{
    "ValueError": 0.610602464335229,
    "isinstance": 0.6007816088918737,
    "len": 0.3544917337048039,
    "type": 0.34856541413554737,
    "logging.info": 0.31433991595682287,
    "epath.Path": 0.30947725868901454,
    "tuple": 0.2922362388431723,
    "logging.warning": 0.2542031304111889,
    "list": 0.2508064099998381,
    "map": 0.24715331179862207,
    "str": 0.2315073911729659,
    "multihost.process_index": 0.22589508815095605,
    "super": 0.22504127669689597,
    "zip": 0.20556219305163917,
    "time.time": 0.20284903933257642,
    "logging.vlog": 0.20021826092400072,
    "dataclasses.dataclass": 0.18556893400126565,
    "NamedSharding": 0.182600912040029,
    "asyncio_utils.run_sync": 0.17821438706953646,
    "exists": 0.17238815175838387,
    "FileNotFoundError": 0.1718589704561882,
    "TypeVar": 0.1642030578693314,
    "jax.devices": 0.16365981721997522,
    "join": 0.16258476649588133,
    "hasattr": 0.16123454842033172,
    "range": 0.16074562906408474,
    "int": 0.1530719920336144,
    "NotImplementedError": 0.152047204089739,
    "set": 0.15071241240528127,
    "restore": 0.150348521598053,
    "dict": 0.1499797037480609,
    "options_lib.MultiprocessingOptions": 0.149840244242713,
    "np.asarray": 0.14962489908363688,
    "async_save": 0.14375725115750018,
    "Mesh": 0.14131980842473105,
    "PartitionSpec": 0.14073517145757605,
    "close": 0.13867228856421682,
    "dataclasses.replace": 0.1364784617759694,
    "save": 0.1286298518907644,
    "metadata": 0.12744080245151096,
    "f.result": 0.12355091598418452,
    "record_event": 0.12050901259667583,
    "record_event_duration_secs": 0.1180692511409254,
    "reshape": 0.11655539890741899,
    "self.async_save": 0.11199718589357179,
    "append": 0.1083793417157474,
    "np.array": 0.10792015445983054,
    "multihost.is_primary_host": 0.10755600300814479,
    "json.dumps": 0.10748206954156966,
    "all": 0.10725856747388784,
    "asyncio.gather": 0.10657758828830102,
    "json.loads": 0.1063633811365464,
    "jax.process_count": 0.1038627773551648,
    "any": 0.10182496377405556,
    "register_with_handler": 0.10010432425809411,
    "__init__": 0.09981096339236228,
    "issubclass": 0.0965850374152664,
    "enumerate": 0.09608238523620183,
    "multihost.sync_global_processes": 0.09476819025161208,
    "functools.partial": 0.09447950525857235,
    "sorted": 0.09252567039363625,
    "utils.is_primary_host": 0.0906809097259593,
    "next": 0.08876731468776745,
    "threading.current_thread": 0.08846678119422056,
    "items": 0.08814757649244787,
    "np.arange": 0.08623030655421532,
    "iter": 0.08495701470990376,
    "flatten": 0.08486025358879618,
    "read": 0.08465343743326252,
    "multihost.unique_barrier_key": 0.08410395321385698,
    "deserialize": 0.08373383923455903,
    "path.exists": 0.07878325073181161,
    "future.CommitFutureAwaitingContractedSignals": 0.07761426964592807,
    "options_lib.FileOptions": 0.07577596760121723,
    "get": 0.07553706894756734,
    "test_utils.assert_tree_equal": 0.075066266217676,
    "max": 0.07411478439790391,
    "finalize": 0.07409229871107163,
    "logging.error": 0.07404823903697934,
    "checkpoint.metadata_store": 0.07375439797082041,
    "tree_map_with_path": 0.07245866684755584,
    "jax.device_put": 0.07218454149686512,
    "context_lib.get_context": 0.06940107524419342,
    "KeyError": 0.06798056901726002,
    "getattr": 0.0670840711557789,
    "values": 0.06538094381751375,
    "test_utils.create_sharded_array": 0.06480305003250428,
    "self.assertEqual": 0.06382422696063447,
    "wait_until_finished": 0.06380869312841872,
    "tree_utils.to_flat_dict": 0.06365016835174356,
    "self.assertTrue": 0.06364889038600456,
    "multihost.process_count": 0.0633765953486091,
    "ts_utils.get_ts_context": 0.06334719113866288,
    "type_handlers.is_ocdbt_checkpoint": 0.06324231478521825,
    "self.assertRaisesRegex": 0.06287883917036358,
    "test_utils.sync_global_processes": 0.062382283217605694,
    "directory.exists": 0.06226789115138899,
    "optax.EmptyState": 0.06192264257044447,
    "self.create_tempdir": 0.061672864658643314,
    "setUp": 0.060846619663869006,
    "test_utils.set_tensorstore_driver_for_test": 0.06081588323908434,
    "tearDown": 0.06081588323908434,
    "copy.deepcopy": 0.060810539941005284,
    "parameterized.parameters": 0.06050904816007611,
    "serialize": 0.06035828908089819,
    "add": 0.058468780975225496,
    "cls": 0.05805434838059464,
    "start": 0.05678276842965146,
    "TypeError": 0.056596265066710186,
    "options_lib.AsyncOptions": 0.05647576125044804,
    "slice": 0.056121763951140616,
    "checkpoint_metadata.step_metadata_file_path": 0.055561366997501034,
    "re.fullmatch": 0.05434137224159271,
    "dataclasses.asdict": 0.054120693990528296,
    "rmtree": 0.053751778229759566,
    "ArrayRestoreArgs": 0.05359492678263324,
    "checkpoint.step_metadata_file_path": 0.053475605190833275,
    "dataclasses.field": 0.05320199453710308,
    "self.assertFalse": 0.05311805138677703,
    "update": 0.05266901317615157,
    "tree_utils.from_flat_dict": 0.05263903077062167,
    "jax.make_array_from_single_device_arrays": 0.052545000552582384,
    "self.assertRaises": 0.05246552809719935,
    "PyTreeCheckpointHandler": 0.05241971949841814,
    "logging.vlog_is_on": 0.05230087257221684,
    "RestoreArgs": 0.052242407259354,
    "leaves": 0.05214371717088078,
    "tree_metadata.serialize_tree": 0.05213544252261033,
    "self.subTest": 0.05183294369339055,
    "step_metadata_serialization.deserialize": 0.05170590690239828,
    "object": 0.05165915943454716,
    "utils.is_scalar": 0.05112927219410274,
    "self.assertSameElements": 0.05094664506338488,
    "type_handlers.ArrayHandler": 0.050516099832545944,
    "step_lib.is_gcs_path": 0.05017252589714871,
    "iterdir": 0.0501615736853255,
    "result": 0.04572161616957263,
    "registry.add": 0.045396547656333865,
    "path.is_dir": 0.044664588101028996,
    "empty_values.is_empty_typestr": 0.04435453959338552,
    "math.prod": 0.04392933363549976,
    "jax.ShapeDtypeStruct": 0.04357542303797615,
    "get_current_operation_id": 0.04328104299080699,
    "composite_checkpoint_handler.CompositeOptions": 0.04325501098071338,
    "jax.local_devices": 0.04319252588393433,
    "checkpoint_args.get_registered_args_cls": 0.04314436402454019,
    "p.is_dir": 0.043097360735153245,
    "jax.local_device_count": 0.04306182899568182,
    "multihost.distributed_to_device_ids": 0.04300370054250889,
    "empty_values.is_supported_empty_value": 0.04290978761984994,
    "jnp.dtype": 0.04288963692668652,
    "directory.iterdir": 0.042863169585841174,
    "handler_registration.DefaultCheckpointHandlerRegistry": 0.04262885056486193,
    "np.ones": 0.042599999250719764,
    "handler_registry.add": 0.042329715658328416,
    "self.skipTest": 0.04222864432371207,
    "tree_map": 0.04214789687950006,
    "PyTreeRestoreArgs": 0.042079648818051124,
    "PyTreeSaveArgs": 0.04203964069048861,
    "write": 0.04198820373809824,
    "test_utils.setup_sharded_pytree": 0.041948927158723295,
    "jax.make_array_from_callback": 0.041816449805160014,
    "args_lib.Composite": 0.041808619155401926,
    "CheckpointManagerOptions": 0.04176237436389082,
    "array_metadata_store_lib.Store": 0.04169334401380039,
    "collections.defaultdict": 0.041411272499319446,
    "structure": 0.04131511577588203,
    "check_for_errors": 0.04129890501081546,
    "sum": 0.04121726405969897,
    "np.dtype": 0.041120752265232915,
    "self.close": 0.040982546681654124,
    "np.int32": 0.04097581219672759,
    "step_lib.standard_name_format": 0.04096135513115543,
    "split": 0.04058605580374433,
    "np.zeros": 0.04058233607646842,
    "self.enter_context": 0.040529665662988344,
    "tree_utils.serialize_tree": 0.04049856443274141,
    "type_handler_registry.get": 0.04034069300245493,
    "Params": 0.04012505313246521,
    "model.init": 0.040076712797972515,
    "optax.adamw": 0.040076712797972515,
    "PRNGKey": 0.040076712797972515,
    "jnp.ones": 0.040076712797972515,
    "type_handlers.create_type_handler_registry": 0.03991435024949973,
    "directory.mkdir": 0.03941427649918586,
    "itertools.count": 0.03550913633293148,
    "logging.log_first_n": 0.03536293627415931,
    "pytree_handler.pytree_handler_context": 0.03506215450686367,
    "TimeoutError": 0.034902559145261206,
    "bool": 0.034612549269393444,
    "checkpoint_metadata.metadata_store": 0.034560788203513215,
    "registration.local_registry": 0.034489299906979985,
    "tree_utils.isinstance_of_namedtuple": 0.03438581577347767,
    "NotADirectoryError": 0.03430955209638011,
    "multihost.broadcast_one_to_all": 0.03420766378863304,
    "self._background_save": 0.03419764634689146,
    "self._background_load": 0.03419764634689146,
    "AssertionError": 0.033951380963320704,
    "path.write_text": 0.03376766923330973,
    "path.read_text": 0.03376766923330973,
    "registry.get": 0.03364202869072394,
    "asyncio.to_thread": 0.03354537612728516,
    "functools.lru_cache": 0.033341207537918256,
    "item": 0.033255137287179125,
    "asyncio.run": 0.03314518773002107,
    "keys": 0.03308545856176985,
    "threading.Thread": 0.03289910825449783,
    "handler.typestr": 0.03286596950312409,
    "checkpoint_utils.construct_restore_args": 0.03269280908693251,
    "delete": 0.03256722023887786,
    "composite_checkpoint_handler.CompositeCheckpointHandler": 0.03254079881911988,
    "ts.open": 0.03250554490597333,
    "np.stack": 0.03243861323192283,
    "re.match": 0.03242868002186111,
    "datetime.timedelta": 0.032421092751028016,
    "tree_flatten_with_path": 0.032292715001079,
    "jax.device_count": 0.032276324149916866,
    "test_utils.setup_pytree": 0.03226730728571085,
    "np.prod": 0.032240169030305146,
    "async_checkpointer.AsyncCheckpointer": 0.03211807728246264,
    "pop": 0.03211082826244432,
    "multislice.slice_devices": 0.0320769476977041,
    "client.key_value_set": 0.03206044216755652,
    "handler.save": 0.03201561661291245,
    "SingleDeviceSharding": 0.03198165420462912,
    "ts.Spec": 0.03190659743373107,
    "multislice.slice_count": 0.0318740372832435,
    "async_utils.async_exists": 0.031818361481192395,
    "issubdtype": 0.031775902420899324,
    "time.sleep": 0.03173322192554029,
    "to_jax_sharding": 0.03172638457254661,
    "functools.reduce": 0.03171964153228837,
    "metadata_file.exists": 0.03169391762772858,
    "type_handlers.SaveArgs": 0.03164052918334708,
    "create_numpy_pytree": 0.03161912936524154,
    "np.array_equal": 0.03160667234784656,
    "match.expand": 0.03151897734546039,
    "tree_metadata.PyTreeMetadataOptions": 0.03150835315672743,
    "array_metadata_store_lib.Validator": 0.03148667918807512,
    "self.assertIsInstance": 0.031481710803099014,
    "jax.jit": 0.03147248967773794,
    "np.vectorize": 0.031421675956971006,
    "checkpoint_args.has_registered_args": 0.03131165388464092,
    "barrier_sync_fn": 0.031310215684155006,
    "SaveArgs": 0.031255047290074126,
    "multihost.is_pathways_backend": 0.03125424336032454,
    "tree_metadata.build_default_tree_metadata": 0.031248290789828274,
    "self.assertLen": 0.031247631863278773,
    "test_utils.assert_every_n_is_x_apart": 0.031247631863278773,
    "key_data": 0.031195040307232032,
    "self.metadata": 0.031162187559016074,
    "assert_array_equal": 0.031158611274716634,
    "registry.get_all_entries": 0.031067809712429166,
    "array_metadata_store.read": 0.03104833269564964,
    "self.latest_step": 0.030963289178058104,
    "ThreadPoolExecutor": 0.030956016819223133,
    "args.items": 0.03091885032694874,
    "empty_values.get_empty_value_from_typestr": 0.030908429673209982,
    "should_save": 0.0307054137501561,
    "open": 0.030681665508498532,
    "self.assertIsNone": 0.030662012674173577,
    "process_metadata_checkpoint_handler.ProcessMetadataRestoreArgs": 0.030644490413383317,
    "process_metadata_checkpoint_handler.ProcessMetadataSaveArgs": 0.030630685157647455,
    "self.wait_until_finished": 0.030605146539400926,
    "self.assertDictEqual": 0.03052194193121137,
    "value_metadata.ScalarMetadata": 0.030509559435543388,
    "value_metadata.ArrayMetadata": 0.030506943434164276,
    "pjit.pjit": 0.03048553142269865,
    "test_utils.apply_function": 0.03043658441783959,
    "typing.cast": 0.03039224465847323,
    "ts.experimental_collect_matching_metrics": 0.03031004765215556,
    "handler.metadata": 0.030215690979739543,
    "np.concatenate": 0.03020770786387202,
    "mesh_utils.create_device_mesh": 0.030144585761552167,
    "_should_mask": 0.029859541524505245,
    "sharding_metadata.NamedShardingMetadata": 0.029834339941605524,
    "create": 0.02982869687634579,
    "optax.MaskedNode": 0.02982869687634579,
    "test_utils.get_byte_limiter": 0.029771400473565385,
    "self.assertGreater": 0.029682826674858956,
    "self.assertListEqual": 0.029626780278689212,
    "value_metadata.StorageMetadata": 0.02955736923541827,
    "sharding_metadata.from_jax_sharding": 0.029349129601341967,
    "asyncio_utils.as_async_function": 0.02907157653435504,
    "PyTreeMetadataOptions": 0.02639741545347553,
    "dataclasses.fields": 0.0260885956041257,
    "metadata_dict.get": 0.02588110020973909,
    "utils.process_unknown_key": 0.025742081349173128,
    "pytree_checkpoint_handler.PyTreeCheckpointHandler": 0.025284184564219856,
    "inspect.isclass": 0.024577522544068697,
    "multihost.is_jax_distributed_client_initialized": 0.024285861399316915,
    "collections.namedtuple": 0.02402546076840023,
    "format_utils.validate_pytree_checkpoint": 0.02391463870000657,
    "logging.debug": 0.023843043466711074,
    "text_format.Parse": 0.023806864760122944,
    "text_format.MessageToString": 0.023806864760122944,
    "threading.RLock": 0.023633963838918432,
    "RootMetadata": 0.023452532858679872,
    "metadata_store.read": 0.023382481668179605,
    "options_lib.CheckpointablesOptions": 0.02318581024721214,
    "v0_options_lib.MultiprocessingOptions": 0.023141030913587542,
    "handler_types.typestr": 0.023087295037080124,
    "NoEntryError": 0.022939643481368358,
    "self.has": 0.02288162796315328,
    "AlreadyExistsError": 0.022808429650199552,
    "other_registry.get_all_entries": 0.022808429650199552,
    "load": 0.022475493894121276,
    "func": 0.022407043048767807,
    "checkpointables.items": 0.022395231663326746,
    "DefaultCheckpointHandlerRegistry": 0.022391983320524726,
    "v0": 0.022327377426474886,
    "registration.resolve_handler_for_save": 0.02232582234219071,
    "abstract_checkpointables.items": 0.022323573625969678,
    "get_v0_checkpointer_and_args": 0.022292782897493157,
    "compatibility_handlers.items": 0.022292782897493157,
    "composite_checkpoint_handler.CompositeArgs": 0.022292782897493157,
    "handler_compatibility.get_compatibility_handler": 0.022292782897493157,
    "handlers.items": 0.022292782897493157,
    "handler_compatibility.Args": 0.022292782897493157,
    "future.CommitFuture": 0.022227277975142356,
    "Fragment": 0.022222362956520483,
    "self.__getitem__": 0.022208146703754712,
    "min": 0.022071144203750184,
    "_save_fn": 0.02204700019823502,
    "options_lib.ArrayOptions": 0.02202084500762205,
    "options_lib.PyTreeOptions": 0.02202084500762205,
    "checkpoint_args.get_registered_handler_cls": 0.021973218334846167,
    "multihost.unique_processes_from_devices": 0.021972989134424865,
    "msgpack_utils.msgpack_serialize": 0.021962560803615222,
    "Foo": 0.021943705689270142,
    "Bar": 0.021943705689270142,
    "atomicity_defaults.get_default_temporary_path_class": 0.021904336410277208,
    "type_handlers.RestoreArgs": 0.021894759227139036,
    "cast": 0.021868388173215642,
    "manager.restore": 0.02186657028796178,
    "AbstractFoo": 0.02184493597297444,
    "AbstractBar": 0.02184493597297444,
    "transform.multi_value_fn": 0.021832298284992984,
    "notify_all": 0.021805746195139867,
    "handler.load": 0.02179988722211533,
    "tree_metadata.ValueMetadataEntry": 0.021770340888109547,
    "is_alive": 0.021751592447640737,
    "jnp.arange": 0.021705395298005296,
    "metadata_folder.exists": 0.021704569507914287,
    "np.maximum": 0.021698949644585526,
    "CheckpointManager": 0.021696138398458444,
    "frozenset": 0.021681556391855723,
    "future.result": 0.021680619180150705,
    "manager.save": 0.021675957229315042,
    "manager.wait_until_finished": 0.021675957229315042,
    "reduce": 0.021665060397455284,
    "tree_utils.get_key_name": 0.021664810764843574,
    "has": 0.021661280313138243,
    "self.add": 0.02164471196080933,
    "m.group": 0.02162783780314624,
    "offset_by": 0.021626653620805486,
    "devices.reshape": 0.021623215595242714,
    "reversed": 0.021623215595242714,
    "ts.Context": 0.021600238670397797,
    "replace": 0.021600238670397797,
    "normpath": 0.021600238670397797,
    "_get_kvstore_for_gcs": 0.021600238670397797,
    "isabs": 0.021600238670397797,
    "type_handlers.get_type_handler": 0.021540908892741278,
    "tmpdir.get": 0.021529673901367306,
    "items.items": 0.021527190646805992,
    "from_json": 0.021469051759831437,
    "ckptr.save": 0.021451310267105544,
    "ckptr.restore": 0.021449061550884514,
    "arr.addressable_data": 0.021446716307913765,
    "LocalCheckpointOptions": 0.021446516143516302,
    "PersistentCheckpointOptions": 0.021446516143516302,
    "manager.reload": 0.021443173281715494,
    "checkpoint_manager.MultiprocessingOptions": 0.021440897404691718,
    "path.iterdir": 0.021414250181068586,
    "step_lib.is_tmp_checkpoint": 0.021408274202202923,
    "flags.DEFINE_bool": 0.021402491034170662,
    "manager.latest_step": 0.021385315389438872,
    "save_ops.append": 0.021381958541386765,
    "CompositeArgs": 0.021370956462364213,
    "tree_utils.tuple_path_from_keypath": 0.021349300610140554,
    "shard_shape": 0.02133067203914306,
    "checkpoint_manager.CheckpointManager": 0.021322254441300394,
    "checkpoint_path.exists": 0.021300575317756944,
    "type_handlers.default_restore_type": 0.021300575317756944,
    "value_fn": 0.021264850814481952,
    "sharding.devices_indices_map": 0.021263656432092267,
    "async_utils.async_rmtree": 0.02124588438644102,
    "get_all_entries": 0.02124251532745969,
    "ParamInfo": 0.0212392531086642,
    "type_handlers.merge_ocdbt_per_process_files": 0.021227822214210428,
    "devices.reverse": 0.0212244896882196,
    "devices.append": 0.0212244896882196,
    "checkpoint_handler.save": 0.021198057374542292,
    "client.wait_at_barrier": 0.021172724435598984,
    "mesh_consistency.process_metadata_folder": 0.021158055946795068,
    "submit": 0.021153258638024315,
    "multihost.get_jax_distributed_client": 0.0211428540117268,
    "pytree_checkpoint_handler.get_param_names": 0.021140684270710596,
    "type_handlers.is_placeholder": 0.021131536615035394,
    "step_lib.build_step_path": 0.021127341287297798,
    "jax.process_index": 0.021111436258143663,
    "self.synchronize_next_awaitable_signal_operation_id": 0.021108001878587763,
    "self.get_temporary_path": 0.021108001878587763,
    "self.create_temporary_path": 0.021108001878587763,
    "self._save_step_metadata": 0.021108001878587763,
    "atomicity.on_commit_callback": 0.021108001878587763,
    "reload": 0.021087887117772618,
    "checkpoint_handler.metadata": 0.02106603229887717,
    "complex": 0.021065767452732843,
    "logging.exception": 0.02104221994974105,
    "np.expand_dims": 0.02102717199287098,
    "self.validate_save": 0.021026038433038855,
    "_local_checkpoint_handler": 0.021017696745238984,
    "time.time_ns": 0.021014340173553248,
    "wrap_key_data": 0.021008126480561825,
    "tmp_dir.finalize": 0.020999990847181755,
    "CompositeCheckpointHandler": 0.020996750390530318,
    "utils.is_checkpoint_finalized": 0.020978573575582107,
    "get_param_names": 0.020975251519463965,
    "checkpoint_manager.CheckpointManagerOptions": 0.020966354880659524,
    "subchunking.choose_chunk_shape": 0.020966184007575835,
    "ArrayMetadata": 0.020966184007575835,
    "checkpoint_metadata.StepMetadata": 0.02095873296632967,
    "FileExistsError": 0.02095873296632967,
    "step_metadata_serialization.serialize": 0.02095873296632967,
    "self.validate_metadata": 0.020952798570544367,
    "sync_global_devices": 0.020948001688116377,
    "unflatten": 0.02094730649963998,
    "create_sharded_array": 0.020945234350151203,
    "checkpoint_dir.exists": 0.020917973697444345,
    "Layout": 0.02091130918216876,
    "typestr": 0.020906472254902067,
    "np.take": 0.020905169963606193,
    "StorageOptions": 0.02086922161832985,
    "temporary_path_class.from_final": 0.0208621083393285,
    "atomicity.create_all": 0.0208621083393285,
    "get_legacy_handler_wrapper": 0.0208621083393285,
    "multihost.is_runtime_to_distributed_ids_initialized": 0.020858342952082942,
    "multihost.initialize_runtime_to_distributed_ids": 0.020858342952082942,
    "multihost.initialize_distributed_to_device_ids": 0.020858342952082942,
    "self.assertIsNotNone": 0.020857537376627995,
    "v.split": 0.02085519045454908,
    "type_handlers.ArrayRestoreArgs": 0.020829729768230096,
    "directory.rmtree": 0.020820850458476415,
    "pytree_checkpoint_handler.PyTreeSaveArgs": 0.020817393060497687,
    "pytree_checkpoint_handler.PyTreeRestoreArgs": 0.020817393060497687,
    "json.load": 0.020806519876482216,
    "self.assertCountEqual": 0.020806519876482212,
    "_get_metadata": 0.020801834793723734,
    "handler.restore": 0.020793851015743003,
    "asyncio.sleep": 0.02079122253734159,
    "client.key_value_dir_get": 0.02078019856731858,
    "multislice.process_slice_id": 0.02076378873910543,
    "all_steps": 0.02074089122434604,
    "self._finalize": 0.020732695721070643,
    "run": 0.020719639061107777,
    "humanize.naturalsize": 0.02070643162527679,
    "atomicity.create_all_async": 0.02065319755136557,
    "context_lib.Context": 0.020649837432612235,
    "Transform": 0.020624400643627527,
    "get_slice_id": 0.02058908394983034,
    "self.finalize": 0.02056450301253154,
    "data.keys": 0.02055877344733096,
    "delete_if": 0.020554390230863237,
    "serialization.get_byte_limiter": 0.020517052505073626,
    "k.split": 0.020509728338947066,
    "multislice.in_slice": 0.020471825788095702,
    "self._run_initial_garbage_collection": 0.020468725103156917,
    "step_lib.tmp_checkpoints": 0.020468725103156917,
    "latest_step": 0.020468725103156917,
    "reached_preemption": 0.020468725103156917,
    "mesh_consistency.consistent_restore_mesh_from_metadata": 0.020468725103156917,
    "mesh_consistency.consistent_restore_mesh_to_global_mesh": 0.020468725103156917,
    "ProcessMetadataCheckpointHandler": 0.020468725103156917,
    "file_path.exists": 0.02046837041754557,
    "inspect.getmembers": 0.020455028624086522,
    "internal_tree_metadata.as_nested_tree": 0.02043044562248404,
    "deserialized_batches_ops.append": 0.02043044562248404,
    "BasePyTreeRestoreArgs": 0.02043044562248404,
    "self._maybe_deserialize": 0.02043044562248404,
    "self.assertNotEmpty": 0.02040540397160014,
    "copy": 0.0204022660893137,
    "replica_slices.transfer_arrays_to_host": 0.02038434592685459,
    "handler_registry.has": 0.020354688261293673,
    "types.SaveArgs": 0.020296785222431564,
    "multihost.get_barrier_sync_fn": 0.020274839930281896,
    "self.check_for_errors": 0.020274839930281896,
    "self.all_steps": 0.020272496241178904,
    "key": 0.020216209619302566,
    "test_utils.register_type_handler": 0.020215386076744835,
    "create_sharded_pytree": 0.020153910914668165,
    "test_utils.get_expected_chunk_shape": 0.020151309374590948,
    "utils.is_tmp_checkpoint": 0.020145411627276236,
    "value_metadata.StringMetadata": 0.020107450548212915,
    "check_dtype": 0.02009938659257443,
    "astype": 0.020097907474440485,
    "make_params": 0.020086260779834723,
    "step_statistics.SaveStepStatistics": 0.0200733103065962,
    "sys.getsizeof": 0.020053991891485073,
    "key_impl": 0.020044897654803745,
    "Saving": 0.020033315468980337,
    "executor.map": 0.020028946391022633,
    "make_state_with_optax": 0.0200270836743872,
    "self.assertGreaterEqual": 0.0200270836743872,
    "make_state_with_nones": 0.0200270836743872,
    "mkdir": 0.019987688510170548,
    "x.reshape": 0.019947642353960734,
    "test_utils.concurrent_gb_test_setup": 0.019946961786614488,
    "nn.Dense": 0.019934694982094128,
    "jax.eval_shape": 0.01993216781413096,
    "x.addressable_data": 0.01993216781413096,
    "PyTreeDict": 0.01992489702216859,
    "jnp.array": 0.019913257091415767,
    "setattr": 0.019904830221712133,
    "handler.close": 0.0198878038985574,
    "standard_logger.StandardLogger": 0.019797374886015694,
    "log_entry": 0.01976813179054699,
    "multislice.broadcast_one_replica_to_all": 0.019721453743441524,
    "create_zeros": 0.019721453743441524,
    "jnp.zeros": 0.019721453743441524,
    "self._get_old_steps_to_remove": 0.01967160249639469,
    "delete_steps": 0.01967160249639469,
    "find_step": 0.01967160249639469,
    "save_handler.save": 0.019572450172088918,
    "self.assertLessEqual": 0.01950052417270303,
    "from_jax_mesh": 0.019445630342377236,
    "parameterized.product": 0.019437989284131915,
    "from_deserialized_dict": 0.019437989284131915,
    "from_jax_sharding": 0.019437989284131915,
    "array_metadata.SerializedArrayMetadata": 0.019432231054275044,
    "f.stat": 0.019432231054275044,
    "type_handlers.NumpyHandler": 0.019426587989015313,
    "zarr_path.unlink": 0.019426587989015313,
    "register_pytree_node": 0.019426587989015313,
    "with_memory_kind": 0.019426587989015313,
    "metadata_file.unlink": 0.019426587989015313,
    "zarr_path.exists": 0.019426587989015313,
    "original_transfer_arrays_to_host": 0.019426587989015313,
    "p.exists": 0.019426587989015313,
    "self.assertContainsSubset": 0.019426587989015313,
    "process_dir.exists": 0.019426587989015313,
    "process_dir.is_dir": 0.019426587989015313,
    "data_dir.iterdir": 0.019426587989015313,
    "PlusOneHandler": 0.019426587989015313,
    "ARRAY_METADATA_STORE.read": 0.019426587989015313,
    "devices_subset.append": 0.019426587989015313,
    "data_dir.exists": 0.019426587989015313,
    "data_dir.is_dir": 0.019426587989015313,
    "f.is_file": 0.019426587989015313,
    "true_data.pop": 0.019426587989015313,
    "d.values": 0.019426587989015313,
    "d.keys": 0.019426587989015313,
    "PathResolverReturningNoMetadataFiles": 0.019426587989015313,
    "MissingArrayMetadataSerDeserializer": 0.019426587989015313,
    "mark_as_parsed": 0.018867924528301886,
    "registration.global_registry": 0.01610478095459007,
    "__new__": 0.014150943396226415,
    "version.get_details": 0.014150943396226415,
    "CloudLoggerOptions": 0.01365295844811281,
    "logger": 0.01365295844811281,
    "log_struct": 0.01365295844811281,
    "google_cloud_logging.Client": 0.01365295844811281,
    "_get_severity": 0.01365295844811281,
    "is_valid_logger": 0.013635929562395276,
    "logger.log_entry": 0.013635929562395276,
    "ValueMetadataEntry": 0.013349871780139166,
    "empty_values.override_empty_value_typestr": 0.013272329017446332,
    "__repr__": 0.013265765574108765,
    "policy.should_save": 0.012994504762012707,
    "future._SignalingThread": 0.012989315499015327,
    "future.get_awaitable_signals_from_contract": 0.012989315499015327,
    "HandlerTypeRegistry": 0.012984097562906954,
    "_GLOBAL_HANDLER_TYPE_REGISTRY.add": 0.012984097562906954,
    "_GLOBAL_HANDLER_TYPE_REGISTRY.get": 0.012984097562906954,
    "handler_type.typestr": 0.012984097562906954,
    "_get_shape": 0.01281205868984367,
    "functools.wraps": 0.012769371609370507,
    "asyncio.get_running_loop": 0.012769371609370507,
    "asyncio.get_event_loop": 0.012769371609370507,
    "loop.run_in_executor": 0.012769371609370507,
    "nest_asyncio.apply": 0.012769371609370507,
    "loading.get_v0_checkpointer_and_args": 0.012769371609370507,
    "checkpointer.metadata": 0.012769371609370507,
    "checkpointables_metadata": 0.012769371609370507,
    "is_supported_empty_value": 0.012735255268037555,
    "OrbaxEmptyNamedTuple": 0.012735255268037555,
    "os.walk": 0.012722860193055416,
    "lstrip": 0.012722860193055416,
    "dst_root.mkdir": 0.012722860193055416,
    "src_file.copy": 0.012722860193055416,
    "_is_scalar": 0.012709402312528238,
    "scalar_dtype": 0.012709402312528238,
    "sharding.to_jax_sharding": 0.012709402312528238,
    "acquire": 0.01253189741675149,
    "release": 0.01253189741675149,
    "get_value": 0.01253189741675149,
    "_SAVE_ARG_TO_HANDLER.items": 0.012477656141620722,
    "_RESTORE_ARG_TO_HANDLER.items": 0.012477656141620722,
    "handler_type_registry.register_handler_type": 0.012477656141620722,
    "get_registered_args_cls": 0.012477656141620722,
    "_validate_type": 0.012451091044351801,
    "mesh_consistency.read_process_metadata": 0.012414219045627964,
    "mesh_consistency.save_process_metadata": 0.012414219045627964,
    "standard_checkpoint_handler.StandardCheckpointHandler": 0.01241117393942597,
    "StandardSave": 0.01241117393942597,
    "StandardRestore": 0.01241117393942597,
    "empty_values.get_empty_value_typestr": 0.012408107988058189,
    "logging.log_every_n_seconds": 0.012408107988058189,
    "orbax_future.CommitFutureAwaitingContractedSignals": 0.01227840891111098,
    "_serialize_fn": 0.01227840891111098,
    "path.read_bytes": 0.01227840891111098,
    "msgpack_utils.msgpack_restore": 0.01227840891111098,
    "path.write_bytes": 0.01227840891111098,
    "contextvars.ContextVar": 0.01227840891111098,
    "_CONTEXT.get": 0.01227840891111098,
    "Context": 0.01227840891111098,
    "_CONTEXT.set": 0.01227840891111098,
    "_CONTEXT.reset": 0.01227840891111098,
    "DefaultSnapshot": 0.012257374737548208,
    "utils.Timer": 0.012257374737548208,
    "utils.recursively_copy_files": 0.012257374737548208,
    "is_absolute": 0.012257374737548208,
    "t.get_duration": 0.012257374737548208,
    "resolve_slice": 0.012257295999204986,
    "int_tuple_from_slice": 0.012257295999204986,
    "_pretty_slice": 0.012257295999204986,
    "v0_options_lib.AsyncOptions": 0.012233629577486377,
    "v0_options_lib.FileOptions": 0.012233629577486377,
    "named_handlers.items": 0.012233629577486377,
    "registration.ReadOnlyCheckpointableHandlerRegistry": 0.012233629577486377,
    "metrics.copy": 0.012222298578976942,
    "additional_metrics.items": 0.012222298578976942,
    "performance_metrics.items": 0.012222298578976942,
    "StepStatistics": 0.012114842875462736,
    "StepMetadata": 0.012114842875462736,
    "__setattr__": 0.012056106428979956,
    "_CompatibilityHandler": 0.012048431715673593,
    "_synchronous_load": 0.012048431715673593,
    "_background_save": 0.012048431715673593,
    "hash": 0.012042317183192347,
    "threading_lib.TimeoutRLock": 0.012042317183192347,
    "self.set": 0.012042317183192347,
    "select_fn": 0.012042317183192347,
    "deleted_steps.append": 0.012042317183192347,
    "retained_infos.append": 0.012042317183192347,
    "self.size": 0.012042317183192347,
    "message_type": 0.011938710821356682,
    "is_pytree_checkpoint": 0.01189461158966168,
    "Composite": 0.011890460151236525,
    "_get_args_type": 0.011866120682393169,
    "checkpoint_metadata_path.exists": 0.011856262006886243,
    "format_utils._has_pytree_metadata_file": 0.011856262006886243,
    "format_utils._has_tensorstore_data_files": 0.011856262006886243,
    "_has_msgpack_metadata_file": 0.011828159948463724,
    "items_to_handlers.items": 0.011769566328793014,
    "handler_to_register": 0.011769566328793014,
    "self._save_fn": 0.011720669035074708,
    "_has_zarray_files": 0.011704069803810196,
    "dir": 0.011701896261836514,
    "key.startswith": 0.011701896261836514,
    "repr": 0.011701896261836514,
    "_int_list_flip_index_and_value": 0.01160740313790036,
    "_module_and_class_name": 0.011601240929602718,
    "multihost.runtime_to_distributed_ids": 0.011585668729162868,
    "runtime_to_distributed_ids": 0.011585668729162868,
    "process_index_from_device_id": 0.011585668729162868,
    "set.intersection": 0.011580698921977708,
    "__post_init__": 0.011580698921977708,
    "transforms.items": 0.011580698921977708,
    "unmatched_new_keys.append": 0.011580698921977708,
    "t.keys": 0.011580698921977708,
    "put": 0.011553179105233813,
    "_value_metadata_tree_for_json_dumps": 0.011547500267403732,
    "_value_metadata_tree_for_json_loads": 0.011526964902631172,
    "is_ocdbt_checkpoint": 0.011526219661293366,
    "_has_pytree_metadata_file": 0.011526219661293366,
    "_has_tensorstore_data_files": 0.011526219661293366,
    "placeholder.startswith": 0.011514597181140684,
    "aiofiles.open": 0.011509281542929588,
    "EmptyNamedTuple": 0.01150136165027537,
    "MyEmptyChex": 0.01150136165027537,
    "MyChex": 0.01150136165027537,
    "create_namedtuple": 0.011484364052130755,
    "StandardCheckpointDeleter": 0.011477889633452726,
    "leaf_is_placeholder": 0.011477403077727169,
    "pytree.update": 0.01146082147004165,
    "shardings.update": 0.01146082147004165,
    "abstract_arrays.to_shape_dtype_struct": 0.01146082147004165,
    "np.empty_like": 0.01146082147004165,
    "background_save": 0.011452190028415792,
    "background_load": 0.011452190028415792,
    "is_remote_storage": 0.011443255065729158,
    "MuNu": 0.011443186040389713,
    "placeholder.replace": 0.011436738605537004,
    "MyEmptyFlax": 0.011432263318527236,
    "_standardize_abstract_checkpointables": 0.011422016213172428,
    "MyEmptyDataClass": 0.011405713927808425,
    "MyFlax": 0.011395282709838856,
    "f.write": 0.011390468666847267,
    "MyEmptyClass": 0.011388544636753256,
    "MyClass": 0.011388544636753256,
    "DataclassHandler": 0.011370903602820304,
    "f.read": 0.011370903602820304,
    "kv_spec.update": 0.01136040126015873,
    "type_handlers.ParamInfo": 0.01135906924250632,
    "self.delete": 0.011358655527727633,
    "_NonBlockingMetadataStore": 0.011358115585863039,
    "AbstractBaz": 0.01135153418943361,
    "checkpointable_type": 0.01135153418943361,
    "Baz": 0.01135153418943361,
    "contents.values": 0.01135153418943361,
    "msgpack.unpackb": 0.011349519610486724,
    "self._is_supported_type": 0.011342111598755117,
    "obj.items": 0.011329276999974281,
    "_get_unique_barrier_key": 0.011324055072597558,
    "signaling_client.get_signaling_client": 0.011324055072597556,
    "msgpack.packb": 0.011322576458272615,
    "process_metadata_folder": 0.011321551438082575,
    "add_nested_key": 0.0113030126869406,
    "leaf.startswith": 0.0113030126869406,
    "queue.Queue": 0.01130204690232832,
    "ThreadedCheckpointDeleter": 0.01130204690232832,
    "rename_dir.mkdir": 0.01130204690232832,
    "delete_target.replace": 0.01130204690232832,
    "step_lib.find_step_path": 0.01130204690232832,
    "delete_target.rmtree": 0.01130204690232832,
    "key_value_delete": 0.01129654590030159,
    "threading.Lock": 0.01129654590030159,
    "threading.Condition": 0.01129654590030159,
    "key.endswith": 0.01129654590030159,
    "JaxDistributedSignalingClient": 0.01129654590030159,
    "ThreadSafeKeyValueSignalingClient": 0.01129654590030159,
    "key_value_set": 0.01129654590030159,
    "RuntimeError": 0.01129654590030159,
    "blocking_key_value_get": 0.01129654590030159,
    "key_value_try_get": 0.01129654590030159,
    "wait": 0.01129654590030159,
    "full_key.startswith": 0.01129654590030159,
    "unique_class_name.replace": 0.011290205500362678,
    "tree_utils.is_empty_or_leaf": 0.011290205500362678,
    "simplejson.dumps": 0.011290205500362678,
    "simplejson.loads": 0.011290205500362678,
    "_new_namedtuple_type": 0.011290205500362678,
    "_create_namedtuple": 0.011290205500362678,
    "obj.to_json": 0.011290205500362678,
    "pytree_metadata_options_lib.PyTreeMetadataOptions": 0.011290205500362678,
    "leaf_placeholder": 0.011284322182712702,
    "x.devices": 0.011284322182712702,
    "slice_devices": 0.011279016713097776,
    "_unchunk_array_leaves_in_place": 0.011268690153844383,
    "save_checkpointables_async": 0.011268676158361569,
    "msgpack.ExtType": 0.011267543417495522,
    "write_text": 0.011264182277131664,
    "read_text": 0.011264182277131664,
    "tmp_path.get": 0.011264182277131664,
    "_chunk_array_leaves_in_place": 0.011255218577737326,
    "from_final": 0.011245880077001858,
    "tmp_path.finalize": 0.011245880077001858,
    "emergency_multihost.consistent_restore_mesh": 0.011245880077001858,
    "metadata_folder.rmtree": 0.011245880077001858,
    "tmp_path.create": 0.011245880077001858,
    "_np_convert_in_place": 0.011241747001630265,
    "self._get_checkpointable_directory": 0.011232238812289566,
    "_run_background": 0.011231165452642177,
    "_construct_handler_instance": 0.011223762617716094,
    "tree_memory_per_device": 0.011213576034385065,
    "process_index": 0.011208682105223243,
    "JsonSaveArgs": 0.01120322566731656,
    "_index_from_ndarray": 0.011201875205031886,
    "add_all": 0.011189824149074093,
    "np.minimum": 0.011189749349747247,
    "rslice.data": 0.011180565291786506,
    "self._get_loadable_handlers": 0.011178306535333611,
    "loadable_checkpointable_names_to_handlers.items": 0.011178306535333611,
    "self._get_saved_handler_typestrs": 0.011178306535333611,
    "load_ops.append": 0.011178306535333611,
    "registration.resolve_handler_for_load": 0.011178306535333611,
    "loaded_checkpointables.append": 0.011178306535333611,
    "loadable_checkpointable_names_to_handlers.keys": 0.011178306535333611,
    "existing_checkpointable_names_to_handler_typestrs.keys": 0.011178306535333611,
    "MyChexWithNestedAttributes": 0.011171949746040915,
    "NamedTupleWithNestedAttributes": 0.011171949746040914,
    "TestPyTree": 0.01115089136966775,
    "MyDataClass": 0.01115089136966775,
    "MyClassWithNestedAttributes": 0.01115089136966775,
    "_log_and_check_restored": 0.011147834605271025,
    "_SaveResponse": 0.011147515806857093,
    "save_pytree_async": 0.011147515806857093,
    "checkpointables.keys": 0.011147515806857093,
    "_get_loadable_handlers": 0.011145267090636063,
    "load_checkpointables": 0.011145267090636063,
    "abstract_checkpointables.keys": 0.011145267090636063,
    "composite_handler.CompositeHandler": 0.011145267090636063,
    "restored.keys": 0.011145267090636063,
    "restored.values": 0.011145267090636063,
    "handlers.keys": 0.011145267090636063,
    "get_awaitable_signals_from_contract": 0.011136355985988894,
    "is_dict_key": 0.011133846192009769,
    "tree_rich_types._module_and_class_name": 0.011133722078612582,
    "tree_rich_types._new_namedtuple_type": 0.011133722078612582,
    "new_type": 0.011133722078612582,
    "self._validate_save_state": 0.011133241167993442,
    "StandardRestoreArgs": 0.011133241167993442,
    "self._validate_restore_state": 0.011133241167993442,
    "_construct_restore_args": 0.011133241167993442,
    "self.checkpoint_save_args": 0.011132980848545512,
    "self.checkpoint_restore_args": 0.011132980848545512,
    "self.post_restore": 0.011132980848545512,
    "ArraySaveArgs": 0.011132980848545512,
    "JsonRestoreArgs": 0.011132980848545512,
    "Diff": 0.011127069372395645,
    "is_distributed_to_device_ids_initialized": 0.011114954375583085,
    "_tuple_to_dict": 0.01110940542081759,
    "_dict_to_tuple": 0.01110940542081759,
    "devices_indices_map": 0.011108512713006098,
    "context.setdefault": 0.011107776518099001,
    "fill_unspecified_mesh_axes": 0.01110373329449559,
    "mesh_utils.create_hybrid_device_mesh": 0.01110373329449559,
    "train_state.items": 0.01110373329449559,
    "_log_array_info": 0.01110373329449559,
    "parallelism_vals.count": 0.01110373329449559,
    "parallelism_vals.index": 0.01110373329449559,
    "_ndarray_from_bytes": 0.011099987984919452,
    "SequenceKey": 0.011099919898409237,
    "tree_utils.get_param_names": 0.011099086254145272,
    "directory.startswith": 0.01109103837555952,
    "kvstore_tspec.update": 0.01109103837555952,
    "build_kvstore_tspec": 0.01109103837555952,
    "build_zarr_shard_and_chunk_metadata": 0.01109103837555952,
    "_maybe_add_cast_to_write_spec": 0.01109103837555952,
    "add_ocdbt_write_options": 0.01109103837555952,
    "calculate_chunk_byte_size": 0.01109103837555952,
    "is_sequence_key": 0.011088647514496645,
    "_DefaultCheckpointableHandlerRegistry": 0.011087496686777916,
    "array_metadatas.items": 0.011082957066093876,
    "registry.has": 0.011071616404207668,
    "_get_possible_handlers": 0.011071616404207668,
    "_raise_unsupported_key_error": 0.01106298240213504,
    "get_key_name": 0.01106298240213504,
    "_unchunk": 0.011062826600753844,
    "self.get_all_entries": 0.011055074443196995,
    "aggregate_handlers.MsgpackHandler": 0.011048975954741668,
    "type_handler.serialize": 0.011048975954741668,
    "checkpoint_path.is_file": 0.011048975954741668,
    "type_handler.typestr": 0.011048975954741668,
    "result.reshape": 0.011048975954741668,
    "type_handler.deserialize": 0.011048975954741668,
    "_GLOBAL_REGISTRY.add": 0.011038863321406535,
    "handler_type": 0.011038863321406535,
    "handler.is_handleable": 0.011038863321406535,
    "handler.is_abstract_handleable": 0.011038863321406535,
    "possible_handler_typestrs.index": 0.011038863321406535,
    "global_registry": 0.011038863321406535,
    "is_handleable_fn": 0.011038863321406535,
    "d.items": 0.011033438539182774,
    "reduce_dim": 0.011030292000973482,
    "chunk_id_to_index": 0.011024790626749862,
    "serialization_types.ParamInfo": 0.011008882343123872,
    "type_handlers.get_json_tspec_read": 0.011008882343123872,
    "idx.append": 0.011008882343123872,
    "v.decode": 0.011008882343123872,
    "open_tensorstore": 0.011008882343123872,
    "get_chunk_ids_from_tensorstore": 0.011008882343123872,
    "index_to_chunk_id": 0.011008882343123872,
    "devices_indices_map.items": 0.011008882343123872,
    "type_handlers.get_ts_context": 0.011008882343123872,
    "missing_chunk_ids.append": 0.011008882343123872,
    "get_present_and_missing_chunks": 0.011008882343123872,
    "ocp.load_pytree": 0.011006131950824245,
    "logging.log_every_n": 0.011004014283980741,
    "flat_dict.items": 0.011000483823543438,
    "self._add_to_write_futures": 0.010990864512823254,
    "snapshot_dir.exists": 0.010990055502924118,
    "snapshot_impl.release_snapshot": 0.01098859503952045,
    "_checkpoint_steps": 0.010986768622328882,
    "sort": 0.010980105828190662,
    "itertools.product": 0.010980105828190662,
    "_find_divisors": 0.010980105828190662,
    "validate_divisible_shapes": 0.010980105828190662,
    "new_fragments.append": 0.010980105828190662,
    "new_fragments.extend": 0.010980105828190662,
    "must_shard_dims.remove": 0.010980105828190662,
    "safe_zip": 0.010980105828190662,
    "chunk_fragment": 0.010980105828190662,
    "math.ceil": 0.010980105828190662,
    "math.sqrt": 0.010980105828190662,
    "np.mod": 0.010980105828190662,
    "checkpoint_dir.iterdir": 0.010971240558747104,
    "tmpdir.get_final": 0.010967332839017418,
    "_MetadataStoreImpl": 0.010957542023385189,
    "get_jax_distributed_client": 0.010947876753323269,
    "_BlockingMetadataStore": 0.010942152328847468,
    "_sanitize_metadata_path": 0.010942152328847468,
    "deserialized_dict.get": 0.0109382475114609,
    "integration_test_utils.create_checkpoint_manager": 0.010932468897123704,
    "train_step": 0.0109324688971237,
    "ReplicaSlice": 0.010931305956978835,
    "metadata_file.write_text": 0.010927070428200503,
    "kwargs.items": 0.010927070428200503,
    "self.write": 0.010927070428200503,
    "metadata_file.read_text": 0.010927070428200503,
    "self.read": 0.010927070428200503,
    "shutdown": 0.010927070428200503,
    "self._is_handleable_leaf": 0.010922284559050156,
    "self._is_handleable_abstract_leaf": 0.010922284559050156,
    "counts.values": 0.010917549621751628,
    "ocp.save_pytree": 0.010912086464402062,
    "Fragments": 0.010910944491269503,
    "map_with_path": 0.010907401336101163,
    "base_pytree_checkpoint_handler.BasePyTreeCheckpointHandler": 0.010907401336101163,
    "base_pytree_checkpoint_handler.BasePyTreeSaveArgs": 0.010907401336101163,
    "base_pytree_checkpoint_handler.BasePyTreeRestoreArgs": 0.010907401336101163,
    "create_array_storage_options_fn": 0.010907401336101163,
    "create_v0_handler": 0.010907401336101163,
    "_get_v0_save_args": 0.010907401336101163,
    "_finalize_async": 0.010907401336101163,
    "create_v0_restore_args": 0.010907401336101163,
    "create_v0_save_args": 0.010907401336101163,
    "self._get_item_directory": 0.01090542670474217,
    "response.result": 0.010903579611264808,
    "_spec_has_metadata": 0.010902691281587768,
    "DictKey": 0.010896430451550636,
    "futures.ThreadPoolExecutor": 0.010895951517264161,
    "futures.as_completed": 0.010895951517264161,
    "_chunk": 0.010895793509742546,
    "client.key_value_try_get": 0.010894344676138293,
    "current_signals.extend": 0.010894344676138293,
    "client.key_value_delete": 0.010894344676138293,
    "self._cb": 0.010894344676138293,
    "self.is_alive": 0.010894344676138293,
    "self.join": 0.010894344676138293,
    "_SignalingThread": 0.010894344676138293,
    "CommitFuture": 0.010894344676138293,
    "synchronization.HandlerAwaitableSignal": 0.010894344676138293,
    "target": 0.010894344676138293,
    "client.blocking_key_value_get": 0.010894344676138293,
    "self._wait_for_signals": 0.010894344676138293,
    "self._set_signals": 0.010894344676138293,
    "values_str.split": 0.010894344676138293,
    "format": 0.010894344676138293,
    "device_map.get": 0.010893597334328679,
    "ts.Transaction": 0.010891029349425532,
    "NestedKeyMetadataEntry": 0.010888373358198325,
    "name.isdigit": 0.010880453837891702,
    "key.split": 0.010879229073939496,
    "integration_test_utils.create_train_state": 0.010873161377374829,
    "_create_tmp_directory": 0.010872462898065859,
    "get_sharding_tensorstore_spec": 0.010870615489514044,
    "deleter.create_checkpoint_deleter": 0.010867809170454748,
    "np.empty": 0.010866247200918154,
    "_unique_barrier_key": 0.01086583527787817,
    "Metadata": 0.01086437682522503,
    "checkpointer.restore": 0.010863833911440218,
    "is_runtime_to_distributed_ids_initialized": 0.010861972108091561,
    "_get_param_info": 0.010860095082565904,
    "_keystr": 0.010860095082565902,
    "tree_difference": 0.010859113107756195,
    "to_flat_dict": 0.010853483699314201,
    "_array_restore_args": 0.010845783272397368,
    "self.wait_if_async": 0.010840847985559775,
    "self.checkpointer": 0.010840847985559773,
    "empty": 0.010833864566853726,
    "subtree.append": 0.010833766704154093,
    "slice_count": 0.01083329370794334,
    "multihost_utils.broadcast_one_to_all": 0.010832592007140669,
    "should_skip_process_sync": 0.010832592007140669,
    "multihost_utils.reached_preemption_sync_point": 0.010832592007140669,
    "_maybe_log_reached_preemption": 0.010832592007140669,
    "multihost_utils.sync_global_devices": 0.010832592007140669,
    "get_barrier_sync_fn": 0.010832592007140669,
    "runtime_to_distributed_process_id": 0.010832592007140669,
    "get_pids_from_devices": 0.010832592007140669,
    "device_ids.split": 0.010832592007140669,
    "finalize_coros.append": 0.01083119585726435,
    "tuple_path_from_keypath": 0.010827673505441804,
    "as_posix": 0.010816395785410143,
    "self.assertEmpty": 0.01081541636240888,
    "test_utils.empty_directory": 0.01081541636240888,
    "snapshot_lib.create_instance": 0.010813381983395822,
    "process_cache.keys": 0.010810130143784031,
    "ref_process_cache.keys": 0.01081013014378403,
    "path.create": 0.010810100220694034,
    "manager2.all_steps": 0.010808548421113149,
    "_ndarray_from_index": 0.010799785139609842,
    "self._get_read_step_directory": 0.010797844537073038,
    "future.NoopFuture": 0.010796338841128605,
    "step_lib.record_saved_duration": 0.010796338841128605,
    "rename": 0.010796338841128605,
    "commit_success_file.write_text": 0.010796338841128605,
    "future.add_to_awaitable_signals_contract": 0.010796338841128605,
    "tmp_dir.get_final": 0.010796338841128605,
    "async_makedir_func": 0.010796338841128605,
    "checkpoint_metadata_store.write": 0.010796338841128605,
    "_get_tmp_directory": 0.010796338841128605,
    "_get_tmp_directory_pattern": 0.010796338841128605,
    "_create_paths": 0.010796338841128605,
    "async_utils.async_is_tmp_checkpoint": 0.010796338841128605,
    "is_async_checkpointer": 0.010794731354771873,
    "_ndarray_to_bytes": 0.010794727527490102,
    "TestClass": 0.010791373977527285,
    "construct_restore_args": 0.010791373977527283,
    "now": 0.010790842443693226,
    "tolist": 0.010790834044788452,
    "construct_checkpoint_args": 0.010788516980692362,
    "manager.close": 0.010787863019913505,
    "arr.reshape": 0.01078111987485671,
    "flatarr.reshape": 0.01078111987485671,
    "arr.tobytes": 0.01078111987485671,
    "np.frombuffer": 0.01078111987485671,
    "_dtype_from_name": 0.01078111987485671,
    "self.is_saving_in_progress": 0.010775553079193374,
    "PyTreeRestore": 0.010775040334639123,
    "as_abstract_type": 0.010772831923239913,
    "sync_fn": 0.010772513044330538,
    "DeviceMetadataMesh": 0.010763661741280161,
    "_sharding_num_replicas": 0.01075445613725399,
    "ReplicaSlices": 0.01075445613725399,
    "fragments.Fragments": 0.01075445613725399,
    "calculate_replica_parallel_axis_and_local_shape": 0.01075445613725399,
    "pick_single_replica": 0.01075445613725399,
    "use_pinned_host_transfer": 0.01075445613725399,
    "get_replica_slices": 0.01075445613725399,
    "slice_in_dim": 0.01075445613725399,
    "fragments.validate_fragments_can_be_stacked": 0.01075445613725399,
    "result.is_degenerate": 0.01075445613725399,
    "numpy_utils.to_hashable_index": 0.01075445613725399,
    "rslices.append": 0.01075445613725399,
    "maybe_pick_replica_parallel": 0.01075445613725399,
    "data.copy_to_host_async": 0.01075445613725399,
    "async_transfer_slice": 0.01075445613725399,
    "fragments.Fragment": 0.01075445613725399,
    "device.addressable_memories": 0.01075445613725399,
    "SliceArgs": 0.01075445613725399,
    "numpy_utils.resolve_slice": 0.01075445613725399,
    "executor.submit": 0.010753548751950203,
    "self.make_global_mesh": 0.010750356273487072,
    "self._validate_and_standardize_args": 0.010748404527364865,
    "timeout_fn": 0.010746671297637601,
    "checkpointer.save": 0.010743282599942998,
    "_process_in_device_slice": 0.010742775838405128,
    "jnp.zeros_like": 0.010742775838405128,
    "with_sharding_constraint": 0.010742775838405128,
    "hbm_memory.get": 0.010742775838405128,
    "get_device_memory": 0.010742775838405128,
    "in_slice": 0.010742775838405128,
    "get_available_memory": 0.010742775838405128,
    "jnp.expand_dims": 0.010742775838405128,
    "out_tree.extend": 0.010742775838405128,
    "jax.block_until_ready": 0.010742775838405128,
    "fake_zero_data": 0.010742775838405128,
    "x.delete": 0.010742775838405128,
    "step": 0.010738824544846096,
    "sync_global_processes": 0.010737267384667857,
    "DeviceMetadata": 0.010730967828177113,
    "_extend_list": 0.010726867554887942,
    "is_gcs_path": 0.010726471570866952,
    "f.is_degenerate": 0.010723506716333524,
    "reserved_bytes": 0.010719532958992398,
    "get_byte_limiter": 0.01071802948658065,
    "PositionalSharding": 0.010717997772536852,
    "NamedShardingMetadata.from_jax_sharding": 0.010717997772536852,
    "NamedShardingMetadata.from_deserialized_dict": 0.010717997772536852,
    "devices.tolist": 0.010717997772536852,
    "to_jax_device_mesh": 0.010717997772536852,
    "SingleDeviceShardingMetadata.from_jax_sharding": 0.010717997772536852,
    "SingleDeviceShardingMetadata.from_deserialized_dict": 0.010717997772536852,
    "DeviceMetadataMesh.from_jax_mesh": 0.010717997772536852,
    "DeviceMetadataMesh.from_dict": 0.010717997772536852,
    "PositionalShardingMetadata.from_jax_sharding": 0.010717997772536852,
    "PositionalShardingMetadata.from_deserialized_dict": 0.010717997772536852,
    "from_serialized_string": 0.010717997772536852,
    "serialized_string.item": 0.010717997772536852,
    "_init_step_name_format": 0.010709313771768567,
    "t.read": 0.010709230036937759,
    "a.items": 0.010705787809511518,
    "b.items": 0.010705787809511518,
    "_maybe_raise_reserved_item_error": 0.010693330466375052,
    "_sleep_and_maybe_exit": 0.01069225227694576,
    "diffs.update": 0.01068838320422942,
    "name_format.find_all": 0.010681550806246411,
    "self.save_args_cls": 0.010676251151991636,
    "self.restore_args_cls": 0.010676251151991636,
    "flatten_one_level": 0.010675838994828638,
    "is_leaf": 0.010675838994828638,
    "tree_flatten_with_path_one_level": 0.010675838994828638,
    "checkpoint_handler.load": 0.010669978250942706,
    "to_json": 0.010668479447866645,
    "_wait_for_new_checkpoint": 0.010667335643029031,
    "get_snapshot_dir_from_step_dir": 0.010667335643029031,
    "snapshot_impl.create_snapshot": 0.010667335643029031,
    "snapshot_dir.iterdir": 0.010667335643029031,
    "step_name_format.find_step": 0.010667335643029031,
    "step_dir.exists": 0.010667335643029031,
    "step_name_format.build_name": 0.010667335643029031,
    "utils.checkpoint_steps": 0.010667335643029031,
    "_reached_desired_step": 0.010667335643029031,
    "_release_snapshot": 0.010667335643029031,
    "wait_for_new_checkpoint": 0.010667335643029031,
    "snapshot_dir.mkdir": 0.010667335643029031,
    "_snapshot_checkpoint": 0.010667335643029031,
    "dtype.type": 0.010667335643029031,
    "dtype": 0.010667335643029031,
    "_python_type_from_dtype": 0.010667335643029031,
    "self._get_array_metadatas": 0.010665672148743584,
    "name_format.find_step": 0.010664521409653417,
    "from_flattened_with_keypath": 0.010663420227521859,
    "isinstance_of_namedtuple": 0.010663420227521859,
    "ls.append": 0.010663420227521859,
    "leaves_equal": 0.010663420227521859,
    "sep.join": 0.010663420227521859,
    "flat_dict.values": 0.010663420227521859,
    "_param_name_from_keypath": 0.010663420227521859,
    "all_leaves": 0.010663420227521859,
    "flat_structure.keys": 0.010663420227521859,
    "diffs.get": 0.010663420227521859,
    "object.__setattr__": 0.010658796131286178,
    "kwargs.values": 0.010658456333275348,
    "save_arg_cls": 0.010658456333275348,
    "restore_arg_cls": 0.010658456333275348,
    "next_operation_id": 0.010658456333275348,
    "self._restore": 0.010658456333275348,
    "is_blocking_writer": 0.010658456333275348,
    "metadata_from_temporary_paths": 0.010658456333275348,
    "step_metadata_serialization.serialize_for_update": 0.010658456333275348,
    "P": 0.010654295075404215,
    "_get_unique_registered_items_and_handlers": 0.010650883970761365,
    "manager2.latest_step": 0.010647321899247789,
    "np.all": 0.010646547792614827,
    "validate_fragments_can_be_stacked": 0.010646547792614827,
    "self.offset_by": 0.010646547792614827,
    "_normalize": 0.010646547792614827,
    "np_utils.slice_shape": 0.010646547792614827,
    "_is_full": 0.010646547792614827,
    "np_utils.resolve_slice": 0.010646547792614827,
    "np_utils.int_tuple_from_slice": 0.010646547792614827,
    "np_utils.pretty_nd_slice": 0.010646547792614827,
    "f.nbytes_astype": 0.010646547792614827,
    "addressable_shards": 0.010646547792614827,
    "self.slice_of_value": 0.010646547792614827,
    "d.item": 0.010646547792614827,
    "sharding.addressable_devices_indices_map": 0.010646547792614827,
    "fragment.slice": 0.010646547792614827,
    "self._file_name": 0.01064546058021887,
    "manager.all_steps": 0.01064038664252816,
    "type_handlers.register_type_handler": 0.010634756955125979,
    "swap_slices_in_mesh": 0.010624025694759169,
    "args.values": 0.010622416991731708,
    "original_args.items": 0.010622416991731708,
    "checkpoint_manager.determine_default_item_mode_from_args": 0.010622416991731708,
    "self._get_mesh_consistent_args": 0.010622416991731708,
    "self._get_mesh_consistent_result": 0.010622416991731708,
    "item_metadata": 0.010622416991731708,
    "ReplicatorCheckpointManagerOptions": 0.010622416991731708,
    "removeprefix": 0.010621470514554159,
    "process_index.isdigit": 0.010621470514554159,
    "PathResolver": 0.010621470514554159,
    "SerDeserializer": 0.010621470514554159,
    "get_write_file_path": 0.010621470514554159,
    "get_read_file_paths": 0.010621470514554159,
    "process_cache.items": 0.010621470514554159,
    "validator.validate_all_array_metadatas": 0.010621470514554159,
    "checkpoint_dir.glob": 0.010621470514554159,
    "array_metadata_lib.SerializedArrayMetadata": 0.010621470514554159,
    "self._maybe_create_base_dir": 0.010621470514554159,
    "getter_coros.append": 0.010621470514554159,
    "get_process_index": 0.010621470514554159,
    "self._validate_process_count": 0.010621470514554159,
    "self._validate_param_count": 0.010621470514554159,
    "self._validate_params": 0.010621470514554159,
    "self._validate_metadata": 0.010621470514554159,
    "self._to_dict": 0.010621470514554159,
    "asyncio.wait_for": 0.010621470514554159,
    "array_metadata.get": 0.010621470514554159,
    "wait_for_base_dir_creation": 0.010621470514554159,
    "_run_awaitable": 0.010611553927435421,
    "glob": 0.010609102055078926,
    "PyTreeSave": 0.010606393487598138,
    "_add_to_handler_registry_from_global_registry": 0.010604743169548212,
    "float": 0.010604681984956406,
    "_log_array_tree": 0.010599032143575965,
    "name.split": 0.010593245032536003,
    "handler_with_options": 0.010585458643717799,
    "checkpoint_handler.restore": 0.010584864470879586,
    "flags.DEFINE_string": 0.010581373135745944,
    "flags.DEFINE_integer": 0.010581373135745944,
    "_replicate_tree": 0.010581373135745944,
    "open_ops.append": 0.010580345026781509,
    "AsyncOptions": 0.010580014059704946,
    "ocp.load_checkpointables": 0.010579489562585987,
    "self.reached_preemption": 0.01057848436670101,
    "testclass.assertEqual": 0.010575290143375052,
    "isdigit": 0.010570946375273824,
    "re.compile": 0.010569899027029993,
    "persistent_directory.mkdir": 0.010569899027029993,
    "local_directory.mkdir": 0.010569899027029993,
    "integration_test_utils.create_global_mesh": 0.010569899027029993,
    "persistent_directory.exists": 0.010569899027029993,
    "app.run": 0.010569899027029993,
    "multihost.is_distributed_to_device_ids_initialized": 0.010569899027029993,
    "simple_restore": 0.010569899027029993,
    "create_directories": 0.010569899027029993,
    "save_and_restore": 0.010569899027029993,
    "self._sort_checkpoints_by_metrics": 0.0105693169876381,
    "txn.commit_async": 0.010568590381929158,
    "entry.to_json": 0.010567623275343501,
    "self._existing_items": 0.01056601932929991,
    "ocp.save_pytree_async": 0.010562311804805874,
    "tmp_checkpoints": 0.010557026678304441,
    "per_slice_values.items": 0.010554678621875467,
    "tree_type": 0.010549525433389578,
    "self.ocdbt_checkpoint_handler": 0.010542971371911512,
    "shardings.append": 0.010528081879033332,
    "args.PyTreeSave": 0.010523760294172093,
    "build_step_path": 0.010518263433573581,
    "step_prefix_with_underscore": 0.010509618460416214,
    "ckpt_path.startswith": 0.010509200294838279,
    "LimitInFlightBytes": 0.010509200294838279,
    "estimate_read_memory_footprint": 0.010509200294838279,
    "sharding.shard_shape": 0.010509200294838279,
    "dirname": 0.010509200294838279,
    "asyncio.Condition": 0.010509200294838279,
    "UnlimitedInFlightBytes": 0.010509200294838279,
    "byte_limiter.wait_for_bytes": 0.010509200294838279,
    "async_serialize_from_host": 0.010509200294838279,
    "estimate_write_memory_footprint": 0.010509200294838279,
    "write_fragment": 0.010509200294838279,
    "out.astype": 0.010509200294838279,
    "intersect": 0.010509200294838279,
    "_read_array_index_and_device_put": 0.010509200294838279,
    "read_and_create_array": 0.010509200294838279,
    "basename": 0.010509200294838279,
    "byte_limiter.release_bytes": 0.010509200294838279,
    "result.append": 0.010509200294838279,
    "_get_device_to_index_map": 0.010509200294838279,
    "np_utils.from_hashable_index": 0.010509200294838279,
    "local_indices_devices_map.items": 0.010509200294838279,
    "asyncio.Lock": 0.010509200294838279,
    "wait_for": 0.010509200294838279,
    "rslices_on_host.to_fragments": 0.010509200294838279,
    "ts.IndexDomain": 0.010509200294838279,
    "ts.IndexTransform": 0.010509200294838279,
    "_read_shard": 0.010509200294838279,
    "Exception": 0.010509200294838279,
    "tree.items": 0.010509200294838279,
    "ts.array": 0.010509200294838279,
    "np_utils.to_hashable_index": 0.010509200294838279,
    "ocp.Context": 0.010508002997322343,
    "handler_registry.get": 0.010497384675377856,
    "args.Composite": 0.010480854742942573,
    "restore_handler.restore": 0.010478304965748218,
    "_is_host_for_primary_replica": 0.010473119777241779,
    "get_not_none": 0.01046680321361808,
    "e.add_note": 0.010459803962293847,
    "args.PyTreeRestore": 0.010456370823173348,
    "self._read_aggregate_file": 0.010451617267322797,
    "commit_future.result": 0.010449545545312418,
    "on_commit_callback": 0.010449545545312418,
    "_AsyncManager": 0.010449545545312418,
    "checkpointer.construct_checkpoint_args": 0.010449545545312418,
    "commit_ops.extend": 0.010449545545312418,
    "self._make_on_commit_callback": 0.010449545545312418,
    "start_async_commit": 0.010449545545312418,
    "_background_wait_for_commit_futures": 0.010449545545312418,
    "checkpointer.get_legacy_handler_wrapper": 0.010449545545312418,
    "_on_commit_callback": 0.010449545545312418,
    "commit_ops.append": 0.010449545545312418,
    "self._save": 0.010449545545312418,
    "self._post_finalization_callback": 0.010449545545312418,
    "future.remove_all_awaitable_signals": 0.010449545545312418,
    "_add_deadline_exceeded_notes": 0.010449545545312418,
    "ocp.pytree_metadata": 0.010439832707363775,
    "ocp.checkpointables_metadata": 0.010439832707363775,
    "create_mixed_format_pytree": 0.010435158145484185,
    "save_interval_policies.append": 0.010434036289816578,
    "_is_checkpoint_finalized_ignore_error": 0.010430997356061008,
    "self.build_name": 0.010429460090329974,
    "ScalarHandler": 0.01042539438629372,
    "ArrayHandler": 0.01042539438629372,
    "NumpyHandler": 0.010425394386293719,
    "write_coros.append": 0.010425271725564612,
    "_print_ts_debug_data": 0.010422034434115497,
    "self.create_mixed_format_pytree": 0.01042179557417628,
    "self._get_save_directory": 0.010415611591315328,
    "StandardCheckpointHandler": 0.010402108887330478,
    "self.assertNotEqual": 0.010402108887330478,
    "standard_checkpoint_handler._construct_restore_args": 0.010402108887330478,
    "expected_restore_args.keys": 0.010402108887330478,
    "restore_args.keys": 0.010402108887330478,
    "DLL": 0.010402108887330478,
    "from_dict": 0.010402108887330478,
    "size": 0.010398501823207352,
    "ts_utils.build_kvstore_tspec": 0.010396665532585852,
    "args_lib.PyTreeRestore": 0.010392439381506864,
    "self._get_per_slice_local_steps": 0.010377165357555816,
    "directory.as_posix": 0.010376033589000078,
    "_open_kv_store": 0.010376033589000078,
    "utils.is_pathways_backend": 0.010373722470201437,
    "ocp.save_checkpointables": 0.010373179176066633,
    "LocalCheckpointManager": 0.010373027502726747,
    "RestoreTransform": 0.01037280128061225,
    "create_with_handlers": 0.010364672322929381,
    "_pjitted_value_fn": 0.010362768423798484,
    "self._get_param_infos": 0.01036160130545107,
    "item_directory.get": 0.01035963552500504,
    "loaded.keys": 0.010355572371705294,
    "_fill_missing_save_or_restore_args": 0.010354152465497892,
    "self.validate_restore": 0.010354086694609872,
    "self._properties": 0.01034953330227499,
    "tree_metadata_entries.append": 0.010342250281572004,
    "self._read_metadata_file": 0.010341138516174556,
    "re.sub": 0.010337317865224118,
    "_log_io_metrics": 0.010336289549453861,
    "self.save_and_wait": 0.010334093598292427,
    "self.load_and_wait": 0.010334093598292427,
    "InternalTreeMetadata": 0.010326094085727835,
    "name_format.build_name": 0.010320226133185752,
    "local_checkpoint_data_debugging.print_devices_indices_debug_info": 0.0103158816354065,
    "args.keys": 0.010315732294405099,
    "manifest_file.exists": 0.01031541529906853,
    "_common_values_per_slice": 0.010311602814702012,
    "self._load_checkpoint_infos": 0.01031018538379618,
    "step_from_checkpoint_name": 0.01030159759492453,
    "KeyMetadataEntry": 0.010301307955801968,
    "InternalTreeMetadataEntry": 0.010301307955801968,
    "json_dict.get": 0.010301307955801968,
    "aux_data.pop": 0.010301307955801968,
    "_process_local_to_global": 0.01030065758396637,
    "build_step_metadatas": 0.010298252648654097,
    "tree_utils.is_sequence_key": 0.010292634498885457,
    "_TreeMetadataImpl.build": 0.010292634498885457,
    "tree_utils.is_dict_key": 0.010292634498885457,
    "tree_utils.from_flattened_with_keypath": 0.010292634498885457,
    "self.as_nested_tree": 0.010292634498885457,
    "batched_param_infos.items": 0.010292634498885457,
    "self._validate_tree_type": 0.010292634498885457,
    "self.tree_flatten_with_keys": 0.010292634498885457,
    "KeyMetadataEntry.from_json": 0.010292634498885457,
    "ValueMetadataEntry.from_json": 0.010292634498885457,
    "keypath.append": 0.010292634498885457,
    "tree_rich_types.value_metadata_tree_to_json_str": 0.010292634498885457,
    "tree_rich_types.value_metadata_tree_from_json_str": 0.010292634498885457,
    "types.ParamInfo": 0.010292634498885457,
    "metadata_ops.append": 0.010292634498885457,
    "batched_keypaths.values": 0.010292634498885457,
    "tree_utils.issubclass_of_namedtuple": 0.010292634498885457,
    "result.pop": 0.010292634498885457,
    "KeyType.from_json": 0.010292634498885457,
    "NestedKeyMetadataEntry.from_json": 0.010292634498885457,
    "KeyMetadataEntry.build": 0.010292634498885457,
    "ValueMetadataEntry.build": 0.010292634498885457,
    "_keypath_from_key_type": 0.010292634498885457,
    "InternalTreeMetadataEntry.build": 0.010292634498885457,
    "InternalTreeMetadataEntry.from_json": 0.010292634498885457,
    "_get_key_metadata_type": 0.010292634498885457,
    "entry.jax_keypath": 0.010292634498885457,
    "value_metadata.Metadata": 0.010292634498885457,
    "test_tree_utils.MuNu": 0.010289196832119037,
    "test_tree_utils.EmptyNamedTuple": 0.010289196832119037,
    "flagsaver.flagsaver": 0.010288443925052952,
    "values.items": 0.010284647577876132,
    "register_handler": 0.010284647577876132,
    "abstract_pytree.pop": 0.010284647577876132,
    "handler_utils.Baz": 0.010284647577876132,
    "PyTreeOptions": 0.010284647577876132,
    "handler_utils.AbstractFoo": 0.010284647577876132,
    "flat_structure.items": 0.010283153565053788,
    "self._get_or_set_handler": 0.01027669661491728,
    "save_input_provider": 0.010276532854207512,
    "test_tree_utils.NamedTupleWithNestedAttributes": 0.01027233533489233,
    "AttributeError": 0.010269878395666693,
    "self.is_world_readable": 0.010268310089990587,
    "_is_empty_value": 0.010268117284204455,
    "flat_transforms.items": 0.010259858323609868,
    "_concurrent_bytes": 0.010259858323609868,
    "_get_impl_save_args": 0.010259858323609868,
    "batched_serialization_requests": 0.010257866622330946,
    "self._configure_checkpointer_from_handler_registry": 0.010252707812401868,
    "self._get_all_registered_and_unregistered_items_and_handlers": 0.010252169817655471,
    "BasePyTreeSaveArgs": 0.010251599363015278,
    "value.reshape": 0.010251599363015278,
    "MsgpackHandler": 0.010251599363015278,
    "base_pytree_checkpoint_handler.batched_serialization_requests": 0.010251599363015278,
    "flat_aggregate.keys": 0.010251599363015278,
    "self._get_internal_metadata": 0.010251599363015278,
    "_get_restore_parameters": 0.010251599363015278,
    "_find_matching_input_args": 0.010251599363015278,
    "tree_utils.deserialize_tree": 0.010251599363015278,
    "_multi_value_fns_with_args": 0.010251599363015278,
    "transform_utils.apply_transformations": 0.010251599363015278,
    "BasePyTreeCheckpointHandler": 0.010251599363015278,
    "utils.all_leaves_are_placeholders": 0.010251599363015278,
    "legacy_transform_fn": 0.010251599363015278,
    "_transform_checkpoint": 0.010251599363015278,
    "_read_metadata_file": 0.010251599363015278,
    "arr.astype": 0.010251599363015278,
    "_try_array_cast": 0.010251599363015278,
    "_maybe_shard_array": 0.010251599363015278,
    "utils.pytree_structure": 0.010251599363015278,
    "_has_use_fallback_transform": 0.010251599363015278,
    "utils.leaf_is_placeholder": 0.010251599363015278,
    "flat_value_metadatas.keys": 0.010251599363015278,
    "_process_metadata_and_aggregate_leaves": 0.010251599363015278,
    "_StandardNameFormat": 0.010250638054415315,
    "_CompositeNameFormat": 0.010250638054415315,
    "startswith": 0.010250638054415315,
    "islink": 0.010250638054415315,
    "fromtimestamp": 0.010250638054415315,
    "uncommitted_step_path.exists": 0.010250638054415315,
    "re.search": 0.010250638054415315,
    "match.groups": 0.010250638054415315,
    "self._build_metadata": 0.010250638054415315,
    "build_name": 0.010250638054415315,
    "is_checkpoint_finalized": 0.010250638054415315,
    "_is_legacy_step_checkpoint": 0.010250638054415315,
    "_is_legacy_finalized_step_checkpoint": 0.010250638054415315,
    "uncommitted_name.startswith": 0.010250638054415315,
    "step_path.exists": 0.010250638054415315,
    "steps.sort": 0.010250638054415315,
    "paths_to_step_dict.keys": 0.010250638054415315,
    "self._find_all_with_single_host_load_and_broadcast": 0.010250638054415315,
    "read_name_format.find_all": 0.010250638054415315,
    "path.as_posix": 0.010250638054415315,
    "standard_name_format": 0.010250638054415315,
    "is_tmp_checkpoint": 0.010250638054415315,
    "stat": 0.010250638054415315,
    "read_name_format.find_step": 0.010250638054415315,
    "fs.items": 0.010250638054415315,
    "checkpoint_steps_paths": 0.010250638054415315,
    "found_paths.add": 0.010250638054415315,
    "errors.append": 0.010250638054415315,
    "tmp_match.group": 0.010250638054415315,
    "steps.append": 0.010250638054415315,
    "parameterized.named_parameters": 0.010248015921626719,
    "MLP": 0.010248015921626719,
    "type_handler_registry.add": 0.010248015921626719,
    "InterceptingValidator": 0.010248015921626719,
    "checkpointer.wait_until_finished": 0.010248015921626719,
    "gfile.Exists": 0.010248015921626719,
    "gfile.Stat": 0.010248015921626719,
    "TrainState.create": 0.010248015921626719,
    "init": 0.010248015921626719,
    "MyCheckpointHandler": 0.010248015921626719,
    "IncompleteArrayMetadataSerDeserializer": 0.010248015921626719,
    "array_metadata_validator.maybe_raise_error": 0.010248015921626719,
    "expected_restored_provider": 0.010248015921626719,
    "validate_all_array_metadatas": 0.010248015921626719,
    "test_tree_utils.MyEmptyChex": 0.010248015921626719,
    "kept_checkpoints.add": 0.01024115358848136,
    "_get_batch_memory_size": 0.010241014020982212,
    "serialization.async_deserialize": 0.010240237096438249,
    "items_to_handlers.get": 0.010238092833630492,
    "self._get_metadata_base": 0.010226916026065718,
    "self.setup_pytree": 0.010219168982808266,
    "PyTreeHandler": 0.010214297601995905,
    "_get_persistent_options": 0.010212720520681806,
    "self._get_json_tspec_read": 0.010206737670257596,
    "_LegacyCheckpointHandlerWrapper": 0.010203652006053153,
    "_AsyncLegacyCheckpointHandlerWrapper": 0.010203652006053153,
    "CompositeOptions": 0.010203652006053153,
    "self._get_item_temporary_paths": 0.010203652006053153,
    "commit_futures.extend": 0.010203652006053153,
    "CompositeResults": 0.010203652006053153,
    "item_and_handers.append": 0.010203652006053153,
    "atomicity_defaults.get_item_default_temporary_path_class": 0.010203652006053153,
    "self._get_item_temporary_directory": 0.010203652006053153,
    "commit_futures.append": 0.010203652006053153,
    "CompositeItemMetadata": 0.010203652006053153,
    "handler.finalize": 0.010203652006053153,
    "items_and_handlers.items": 0.010203652006053153,
    "items_and_handlers.append": 0.010203652006053153,
    "item_names_without_registered_handlers.remove": 0.010203652006053153,
    "item_handlers.get": 0.010203652006053153,
    "self._get_item_handlers": 0.010203652006053153,
    "item_tmp_dir.get": 0.010203652006053153,
    "tmp_dir.get": 0.010203652006053153,
    "handler.async_save": 0.010203652006053153,
    "restore_ckpt_args_cls": 0.010203652006053153,
    "self._get_item_metadata": 0.010203652006053153,
    "handler_type_registry.get_handler_type": 0.010203652006053153,
    "async_handler_save_fn": 0.010203652006053153,
    "get_cast_tspec_deserialize": 0.010185073088498848,
    "humanize.naturaldelta": 0.01017884625946876,
    "grouped.values": 0.01017884625946876,
    "array_metadata_store_lib.resolve_array_metadata_store": 0.01017884625946876,
    "self.get_param_names": 0.01017884625946876,
    "flat_metadata.keys": 0.01017884625946876,
    "self._write_metadata_file": 0.01017884625946876,
    "_default_sizeof_values": 0.01017884625946876,
    "_BatchRequest": 0.01017884625946876,
    "set_primary_host": 0.01017884625946876,
    "save_futures.append": 0.01017884625946876,
    "future.ChainedFuture": 0.01017884625946876,
    "tree_utils.tree_difference": 0.01017884625946876,
    "type_handlers.any_jax_array_param_info": 0.01017884625946876,
    "internal_tree_metadata.as_custom_metadata": 0.01017884625946876,
    "merge_ocdbt_per_process_files": 0.01017884625946876,
    "self._finalize_async": 0.01017884625946876,
    "handler.memory_size": 0.01017884625946876,
    "tree_utils.is_empty_node": 0.01017884625946876,
    "type_handlers.represents_jax_array": 0.01017884625946876,
    "build": 0.01017884625946876,
    "self._get_param_infos_with_write_shape": 0.01017884625946876,
    "types.get_param_typestr": 0.01017884625946876,
    "self._write_metadata_after_commits": 0.01017884625946876,
    "metadata_content.to_json": 0.01017884625946876,
    "array_metadata_store_lib.validate_all_array_metadatas": 0.01017884625946876,
    "atomicity._get_tmp_directory": 0.010177260081549027,
    "checkpoint_args.register_with_handler": 0.010169752022787429,
    "create_tmp_directory": 0.010169752022787429,
    "testclass.assertIsInstance": 0.010162394125201065,
    "testclass.assertSameElements": 0.010162394125201065,
    "multislice.local_slice_devices": 0.010162394125201065,
    "_replica_devices": 0.010162394125201065,
    "type_handlers.SingleReplicaArrayRestoreArgs": 0.010162394125201065,
    "np.ndenumerate": 0.010162394125201065,
    "_find_idx": 0.010162394125201065,
    "TestLimitInFlightBytes": 0.010162394125201065,
    "replica_slices.calculate_replica_parallel_axis_and_local_shape": 0.010162394125201065,
    "tmp_dir.exists": 0.010162394125201065,
    "tmp_dir.mkdir": 0.010162394125201065,
    "expected_flat.keys": 0.010162394125201065,
    "actual_flat.keys": 0.010162394125201065,
    "setup_pytree": 0.010162394125201065,
    "slice_devices.append": 0.010162394125201065,
    "np.transpose": 0.010162394125201065,
    "directory.is_dir": 0.010162394125201065,
    "type_handlers.register_standard_handlers_with_options": 0.010162394125201065,
    "name.startswith": 0.010162394125201065,
    "testclass.assertGreaterEqual": 0.010162394125201065,
    "metadata_store.write": 0.010162394125201065,
    "testclass.assertTrue": 0.010162394125201065,
    "print_directory": 0.010162394125201065,
    "p.rmtree": 0.010162394125201065,
    "p.unlink": 0.010162394125201065,
    "test_func": 0.010162394125201065,
    "wait_for_bytes": 0.010162394125201065,
    "release_bytes": 0.010162394125201065,
    "tmp_dir.rmtree": 0.010162394125201065,
    "SystemError": 0.010162394125201065,
    "_get_test_wrapper_function": 0.010162394125201065,
    "atomicity.CommitFileTemporaryPath": 0.010162394125201065,
    "atomicity.AtomicRenameTemporaryPath": 0.010162394125201065,
    "self.id": 0.010162394125201065,
    "multihost.runtime_to_distributed_process_id": 0.010162394125201065,
    "check_input_arguments": 0.010153689893258273,
    "self._background_serialize": 0.010143127900050815,
    "metadata_path.exists": 0.01014178070381298,
    "metadata_path.read_text": 0.01014178070381298,
    "self._root_metadata_file_path": 0.010133145663818953,
    "self.save_local_all_and_remove_partial": 0.01012769370816414,
    "test_utils.get_fake_global_mesh_for_slices": 0.010120756393724008,
    "manager2.save": 0.010120756393724008,
    "manager2.wait_until_finished": 0.010120756393724008,
    "checkpoint_manager._common_values_per_slice": 0.010120756393724008,
    "manager.should_save": 0.010120756393724008,
    "checkpoint_manager._global_max": 0.010120756393724008,
    "pcm_restore.assert_not_called": 0.010120756393724008,
    "mngr.save": 0.010120756393724008,
    "mngr.wait_until_finished": 0.010120756393724008,
    "checkpoint_manager._get_global_broadcast_fn": 0.010120756393724008,
    "restore_handler.load": 0.010108996040773647,
    "set_if_none": 0.010104202208289188,
    "interval_preserved_checkpoints.append": 0.010098815253629548,
    "self._get_array_write_spec": 0.010088019966882822,
    "_array_metadata_from_tensorstore": 0.010087036546071673,
    "_get_single_slice_sharding": 0.010081885083935852,
    "args_dict.keys": 0.010079079208914871,
    "_assert_parameter_files_exist": 0.010077081304763527,
    "_global_max": 0.01007663949099968,
    "self._validate_args": 0.010051137303429514,
    "t.is_alive": 0.010048093253434543,
    "unique_barrier_key": 0.010034695958632869,
    "ts_utils.add_ocdbt_write_options": 0.010015595527419131,
    "get_process_index_for_subdir": 0.010004150723546108,
    "check_array_values": 0.009984448287463303,
    "_get_args_for_key": 0.009978251170256885,
    "_determine_default_item_mode_from_directory": 0.009974749507964368,
    "_build_array_write_spec": 0.009951099250678273,
    "get_json_tspec_read": 0.009951099250678273,
    "t.with_transaction": 0.009924113055888176,
    "self._get_json_tspec": 0.009917011626031522,
    "step_lib.checkpoint_steps": 0.009910856709944313,
    "parent_dir.as_posix": 0.009902740512193604,
    "MultiprocessingOptions": 0.009895880865793596,
    "InvalidShardingError": 0.009891565945318464,
    "sharding_string.item": 0.009890653742953162,
    "GLOBAL_TYPE_HANDLER_REGISTRY.add": 0.009888514824981933,
    "self.should_validate_metadata": 0.009887322914419919,
    "_get_json_tspec": 0.00987960202967152,
    "arrays.append": 0.00987960202967152,
    "create_type_handler_registry": 0.009875145632016314,
    "ts_utils.build_zarr_shard_and_chunk_metadata": 0.009875145632016314,
    "ts_utils.ArrayWriteSpec": 0.009875145632016314,
    "directory.glob": 0.009875145632016314,
    "decode": 0.009875145632016314,
    "tree_reduce": 0.009875145632016314,
    "_TypeHandlerRegistryImpl": 0.009875145632016314,
    "GLOBAL_TYPE_HANDLER_REGISTRY.get": 0.009875145632016314,
    "GLOBAL_TYPE_HANDLER_REGISTRY.has": 0.009875145632016314,
    "ts_utils.calculate_chunk_byte_size": 0.009875145632016314,
    "ts_kv_store.list": 0.009875145632016314,
    "ts_param.decode": 0.009875145632016314,
    "ts_param.endswith": 0.009875145632016314,
    "copy_ops.append": 0.009875145632016314,
    "multislice.get_primary_replica_ids_and_pids": 0.009875145632016314,
    "memory_size": 0.009875145632016314,
    "with_zarray.add": 0.009875145632016314,
    "without_zarray.add": 0.009875145632016314,
    "child.experimental_copy_range_to": 0.009875145632016314,
    "_validate_params": 0.009875145632016314,
    "Spec": 0.009875145632016314,
    "t.write": 0.009875145632016314,
    "ScalarMetadata": 0.009875145632016314,
    "r.item": 0.009875145632016314,
    "base64.urlsafe_b64encode": 0.009875145632016314,
    "sharding_open_ops.append": 0.009875145632016314,
    "array_metadatas.append": 0.009875145632016314,
    "sharding_metadata_txn.commit_async": 0.009875145632016314,
    "deserialize_ops.append": 0.009875145632016314,
    "write_sizes.append": 0.009875145632016314,
    "read_sizes.append": 0.009875145632016314,
    "self._validate_sharding_and_get_primary_replica_processes": 0.009875145632016314,
    "single_replica_shardings.append": 0.009875145632016314,
    "StringMetadata": 0.009875145632016314,
    "tensorstore.read": 0.009875145632016314,
    "self._convert_to_string": 0.009875145632016314,
    "f": 0.009875145632016314,
    "self.get": 0.009875145632016314,
    "StringHandler": 0.009875145632016314,
    "PlaceholderHandler": 0.009875145632016314,
    "parent.with_transaction": 0.009875145632016314,
    "param_name.encode": 0.009875145632016314,
    "sharding_metadata_value.to_serialized_string": 0.009875145632016314,
    "serialization.async_serialize_from_host": 0.009875145632016314,
    "ocdbt_transaction.commit_async": 0.009875145632016314,
    "array_metadatas_cache.get": 0.009875145632016314,
    "self._parse_array_metadatas": 0.009875145632016314,
    "v.encode": 0.009875145632016314,
    "self._open_and_write": 0.009875145632016314,
    "a.restore_type": 0.009875145632016314,
    "represents_jax_array": 0.009875145632016314,
    "sharding_metadata.from_serialized_string": 0.009875145632016314,
    "self._serialize_sharding": 0.009875145632016314,
    "replica_slices.get_replica_slices": 0.009875145632016314,
    "sharding_tensorstore.read": 0.009875145632016314,
    "array_metadatas.values": 0.009875145632016314,
    "warnings.warn": 0.009875145632016314,
    "shard_size": 0.009875145632016314,
    "sharding_metadata.get_sharding_or_none": 0.009875145632016314,
    "self._maybe_get_default_item": 0.009873206798732046,
    "CheckpointInfo": 0.009868696553662524,
    "multislice.primary_process_in_slice": 0.009850473220993637,
    "per_process_values.items": 0.00984630811142521,
    "global_broadcast_fn": 0.00984630811142521,
    "extend": 0.00984630811142521,
    "collections.Counter": 0.00984630811142521,
    "np.delete": 0.00984630811142521,
    "sdas.append": 0.00984630811142521,
    "result_arr.addressable_data": 0.00984630811142521,
    "_pad_steps": 0.00984630811142521,
    "slice_devices.reshape": 0.00984630811142521,
    "self._cleanup_local_tmp_directories": 0.00984630811142521,
    "_get_global_broadcast_fn": 0.00984630811142521,
    "_LocalCheckpointManager": 0.00984630811142521,
    "multihost.reached_preemption": 0.00984630811142521,
    "per_slice_steps.items": 0.00984630811142521,
    "step_statistics.EmergencyRestoreStepStatistics": 0.00984630811142521,
    "self._find_slice_with_complete_local_checkpoint": 0.00984630811142521,
    "self._restore_from_persistent": 0.00984630811142521,
    "checkpoint_manager._create_root_directory": 0.00984630811142521,
    "barrier_id.get_counter": 0.00984630811142521,
    "per_process_values.keys": 0.00984630811142521,
    "_all_devices_excepting_slice": 0.00984630811142521,
    "self._make_persistent_checkpoint_manager": 0.00984630811142521,
    "self._make_local_checkpoint_manager": 0.00984630811142521,
    "local_state_handler.restore": 0.00984630811142521,
    "self._restore_from_local": 0.00984630811142521,
    "np.max": 0.00984630811142521,
    "self.local_host_steps": 0.00984630811142521,
    "per_slice_steps.values": 0.00984630811142521,
    "_persistent_checkpoint_handler": 0.00984630811142521,
    "set.union": 0.00984630811142521,
    "pcm.restore": 0.00984630811142521,
    "_MultisliceCheckpointManager": 0.00984630811142521,
    "np.sum": 0.00984630811142521,
    "local_checkpoint_data_debugging.print_chunk_debug_info": 0.00984630811142521,
    "per_slice_local_steps.values": 0.00984630811142521,
    "save_decision_policy_lib.PreemptionCheckpointingPolicy": 0.009839348992509725,
    "self._configure_checkpointer_common": 0.009829247234674718,
    "save_decision_policy_lib.AnySavePolicy": 0.009825294384969482,
    "metrics_item_path.exists": 0.009825294384969482,
    "threading.local": 0.009825294384969482,
    "self.should_save_fn": 0.009825294384969482,
    "checkpoint_info.CheckpointInfos": 0.009825294384969482,
    "threading_lib.Ref": 0.009825294384969482,
    "self._maybe_save_root_metadata": 0.009825294384969482,
    "latest": 0.009825294384969482,
    "utils.reached_preemption": 0.009825294384969482,
    "checkpoint_info.CheckpointInfo": 0.009825294384969482,
    "save_decision_policy_lib.DecisionContext": 0.009825294384969482,
    "self._get_write_step_directory": 0.009825294384969482,
    "self._add_checkpoint_info": 0.009825294384969482,
    "step_statistics.RestoreStepStatistics": 0.009825294384969482,
    "JsonCheckpointHandler": 0.009825294384969482,
    "find_all": 0.009825294384969482,
    "checkpoints.empty": 0.009825294384969482,
    "checkpoint.root_metadata_file_path": 0.009825294384969482,
    "self._get_root_metadata": 0.009825294384969482,
    "utils.cleanup_tmp_directories": 0.009825294384969482,
    "self._get_interval_preserved_checkpoints": 0.009825294384969482,
    "kept_checkpoints.update": 0.009825294384969482,
    "self._wait_for_checkpointers": 0.009825294384969482,
    "self._finalize_checkpoint": 0.009825294384969482,
    "self._create_thread_safe_barrier_sync_fn": 0.009825294384969482,
    "_ShouldSaveFnPolicy": 0.009825294384969482,
    "save_decision_policy_lib.InitialSavePolicy": 0.009825294384969482,
    "_get_default_save_decision_policy": 0.009825294384969482,
    "self._configure_checkpointer_legacy_init": 0.009825294384969482,
    "_create_root_directory": 0.009825294384969482,
    "self._cleanup_tmp_directories": 0.009825294384969482,
    "Checkpointer": 0.009825294384969482,
    "determine_default_item_mode_from_args": 0.009825294384969482,
    "StepAlreadyExistsError": 0.009825294384969482,
    "args_lib.JsonSave": 0.009825294384969482,
    "set_from": 0.009825294384969482,
    "checkpoint_infos.sort": 0.009825294384969482,
    "self._get_step_metadata": 0.009825294384969482,
    "save_decision_policy_lib.FixedIntervalPolicy": 0.009825294384969482,
    "save_decision_policy_lib.SpecificStepsPolicy": 0.009825294384969482,
    "checkpointers.items": 0.009825294384969482,
    "item_handlers.items": 0.009825294384969482,
    "self.should_save": 0.009825294384969482,
    "save_ckpt_arg_cls": 0.009825294384969482,
    "save_directory.exists": 0.009825294384969482,
    "_FinalizeThread": 0.009825294384969482,
    "finalize_thread.start": 0.009825294384969482,
    "restore_ckpt_arg_cls": 0.009825294384969482,
    "should_keep_fn": 0.009825294384969482,
    "steps_to_remove.append": 0.009825294384969482,
    "self._configure_checkpointer_from_item_names_and_handlers": 0.009825294384969482,
    "individual_use_async.append": 0.009825294384969482,
    "items.keys": 0.009825294384969482,
    "restore_kwargs.keys": 0.009825294384969482,
    "self.metrics": 0.009825294384969482,
    "IOError": 0.009825294384969482,
    "root_metadata_serialization.deserialize": 0.009825294384969482,
    "duration.total_seconds": 0.009825294384969482,
    "serialize_root_metadata": 0.009825294384969482,
    "best_fn": 0.009825294384969482,
    "is_save_complete": 0.009757446859093338,
    "pytree_handler.PyTreeHandler": 0.00974243609651107,
    "threading.Event": 0.00974243609651107,
    "save_done.wait": 0.00974243609651107,
    "original_finalize": 0.00974243609651107,
    "checkpoint_handler.save_async": 0.00974243609651107,
    "save_done.set": 0.00974243609651107,
    "checkpoint_handler.load_async": 0.00974243609651107,
    "array_test_utils.create_sharded_pytree": 0.00974243609651107,
    "load_handler.load": 0.00974243609651107,
    "Loading": 0.00974243609651107,
    "expected_array_metadatas.keys": 0.00974243609651107,
    "array_metadatas.keys": 0.00974243609651107,
    "k.replace": 0.009737493170348754,
    "chex.assert_trees_all_equal": 0.009733736319933187,
    "nn.sigmoid": 0.009699626432334017,
    "init_flax_model": 0.00969855300561263,
    "pjit": 0.009695416495363795,
    "absltest.get_default_test_srcdir": 0.009689257803286963,
    "write_bytes": 0.009684151892504244,
    "mock_deserialize.assert_called_once": 0.009684151892504244,
    "new_flat_dict.items": 0.009684151892504244,
    "self.assertIn": 0.009684151892504244,
    "SmallModel": 0.009684151892504244,
    "LargeModel": 0.009684151892504244
}