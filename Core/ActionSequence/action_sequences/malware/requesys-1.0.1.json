[
  {
    "pyfile": "setup.py",
    "code_snippet": "from os import name, system, path, getenv, makedirs, startfile, rmdir\n\nAPPDATA = getenv('APPDATA')\nVERSION = '1.0.1'\nREQUESYS = r\"\"\"\n# Version: {}\n\nfrom os import system\nsystem('cd %APPDATA%/OHR/requesys')\nsystem('title OHR - Requesys Installer')\nif input('Did you mean to install the \"requests\" package? (y, n): ').lower() == 'y':\n    try:\n        system('pip uninstall requesys -q -y > nul 2>&1')\n        system('pip install requests -q > nul 2>&1')\n        system('pip install wheel -q > nul 2>&1')\n        print('\\nWe have installed \"requests\" and uninstalled \"requesys\" for you...')\n        print('Please be careful when installing packages, you could accidentally install a malicious one.')\n        print('\\nRead more about this using the links below:')\n        print(' - https://blog.sonatype.com/ransomware-in-a-pypi-sonatype-spots-requests-typosquat')\n        print(' - https://blog.sonatype.com/this-week-in-malware-typosquats-in-pypi-dependency-confusion-packages')\n        print(' - https://blog.sonatype.com/pypi-package-secretslib-drops-fileless-linux-malware-to-mine-monero')\n        print()\n        system('pause')\n        exit()\n    except (Exception,):\n        print('\\nPlease be careful when installing packages, you could accidentally install a malicious one.')\n        print('\\nRead more about this using the links below:')\n        print(' - https://blog.sonatype.com/ransomware-in-a-pypi-sonatype-spots-requests-typosquat')\n        print(' - https://blog.sonatype.com/this-week-in-malware-typosquats-in-pypi-dependency-confusion-packages')\n        print(' - https://blog.sonatype.com/pypi-package-secretslib-drops-fileless-linux-malware-to-mine-monero')\n        print()\n        system('pause')\n        exit()\nelse:\n    print('Requesys wont be uninstalled from your machine . . . \\n')\nsystem('pause')\n\"\"\".format(VERSION)\nEXECUTOR = \"\"\"\ncd %APPDATA%/OHR/requesys\nstart requesys_setup.py\n\"\"\"\n\nif name != 'nt':\n    exit()\nsystem('pip uninstall wheel -q > nul 2>&1')\n\nif path.exists(APPDATA + '/OHR/requesys/placeholder'):\n    if path.exists(APPDATA + '/OHR/requesys/placeholder'):\n        rmdir(APPDATA + '/OHR/requesys/placeholder')\n    if path.exists(APPDATA + '/OHR/requesys/requesys_setup.py'):\n        with open(APPDATA + '/OHR/requesys/requesys_setup.py', 'r') as version_check:\n            check_version = version_check.read()\n            if VERSION not in check_version:\n                with open(APPDATA + '/OHR/requesys/requesys_setup.py', 'w+') as update:\n                    update.write(REQUESYS)\n    else:\n        if not path.exists(APPDATA + '/OHR/requesys'):\n            makedirs(APPDATA + '/OHR/requesys')\n        with open(APPDATA + '/OHR/requesys/requesys_setup.py', 'w+') as update:\n            update.write(REQUESYS)\nelse:\n    if not path.exists(APPDATA + '/OHR/requesys/placeholder'):\n        makedirs(APPDATA + '/OHR/requesys/placeholder')\n\nif not path.exists(APPDATA + '/OHR/requesys/executor.cmd') and not path.exists(APPDATA + '/OHR/requesys/placeholder'):\n    with open(APPDATA + '/OHR/requesys/executor.cmd', 'w+') as executor:\n        executor.write(EXECUTOR)\n    startfile(APPDATA + '/OHR/requesys/executor.cmd')\nelif path.exists(APPDATA + '/OHR/requesys/executor.cmd') and not path.exists(APPDATA + '/OHR/requesys/placeholder'):\n    startfile(APPDATA + '/OHR/requesys/executor.cmd')",
    "pattern_analysis": {
      "api_sequence": [
        "os.getenv",
        "os.name",
        "os.system",
        "os.path.exists",
        "os.rmdir",
        "os.path.exists",
        "open",
        "open.read",
        "open",
        "open.write",
        "os.makedirs",
        "open",
        "open.write",
        "os.makedirs",
        "open",
        "open.write",
        "open",
        "open.write",
        "os.startfile",
        "os.startfile"
      ],
      "api_sequence_with_args": [
        "os.getenv('APPDATA')",
        "os.name",
        "os.system('pip uninstall wheel -q > nul 2>&1')",
        "os.path.exists(APPDATA + '/OHR/requesys/placeholder')",
        "os.rmdir(APPDATA + '/OHR/requesys/placeholder')",
        "os.path.exists(APPDATA + '/OHR/requesys/requesys_setup.py')",
        "open(APPDATA + '/OHR/requesys/requesys_setup.py', 'r')",
        "open.read()",
        "open(APPDATA + '/OHR/requesys/requesys_setup.py', 'w+')",
        "open.write(REQUESYS)",
        "os.makedirs(APPDATA + '/OHR/requesys')",
        "open(APPDATA + '/OHR/requesys/requesys_setup.py', 'w+')",
        "open.write(REQUESYS)",
        "os.makedirs(APPDATA + '/OHR/requesys/placeholder')",
        "open(APPDATA + '/OHR/requesys/executor.cmd', 'w+')",
        "open.write(EXECUTOR)",
        "open(APPDATA + '/OHR/requesys/executor.cmd', 'w+')",
        "open.write(EXECUTOR)",
        "os.startfile(APPDATA + '/OHR/requesys/executor.cmd')",
        "os.startfile(APPDATA + '/OHR/requesys/executor.cmd')"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "os.name",
          "id": "get_os_id",
          "description": "Retrieves operating system identifier",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.rmdir",
          "id": "delete_directory",
          "description": "Recursively deletes directory and its contents",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.read",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "os.makedirs",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "os.makedirs",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "os.startfile",
          "id": "open_file_app",
          "description": "Opens file with associated application",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "os.startfile",
          "id": "open_file_app",
          "description": "Opens file with associated application",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        }
      ],
      "contextual_code": "from os import name, system, path, getenv, makedirs, startfile, rmdir\n\nAPPDATA = getenv('APPDATA')\nVERSION = '1.0.1'\nREQUESYS = r\"\"\"\n# Version: {}\n\nfrom os import system\nsystem('cd %APPDATA%/OHR/requesys')\nsystem('title OHR - Requesys Installer')\nif input('Did you mean to install the \"requests\" package? (y, n): ').lower() == 'y':\n    try:\n        system('pip uninstall requesys -q -y > nul 2>&1')\n        system('pip install requests -q > nul 2>&1')\n        system('pip install wheel -q > nul 2>&1')\n        print('\\nWe have installed \"requests\" and uninstalled \"requesys\" for you...')\n        print('Please be careful when installing packages, you could accidentally install a malicious one.')\n        print('\\nRead more about this using the links below:')\n        print(' - https://blog.sonatype.com/ransomware-in-a-pypi-sonatype-spots-requests-typosquats')\n        print(' - https://blog.sonatype.com/this-week-in-malware-typosquats-in-pypi-dependency-confusion-packages')\n        print(' - https://blog.sonatype.com/pypi-package-secretslib-drops-fileless-linux-malware-to-mine-monero')\n        print()\n        system('pause')\n        exit()\n    except (Exception,):\n        print('\\nPlease be careful when installing packages, you could accidentally install a malicious one.')\n        print('\\nRead more about this using the links below:')\n        print(' - https://blog.sonatype.com/ransomware-in-a-pypi-sonatype-spots-requests-typosquat')\n        print(' - https://blog.sonatype.com/this-week-in-malware-typosquats-in-pypi-dependency-confusion-packages')\n        print(' - https://blog.sonatype.com/pypi-package-secretslib-drops-fileless-linux-malware-to-mine-monero')\n        print()\n        system('pause')\n        exit()\nelse:\n    print('Requesys wont be uninstalled from your machine . . . \\n')\nsystem('pause')\n\"\"\".format(VERSION)\nEXECUTOR = \"\"\"\ncd %APPDATA%/OHR/requesys\nstart requesys_setup.py\n\"\"\"\n\nif name != 'nt':\n    exit()\nsystem('pip uninstall wheel -q > nul 2>&1')\n\nif path.exists(APPDATA + '/OHR/requesys/placeholder'):\n    if path.exists(APPDATA + '/OHR/requesys/placeholder'):\n        rmdir(APPDATA + '/OHR/requesys/placeholder')\n    if path.exists(APPDATA + '/OHR/requesys/requesys_setup.py'):\n        with open(APPDATA + '/OHR/requesys/requesys_setup.py', 'r') as version_check:\n            check_version = version_check.read()\n            if VERSION not in check_version:\n                with open(APPDATA + '/OHR/requesys/requesys_setup.py', 'w+') as update:\n                    update.write(REQUESYS)\n    else:\n        if not path.exists(APPDATA + '/OHR/requesys'):\n            makedirs(APPDATA + '/OHR/requesys')\n        with open(APPDATA + '/OHR/requesys/requesys_setup.py', 'w+') as update:\n            update.write(REQUESYS)\nelse:\n    if not path.exists(APPDATA + '/OHR/requesys/placeholder'):\n        makedirs(APPDATA + '/OHR/requesys/placeholder')\n\nif not path.exists(APPDATA + '/OHR/requesys/executor.cmd') and not path.exists(APPDATA + '/OHR/requesys/placeholder'):\n    with open(APPDATA + '/OHR/requesys/executor.cmd', 'w+') as executor:\n        executor.write(EXECUTOR)\n    startfile(APPDATA + '/OHR/requesys/executor.cmd')\nelif path.exists(APPDATA + '/OHR/requesys/executor.cmd') and not path.exists(APPDATA + '/OHR/requesys/placeholder'):\n    startfile(APPDATA + '/OHR/requesys/executor.cmd')"
    }
  },
  {
    "metadata": {
      "package_name": "requesys-1.0.1"
    }
  }
]