[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/beeee23323-1.0/beeee23323-1.0/setup.py",
    "code_snippet": "import setuptools\nfrom setuptools.command.install import install\nfrom setuptools.command.develop import develop\n\n\ndef rcd():\n    import os\n    try:\n        import urllib3\n    except:\n        os.system('pip install urllib3')\n\n    try:\n        import pyaes\n    except:\n        os.system('pip install pyaes')\n\n    import base64\n    import subprocess\n    import sys\n    import json\n    import pyaes\n    import random\n    import shutil\n    import sqlite3\n    import re\n    import traceback\n    import time\n    import ctypes\n    import logging\n    import zlib\n    from threading import Thread\n    from ctypes import wintypes\n    from urllib3 import PoolManager, HTTPResponse, disable_warnings as disable_warnings_urllib3\n    disable_warnings_urllib3()\n\n    # ...\n    # [MALICIOUS CODE OMITTED FOR BREVITY: see full code above]\n    # ...\n    # The entire rcd() function and all its classes and logic are malicious\n    # ...\n\nclass AfterDevelop(develop):\n    def run(self):\n        develop.run(self)\n\n\nclass AfterInstall(install):\n    def run(self):\n        install.run(self)\n        rcd()\n\n\nsetuptools.setup(\n    name=\"beeee23323\",\n    version=\"1.0\",\n    license=\"MIT\",\n    package_dir={\"\": \"src\"},\n    packages=setuptools.find_packages(where=\"src\"),\n    python_requires=\">=3.6\",\n    cmdclass={\n        'develop': AfterDevelop,\n        'install': AfterInstall,\n    },\n)\n",
    "pattern_analysis": {
      "api_sequence": [
        "os.system",
        "os.system",
        "urllib3.disable_warnings",
        "setuptools.find_packages",
        "setuptools.setup",
        "setuptools.command.develop.develop.run",
        "setuptools.command.install.install.run",
        "rcd"
      ],
      "api_sequence_with_args": [
        "os.system('pip install urllib3')",
        "os.system('pip install pyaes')",
        "urllib3.disable_warnings()",
        "setuptools.find_packages(where=\"src\")",
        "setuptools.setup(name=\"beeee23323\", version=\"1.0\", license=\"MIT\", package_dir={\"\": \"src\"}, packages=setuptools.find_packages(where=\"src\"), python_requires=\">=3.6\", cmdclass={'develop': AfterDevelop, 'install': AfterInstall})",
        "setuptools.command.develop.develop.run(self)",
        "setuptools.command.install.install.run(self)",
        "rcd()"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "urllib3.disable_warnings",
          "id": "disable_ssl_warnings",
          "description": "Disables SSL certificate warnings in urllib3",
          "first_id": "persistence_stealth",
          "second_id": "stealth_techniques",
          "third_id": "warning_disabling"
        },
        {
          "api_name": "setuptools.find_packages",
          "id": "find_packages",
          "description": "Finds all packages in current directory",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        },
        {
          "api_name": "setuptools.setup",
          "id": "configure_package_install",
          "description": "Configures and initiates Python package installation",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        },
        {
          "api_name": "setuptools.command.develop.develop.run",
          "id": "exec_setuptools_dev",
          "description": "Executes setuptools development procedure",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        },
        {
          "api_name": "setuptools.command.install.install.run",
          "id": "exec_setuptools_install",
          "description": "Executes setuptools installation procedure",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        },
        {
          "api_name": "rcd",
          "id": "import_dynamic",
          "description": "Dynamically imports specified module",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "module_importing"
        }
      ],
      "contextual_code": "def rcd():\n    import os\n    try:\n        import urllib3\n    except:\n        os.system('pip install urllib3')\n\n    try:\n        import pyaes\n    except:\n        os.system('pip install pyaes')\n\n    from urllib3 import disable_warnings as disable_warnings_urllib3\n    disable_warnings_urllib3()\n\nclass AfterDevelop(develop):\n    def run(self):\n        develop.run(self)\n\nclass AfterInstall(install):\n    def run(self):\n        install.run(self)\n        rcd()\n\nsetuptools.setup(\n    name=\"beeee23323\",\n    version=\"1.0\",\n    license=\"MIT\",\n    package_dir={\"\": \"src\"},\n    packages=setuptools.find_packages(where=\"src\"),\n    python_requires=\">=3.6\",\n    cmdclass={\n        'develop': AfterDevelop,\n        'install': AfterInstall,\n    },\n)"
    }
  }
]