[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/effre4frferfrf-1.0/effre4frferfrf-1.0/setup.py",
    "code_snippet": "import setuptools\nfrom setuptools.command.install import install\nfrom setuptools.command.develop import develop\n\n\ndef rcd():\n    import os\n\n    os.system(\"python -m pip install urllib3 pyaes\")\n    import base64\n    import subprocess\n    import sys\n    import json\n    import pyaes\n    import random\n    import shutil\n    import sqlite3\n    import re\n    import traceback\n    import time\n    import ctypes\n    import logging\n    import zlib\n    from threading import Thread\n    from ctypes import wintypes\n    from urllib3 import PoolManager, HTTPResponse, disable_warnings as disable_warnings_urllib3\n    disable_warnings_urllib3()\n\n    # ... [MALICIOUS STEALER CODE OMITTED FOR BREVITY, see full code above] ...\n    # The entire rcd() function is malicious, as it implements a full-featured stealer:\n    # - Steals browser passwords, cookies, autofills, history\n    # - Steals Discord tokens, injects JS backdoor into Discord\n    # - Steals Telegram sessions, crypto wallets, Minecraft/Epic/Steam/Uplay/Growtopia sessions\n    # - Steals system info, clipboard, wifi passwords, screenshots, webcam images, common files\n    # - Blocks AV/AM sites, disables Defender, UAC bypass, persistence, self-deletion, anti-VM\n    # - Exfiltrates all data to C2 via Discord webhook or Telegram bot\n    # - Runs on install via setuptools install hook\n    #\n    # The code is highly modular and obfuscated in places, but the entire rcd() function and its classes are malicious.\n\n    # ... [END MALICIOUS STEALER CODE] ...\n\nclass AfterDevelop(develop):\n    def run(self):\n        develop.run(self)\n\nclass AfterInstall(install):\n    def run(self):\n        install.run(self)\n        rcd()\n\nsetuptools.setup(\n    name=\"effre4frferfrf\",\n    version=\"1.0\",\n    license=\"MIT\",\n    package_dir={\"\": \"src\"},\n    packages=setuptools.find_packages(where=\"src\"),\n    python_requires=\">=3.6\",\n    cmdclass={\n        'develop': AfterDevelop,\n        'install': AfterInstall,\n    },\n)\n",
    "pattern_analysis": {
      "api_sequence": [
        "os.system",
        "urllib3.disable_warnings",
        "setuptools.command.install.install.run",
        "rcd"
      ],
      "api_sequence_with_args": [
        "os.system(\"python -m pip install urllib3 pyaes\")",
        "urllib3.disable_warnings()",
        "setuptools.command.install.install.run(self)",
        "rcd()"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "urllib3.disable_warnings",
          "id": "disable_ssl_warnings",
          "description": "Disables SSL certificate warnings in urllib3",
          "first_id": "persistence_stealth",
          "second_id": "stealth_techniques",
          "third_id": "warning_disabling"
        },
        {
          "api_name": "setuptools.command.install.install.run",
          "id": "exec_setuptools_install",
          "description": "Executes setuptools installation procedure",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "package_configuration"
        },
        {
          "api_name": "rcd",
          "id": "exec_python_code",
          "description": "Dynamically executes Python code string",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "string_execution"
        }
      ],
      "contextual_code": "def rcd():\n    import os\n    os.system(\"python -m pip install urllib3 pyaes\")\n    from urllib3 import disable_warnings as disable_warnings_urllib3\n    disable_warnings_urllib3()\n\nclass AfterInstall(install):\n    def run(self):\n        install.run(self)\n        rcd()\n"
    }
  }
]