[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/noblesse-0.0.2/noblesse-0.0.2/src/noblesse.py",
    "code_snippet": "import requests\nimport os\nimport datetime\nimport json\nimport re\n\ndef DMChannel(image,message):\n    src = requests.get(image.url)\n    author = str(message.channel).replace(\"/\",\" \").replace(\":\",\" \").replace(\"*\",\" \").replace(\"?\",\" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    if not os.path.exists(\"files/DMChannels/\" + author):\n        os.mkdir('files/DMChannels/' + author)\n    with open(f'files/DMChannels/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}',\"wb+\") as handle:\n        handle.write(src.content)\n        handle.flush()\n        handle.close()\n    # Logging file download\n\ndef GroupChannel(image,message):\n    src = requests.get(image.url)\n    author = str(message.channel).replace(\"/\",\" \").replace(\":\",\" \").replace(\"*\",\" \").replace(\"?\",\" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    if not os.path.exists(\"files/GroupChannels/\" + author):\n        os.mkdir('files/GroupChannels/' + author)\n    with open(f'files/GroupChannels/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}',\"wb+\") as handle:\n        handle.write(src.content)\n        handle.flush()\n        handle.close()\n    # Logging file download\n\ndef GuildChannel(image,message):\n    src = requests.get(image.url)\n    guild = str(message.guild.name).replace(\"/\",\" \").replace(\":\",\" \").replace(\"*\",\" \").replace(\"?\",\" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    author = str(message.author.name).replace(\"/\",\" \").replace(\":\",\" \").replace(\"*\",\" \").replace(\"?\",\" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    channel = str(message.channel.name).replace(\"/\",\" \").replace(\":\",\" \").replace(\"*\",\" \").replace(\"?\",\" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    if not os.path.exists(f\"files/Servers/{guild}\"):\n       os.mkdir(f\"files/Servers/{guild}\") \n    if not os.path.exists(f\"files/Servers/{guild}/{channel}\"):\n        os.mkdir(f\"files/Servers/{guild}/{channel}\")\n    if not os.path.exists(f\"files/Servers/{guild}/{channel}/{author}\"):\n        os.mkdir(f\"files/Servers/{guild}/{channel}/{author}\")\n    with open(f'files/Servers/{guild}/{channel}/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}',\"wb+\") as handle:\n        handle.write(src.content)\n        handle.flush()\n        handle.close()\n    # Logging file download\n\ndef log_attachments(attachment,message,config):\n    payload = {\n        \"username\" : message.author.name,\n        \"avatar_url\" : str(message.author.avatar_url),\n        \"content\" : message.content,\n        \"embeds\" : [\n            {\n                \"author\" : {\n                    \"name\" : message.author.name,\n                    \"url\" : str(message.author.avatar_url),\n                    \"icon_url\" : str(message.author.avatar_url)\n                },\n                \"title\" : attachment.filename,\n                \"description\" : f\"```URL HERE: {attachment.url}```\",\n                \"image\" : {\n                    \"url\" : attachment.url\n                },\n                \"footer\" : {\n                    \"text\" : f\"Message ID: {message.id}\",\n                    \"icon_url\" : str(message.author.avatar_url)\n                }\n            }\n        ]       \n    }\n    requests.post(config['attachment_webhook'],json=payload)\n\ndef check_nitro(config,message):\n    if 'discord.gift/' in message.content:\n        code = re.search(\"discord.gift/(.*)\", message.content).group(1)\n        if code in config['duplicates']:\n            payload = {\"username\" : message.author.name,\"avatar_url\" : str(message.author.avatar_url),\"embeds\" : [{\"description\" : \"Duplicate code.\",\"footer\" : {\"text\" : f\"Code here: {code}\",\"icon_url\": config['GenesisGif']}}]}\n            requests.post(config['nitro_webhook'],json=payload)\n        else:\n            headers = {'Authorization': config['token']}\n            r = requests.post(\n                f'https://discordapp.com/api/v6/entitlements/gift-codes/{code}/redeem', \n                headers=headers,\n            ).text\n            if 'This gift has been redeemed already.' in r:\n                config['duplicates'].append(code)\n                open('assets/config.json','w+').write(json.dumps(config,indent=4,sort_keys=True))\n                payload = {\"username\" : message.author.name,\"avatar_url\" : str(message.author.avatar_url),\"embeds\" : [{\"description\" : \"Nitro Already Redeemed\",\"footer\" : {\"text\" : f\"Code here: {code}\",\"icon_url\": config['GenesisGif']}}]}\n                requests.post(config['nitro_webhook'],json=payload)\n            elif 'subscription_plan' in r:\n                config['duplicates'].append(code)\n                open('assets/config.json','w+').write(json.dumps(config,indent=4,sort_keys=True))\n                payload = {\"username\" : message.author.name,\"avatar_url\" : str(message.author.avatar_url),\"content\" : \"@everyone\",\"embeds\" : [{\"description\" : \"Nitro Successfully Redeemed!\",\"footer\" : {\"text\" : f\"Code here: {code}\",\"icon_url\": config['GenesisGif']}}]}\n                requests.post(config['nitro_webhook'],json=payload)\n            elif 'Unknown Gift Code' in r:\n                config['duplicates'].append(code)\n                open('assets/config.json','w+').write(json.dumps(config,indent=4,sort_keys=True))\n                payload = {\"username\" : message.author.name,\"avatar_url\" : str(message.author.avatar_url),\"embeds\" : [{\"description\" : \"Invalid Gift Code\",\"footer\" : {\"text\" : f\"Code here: {code}\",\"icon_url\": config['GenesisGif']}}]}\n                requests.post(config['nitro_webhook'],json=payload)\n            else:\n                return\n",
    "pattern_analysis": {
      "api_sequence": [
        "requests.get",
        "os.path.exists",
        "os.mkdir",
        "open",
        "handle.write",
        "handle.flush",
        "handle.close",
        "requests.get",
        "os.path.exists",
        "os.mkdir",
        "open",
        "handle.write",
        "handle.flush",
        "handle.close",
        "requests.get",
        "os.path.exists",
        "os.mkdir",
        "os.path.exists",
        "os.mkdir",
        "os.path.exists",
        "os.mkdir",
        "open",
        "handle.write",
        "handle.flush",
        "handle.close",
        "requests.post",
        "re.search",
        "requests.post",
        "requests.post",
        "requests.post",
        "requests.post",
        "open",
        "open.write",
        "json.dumps"
      ],
      "api_sequence_with_args": [
        "requests.get(image.url)",
        "os.path.exists('files/DMChannels/' + author)",
        "os.mkdir('files/DMChannels/' + author)",
        "open(f'files/DMChannels/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}', 'wb+')",
        "handle.write(src.content)",
        "handle.flush()",
        "handle.close()",
        "requests.get(image.url)",
        "os.path.exists('files/GroupChannels/' + author)",
        "os.mkdir('files/GroupChannels/' + author)",
        "open(f'files/GroupChannels/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}', 'wb+')",
        "handle.write(src.content)",
        "handle.flush()",
        "handle.close()",
        "requests.get(image.url)",
        "os.path.exists(f'files/Servers/{guild}')",
        "os.mkdir(f'files/Servers/{guild}')",
        "os.path.exists(f'files/Servers/{guild}/{channel}')",
        "os.mkdir(f'files/Servers/{guild}/{channel}')",
        "os.path.exists(f'files/Servers/{guild}/{channel}/{author}')",
        "os.mkdir(f'files/Servers/{guild}/{channel}/{author}')",
        "open(f'files/Servers/{guild}/{channel}/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}', 'wb+')",
        "handle.write(src.content)",
        "handle.flush()",
        "handle.close()",
        "requests.post(config['attachment_webhook'], json=payload)",
        "re.search('discord.gift/(.*)', message.content)",
        "requests.post(config['nitro_webhook'], json=payload)",
        "requests.post(f'https://discordapp.com/api/v6/entitlements/gift-codes/{code}/redeem', headers=headers)",
        "requests.post(config['nitro_webhook'], json=payload)",
        "requests.post(config['nitro_webhook'], json=payload)",
        "open('assets/config.json', 'w+')",
        "open.write(json.dumps(config, indent=4, sort_keys=True))",
        "json.dumps(config, indent=4, sort_keys=True)"
      ],
      "mapped_sequence": [
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.mkdir",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "handle.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "handle.flush",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "handle.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.mkdir",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "handle.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "handle.flush",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "handle.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.mkdir",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.mkdir",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.mkdir",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "handle.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "handle.flush",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "handle.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "requests.post",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "re.search",
          "id": "compile_regex",
          "description": "Compiles regular expression pattern",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "code_compilation"
        },
        {
          "api_name": "requests.post",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "requests.post",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "requests.post",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "requests.post",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "json.dumps",
          "id": "serialize_to_json",
          "description": "Serializes Python object to JSON string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        }
      ],
      "contextual_code": "import requests\nimport os\nimport datetime\nimport json\nimport re\n\ndef DMChannel(image, message):\n    src = requests.get(image.url)\n    author = str(message.channel).replace(\"/\", \" \").replace(\":\", \" \").replace(\"*\", \" \").replace(\"?\", \" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    if not os.path.exists(\"files/DMChannels/\" + author):\n        os.mkdir('files/DMChannels/' + author)\n    with open(f'files/DMChannels/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}',\"wb+\") as handle:\n        handle.write(src.content)\n        handle.flush()\n        handle.close()\n\ndef GroupChannel(image, message):\n    src = requests.get(image.url)\n    author = str(message.channel).replace(\"/\", \" \").replace(\":\", \" \").replace(\"*\", \" \").replace(\"?\", \" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    if not os.path.exists(\"files/GroupChannels/\" + author):\n        os.mkdir('files/GroupChannels/' + author)\n    with open(f'files/GroupChannels/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}',\"wb+\") as handle:\n        handle.write(src.content)\n        handle.flush()\n        handle.close()\n\ndef GuildChannel(image, message):\n    src = requests.get(image.url)\n    guild = str(message.guild.name).replace(\"/\", \" \").replace(\":\", \" \").replace(\"*\", \" \").replace(\"?\", \" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    author = str(message.author.name).replace(\"/\", \" \").replace(\":\", \" \").replace(\"*\", \" \").replace(\"?\", \" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    channel = str(message.channel.name).replace(\"/\", \" \").replace(\":\", \" \").replace(\"*\", \" \").replace(\"?\", \" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    if not os.path.exists(f\"files/Servers/{guild}\"):\n        os.mkdir(f\"files/Servers/{guild}\")\n    if not os.path.exists(f\"files/Servers/{guild}/{channel}\"):\n        os.mkdir(f\"files/Servers/{guild}/{channel}\")\n    if not os.path.exists(f\"files/Servers/{guild}/{channel}/{author}\"):\n        os.mkdir(f\"files/Servers/{guild}/{channel}/{author}\")\n    with open(f'files/Servers/{guild}/{channel}/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}',\"wb+\") as handle:\n        handle.write(src.content)\n        handle.flush()\n        handle.close()\n\ndef log_attachments(attachment, message, config):\n    payload = {\n        \"username\": message.author.name,\n        \"avatar_url\": str(message.author.avatar_url),\n        \"content\": message.content,\n        \"embeds\": [\n            {\n                \"author\": {\n                    \"name\": message.author.name,\n                    \"url\": str(message.author.avatar_url),\n                    \"icon_url\": str(message.author.avatar_url)\n                },\n                \"title\": attachment.filename,\n                \"description\": f\"```URL HERE: {attachment.url}```\",\n                \"image\": {\n                    \"url\": attachment.url\n                },\n                \"footer\": {\n                    \"text\": f\"Message ID: {message.id}\",\n                    \"icon_url\": str(message.author.avatar_url)\n                }\n            }\n        ]\n    }\n    requests.post(config['attachment_webhook'], json=payload)\n\ndef check_nitro(config, message):\n    if 'discord.gift/' in message.content:\n        code = re.search(\"discord.gift/(.*)\", message.content).group(1)\n        if code in config['duplicates']:\n            payload = {\"username\": message.author.name, \"avatar_url\": str(message.author.avatar_url), \"embeds\": [{\"description\": \"Duplicate code.\", \"footer\": {\"text\": f\"Code here: {code}\", \"icon_url\": config['GenesisGif']}}]}\n            requests.post(config['nitro_webhook'], json=payload)\n        else:\n            headers = {'Authorization': config['token']}\n            r = requests.post(\n                f'https://discordapp.com/api/v6/entitlements/gift-codes/{code}/redeem',\n                headers=headers,\n            ).text\n            if 'This gift has been redeemed already.' in r:\n                config['duplicates'].append(code)\n                open('assets/config.json', 'w+').write(json.dumps(config, indent=4, sort_keys=True))\n                payload = {\"username\": message.author.name, \"avatar_url\": str(message.author.avatar_url), \"embeds\": [{\"description\": \"Nitro Already Redeemed\", \"footer\": {\"text\": f\"Code here: {code}\", \"icon_url\": config['GenesisGif']}}]}\n                requests.post(config['nitro_webhook'], json=payload)\n            elif 'subscription_plan' in r:\n                config['duplicates'].append(code)\n                open('assets/config.json', 'w+').write(json.dumps(config, indent=4, sort_keys=True))\n                payload = {\"username\": message.author.name, \"avatar_url\": str(message.author.avatar_url), \"content\": \"@everyone\", \"embeds\": [{\"description\": \"Nitro Successfully Redeemed!\", \"footer\": {\"text\": f\"Code here: {code}\", \"icon_url\": config['GenesisGif']}}]}\n                requests.post(config['nitro_webhook'], json=payload)\n            elif 'Unknown Gift Code' in r:\n                config['duplicates'].append(code)\n                open('assets/config.json', 'w+').write(json.dumps(config, indent=4, sort_keys=True))\n                payload = {\"username\": message.author.name, \"avatar_url\": str(message.author.avatar_url), \"embeds\": [{\"description\": \"Invalid Gift Code\", \"footer\": {\"text\": f\"Code here: {code}\", \"icon_url\": config['GenesisGif']}}]}\n                requests.post(config['nitro_webhook'], json=payload)\n            else:\n                return"
    }
  }
]