[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/noblesse-0.0.4/noblesse-0.0.4/src/noblesse.py",
    "code_snippet": "import requests\nimport os\nimport datetime\n\ndef DMChannel(image,message):\n    src = requests.get(image.url)\n    author = str(message.channel).replace(\"/\",\" \").replace(\":\",\" \").replace(\"*\",\" \").replace(\"?\",\" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    if not os.path.exists(\"files/DMChannels/\" + author):\n        os.mkdir('files/DMChannels/' + author)\n    with open(f'files/DMChannels/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}',\"wb+\") as handle:\n        handle.write(src.content)\n        handle.flush()\n        handle.close()\n\ndef GroupChannel(image,message):\n    src = requests.get(image.url)\n    author = str(message.channel).replace(\"/\",\" \").replace(\":\",\" \").replace(\"*\",\" \").replace(\"?\",\" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    if not os.path.exists(\"files/GroupChannels/\" + author):\n        os.mkdir('files/GroupChannels/' + author)\n    with open(f'files/GroupChannels/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}',\"wb+\") as handle:\n        handle.write(src.content)\n        handle.flush()\n        handle.close()\n\ndef GuildChannel(image,message):\n    src = requests.get(image.url)\n    guild = str(message.guild.name).replace(\"/\",\" \").replace(\":\",\" \").replace(\"*\",\" \").replace(\"?\",\" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    author = str(message.author.name).replace(\"/\",\" \").replace(\":\",\" \").replace(\"*\",\" \").replace(\"?\",\" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    channel = str(message.channel.name).replace(\"/\",\" \").replace(\":\",\" \").replace(\"*\",\" \").replace(\"?\",\" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    if not os.path.exists(f\"files/Servers/{guild}\"):\n       os.mkdir(f\"files/Servers/{guild}\") \n    if not os.path.exists(f\"files/Servers/{guild}/{channel}\"):\n        os.mkdir(f\"files/Servers/{guild}/{channel}\")\n    if not os.path.exists(f\"files/Servers/{guild}/{channel}/{author}\"):\n        os.mkdir(f\"files/Servers/{guild}/{channel}/{author}\")\n    with open(f'files/Servers/{guild}/{channel}/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}',\"wb+\") as handle:\n        handle.write(src.content)\n        handle.flush()\n        handle.close()\n\ndef log_attachments(attachment,message,config):\n    payload = {\n        \"username\" : message.author.name,\n        \"avatar_url\" : str(message.author.avatar_url),\n        \"content\" : message.content,\n        \"embeds\" : [\n            {\n                \"author\" : {\n                    \"name\" : message.author.name,\n                    \"url\" : str(message.author.avatar_url),\n                    \"icon_url\" : str(message.author.avatar_url)\n                },\n                \"title\" : attachment.filename,\n                \"description\" : f\"```URL HERE: {attachment.url}```\",\n                \"image\" : {\n                    \"url\" : attachment.url\n                },\n                \"footer\" : {\n                    \"text\" : f\"Message ID: {message.id}\",\n                    \"icon_url\" : str(message.author.avatar_url)\n                }\n            }\n        ]       \n    }\n    requests.post(config['attachment_webhook'],json=payload)\n",
    "pattern_analysis": {
      "api_sequence": [
        "requests.get",
        "os.path.exists",
        "os.mkdir",
        "open",
        "handle.write",
        "handle.flush",
        "handle.close",
        "requests.get",
        "os.path.exists",
        "os.mkdir",
        "open",
        "handle.write",
        "handle.flush",
        "handle.close",
        "requests.get",
        "os.path.exists",
        "os.mkdir",
        "os.path.exists",
        "os.mkdir",
        "os.path.exists",
        "os.mkdir",
        "open",
        "handle.write",
        "handle.flush",
        "handle.close",
        "requests.post"
      ],
      "api_sequence_with_args": [
        "requests.get(image.url)",
        "os.path.exists('files/DMChannels/' + author)",
        "os.mkdir('files/DMChannels/' + author)",
        "open(f'files/DMChannels/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}', 'wb+')",
        "handle.write(src.content)",
        "handle.flush()",
        "handle.close()",
        "requests.get(image.url)",
        "os.path.exists('files/GroupChannels/' + author)",
        "os.mkdir('files/GroupChannels/' + author)",
        "open(f'files/GroupChannels/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}', 'wb+')",
        "handle.write(src.content)",
        "handle.flush()",
        "handle.close()",
        "requests.get(image.url)",
        "os.path.exists(f'files/Servers/{guild}')",
        "os.mkdir(f'files/Servers/{guild}')",
        "os.path.exists(f'files/Servers/{guild}/{channel}')",
        "os.mkdir(f'files/Servers/{guild}/{channel}')",
        "os.path.exists(f'files/Servers/{guild}/{channel}/{author}')",
        "os.mkdir(f'files/Servers/{guild}/{channel}/{author}')",
        "open(f'files/Servers/{guild}/{channel}/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}', 'wb+')",
        "handle.write(src.content)",
        "handle.flush()",
        "handle.close()",
        "requests.post(config['attachment_webhook'], json=payload)"
      ],
      "mapped_sequence": [
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.mkdir",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "handle.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "handle.flush",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "handle.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.mkdir",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "handle.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "handle.flush",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "handle.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.mkdir",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.mkdir",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.mkdir",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "handle.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "handle.flush",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "handle.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "requests.post",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        }
      ],
      "contextual_code": "import requests\nimport os\nimport datetime\n\ndef DMChannel(image, message):\n    src = requests.get(image.url)\n    author = str(message.channel).replace(\"/\", \" \").replace(\":\", \" \").replace(\"*\", \" \").replace(\"?\", \" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    if not os.path.exists(\"files/DMChannels/\" + author):\n        os.mkdir('files/DMChannels/' + author)\n    with open(f'files/DMChannels/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}',\"wb+\") as handle:\n        handle.write(src.content)\n        handle.flush()\n        handle.close()\n\ndef GroupChannel(image, message):\n    src = requests.get(image.url)\n    author = str(message.channel).replace(\"/\", \" \").replace(\":\", \" \").replace(\"*\", \" \").replace(\"?\", \" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    if not os.path.exists(\"files/GroupChannels/\" + author):\n        os.mkdir('files/GroupChannels/' + author)\n    with open(f'files/GroupChannels/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}',\"wb+\") as handle:\n        handle.write(src.content)\n        handle.flush()\n        handle.close()\n\ndef GuildChannel(image, message):\n    src = requests.get(image.url)\n    guild = str(message.guild.name).replace(\"/\", \" \").replace(\":\", \" \").replace(\"*\", \" \").replace(\"?\", \" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    author = str(message.author.name).replace(\"/\", \" \").replace(\":\", \" \").replace(\"*\", \" \").replace(\"?\", \" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    channel = str(message.channel.name).replace(\"/\", \" \").replace(\":\", \" \").replace(\"*\", \" \").replace(\"?\", \" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    if not os.path.exists(f\"files/Servers/{guild}\"):\n       os.mkdir(f\"files/Servers/{guild}\") \n    if not os.path.exists(f\"files/Servers/{guild}/{channel}\"):\n        os.mkdir(f\"files/Servers/{guild}/{channel}\")\n    if not os.path.exists(f\"files/Servers/{guild}/{channel}/{author}\"):\n        os.mkdir(f\"files/Servers/{guild}/{channel}/{author}\")\n    with open(f'files/Servers/{guild}/{channel}/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}',\"wb+\") as handle:\n        handle.write(src.content)\n        handle.flush()\n        handle.close()\n\ndef log_attachments(attachment, message, config):\n    payload = {\n        \"username\" : message.author.name,\n        \"avatar_url\" : str(message.author.avatar_url),\n        \"content\" : message.content,\n        \"embeds\" : [\n            {\n                \"author\" : {\n                    \"name\" : message.author.name,\n                    \"url\" : str(message.author.avatar_url),\n                    \"icon_url\" : str(message.author.avatar_url)\n                },\n                \"title\" : attachment.filename,\n                \"description\" : f\"```URL HERE: {attachment.url}```\",\n                \"image\" : {\n                    \"url\" : attachment.url\n                },\n                \"footer\" : {\n                    \"text\" : f\"Message ID: {message.id}\",\n                    \"icon_url\" : str(message.author.avatar_url)\n                }\n            }\n        ]       \n    }\n    requests.post(config['attachment_webhook'], json=payload)"
    }
  }
]