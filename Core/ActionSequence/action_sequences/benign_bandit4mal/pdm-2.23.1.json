[
  {
    "metadata": {
      "package_name": "pdm-2.23.1",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "test_project.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pdm-2.23.1/pdm-2.23.1/tests/test_project.py",
    "line_number": "362",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "361\t    }\n362\t    project.pyproject.write()\n363\t    parser = mocker.patch(\"argparse.ArgumentParser.parse_args\")",
    "code_snippet": "def test_invoke_pdm_adding_configured_args(project, pdm, mocker):\n    project.pyproject.settings[\"options\"] = {\n        \"install\": [\"--no-self\", \"--no-editable\"],\n        \"add\": [\"--no-isolation\"],\n        \"lock\": [\"--no-cross-platform\"],\n    }\n    project.pyproject.write()\n    parser = mocker.patch(\"argparse.ArgumentParser.parse_args\")\n    pdm([\"add\", \"requests\"], obj=project)\n    parser.assert_called_with([\"add\", \"--no-isolation\", \"requests\"])\n    pdm([\"install\", \"--check\"], obj=project)\n    parser.assert_called_with([\"install\", \"--no-self\", \"--no-editable\", \"--check\"])\n    pdm([\"lock\", \"--lockfile\", \"pdm.2.lock\"], obj=project)\n    parser.assert_called_with([\"lock\", \"--no-cross-platform\", \"--lockfile\", \"pdm.2.lock\"])\n    pdm([\"-c\", \"/dev/null\", \"lock\"], obj=project)\n    parser.assert_called_with([\"-c\", \"/dev/null\", \"lock\", \"--no-cross-platform\"])\n    pdm([\"--verbose\", \"add\", \"requests\"], obj=project)\n    parser.assert_called_with([\"--verbose\", \"add\", \"--no-isolation\", \"requests\"])",
    "pattern_analysis": {
      "api_sequence": [
        "project.pyproject.write"
      ],
      "api_sequence_with_args": [
        "project.pyproject.write()"
      ],
      "mapped_sequence": [
        {
          "api_name": "project.pyproject.write",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        }
      ],
      "contextual_code": "def test_invoke_pdm_adding_configured_args(project, pdm, mocker):\n    project.pyproject.settings[\"options\"] = {\n        \"install\": [\"--no-self\", \"--no-editable\"],\n        \"add\": [\"--no-isolation\"],\n        \"lock\": [\"--no-cross-platform\"],\n    }\n    project.pyproject.write()"
    }
  }
]