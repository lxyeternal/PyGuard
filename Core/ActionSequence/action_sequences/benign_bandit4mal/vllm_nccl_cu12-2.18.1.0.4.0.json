[
  {
    "metadata": {
      "package_name": "vllm_nccl_cu12-2.18.1.0.4.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "setup.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/vllm_nccl_cu12-2.18.1.0.4.0/vllm_nccl_cu12-2.18.1.0.4.0/setup.py",
    "line_number": "78",
    "type_description": "B819:urlretrieve",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "77\t            import urllib.request\n78\t            urllib.request.urlretrieve(url, destination)\n79\t            print(f\"nccl package downloaded to {destination}\")",
    "code_snippet": "while True:\n    if os.path.exists(destination):\n        print(f\"nccl package already exists at {destination}\")\n    else:\n        print(f\"Downloading nccl package from {url}\")\n        try:\n            import urllib.request\n            urllib.request.urlretrieve(url, destination)\n            print(f\"nccl package downloaded to {destination}\")\n        except Exception as e:\n            print(f\"Failed to download nccl package from {url}\")\n            print(e)\n    if get_md5_hash(destination) != file_hash:\n        print(f\"md5 hash of downloaded file does not match expected hash, retrying\")\n        os.remove(destination)\n    else:\n        print(f\"md5 hash of downloaded file matches expected hash\")\n        break",
    "pattern_analysis": {
      "api_sequence": [
        "os.path.exists",
        "urllib.request.urlretrieve",
        "get_md5_hash",
        "os.remove"
      ],
      "api_sequence_with_args": [
        "os.path.exists(destination)",
        "urllib.request.urlretrieve(url, destination)",
        "get_md5_hash(destination)",
        "os.remove(destination)"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "urllib.request.urlretrieve",
          "id": "download_file_url",
          "description": "Downloads file from URL to specified local path",
          "first_id": "network_file_transfer",
          "second_id": "file_download",
          "third_id": "url_file_acquisition"
        },
        {
          "api_name": "get_md5_hash",
          "id": "create_md5_hash",
          "description": "Creates MD5 hash object from encoded hostname",
          "first_id": "encryption_hashing",
          "second_id": "hash_calculation",
          "third_id": "hash_object_creation"
        },
        {
          "api_name": "os.remove",
          "id": "delete_file",
          "description": "Deletes specified file from filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_transfer"
        }
      ],
      "contextual_code": "while True:\n    if os.path.exists(destination):\n        print(f\"nccl package already exists at {destination}\")\n    else:\n        print(f\"Downloading nccl package from {url}\")\n        try:\n            import urllib.request\n            urllib.request.urlretrieve(url, destination)\n            print(f\"nccl package downloaded to {destination}\")\n        except Exception as e:\n            print(f\"Failed to download nccl package from {url}\")\n            print(e)\n    if get_md5_hash(destination) != file_hash:\n        print(f\"md5 hash of downloaded file does not match expected hash, retrying\")\n        os.remove(destination)\n    else:\n        print(f\"md5 hash of downloaded file matches expected hash\")\n        break"
    }
  }
]