[
  {
    "metadata": {
      "package_name": "pyprof2calltree-1.4.5",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "pyprof2calltree.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pyprof2calltree-1.4.5/pyprof2calltree-1.4.5/pyprof2calltree.py",
    "line_number": "266",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "265\t        munged_name = self.munged_function_name(code)\n266\t        out_file.write('fl=%s\\nfn=%s\\n' % (co_filename, munged_name))\n267",
    "code_snippet": "    def _output_entry(self, entry):\n        out_file = self.out_file\n\n        code = entry.code\n\n        co_filename, co_firstlineno, co_name = cProfile.label(code)\n        munged_name = self.munged_function_name(code)\n        out_file.write('fl=%s\\nfn=%s\\n' % (co_filename, munged_name))\n\n        inlinetime = int(entry.inlinetime * SCALE)\n        out_file.write('%d %d\\n' % (co_firstlineno, inlinetime))\n\n        # recursive calls are counted in entry.calls\n        if entry.calls:\n            for subentry in sorted(entry.calls, key=_entry_sort_key):\n                self._output_subentry(co_firstlineno, subentry.code,\n                                      subentry.callcount,\n                                      int(subentry.totaltime * SCALE))\n\n        out_file.write('\\n')",
    "pattern_analysis": {
      "api_sequence": [
        "cProfile.label",
        "self.munged_function_name",
        "out_file.write",
        "out_file.write",
        "sorted",
        "self._output_subentry",
        "out_file.write"
      ],
      "api_sequence_with_args": [
        "cProfile.label(code)",
        "self.munged_function_name(code)",
        "out_file.write('fl=%s\\nfn=%s\\n' % (co_filename, munged_name))",
        "out_file.write('%d %d\\n' % (co_firstlineno, inlinetime))",
        "sorted(entry.calls, key=_entry_sort_key)",
        "self._output_subentry(co_firstlineno, subentry.code, subentry.callcount, int(subentry.totaltime * SCALE))",
        "out_file.write('\\n')"
      ],
      "mapped_sequence": [
        {
          "api_name": "out_file.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "out_file.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "out_file.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        }
      ],
      "contextual_code": "def _output_entry(self, entry):\n    out_file = self.out_file\n    code = entry.code\n    co_filename, co_firstlineno, co_name = cProfile.label(code)\n    munged_name = self.munged_function_name(code)\n    out_file.write('fl=%s\\nfn=%s\\n' % (co_filename, munged_name))\n    inlinetime = int(entry.inlinetime * SCALE)\n    out_file.write('%d %d\\n' % (co_firstlineno, inlinetime))\n    if entry.calls:\n        for subentry in sorted(entry.calls, key=_entry_sort_key):\n            self._output_subentry(co_firstlineno, subentry.code, subentry.callcount, int(subentry.totaltime * SCALE))\n    out_file.write('\\n')"
    }
  }
]