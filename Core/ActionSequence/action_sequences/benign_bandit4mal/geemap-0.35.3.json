[
  {
    "metadata": {
      "package_name": "geemap-0.35.3",
      "total_matches": 3,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "ai.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/geemap-0.35.3/geemap-0.35.3/geemap/ai.py",
    "line_number": "1142",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1141\t            return \"\"\n1142\t        js_code = self.stac_json.get(\"code\").get(\"js_code\")\n1143\t        self.stac_json[\"code\"] = {\"js_code\": \"\", \"py_code\": code}",
    "code_snippet": "def set_js_code(self, code: str) -> None:\n    \"\"\"Sets the JavaScript code sample for the collection.\n\n    Args:\n        code (str): The JavaScript code sample to set.\n    \"\"\"\n    if not code:\n        return \"\"\n    js_code = self.stac_json.get(\"code\").get(\"js_code\")\n    self.stac_json[\"code\"] = {\"js_code\": \"\", \"py_code\": code}\n",
    "pattern_analysis": {
      "api_sequence": [
        "self.stac_json.get",
        "self.stac_json.get",
        "self.stac_json.__setitem__"
      ],
      "api_sequence_with_args": [
        "self.stac_json.get(\"code\")",
        "self.stac_json.get(\"code\").get(\"js_code\")",
        "self.stac_json.__setitem__(\"code\", {\"js_code\": \"\", \"py_code\": code})"
      ],
      "mapped_sequence": [],
      "contextual_code": "def set_js_code(self, code: str) -> None:\n    if not code:\n        return \"\"\n    js_code = self.stac_json.get(\"code\").get(\"js_code\")\n    self.stac_json[\"code\"] = {\"js_code\": \"\", \"py_code\": code}\n"
    }
  },
  {
    "pyfile": "common.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/geemap-0.35.3/geemap-0.35.3/geemap/common.py",
    "line_number": "4245",
    "type_description": "B834:open",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "4244\n4245\t    with open(html_file) as f:\n4246\t        in_html_lines = f.readlines()",
    "code_snippet": "def read_api_csv():\n    \"\"\"Extracts Earth Engine API from a csv file and returns a dictionary containing information about each function.\n\n    Returns:\n        dict: The dictionary containing information about each function, including name, description, function form, return type, arguments, html.\n    \"\"\"\n    import copy\n\n    import pkg_resources\n\n    pkg_dir = os.path.dirname(pkg_resources.resource_filename(\"geemap\", \"geemap.py\"))\n    data_dir = os.path.join(pkg_dir, \"data\")\n    template_dir = os.path.join(data_dir, \"template\")\n    csv_file = os.path.join(template_dir, \"ee_api_docs.csv\")\n    html_file = os.path.join(template_dir, \"ee_api_docs.html\")\n\n    with open(html_file) as f:\n        in_html_lines = f.readlines()\n\n    api_dict = {}\n\n    with open(csv_file, \"r\", encoding=\"utf-8\") as f:\n        csv_reader = csv.DictReader(f, delimiter=\"\\t\")\n\n        for line in csv_reader:\n            out_html_lines = copy.copy(in_html_lines)\n            out_html_lines[65] = in_html_lines[65].replace(\n                \"function_name\", line[\"name\"]\n            )\n            out_html_lines[66] = in_html_lines[66].replace(\n                \"function_description\", line.get(\"description\")\n            )\n            out_html_lines[74] = in_html_lines[74].replace(\n                \"function_usage\", line.get(\"function\")\n            )\n            out_html_lines[75] = in_html_lines[75].replace(\n                \"function_returns\", line.get(\"returns\")\n            )\n\n            arguments = line.get(\"argument\")\n            types = line.get(\"type\")\n            details = line.get(\"details\")\n\n            if \"|\" in arguments:\n                argument_items = arguments.split(\"|\")\n            else:\n                argument_items = [arguments]\n\n            if \"|\" in types:\n                types_items = types.split(\"|\")\n            else:\n                types_items = [types]\n\n            if \"|\" in details:\n                details_items = details.split(\"|\")\n            else:\n                details_items = [details]\n\n            out_argument_lines = []\n\n            for index in range(len(argument_items)):\n                in_argument_lines = in_html_lines[87:92]\n                in_argument_lines[1] = in_argument_lines[1].replace(\n                    \"function_argument\", argument_items[index]\n                )\n                in_argument_lines[2] = in_argument_lines[2].replace(\n                    \"function_type\", types_items[index]\n                )\n                in_argument_lines[3] = in_argument_lines[3].replace(\n                    \"function_details\", details_items[index]\n                )\n                out_argument_lines.append(\"\".join(in_argument_lines))\n\n            out_html_lines = (\n                out_html_lines[:87] + out_argument_lines + out_html_lines[92:]\n            )\n\n            contents = \"\".join(out_html_lines)\n\n            api_dict[line[\"name\"]] = {\n                \"description\": line.get(\"description\"),\n                \"function\": line.get(\"function\"),\n                \"returns\": line.get(\"returns\"),\n                \"argument\": line.get(\"argument\"),\n                \"type\": line.get(\"type\"),\n                \"details\": line.get(\"details\"),\n                \"html\": contents,\n            }\n\n    return api_dict\n",
    "pattern_analysis": {
      "api_sequence": [
        "pkg_resources.resource_filename",
        "os.path.dirname",
        "os.path.join",
        "os.path.join",
        "os.path.join",
        "os.path.join",
        "open",
        "open.read",
        "open",
        "csv.DictReader"
      ],
      "api_sequence_with_args": [
        "pkg_resources.resource_filename(\"geemap\", \"geemap.py\")",
        "os.path.dirname(pkg_resources.resource_filename(\"geemap\", \"geemap.py\"))",
        "os.path.join(pkg_dir, \"data\")",
        "os.path.join(data_dir, \"template\")",
        "os.path.join(template_dir, \"ee_api_docs.csv\")",
        "os.path.join(template_dir, \"ee_api_docs.html\")",
        "open(html_file)",
        "f.readlines()",
        "open(csv_file, \"r\", encoding=\"utf-8\")",
        "csv.DictReader(f, delimiter=\"\\t\")"
      ],
      "mapped_sequence": [
        {
          "api_name": "pkg_resources.resource_filename",
          "id": "path_special_operations",
          "description": "Special path operations (home directory expansion, temporary directory path, executable path, directory tree generation)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.path.dirname",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.path.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.path.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.path.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.path.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open.read",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "csv.DictReader",
          "id": "deserialize_from_bytes",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        }
      ],
      "contextual_code": "import pkg_resources\nimport os\nimport csv\nimport copy\n\npkg_dir = os.path.dirname(pkg_resources.resource_filename(\"geemap\", \"geemap.py\"))\ndata_dir = os.path.join(pkg_dir, \"data\")\ntemplate_dir = os.path.join(data_dir, \"template\")\ncsv_file = os.path.join(template_dir, \"ee_api_docs.csv\")\nhtml_file = os.path.join(template_dir, \"ee_api_docs.html\")\n\nwith open(html_file) as f:\n    in_html_lines = f.readlines()\n\nwith open(csv_file, \"r\", encoding=\"utf-8\") as f:\n    csv_reader = csv.DictReader(f, delimiter=\"\\t\")\n    # ... further processing"
    }
  },
  {
    "pyfile": "common.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/geemap-0.35.3/geemap-0.35.3/geemap/common.py",
    "line_number": "2450",
    "type_description": "B834:open",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "2449\t    else:\n2450\t        with open(out_geojson, \"w\", encoding=encoding) as f:\n2451\t            f.write(json.dumps(geojson))",
    "code_snippet": "def csv_to_geojson(\n    in_csv,\n    out_geojson=None,\n    latitude=\"latitude\",\n    longitude=\"longitude\",\n    encoding=\"utf-8\",\n):\n    \"\"\"Creates points for a CSV file and exports data as a GeoJSON.\n\n    Args:\n        in_csv (str): The file path to the input CSV file.\n        out_geojson (str): The file path to the exported GeoJSON. Default to None.\n        latitude (str, optional): The name of the column containing latitude coordinates. Defaults to \"latitude\".\n        longitude (str, optional): The name of the column containing longitude coordinates. Defaults to \"longitude\".\n        encoding (str, optional): The encoding of characters. Defaults to \"utf-8\".\n\n    \"\"\"\n\n    import pandas as pd\n\n    in_csv = github_raw_url(in_csv)\n\n    if out_geojson is not None:\n        out_geojson = check_file_path(out_geojson)\n\n    df = pd.read_csv(in_csv)\n    geojson = df_to_geojson(\n        df, latitude=latitude, longitude=longitude, encoding=encoding\n    )\n\n    if out_geojson is None:\n        return geojson\n    else:\n        with open(out_geojson, \"w\", encoding=encoding) as f:\n            f.write(json.dumps(geojson))",
    "pattern_analysis": {
      "api_sequence": [
        "github_raw_url",
        "check_file_path",
        "pandas.read_csv",
        "df_to_geojson",
        "open",
        "json.dumps",
        "io.TextIOWrapper.write"
      ],
      "api_sequence_with_args": [
        "github_raw_url(in_csv)",
        "check_file_path(out_geojson)",
        "pandas.read_csv(in_csv)",
        "df_to_geojson(df, latitude=latitude, longitude=longitude, encoding=encoding)",
        "open(out_geojson, \"w\", encoding=encoding)",
        "json.dumps(geojson)",
        "f.write(json.dumps(geojson))"
      ],
      "mapped_sequence": [
        {
          "api_name": "github_raw_url",
          "id": "open_url_get",
          "description": "Opens URL with GET parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "check_file_path",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "pandas.read_csv",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "df_to_geojson",
          "id": "serialize_to_json",
          "description": "Serializes Python object to JSON string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "json.dumps",
          "id": "serialize_to_json",
          "description": "Serializes Python object to JSON string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "io.TextIOWrapper.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        }
      ],
      "contextual_code": "def csv_to_geojson(\n    in_csv,\n    out_geojson=None,\n    latitude=\"latitude\",\n    longitude=\"longitude\",\n    encoding=\"utf-8\",\n):\n    import pandas as pd\n\n    in_csv = github_raw_url(in_csv)\n\n    if out_geojson is not None:\n        out_geojson = check_file_path(out_geojson)\n\n    df = pd.read_csv(in_csv)\n    geojson = df_to_geojson(\n        df, latitude=latitude, longitude=longitude, encoding=encoding\n    )\n\n    if out_geojson is None:\n        return geojson\n    else:\n        with open(out_geojson, \"w\", encoding=encoding) as f:\n            f.write(json.dumps(geojson))"
    }
  }
]