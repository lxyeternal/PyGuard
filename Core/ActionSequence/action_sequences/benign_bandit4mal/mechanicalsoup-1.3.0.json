[
  {
    "metadata": {
      "package_name": "mechanicalsoup-1.3.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "test_browser.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/mechanicalsoup-1.3.0/MechanicalSoup-1.3.0/tests/test_browser.py",
    "line_number": "280",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "279\t    browser.set_cookiejar(jar)\n280\t    resp = browser.get(httpbin + \"/cookies\")\n281\t    assert resp.json() == {'cookies': {'field': 'value'}}",
    "code_snippet": "def test_set_cookiejar(httpbin):\n    \"\"\"Set cookies locally and test that they are received remotely.\"\"\"\n    # construct a phony cookiejar and attach it to the session\n    jar = RequestsCookieJar()\n    jar.set('field', 'value')\n    assert jar.get('field') == 'value'\n\n    browser = mechanicalsoup.Browser()\n    browser.set_cookiejar(jar)\n    resp = browser.get(httpbin + \"/cookies\")\n    assert resp.json() == {'cookies': {'field': 'value'}}\n",
    "pattern_analysis": {
      "api_sequence": [
        "RequestsCookieJar",
        "RequestsCookieJar.set",
        "RequestsCookieJar.get",
        "mechanicalsoup.Browser",
        "mechanicalsoup.Browser.set_cookiejar",
        "mechanicalsoup.Browser.get",
        "mechanicalsoup.Browser.get.json"
      ],
      "api_sequence_with_args": [
        "RequestsCookieJar()",
        "RequestsCookieJar.set('field', 'value')",
        "RequestsCookieJar.get('field')",
        "mechanicalsoup.Browser()",
        "mechanicalsoup.Browser.set_cookiejar(jar)",
        "mechanicalsoup.Browser.get(httpbin + \"/cookies\")",
        "mechanicalsoup.Browser.get(json)"
      ],
      "mapped_sequence": [
        {
          "api_name": "RequestsCookieJar",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "RequestsCookieJar.set",
          "id": "set_file_attributes",
          "description": "Sets file attributes for specified file",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_attribute_management"
        },
        {
          "api_name": "RequestsCookieJar.get",
          "id": "get_registry_value",
          "description": "Retrieves value and data type for specified registry value",
          "first_id": "system_operations",
          "second_id": "registry_operations",
          "third_id": "registry_modification"
        },
        {
          "api_name": "mechanicalsoup.Browser",
          "id": "init_browser_class",
          "description": "Instantiates Browser class with configuration",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "instance_creation"
        },
        {
          "api_name": "mechanicalsoup.Browser.set_cookiejar",
          "id": "set_file_attributes",
          "description": "Sets file attributes for specified file",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_attribute_management"
        },
        {
          "api_name": "mechanicalsoup.Browser.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "mechanicalsoup.Browser.get.json",
          "id": "deserialize_json_response",
          "description": "Deserializes JSON response body to Python object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        }
      ],
      "contextual_code": "def test_set_cookiejar(httpbin):\n    jar = RequestsCookieJar()\n    jar.set('field', 'value')\n    assert jar.get('field') == 'value'\n\n    browser = mechanicalsoup.Browser()\n    browser.set_cookiejar(jar)\n    resp = browser.get(httpbin + \"/cookies\")\n    assert resp.json() == {'cookies': {'field': 'value'}}"
    }
  }
]