[
  {
    "metadata": {
      "package_name": "launchdarkly_server_sdk-9.10.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "migrator.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/launchdarkly_server_sdk-9.10.0/launchdarkly_server_sdk-9.10.0/ldclient/migrations/migrator.py",
    "line_number": "97",
    "type_description": "B840:executor",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "96\n97\t        old = Executor(Origin.OLD, self.__write_config.old, tracker, self.__measure_latency, self.__measure_errors, payload)\n98\t        new = Executor(Origin.NEW, self.__write_config.new, tracker, self.__measure_latency, self.__measure_errors, payload)",
    "code_snippet": "def write(self, key: str, context: Context, default_stage: Stage, payload: Optional[Any] = None) -> WriteResult:\n    stage, tracker = self.__client.migration_variation(key, context, default_stage)\n    tracker.operation(Operation.WRITE)\n\n    old = Executor(Origin.OLD, self.__write_config.old, tracker, self.__measure_latency, self.__measure_errors, payload)\n    new = Executor(Origin.NEW, self.__write_config.new, tracker, self.__measure_latency, self.__measure_errors, payload)\n\n    if stage == Stage.OFF:\n        result = old.run()\n        write_result = WriteResult(result)\n    elif stage == Stage.DUALWRITE:\n        authoritative_result, nonauthoritative_result = self.__write_both(old, new, tracker)\n        write_result = WriteResult(authoritative_result, nonauthoritative_result)\n    elif stage == Stage.SHADOW:\n        authoritative_result, nonauthoritative_result = self.__write_both(old, new, tracker)\n        write_result = WriteResult(authoritative_result, nonauthoritative_result)\n    elif stage == Stage.LIVE:\n        authoritative_result, nonauthoritative_result = self.__write_both(new, old, tracker)\n        write_result = WriteResult(authoritative_result, nonauthoritative_result)\n    elif stage == Stage.RAMPDOWN:\n        authoritative_result, nonauthoritative_result = self.__write_both(new, old, tracker)\n        write_result = WriteResult(authoritative_result, nonauthoritative_result)\n    else:\n        result = new.run()\n        write_result = WriteResult(result)\n\n    self.__client.track_migration_op(tracker)\n\n    return write_result",
    "pattern_analysis": {
      "api_sequence": [
        "self.__client.migration_variation",
        "tracker.operation",
        "Executor",
        "Executor",
        "old.run",
        "WriteResult",
        "self.__write_both",
        "WriteResult",
        "self.__write_both",
        "WriteResult",
        "self.__write_both",
        "WriteResult",
        "self.__write_both",
        "WriteResult",
        "new.run",
        "WriteResult",
        "self.__client.track_migration_op"
      ],
      "api_sequence_with_args": [
        "self.__client.migration_variation(key, context, default_stage)",
        "tracker.operation(Operation.WRITE)",
        "Executor(Origin.OLD, self.__write_config.old, tracker, self.__measure_latency, self.__measure_errors, payload)",
        "Executor(Origin.NEW, self.__write_config.new, tracker, self.__measure_latency, self.__measure_errors, payload)",
        "old.run()",
        "WriteResult(result)",
        "self.__write_both(old, new, tracker)",
        "WriteResult(authoritative_result, nonauthoritative_result)",
        "self.__write_both(old, new, tracker)",
        "WriteResult(authoritative_result, nonauthoritative_result)",
        "self.__write_both(new, old, tracker)",
        "WriteResult(authoritative_result, nonauthoritative_result)",
        "self.__write_both(new, old, tracker)",
        "WriteResult(authoritative_result, nonauthoritative_result)",
        "new.run()",
        "WriteResult(result)",
        "self.__client.track_migration_op(tracker)"
      ],
      "mapped_sequence": [
        {
          "api_name": "self.__client.migration_variation",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "tracker.operation",
          "id": "log_info",
          "description": "Logs informational message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "Executor",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "Executor",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "old.run",
          "id": "exec_python_code",
          "description": "Dynamically executes Python code string",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "string_execution"
        },
        {
          "api_name": "WriteResult",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "self.__write_both",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "WriteResult",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "self.__write_both",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "WriteResult",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "self.__write_both",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "WriteResult",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "self.__write_both",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "WriteResult",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "new.run",
          "id": "exec_python_code",
          "description": "Dynamically executes Python code string",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "string_execution"
        },
        {
          "api_name": "WriteResult",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "self.__client.track_migration_op",
          "id": "log_info",
          "description": "Logs informational message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        }
      ],
      "contextual_code": "def write(self, key: str, context: Context, default_stage: Stage, payload: Optional[Any] = None) -> WriteResult:\n    stage, tracker = self.__client.migration_variation(key, context, default_stage)\n    tracker.operation(Operation.WRITE)\n\n    old = Executor(Origin.OLD, self.__write_config.old, tracker, self.__measure_latency, self.__measure_errors, payload)\n    new = Executor(Origin.NEW, self.__write_config.new, tracker, self.__measure_latency, self.__measure_errors, payload)\n\n    if stage == Stage.OFF:\n        result = old.run()\n        write_result = WriteResult(result)\n    elif stage == Stage.DUALWRITE:\n        authoritative_result, nonauthoritative_result = self.__write_both(old, new, tracker)\n        write_result = WriteResult(authoritative_result, nonauthoritative_result)\n    elif stage == Stage.SHADOW:\n        authoritative_result, nonauthoritative_result = self.__write_both(old, new, tracker)\n        write_result = WriteResult(authoritative_result, nonauthoritative_result)\n    elif stage == Stage.LIVE:\n        authoritative_result, nonauthoritative_result = self.__write_both(new, old, tracker)\n        write_result = WriteResult(authoritative_result, nonauthoritative_result)\n    elif stage == Stage.RAMPDOWN:\n        authoritative_result, nonauthoritative_result = self.__write_both(new, old, tracker)\n        write_result = WriteResult(authoritative_result, nonauthoritative_result)\n    else:\n        result = new.run()\n        write_result = WriteResult(result)\n\n    self.__client.track_migration_op(tracker)\n\n    return write_result"
    }
  }
]