[
  {
    "metadata": {
      "package_name": "azure_cli_appservice-0.2.21-py2.py3-none-any",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "custom.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/azure_cli_appservice-0.2.21-py2.py3-none-any/azure/cli/command_modules/appservice/custom.py",
    "line_number": "1700",
    "type_description": "B830:read",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1699\t    user, password = _get_site_credential(cmd.cli_ctx, resource_group_name, name, slot)\n1700\t    t = threading.Thread(target=_get_log, args=(streaming_url, user, password))\n1701\t    t.daemon = True",
    "code_snippet": "def get_streaming_log(cmd, resource_group_name, name, provider=None, slot=None):\n    scm_url = _get_scm_url(cmd, resource_group_name, name, slot)\n    streaming_url = scm_url + '/logstream'\n    if provider:\n        streaming_url += ('/' + provider.lstrip('/'))\n\n    user, password = _get_site_credential(cmd.cli_ctx, resource_group_name, name, slot)\n    t = threading.Thread(target=_get_log, args=(streaming_url, user, password))\n    t.daemon = True\n    t.start()\n\n    while True:\n        time.sleep(100)  # so that ctrl+c can stop the command\n",
    "pattern_analysis": {
      "api_sequence": [
        "_get_scm_url",
        "_get_site_credential",
        "threading.Thread",
        "threading.Thread.start",
        "time.sleep"
      ],
      "api_sequence_with_args": [
        "_get_scm_url(cmd, resource_group_name, name, slot)",
        "_get_site_credential(cmd.cli_ctx, resource_group_name, name, slot)",
        "threading.Thread(target=_get_log, args=(streaming_url, user, password))",
        "threading.Thread.start()",
        "time.sleep(100)"
      ],
      "mapped_sequence": [
        {
          "api_name": "_get_scm_url",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "_get_site_credential",
          "id": "deserialize_from_bytes",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "threading.Thread",
          "id": "create_thread",
          "description": "Creates new thread to execute target function",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_creation"
        },
        {
          "api_name": "threading.Thread.start",
          "id": "start_thread",
          "description": "Starts thread execution",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_control"
        },
        {
          "api_name": "time.sleep",
          "id": "suspend_execution",
          "description": "Suspends execution for specified seconds",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        }
      ],
      "contextual_code": "def get_streaming_log(cmd, resource_group_name, name, provider=None, slot=None):\n    scm_url = _get_scm_url(cmd, resource_group_name, name, slot)\n    streaming_url = scm_url + '/logstream'\n    if provider:\n        streaming_url += ('/' + provider.lstrip('/'))\n\n    user, password = _get_site_credential(cmd.cli_ctx, resource_group_name, name, slot)\n    t = threading.Thread(target=_get_log, args=(streaming_url, user, password))\n    t.daemon = True\n    t.start()\n\n    while True:\n        time.sleep(100)  # so that ctrl+c can stop the command"
    }
  }
]