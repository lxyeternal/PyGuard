[
  {
    "metadata": {
      "package_name": "azure_ml_component-0.9.18.post2-py3-none-any",
      "total_matches": 2,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "_step_run_debug_helper.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/azure_ml_component-0.9.18.post2-py3-none-any/azure/ml/component/_debug/_step_run_debug_helper.py",
    "line_number": "1066",
    "type_description": "B814:read",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1065\t            process.wait()\n1066\t            process_stdout = process.stdout.read()\n1067\t            return \"--debug\" in process_stdout",
    "code_snippet": "def bootstrapper_support_debug(vm_bootstrapper_path):\n    \"\"\"Check bootstrapper contains debug args\"\"\"\n    # TODO: Remove this before merging into master.\n    process = subprocess.Popen(f\"{vm_bootstrapper_path} --help\", stdout=subprocess.PIPE, shell=True,\n                               stderr=subprocess.STDOUT, encoding='utf-8')\n    process.wait()\n    process_stdout = process.stdout.read()\n    return \"--debug\" in process_stdout",
    "pattern_analysis": {
      "api_sequence": [
        "subprocess.Popen",
        "subprocess.Popen.wait",
        "subprocess.Popen.stdout.read"
      ],
      "api_sequence_with_args": [
        "subprocess.Popen(f\"{vm_bootstrapper_path} --help\", stdout=subprocess.PIPE, shell=True, stderr=subprocess.STDOUT, encoding='utf-8')",
        "subprocess.Popen.wait()",
        "subprocess.Popen.stdout.read()"
      ],
      "mapped_sequence": [
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        },
        {
          "api_name": "subprocess.Popen.wait",
          "id": "wait_process_completion",
          "description": "Waits for process to complete execution",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_control"
        },
        {
          "api_name": "subprocess.Popen.stdout.read",
          "id": "read_process_stdout",
          "description": "Reads all bytes from process standard output",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_information"
        }
      ],
      "contextual_code": "def bootstrapper_support_debug(vm_bootstrapper_path):\n    process = subprocess.Popen(f\"{vm_bootstrapper_path} --help\", stdout=subprocess.PIPE, shell=True,\n                               stderr=subprocess.STDOUT, encoding='utf-8')\n    process.wait()\n    process_stdout = process.stdout.read()\n    return \"--debug\" in process_stdout"
    }
  },
  {
    "pyfile": "_cache.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/azure_ml_component-0.9.18.post2-py3-none-any/azure/ml/component/_util/_cache.py",
    "line_number": "372",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "371\t        key = self._convert_register_params_to_cache_key(key)\n372\t        return super(RegisteredComponentDiskCache, self).get(key=key, default=default)\n373",
    "code_snippet": "class RegisteredComponentDiskCache(DiskCache):\n    \"\"\"Disk cache of registered pipeline component dto. The expire time of the component dto is 1 week.\"\"\"\n    DEFAULT_DISK_CACHE_DIRECTORY = os.path.join(DiskCache.DEFAULT_DISK_CACHE_DIRECTORY, \"registered_component\")\n    EXPIRE = 7 * 24 * 60 * 60\n    _CACHE_ENV_VARIABLE = COMPONENT_CACHE_ENV_VARIABLE\n    _EXPIRE_ENV_VARIABLE = COMPONENT_EXPIRE_ENV_VARIABLE\n\n    @staticmethod\n    def _convert_register_params_to_cache_key(register_params):\n        return hashlib.sha1(json.dumps(register_params, sort_keys=True).encode(\"utf-8\")).hexdigest()\n\n    def _serialize(self, data):\n        return json.dumps(data.serialize())\n\n    def _deserialize(self, data):\n        client_models = {k: v for k, v in models.__dict__.items() if isinstance(v, type)}\n        deserializer = Deserializer(client_models)\n        return deserializer('ModuleDto', json.loads(data))\n\n    def get(self, key, default=None):\n        \"\"\"Get registered component from disk cache.\"\"\"\n        key = self._convert_register_params_to_cache_key(key)\n        return super(RegisteredComponentDiskCache, self).get(key=key, default=default)\n",
    "pattern_analysis": {
      "api_sequence": [
        "os.path.join",
        "hashlib.sha1",
        "json.dumps",
        "str.encode",
        "hashlib.sha1.hexdigest",
        "json.dumps",
        "models.__dict__.items",
        "isinstance",
        "json.loads"
      ],
      "api_sequence_with_args": [
        "os.path.join(DiskCache.DEFAULT_DISK_CACHE_DIRECTORY, \"registered_component\")",
        "hashlib.sha1(json.dumps(register_params, sort_keys=True).encode(\"utf-8\"))",
        "json.dumps(register_params, sort_keys=True)",
        "str.encode(\"utf-8\")",
        "hashlib.sha1(...).hexdigest()",
        "json.dumps(data.serialize())",
        "models.__dict__.items",
        "isinstance(v, type)",
        "json.loads(data)"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.path.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "hashlib.sha1",
          "id": "create_sha1_hash",
          "description": "Creates SHA-1 hash object from encoded string",
          "first_id": "encryption_hashing",
          "second_id": "hash_calculation",
          "third_id": "hash_object_creation"
        },
        {
          "api_name": "json.dumps",
          "id": "serialize_to_json",
          "description": "Serializes Python object to JSON string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "str.encode",
          "id": "encode_string_to_bytes",
          "description": "Encodes string to bytes using default encoding",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "hashlib.sha1.hexdigest",
          "id": "get_sha1_digest",
          "description": "Returns hexadecimal digest of SHA-1 hash",
          "first_id": "encryption_hashing",
          "second_id": "hash_calculation",
          "third_id": "hash_value_retrieval"
        },
        {
          "api_name": "json.dumps",
          "id": "serialize_to_json",
          "description": "Serializes Python object to JSON string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "models.__dict__.items",
          "id": "get_global_symbols",
          "description": "Retrieves global symbol table as dictionary",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "isinstance",
          "id": "check_instance_type",
          "description": "Checks if object is instance of specified type",
          "first_id": "utility_functions",
          "second_id": "logging_exception_handling",
          "third_id": "exception_checking"
        },
        {
          "api_name": "json.loads",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        }
      ],
      "contextual_code": "class RegisteredComponentDiskCache(DiskCache):\n    DEFAULT_DISK_CACHE_DIRECTORY = os.path.join(DiskCache.DEFAULT_DISK_CACHE_DIRECTORY, \"registered_component\")\n    \n    @staticmethod\n    def _convert_register_params_to_cache_key(register_params):\n        return hashlib.sha1(json.dumps(register_params, sort_keys=True).encode(\"utf-8\")).hexdigest()\n\n    def _serialize(self, data):\n        return json.dumps(data.serialize())\n\n    def _deserialize(self, data):\n        client_models = {k: v for k, v in models.__dict__.items() if isinstance(v, type)}\n        deserializer = Deserializer(client_models)\n        return deserializer('ModuleDto', json.loads(data))"
    }
  }
]