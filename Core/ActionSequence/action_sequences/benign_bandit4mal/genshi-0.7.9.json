[
  {
    "metadata": {
      "package_name": "genshi-0.7.9",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "loader.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/genshi-0.7.9/Genshi-0.7.9/genshi/template/tests/loader.py",
    "line_number": "506",
    "type_description": "B832:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "505\t        try:\n506\t            file4.write(\"\"\"<div>bar/tmpl3</div>\"\"\")\n507\t        finally:",
    "code_snippet": "def test_prefix_delegation_to_directories_with_subdirs(self):\n    \"\"\"\n    Test prefix delegation with the following layout:\n    \n    templates/foo.html\n    sub1/templates/tmpl1.html\n    sub1/templates/tmpl2.html\n    sub1/templates/bar/tmpl3.html\n    \n    Where sub1 is a prefix, and tmpl1.html includes all the others.\n    \"\"\"\n    dir1 = os.path.join(self.dirname, 'templates')\n    os.mkdir(dir1)\n    file1 = open(os.path.join(dir1, 'foo.html'), 'w')\n    try:\n        file1.write(\"\"\"<div>Included foo</div>\"\"\")\n    finally:\n        file1.close()\n\n    dir2 = os.path.join(self.dirname, 'sub1', 'templates')\n    os.makedirs(dir2)\n    file2 = open(os.path.join(dir2, 'tmpl1.html'), 'w')\n    try:\n        file2.write(\"\"\"<html xmlns:xi=\"http://www.w3.org/2001/XInclude\">\n          <xi:include href=\"../foo.html\" /> from sub1\n          <xi:include href=\"tmpl2.html\" /> from sub1\n          <xi:include href=\"bar/tmpl3.html\" /> from sub1\n        </html>\"\"\")\n    finally:\n        file2.close()\n\n    file3 = open(os.path.join(dir2, 'tmpl2.html'), 'w')\n    try:\n        file3.write(\"\"\"<div>tmpl2</div>\"\"\")\n    finally:\n        file3.close()\n\n    dir3 = os.path.join(self.dirname, 'sub1', 'templates', 'bar')\n    os.makedirs(dir3)\n    file4 = open(os.path.join(dir3, 'tmpl3.html'), 'w')\n    try:\n        file4.write(\"\"\"<div>bar/tmpl3</div>\"\"\")\n    finally:\n        file4.close()\n\n    loader = TemplateLoader([dir1, TemplateLoader.prefixed(\n        sub1 = os.path.join(dir2),\n        sub2 = os.path.join(dir3)\n    )])\n    tmpl = loader.load('sub1/tmpl1.html')\n    self.assertEqual(\"\"\"<html>\n          <div>Included foo</div> from sub1\n          <div>tmpl2</div> from sub1\n          <div>bar/tmpl3</div> from sub1\n        </html>\"\"\", tmpl.generate().render(encoding=None))",
    "pattern_analysis": {
      "api_sequence": [
        "os.path.join",
        "os.mkdir",
        "os.path.join",
        "open",
        "file.write",
        "file.close",
        "os.path.join",
        "os.makedirs",
        "os.path.join",
        "open",
        "file.write",
        "file.close",
        "os.path.join",
        "open",
        "file.write",
        "file.close",
        "os.path.join",
        "os.makedirs",
        "os.path.join",
        "open",
        "file.write",
        "file.close"
      ],
      "api_sequence_with_args": [
        "os.path.join(self.dirname, 'templates')",
        "os.mkdir(dir1)",
        "os.path.join(dir1, 'foo.html')",
        "open(os.path.join(dir1, 'foo.html'), 'w')",
        "file1.write(\"\"\"<div>Included foo</div>\"\"\")",
        "file1.close()",
        "os.path.join(self.dirname, 'sub1', 'templates')",
        "os.makedirs(dir2)",
        "os.path.join(dir2, 'tmpl1.html')",
        "open(os.path.join(dir2, 'tmpl1.html'), 'w')",
        "file2.write(\"\"\"<html xmlns:xi=\"http://www.w3.org/2001/XInclude\">\n          <xi:include href=\"../foo.html\" /> from sub1\n          <xi:include href=\"tmpl2.html\" /> from sub1\n          <xi:include href=\"bar/tmpl3.html\" /> from sub1\n        </html>\"\"\")",
        "file2.close()",
        "os.path.join(dir2, 'tmpl2.html')",
        "open(os.path.join(dir2, 'tmpl2.html'), 'w')",
        "file3.write(\"\"\"<div>tmpl2</div>\"\"\")",
        "file3.close()",
        "os.path.join(self.dirname, 'sub1', 'templates', 'bar')",
        "os.makedirs(dir3)",
        "os.path.join(dir3, 'tmpl3.html')",
        "open(os.path.join(dir3, 'tmpl3.html'), 'w')",
        "file4.write(\"\"\"<div>bar/tmpl3</div>\"\"\")",
        "file4.close()"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.path.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.mkdir",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "os.path.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "file.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "file.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "os.path.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.makedirs",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "os.path.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "file.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "file.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "os.path.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "file.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "file.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "os.path.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.makedirs",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "os.path.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "file.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "file.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        }
      ],
      "contextual_code": "dir1 = os.path.join(self.dirname, 'templates')\nos.mkdir(dir1)\nfile1 = open(os.path.join(dir1, 'foo.html'), 'w')\ntry:\n    file1.write(\"\"\"<div>Included foo</div>\"\"\")\nfinally:\n    file1.close()\n\ndir2 = os.path.join(self.dirname, 'sub1', 'templates')\nos.makedirs(dir2)\nfile2 = open(os.path.join(dir2, 'tmpl1.html'), 'w')\ntry:\n    file2.write(\"\"\"<html xmlns:xi=\"http://www.w3.org/2001/XInclude\">\n          <xi:include href=\"../foo.html\" /> from sub1\n          <xi:include href=\"tmpl2.html\" /> from sub1\n          <xi:include href=\"bar/tmpl3.html\" /> from sub1\n        </html>\"\"\")\nfinally:\n    file2.close()\n\nfile3 = open(os.path.join(dir2, 'tmpl2.html'), 'w')\ntry:\n    file3.write(\"\"\"<div>tmpl2</div>\"\"\")\nfinally:\n    file3.close()\n\ndir3 = os.path.join(self.dirname, 'sub1', 'templates', 'bar')\nos.makedirs(dir3)\nfile4 = open(os.path.join(dir3, 'tmpl3.html'), 'w')\ntry:\n    file4.write(\"\"\"<div>bar/tmpl3</div>\"\"\")\nfinally:\n    file4.close()"
    }
  }
]