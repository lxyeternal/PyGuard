[
  {
    "metadata": {
      "package_name": "ddtrace-3.4.1",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "app.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/ddtrace-3.4.1/ddtrace-3.4.1/tests/appsec/app.py",
    "line_number": "485",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "484\tdef iast_ast_patching_re_subn():\n485\t    filename = request.args.get(\"filename\")\n486\t    style = request.args.get(\"style\")",
    "code_snippet": "@app.route(\"/iast-ast-patching-re-subn\", methods=[\"GET\"])\ndef iast_ast_patching_re_subn():\n    filename = request.args.get(\"filename\")\n    style = request.args.get(\"style\")\n    changed = \"\"\n    if style == \"re_module\":\n        changed, number = re.subn(r\"_\", \" \", filename)\n    elif style == \"re_object\":\n        pattern = re.compile(r\"_\")\n        changed, number = pattern.subn(\" \", filename)\n    resp = Response(\"Fail\")\n    if is_pyobject_tainted(changed):\n        resp = Response(\"OK\")\n    return resp",
    "pattern_analysis": {
      "api_sequence": [
        "request.args.get",
        "request.args.get",
        "re.subn",
        "re.compile",
        "re.Pattern.subn",
        "is_pyobject_tainted"
      ],
      "api_sequence_with_args": [
        "request.args.get(\"filename\")",
        "request.args.get(\"style\")",
        "re.subn(r\"_\", \" \", filename)",
        "re.compile(r\"_\")",
        "re.Pattern.subn(\" \", filename)",
        "is_pyobject_tainted(changed)"
      ],
      "mapped_sequence": [
        {
          "api_name": "request.args.get",
          "id": "read_user_input",
          "description": "Reads user input from standard input",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "request.args.get",
          "id": "read_user_input",
          "description": "Reads user input from standard input",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "re.subn",
          "id": "compile_regex",
          "description": "Compiles regular expression pattern",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "code_compilation"
        },
        {
          "api_name": "re.compile",
          "id": "compile_regex",
          "description": "Compiles regular expression pattern",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "code_compilation"
        },
        {
          "api_name": "re.Pattern.subn",
          "id": "compile_regex",
          "description": "Compiles regular expression pattern",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "code_compilation"
        },
        {
          "api_name": "is_pyobject_tainted",
          "id": "check_instance_type",
          "description": "Checks if object is instance of specified type",
          "first_id": "utility_functions",
          "second_id": "logging_exception_handling",
          "third_id": "exception_checking"
        }
      ],
      "contextual_code": "@app.route(\"/iast-ast-patching-re-subn\", methods=[\"GET\"])\ndef iast_ast_patching_re_subn():\n    filename = request.args.get(\"filename\")\n    style = request.args.get(\"style\")\n    changed = \"\"\n    if style == \"re_module\":\n        changed, number = re.subn(r\"_\", \" \", filename)\n    elif style == \"re_object\":\n        pattern = re.compile(r\"_\")\n        changed, number = pattern.subn(\" \", filename)\n    resp = Response(\"Fail\")\n    if is_pyobject_tainted(changed):\n        resp = Response(\"OK\")\n    return resp"
    }
  }
]