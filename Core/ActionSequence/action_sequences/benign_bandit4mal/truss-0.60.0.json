[
  {
    "metadata": {
      "package_name": "truss-0.60.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "test_model_schema.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/truss-0.60.0/truss-0.60.0/truss/tests/test_model_schema.py",
    "line_number": "87",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "86\n87\t        schema_response = requests.get(SCHEMA_URL)\n88",
    "code_snippet": "@pytest.mark.integration\ndef test_truss_with_no_annotations(test_data_path):\n    truss_dir = test_data_path / \"test_basic_truss\"\n\n    tr = TrussHandle(truss_dir)\n\n    with ensure_kill_all():\n        _ = tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)\n\n        response = requests.post(INFERENCE_URL, json={\"prompt\": \"value\"})\n        assert response.json() == {\"prompt\": \"value\"}\n\n        schema_response = requests.get(SCHEMA_URL)\n        assert schema_response.status_code == 404\n\n        assert schema_response.json()[\"error\"] == \"No schema found\"\n        assert schema_response.headers[\"x-baseten-error-source\"] == \"04\"\n        assert schema_response.headers[\"x-baseten-error-code\"] == \"600\"",
    "pattern_analysis": {
      "api_sequence": [
        "TrussHandle",
        "TrussHandle.docker_run",
        "requests.post",
        "requests.get",
        "requests.models.Response.json",
        "requests.models.Response.status_code",
        "requests.models.Response.json",
        "requests.models.Response.headers"
      ],
      "api_sequence_with_args": [
        "TrussHandle(truss_dir)",
        "TrussHandle.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)",
        "requests.post(INFERENCE_URL, json={\"prompt\": \"value\"})",
        "requests.get(SCHEMA_URL)",
        "requests.models.Response.json()",
        "requests.models.Response.status_code",
        "requests.models.Response.json()",
        "requests.models.Response.headers"
      ],
      "mapped_sequence": [
        {
          "api_name": "TrussHandle",
          "id": "init_grabber_class",
          "description": "Instantiates Grabber class",
          "first_id": "data_exfiltration",
          "second_id": "exfiltration_component_initialization",
          "third_id": "exfiltration_component_creation"
        },
        {
          "api_name": "TrussHandle.docker_run",
          "id": "spawn_process_no_shell",
          "description": "Spawns new process to execute command without shell access",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_creation"
        },
        {
          "api_name": "requests.post",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "requests.models.Response.json",
          "id": "deserialize_json_response",
          "description": "Deserializes JSON response body to Python object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "requests.models.Response.status_code",
          "id": "get_http_status",
          "description": "Retrieves HTTP response status code",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "requests.models.Response.json",
          "id": "deserialize_json_response",
          "description": "Deserializes JSON response body to Python object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "requests.models.Response.headers",
          "id": "get_response_body",
          "description": "Retrieves response body from HTTP response",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        }
      ],
      "contextual_code": "@pytest.mark.integration\ndef test_truss_with_no_annotations(test_data_path):\n    truss_dir = test_data_path / \"test_basic_truss\"\n\n    tr = TrussHandle(truss_dir)\n\n    with ensure_kill_all():\n        _ = tr.docker_run(local_port=8090, detach=True, wait_for_server_ready=True)\n\n        response = requests.post(INFERENCE_URL, json={\"prompt\": \"value\"})\n        assert response.json() == {\"prompt\": \"value\"}\n\n        schema_response = requests.get(SCHEMA_URL)\n        assert schema_response.status_code == 404\n\n        assert schema_response.json()[\"error\"] == \"No schema found\"\n        assert schema_response.headers[\"x-baseten-error-source\"] == \"04\"\n        assert schema_response.headers[\"x-baseten-error-code\"] == \"600\""
    }
  }
]