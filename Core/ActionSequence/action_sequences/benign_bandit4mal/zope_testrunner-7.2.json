[
  {
    "metadata": {
      "package_name": "zope_testrunner-7.2",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "formatter.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/zope_testrunner-7.2/zope_testrunner-7.2/src/zope/testrunner/formatter.py",
    "line_number": "385",
    "type_description": "B832:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "384\t            if not stdout.endswith(\"\\n\"):\n385\t                sys.stdout.write(\"\\n\")\n386\t            sys.stdout.write(\"\\n\")",
    "code_snippet": "def print_std_streams(self, stdout, stderr):\n    \"\"\"Emit contents of buffered standard streams.\"\"\"\n    if stdout:\n        sys.stdout.write(\"Stdout:\\n\")\n        sys.stdout.write(stdout)\n        if not stdout.endswith(\"\\n\"):\n            sys.stdout.write(\"\\n\")\n        sys.stdout.write(\"\\n\")\n    if stderr:\n        sys.stderr.write(\"Stderr:\\n\")\n        sys.stderr.write(stderr)\n        if not stderr.endswith(\"\\n\"):\n            sys.stderr.write(\"\\n\")\n        sys.stderr.write(\"\\n\")",
    "pattern_analysis": {
      "api_sequence": [
        "sys.stdout.write",
        "sys.stdout.write",
        "sys.stdout.write",
        "sys.stdout.write",
        "sys.stderr.write",
        "sys.stderr.write",
        "sys.stderr.write",
        "sys.stderr.write"
      ],
      "api_sequence_with_args": [
        "sys.stdout.write(\"Stdout:\\n\")",
        "sys.stdout.write(stdout)",
        "sys.stdout.write(\"\\n\")",
        "sys.stdout.write(\"\\n\")",
        "sys.stderr.write(\"Stderr:\\n\")",
        "sys.stderr.write(stderr)",
        "sys.stderr.write(\"\\n\")",
        "sys.stderr.write(\"\\n\")"
      ],
      "mapped_sequence": [
        {
          "api_name": "sys.stdout.write",
          "id": "get_stdout_stream",
          "description": "Retrieves standard output stream object",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "sys.stdout.write",
          "id": "get_stdout_stream",
          "description": "Retrieves standard output stream object",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "sys.stdout.write",
          "id": "get_stdout_stream",
          "description": "Retrieves standard output stream object",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "sys.stdout.write",
          "id": "get_stdout_stream",
          "description": "Retrieves standard output stream object",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "sys.stderr.write",
          "id": "read_process_stderr",
          "description": "Reads all bytes from process standard error",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_information"
        },
        {
          "api_name": "sys.stderr.write",
          "id": "read_process_stderr",
          "description": "Reads all bytes from process standard error",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_information"
        },
        {
          "api_name": "sys.stderr.write",
          "id": "read_process_stderr",
          "description": "Reads all bytes from process standard error",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_information"
        },
        {
          "api_name": "sys.stderr.write",
          "id": "read_process_stderr",
          "description": "Reads all bytes from process standard error",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_information"
        }
      ],
      "contextual_code": "def print_std_streams(self, stdout, stderr):\n    if stdout:\n        sys.stdout.write(\"Stdout:\\n\")\n        sys.stdout.write(stdout)\n        if not stdout.endswith(\"\\n\"):\n            sys.stdout.write(\"\\n\")\n        sys.stdout.write(\"\\n\")\n    if stderr:\n        sys.stderr.write(\"Stderr:\\n\")\n        sys.stderr.write(stderr)\n        if not stderr.endswith(\"\\n\"):\n            sys.stderr.write(\"\\n\")\n        sys.stderr.write(\"\\n\")"
    }
  }
]