[
  {
    "metadata": {
      "package_name": "pyarrow-19.0.1",
      "total_matches": 2,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "test_io.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pyarrow-19.0.1/pyarrow-19.0.1/pyarrow/tests/test_io.py",
    "line_number": "343",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "342\t    assert not pf.seekable()\n343\t    pf.write(b'foobar\\n')\n344\t    assert bio.getvalue() == b'foobar\\n'",
    "code_snippet": "def test_python_file_implicit_mode(tmpdir):\n    path = os.path.join(str(tmpdir), 'foo.txt')\n    with open(path, 'wb') as f:\n        pf = pa.PythonFile(f)\n        assert pf.writable()\n        assert not pf.readable()\n        assert not pf.seekable()  # PyOutputStream isn't seekable\n        f.write(b'foobar\\n')\n\n    with open(path, 'rb') as f:\n        pf = pa.PythonFile(f)\n        assert pf.readable()\n        assert not pf.writable()\n        assert pf.seekable()\n        assert pf.read() == b'foobar\\n'\n\n    bio = BytesIO()\n    pf = pa.PythonFile(bio)\n    assert pf.writable()\n    assert not pf.readable()\n    assert not pf.seekable()\n    pf.write(b'foobar\\n')\n    assert bio.getvalue() == b'foobar\\n'\n",
    "pattern_analysis": {
      "api_sequence": [
        "os.path.join",
        "open",
        "open",
        "BytesIO",
        "pa.PythonFile",
        "pa.PythonFile",
        "pa.PythonFile",
        "f.write",
        "pa.PythonFile",
        "pa.PythonFile",
        "pa.PythonFile",
        "f.read",
        "pa.PythonFile",
        "bio.getvalue",
        "pa.PythonFile.write"
      ],
      "api_sequence_with_args": [
        "os.path.join(str(tmpdir), 'foo.txt')",
        "open(path, 'wb')",
        "open(path, 'rb')",
        "BytesIO()",
        "pa.PythonFile(f)",
        "pa.PythonFile(f)",
        "pa.PythonFile(f)",
        "f.write(b'foobar\\n')",
        "pa.PythonFile(f)",
        "pa.PythonFile(f)",
        "pa.PythonFile(f)",
        "f.read()",
        "pa.PythonFile(bio)",
        "bio.getvalue()",
        "pa.PythonFile.write(b'foobar\\n')"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.path.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "BytesIO",
          "id": "create_memory_bytes",
          "description": "Creates in-memory bytes buffer from encoded string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "pa.PythonFile",
          "id": "open_file_app",
          "description": "Opens file with associated application",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "pa.PythonFile",
          "id": "open_file_app",
          "description": "Opens file with associated application",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "pa.PythonFile",
          "id": "open_file_app",
          "description": "Opens file with associated application",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "f.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "pa.PythonFile",
          "id": "open_file_app",
          "description": "Opens file with associated application",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "pa.PythonFile",
          "id": "open_file_app",
          "description": "Opens file with associated application",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "pa.PythonFile",
          "id": "open_file_app",
          "description": "Opens file with associated application",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "f.read",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "pa.PythonFile",
          "id": "open_file_app",
          "description": "Opens file with associated application",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "bio.getvalue",
          "id": "get_buffer_bytes",
          "description": "Retrieves bytes value from in-memory buffer",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "pa.PythonFile.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        }
      ],
      "contextual_code": "def test_python_file_implicit_mode(tmpdir):\n    path = os.path.join(str(tmpdir), 'foo.txt')\n    with open(path, 'wb') as f:\n        pf = pa.PythonFile(f)\n        assert pf.writable()\n        assert not pf.readable()\n        assert not pf.seekable()  # PyOutputStream isn't seekable\n        f.write(b'foobar\\n')\n\n    with open(path, 'rb') as f:\n        pf = pa.PythonFile(f)\n        assert pf.readable()\n        assert not pf.writable()\n        assert pf.seekable()\n        assert pf.read() == b'foobar\\n'\n\n    bio = BytesIO()\n    pf = pa.PythonFile(bio)\n    assert pf.writable()\n    assert not pf.readable()\n    assert not pf.seekable()\n    pf.write(b'foobar\\n')\n    assert bio.getvalue() == b'foobar\\n'\n"
    }
  },
  {
    "pyfile": "test_io.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pyarrow-19.0.1/pyarrow-19.0.1/pyarrow/tests/test_io.py",
    "line_number": "1047",
    "type_description": "B832:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1046\t        f1.write(val)\n1047\t        f2.write(val)\n1048",
    "code_snippet": "def test_mock_output_stream():\n    # Make sure that the MockOutputStream and the BufferOutputStream record the\n    # same size\n\n    # 10 bytes\n    val = b'dataabcdef'\n\n    f1 = pa.MockOutputStream()\n    f2 = pa.BufferOutputStream()\n\n    K = 1000\n    for i in range(K):\n        f1.write(val)\n        f2.write(val)\n\n    assert f1.size() == len(f2.getvalue())\n\n    # Do the same test with a table\n    record_batch = pa.RecordBatch.from_arrays([pa.array([1, 2, 3])], ['a'])\n\n    f1 = pa.MockOutputStream()\n    f2 = pa.BufferOutputStream()\n\n    stream_writer1 = pa.RecordBatchStreamWriter(f1, record_batch.schema)\n    stream_writer2 = pa.RecordBatchStreamWriter(f2, record_batch.schema)\n\n    stream_writer1.write_batch(record_batch)\n    stream_writer2.write_batch(record_batch)\n    stream_writer1.close()\n    stream_writer2.close()\n\n    assert f1.size() == len(f2.getvalue())",
    "pattern_analysis": {
      "api_sequence": [
        "pa.MockOutputStream",
        "pa.BufferOutputStream",
        "pa.MockOutputStream.write",
        "pa.BufferOutputStream.write",
        "pa.MockOutputStream.size",
        "pa.BufferOutputStream.getvalue",
        "pa.RecordBatch.from_arrays",
        "pa.array",
        "pa.MockOutputStream",
        "pa.BufferOutputStream",
        "pa.RecordBatchStreamWriter",
        "pa.RecordBatchStreamWriter",
        "pa.RecordBatchStreamWriter.write_batch",
        "pa.RecordBatchStreamWriter.write_batch",
        "pa.RecordBatchStreamWriter.close",
        "pa.RecordBatchStreamWriter.close",
        "pa.MockOutputStream.size",
        "pa.BufferOutputStream.getvalue"
      ],
      "api_sequence_with_args": [
        "pa.MockOutputStream()",
        "pa.BufferOutputStream()",
        "pa.MockOutputStream.write(val)",
        "pa.BufferOutputStream.write(val)",
        "pa.MockOutputStream.size()",
        "pa.BufferOutputStream.getvalue()",
        "pa.RecordBatch.from_arrays([pa.array([1, 2, 3])], ['a'])",
        "pa.array([1, 2, 3])",
        "pa.MockOutputStream()",
        "pa.BufferOutputStream()",
        "pa.RecordBatchStreamWriter(f1, record_batch.schema)",
        "pa.RecordBatchStreamWriter(f2, record_batch.schema)",
        "pa.RecordBatchStreamWriter.write_batch(record_batch)",
        "pa.RecordBatchStreamWriter.write_batch(record_batch)",
        "pa.RecordBatchStreamWriter.close()",
        "pa.RecordBatchStreamWriter.close()",
        "pa.MockOutputStream.size()",
        "pa.BufferOutputStream.getvalue()"
      ],
      "mapped_sequence": [
        {
          "api_name": "pa.MockOutputStream",
          "id": "create_memory_bytes",
          "description": "Creates in-memory bytes buffer from encoded string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "pa.BufferOutputStream",
          "id": "create_memory_bytes",
          "description": "Creates in-memory bytes buffer from encoded string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "pa.MockOutputStream.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "pa.BufferOutputStream.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "pa.MockOutputStream.size",
          "id": "get_buffer_bytes",
          "description": "Retrieves bytes value from in-memory buffer",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "pa.BufferOutputStream.getvalue",
          "id": "get_buffer_bytes",
          "description": "Retrieves bytes value from in-memory buffer",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "pa.RecordBatch.from_arrays",
          "id": "deserialize_from_bytes",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "pa.array",
          "id": "deserialize_from_bytes",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "pa.MockOutputStream",
          "id": "create_memory_bytes",
          "description": "Creates in-memory bytes buffer from encoded string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "pa.BufferOutputStream",
          "id": "create_memory_bytes",
          "description": "Creates in-memory bytes buffer from encoded string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "pa.RecordBatchStreamWriter",
          "id": "create_memory_bytes",
          "description": "Creates in-memory bytes buffer from encoded string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "pa.RecordBatchStreamWriter",
          "id": "create_memory_bytes",
          "description": "Creates in-memory bytes buffer from encoded string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "pa.RecordBatchStreamWriter.write_batch",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "pa.RecordBatchStreamWriter.write_batch",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "pa.RecordBatchStreamWriter.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "pa.RecordBatchStreamWriter.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "pa.MockOutputStream.size",
          "id": "get_buffer_bytes",
          "description": "Retrieves bytes value from in-memory buffer",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "pa.BufferOutputStream.getvalue",
          "id": "get_buffer_bytes",
          "description": "Retrieves bytes value from in-memory buffer",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        }
      ],
      "contextual_code": "def test_mock_output_stream():\n    val = b'dataabcdef'\n    f1 = pa.MockOutputStream()\n    f2 = pa.BufferOutputStream()\n    K = 1000\n    for i in range(K):\n        f1.write(val)\n        f2.write(val)\n    assert f1.size() == len(f2.getvalue())\n    record_batch = pa.RecordBatch.from_arrays([pa.array([1, 2, 3])], ['a'])\n    f1 = pa.MockOutputStream()\n    f2 = pa.BufferOutputStream()\n    stream_writer1 = pa.RecordBatchStreamWriter(f1, record_batch.schema)\n    stream_writer2 = pa.RecordBatchStreamWriter(f2, record_batch.schema)\n    stream_writer1.write_batch(record_batch)\n    stream_writer2.write_batch(record_batch)\n    stream_writer1.close()\n    stream_writer2.close()\n    assert f1.size() == len(f2.getvalue())"
    }
  }
]