[
  {
    "metadata": {
      "package_name": "plumbum-1.9.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "daemons.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/plumbum-1.9.0/plumbum-1.9.0/plumbum/commands/daemons.py",
    "line_number": "121",
    "type_description": "B813:popen",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "120\t    stderr = open(stderr, \"a\" if append else \"w\", encoding=\"utf-8\")\n121\t    return command.popen(\n122\t        cwd=cwd,\n123\t        stdin=stdin.fileno(),\n124\t        stdout=stdout.fileno(),\n125\t        stderr=stderr.fileno(),\n126\t        creationflags=subprocess.CREATE_NEW_PROCESS_GROUP | DETACHED_PROCESS,\n127\t    )",
    "code_snippet": "def win32_daemonize(command, cwd, stdout=None, stderr=None, append=True):\n    if stdout is None:\n        stdout = os.devnull\n    if stderr is None:\n        stderr = stdout\n    DETACHED_PROCESS = 0x00000008\n    stdin = open(os.devnull, encoding=\"utf-8\")\n    stdout = open(stdout, \"a\" if append else \"w\", encoding=\"utf-8\")\n    stderr = open(stderr, \"a\" if append else \"w\", encoding=\"utf-8\")\n    return command.popen(\n        cwd=cwd,\n        stdin=stdin.fileno(),\n        stdout=stdout.fileno(),\n        stderr=stderr.fileno(),\n        creationflags=subprocess.CREATE_NEW_PROCESS_GROUP | DETACHED_PROCESS,\n    )",
    "pattern_analysis": {
      "api_sequence": [
        "os.devnull",
        "open",
        "os.devnull",
        "open",
        "open",
        "open",
        "open",
        "open",
        "open",
        "subprocess.CREATE_NEW_PROCESS_GROUP",
        "command.popen",
        "stdin.fileno",
        "stdout.fileno",
        "stderr.fileno"
      ],
      "api_sequence_with_args": [
        "os.devnull",
        "open(os.devnull, encoding=\"utf-8\")",
        "os.devnull",
        "open(stdout, \"a\" if append else \"w\", encoding=\"utf-8\")",
        "open(stderr, \"a\" if append else \"w\", encoding=\"utf-8\")",
        "open(os.devnull, encoding=\"utf-8\")",
        "open(stdout, \"a\" if append else \"w\", encoding=\"utf-8\")",
        "open(stderr, \"a\" if append else \"w\", encoding=\"utf-8\")",
        "subprocess.CREATE_NEW_PROCESS_GROUP",
        "command.popen(cwd=cwd, stdin=stdin.fileno(), stdout=stdout.fileno(), stderr=stderr.fileno(), creationflags=subprocess.CREATE_NEW_PROCESS_GROUP | DETACHED_PROCESS)",
        "stdin.fileno()",
        "stdout.fileno()",
        "stderr.fileno()"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.devnull",
          "id": "get_os_null_device",
          "description": "Retrieves operating system null device path",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "open",
          "id": "open_null_device",
          "description": "Opens null device for writing",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "subprocess.CREATE_NEW_PROCESS_GROUP",
          "id": "spawn_process_no_shell",
          "description": "Spawns new process to execute command without shell access",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_creation"
        },
        {
          "api_name": "command.popen",
          "id": "spawn_process_no_shell",
          "description": "Spawns new process to execute command without shell access",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_creation"
        },
        {
          "api_name": "stdin.fileno",
          "id": "get_socket_fd",
          "description": "Retrieves file descriptor for socket object",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "connection_management"
        },
        {
          "api_name": "stdout.fileno",
          "id": "get_socket_fd",
          "description": "Retrieves file descriptor for socket object",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "connection_management"
        },
        {
          "api_name": "stderr.fileno",
          "id": "get_socket_fd",
          "description": "Retrieves file descriptor for socket object",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "connection_management"
        }
      ],
      "contextual_code": "def win32_daemonize(command, cwd, stdout=None, stderr=None, append=True):\n    if stdout is None:\n        stdout = os.devnull\n    if stderr is None:\n        stderr = stdout\n    DETACHED_PROCESS = 0x00000008\n    stdin = open(os.devnull, encoding=\"utf-8\")\n    stdout = open(stdout, \"a\" if append else \"w\", encoding=\"utf-8\")\n    stderr = open(stderr, \"a\" if append else \"w\", encoding=\"utf-8\")\n    return command.popen(\n        cwd=cwd,\n        stdin=stdin.fileno(),\n        stdout=stdout.fileno(),\n        stderr=stderr.fileno(),\n        creationflags=subprocess.CREATE_NEW_PROCESS_GROUP | DETACHED_PROCESS,\n    )"
    }
  }
]