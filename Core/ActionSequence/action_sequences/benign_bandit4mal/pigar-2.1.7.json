[
  {
    "metadata": {
      "package_name": "pigar-2.1.7",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "misc.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pigar-2.1.7/pigar-2.1.7/pigar/_vendor/pip/_internal/utils/misc.py",
    "line_number": "769",
    "type_description": "B811:getuid",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "768\n769\t    if os.getuid() != 0:\n770\t        return",
    "code_snippet": "def warn_if_run_as_root() -> None:\n    \"\"\"Output a warning for sudo users on Unix.\n\n    In a virtual environment, sudo pip still writes to virtualenv.\n    On Windows, users may run pip as Administrator without issues.\n    This warning only applies to Unix root users outside of virtualenv.\n    \"\"\"\n    if running_under_virtualenv():\n        return\n    if not hasattr(os, \"getuid\"):\n        return\n    # On Windows, there are no \"system managed\" Python packages. Installing as\n    # Administrator via pip is the correct way of updating system environments.\n    #\n    # We choose sys.platform over utils.compat.WINDOWS here to enable Mypy platform\n    # checks: https://mypy.readthedocs.io/en/stable/common_issues.html\n    if sys.platform == \"win32\" or sys.platform == \"cygwin\":\n        return\n\n    if os.getuid() != 0:\n        return\n\n    logger.warning(\n        \"Running pip as the 'root' user can result in broken permissions and \"\n        \"conflicting behaviour with the system package manager, possibly \"\n        \"rendering your system unusable.\"\n        \"It is recommended to use a virtual environment instead: \"\n        \"https://pip.pypa.io/warnings/venv. \"\n        \"Use the --root-user-action option if you know what you are doing and \"\n        \"want to suppress this warning.\"\n    )",
    "pattern_analysis": {
      "api_sequence": [
        "running_under_virtualenv",
        "hasattr",
        "os.getuid",
        "sys.platform",
        "os.getuid",
        "logger.warning"
      ],
      "api_sequence_with_args": [
        "running_under_virtualenv()",
        "hasattr(os, \"getuid\")",
        "os.getuid",
        "sys.platform",
        "os.getuid()",
        "logger.warning(\"Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.\")"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.getuid",
          "id": "check_admin_privileges",
          "description": "Checks if process is running with administrator privileges",
          "first_id": "system_operations",
          "second_id": "system_privilege_operations",
          "third_id": "privilege_management"
        }
      ],
      "contextual_code": "def warn_if_run_as_root() -> None:\n    if running_under_virtualenv():\n        return\n    if not hasattr(os, \"getuid\"):\n        return\n    if sys.platform == \"win32\" or sys.platform == \"cygwin\":\n        return\n    if os.getuid() != 0:\n        return\n    logger.warning(\n        \"Running pip as the 'root' user can result in broken permissions and \"\n        \"conflicting behaviour with the system package manager, possibly \"\n        \"rendering your system unusable.\"\n        \"It is recommended to use a virtual environment instead: \"\n        \"https://pip.pypa.io/warnings/venv. \"\n        \"Use the --root-user-action option if you know what you are doing and \"\n        \"want to suppress this warning.\"\n    )"
    }
  }
]