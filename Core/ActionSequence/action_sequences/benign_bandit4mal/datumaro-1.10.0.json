[
  {
    "metadata": {
      "package_name": "datumaro-1.10.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "base.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/datumaro-1.10.0/datumaro-1.10.0/src/datumaro/plugins/data_formats/datumaro_binary/base.py",
    "line_number": "122",
    "type_description": "B814:read",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "121\t        (n_blob_sizes_bytes,) = struct.unpack(\"<I\", self._fp.read(4))\n122\t        blob_sizes_bytes = self._crypter.decrypt(self._fp.read(n_blob_sizes_bytes))\n123\t        blob_sizes, _ = IntListMapper.backward(blob_sizes_bytes, 0)",
    "code_snippet": "def _read_items(self) -> None:\n    (n_blob_sizes_bytes,) = struct.unpack(\"<I\", self._fp.read(4))\n    blob_sizes_bytes = self._crypter.decrypt(self._fp.read(n_blob_sizes_bytes))\n    blob_sizes, _ = IntListMapper.backward(blob_sizes_bytes, 0)\n\n    media_path_prefix = {\n        MediaType.IMAGE: osp.join(self._images_dir, self._subset),\n        MediaType.POINT_CLOUD: osp.join(self._pcd_dir, self._subset),\n        MediaType.VIDEO: osp.join(self._video_dir, self._subset),\n        MediaType.VIDEO_FRAME: osp.join(self._video_dir, self._subset),\n    }\n\n    if self._num_workers > 0:\n        self._items = self._read_items_mp(blob_sizes, media_path_prefix)\n    else:\n        self._items = self._read_items_sp(blob_sizes, media_path_prefix)\n\n    for item in self._items:\n        if item.media is not None and self._media_encryption:\n            item.media.set_crypter(self._crypter)\n\n        for ann in item.annotations:\n            self._ann_types.add(ann.type)",
    "pattern_analysis": {
      "api_sequence": [
        "struct.unpack",
        "self._fp.read",
        "self._fp.read",
        "self._crypter.decrypt",
        "IntListMapper.backward",
        "osp.join",
        "osp.join",
        "osp.join",
        "osp.join"
      ],
      "api_sequence_with_args": [
        "struct.unpack(\"<I\", self._fp.read(4))",
        "self._fp.read(4)",
        "self._fp.read(n_blob_sizes_bytes)",
        "self._crypter.decrypt(self._fp.read(n_blob_sizes_bytes))",
        "IntListMapper.backward(blob_sizes_bytes, 0)",
        "osp.join(self._images_dir, self._subset)",
        "osp.join(self._pcd_dir, self._subset)",
        "osp.join(self._video_dir, self._subset)",
        "osp.join(self._video_dir, self._subset)"
      ],
      "mapped_sequence": [
        {
          "api_name": "struct.unpack",
          "id": "unclassified",
          "description": "No direct match in provided categories; closest is binary data manipulation",
          "first_id": "",
          "second_id": "",
          "third_id": ""
        },
        {
          "api_name": "self._fp.read",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "self._fp.read",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "self._crypter.decrypt",
          "id": "decrypt_aes_data",
          "description": "Decrypts data using initialized AES cipher",
          "first_id": "encryption_hashing",
          "second_id": "encryption_operations",
          "third_id": "decryption_execution"
        },
        {
          "api_name": "IntListMapper.backward",
          "id": "unclassified",
          "description": "No direct match in provided categories; likely custom deserialization",
          "first_id": "",
          "second_id": "",
          "third_id": ""
        },
        {
          "api_name": "osp.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "osp.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "osp.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "osp.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        }
      ],
      "contextual_code": "def _read_items(self) -> None:\n    (n_blob_sizes_bytes,) = struct.unpack(\"<I\", self._fp.read(4))\n    blob_sizes_bytes = self._crypter.decrypt(self._fp.read(n_blob_sizes_bytes))\n    blob_sizes, _ = IntListMapper.backward(blob_sizes_bytes, 0)\n\n    media_path_prefix = {\n        MediaType.IMAGE: osp.join(self._images_dir, self._subset),\n        MediaType.POINT_CLOUD: osp.join(self._pcd_dir, self._subset),\n        MediaType.VIDEO: osp.join(self._video_dir, self._subset),\n        MediaType.VIDEO_FRAME: osp.join(self._video_dir, self._subset),\n    }\n    # ... rest of function omitted as it does not contain sensitive API calls"
    }
  }
]