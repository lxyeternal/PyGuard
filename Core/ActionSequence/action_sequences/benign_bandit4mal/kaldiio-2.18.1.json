[
  {
    "metadata": {
      "package_name": "kaldiio-2.18.1",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "utils.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/kaldiio-2.18.1/kaldiio-2.18.1/kaldiio/utils.py",
    "line_number": "182",
    "type_description": "B813:popen",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "181\t        cmd = name.strip()[1:].encode(default_encoding)\n182\t        return my_popen(cmd, mode)\n183\t    # If read mode",
    "code_snippet": "def open_like_kaldi(name, mode=\"r\"):\n    \"\"\"Open a file like kaldi io\n\n    Args:\n        name (str or file):\n        mode (str):\n    \"\"\"\n    # If file descriptor\n    if not isinstance(name, string_types):\n        if PY3 and \"b\" in mode and isinstance(name, TextIOBase):\n            return name.buffer\n        else:\n            return name\n\n    # If writting to stdout\n    if name.strip().endswith(\"|\"):\n        cmd = name.strip()[:-1].encode(default_encoding)\n        return my_popen(cmd, mode)\n    # If reading from stdin\n    elif name.strip().startswith(\"|\"):\n        cmd = name.strip()[1:].encode(default_encoding)\n        return my_popen(cmd, mode)\n    # If read mode\n    elif name == \"-\" and \"r\" in mode:\n        if PY3:\n            if mode == \"rb\":\n                return _stdstream_wrap(sys.stdin.buffer)\n            else:\n                return _stdstream_wrap(\n                    io.TextIOWrapper(sys.stdin.buffer, encoding=default_encoding)\n                )\n        else:\n            return _stdstream_wrap(sys.stdin)\n    # If write mode\n    elif name == \"-\" and (\"w\" in mode or \"a\" in mode):\n        if PY3:\n            if mode == \"wb\" or mode == \"ab\":\n                return _stdstream_wrap(sys.stdout.buffer)\n            else:\n                return _stdstream_wrap(\n                    io.TextIOWrapper(sys.stdout.buffer, encoding=default_encoding)\n                )\n        else:\n            return _stdstream_wrap(sys.stdout)\n    else:\n        encoding = None if \"b\" in mode else default_encoding\n        return io.open(name, mode, encoding=encoding)\n",
    "pattern_analysis": {
      "api_sequence": [
        "isinstance",
        "my_popen",
        "my_popen",
        "_stdstream_wrap",
        "_stdstream_wrap",
        "_stdstream_wrap",
        "_stdstream_wrap",
        "_stdstream_wrap",
        "io.open"
      ],
      "api_sequence_with_args": [
        "isinstance(name, string_types)",
        "my_popen(cmd, mode)",
        "my_popen(cmd, mode)",
        "_stdstream_wrap(sys.stdin.buffer)",
        "_stdstream_wrap(io.TextIOWrapper(sys.stdin.buffer, encoding=default_encoding))",
        "_stdstream_wrap(sys.stdin)",
        "_stdstream_wrap(sys.stdout.buffer)",
        "_stdstream_wrap(io.TextIOWrapper(sys.stdout.buffer, encoding=default_encoding))",
        "io.open(name, mode, encoding=encoding)"
      ],
      "mapped_sequence": [
        {
          "api_name": "isinstance",
          "id": "check_instance_type",
          "description": "Checks if object is instance of specified type",
          "first_id": "utility_functions",
          "second_id": "logging_exception_handling",
          "third_id": "exception_checking"
        },
        {
          "api_name": "my_popen",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "my_popen",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "_stdstream_wrap",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "_stdstream_wrap",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "_stdstream_wrap",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "_stdstream_wrap",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "_stdstream_wrap",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "io.open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        }
      ],
      "contextual_code": "def open_like_kaldi(name, mode=\"r\"):\n    # If file descriptor\n    if not isinstance(name, string_types):\n        if PY3 and \"b\" in mode and isinstance(name, TextIOBase):\n            return name.buffer\n        else:\n            return name\n\n    # If writting to stdout\n    if name.strip().endswith(\"|\"):\n        cmd = name.strip()[:-1].encode(default_encoding)\n        return my_popen(cmd, mode)\n    # If reading from stdin\n    elif name.strip().startswith(\"|\"):\n        cmd = name.strip()[1:].encode(default_encoding)\n        return my_popen(cmd, mode)\n    # If read mode\n    elif name == \"-\" and \"r\" in mode:\n        if PY3:\n            if mode == \"rb\":\n                return _stdstream_wrap(sys.stdin.buffer)\n            else:\n                return _stdstream_wrap(\n                    io.TextIOWrapper(sys.stdin.buffer, encoding=default_encoding)\n                )\n        else:\n            return _stdstream_wrap(sys.stdin)\n    # If write mode\n    elif name == \"-\" and (\"w\" in mode or \"a\" in mode):\n        if PY3:\n            if mode == \"wb\" or mode == \"ab\":\n                return _stdstream_wrap(sys.stdout.buffer)\n            else:\n                return _stdstream_wrap(\n                    io.TextIOWrapper(sys.stdout.buffer, encoding=default_encoding)\n                )\n        else:\n            return _stdstream_wrap(sys.stdout)\n    else:\n        encoding = None if \"b\" in mode else default_encoding\n        return io.open(name, mode, encoding=encoding)"
    }
  }
]