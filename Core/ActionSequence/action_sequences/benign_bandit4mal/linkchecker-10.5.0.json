[
  {
    "metadata": {
      "package_name": "linkchecker-10.5.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "console.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/linkchecker-10.5.0/LinkChecker-10.5.0/linkcheck/director/console.py",
    "line_number": "56",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "55\t        \"\"\"Write status message and line break to file descriptor.\"\"\"\n56\t        self.fd.write(f\"{msg}{os.linesep}\")\n57",
    "code_snippet": "class StatusLogger:\n    \"\"\"Standard status logger. Default output is stderr.\"\"\"\n\n    def __init__(self, fd=stderr):\n        \"\"\"Save file descriptor for logging.\"\"\"\n        self.fd = fd\n\n    def log_status(self, checked, in_progress, queue, duration, num_urls):\n        \"\"\"Write status message to file descriptor.\"\"\"\n        msg = _n(\"%2d thread active\", \"%2d threads active\", in_progress) % in_progress\n        self.write(\"%s, \" % msg)\n        msg = _n(\"%5d link queued\", \"%5d links queued\", queue) % queue\n        self.write(\"%s, \" % msg)\n        msg = _n(\"%4d link\", \"%4d links\", checked) % checked\n        self.write(\"%s\" % msg)\n        msg = _n(\"%3d URL\", \"%3d URLs\", num_urls) % num_urls\n        self.write(\" in %s checked, \" % msg)\n        msg = _(\"runtime %s\") % strformat.strduration_long(duration)\n        self.writeln(msg)\n        self.flush()\n\n    def write(self, msg):\n        \"\"\"Write message to file descriptor.\"\"\"\n        self.fd.write(msg)\n\n    def writeln(self, msg):\n        \"\"\"Write status message and line break to file descriptor.\"\"\"\n        self.fd.write(f\"{msg}{os.linesep}\")\n\n    def flush(self):\n        \"\"\"Flush file descriptor.\"\"\"\n        self.fd.flush()",
    "pattern_analysis": {
      "api_sequence": [
        "os.linesep",
        "self.fd.write",
        "self.fd.flush"
      ],
      "api_sequence_with_args": [
        "os.linesep",
        "self.fd.write(msg)",
        "self.fd.flush()"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.linesep",
          "id": "get_os_path_sep",
          "description": "Retrieves operating system path separator",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "self.fd.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "self.fd.flush",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        }
      ],
      "contextual_code": "def writeln(self, msg):\n    self.fd.write(f\"{msg}{os.linesep}\")\n\ndef flush(self):\n    self.fd.flush()\n\ndef write(self, msg):\n    self.fd.write(msg)"
    }
  }
]