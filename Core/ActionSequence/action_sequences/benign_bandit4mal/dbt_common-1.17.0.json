[
  {
    "metadata": {
      "package_name": "dbt_common-1.17.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "system.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/dbt_common-1.17.0/dbt_common-1.17.0/dbt_common/clients/system.py",
    "line_number": "592",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "591\t    connection_timeout = timeout or float(os.getenv(\"DBT_HTTP_TIMEOUT\", 10))\n592\t    response = requests.get(url, timeout=connection_timeout)\n593\t    with open(path, \"wb\") as handle:",
    "code_snippet": "def download(\n    url: str,\n    path: str,\n    timeout: Optional[Union[float, Tuple[float, float], Tuple[float, None]]] = None,\n) -> None:\n    path = convert_path(path)\n    connection_timeout = timeout or float(os.getenv(\"DBT_HTTP_TIMEOUT\", 10))\n    response = requests.get(url, timeout=connection_timeout)\n    with open(path, \"wb\") as handle:\n        for block in response.iter_content(1024 * 64):\n            handle.write(block)",
    "pattern_analysis": {
      "api_sequence": [
        "os.getenv",
        "requests.get",
        "open",
        "response.iter_content",
        "handle.write"
      ],
      "api_sequence_with_args": [
        "os.getenv(\"DBT_HTTP_TIMEOUT\", 10)",
        "requests.get(url, timeout=connection_timeout)",
        "open(path, \"wb\")",
        "response.iter_content(1024 * 64)",
        "handle.write(block)"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "response.iter_content",
          "id": "iterate_response_chunks",
          "description": "Iterates over response content in chunks",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "handle.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        }
      ],
      "contextual_code": "def download(url: str, path: str, timeout: Optional[Union[float, Tuple[float, float], Tuple[float, None]]] = None) -> None:\n    path = convert_path(path)\n    connection_timeout = timeout or float(os.getenv(\"DBT_HTTP_TIMEOUT\", 10))\n    response = requests.get(url, timeout=connection_timeout)\n    with open(path, \"wb\") as handle:\n        for block in response.iter_content(1024 * 64):\n            handle.write(block)"
    }
  }
]