[
  {
    "metadata": {
      "package_name": "genie_libs_sdk-25.3.1-py3-none-any",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "gnmi_util.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/genie_libs_sdk-25.3.1-py3-none-any/genie/libs/sdk/triggers/blitz/gnmi_util.py",
    "line_number": "568",
    "type_description": "B802:b64encode",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "567\t                        )\n568\t                        gnmi_update.val.json_val = base64.b64encode(jval)\n569\t                    else:",
    "code_snippet": "    @staticmethod\n    def _upd_rpl(upd_rpl, base64_encode):\n        updates = []\n        for upd in upd_rpl:\n            val = None\n            if 'val' in upd:\n                val = upd.pop('val', {})\n            gnmi_update = json_format.ParseDict(\n                upd,\n                proto.gnmi_pb2.Update()\n            )\n            if val is not None:\n                if 'jsonIetfVal' in val:\n                    if base64_encode:\n                        jval = bytes(\n                            json.dumps(val['jsonIetfVal']), encoding='utf-8'\n                        )\n                        gnmi_update.val.json_ietf_val = base64.b64encode(jval)\n                    else:\n                        gnmi_update.val.json_ietf_val = json.dumps(\n                            val['jsonIetfVal']\n                        ).encode('utf-8')\n                elif 'jsonVal' in val:\n                    if base64_encode:\n                        jval = bytes(\n                            json.dumps(val['jsonVal']), encoding='utf-8'\n                        )\n                        gnmi_update.val.json_val = base64.b64encode(jval)\n                    else:\n                        gnmi_update.val.json_val = json.dumps(\n                            val['jsonVal']\n                        ).encode('utf-8')\n            updates.append(gnmi_update)\n        return updates",
    "pattern_analysis": {
      "api_sequence": [
        "json_format.ParseDict",
        "json.dumps",
        "base64.b64encode",
        "json.dumps"
      ],
      "api_sequence_with_args": [
        "json_format.ParseDict(upd, proto.gnmi_pb2.Update())",
        "json.dumps(val['jsonIetfVal'])",
        "base64.b64encode(jval)",
        "json.dumps(val['jsonIetfVal'])"
      ],
      "mapped_sequence": [
        {
          "api_name": "json_format.ParseDict",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "json.dumps",
          "id": "serialize_to_json",
          "description": "Serializes Python object to JSON string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "base64.b64encode",
          "id": "encode_bytes_to_base64",
          "description": "Encodes bytes to base64-encoded bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "json.dumps",
          "id": "serialize_to_json",
          "description": "Serializes Python object to JSON string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        }
      ],
      "contextual_code": "def _upd_rpl(upd_rpl, base64_encode):\n    updates = []\n    for upd in upd_rpl:\n        val = None\n        if 'val' in upd:\n            val = upd.pop('val', {})\n        gnmi_update = json_format.ParseDict(\n            upd,\n            proto.gnmi_pb2.Update()\n        )\n        if val is not None:\n            if 'jsonIetfVal' in val:\n                if base64_encode:\n                    jval = bytes(\n                        json.dumps(val['jsonIetfVal']), encoding='utf-8'\n                    )\n                    gnmi_update.val.json_ietf_val = base64.b64encode(jval)\n                else:\n                    gnmi_update.val.json_ietf_val = json.dumps(\n                        val['jsonIetfVal']\n                    ).encode('utf-8')\n            elif 'jsonVal' in val:\n                if base64_encode:\n                    jval = bytes(\n                        json.dumps(val['jsonVal']), encoding='utf-8'\n                    )\n                    gnmi_update.val.json_val = base64.b64encode(jval)\n                else:\n                    gnmi_update.val.json_val = json.dumps(\n                        val['jsonVal']\n                    ).encode('utf-8')\n        updates.append(gnmi_update)\n    return updates"
    }
  }
]