[
  {
    "metadata": {
      "package_name": "avro-1.12.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "codecs.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/avro-1.12.0/avro-1.12.0/avro/codecs.py",
    "line_number": "142",
    "type_description": "B816:decompress",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "141\t            data = readers_decoder.read(length)\n142\t            uncompressed = bz2.decompress(data)\n143\t            return avro.io.BinaryDecoder(io.BytesIO(uncompressed))",
    "code_snippet": "class BZip2Codec(Codec):\n    @staticmethod\n    def compress(data: bytes) -> Tuple[bytes, int]:\n        compressed_data = bz2.compress(data)\n        return compressed_data, len(compressed_data)\n\n    @staticmethod\n    def decompress(readers_decoder: avro.io.BinaryDecoder) -> avro.io.BinaryDecoder:\n        length = readers_decoder.read_long()\n        data = readers_decoder.read(length)\n        uncompressed = bz2.decompress(data)\n        return avro.io.BinaryDecoder(io.BytesIO(uncompressed))",
    "pattern_analysis": {
      "api_sequence": [
        "bz2.compress",
        "len",
        "readers_decoder.read_long",
        "readers_decoder.read",
        "bz2.decompress",
        "io.BytesIO",
        "avro.io.BinaryDecoder"
      ],
      "api_sequence_with_args": [
        "bz2.compress(data)",
        "len(compressed_data)",
        "readers_decoder.read_long()",
        "readers_decoder.read(length)",
        "bz2.decompress(data)",
        "io.BytesIO(uncompressed)",
        "avro.io.BinaryDecoder(io.BytesIO(uncompressed))"
      ],
      "mapped_sequence": [
        {
          "api_name": "bz2.compress",
          "id": "compress_data_zlib",
          "description": "Compresses data using zlib compression",
          "first_id": "file_operations",
          "second_id": "compression_archiving",
          "third_id": "compression_decompression"
        },
        {
          "api_name": "len",
          "id": "deserialize_from_bytes",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "readers_decoder.read_long",
          "id": "deserialize_from_bytes",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "readers_decoder.read",
          "id": "deserialize_from_bytes",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "bz2.decompress",
          "id": "decompress_data_zlib",
          "description": "Decompresses zlib-compressed data",
          "first_id": "file_operations",
          "second_id": "compression_archiving",
          "third_id": "compression_decompression"
        },
        {
          "api_name": "io.BytesIO",
          "id": "create_memory_bytes",
          "description": "Creates in-memory bytes buffer from encoded string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "avro.io.BinaryDecoder",
          "id": "deserialize_from_bytes",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        }
      ],
      "contextual_code": "class BZip2Codec(Codec):\n    @staticmethod\n    def compress(data: bytes) -> Tuple[bytes, int]:\n        compressed_data = bz2.compress(data)\n        return compressed_data, len(compressed_data)\n\n    @staticmethod\n    def decompress(readers_decoder: avro.io.BinaryDecoder) -> avro.io.BinaryDecoder:\n        length = readers_decoder.read_long()\n        data = readers_decoder.read(length)\n        uncompressed = bz2.decompress(data)\n        return avro.io.BinaryDecoder(io.BytesIO(uncompressed))"
    }
  }
]