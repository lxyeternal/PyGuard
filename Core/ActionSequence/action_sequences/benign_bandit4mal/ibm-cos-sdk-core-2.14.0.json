[
  {
    "metadata": {
      "package_name": "ibm-cos-sdk-core-2.14.0",
      "total_matches": 3,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "test_session_legacy.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/ibm-cos-sdk-core-2.14.0/ibm-cos-sdk-core-2.14.0/tests/unit/test_session_legacy.py",
    "line_number": "200",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "199\t            f.write('aws_access_key_id=FROM_CREDS_FILE_1\\n')\n200\t            f.write('aws_secret_access_key=FROM_CREDS_FILE_2\\n')\n201\t            f.flush()",
    "code_snippet": "def test_full_config_merges_creds_file_data(self):\n    with temporary_file('w') as f:\n        self.session.set_config_variable('credentials_file', f.name)\n        f.write('[newprofile]\\n')\n        f.write('aws_access_key_id=FROM_CREDS_FILE_1\\n')\n        f.write('aws_secret_access_key=FROM_CREDS_FILE_2\\n')\n        f.flush()\n\n        full_config = self.session.full_config\n        self.assertEqual(full_config['profiles']['newprofile'],\n                         {'aws_access_key_id': 'FROM_CREDS_FILE_1',\n                          'aws_secret_access_key': 'FROM_CREDS_FILE_2'})",
    "pattern_analysis": {
      "api_sequence": [
        "temporary_file",
        "self.session.set_config_variable",
        "f.write",
        "f.write",
        "f.write",
        "f.flush",
        "self.session.full_config",
        "self.assertEqual"
      ],
      "api_sequence_with_args": [
        "temporary_file('w')",
        "self.session.set_config_variable('credentials_file', f.name)",
        "f.write('[newprofile]\\n')",
        "f.write('aws_access_key_id=FROM_CREDS_FILE_1\\n')",
        "f.write('aws_secret_access_key=FROM_CREDS_FILE_2\\n')",
        "f.flush()",
        "self.session.full_config",
        "self.assertEqual(full_config['profiles']['newprofile'], {'aws_access_key_id': 'FROM_CREDS_FILE_1', 'aws_secret_access_key': 'FROM_CREDS_FILE_2'})"
      ],
      "mapped_sequence": [
        {
          "api_name": "temporary_file",
          "id": "create_temp_file",
          "description": "Creates temporary file that is not deleted on close",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "self.session.set_config_variable",
          "id": "init_config_class",
          "description": "Initializes Config class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "f.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "f.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "f.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "f.flush",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "self.session.full_config",
          "id": "init_config_class",
          "description": "Initializes Config class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        }
      ],
      "contextual_code": "def test_full_config_merges_creds_file_data(self):\n    with temporary_file('w') as f:\n        self.session.set_config_variable('credentials_file', f.name)\n        f.write('[newprofile]\\n')\n        f.write('aws_access_key_id=FROM_CREDS_FILE_1\\n')\n        f.write('aws_secret_access_key=FROM_CREDS_FILE_2\\n')\n        f.flush()\n\n        full_config = self.session.full_config\n        self.assertEqual(full_config['profiles']['newprofile'],\n                         {'aws_access_key_id': 'FROM_CREDS_FILE_1',\n                          'aws_secret_access_key': 'FROM_CREDS_FILE_2'})"
    }
  },
  {
    "pyfile": "test_http_session.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/ibm-cos-sdk-core-2.14.0/ibm-cos-sdk-core-2.14.0/tests/unit/test_http_session.py",
    "line_number": "293",
    "type_description": "B805:send",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "292\t        self.request.url = 'https://example.com/'\n293\t        session.send(self.request.prepare())\n294\t        self.assert_proxy_manager_call(",
    "code_snippet": "def test_http_proxy_scheme_with_https_url(self):\n    proxies = {'https': 'http://proxy.com'}\n    session = URLLib3Session(proxies=proxies)\n    self.request.url = 'https://example.com/'\n    session.send(self.request.prepare())\n    self.assert_proxy_manager_call(\n        proxies['https'],\n        proxy_headers={},\n    )\n    self.assert_request_sent()",
    "pattern_analysis": {
      "api_sequence": [
        "URLLib3Session",
        "URLLib3Session.send"
      ],
      "api_sequence_with_args": [
        "URLLib3Session(proxies=proxies)",
        "URLLib3Session.send(self.request.prepare())"
      ],
      "mapped_sequence": [
        {
          "api_name": "URLLib3Session",
          "id": "create_http_session",
          "description": "Creates HTTP session for making asynchronous requests",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_creation"
        },
        {
          "api_name": "URLLib3Session.send",
          "id": "send_http_custom",
          "description": "Sends HTTP request with specified method and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        }
      ],
      "contextual_code": "def test_http_proxy_scheme_with_https_url(self):\n    proxies = {'https': 'http://proxy.com'}\n    session = URLLib3Session(proxies=proxies)\n    self.request.url = 'https://example.com/'\n    session.send(self.request.prepare())"
    }
  },
  {
    "pyfile": "test_http_session.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/ibm-cos-sdk-core-2.14.0/ibm-cos-sdk-core-2.14.0/tests/unit/test_http_session.py",
    "line_number": "415",
    "type_description": "B805:send",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "414\t        session = URLLib3Session(proxies=proxies)\n415\t        session.send(self.request.prepare())\n416\t        self.assert_proxy_manager_call(proxies['http'], proxy_headers={})",
    "code_snippet": "def test_basic_http_proxy_request(self):\n    proxies = {'http': 'http://proxy.com'}\n    session = URLLib3Session(proxies=proxies)\n    session.send(self.request.prepare())\n    self.assert_proxy_manager_call(proxies['http'], proxy_headers={})\n    self.assert_request_sent(url=self.request.url)",
    "pattern_analysis": {
      "api_sequence": [
        "URLLib3Session",
        "URLLib3Session.send"
      ],
      "api_sequence_with_args": [
        "URLLib3Session(proxies=proxies)",
        "URLLib3Session.send(self.request.prepare())"
      ],
      "mapped_sequence": [
        {
          "api_name": "URLLib3Session",
          "id": "create_http_session",
          "description": "Creates HTTP session for making asynchronous requests",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_creation"
        },
        {
          "api_name": "URLLib3Session.send",
          "id": "send_http_custom",
          "description": "Sends HTTP request with specified method and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        }
      ],
      "contextual_code": "def test_basic_http_proxy_request(self):\n    proxies = {'http': 'http://proxy.com'}\n    session = URLLib3Session(proxies=proxies)\n    session.send(self.request.prepare())"
    }
  }
]