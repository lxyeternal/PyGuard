[
  {
    "metadata": {
      "package_name": "setuptools-78.1.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "test_pkg_resources.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/setuptools-78.1.0/setuptools-78.1.0/pkg_resources/tests/test_pkg_resources.py",
    "line_number": "349",
    "type_description": "B810:chmod",
    "severity": "High",
    "confidence": "Medium",
    "code_snippet": "@pytest.fixture\n    def env(self, tmpdir):\n        \"\"\"\n        Create a package environment, similar to a virtualenv,\n        in which packages are installed.\n        \"\"\"\n\n        class Environment(str):\n            pass\n\n        env = Environment(tmpdir)\n        tmpdir.chmod(stat.S_IRWXU)\n        subs = 'home', 'lib', 'scripts', 'data', 'egg-base'\n        env.paths = dict((dirname, str(tmpdir / dirname)) for dirname in subs)\n        list(map(os.mkdir, env.paths.values()))\n        return env",
    "pattern_analysis": {
      "api_sequence": [
        "stat.S_IRWXU",
        "tmpdir.chmod",
        "os.mkdir"
      ],
      "api_sequence_with_args": [
        "stat.S_IRWXU",
        "tmpdir.chmod(stat.S_IRWXU)",
        "os.mkdir(env.paths.values())"
      ],
      "mapped_sequence": [
        {
          "api_name": "stat.S_IRWXU",
          "id": "set_file_attributes",
          "description": "Sets file attributes for specified file",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_attribute_management"
        },
        {
          "api_name": "tmpdir.chmod",
          "id": "set_file_attributes",
          "description": "Sets file attributes for specified file",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_attribute_management"
        },
        {
          "api_name": "os.mkdir",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        }
      ],
      "contextual_code": "def env(self, tmpdir):\n    class Environment(str):\n        pass\n    env = Environment(tmpdir)\n    tmpdir.chmod(stat.S_IRWXU)\n    subs = 'home', 'lib', 'scripts', 'data', 'egg-base'\n    env.paths = dict((dirname, str(tmpdir / dirname)) for dirname in subs)\n    list(map(os.mkdir, env.paths.values()))\n    return env"
    }
  }
]