[
  {
    "metadata": {
      "package_name": "watchdog-6.0.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "test_emitter.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/watchdog-6.0.0/watchdog-6.0.0/tests/test_emitter.py",
    "line_number": "154",
    "type_description": "B810:chmod",
    "severity": "High",
    "confidence": "Medium",
    "code_snippet": "@pytest.mark.flaky(max_runs=5, min_passes=1, rerun_filter=rerun_filter)\ndef test_chmod(p: P, start_watching: StartWatching, expect_event: ExpectEvent) -> None:\n    mkfile(p(\"a\"))\n    start_watching()\n\n    # Note: We use S_IREAD here because chmod on Windows only\n    # allows setting the read-only flag.\n    os.chmod(p(\"a\"), stat.S_IREAD)\n\n    expect_event(FileModifiedEvent(p(\"a\")))\n\n    # Reset permissions to allow cleanup.\n    os.chmod(p(\"a\"), stat.S_IWRITE)\n",
    "pattern_analysis": {
      "api_sequence": [
        "os.chmod",
        "os.chmod"
      ],
      "api_sequence_with_args": [
        "os.chmod(p(\"a\"), stat.S_IREAD)",
        "os.chmod(p(\"a\"), stat.S_IWRITE)"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.chmod",
          "id": "change_file_mode_execute",
          "description": "Changes file mode to add execute permission",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_attribute_management"
        },
        {
          "api_name": "os.chmod",
          "id": "change_file_mode_execute",
          "description": "Changes file mode to add execute permission",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_attribute_management"
        }
      ],
      "contextual_code": "def test_chmod(p: P, start_watching: StartWatching, expect_event: ExpectEvent) -> None:\n    mkfile(p(\"a\"))\n    start_watching()\n\n    # Note: We use S_IREAD here because chmod on Windows only\n    # allows setting the read-only flag.\n    os.chmod(p(\"a\"), stat.S_IREAD)\n\n    expect_event(FileModifiedEvent(p(\"a\")))\n\n    # Reset permissions to allow cleanup.\n    os.chmod(p(\"a\"), stat.S_IWRITE)"
    }
  }
]