[
  {
    "metadata": {
      "package_name": "keras_nightly-3.9.0.dev2025032003",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "saving_lib.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/keras_nightly-3.9.0.dev2025032003/keras_nightly-3.9.0.dev2025032003/keras/src/saving/saving_lib.py",
    "line_number": "168",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "167\t    with open(file_utils.join(dirpath, _METADATA_FILENAME), \"w\") as f:\n168\t        f.write(metadata_json)\n169\t    with open(file_utils.join(dirpath, _CONFIG_FILENAME), \"w\") as f:",
    "code_snippet": "def _save_model_to_dir(model, dirpath, weights_format):\n    if not file_utils.exists(dirpath):\n        file_utils.makedirs(dirpath)\n    config_json, metadata_json = _serialize_model_as_json(model)\n    with open(file_utils.join(dirpath, _METADATA_FILENAME), \"w\") as f:\n        f.write(metadata_json)\n    with open(file_utils.join(dirpath, _CONFIG_FILENAME), \"w\") as f:\n        f.write(config_json)\n    weights_filepath = file_utils.join(dirpath, _VARS_FNAME_H5)\n    assert_dirpath = file_utils.join(dirpath, _ASSETS_DIRNAME)\n    try:\n        if weights_format == \"h5\":\n            weights_store = H5IOStore(weights_filepath, mode=\"w\")\n        elif weights_format == \"npz\":\n            weights_store = NpzIOStore(weights_filepath, mode=\"w\")\n        else:\n            raise ValueError(\n                \"Unknown `weights_format` argument. \"\n                \"Expected 'h5' or 'npz'. \"\n                f\"Received: weights_format={weights_format}\"\n            )\n        asset_store = DiskIOStore(assert_dirpath, mode=\"w\")\n        _save_state(\n            model,\n            weights_store=weights_store,\n            assets_store=asset_store,\n            inner_path=\"\",\n            visited_saveables=set(),\n        )\n    finally:\n        weights_store.close()\n        asset_store.close()",
    "pattern_analysis": {
      "api_sequence": [
        "file_utils.exists",
        "file_utils.makedirs",
        "file_utils.join",
        "open",
        "file_utils.join",
        "open",
        "file_utils.join",
        "file_utils.join",
        "H5IOStore",
        "NpzIOStore",
        "DiskIOStore",
        "weights_store.close",
        "asset_store.close"
      ],
      "api_sequence_with_args": [
        "file_utils.exists(dirpath)",
        "file_utils.makedirs(dirpath)",
        "file_utils.join(dirpath, _METADATA_FILENAME)",
        "open(file_utils.join(dirpath, _METADATA_FILENAME), \"w\")",
        "file_utils.join(dirpath, _CONFIG_FILENAME)",
        "open(file_utils.join(dirpath, _CONFIG_FILENAME), \"w\")",
        "file_utils.join(dirpath, _VARS_FNAME_H5)",
        "file_utils.join(dirpath, _ASSETS_DIRNAME)",
        "H5IOStore(weights_filepath, mode=\"w\")",
        "NpzIOStore(weights_filepath, mode=\"w\")",
        "DiskIOStore(assert_dirpath, mode=\"w\")",
        "weights_store.close()",
        "asset_store.close()"
      ],
      "mapped_sequence": [
        {
          "api_name": "file_utils.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "file_utils.makedirs",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "file_utils.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "file_utils.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "file_utils.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "file_utils.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "H5IOStore",
          "id": "open_zip_write",
          "description": "Opens ZIP archive for writing",
          "first_id": "file_operations",
          "second_id": "compression_archiving",
          "third_id": "zip_operations"
        },
        {
          "api_name": "NpzIOStore",
          "id": "open_zip_write",
          "description": "Opens ZIP archive for writing",
          "first_id": "file_operations",
          "second_id": "compression_archiving",
          "third_id": "zip_operations"
        },
        {
          "api_name": "DiskIOStore",
          "id": "open_zip_write",
          "description": "Opens ZIP archive for writing",
          "first_id": "file_operations",
          "second_id": "compression_archiving",
          "third_id": "zip_operations"
        },
        {
          "api_name": "weights_store.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "asset_store.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        }
      ],
      "contextual_code": "def _save_model_to_dir(model, dirpath, weights_format):\n    if not file_utils.exists(dirpath):\n        file_utils.makedirs(dirpath)\n    config_json, metadata_json = _serialize_model_as_json(model)\n    with open(file_utils.join(dirpath, _METADATA_FILENAME), \"w\") as f:\n        f.write(metadata_json)\n    with open(file_utils.join(dirpath, _CONFIG_FILENAME), \"w\") as f:\n        f.write(config_json)\n    weights_filepath = file_utils.join(dirpath, _VARS_FNAME_H5)\n    assert_dirpath = file_utils.join(dirpath, _ASSETS_DIRNAME)\n    try:\n        if weights_format == \"h5\":\n            weights_store = H5IOStore(weights_filepath, mode=\"w\")\n        elif weights_format == \"npz\":\n            weights_store = NpzIOStore(weights_filepath, mode=\"w\")\n        else:\n            raise ValueError(\n                \"Unknown `weights_format` argument. \"\n                \"Expected 'h5' or 'npz'. \"\n                f\"Received: weights_format={weights_format}\"\n            )\n        asset_store = DiskIOStore(assert_dirpath, mode=\"w\")\n        _save_state(\n            model,\n            weights_store=weights_store,\n            assets_store=asset_store,\n            inner_path=\"\",\n            visited_saveables=set(),\n        )\n    finally:\n        weights_store.close()\n        asset_store.close()"
    }
  }
]