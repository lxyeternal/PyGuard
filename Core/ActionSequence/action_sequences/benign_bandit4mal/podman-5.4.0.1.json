[
  {
    "metadata": {
      "package_name": "podman-5.4.0.1",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "containers.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/podman-5.4.0.1/podman-5.4.0.1/podman/domain/containers.py",
    "line_number": "490",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "489\t        \"\"\"\n490\t        stream = kwargs.get(\"stream\", False)\n491",
    "code_snippet": "def top(self, **kwargs) -> Union[Iterator[dict[str, Any]], dict[str, Any]]:\n    \"\"\"Report on running processes in the container.\n\n    Keyword Args:\n        ps_args (str): When given, arguments will be passed to ps\n        stream (bool): When True, repeatedly return results. Default: False\n\n    Raises:\n        NotFound: when the container no longer exists\n        APIError: when the service reports an error\n    \"\"\"\n    stream = kwargs.get(\"stream\", False)\n\n    params = {\n        \"stream\": stream,\n        \"ps_args\": kwargs.get(\"ps_args\"),\n    }\n    response = self.client.get(f\"/containers/{self.id}/top\", params=params, stream=stream)\n    response.raise_for_status()\n\n    if stream:\n        return api.stream_helper(response, decode_to_json=True)\n\n    return response.json()",
    "pattern_analysis": {
      "api_sequence": [
        "self.client.get",
        "response.raise_for_status",
        "api.stream_helper",
        "response.json"
      ],
      "api_sequence_with_args": [
        "self.client.get(f\"/containers/{self.id}/top\", params=params, stream=stream)",
        "response.raise_for_status()",
        "api.stream_helper(response, decode_to_json=True)",
        "response.json()"
      ],
      "mapped_sequence": [
        {
          "api_name": "self.client.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "response.raise_for_status",
          "id": "raise_http_error",
          "description": "Raises HTTPError if response status code indicates error",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "api.stream_helper",
          "id": "read_response_body",
          "description": "Reads response body from HTTP response",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "response.json",
          "id": "deserialize_json_response",
          "description": "Deserializes JSON response body to Python object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        }
      ],
      "contextual_code": "def top(self, **kwargs):\n    stream = kwargs.get(\"stream\", False)\n    params = {\n        \"stream\": stream,\n        \"ps_args\": kwargs.get(\"ps_args\"),\n    }\n    response = self.client.get(f\"/containers/{self.id}/top\", params=params, stream=stream)\n    response.raise_for_status()\n\n    if stream:\n        return api.stream_helper(response, decode_to_json=True)\n\n    return response.json()"
    }
  }
]