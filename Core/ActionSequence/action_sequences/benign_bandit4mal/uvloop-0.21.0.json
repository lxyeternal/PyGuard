[
  {
    "metadata": {
      "package_name": "uvloop-0.21.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "echoclient.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/uvloop-0.21.0/uvloop-0.21.0/examples/bench/echoclient.py",
    "line_number": "75",
    "type_description": "B804:connect",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "74\n75\t        sock.connect(addr)\n76",
    "code_snippet": "def run_test(n):\n    print('Sending', NMESSAGES, 'messages')\n    if args.mpr:\n        n //= args.mpr\n\n    if unix:\n        sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)\n    else:\n        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\n    try:\n        sock.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)\n    except (OSError, NameError):\n        pass\n\n    if client_context:\n        sock = client_context.wrap_socket(sock)\n\n    sock.connect(addr)\n\n    while n > 0:\n        sock.sendall(msg)\n        nrecv = 0\n        while nrecv < REQSIZE:\n            resp = sock.recv(REQSIZE)\n            if not resp:\n                raise SystemExit()\n            nrecv += len(resp)\n        n -= 1",
    "pattern_analysis": {
      "api_sequence": [
        "socket.socket",
        "socket.socket.setsockopt",
        "client_context.wrap_socket",
        "socket.socket.connect",
        "socket.socket.sendall",
        "socket.socket.recv"
      ],
      "api_sequence_with_args": [
        "socket.socket(socket.AF_UNIX, socket.SOCK_STREAM) / socket.socket(socket.AF_INET, socket.SOCK_STREAM)",
        "socket.socket.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)",
        "client_context.wrap_socket(sock)",
        "socket.socket.connect(addr)",
        "socket.socket.sendall(msg)",
        "socket.socket.recv(REQSIZE)"
      ],
      "mapped_sequence": [
        {
          "api_name": "socket.socket",
          "id": "create_socket",
          "description": "Creates new socket object",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "socket_creation"
        },
        {
          "api_name": "socket.socket.setsockopt",
          "id": "set_socket_timeout",
          "description": "Sets timeout for socket operations",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "socket_configuration"
        },
        {
          "api_name": "client_context.wrap_socket",
          "id": "wrap_socket_ssl",
          "description": "Wraps socket for SSL/TLS communication",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "connection_management"
        },
        {
          "api_name": "socket.socket.connect",
          "id": "establish_tcp_connection",
          "description": "Establishes TCP connection to specified address",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "connection_management"
        },
        {
          "api_name": "socket.socket.sendall",
          "id": "send_socket_data",
          "description": "Sends data over socket connection",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "data_transmission"
        },
        {
          "api_name": "socket.socket.recv",
          "id": "receive_socket_data",
          "description": "Receives data from socket connection",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "data_transmission"
        }
      ],
      "contextual_code": "def run_test(n):\n    if args.mpr:\n        n //= args.mpr\n\n    if unix:\n        sock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)\n    else:\n        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\n    try:\n        sock.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)\n    except (OSError, NameError):\n        pass\n\n    if client_context:\n        sock = client_context.wrap_socket(sock)\n\n    sock.connect(addr)\n\n    while n > 0:\n        sock.sendall(msg)\n        nrecv = 0\n        while nrecv < REQSIZE:\n            resp = sock.recv(REQSIZE)\n            if not resp:\n                raise SystemExit()\n            nrecv += len(resp)\n        n -= 1"
    }
  }
]