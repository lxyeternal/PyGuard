[
  {
    "metadata": {
      "package_name": "hashin-1.0.3",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "hashin.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/hashin-1.0.3/hashin-1.0.3/hashin.py",
    "line_number": "311",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "310\t        sys.stdout.write(\"\\033[F\")  # Cursor up one line\n311\t        sys.stdout.write(\"\\033[K\")  # Clear to the end of line\n312",
    "code_snippet": "def interactive_upgrade_request(\n    package, old_version, new_version, print_header=False, force_yes=False\n):\n    def print_version(v):\n        return str(v).replace(\"==\", \"\").ljust(15)\n\n    if print_header:\n        print(\n            \"PACKAGE\".ljust(30),\n            print_version(\"YOUR VERSION\"),\n            print_version(\"NEW VERSION\"),\n        )\n\n    def print_line(checkbox=None):\n        if checkbox is None:\n            checkboxed = \"?\"\n        elif checkbox:\n            checkboxed = \"✓\"\n        else:\n            checkboxed = \"✘\"\n        print(\n            package.ljust(30),\n            print_version(old_version),\n            print_version(new_version),\n            checkboxed,\n        )\n\n    if force_yes:\n        print_line(True)\n        return \"YES\"\n    else:\n        print_line()\n\n    printed_help = []\n\n    def print_help():\n        print(\n            \"y - Include this update (default)\\n\"\n            \"n - Skip this update\\n\"\n            \"a - Include this and all following upgrades\\n\"\n            \"q - Skip this and all following upgrades\\n\"\n            \"? - Print this help\\n\"\n        )\n        printed_help.append(1)\n\n    def clear_line():\n        sys.stdout.write(\"\\033[F\")  # Cursor up one line\n        sys.stdout.write(\"\\033[K\")  # Clear to the end of line\n\n    def ask():\n        answer = input(\"Update? [Y/n/a/q/?]: \").lower().strip()\n        if printed_help:\n            # Because the print_help() prints 5 lines to stdout.\n            # Plus 2 because of the original question line and the extra blank line.\n            for i in range(5 + 2):\n                clear_line()\n            # printed_help.clear()\n            del printed_help[:]\n\n        if answer == \"n\":\n            clear_line()\n            clear_line()\n            print_line(False)\n            return \"NO\"\n        if answer == \"a\":\n            clear_line()\n            clear_line()\n            print_line(True)\n            return \"ALL\"\n        if answer == \"q\":\n            return \"QUIT\"\n        if answer == \"y\" or answer == \"\" or answer == \"yes\":\n            clear_line()\n            clear_line()\n            print_line(True)\n            return \"YES\"\n        if answer == \"?\":\n            print_help()\n\n        return ask()\n\n    return ask()",
    "pattern_analysis": {
      "api_sequence": [
        "print",
        "print",
        "input",
        "sys.stdout.write",
        "sys.stdout.write",
        "print",
        "sys.stdout.write",
        "sys.stdout.write",
        "print",
        "sys.stdout.write",
        "sys.stdout.write",
        "print"
      ],
      "api_sequence_with_args": [
        "print(\"PACKAGE\".ljust(30), print_version(\"YOUR VERSION\"), print_version(\"NEW VERSION\"))",
        "print(package.ljust(30), print_version(old_version), print_version(new_version), checkboxed)",
        "input(\"Update? [Y/n/a/q/?]: \")",
        "sys.stdout.write(\"\\033[F\")",
        "sys.stdout.write(\"\\033[K\")",
        "print(package.ljust(30), print_version(old_version), print_version(new_version), checkboxed)",
        "sys.stdout.write(\"\\033[F\")",
        "sys.stdout.write(\"\\033[K\")",
        "print(package.ljust(30), print_version(old_version), print_version(new_version), checkboxed)",
        "sys.stdout.write(\"\\033[F\")",
        "sys.stdout.write(\"\\033[K\")",
        "print(package.ljust(30), print_version(old_version), print_version(new_version), checkboxed)"
      ],
      "mapped_sequence": [
        {
          "api_name": "print",
          "id": "get_stdout_stream",
          "description": "Retrieves standard output stream object",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "print",
          "id": "get_stdout_stream",
          "description": "Retrieves standard output stream object",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "input",
          "id": "read_user_input",
          "description": "Reads user input from standard input",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "sys.stdout.write",
          "id": "get_stdout_stream",
          "description": "Retrieves standard output stream object",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "sys.stdout.write",
          "id": "get_stdout_stream",
          "description": "Retrieves standard output stream object",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "print",
          "id": "get_stdout_stream",
          "description": "Retrieves standard output stream object",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "sys.stdout.write",
          "id": "get_stdout_stream",
          "description": "Retrieves standard output stream object",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "sys.stdout.write",
          "id": "get_stdout_stream",
          "description": "Retrieves standard output stream object",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "print",
          "id": "get_stdout_stream",
          "description": "Retrieves standard output stream object",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "sys.stdout.write",
          "id": "get_stdout_stream",
          "description": "Retrieves standard output stream object",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "sys.stdout.write",
          "id": "get_stdout_stream",
          "description": "Retrieves standard output stream object",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "print",
          "id": "get_stdout_stream",
          "description": "Retrieves standard output stream object",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        }
      ],
      "contextual_code": "def interactive_upgrade_request(package, old_version, new_version, print_header=False, force_yes=False):\n    def print_version(v):\n        return str(v).replace(\"==\", \"\").ljust(15)\n\n    if print_header:\n        print(\n            \"PACKAGE\".ljust(30),\n            print_version(\"YOUR VERSION\"),\n            print_version(\"NEW VERSION\"),\n        )\n\n    def print_line(checkbox=None):\n        if checkbox is None:\n            checkboxed = \"?\"\n        elif checkbox:\n            checkboxed = \"✓\"\n        else:\n            checkboxed = \"✘\"\n        print(\n            package.ljust(30),\n            print_version(old_version),\n            print_version(new_version),\n            checkboxed,\n        )\n\n    if force_yes:\n        print_line(True)\n        return \"YES\"\n    else:\n        print_line()\n\n    printed_help = []\n\n    def print_help():\n        print(\n            \"y - Include this update (default)\\n\"\n            \"n - Skip this update\\n\"\n            \"a - Include this and all following upgrades\\n\"\n            \"q - Skip this and all following upgrades\\n\"\n            \"? - Print this help\\n\"\n        )\n        printed_help.append(1)\n\n    def clear_line():\n        sys.stdout.write(\"\\033[F\")  # Cursor up one line\n        sys.stdout.write(\"\\033[K\")  # Clear to the end of line\n\n    def ask():\n        answer = input(\"Update? [Y/n/a/q/?]: \").lower().strip()\n        if printed_help:\n            for i in range(5 + 2):\n                clear_line()\n            del printed_help[:]\n\n        if answer == \"n\":\n            clear_line()\n            clear_line()\n            print_line(False)\n            return \"NO\"\n        if answer == \"a\":\n            clear_line()\n            clear_line()\n            print_line(True)\n            return \"ALL\"\n        if answer == \"q\":\n            return \"QUIT\"\n        if answer == \"y\" or answer == \"\" or answer == \"yes\":\n            clear_line()\n            clear_line()\n            print_line(True)\n            return \"YES\"\n        if answer == \"?\":\n            print_help()\n\n        return ask()\n\n    return ask()"
    }
  }
]