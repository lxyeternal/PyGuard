[
  {
    "metadata": {
      "package_name": "nilearn-0.11.1",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "__init__.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/nilearn-0.11.1/nilearn-0.11.1/nilearn/externals/tempita/__init__.py",
    "line_number": "1299",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1298\t        f = open(options.output, 'wb')\n1299\t        f.write(result)\n1300\t        f.close()",
    "code_snippet": "def fill_command(args=None):\n    import optparse\n    import pkg_resources\n    if args is None:\n        args = sys.argv[1:]\n    dist = pkg_resources.get_distribution('Paste')\n    parser = optparse.OptionParser(\n        version=coerce_text(dist),\n        usage=_fill_command_usage)\n    parser.add_option(\n        '-o', '--output',\n        dest='output',\n        metavar=\"FILENAME\",\n        help=\"File to write output to (default stdout)\")\n    parser.add_option(\n        '--html',\n        dest='use_html',\n        action='store_true',\n        help=\"Use HTML style filling (including automatic HTML quoting)\")\n    parser.add_option(\n        '--env',\n        dest='use_env',\n        action='store_true',\n        help=\"Put the environment in as top-level variables\")\n    options, args = parser.parse_args(args)\n    if len(args) < 1:\n        print('You must give a template filename')\n        sys.exit(2)\n    template_name = args[0]\n    args = args[1:]\n    vars = {}\n    if options.use_env:\n        vars.update(os.environ)\n    for value in args:\n        if '=' not in value:\n            print('Bad argument: %r' % value)\n            sys.exit(2)\n        name, value = value.split('=', 1)\n        if name.startswith('py:'):\n            name = name[:3]\n            value = eval(value)\n        vars[name] = value\n    if template_name == '-':\n        template_content = sys.stdin.read()\n        template_name = '<stdin>'\n    else:\n        f = open(template_name, 'rb', encoding=\"latin-1\")\n        template_content = f.read()\n        f.close()\n    if options.use_html:\n        TemplateClass = HTMLTemplate\n    else:\n        TemplateClass = Template\n    template = TemplateClass(template_content, name=template_name)\n    result = template.substitute(vars)\n    if options.output:\n        f = open(options.output, 'wb')\n        f.write(result)\n        f.close()\n    else:\n        sys.stdout.write(result)",
    "pattern_analysis": {
      "api_sequence": [
        "sys.argv",
        "os.environ",
        "eval",
        "sys.stdin.read",
        "open",
        "open",
        "f.read",
        "f.close",
        "TemplateClass",
        "template.substitute",
        "open",
        "f.write",
        "f.close",
        "sys.stdout.write",
        "sys.exit"
      ],
      "api_sequence_with_args": [
        "sys.argv[1:]",
        "os.environ",
        "eval(value)",
        "sys.stdin.read()",
        "open(template_name, 'rb', encoding=\"latin-1\")",
        "open(options.output, 'wb')",
        "f.read()",
        "f.close()",
        "TemplateClass(template_content, name=template_name)",
        "template.substitute(vars)",
        "open(options.output, 'wb')",
        "f.write(result)",
        "f.close()",
        "sys.stdout.write(result)",
        "sys.exit(2)"
      ],
      "mapped_sequence": [
        {
          "api_name": "sys.argv",
          "id": "get_cmd_args",
          "description": "Retrieves command-line arguments passed to script",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "os.environ",
          "id": "get_env_vars",
          "description": "Retrieves environment variables mapping",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "eval",
          "id": "eval_python_expr",
          "description": "Evaluates string as Python expression",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "string_execution"
        },
        {
          "api_name": "sys.stdin.read",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "f.read",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "f.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "TemplateClass",
          "id": "import_dynamic",
          "description": "Dynamically imports specified module",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "module_importing"
        },
        {
          "api_name": "template.substitute",
          "id": "eval_python_expr",
          "description": "Evaluates string as Python expression",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "string_execution"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "f.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "f.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "sys.stdout.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "sys.exit",
          "id": "exit_program",
          "description": "Exits program with specified status code",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_control"
        }
      ],
      "contextual_code": "def fill_command(args=None):\n    import optparse\n    import pkg_resources\n    if args is None:\n        args = sys.argv[1:]\n    ...\n    if options.use_env:\n        vars.update(os.environ)\n    for value in args:\n        if '=' not in value:\n            print('Bad argument: %r' % value)\n            sys.exit(2)\n        name, value = value.split('=', 1)\n        if name.startswith('py:'):\n            name = name[:3]\n            value = eval(value)\n        vars[name] = value\n    if template_name == '-':\n        template_content = sys.stdin.read()\n        template_name = '<stdin>'\n    else:\n        f = open(template_name, 'rb', encoding=\"latin-1\")\n        template_content = f.read()\n        f.close()\n    if options.use_html:\n        TemplateClass = HTMLTemplate\n    else:\n        TemplateClass = Template\n    template = TemplateClass(template_content, name=template_name)\n    result = template.substitute(vars)\n    if options.output:\n        f = open(options.output, 'wb')\n        f.write(result)\n        f.close()\n    else:\n        sys.stdout.write(result)"
    }
  }
]