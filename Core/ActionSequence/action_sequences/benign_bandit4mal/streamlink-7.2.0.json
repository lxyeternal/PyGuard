[
  {
    "metadata": {
      "package_name": "streamlink-7.2.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "m3u8.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/streamlink-7.2.0/streamlink-7.2.0/src/streamlink/stream/hls/m3u8.py",
    "line_number": "474",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "473\t            default=self.parse_bool(attr.get(\"DEFAULT\", \"NO\")),\n474\t            autoselect=self.parse_bool(attr.get(\"AUTOSELECT\", \"NO\")),\n475\t            forced=self.parse_bool(attr.get(\"FORCED\", \"NO\")),",
    "code_snippet": "@parse_tag(\"EXT-X-MEDIA\")\ndef parse_tag_ext_x_media(self, value: str) -> None:\n    \"\"\"\n    EXT-X-MEDIA\n    https://datatracker.ietf.org/doc/html/rfc8216#section-4.3.4.1\n    \"\"\"\n    attr = self.parse_attributes(value)\n    mediatype = attr.get(\"TYPE\")\n    uri = attr.get(\"URI\")\n    group_id = attr.get(\"GROUP-ID\")\n    name = attr.get(\"NAME\")\n\n    if not mediatype or not group_id or not name:\n        return\n\n    if language := attr.get(\"LANGUAGE\"):\n        language = language.strip().lower()\n\n    media = Media(\n        type=mediatype,\n        uri=self.uri(uri) if uri else None,\n        group_id=group_id,\n        language=language,\n        name=name,\n        default=self.parse_bool(attr.get(\"DEFAULT\", \"NO\")),\n        autoselect=self.parse_bool(attr.get(\"AUTOSELECT\", \"NO\")),\n        forced=self.parse_bool(attr.get(\"FORCED\", \"NO\")),\n        characteristics=attr.get(\"CHARACTERISTICS\"),\n    )\n    self.m3u8.media.append(media)",
    "pattern_analysis": {
      "api_sequence": [],
      "api_sequence_with_args": [],
      "mapped_sequence": [],
      "contextual_code": "@parse_tag(\"EXT-X-MEDIA\")\ndef parse_tag_ext_x_media(self, value: str) -> None:\n    attr = self.parse_attributes(value)\n    mediatype = attr.get(\"TYPE\")\n    uri = attr.get(\"URI\")\n    group_id = attr.get(\"GROUP-ID\")\n    name = attr.get(\"NAME\")\n\n    if not mediatype or not group_id or not name:\n        return\n\n    if language := attr.get(\"LANGUAGE\"):\n        language = language.strip().lower()\n\n    media = Media(\n        type=mediatype,\n        uri=self.uri(uri) if uri else None,\n        group_id=group_id,\n        language=language,\n        name=name,\n        default=self.parse_bool(attr.get(\"DEFAULT\", \"NO\")),\n        autoselect=self.parse_bool(attr.get(\"AUTOSELECT\", \"NO\")),\n        forced=self.parse_bool(attr.get(\"FORCED\", \"NO\")),\n        characteristics=attr.get(\"CHARACTERISTICS\"),\n    )\n    self.m3u8.media.append(media)"
    }
  }
]