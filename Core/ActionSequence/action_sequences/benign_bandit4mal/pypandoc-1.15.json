[
  {
    "metadata": {
      "package_name": "pypandoc-1.15",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "tests.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pypandoc-1.15/pypandoc-1.15/tests.py",
    "line_number": "28",
    "type_description": "B814:read",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "27\t    sys.stderr.seek(0)\n28\t    yield sys.stderr.read()\n29\t  finally:",
    "code_snippet": "@contextlib.contextmanager\ndef capture(command, *args, **kwargs):\n  err, sys.stderr = sys.stderr, io.StringIO()\n  try:\n    command(*args, **kwargs)\n    sys.stderr.seek(0)\n    yield sys.stderr.read()\n  finally:\n    sys.stderr = err",
    "pattern_analysis": {
      "api_sequence": [
        "sys.stderr",
        "io.StringIO",
        "sys.stderr.seek",
        "sys.stderr.read"
      ],
      "api_sequence_with_args": [
        "sys.stderr",
        "io.StringIO()",
        "sys.stderr.seek(0)",
        "sys.stderr.read()"
      ],
      "mapped_sequence": [
        {
          "api_name": "sys.stderr",
          "id": "get_stdout_stream",
          "description": "Retrieves standard output stream object",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "io.StringIO",
          "id": "create_memory_bytes",
          "description": "Creates in-memory bytes buffer from encoded string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "sys.stderr.seek",
          "id": "move_buffer_pointer",
          "description": "Moves buffer pointer to start",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "sys.stderr.read",
          "id": "get_buffer_bytes",
          "description": "Retrieves bytes value from in-memory buffer",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        }
      ],
      "contextual_code": "@contextlib.contextmanager\ndef capture(command, *args, **kwargs):\n  err, sys.stderr = sys.stderr, io.StringIO()\n  try:\n    command(*args, **kwargs)\n    sys.stderr.seek(0)\n    yield sys.stderr.read()\n  finally:\n    sys.stderr = err"
    }
  }
]