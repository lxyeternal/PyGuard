[
  {
    "metadata": {
      "package_name": "hachoir-3.3.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "timeout.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/hachoir-3.3.0/hachoir-3.3.0/hachoir/core/timeout.py",
    "line_number": "54",
    "type_description": "B828:signal",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "53\t                alarm(0)\n54\t                signal(SIGALRM, old_alarm)\n55",
    "code_snippet": "if not IMPLEMENTATION:\n    try:\n        from signal import signal, alarm, SIGALRM\n\n        # signal.alarm() implementation\n        def limitedTime(second, func, *args, **kw):  # noqa\n            second = fixTimeout(second)\n            old_alarm = signal(SIGALRM, signalHandler)\n            try:\n                alarm(second)\n                return func(*args, **kw)\n            finally:\n                alarm(0)\n                signal(SIGALRM, old_alarm)\n\n        IMPLEMENTATION = \"signal.alarm()\"\n    except ImportError:\n        pass",
    "pattern_analysis": {
      "api_sequence": [
        "signal.signal",
        "signal.alarm",
        "signal.alarm",
        "signal.signal"
      ],
      "api_sequence_with_args": [
        "signal.signal(SIGALRM, signalHandler)",
        "signal.alarm(second)",
        "signal.alarm(0)",
        "signal.signal(SIGALRM, old_alarm)"
      ],
      "mapped_sequence": [
        {
          "api_name": "signal.signal",
          "id": "register_exit_function",
          "description": "Registers function to be called at program exit",
          "first_id": "persistence_stealth",
          "second_id": "persistence_mechanisms",
          "third_id": "persistence_configuration"
        },
        {
          "api_name": "signal.alarm",
          "id": "suspend_execution",
          "description": "Suspends execution for specified seconds",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        },
        {
          "api_name": "signal.alarm",
          "id": "suspend_execution",
          "description": "Suspends execution for specified seconds",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        },
        {
          "api_name": "signal.signal",
          "id": "register_exit_function",
          "description": "Registers function to be called at program exit",
          "first_id": "persistence_stealth",
          "second_id": "persistence_mechanisms",
          "third_id": "persistence_configuration"
        }
      ],
      "contextual_code": "from signal import signal, alarm, SIGALRM\n\ndef limitedTime(second, func, *args, **kw):\n    second = fixTimeout(second)\n    old_alarm = signal(SIGALRM, signalHandler)\n    try:\n        alarm(second)\n        return func(*args, **kw)\n    finally:\n        alarm(0)\n        signal(SIGALRM, old_alarm)"
    }
  }
]