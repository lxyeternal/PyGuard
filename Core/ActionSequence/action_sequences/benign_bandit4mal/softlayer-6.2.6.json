[
  {
    "metadata": {
      "package_name": "softlayer-6.2.6",
      "total_matches": 2,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "sshkey_tests.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/softlayer-6.2.6/softlayer-6.2.6/tests/CLI/modules/sshkey_tests.py",
    "line_number": "130",
    "type_description": "B814:read",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "129\t            self.assert_no_fail(result)\n130\t            self.assertEqual(mock_key, sshkey_file.read().decode(\"utf-8\"))",
    "code_snippet": "def test_print_key_file(self):\n    if sys.platform.startswith(\"win\"):\n        self.skipTest(\"Test doesn't work in Windows\")\n    with tempfile.NamedTemporaryFile() as sshkey_file:\n        service = self.client['Security_Ssh_Key']\n        mock_key = service.getObject()['key']\n        result = self.run_command(['sshkey', 'print', '1234',\n                                   '--out-file=%s' % sshkey_file.name])\n\n        self.assert_no_fail(result)\n        self.assertEqual(mock_key, sshkey_file.read().decode(\"utf-8\"))",
    "pattern_analysis": {
      "api_sequence": [
        "tempfile.NamedTemporaryFile",
        "self.client.__getitem__",
        "service.getObject",
        "self.run_command",
        "sshkey_file.read",
        "sshkey_file.read.decode"
      ],
      "api_sequence_with_args": [
        "tempfile.NamedTemporaryFile()",
        "self.client['Security_Ssh_Key']",
        "service.getObject()",
        "self.run_command(['sshkey', 'print', '1234', '--out-file=%s' % sshkey_file.name])",
        "sshkey_file.read()",
        "sshkey_file.read().decode('utf-8')"
      ],
      "mapped_sequence": [
        {
          "api_name": "tempfile.NamedTemporaryFile",
          "id": "create_temp_file",
          "description": "Creates temporary file that is not deleted on close",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "self.client.__getitem__",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "service.getObject",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "self.run_command",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "sshkey_file.read",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "sshkey_file.read.decode",
          "id": "decode_bytes_codec",
          "description": "Decodes bytes using specified codec",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        }
      ],
      "contextual_code": "with tempfile.NamedTemporaryFile() as sshkey_file:\n    service = self.client['Security_Ssh_Key']\n    mock_key = service.getObject()['key']\n    result = self.run_command(['sshkey', 'print', '1234', '--out-file=%s' % sshkey_file.name])\n    self.assertEqual(mock_key, sshkey_file.read().decode('utf-8'))"
    }
  },
  {
    "pyfile": "rest_tests.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/softlayer-6.2.6/softlayer-6.2.6/tests/transports/rest_tests.py",
    "line_number": "280",
    "type_description": "B822:request",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "279\t    def test_with_limit_offset(self, request):\n280\t        request().text = '{}'\n281",
    "code_snippet": "@mock.patch('SoftLayer.transports.rest.requests.Session.request')\n    def test_with_limit_offset(self, request):\n        request().text = '{}'\n\n        req = transports.Request()\n        req.service = 'SoftLayer_Service'\n        req.method = 'getObject'\n        req.identifier = 2\n        req.limit = 10\n        req.offset = 5\n\n        resp = self.transport(req)\n\n        self.assertEqual(resp, {})\n        request.assert_called_with(\n            'GET',\n            'http://something9999999999999999999999.com/SoftLayer_Service/2/getObject.json',\n            headers=mock.ANY,\n            auth=None,\n            data=None,\n            params={'resultLimit': '5,10'},\n            verify=True,\n            cert=None,\n            proxies=None,\n            timeout=None)",
    "pattern_analysis": {
      "api_sequence": [
        "SoftLayer.transports.rest.requests.Session.request"
      ],
      "api_sequence_with_args": [
        "SoftLayer.transports.rest.requests.Session.request('GET', 'http://something9999999999999999999999.com/SoftLayer_Service/2/getObject.json', headers=mock.ANY, auth=None, data=None, params={'resultLimit': '5,10'}, verify=True, cert=None, proxies=None, timeout=None)"
      ],
      "mapped_sequence": [
        {
          "api_name": "SoftLayer.transports.rest.requests.Session.request",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        }
      ],
      "contextual_code": "@mock.patch('SoftLayer.transports.rest.requests.Session.request')\ndef test_with_limit_offset(self, request):\n    request().text = '{}'\n\n    req = transports.Request()\n    req.service = 'SoftLayer_Service'\n    req.method = 'getObject'\n    req.identifier = 2\n    req.limit = 10\n    req.offset = 5\n\n    resp = self.transport(req)\n\n    self.assertEqual(resp, {})\n    request.assert_called_with(\n        'GET',\n        'http://something9999999999999999999999.com/SoftLayer_Service/2/getObject.json',\n        headers=mock.ANY,\n        auth=None,\n        data=None,\n        params={'resultLimit': '5,10'},\n        verify=True,\n        cert=None,\n        proxies=None,\n        timeout=None)"
    }
  }
]