[
  {
    "metadata": {
      "package_name": "pyobjc_framework_applescriptobjc-11.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "pyobjc_setup.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pyobjc_framework_applescriptobjc-11.0/pyobjc_framework_applescriptobjc-11.0/pyobjc_setup.py",
    "line_number": "355",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "354\t    with tempfile.NamedTemporaryFile(mode=\"w\", suffix=\".c\") as fp:\n355\t        fp.write(\"#include <stdarg.h>\\nint main(void) { return 0; }\\n\")\n356\t        fp.flush()",
    "code_snippet": "def _working_compiler(executable):\n    with tempfile.NamedTemporaryFile(mode=\"w\", suffix=\".c\") as fp:\n        fp.write(\"#include <stdarg.h>\\nint main(void) { return 0; }\\n\")\n        fp.flush()\n\n        cflags = get_config_var(\"CFLAGS\")\n        cflags = shlex.split(cflags)\n\n        p = subprocess.Popen(\n            [executable, \"-c\", fp.name] + cflags,\n            stdout=subprocess.PIPE,\n            stderr=subprocess.PIPE,\n        )\n        status = p.wait()\n        p.stdout.close()\n        p.stderr.close()\n        if status != 0:\n            return False\n\n        binfile = fp.name[:-1] + \"o\"\n        if os.path.exists(binfile):\n            os.unlink(binfile)\n\n        binfile = os.path.basename(binfile)\n        if os.path.exists(binfile):\n            os.unlink(binfile)\n\n    cflags = get_config_var(\"CFLAGS\")\n    if re.search(r\"-arch\\s+i386\", cflags) is not None:\n        raise DistutilsPlatformError(\"i386 (32-bit) is not supported by PyObjC\")\n\n    if re.search(r\"-arch\\s+ppc\", cflags) is not None:\n        raise DistutilsPlatformError(\"PowerPC is not supported by PyObjC\")\n\n    return True",
    "pattern_analysis": {
      "api_sequence": [
        "tempfile.NamedTemporaryFile",
        "tempfile.NamedTemporaryFile.write",
        "tempfile.NamedTemporaryFile.flush",
        "get_config_var",
        "shlex.split",
        "subprocess.Popen",
        "subprocess.Popen.wait",
        "subprocess.Popen.stdout.close",
        "subprocess.Popen.stderr.close",
        "os.path.exists",
        "os.unlink",
        "os.path.basename",
        "os.path.exists",
        "os.unlink",
        "get_config_var",
        "re.search",
        "re.search"
      ],
      "api_sequence_with_args": [
        "tempfile.NamedTemporaryFile(mode=\"w\", suffix=\".c\")",
        "tempfile.NamedTemporaryFile.write(\"#include <stdarg.h>\\nint main(void) { return 0; }\\n\")",
        "tempfile.NamedTemporaryFile.flush()",
        "get_config_var(\"CFLAGS\")",
        "shlex.split(cflags)",
        "subprocess.Popen([executable, \"-c\", fp.name] + cflags, stdout=subprocess.PIPE, stderr=subprocess.PIPE)",
        "subprocess.Popen.wait()",
        "subprocess.Popen.stdout.close()",
        "subprocess.Popen.stderr.close()",
        "os.path.exists(binfile)",
        "os.unlink(binfile)",
        "os.path.basename(binfile)",
        "os.path.exists(binfile)",
        "os.unlink(binfile)",
        "get_config_var(\"CFLAGS\")",
        "re.search(r\"-arch\\s+i386\", cflags)",
        "re.search(r\"-arch\\s+ppc\", cflags)"
      ],
      "mapped_sequence": [
        {
          "api_name": "tempfile.NamedTemporaryFile",
          "id": "create_temp_file",
          "description": "Creates temporary file that is not deleted on close",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "tempfile.NamedTemporaryFile.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "tempfile.NamedTemporaryFile.flush",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "get_config_var",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "shlex.split",
          "id": "deserialize_from_bytes",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "subprocess.Popen",
          "id": "spawn_process_no_shell",
          "description": "Spawns new process to execute command without shell access",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_creation"
        },
        {
          "api_name": "subprocess.Popen.wait",
          "id": "wait_process_completion",
          "description": "Waits for process to complete execution",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_control"
        },
        {
          "api_name": "subprocess.Popen.stdout.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "subprocess.Popen.stderr.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.unlink",
          "id": "delete_file",
          "description": "Deletes specified file from filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_transfer"
        },
        {
          "api_name": "os.path.basename",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.unlink",
          "id": "delete_file",
          "description": "Deletes specified file from filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_transfer"
        },
        {
          "api_name": "get_config_var",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "re.search",
          "id": "compile_regex",
          "description": "Compiles regular expression pattern",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "code_compilation"
        },
        {
          "api_name": "re.search",
          "id": "compile_regex",
          "description": "Compiles regular expression pattern",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "code_compilation"
        }
      ],
      "contextual_code": "def _working_compiler(executable):\n    with tempfile.NamedTemporaryFile(mode=\"w\", suffix=\".c\") as fp:\n        fp.write(\"#include <stdarg.h>\\nint main(void) { return 0; }\\n\")\n        fp.flush()\n\n        cflags = get_config_var(\"CFLAGS\")\n        cflags = shlex.split(cflags)\n\n        p = subprocess.Popen(\n            [executable, \"-c\", fp.name] + cflags,\n            stdout=subprocess.PIPE,\n            stderr=subprocess.PIPE,\n        )\n        status = p.wait()\n        p.stdout.close()\n        p.stderr.close()\n        if status != 0:\n            return False\n\n        binfile = fp.name[:-1] + \"o\"\n        if os.path.exists(binfile):\n            os.unlink(binfile)\n\n        binfile = os.path.basename(binfile)\n        if os.path.exists(binfile):\n            os.unlink(binfile)\n\n    cflags = get_config_var(\"CFLAGS\")\n    if re.search(r\"-arch\\s+i386\", cflags) is not None:\n        raise DistutilsPlatformError(\"i386 (32-bit) is not supported by PyObjC\")\n\n    if re.search(r\"-arch\\s+ppc\", cflags) is not None:\n        raise DistutilsPlatformError(\"PowerPC is not supported by PyObjC\")\n\n    return True"
    }
  }
]