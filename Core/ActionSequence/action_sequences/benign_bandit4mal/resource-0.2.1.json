[
  {
    "metadata": {
      "package_name": "resource-0.2.1",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "django.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/resource-0.2.1/Resource-0.2.1/rsrc/framework/django.py",
    "line_number": "95",
    "type_description": "B835:load",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "94\t        def get_data(self, request):\n95\t            return payload(request)\n96",
    "code_snippet": "def get_data(self, request):\n    return payload(request)\n\ndef payload(request):\n    \"\"\"\n    Inspired by `Django REST framework` - https://github.com/tomchristie/django-rest-framework\n    \"\"\"\n\n    # get the content body of the request, as a stream.\n    try:\n        content_length = int(request.META.get('CONTENT_LENGTH',\n                             request.META.get('HTTP_CONTENT_LENGTH')))\n    except (ValueError, TypeError):\n        content_length = 0\n\n    if content_length == 0:\n        stream = None\n    else:\n        stream = request\n\n    content_type = request.META.get('HTTP_CONTENT_TYPE',\n                                    request.META.get('CONTENT_TYPE'))\n\n    if stream is None or content_type is None:\n        return {}\n\n    encoding = settings.DEFAULT_CHARSET\n    try:\n        data = stream.read().decode(encoding)\n        return json.loads(data)\n    except ValueError:\n        return {}",
    "pattern_analysis": {
      "api_sequence": [
        "request.META.get",
        "request.META.get",
        "request.read",
        "json.loads"
      ],
      "api_sequence_with_args": [
        "request.META.get('CONTENT_LENGTH', request.META.get('HTTP_CONTENT_LENGTH'))",
        "request.META.get('HTTP_CONTENT_TYPE', request.META.get('CONTENT_TYPE'))",
        "request.read()",
        "json.loads(data)"
      ],
      "mapped_sequence": [
        {
          "api_name": "request.META.get",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "request.META.get",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "request.read",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "json.loads",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        }
      ],
      "contextual_code": "def payload(request):\n    try:\n        content_length = int(request.META.get('CONTENT_LENGTH', request.META.get('HTTP_CONTENT_LENGTH')))\n    except (ValueError, TypeError):\n        content_length = 0\n\n    if content_length == 0:\n        stream = None\n    else:\n        stream = request\n\n    content_type = request.META.get('HTTP_CONTENT_TYPE', request.META.get('CONTENT_TYPE'))\n\n    if stream is None or content_type is None:\n        return {}\n\n    encoding = settings.DEFAULT_CHARSET\n    try:\n        data = stream.read().decode(encoding)\n        return json.loads(data)\n    except ValueError:\n        return {}"
    }
  }
]