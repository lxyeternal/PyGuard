[
  {
    "metadata": {
      "package_name": "easy_thumbnails-2.10",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "namers.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/easy_thumbnails-2.10/easy_thumbnails-2.10/easy_thumbnails/namers.py",
    "line_number": "42",
    "type_description": "B802:b64encode",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "41\t    short_sha = hashlib.sha1(parts.encode('utf-8')).digest()\n42\t    short_hash = base64.urlsafe_b64encode(short_sha[:9]).decode('utf-8')\n43\t    return '.'.join([short_hash, thumbnail_extension])",
    "code_snippet": "import base64\nimport hashlib\n\ndef hashed(source_filename, prepared_options, thumbnail_extension, **kwargs):\n    \"\"\"\n    Generate a short hashed thumbnail filename.\n\n    Creates a 12 character url-safe base64 sha1 filename (plus the extension),\n    for example: ``6qW1buHgLaZ9.jpg``.\n    \"\"\"\n    parts = ':'.join([source_filename] + prepared_options)\n    short_sha = hashlib.sha1(parts.encode('utf-8')).digest()\n    short_hash = base64.urlsafe_b64encode(short_sha[:9]).decode('utf-8')\n    return '.'.join([short_hash, thumbnail_extension])\n",
    "pattern_analysis": {
      "api_sequence": [
        "hashlib.sha1",
        "base64.urlsafe_b64encode"
      ],
      "api_sequence_with_args": [
        "hashlib.sha1(parts.encode('utf-8')).digest()",
        "base64.urlsafe_b64encode(short_sha[:9])"
      ],
      "mapped_sequence": [
        {
          "api_name": "hashlib.sha1",
          "id": "create_sha1_hash",
          "description": "Creates SHA-1 hash object from encoded string",
          "first_id": "encryption_hashing",
          "second_id": "hash_calculation",
          "third_id": "hash_object_creation"
        },
        {
          "api_name": "base64.urlsafe_b64encode",
          "id": "encode_bytes_to_base64",
          "description": "Encodes bytes to base64-encoded bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        }
      ],
      "contextual_code": "import base64\nimport hashlib\n\ndef hashed(source_filename, prepared_options, thumbnail_extension, **kwargs):\n    parts = ':'.join([source_filename] + prepared_options)\n    short_sha = hashlib.sha1(parts.encode('utf-8')).digest()\n    short_hash = base64.urlsafe_b64encode(short_sha[:9]).decode('utf-8')\n    return '.'.join([short_hash, thumbnail_extension])"
    }
  }
]