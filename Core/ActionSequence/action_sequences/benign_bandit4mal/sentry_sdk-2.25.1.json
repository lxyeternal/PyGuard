[
  {
    "metadata": {
      "package_name": "sentry_sdk-2.25.1",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "stdlib.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/sentry_sdk-2.25.1/sentry_sdk-2.25.1/sentry_sdk/integrations/stdlib.py",
    "line_number": "131",
    "type_description": "B826:getresponse",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "130\t        try:\n131\t            rv = real_getresponse(self, *args, **kwargs)\n132",
    "code_snippet": "def getresponse(self, *args, **kwargs):\n    # type: (HTTPConnection, *Any, **Any) -> Any\n    span = getattr(self, \"_sentrysdk_span\", None)\n\n    if span is None:\n        return real_getresponse(self, *args, **kwargs)\n\n    try:\n        rv = real_getresponse(self, *args, **kwargs)\n\n        span.set_http_status(int(rv.status))\n        span.set_data(\"reason\", rv.reason)\n    finally:\n        span.finish()\n\n    return rv",
    "pattern_analysis": {
      "api_sequence": [
        "real_getresponse",
        "rv.status",
        "span.set_http_status",
        "rv.reason",
        "span.set_data",
        "span.finish"
      ],
      "api_sequence_with_args": [
        "real_getresponse(self, *args, **kwargs)",
        "rv.status",
        "span.set_http_status(int(rv.status))",
        "rv.reason",
        "span.set_data(\"reason\", rv.reason)",
        "span.finish()"
      ],
      "mapped_sequence": [
        {
          "api_name": "real_getresponse",
          "id": "get_response_body",
          "description": "Retrieves response body from HTTP response",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "rv.status",
          "id": "get_http_status",
          "description": "Retrieves HTTP response status code",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "span.set_http_status",
          "id": "get_http_status",
          "description": "Retrieves HTTP response status code",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "rv.reason",
          "id": "get_response_body",
          "description": "Retrieves response body from HTTP response",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "span.set_data",
          "id": "get_response_body",
          "description": "Retrieves response body from HTTP response",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "span.finish",
          "id": "close_http_response",
          "description": "Closes the HTTP response object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        }
      ],
      "contextual_code": "def getresponse(self, *args, **kwargs):\n    span = getattr(self, \"_sentrysdk_span\", None)\n\n    if span is None:\n        return real_getresponse(self, *args, **kwargs)\n\n    try:\n        rv = real_getresponse(self, *args, **kwargs)\n        span.set_http_status(int(rv.status))\n        span.set_data(\"reason\", rv.reason)\n    finally:\n        span.finish()\n\n    return rv"
    }
  }
]