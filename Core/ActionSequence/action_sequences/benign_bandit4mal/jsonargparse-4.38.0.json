[
  {
    "metadata": {
      "package_name": "jsonargparse-4.38.0",
      "total_matches": 2,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "test_util.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/jsonargparse-4.38.0/jsonargparse-4.38.0/jsonargparse_tests/test_util.py",
    "line_number": "312",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "311\t    ziph = zipfile.ZipFile(zip_path, \"w\", zipfile.ZIP_DEFLATED)\n312\t    ziph.write(file_path)\n313\t    ziph.close()",
    "code_snippet": "def create_zip(zip_path, file_path):\n    ziph = zipfile.ZipFile(zip_path, \"w\", zipfile.ZIP_DEFLATED)\n    ziph.write(file_path)\n    ziph.close()",
    "pattern_analysis": {
      "api_sequence": [
        "zipfile.ZipFile",
        "zipfile.ZipFile.write",
        "zipfile.ZipFile.close"
      ],
      "api_sequence_with_args": [
        "zipfile.ZipFile(zip_path, \"w\", zipfile.ZIP_DEFLATED)",
        "zipfile.ZipFile.write(file_path)",
        "zipfile.ZipFile.close()"
      ],
      "mapped_sequence": [
        {
          "api_name": "zipfile.ZipFile",
          "id": "open_zip_write",
          "description": "Opens ZIP archive for writing",
          "first_id": "file_operations",
          "second_id": "compression_archiving",
          "third_id": "zip_operations"
        },
        {
          "api_name": "zipfile.ZipFile.write",
          "id": "add_file_zip",
          "description": "Adds file to ZIP archive with specified archive name",
          "first_id": "file_operations",
          "second_id": "compression_archiving",
          "third_id": "zip_operations"
        },
        {
          "api_name": "zipfile.ZipFile.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        }
      ],
      "contextual_code": "def create_zip(zip_path, file_path):\n    ziph = zipfile.ZipFile(zip_path, \"w\", zipfile.ZIP_DEFLATED)\n    ziph.write(file_path)\n    ziph.close()"
    }
  },
  {
    "pyfile": "test_util.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/jsonargparse-4.38.0/jsonargparse-4.38.0/jsonargparse_tests/test_util.py",
    "line_number": "92",
    "type_description": "B810:chmod",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "91\t        dir_rwx.chmod(stat.S_IREAD | stat.S_IWRITE | stat.S_IEXEC)\n92\t        dir_rx.chmod(stat.S_IREAD | stat.S_IEXEC)\n93\t        dir_x.chmod(stat.S_IEXEC)",
    "code_snippet": "@pytest.fixture(scope=\"module\")\ndef paths(tmp_path_factory):\n    cwd = os.getcwd()\n    tmp_path = tmp_path_factory.mktemp(\"paths_fixture\")\n    os.chdir(tmp_path)\n\n    try:\n        paths = Namespace()\n        paths.tmp_path = tmp_path\n        paths.file_rw = file_rw = pathlib.Path(\"file_rw\")\n        paths.file_r = file_r = pathlib.Path(\"file_r\")\n        paths.file_ = file_ = pathlib.Path(\"file_\")\n        paths.dir_rwx = dir_rwx = pathlib.Path(\"dir_rwx\")\n        paths.dir_rx = dir_rx = pathlib.Path(\"dir_rx\")\n        paths.dir_x = dir_x = pathlib.Path(\"dir_x\")\n        paths.dir_file_rx = dir_file_rx = dir_x / \"file_rx\"\n\n        file_r.write_text(\"file contents\")\n        file_rw.touch()\n        file_.touch()\n        dir_rwx.mkdir()\n        dir_rx.mkdir()\n        dir_x.mkdir()\n        dir_file_rx.touch()\n\n        file_rw.chmod(stat.S_IREAD | stat.S_IWRITE)\n        file_r.chmod(stat.S_IREAD)\n        file_.chmod(0)\n        dir_file_rx.chmod(stat.S_IREAD | stat.S_IEXEC)\n        dir_rwx.chmod(stat.S_IREAD | stat.S_IWRITE | stat.S_IEXEC)\n        dir_rx.chmod(stat.S_IREAD | stat.S_IEXEC)\n        dir_x.chmod(stat.S_IEXEC)\n\n        yield paths\n    finally:\n        dir_x.chmod(stat.S_IREAD | stat.S_IWRITE | stat.S_IEXEC)\n        os.chdir(cwd)\n",
    "pattern_analysis": {
      "api_sequence": [
        "os.getcwd",
        "tmp_path_factory.mktemp",
        "os.chdir",
        "pathlib.Path",
        "pathlib.Path",
        "pathlib.Path",
        "pathlib.Path",
        "pathlib.Path",
        "pathlib.Path",
        "pathlib.Path",
        "pathlib.Path.write_text",
        "pathlib.Path.touch",
        "pathlib.Path.touch",
        "pathlib.Path.mkdir",
        "pathlib.Path.mkdir",
        "pathlib.Path.mkdir",
        "pathlib.Path.touch",
        "pathlib.Path.chmod",
        "pathlib.Path.chmod",
        "pathlib.Path.chmod",
        "pathlib.Path.chmod",
        "pathlib.Path.chmod",
        "pathlib.Path.chmod",
        "pathlib.Path.chmod",
        "pathlib.Path.chmod",
        "os.chdir"
      ],
      "api_sequence_with_args": [
        "os.getcwd()",
        "tmp_path_factory.mktemp(\"paths_fixture\")",
        "os.chdir(tmp_path)",
        "pathlib.Path(\"file_rw\")",
        "pathlib.Path(\"file_r\")",
        "pathlib.Path(\"file_\")",
        "pathlib.Path(\"dir_rwx\")",
        "pathlib.Path(\"dir_rx\")",
        "pathlib.Path(\"dir_x\")",
        "pathlib.Path(\"dir_x\") / \"file_rx\"",
        "file_r.write_text(\"file contents\")",
        "file_rw.touch()",
        "file_.touch()",
        "dir_rwx.mkdir()",
        "dir_rx.mkdir()",
        "dir_x.mkdir()",
        "dir_file_rx.touch()",
        "file_rw.chmod(stat.S_IREAD | stat.S_IWRITE)",
        "file_r.chmod(stat.S_IREAD)",
        "file_.chmod(0)",
        "dir_file_rx.chmod(stat.S_IREAD | stat.S_IEXEC)",
        "dir_rwx.chmod(stat.S_IREAD | stat.S_IWRITE | stat.S_IEXEC)",
        "dir_rx.chmod(stat.S_IREAD | stat.S_IEXEC)",
        "dir_x.chmod(stat.S_IEXEC)",
        "dir_x.chmod(stat.S_IREAD | stat.S_IWRITE | stat.S_IEXEC)",
        "os.chdir(cwd)"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.getcwd",
          "id": "get_working_dir",
          "description": "Returns current working directory",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "tmp_path_factory.mktemp",
          "id": "create_temp_dir",
          "description": "Creates temporary directory and returns its path",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "os.chdir",
          "id": "change_working_dir",
          "description": "Changes current working directory",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "pathlib.Path",
          "id": "path_object_operations",
          "description": "Path object and status operations (creating Path objects, retrieving file status)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "pathlib.Path",
          "id": "path_object_operations",
          "description": "Path object and status operations (creating Path objects, retrieving file status)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "pathlib.Path",
          "id": "path_object_operations",
          "description": "Path object and status operations (creating Path objects, retrieving file status)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "pathlib.Path",
          "id": "path_object_operations",
          "description": "Path object and status operations (creating Path objects, retrieving file status)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "pathlib.Path",
          "id": "path_object_operations",
          "description": "Path object and status operations (creating Path objects, retrieving file status)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "pathlib.Path",
          "id": "path_object_operations",
          "description": "Path object and status operations (creating Path objects, retrieving file status)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "pathlib.Path",
          "id": "path_object_operations",
          "description": "Path object and status operations (creating Path objects, retrieving file status)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "pathlib.Path.write_text",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "pathlib.Path.touch",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "pathlib.Path.touch",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "pathlib.Path.mkdir",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "pathlib.Path.mkdir",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "pathlib.Path.mkdir",
          "id": "create_directory",
          "description": "Creates directory, ignoring if it already exists",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "pathlib.Path.touch",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "pathlib.Path.chmod",
          "id": "set_file_attributes",
          "description": "Sets file attributes for specified file",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_attribute_management"
        },
        {
          "api_name": "pathlib.Path.chmod",
          "id": "set_file_attributes",
          "description": "Sets file attributes for specified file",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_attribute_management"
        },
        {
          "api_name": "pathlib.Path.chmod",
          "id": "set_file_attributes",
          "description": "Sets file attributes for specified file",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_attribute_management"
        },
        {
          "api_name": "pathlib.Path.chmod",
          "id": "set_file_attributes",
          "description": "Sets file attributes for specified file",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_attribute_management"
        },
        {
          "api_name": "pathlib.Path.chmod",
          "id": "set_file_attributes",
          "description": "Sets file attributes for specified file",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_attribute_management"
        },
        {
          "api_name": "pathlib.Path.chmod",
          "id": "set_file_attributes",
          "description": "Sets file attributes for specified file",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_attribute_management"
        },
        {
          "api_name": "pathlib.Path.chmod",
          "id": "set_file_attributes",
          "description": "Sets file attributes for specified file",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_attribute_management"
        },
        {
          "api_name": "pathlib.Path.chmod",
          "id": "set_file_attributes",
          "description": "Sets file attributes for specified file",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_attribute_management"
        },
        {
          "api_name": "os.chdir",
          "id": "change_working_dir",
          "description": "Changes current working directory",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        }
      ],
      "contextual_code": "cwd = os.getcwd()\ntmp_path = tmp_path_factory.mktemp(\"paths_fixture\")\nos.chdir(tmp_path)\n\npaths = Namespace()\npaths.tmp_path = tmp_path\npaths.file_rw = file_rw = pathlib.Path(\"file_rw\")\npaths.file_r = file_r = pathlib.Path(\"file_r\")\npaths.file_ = file_ = pathlib.Path(\"file_\")\npaths.dir_rwx = dir_rwx = pathlib.Path(\"dir_rwx\")\npaths.dir_rx = dir_rx = pathlib.Path(\"dir_rx\")\npaths.dir_x = dir_x = pathlib.Path(\"dir_x\")\npaths.dir_file_rx = dir_file_rx = dir_x / \"file_rx\"\n\nfile_r.write_text(\"file contents\")\nfile_rw.touch()\nfile_.touch()\ndir_rwx.mkdir()\ndir_rx.mkdir()\ndir_x.mkdir()\ndir_file_rx.touch()\n\nfile_rw.chmod(stat.S_IREAD | stat.S_IWRITE)\nfile_r.chmod(stat.S_IREAD)\nfile_.chmod(0)\ndir_file_rx.chmod(stat.S_IREAD | stat.S_IEXEC)\ndir_rwx.chmod(stat.S_IREAD | stat.S_IWRITE | stat.S_IEXEC)\ndir_rx.chmod(stat.S_IREAD | stat.S_IEXEC)\ndir_x.chmod(stat.S_IEXEC)\n\ndir_x.chmod(stat.S_IREAD | stat.S_IWRITE | stat.S_IEXEC)\nos.chdir(cwd)"
    }
  }
]