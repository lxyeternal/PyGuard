[
  {
    "metadata": {
      "package_name": "safety-3.4.0b6",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "util.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/safety-3.4.0b6/safety-3.4.0b6/safety/util.py",
    "line_number": "264",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "263\t                used_options[option_used][cleaned_arg] = (\n264\t                    used_options[option_used].get(cleaned_arg, 0) + 1\n265\t                )",
    "code_snippet": "def get_used_options() -> Dict[str, Dict[str, int]]:\n    \"\"\"\n    Get the used options from the command-line arguments.\n\n    Returns:\n        Dict[str, Dict[str, int]]: A dictionary of used options and their counts.\n    \"\"\"\n    flags = get_flags_from_context()\n    used_options = {}\n\n    for arg in sys.argv:\n        cleaned_arg = arg if \"=\" not in arg else arg.split(\"=\")[0]\n        if cleaned_arg in flags:\n            option_used = flags.get(cleaned_arg)\n\n            if option_used in used_options:\n                used_options[option_used][cleaned_arg] = (\n                    used_options[option_used].get(cleaned_arg, 0) + 1\n                )\n            else:\n                used_options[option_used] = {cleaned_arg: 1}\n\n    return used_options",
    "pattern_analysis": {
      "api_sequence": [
        "sys.argv",
        "get_flags_from_context"
      ],
      "api_sequence_with_args": [
        "sys.argv",
        "get_flags_from_context()"
      ],
      "mapped_sequence": [
        {
          "api_name": "sys.argv",
          "id": "get_cmd_args",
          "description": "Retrieves command-line arguments passed to script",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "get_flags_from_context",
          "id": "import_dynamic",
          "description": "Dynamically imports specified module",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "module_importing"
        }
      ],
      "contextual_code": "def get_used_options() -> Dict[str, Dict[str, int]]:\n    flags = get_flags_from_context()\n    used_options = {}\n\n    for arg in sys.argv:\n        cleaned_arg = arg if \"=\" not in arg else arg.split(\"=\")[0]\n        if cleaned_arg in flags:\n            option_used = flags.get(cleaned_arg)\n\n            if option_used in used_options:\n                used_options[option_used][cleaned_arg] = (\n                    used_options[option_used].get(cleaned_arg, 0) + 1\n                )\n            else:\n                used_options[option_used] = {cleaned_arg: 1}\n\n    return used_options"
    }
  }
]