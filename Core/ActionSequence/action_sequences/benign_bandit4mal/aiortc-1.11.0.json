[
  {
    "metadata": {
      "package_name": "aiortc-1.11.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "webcam.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/aiortc-1.11.0/aiortc-1.11.0/examples/webcam/webcam.py",
    "line_number": "29",
    "type_description": "B817:system",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "28\t        if relay is None:\n29\t            if platform.system() == \"Darwin\":\n30\t                webcam = MediaPlayer(",
    "code_snippet": "import platform\nfrom aiortc.contrib.media import MediaPlayer, MediaRelay\n\nrelay = None\nwebcam = None\n\ndef create_local_tracks(play_from, decode):\n    global relay, webcam\n\n    if play_from:\n        player = MediaPlayer(play_from, decode=decode)\n        return player.audio, player.video\n    else:\n        options = {\"framerate\": \"30\", \"video_size\": \"640x480\"}\n        if relay is None:\n            if platform.system() == \"Darwin\":\n                webcam = MediaPlayer(\n                    \"default:none\", format=\"avfoundation\", options=options\n                )\n            elif platform.system() == \"Windows\":\n                webcam = MediaPlayer(\n                    \"video=Integrated Camera\", format=\"dshow\", options=options\n                )\n            else:\n                webcam = MediaPlayer(\"/dev/video0\", format=\"v4l2\", options=options)\n            relay = MediaRelay()\n        return None, relay.subscribe(webcam.video)",
    "pattern_analysis": {
      "api_sequence": [
        "platform.system",
        "aiortc.contrib.media.MediaPlayer",
        "aiortc.contrib.media.MediaPlayer",
        "aiortc.contrib.media.MediaPlayer",
        "aiortc.contrib.media.MediaRelay",
        "aiortc.contrib.media.MediaRelay.subscribe"
      ],
      "api_sequence_with_args": [
        "platform.system()",
        "aiortc.contrib.media.MediaPlayer(play_from, decode=decode)",
        "aiortc.contrib.media.MediaPlayer(\"default:none\", format=\"avfoundation\", options=options)",
        "aiortc.contrib.media.MediaPlayer(\"video=Integrated Camera\", format=\"dshow\", options=options)",
        "aiortc.contrib.media.MediaPlayer(\"/dev/video0\", format=\"v4l2\", options=options)",
        "aiortc.contrib.media.MediaRelay()",
        "aiortc.contrib.media.MediaRelay.subscribe(webcam.video)"
      ],
      "mapped_sequence": [
        {
          "api_name": "platform.system",
          "id": "get_platform_info",
          "description": "Retrieves platform information as string",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "aiortc.contrib.media.MediaPlayer",
          "id": "create_video_capture",
          "description": "Creates video capture object for default camera",
          "first_id": "information_gathering",
          "second_id": "multimedia_capture",
          "third_id": "camera_operations"
        },
        {
          "api_name": "aiortc.contrib.media.MediaPlayer",
          "id": "create_video_capture",
          "description": "Creates video capture object for default camera",
          "first_id": "information_gathering",
          "second_id": "multimedia_capture",
          "third_id": "camera_operations"
        },
        {
          "api_name": "aiortc.contrib.media.MediaPlayer",
          "id": "create_video_capture",
          "description": "Creates video capture object for default camera",
          "first_id": "information_gathering",
          "second_id": "multimedia_capture",
          "third_id": "camera_operations"
        },
        {
          "api_name": "aiortc.contrib.media.MediaRelay",
          "id": "create_async_task",
          "description": "Creates asynchronous task for coroutine",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_creation"
        },
        {
          "api_name": "aiortc.contrib.media.MediaRelay.subscribe",
          "id": "create_async_task",
          "description": "Creates asynchronous task for coroutine",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_creation"
        }
      ],
      "contextual_code": "import platform\nfrom aiortc.contrib.media import MediaPlayer, MediaRelay\n\nrelay = None\nwebcam = None\n\ndef create_local_tracks(play_from, decode):\n    global relay, webcam\n\n    if play_from:\n        player = MediaPlayer(play_from, decode=decode)\n        return player.audio, player.video\n    else:\n        options = {\"framerate\": \"30\", \"video_size\": \"640x480\"}\n        if relay is None:\n            if platform.system() == \"Darwin\":\n                webcam = MediaPlayer(\n                    \"default:none\", format=\"avfoundation\", options=options\n                )\n            elif platform.system() == \"Windows\":\n                webcam = MediaPlayer(\n                    \"video=Integrated Camera\", format=\"dshow\", options=options\n                )\n            else:\n                webcam = MediaPlayer(\"/dev/video0\", format=\"v4l2\", options=options)\n            relay = MediaRelay()\n        return None, relay.subscribe(webcam.video)"
    }
  }
]