[
  {
    "metadata": {
      "package_name": "distributed-2025.3.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "plugin.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/distributed-2025.3.0/distributed-2025.3.0/distributed/diagnostics/plugin.py",
    "line_number": "534",
    "type_description": "B803:gethostname",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "533\t            max_leases=1,\n534\t            name=socket.gethostname(),\n535\t            scheduler_rpc=nanny.scheduler,",
    "code_snippet": "class _InstallNannyPlugin(NannyPlugin):\n    \"\"\"Nanny plugin to install software on the nanny and then restart the workers\n\n    This accepts an installer which will installs software on all nannies.\n\n    .. note::\n\n       This will increase the time it takes to start up\n       the cluster. If possible, we recommend including the\n       software in the cluster environment or image. This is\n       primarily intended for experimentation and debugging.\n\n    Parameters\n    ----------\n    install_fn\n        Function that installs software\n    name:\n        Name of the plugin\n\n    See Also\n    --------\n    InstallPlugin\n    \"\"\"\n\n    _install_fn: Callable[[], None]\n    name: str\n    restart = True\n\n    def __init__(self, _install_fn: Callable[[], None], name: str):\n        self._install_fn = _install_fn\n        self.name = name\n\n    async def setup(self, nanny):\n        from distributed.semaphore import Semaphore\n\n        async with await Semaphore(\n            max_leases=1,\n            name=socket.gethostname(),\n            scheduler_rpc=nanny.scheduler,\n            loop=nanny.loop,\n        ):\n            self._install_fn()",
    "pattern_analysis": {
      "api_sequence": [
        "socket.gethostname",
        "distributed.semaphore.Semaphore"
      ],
      "api_sequence_with_args": [
        "socket.gethostname()",
        "distributed.semaphore.Semaphore(max_leases=1, name=socket.gethostname(), scheduler_rpc=nanny.scheduler, loop=nanny.loop)"
      ],
      "mapped_sequence": [
        {
          "api_name": "socket.gethostname",
          "id": "get_hostname",
          "description": "Retrieves current host name",
          "first_id": "basic_network_operations",
          "second_id": "network_information_gathering",
          "third_id": "address_information"
        },
        {
          "api_name": "distributed.semaphore.Semaphore",
          "id": "create_thread",
          "description": "Creates new thread to execute target function",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_creation"
        }
      ],
      "contextual_code": "async def setup(self, nanny):\n    from distributed.semaphore import Semaphore\n\n    async with await Semaphore(\n        max_leases=1,\n        name=socket.gethostname(),\n        scheduler_rpc=nanny.scheduler,\n        loop=nanny.loop,\n    ):\n        self._install_fn()"
    }
  }
]