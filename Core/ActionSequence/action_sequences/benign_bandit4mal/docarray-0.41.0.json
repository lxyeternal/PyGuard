[
  {
    "metadata": {
      "package_name": "docarray-0.41.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "compress.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/docarray-0.41.0/docarray-0.41.0/docarray/utils/_internal/compress.py",
    "line_number": "46",
    "type_description": "B816:decompress",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "45\n46\t        data = bz2.decompress(data)\n47\t    elif algorithm == 'lzma':",
    "code_snippet": "def _decompress_bytes(data: bytes, algorithm: Optional[str] = None) -> bytes:\n    if algorithm == 'lz4':\n        if TYPE_CHECKING:\n            from lz4 import frame\n        else:\n            lz4 = import_library('lz4', raise_error=True)  # noqa: F841\n            from lz4 import frame\n\n        data = frame.decompress(data)\n    elif algorithm == 'bz2':\n        import bz2\n\n        data = bz2.decompress(data)\n    elif algorithm == 'lzma':\n        import lzma\n\n        data = lzma.decompress(data)\n    elif algorithm == 'zlib':\n        import zlib\n\n        data = zlib.decompress(data)\n    elif algorithm == 'gzip':\n        import gzip\n\n        data = gzip.decompress(data)\n    return data",
    "pattern_analysis": {
      "api_sequence": [
        "import_library",
        "lz4.frame.decompress",
        "bz2.decompress",
        "lzma.decompress",
        "zlib.decompress",
        "gzip.decompress"
      ],
      "api_sequence_with_args": [
        "import_library('lz4', raise_error=True)",
        "lz4.frame.decompress(data)",
        "bz2.decompress(data)",
        "lzma.decompress(data)",
        "zlib.decompress(data)",
        "gzip.decompress(data)"
      ],
      "mapped_sequence": [
        {
          "api_name": "import_library",
          "id": "import_dynamic",
          "description": "Dynamically imports specified module",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "module_importing"
        },
        {
          "api_name": "lz4.frame.decompress",
          "id": "decompress_data_zlib",
          "description": "Decompresses zlib-compressed data",
          "first_id": "file_operations",
          "second_id": "compression_archiving",
          "third_id": "compression_decompression"
        },
        {
          "api_name": "bz2.decompress",
          "id": "decompress_data_zlib",
          "description": "Decompresses zlib-compressed data",
          "first_id": "file_operations",
          "second_id": "compression_archiving",
          "third_id": "compression_decompression"
        },
        {
          "api_name": "lzma.decompress",
          "id": "decompress_data_zlib",
          "description": "Decompresses zlib-compressed data",
          "first_id": "file_operations",
          "second_id": "compression_archiving",
          "third_id": "compression_decompression"
        },
        {
          "api_name": "zlib.decompress",
          "id": "decompress_data_zlib",
          "description": "Decompresses zlib-compressed data",
          "first_id": "file_operations",
          "second_id": "compression_archiving",
          "third_id": "compression_decompression"
        },
        {
          "api_name": "gzip.decompress",
          "id": "decompress_data_zlib",
          "description": "Decompresses zlib-compressed data",
          "first_id": "file_operations",
          "second_id": "compression_archiving",
          "third_id": "compression_decompression"
        }
      ],
      "contextual_code": "def _decompress_bytes(data: bytes, algorithm: Optional[str] = None) -> bytes:\n    if algorithm == 'lz4':\n        if TYPE_CHECKING:\n            from lz4 import frame\n        else:\n            lz4 = import_library('lz4', raise_error=True)\n            from lz4 import frame\n        data = frame.decompress(data)\n    elif algorithm == 'bz2':\n        import bz2\n        data = bz2.decompress(data)\n    elif algorithm == 'lzma':\n        import lzma\n        data = lzma.decompress(data)\n    elif algorithm == 'zlib':\n        import zlib\n        data = zlib.decompress(data)\n    elif algorithm == 'gzip':\n        import gzip\n        data = gzip.decompress(data)\n    return data"
    }
  }
]