[
  {
    "metadata": {
      "package_name": "tifffile-2025.3.30",
      "total_matches": 2,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "test_tifffile.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/tifffile-2025.3.30/tifffile-2025.3.30/tests/test_tifffile.py",
    "line_number": "17906",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "17905\n17906\t        imwrite(\n17907\t            fname,\n17908\t            strips(),\n17909\t            shape=data.shape,\n17910\t            dtype=data.dtype,\n17911\t            rowsperstrip=rowsperstrip,\n17912\t            compression=compression,\n17913\t            planarconfig='separate',\n17914\t            photometric='rgb',\n17915\t        )",
    "code_snippet": "def test_issue_write_separated():\n    \"\"\"Test write SEPARATED colorspace.\"\"\"\n    # https://github.com/cgohlke/tifffile/issues/37\n    contig = random_data(numpy.uint8, (63, 95, 4))\n    separate = random_data(numpy.uint8, (4, 63, 95))\n    extrasample = random_data(numpy.uint8, (63, 95, 5))\n    with TempFileName('issue_write_separated') as fname:\n        with TiffWriter(fname) as tif:\n            tif.write(contig, photometric=PHOTOMETRIC.SEPARATED)\n            tif.write(separate, photometric=PHOTOMETRIC.SEPARATED)\n            tif.write(\n                extrasample,\n                photometric=PHOTOMETRIC.SEPARATED,\n                extrasamples=[1],\n            )\n        assert_valid_tiff(fname)\n        with TiffFile(fname) as tif:\n            assert len(tif.pages) == 3\n            assert len(tif.series) == 3\n            page = tif.pages.first\n            assert page.photometric == PHOTOMETRIC.SEPARATED\n            assert_array_equal(page.asarray(), contig)\n            page = tif.pages[1]\n            assert page.photometric == PHOTOMETRIC.SEPARATED\n            assert_array_equal(page.asarray(), separate)\n            page = tif.pages[2]\n            assert page.photometric == PHOTOMETRIC.SEPARATED\n            assert page.extrasamples == (1,)\n            assert_array_equal(page.asarray(), extrasample)",
    "pattern_analysis": {
      "api_sequence": [
        "TempFileName",
        "TiffWriter",
        "TiffWriter.write",
        "TiffWriter.write",
        "TiffWriter.write",
        "assert_valid_tiff",
        "TiffFile",
        "TiffFile.pages",
        "TiffFile.series",
        "TiffFile.pages.first",
        "TiffFile.pages.first.photometric",
        "TiffFile.pages.first.asarray",
        "TiffFile.pages.__getitem__",
        "TiffFile.pages.__getitem__.photometric",
        "TiffFile.pages.__getitem__.asarray",
        "TiffFile.pages.__getitem__",
        "TiffFile.pages.__getitem__.photometric",
        "TiffFile.pages.__getitem__.extrasamples",
        "TiffFile.pages.__getitem__.asarray"
      ],
      "api_sequence_with_args": [
        "TempFileName('issue_write_separated')",
        "TiffWriter(fname)",
        "TiffWriter.write(contig, photometric=PHOTOMETRIC.SEPARATED)",
        "TiffWriter.write(separate, photometric=PHOTOMETRIC.SEPARATED)",
        "TiffWriter.write(extrasample, photometric=PHOTOMETRIC.SEPARATED, extrasamples=[1])",
        "assert_valid_tiff(fname)",
        "TiffFile(fname)",
        "tif.pages",
        "tif.series",
        "tif.pages.first",
        "tif.pages.first.photometric",
        "tif.pages.first.asarray()",
        "tif.pages[1]",
        "tif.pages[1].photometric",
        "tif.pages[1].asarray()",
        "tif.pages[2]",
        "tif.pages[2].photometric",
        "tif.pages[2].extrasamples",
        "tif.pages[2].asarray()"
      ],
      "mapped_sequence": [
        {
          "api_name": "TempFileName",
          "id": "create_temp_file",
          "description": "Creates temporary file that is not deleted on close",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "TiffWriter",
          "id": "open_file_app",
          "description": "Opens file with associated application",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "TiffWriter.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "TiffWriter.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "TiffWriter.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "assert_valid_tiff",
          "id": "check_file_is_file",
          "description": "Checks if specified path exists and is a file",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "TiffFile",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "TiffFile.pages",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "TiffFile.series",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "TiffFile.pages.first",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "TiffFile.pages.first.photometric",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "TiffFile.pages.first.asarray",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "TiffFile.pages.__getitem__",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "TiffFile.pages.__getitem__.photometric",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "TiffFile.pages.__getitem__.asarray",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "TiffFile.pages.__getitem__",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "TiffFile.pages.__getitem__.photometric",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "TiffFile.pages.__getitem__.extrasamples",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "TiffFile.pages.__getitem__.asarray",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        }
      ],
      "contextual_code": "def test_issue_write_separated():\n    contig = random_data(numpy.uint8, (63, 95, 4))\n    separate = random_data(numpy.uint8, (4, 63, 95))\n    extrasample = random_data(numpy.uint8, (63, 95, 5))\n    with TempFileName('issue_write_separated') as fname:\n        with TiffWriter(fname) as tif:\n            tif.write(contig, photometric=PHOTOMETRIC.SEPARATED)\n            tif.write(separate, photometric=PHOTOMETRIC.SEPARATED)\n            tif.write(\n                extrasample,\n                photometric=PHOTOMETRIC.SEPARATED,\n                extrasamples=[1],\n            )\n        assert_valid_tiff(fname)\n        with TiffFile(fname) as tif:\n            assert len(tif.pages) == 3\n            assert len(tif.series) == 3\n            page = tif.pages.first\n            assert page.photometric == PHOTOMETRIC.SEPARATED\n            assert_array_equal(page.asarray(), contig)\n            page = tif.pages[1]\n            assert page.photometric == PHOTOMETRIC.SEPARATED\n            assert_array_equal(page.asarray(), separate)\n            page = tif.pages[2]\n            assert page.photometric == PHOTOMETRIC.SEPARATED\n            assert page.extrasamples == (1,)\n            assert_array_equal(page.asarray(), extrasample)"
    }
  },
  {
    "pyfile": "test_tifffile.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/tifffile-2025.3.30/tifffile-2025.3.30/tests/test_tifffile.py",
    "line_number": "1741",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1740\t        ijmeta['axes'] = 'ZYX'\n1741\t        imwrite(fname, data, imagej=True, colormap=colormap, metadata=ijmeta)\n1742",
    "code_snippet": "@pytest.mark.skipif(SKIP_PRIVATE, reason=REASON)\ndef test_issue_imagej_prop():\n    \"\"\"Test read and write ImageJ prop metadata type.\"\"\"\n    # https://github.com/cgohlke/tifffile/issues/103\n    # also test write indexed ImageJ file\n\n    fname = private_file('issues/triple-sphere-big-distance=035.tif')\n    with tifffile.TiffFile(fname) as tif:\n        assert tif.is_imagej\n        ijmeta = tif.imagej_metadata\n        assert ijmeta is not None\n        prop = ijmeta['Properties']\n        assert ijmeta['slices'] == 500\n        assert not ijmeta['loop']\n        assert prop['CurrentLUT'] == 'glasbey_on_dark'\n        assert tif.pages.first.photometric == PHOTOMETRIC.PALETTE\n        colormap = tif.pages.first.colormap\n        data = tif.asarray()\n\n    prop['Test'] = 0.1\n    with TempFileName('issue_imagej_prop') as fname:\n        ijmeta['axes'] = 'ZYX'\n        imwrite(fname, data, imagej=True, colormap=colormap, metadata=ijmeta)\n\n    with tifffile.TiffFile(fname) as tif:\n        assert tif.is_imagej\n        ijmeta = tif.imagej_metadata\n        assert ijmeta is not None\n        prop = ijmeta['Properties']\n        assert ijmeta['slices'] == 500\n        assert not ijmeta['loop']\n        assert prop['CurrentLUT'] == 'glasbey_on_dark'\n        assert prop['Test'] == '0.1'\n        assert tif.pages.first.photometric == PHOTOMETRIC.PALETTE\n        colormap = tif.pages.first.colormap\n        image = tif.asarray()\n        assert_array_equal(image, data)\n",
    "pattern_analysis": {
      "api_sequence": [
        "private_file",
        "tifffile.TiffFile",
        "tifffile.TiffFile.is_imagej",
        "tifffile.TiffFile.imagej_metadata",
        "tifffile.TiffFile.pages.first.photometric",
        "tifffile.TiffFile.pages.first.colormap",
        "tifffile.TiffFile.asarray",
        "TempFileName",
        "imwrite",
        "tifffile.TiffFile",
        "tifffile.TiffFile.is_imagej",
        "tifffile.TiffFile.imagej_metadata",
        "tifffile.TiffFile.pages.first.photometric",
        "tifffile.TiffFile.pages.first.colormap",
        "tifffile.TiffFile.asarray",
        "assert_array_equal"
      ],
      "api_sequence_with_args": [
        "private_file('issues/triple-sphere-big-distance=035.tif')",
        "tifffile.TiffFile(fname)",
        "tifffile.TiffFile(fname).is_imagej",
        "tifffile.TiffFile(fname).imagej_metadata",
        "tifffile.TiffFile(fname).pages.first.photometric",
        "tifffile.TiffFile(fname).pages.first.colormap",
        "tifffile.TiffFile(fname).asarray()",
        "TempFileName('issue_imagej_prop')",
        "imwrite(fname, data, imagej=True, colormap=colormap, metadata=ijmeta)",
        "tifffile.TiffFile(fname)",
        "tifffile.TiffFile(fname).is_imagej",
        "tifffile.TiffFile(fname).imagej_metadata",
        "tifffile.TiffFile(fname).pages.first.photometric",
        "tifffile.TiffFile(fname).pages.first.colormap",
        "tifffile.TiffFile(fname).asarray()",
        "assert_array_equal(image, data)"
      ],
      "mapped_sequence": [
        {
          "api_name": "private_file",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "tifffile.TiffFile",
          "id": "open_file_app",
          "description": "Opens file with associated application",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "tifffile.TiffFile.is_imagej",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "tifffile.TiffFile.imagej_metadata",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "tifffile.TiffFile.pages.first.photometric",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "tifffile.TiffFile.pages.first.colormap",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "tifffile.TiffFile.asarray",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "TempFileName",
          "id": "create_temp_file",
          "description": "Creates temporary file that is not deleted on close",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "imwrite",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "tifffile.TiffFile",
          "id": "open_file_app",
          "description": "Opens file with associated application",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "tifffile.TiffFile.is_imagej",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "tifffile.TiffFile.imagej_metadata",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "tifffile.TiffFile.pages.first.photometric",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "tifffile.TiffFile.pages.first.colormap",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "tifffile.TiffFile.asarray",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "assert_array_equal",
          "id": "check_instance_type",
          "description": "Checks if object is instance of specified type",
          "first_id": "utility_functions",
          "second_id": "logging_exception_handling",
          "third_id": "exception_checking"
        }
      ],
      "contextual_code": "@pytest.mark.skipif(SKIP_PRIVATE, reason=REASON)\ndef test_issue_imagej_prop():\n    fname = private_file('issues/triple-sphere-big-distance=035.tif')\n    with tifffile.TiffFile(fname) as tif:\n        ijmeta = tif.imagej_metadata\n        prop = ijmeta['Properties']\n        colormap = tif.pages.first.colormap\n        data = tif.asarray()\n\n    prop['Test'] = 0.1\n    with TempFileName('issue_imagej_prop') as fname:\n        ijmeta['axes'] = 'ZYX'\n        imwrite(fname, data, imagej=True, colormap=colormap, metadata=ijmeta)\n\n    with tifffile.TiffFile(fname) as tif:\n        ijmeta = tif.imagej_metadata\n        prop = ijmeta['Properties']\n        colormap = tif.pages.first.colormap\n        image = tif.asarray()\n        assert_array_equal(image, data)"
    }
  }
]