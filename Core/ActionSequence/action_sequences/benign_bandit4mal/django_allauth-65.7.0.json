[
  {
    "metadata": {
      "package_name": "django_allauth-65.7.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "__init__.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/django_allauth-65.7.0/django_allauth-65.7.0/allauth/socialaccount/tests/__init__.py",
    "line_number": "228",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "227\t    def test_login_with_pkce_disabled(self):\n228\t        provider_settings = app_settings.PROVIDERS.get(self.app.provider, {})\n229\t        provider_settings_with_pkce_disabled = provider_settings.copy()",
    "code_snippet": "@override_settings(SOCIALACCOUNT_AUTO_SIGNUP=False)\ndef test_login_with_pkce_disabled(self):\n    provider_settings = app_settings.PROVIDERS.get(self.app.provider, {})\n    provider_settings_with_pkce_disabled = provider_settings.copy()\n    provider_settings_with_pkce_disabled[\"OAUTH_PKCE_ENABLED\"] = False\n\n    with self.settings(\n        SOCIALACCOUNT_PROVIDERS={\n            self.app.provider: provider_settings_with_pkce_disabled\n        }\n    ):\n        resp_mock = self.get_mocked_response()\n        if not resp_mock:\n            warnings.warn(\n                \"Cannot test provider %s, no oauth mock\" % self.provider.id\n            )\n            return\n        resp = self.login(\n            resp_mock,\n        )\n        self.assertRedirects(resp, reverse(\"socialaccount_signup\"))",
    "pattern_analysis": {
      "api_sequence": [
        "warnings.warn",
        "self.login",
        "self.assertRedirects",
        "reverse"
      ],
      "api_sequence_with_args": [
        "warnings.warn(\"Cannot test provider %s, no oauth mock\" % self.provider.id)",
        "self.login(resp_mock)",
        "self.assertRedirects(resp, reverse(\"socialaccount_signup\"))",
        "reverse(\"socialaccount_signup\")"
      ],
      "mapped_sequence": [
        {
          "api_name": "warnings.warn",
          "id": "log_error",
          "description": "Logs error message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "self.login",
          "id": "check_discord_token",
          "description": "Checks validity of Discord token",
          "first_id": "third_party_platform_abuse",
          "second_id": "discord_abuse",
          "third_id": "discord_control"
        },
        {
          "api_name": "self.assertRedirects",
          "id": "log_info",
          "description": "Logs informational message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "reverse",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        }
      ],
      "contextual_code": "def test_login_with_pkce_disabled(self):\n    ...\n    with self.settings(\n        SOCIALACCOUNT_PROVIDERS={\n            self.app.provider: provider_settings_with_pkce_disabled\n        }\n    ):\n        resp_mock = self.get_mocked_response()\n        if not resp_mock:\n            warnings.warn(\n                \"Cannot test provider %s, no oauth mock\" % self.provider.id\n            )\n            return\n        resp = self.login(\n            resp_mock,\n        )\n        self.assertRedirects(resp, reverse(\"socialaccount_signup\"))"
    }
  }
]