[
  {
    "metadata": {
      "package_name": "airbyte_cdk-6.45.0.post24.dev14387467928",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "simple_retriever.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/airbyte_cdk-6.45.0.post24.dev14387467928/airbyte_cdk-6.45.0.post24.dev14387467928/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py",
    "line_number": "766",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "765\t                last_page_token_value = (\n766\t                    next_page_token.get(\"next_page_token\") if next_page_token else None\n767\t                )",
    "code_snippet": "def _read_pages(\n    self,\n    records_generator_fn: Callable[[Optional[requests.Response]], Iterable[Record]],\n    stream_state: Mapping[str, Any],\n    stream_slice: StreamSlice,\n) -> Iterable[Record]:\n    pagination_complete = False\n    initial_token = self._paginator.get_initial_token()\n    next_page_token: Optional[Mapping[str, Any]] = (\n        {\"next_page_token\": initial_token} if initial_token else None\n    )\n    while not pagination_complete:\n        response = self._fetch_next_page(stream_state, stream_slice, next_page_token)\n\n        last_page_size = 0\n        last_record: Optional[Record] = None\n        for record in records_generator_fn(response):\n            last_page_size += 1\n            last_record = record\n            yield record\n\n        if not response:\n            pagination_complete = True\n        else:\n            last_page_token_value = (\n                next_page_token.get(\"next_page_token\") if next_page_token else None\n            )\n            next_page_token = self._next_page_token(\n                response=response,\n                last_page_size=last_page_size,\n                last_record=last_record,\n                last_page_token_value=last_page_token_value,\n            )\n            if not next_page_token:\n                pagination_complete = True\n\n    # Always return an empty generator just in case no records were ever yielded\n    yield from []",
    "pattern_analysis": {
      "api_sequence": [],
      "api_sequence_with_args": [],
      "mapped_sequence": [],
      "contextual_code": "def _read_pages(\n    self,\n    records_generator_fn: Callable[[Optional[requests.Response]], Iterable[Record]],\n    stream_state: Mapping[str, Any],\n    stream_slice: StreamSlice,\n) -> Iterable[Record]:\n    pagination_complete = False\n    initial_token = self._paginator.get_initial_token()\n    next_page_token: Optional[Mapping[str, Any]] = (\n        {\"next_page_token\": initial_token} if initial_token else None\n    )\n    while not pagination_complete:\n        response = self._fetch_next_page(stream_state, stream_slice, next_page_token)\n\n        last_page_size = 0\n        last_record: Optional[Record] = None\n        for record in records_generator_fn(response):\n            last_page_size += 1\n            last_record = record\n            yield record\n\n        if not response:\n            pagination_complete = True\n        else:\n            last_page_token_value = (\n                next_page_token.get(\"next_page_token\") if next_page_token else None\n            )\n            next_page_token = self._next_page_token(\n                response=response,\n                last_page_size=last_page_size,\n                last_record=last_record,\n                last_page_token_value=last_page_token_value,\n            )\n            if not next_page_token:\n                pagination_complete = True\n\n    # Always return an empty generator just in case no records were ever yielded\n    yield from []"
    }
  }
]