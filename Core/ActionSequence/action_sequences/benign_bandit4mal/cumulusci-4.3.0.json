[
  {
    "metadata": {
      "package_name": "cumulusci-4.3.0",
      "total_matches": 2,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "test_apex_tasks.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/cumulusci-4.3.0/cumulusci-4.3.0/cumulusci/tasks/apex/tests/test_apex_tasks.py",
    "line_number": "937",
    "type_description": "B832:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "936\t        with open(apex_path, \"w\") as f:\n937\t            f.write('System.debug(\"from file\")')\n938\t        self.task_config = TaskConfig()",
    "code_snippet": "@patch(\n    \"cumulusci.core.tasks.BaseSalesforceTask._update_credentials\",\n    MagicMock(return_value=None),\n)\nclass TestAnonymousApexTask:\n    def setup_method(self):\n        self.api_version = 42.0\n        self.universal_config = UniversalConfig(\n            {\"project\": {\"api_version\": self.api_version}}\n        )\n        self.tmpdir = tempfile.mkdtemp(dir=\".\")\n        apex_path = os.path.join(self.tmpdir, \"test.apex\")\n        with open(apex_path, \"w\") as f:\n            f.write('System.debug(\"from file\")')\n        self.task_config = TaskConfig()\n        self.task_config.config[\"options\"] = {\n            \"path\": apex_path,\n            \"apex\": 'system.debug(\"Hello World!\")',\n            \"param1\": \"StringValue\",\n        }\n        self.project_config = BaseProjectConfig(\n            self.universal_config, config={\"noyaml\": True}\n        )\n        self.project_config.config = {\n            \"project\": {\n                \"package\": {\"namespace\": \"abc\", \"api_version\": self.api_version}\n            }\n        }\n        keychain = BaseProjectKeychain(self.project_config, \"\")\n        self.project_config.set_keychain(keychain)\n        self.org_config = OrgConfig(\n            {\n                \"id\": \"foo/1\",\n                \"instance_url\": \"https://example.com\",\n                \"access_token\": \"abc123\",\n                \"namespace\": \"abc\",\n            },\n            \"test\",\n        )\n        self.org_config._installed_packages = {}\n        self.base_tooling_url = \"{}/services/data/v{}/tooling/\".format(\n            self.org_config.instance_url, self.api_version\n        )",
    "pattern_analysis": {
      "api_sequence": [
        "tempfile.mkdtemp",
        "os.path.join",
        "open",
        "builtins.open.write"
      ],
      "api_sequence_with_args": [
        "tempfile.mkdtemp(dir=\".\")",
        "os.path.join(self.tmpdir, \"test.apex\")",
        "open(apex_path, \"w\")",
        "builtins.open.write('System.debug(\"from file\")')"
      ],
      "mapped_sequence": [
        {
          "api_name": "tempfile.mkdtemp",
          "id": "create_temp_dir",
          "description": "Creates temporary directory and returns its path",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "os.path.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "builtins.open.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        }
      ],
      "contextual_code": "import tempfile\nimport os\n\nclass TestAnonymousApexTask:\n    def setup_method(self):\n        self.api_version = 42.0\n        self.universal_config = UniversalConfig(\n            {\"project\": {\"api_version\": self.api_version}}\n        )\n        self.tmpdir = tempfile.mkdtemp(dir=\".\")\n        apex_path = os.path.join(self.tmpdir, \"test.apex\")\n        with open(apex_path, \"w\") as f:\n            f.write('System.debug(\"from file\")')"
    }
  },
  {
    "pyfile": "test_config_expensive.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/cumulusci-4.3.0/cumulusci-4.3.0/cumulusci/core/config/tests/test_config_expensive.py",
    "line_number": "351",
    "type_description": "B832:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "350\t            with open(\"tmp.json\", \"w\") as f:\n351\t                f.write(\"{}\")\n352\t            with pytest.raises(ScratchOrgException):",
    "code_snippet": "@pytest.fixture\ndef scratch_def_file():\n    with temporary_dir():\n        with open(\"tmp.json\", \"w\") as f:\n            f.write(\"{}\")\n        yield",
    "pattern_analysis": {
      "api_sequence": [
        "open",
        "f.write"
      ],
      "api_sequence_with_args": [
        "open(\"tmp.json\", \"w\")",
        "f.write(\"{}\")"
      ],
      "mapped_sequence": [
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "f.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        }
      ],
      "contextual_code": "def scratch_def_file():\n    with temporary_dir():\n        with open(\"tmp.json\", \"w\") as f:\n            f.write(\"{}\")\n        yield"
    }
  }
]