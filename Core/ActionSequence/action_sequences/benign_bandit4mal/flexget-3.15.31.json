[
  {
    "metadata": {
      "package_name": "flexget-3.15.31",
      "total_matches": 5,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "api_emby.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/flexget-3.15.31/flexget-3.15.31/flexget/components/emby/api_emby.py",
    "line_number": "1334",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1333\n1334\t                self.source_id = file.get('Id')\n1335",
    "code_snippet": "def __init__(self, **kwargs):\n    if not kwargs:\n        return\n\n    myfield_map = EmbyApiMedia.field_map.copy()\n\n    if 'field_map' in kwargs:\n        myfield_map = EmbyApiBase.merge_field_map(kwargs.get('field_map'), myfield_map)\n\n    EmbyApiBase.update_using_map(self, EmbyApiMedia.field_map, kwargs)\n\n    self.auth = EmbyApi.get_auth(**kwargs)\n\n    if self.created_date:\n        self.created_date = EmbyApi.strtotime(self.created_date)\n\n    if self.aired_date:\n        self.aired_date = EmbyApi.strtotime(self.aired_date)\n\n    if self.mtype:\n        self.mtype = self.mtype.lower()\n\n    if 'MediaSources' in kwargs:\n        self.media_sources_raw = kwargs.get('MediaSources')\n        for file in self.media_sources_raw:\n            if 'Type' not in file or file.get('Type') != 'Default':\n                continue\n\n            if 'MediaStreams' not in file:\n                continue\n\n            self.source_id = file.get('Id')\n\n            for stream in file.get('MediaStreams'):\n                if stream.get('Type') == 'Video':\n                    self.quality = stream.get('DisplayTitle')\n\n                if stream.get('Type') == 'Subtitle' and stream.get('Language'):\n                    if not self.subtitles:\n                        self.subtitles = []\n\n                    self.subtitles.append(stream['Language'])\n\n                if stream.get('Type') == 'Audio' and 'Language' in stream:\n                    if not self.audio:\n                        self.audio = []\n\n                    self.audio.append(stream['Language'])\n\n    self.library = self.get_libary()",
    "pattern_analysis": {
      "api_sequence": [
        "EmbyApiMedia.field_map.copy",
        "kwargs.get",
        "EmbyApiBase.merge_field_map",
        "EmbyApiBase.update_using_map",
        "EmbyApi.get_auth",
        "EmbyApi.strtotime",
        "EmbyApi.strtotime",
        "self.mtype.lower",
        "kwargs.get",
        "file.get",
        "file.get",
        "file.get",
        "stream.get",
        "stream.get",
        "self.subtitles.append",
        "stream.get",
        "self.audio.append",
        "self.get_libary"
      ],
      "api_sequence_with_args": [
        "EmbyApiMedia.field_map.copy()",
        "kwargs.get('field_map')",
        "EmbyApiBase.merge_field_map(kwargs.get('field_map'), myfield_map)",
        "EmbyApiBase.update_using_map(self, EmbyApiMedia.field_map, kwargs)",
        "EmbyApi.get_auth(**kwargs)",
        "EmbyApi.strtotime(self.created_date)",
        "EmbyApi.strtotime(self.aired_date)",
        "self.mtype.lower()",
        "kwargs.get('MediaSources')",
        "file.get('Type')",
        "file.get('MediaStreams')",
        "file.get('Id')",
        "stream.get('Type')",
        "stream.get('DisplayTitle')",
        "self.subtitles.append(stream['Language'])",
        "stream.get('Language')",
        "self.audio.append(stream['Language'])",
        "self.get_libary()"
      ],
      "mapped_sequence": [
        {
          "api_name": "EmbyApiMedia.field_map.copy",
          "id": "path_object_operations",
          "description": "Path object and status operations (creating Path objects, retrieving file status)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "kwargs.get",
          "id": "deserialize_from_json",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "EmbyApiBase.merge_field_map",
          "id": "deserialize_from_json",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "EmbyApiBase.update_using_map",
          "id": "deserialize_from_json",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "EmbyApi.get_auth",
          "id": "deserialize_from_json",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "EmbyApi.strtotime",
          "id": "parse_datetime",
          "description": "Parses string into datetime object using format",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        },
        {
          "api_name": "EmbyApi.strtotime",
          "id": "parse_datetime",
          "description": "Parses string into datetime object using format",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        },
        {
          "api_name": "self.mtype.lower",
          "id": "deserialize_from_json",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "kwargs.get",
          "id": "deserialize_from_json",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "file.get",
          "id": "deserialize_from_json",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "file.get",
          "id": "deserialize_from_json",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "file.get",
          "id": "deserialize_from_json",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "stream.get",
          "id": "deserialize_from_json",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "stream.get",
          "id": "deserialize_from_json",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "self.subtitles.append",
          "id": "deserialize_from_json",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "stream.get",
          "id": "deserialize_from_json",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "self.audio.append",
          "id": "deserialize_from_json",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "self.get_libary",
          "id": "deserialize_from_json",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        }
      ],
      "contextual_code": "def __init__(self, **kwargs):\n    if not kwargs:\n        return\n\n    myfield_map = EmbyApiMedia.field_map.copy()\n\n    if 'field_map' in kwargs:\n        myfield_map = EmbyApiBase.merge_field_map(kwargs.get('field_map'), myfield_map)\n\n    EmbyApiBase.update_using_map(self, EmbyApiMedia.field_map, kwargs)\n\n    self.auth = EmbyApi.get_auth(**kwargs)\n\n    if self.created_date:\n        self.created_date = EmbyApi.strtotime(self.created_date)\n\n    if self.aired_date:\n        self.aired_date = EmbyApi.strtotime(self.aired_date)\n\n    if self.mtype:\n        self.mtype = self.mtype.lower()\n\n    if 'MediaSources' in kwargs:\n        self.media_sources_raw = kwargs.get('MediaSources')\n        for file in self.media_sources_raw:\n            if 'Type' not in file or file.get('Type') != 'Default':\n                continue\n\n            if 'MediaStreams' not in file:\n                continue\n\n            self.source_id = file.get('Id')\n\n            for stream in file.get('MediaStreams'):\n                if stream.get('Type') == 'Video':\n                    self.quality = stream.get('DisplayTitle')\n\n                if stream.get('Type') == 'Subtitle' and stream.get('Language'):\n                    if not self.subtitles:\n                        self.subtitles = []\n\n                    self.subtitles.append(stream['Language'])\n\n                if stream.get('Type') == 'Audio' and 'Language' in stream:\n                    if not self.audio:\n                        self.audio = []\n\n                    self.audio.append(stream['Language'])\n\n    self.library = self.get_libary()"
    }
  },
  {
    "pyfile": "newznab.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/flexget-3.15.31/flexget-3.15.31/flexget/components/sites/sites/newznab.py",
    "line_number": "129",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "128\t        elif arg_entry.get('tmdb_id'):\n129\t            params['tmdbid'] = arg_entry.get('tmdb_id')\n130\t        elif arg_entry.get('imdb_id'):",
    "code_snippet": "    def do_search_tvsearch(self, arg_entry, task, url, params):\n        logger.info('Searching for {}', arg_entry['title'])\n        # normally this should be used with next_series_episodes who has provided season and episodenumber\n        if (\n            'series_name' not in arg_entry\n            or 'series_season' not in arg_entry\n            or 'series_episode' not in arg_entry\n        ):\n            return []\n        if arg_entry.get('tvdb_id'):\n            params['tvdbid'] = arg_entry.get('tvdb_id')\n        elif arg_entry.get('trakt_id'):\n            params['traktid'] = arg_entry.get('trakt_id')\n        elif arg_entry.get('tvmaze_series_id'):\n            params['tvmazeid'] = arg_entry.get('tvmaze_series_id')\n        elif arg_entry.get('tmdb_id'):\n            params['tmdbid'] = arg_entry.get('tmdb_id')\n        elif arg_entry.get('imdb_id'):\n            params['imdbid'] = arg_entry.get('imdb_id')\n        elif arg_entry.get('tvrage_id'):\n            params['rid'] = arg_entry.get('tvrage_id')\n        else:\n            params['q'] = arg_entry['series_name']\n        params['ep'] = arg_entry['series_episode']\n        params['season'] = arg_entry['series_season']\n        return self.fill_entries_for_url(url, params, task)",
    "pattern_analysis": {
      "api_sequence": [
        "logger.info",
        "self.fill_entries_for_url"
      ],
      "api_sequence_with_args": [
        "logger.info('Searching for {}', arg_entry['title'])",
        "self.fill_entries_for_url(url, params, task)"
      ],
      "mapped_sequence": [
        {
          "api_name": "logger.info",
          "id": "log_info",
          "description": "Logs informational message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "self.fill_entries_for_url",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        }
      ],
      "contextual_code": "def do_search_tvsearch(self, arg_entry, task, url, params):\n    logger.info('Searching for {}', arg_entry['title'])\n    if (\n        'series_name' not in arg_entry\n        or 'series_season' not in arg_entry\n        or 'series_episode' not in arg_entry\n    ):\n        return []\n    if arg_entry.get('tvdb_id'):\n        params['tvdbid'] = arg_entry.get('tvdb_id')\n    elif arg_entry.get('trakt_id'):\n        params['traktid'] = arg_entry.get('trakt_id')\n    elif arg_entry.get('tvmaze_series_id'):\n        params['tvmazeid'] = arg_entry.get('tvmaze_series_id')\n    elif arg_entry.get('tmdb_id'):\n        params['tmdbid'] = arg_entry.get('tmdb_id')\n    elif arg_entry.get('imdb_id'):\n        params['imdbid'] = arg_entry.get('imdb_id')\n    elif arg_entry.get('tvrage_id'):\n        params['rid'] = arg_entry.get('tvrage_id')\n    else:\n        params['q'] = arg_entry['series_name']\n    params['ep'] = arg_entry['series_episode']\n    params['season'] = arg_entry['series_season']\n    return self.fill_entries_for_url(url, params, task)"
    }
  },
  {
    "pyfile": "api_emby.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/flexget-3.15.31/flexget-3.15.31/flexget/components/emby/api_emby.py",
    "line_number": "2046",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "2045\t            seasons_filter = []\n2046\t            seasons_filter = list(filter(lambda s: s.get('IndexNumber') == target_season, seasons))\n2047\t            seasons = seasons_filter",
    "code_snippet": "    @staticmethod\n    def search(**kwargs) -> 'EmbyApiSeason':\n        args = {}\n\n        auth = EmbyApi.get_auth(**kwargs)\n        kwargs['auth'] = auth\n\n        parameters = {}\n        field_map = EmbyApiBase.merge_field_map(\n            EmbyApiSeason.field_map_up,\n            EmbyApiSerie.field_map_up,\n            EmbyApiMedia.field_map,\n            allow_new=True,\n        )\n\n        EmbyApi.update_using_map(parameters, field_map, kwargs, allow_new=True)\n\n        # We need to have information regarding the series\n        season_serie = None\n        if 'api_serie' in kwargs:\n            season_serie = kwargs.get('api_serie')\n\n        if not season_serie:\n            season_serie = EmbyApiSerie.search(**kwargs)\n\n        if not season_serie:\n            logger.warning('Not possible to determine season, serie not found')\n            return None\n\n        if 'season_id' in parameters:\n            args['Ids'] = parameters.get('season_id')\n        else:\n            args['ParentId'] = season_serie.serie_id\n\n        args['IncludeItemTypes'] = 'Season'\n\n        EmbyApi.set_common_search_arg(args)\n\n        logger.debug('Search season with: {}', args)\n        seasons = EmbyApi.resquest_emby(EMBY_ENDPOINT_SEARCH, auth, 'GET', **args)\n        if not seasons or 'Items' not in seasons or not seasons['Items']:\n            logger.warning('No season found')\n            return None\n\n        seasons = seasons['Items']\n\n        target_season = parameters.get('season')\n        if not target_season:\n            target_season = EmbyApiSeason.parse_string(\n                parameters.get('search_string', parameters.get('base_name'))\n            )\n\n        if target_season:\n            seasons_filter = []\n            seasons_filter = list(filter(lambda s: s.get('IndexNumber') == target_season, seasons))\n            seasons = seasons_filter\n\n        if len(seasons) == 1:\n            season = seasons[0]\n        elif len(seasons) > 1:\n            logger.warning(\n                'More than one season found for {} {}', season_serie.fullname, target_season\n            )\n            return None\n        else:\n            logger.warning('No season found')\n            return None\n\n        season_api = EmbyApiSeason(auth=auth, api_serie=season_serie, **season)\n        if season_api:\n            logger.debug(\"Found season '{}' in emby server\", season_api.fullname)\n            return season_api\n        return None",
    "pattern_analysis": {
      "api_sequence": [
        "EmbyApi.get_auth",
        "EmbyApiBase.merge_field_map",
        "EmbyApi.update_using_map",
        "EmbyApiSerie.search",
        "EmbyApi.set_common_search_arg",
        "logger.debug",
        "EmbyApi.resquest_emby",
        "logger.warning",
        "EmbyApiSeason.parse_string",
        "logger.warning",
        "logger.warning",
        "EmbyApiSeason",
        "logger.debug"
      ],
      "api_sequence_with_args": [
        "EmbyApi.get_auth(**kwargs)",
        "EmbyApiBase.merge_field_map(EmbyApiSeason.field_map_up, EmbyApiSerie.field_map_up, EmbyApiMedia.field_map, allow_new=True)",
        "EmbyApi.update_using_map(parameters, field_map, kwargs, allow_new=True)",
        "EmbyApiSerie.search(**kwargs)",
        "EmbyApi.set_common_search_arg(args)",
        "logger.debug('Search season with: {}', args)",
        "EmbyApi.resquest_emby(EMBY_ENDPOINT_SEARCH, auth, 'GET', **args)",
        "logger.warning('No season found')",
        "EmbyApiSeason.parse_string(parameters.get('search_string', parameters.get('base_name')))",
        "logger.warning('More than one season found for {} {}', season_serie.fullname, target_season)",
        "logger.warning('No season found')",
        "EmbyApiSeason(auth=auth, api_serie=season_serie, **season)",
        "logger.debug(\"Found season '{}' in emby server\", season_api.fullname)"
      ],
      "mapped_sequence": [
        {
          "api_name": "EmbyApi.get_auth",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "EmbyApiBase.merge_field_map",
          "id": "apply_lambda_to_lists",
          "description": "Applies lambda function to elements of two lists",
          "first_id": "data_transformation_processing",
          "second_id": "function_application",
          "third_id": "lambda_application"
        },
        {
          "api_name": "EmbyApi.update_using_map",
          "id": "apply_lambda_to_lists",
          "description": "Applies lambda function to elements of two lists",
          "first_id": "data_transformation_processing",
          "second_id": "function_application",
          "third_id": "lambda_application"
        },
        {
          "api_name": "EmbyApiSerie.search",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "EmbyApi.set_common_search_arg",
          "id": "apply_lambda_to_lists",
          "description": "Applies lambda function to elements of two lists",
          "first_id": "data_transformation_processing",
          "second_id": "function_application",
          "third_id": "lambda_application"
        },
        {
          "api_name": "logger.debug",
          "id": "log_info",
          "description": "Logs informational message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "EmbyApi.resquest_emby",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "logger.warning",
          "id": "log_error",
          "description": "Logs error message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "EmbyApiSeason.parse_string",
          "id": "parse_datetime",
          "description": "Parses string into datetime object using format",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        },
        {
          "api_name": "logger.warning",
          "id": "log_error",
          "description": "Logs error message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "logger.warning",
          "id": "log_error",
          "description": "Logs error message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "EmbyApiSeason",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "logger.debug",
          "id": "log_info",
          "description": "Logs informational message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        }
      ],
      "contextual_code": "@staticmethod\ndef search(**kwargs) -> 'EmbyApiSeason':\n    args = {}\n    auth = EmbyApi.get_auth(**kwargs)\n    kwargs['auth'] = auth\n    parameters = {}\n    field_map = EmbyApiBase.merge_field_map(\n        EmbyApiSeason.field_map_up,\n        EmbyApiSerie.field_map_up,\n        EmbyApiMedia.field_map,\n        allow_new=True,\n    )\n    EmbyApi.update_using_map(parameters, field_map, kwargs, allow_new=True)\n    season_serie = None\n    if 'api_serie' in kwargs:\n        season_serie = kwargs.get('api_serie')\n    if not season_serie:\n        season_serie = EmbyApiSerie.search(**kwargs)\n    if not season_serie:\n        logger.warning('Not possible to determine season, serie not found')\n        return None\n    if 'season_id' in parameters:\n        args['Ids'] = parameters.get('season_id')\n    else:\n        args['ParentId'] = season_serie.serie_id\n    args['IncludeItemTypes'] = 'Season'\n    EmbyApi.set_common_search_arg(args)\n    logger.debug('Search season with: {}', args)\n    seasons = EmbyApi.resquest_emby(EMBY_ENDPOINT_SEARCH, auth, 'GET', **args)\n    if not seasons or 'Items' not in seasons or not seasons['Items']:\n        logger.warning('No season found')\n        return None\n    seasons = seasons['Items']\n    target_season = parameters.get('season')\n    if not target_season:\n        target_season = EmbyApiSeason.parse_string(\n            parameters.get('search_string', parameters.get('base_name'))\n        )\n    if target_season:\n        seasons_filter = []\n        seasons_filter = list(filter(lambda s: s.get('IndexNumber') == target_season, seasons))\n        seasons = seasons_filter\n    if len(seasons) == 1:\n        season = seasons[0]\n    elif len(seasons) > 1:\n        logger.warning(\n            'More than one season found for {} {}', season_serie.fullname, target_season\n        )\n        return None\n    else:\n        logger.warning('No season found')\n        return None\n    season_api = EmbyApiSeason(auth=auth, api_serie=season_serie, **season)\n    if season_api:\n        logger.debug(\"Found season '{}' in emby server\", season_api.fullname)\n        return season_api\n    return None"
    }
  },
  {
    "pyfile": "db.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/flexget-3.15.31/flexget-3.15.31/flexget/components/trakt/db.py",
    "line_number": "350",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "349\t    def update(self, actor, session):\n350\t        if self.id and self.id != actor.get('ids').get('trakt'):\n351\t            raise ValueError('Tried to update db actors with different actor data')",
    "code_snippet": "class TraktActor(Base):\n    __tablename__ = 'trakt_actors'\n\n    id = Column(Integer, primary_key=True, nullable=False)\n    name = Column(Unicode)\n    slug = Column(Unicode)\n    tmdb = Column(Integer)\n    imdb = Column(Unicode)\n    biography = Column(Unicode)\n    birthday = Column(Date)\n    death = Column(Date)\n    homepage = Column(Unicode)\n\n    def __init__(self, actor, session):\n        super().__init__()\n        self.update(actor, session)\n\n    def update(self, actor, session):\n        if self.id and self.id != actor.get('ids').get('trakt'):\n            raise ValueError('Tried to update db actors with different actor data')\n        if not self.id:\n            self.id = actor.get('ids').get('trakt')\n        self.name = actor.get('name')\n        ids = actor.get('ids')\n        self.imdb = ids.get('imdb')\n        self.slug = ids.get('slug')\n        self.tmdb = ids.get('tmdb')\n        self.biography = actor.get('biography')\n        if actor.get('birthday'):\n            self.birthday = dateutil_parse(actor.get('birthday'))\n        if actor.get('death'):\n            self.death = dateutil_parse(actor.get('death'))\n        self.homepage = actor.get('homepage')\n\n    def to_dict(self):\n        return {'name': self.name, 'trakt_id': self.id, 'imdb_id': self.imdb, 'tmdb_id': self.tmdb}",
    "pattern_analysis": {
      "api_sequence": [
        "dateutil_parse"
      ],
      "api_sequence_with_args": [
        "dateutil_parse(actor.get('birthday'))",
        "dateutil_parse(actor.get('death'))"
      ],
      "mapped_sequence": [
        {
          "api_name": "dateutil_parse",
          "id": "parse_datetime",
          "description": "Parses string into datetime object using format",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        },
        {
          "api_name": "dateutil_parse",
          "id": "parse_datetime",
          "description": "Parses string into datetime object using format",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "time_operations"
        }
      ],
      "contextual_code": "def update(self, actor, session):\n    ...\n    if actor.get('birthday'):\n        self.birthday = dateutil_parse(actor.get('birthday'))\n    if actor.get('death'):\n        self.death = dateutil_parse(actor.get('death'))\n    ..."
    }
  },
  {
    "pyfile": "ombi_list.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/flexget-3.15.31/flexget-3.15.31/flexget/components/managed_lists/lists/ombi_list.py",
    "line_number": "894",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "893\t                ombi_id=parent_request.get('externalProviderId'),\n894\t                ombi_status=parent_request.get('status'),\n895\t                ombi_request_id=parent_request.get('id'),",
    "code_snippet": "def generate_tv_entry(self, parent_request, child_request=None, season=None, episode=None):\n    if self.config.get('type') == 'shows':\n        log.debug('Found: %s', parent_request.get('title'))\n        if not parent_request.get('imdbId'):\n            simdburl = ''\n        else:\n            simdburl = 'http://www.imdb.com/title/' + parent_request.get('imdbId') + '/'\n        return Entry(\n            title=self.generate_title(parent_request),\n            url=simdburl,\n            series_name=self.generate_title(parent_request),\n            tvdb_id=parent_request.get('tvDbId'),\n            imdb_id=parent_request.get('imdbId'),\n            tmdb_id=parent_request.get('externalProviderId'),\n            ombi_id=parent_request.get('externalProviderId'),\n            ombi_status=parent_request.get('status'),\n            ombi_request_id=parent_request.get('id'),\n        )\n    if self.config.get('type') == 'seasons':\n        log.debug('Found: %s S%s', parent_request.get('title'), season.get('seasonNumber'))\n        if not parent_request.get('imdbId'):\n            simdburl = ''\n        else:\n            simdburl = 'http://www.imdb.com/title/' + parent_request.get('imdbId') + '/'\n        return Entry(\n            title=self.generate_title(parent_request, season),\n            url=simdburl,\n            series_name=self.generate_title(parent_request),\n            series_season=season.get('seasonNumber'),\n            series_id=self.generate_series_id(season),\n            tvdb_id=parent_request.get('tvDbId'),\n            imdb_id=parent_request.get('imdbId'),\n            tmdb_id=parent_request.get('externalProviderId'),\n            tmdb_season=season.get('seasonNumber'),\n            ombi_id=parent_request.get('externalProviderId'),\n            ombi_childrequest_id=child_request.get('id'),\n            ombi_season_id=season.get('id'),\n            ombi_season=season.get('seasonNumber'),\n            ombi_status=parent_request.get('status'),\n            ombi_request_id=parent_request.get('id'),\n        )\n    if self.config.get('type') == 'episodes':\n        log.debug(\n            'Found: %s S%sE%s',\n            parent_request.get('title'),\n            season.get('seasonNumber'),\n            episode.get('episodeNumber'),\n        )\n        if not parent_request.get('imdbId'):\n            simdburl = ''\n        else:\n            simdburl = 'http://www.imdb.com/title/' + parent_request.get('imdbId') + '/'\n        return Entry(\n            title=self.generate_title(parent_request, season, episode),\n            url=simdburl,\n            series_name=self.generate_title(parent_request),\n            series_season=season.get('seasonNumber'),\n            series_episode=episode.get('episodeNumber'),\n            series_id=self.generate_series_id(season, episode),\n            tvdb_id=parent_request.get('tvDbId'),\n            imdb_id=parent_request.get('imdbId'),\n            tmdb_id=parent_request.get('externalProviderId'),\n            tmdb_season=season.get('seasonNumber'),\n            tmdb_episode=episode.get('episodeNumber'),\n            ombi_id=parent_request.get('externalProviderId'),\n            ombi_request_id=parent_request.get('id'),\n            ombi_childrequest_id=child_request.get('id'),\n            ombi_season_id=season.get('id'),\n            ombi_season=season.get('seasonNumber'),\n            ombi_episode_id=episode.get('id'),\n            ombi_episode=episode.get('episodeNumber'),\n            ombi_approved=episode.get('approved'),\n            ombi_available=episode.get('available'),\n            ombi_requested=episode.get('requested'),\n        )\n    raise plugin.PluginError('Error: Unknown list type {}.'.format(self.config.get('type')))",
    "pattern_analysis": {
      "api_sequence": [
        "self.config.get",
        "parent_request.get",
        "parent_request.get",
        "Entry",
        "self.config.get",
        "parent_request.get",
        "season.get",
        "parent_request.get",
        "Entry",
        "self.config.get",
        "parent_request.get",
        "season.get",
        "episode.get",
        "parent_request.get",
        "Entry",
        "self.config.get"
      ],
      "api_sequence_with_args": [
        "self.config.get('type')",
        "parent_request.get('title')",
        "parent_request.get('imdbId')",
        "Entry(...)",
        "self.config.get('type')",
        "parent_request.get('title')",
        "season.get('seasonNumber')",
        "parent_request.get('imdbId')",
        "Entry(...)",
        "self.config.get('type')",
        "parent_request.get('title')",
        "season.get('seasonNumber')",
        "episode.get('episodeNumber')",
        "parent_request.get('imdbId')",
        "Entry(...)",
        "self.config.get('type')"
      ],
      "mapped_sequence": [
        {
          "api_name": "self.config.get",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "parent_request.get",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "parent_request.get",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "Entry",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "self.config.get",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "parent_request.get",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "season.get",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "parent_request.get",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "Entry",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "self.config.get",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "parent_request.get",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "season.get",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "episode.get",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "parent_request.get",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "Entry",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "self.config.get",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        }
      ],
      "contextual_code": "def generate_tv_entry(self, parent_request, child_request=None, season=None, episode=None):\n    if self.config.get('type') == 'shows':\n        log.debug('Found: %s', parent_request.get('title'))\n        if not parent_request.get('imdbId'):\n            simdburl = ''\n        else:\n            simdburl = 'http://www.imdb.com/title/' + parent_request.get('imdbId') + '/'\n        return Entry(\n            title=self.generate_title(parent_request),\n            url=simdburl,\n            series_name=self.generate_title(parent_request),\n            tvdb_id=parent_request.get('tvDbId'),\n            imdb_id=parent_request.get('imdbId'),\n            tmdb_id=parent_request.get('externalProviderId'),\n            ombi_id=parent_request.get('externalProviderId'),\n            ombi_status=parent_request.get('status'),\n            ombi_request_id=parent_request.get('id'),\n        )\n    if self.config.get('type') == 'seasons':\n        log.debug('Found: %s S%s', parent_request.get('title'), season.get('seasonNumber'))\n        if not parent_request.get('imdbId'):\n            simdburl = ''\n        else:\n            simdburl = 'http://www.imdb.com/title/' + parent_request.get('imdbId') + '/'\n        return Entry(\n            title=self.generate_title(parent_request, season),\n            url=simdburl,\n            series_name=self.generate_title(parent_request),\n            series_season=season.get('seasonNumber'),\n            series_id=self.generate_series_id(season),\n            tvdb_id=parent_request.get('tvDbId'),\n            imdb_id=parent_request.get('imdbId'),\n            tmdb_id=parent_request.get('externalProviderId'),\n            tmdb_season=season.get('seasonNumber'),\n            ombi_id=parent_request.get('externalProviderId'),\n            ombi_childrequest_id=child_request.get('id'),\n            ombi_season_id=season.get('id'),\n            ombi_season=season.get('seasonNumber'),\n            ombi_status=parent_request.get('status'),\n            ombi_request_id=parent_request.get('id'),\n        )\n    if self.config.get('type') == 'episodes':\n        log.debug(\n            'Found: %s S%sE%s',\n            parent_request.get('title'),\n            season.get('seasonNumber'),\n            episode.get('episodeNumber'),\n        )\n        if not parent_request.get('imdbId'):\n            simdburl = ''\n        else:\n            simdburl = 'http://www.imdb.com/title/' + parent_request.get('imdbId') + '/'\n        return Entry(\n            title=self.generate_title(parent_request, season, episode),\n            url=simdburl,\n            series_name=self.generate_title(parent_request),\n            series_season=season.get('seasonNumber'),\n            series_episode=episode.get('episodeNumber'),\n            series_id=self.generate_series_id(season, episode),\n            tvdb_id=parent_request.get('tvDbId'),\n            imdb_id=parent_request.get('imdbId'),\n            tmdb_id=parent_request.get('externalProviderId'),\n            tmdb_season=season.get('seasonNumber'),\n            tmdb_episode=episode.get('episodeNumber'),\n            ombi_id=parent_request.get('externalProviderId'),\n            ombi_request_id=parent_request.get('id'),\n            ombi_childrequest_id=child_request.get('id'),\n            ombi_season_id=season.get('id'),\n            ombi_season=season.get('seasonNumber'),\n            ombi_episode_id=episode.get('id'),\n            ombi_episode=episode.get('episodeNumber'),\n            ombi_approved=episode.get('approved'),\n            ombi_available=episode.get('available'),\n            ombi_requested=episode.get('requested'),\n        )\n    raise plugin.PluginError('Error: Unknown list type {}.'.format(self.config.get('type')))"
    }
  }
]