[
  {
    "metadata": {
      "package_name": "cerberus_python_client-2.5.4-py2.py3-none-any",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "client.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/cerberus_python_client-2.5.4-py2.py3-none-any/cerberus/client.py",
    "line_number": "810",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "809\t                                                    sdb_name=sdb_name)\n810\t            sdb_metadata = metadata_resp.get('safe_deposit_box_metadata')\n811\t            metadata_list.extend(sdb_metadata)",
    "code_snippet": "def get_metadata(self, sdb_name=None):\n    \"\"\"\n    (Limited to Cerberus admin) get metadata for all SDBs or\n    a specific one when sdb_name is set Keyword arguments:\n        sdb_name (string) -- The name of the SDB to query for\n    \"\"\"\n    metadata_list = []\n\n    metadata_resp = self._get_metadata_resp(sdb_name=sdb_name)\n    metadata_list.extend(metadata_resp.get('safe_deposit_box_metadata'))\n    while metadata_resp['has_next']:\n        offset = metadata_resp['next_offset']\n        metadata_resp = self._get_metadata_resp(offset=offset,\n                                                sdb_name=sdb_name)\n        sdb_metadata = metadata_resp.get('safe_deposit_box_metadata')\n        metadata_list.extend(sdb_metadata)\n\n    return metadata_list",
    "pattern_analysis": {
      "api_sequence": [],
      "api_sequence_with_args": [],
      "mapped_sequence": [],
      "contextual_code": "def get_metadata(self, sdb_name=None):\n    metadata_list = []\n    metadata_resp = self._get_metadata_resp(sdb_name=sdb_name)\n    metadata_list.extend(metadata_resp.get('safe_deposit_box_metadata'))\n    while metadata_resp['has_next']:\n        offset = metadata_resp['next_offset']\n        metadata_resp = self._get_metadata_resp(offset=offset, sdb_name=sdb_name)\n        sdb_metadata = metadata_resp.get('safe_deposit_box_metadata')\n        metadata_list.extend(sdb_metadata)\n    return metadata_list"
    }
  }
]