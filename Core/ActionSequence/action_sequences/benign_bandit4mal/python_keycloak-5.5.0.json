[
  {
    "metadata": {
      "package_name": "python_keycloak-5.5.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "keycloak_admin.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/python_keycloak-5.5.0/python_keycloak-5.5.0/src/keycloak/keycloak_admin.py",
    "line_number": "1789",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1788\t        params_path = {\"realm-name\": self.connection.realm_name, \"id\": group_id}\n1789\t        response = self.connection.raw_get(urls_patterns.URL_ADMIN_GROUP.format(**params_path))\n1790",
    "code_snippet": "def get_group(self, group_id: str, full_hierarchy: bool = False) -> dict:\n    \"\"\"\n    Get group by id.\n\n    Returns full group details\n\n    GroupRepresentation\n    https://www.keycloak.org/docs-api/24.0.2/rest-api/#_grouprepresentation\n\n    :param group_id: The group id\n    :type group_id: str\n    :param full_hierarchy: If True, return all of the nested children groups, otherwise only\n        the first level children are returned\n    :type full_hierarchy: bool\n    :return: Keycloak server response (GroupRepresentation)\n    :rtype: dict\n    \"\"\"\n    params_path = {\"realm-name\": self.connection.realm_name, \"id\": group_id}\n    response = self.connection.raw_get(urls_patterns.URL_ADMIN_GROUP.format(**params_path))\n\n    if response.status_code >= HTTP_BAD_REQUEST:\n        return raise_error_from_response(response, KeycloakGetError)\n\n    # For version +23.0.0\n    group = response.json()\n    if group.get(\"subGroupCount\"):\n        group[\"subGroups\"] = self.get_group_children(\n            group.get(\"id\"),\n            full_hierarchy=full_hierarchy,\n        )\n\n    return group",
    "pattern_analysis": {
      "api_sequence": [
        "self.connection.raw_get",
        "response.status_code",
        "raise_error_from_response",
        "response.json",
        "group.get",
        "self.get_group_children"
      ],
      "api_sequence_with_args": [
        "self.connection.raw_get(urls_patterns.URL_ADMIN_GROUP.format(**params_path))",
        "response.status_code",
        "raise_error_from_response(response, KeycloakGetError)",
        "response.json()",
        "group.get(\"subGroupCount\")",
        "self.get_group_children(group.get(\"id\"), full_hierarchy=full_hierarchy)"
      ],
      "mapped_sequence": [
        {
          "api_name": "self.connection.raw_get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "response.status_code",
          "id": "get_http_status",
          "description": "Retrieves HTTP response status code",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "raise_error_from_response",
          "id": "raise_http_error",
          "description": "Raises HTTPError if response status code indicates error",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "response.json",
          "id": "deserialize_json_response",
          "description": "Deserializes JSON response body to Python object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "group.get",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "self.get_group_children",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        }
      ],
      "contextual_code": "def get_group(self, group_id: str, full_hierarchy: bool = False) -> dict:\n    params_path = {\"realm-name\": self.connection.realm_name, \"id\": group_id}\n    response = self.connection.raw_get(urls_patterns.URL_ADMIN_GROUP.format(**params_path))\n\n    if response.status_code >= HTTP_BAD_REQUEST:\n        return raise_error_from_response(response, KeycloakGetError)\n\n    group = response.json()\n    if group.get(\"subGroupCount\"):\n        group[\"subGroups\"] = self.get_group_children(\n            group.get(\"id\"),\n            full_hierarchy=full_hierarchy,\n        )\n\n    return group"
    }
  }
]