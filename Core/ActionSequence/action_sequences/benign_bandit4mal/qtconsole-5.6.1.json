[
  {
    "metadata": {
      "package_name": "qtconsole-5.6.1",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "test_completion_widget.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/qtconsole-5.6.1/qtconsole-5.6.1/qtconsole/tests/test_completion_widget.py",
    "line_number": "27",
    "type_description": "B836:rmtree",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "26\t    def __exit__(self, exc_type, exc_value, traceback):\n27\t        shutil.rmtree(self.dir_name)\n28",
    "code_snippet": "class TemporaryDirectory(object):\n    \"\"\"\n    Context manager for tempfile.mkdtemp().\n    This class is available in python +v3.2.\n    See: https://gist.github.com/cpelley/10e2eeaf60dacc7956bb\n    \"\"\"\n\n    def __enter__(self):\n        self.dir_name = tempfile.mkdtemp()\n        return self.dir_name\n\n    def __exit__(self, exc_type, exc_value, traceback):\n        shutil.rmtree(self.dir_name)",
    "pattern_analysis": {
      "api_sequence": [
        "tempfile.mkdtemp",
        "shutil.rmtree"
      ],
      "api_sequence_with_args": [
        "tempfile.mkdtemp()",
        "shutil.rmtree(self.dir_name)"
      ],
      "mapped_sequence": [
        {
          "api_name": "tempfile.mkdtemp",
          "id": "create_temp_dir",
          "description": "Creates temporary directory and returns its path",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "shutil.rmtree",
          "id": "delete_directory",
          "description": "Recursively deletes directory and its contents",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        }
      ],
      "contextual_code": "class TemporaryDirectory(object):\n    def __enter__(self):\n        self.dir_name = tempfile.mkdtemp()\n        return self.dir_name\n\n    def __exit__(self, exc_type, exc_value, traceback):\n        shutil.rmtree(self.dir_name)"
    }
  }
]