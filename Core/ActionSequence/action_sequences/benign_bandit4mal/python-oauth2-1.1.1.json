[
  {
    "metadata": {
      "package_name": "python-oauth2-1.1.1",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "test_authorization_code.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/python-oauth2-1.1.1/python-oauth2-1.1.1/oauth2/test/functional/test_authorization_code.py",
    "line_number": "139",
    "type_description": "B838:process",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "138\n139\t        self.server = Process(target=run_provider, args=(ready_queue,))\n140\t        self.server.start()",
    "code_snippet": "def test_tornado(self):\n    def run_provider(queue):\n        try:\n            provider = create_provider()\n\n            app = TornadoApplication([\n                url(r\"/authorize\", OAuth2Handler, dict(provider=provider)),\n                url(r\"/token\", OAuth2Handler, dict(provider=provider))\n            ], debug=True)\n            app.listen(15486)\n\n            queue.put({\"result\": 0})\n\n            IOLoop.current().start()\n        except Exception as e:\n            queue.put({\"result\": 1, \"error_message\": str(e)})\n\n    ready_queue = Queue()\n\n    self.server = Process(target=run_provider, args=(ready_queue,))\n    self.server.start()\n\n    provider_started = ready_queue.get()\n\n    if provider_started[\"result\"] != 0:\n        raise Exception(\"Error starting Provider process with message\"\n                        \"'{0}'\".format(provider_started[\"error_message\"]))\n\n    self.client = Process(target=run_client, args=(ready_queue,))\n    self.client.start()\n\n    client_started = ready_queue.get()\n\n    if client_started[\"result\"] != 0:\n        raise Exception(\"Error starting Client Application process with \"\n                        \"message '{0}'\"\n                        .format(client_started[\"error_message\"]))\n\n    self.access_token()",
    "pattern_analysis": {
      "api_sequence": [
        "TornadoApplication.listen",
        "IOLoop.current",
        "IOLoop.start",
        "Queue.put",
        "Process.start",
        "Queue.get",
        "Process.start",
        "Queue.get"
      ],
      "api_sequence_with_args": [
        "TornadoApplication.listen(15486)",
        "IOLoop.current()",
        "IOLoop.start()",
        "Queue.put({\"result\": 0})",
        "Process.start()",
        "Queue.get()",
        "Process.start()",
        "Queue.get()"
      ],
      "mapped_sequence": [
        {
          "api_name": "TornadoApplication.listen",
          "id": "create_http_connection",
          "description": "Creates HTTP connection to specified host",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_creation"
        },
        {
          "api_name": "IOLoop.current",
          "id": "run_async_function",
          "description": "Runs asynchronous function until completion",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_control"
        },
        {
          "api_name": "IOLoop.start",
          "id": "run_async_function",
          "description": "Runs asynchronous function until completion",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_control"
        },
        {
          "api_name": "Queue.put",
          "id": "submit_thread_function",
          "description": "Submits function to thread pool for execution",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_pool_management"
        },
        {
          "api_name": "Process.start",
          "id": "create_child_process",
          "description": "Creates child process by duplicating current process",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_creation"
        },
        {
          "api_name": "Queue.get",
          "id": "read_user_input",
          "description": "Reads user input from standard input",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "Process.start",
          "id": "create_child_process",
          "description": "Creates child process by duplicating current process",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_creation"
        },
        {
          "api_name": "Queue.get",
          "id": "read_user_input",
          "description": "Reads user input from standard input",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        }
      ],
      "contextual_code": "def test_tornado(self):\n    def run_provider(queue):\n        try:\n            provider = create_provider()\n\n            app = TornadoApplication([\n                url(r\"/authorize\", OAuth2Handler, dict(provider=provider)),\n                url(r\"/token\", OAuth2Handler, dict(provider=provider))\n            ], debug=True)\n            app.listen(15486)\n\n            queue.put({\"result\": 0})\n\n            IOLoop.current().start()\n        except Exception as e:\n            queue.put({\"result\": 1, \"error_message\": str(e)})\n\n    ready_queue = Queue()\n\n    self.server = Process(target=run_provider, args=(ready_queue,))\n    self.server.start()\n\n    provider_started = ready_queue.get()\n\n    if provider_started[\"result\"] != 0:\n        raise Exception(\"Error starting Provider process with message\"\n                        \"'{0}'\".format(provider_started[\"error_message\"]))\n\n    self.client = Process(target=run_client, args=(ready_queue,))\n    self.client.start()\n\n    client_started = ready_queue.get()\n\n    if client_started[\"result\"] != 0:\n        raise Exception(\"Error starting Client Application process with \"\n                        \"message '{0}'\"\n                        .format(client_started[\"error_message\"]))\n\n    self.access_token()"
    }
  }
]