[
  {
    "metadata": {
      "package_name": "orjson-3.10.16",
      "total_matches": 2,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "generate-encoding-data.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/orjson-3.10.16/orjson-3.10.16/include/cargo/encoding_rs-0.8.35/generate-encoding-data.py",
    "line_number": "367",
    "type_description": "B814:read",
    "severity": "High",
    "confidence": "Medium",
    "code_snippet": "def read_non_generated(path):\n  partially_generated_file = open(path, \"r\")\n  full = partially_generated_file.read()\n  partially_generated_file.close()\n\n  generated_begin = \"// BEGIN GENERATED CODE. PLEASE DO NOT EDIT.\"\n  generated_end = \"// END GENERATED CODE\"\n\n  generated_begin_index = full.find(generated_begin)\n  if generated_begin_index < 0:\n    sys.stderr.write(\"Can't find generated code start marker in %s. Exiting.\\n\" % path)\n    sys.exit(-1)\n  generated_end_index = full.find(generated_end)\n  if generated_end_index < 0:\n    sys.stderr.write(\"Can't find generated code end marker in %s. Exiting.\\n\" % path)\n    sys.exit(-1)\n\n  return (full[0:generated_begin_index + len(generated_begin)],\n          full[generated_end_index:])",
    "pattern_analysis": {
      "api_sequence": [
        "open",
        "file.read",
        "file.close",
        "str.find",
        "sys.stderr.write",
        "sys.exit",
        "str.find",
        "sys.stderr.write",
        "sys.exit"
      ],
      "api_sequence_with_args": [
        "open(path, \"r\")",
        "partially_generated_file.read()",
        "partially_generated_file.close()",
        "full.find(generated_begin)",
        "sys.stderr.write(\"Can't find generated code start marker in %s. Exiting.\\n\" % path)",
        "sys.exit(-1)",
        "full.find(generated_end)",
        "sys.stderr.write(\"Can't find generated code end marker in %s. Exiting.\\n\" % path)",
        "sys.exit(-1)"
      ],
      "mapped_sequence": [
        {
          "api_name": "open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "file.read",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "file.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "str.find",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "sys.stderr.write",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "sys.exit",
          "id": "exit_program",
          "description": "Exits program with specified status code",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_control"
        },
        {
          "api_name": "str.find",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "sys.stderr.write",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "sys.exit",
          "id": "exit_program",
          "description": "Exits program with specified status code",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_control"
        }
      ],
      "contextual_code": "def read_non_generated(path):\n  partially_generated_file = open(path, \"r\")\n  full = partially_generated_file.read()\n  partially_generated_file.close()\n\n  generated_begin = \"// BEGIN GENERATED CODE. PLEASE DO NOT EDIT.\"\n  generated_end = \"// END GENERATED CODE\"\n\n  generated_begin_index = full.find(generated_begin)\n  if generated_begin_index < 0:\n    sys.stderr.write(\"Can't find generated code start marker in %s. Exiting.\\n\" % path)\n    sys.exit(-1)\n  generated_end_index = full.find(generated_end)\n  if generated_end_index < 0:\n    sys.stderr.write(\"Can't find generated code end marker in %s. Exiting.\\n\" % path)\n    sys.exit(-1)\n\n  return (full[0:generated_begin_index + len(generated_begin)],\n          full[generated_end_index:])"
    }
  },
  {
    "pyfile": "generate-encoding-data.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/orjson-3.10.16/orjson-3.10.16/include/cargo/encoding_rs-0.8.35/generate-encoding-data.py",
    "line_number": "1965",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "code_snippet": "codepage_file.write(codepage_end)\ncodepage_file.close()\n\n(codepage_test_begin, codepage_test_end) = read_non_generated(\"../codepage/src/tests.rs\")\n\ncodepage_test_file = open(\"../codepage/src/tests.rs\", \"w\")\n\ncodepage_test_file.write(codepage_test_begin)\ncodepage_test_file.write(\"\"\"\n// Instead, please regenerate using generate-encoding-data.py\n\n#[test]\nfn test_to_encoding() {\n    assert_eq!(to_encoding(0), None);\n\n\"\"\")\n\nfor code_page in code_pages:\n  codepage_test_file.write(\"    assert_eq!(to_encoding(%d), Some(%s));\\n\" % (code_page, to_constant_name(encodings_by_code_page[code_page])))  \n\ncodepage_test_file.write(\"\"\"}\n\n#[test]\nfn test_from_encoding() {\n\"\"\")\n\nfor name in preferred:\n  if code_pages_by_encoding.has_key(name):\n    codepage_test_file.write(\"    assert_eq!(from_encoding(%s), Some(%d));\\n\" % (to_constant_name(name), code_pages_by_encoding[name]))\n  else:\n    codepage_test_file.write(\"    assert_eq!(from_encoding(%s), None);\\n\" % to_constant_name(name))\n\ncodepage_test_file.write(\"\"\"}\n\"\"\")\n\ncodepage_test_file.write(codepage_test_end)\ncodepage_test_file.close()\n\nsubprocess.call([\"cargo\", \"fmt\"])\n",
    "pattern_analysis": {
      "api_sequence": [
        "codepage_file.write",
        "codepage_file.close",
        "read_non_generated",
        "open",
        "codepage_test_file.write",
        "codepage_test_file.write",
        "codepage_test_file.write",
        "codepage_test_file.write",
        "codepage_test_file.write",
        "codepage_test_file.close",
        "subprocess.call"
      ],
      "api_sequence_with_args": [
        "codepage_file.write(codepage_end)",
        "codepage_file.close()",
        "read_non_generated(\"../codepage/src/tests.rs\")",
        "open(\"../codepage/src/tests.rs\", \"w\")",
        "codepage_test_file.write(codepage_test_begin)",
        "codepage_test_file.write(\"\"\"\n// Instead, please regenerate using generate-encoding-data.py\n\n#[test]\nfn test_to_encoding() {\n    assert_eq!(to_encoding(0), None);\n\n\"\"\")",
        "codepage_test_file.write(\"    assert_eq!(to_encoding(%d), Some(%s));\\n\" % (code_page, to_constant_name(encodings_by_code_page[code_page])))",
        "codepage_test_file.write(\"\"\"}\n\n#[test]\nfn test_from_encoding() {\n\"\"\")",
        "codepage_test_file.write(\"    assert_eq!(from_encoding(%s), Some(%d));\\n\" % (to_constant_name(name), code_pages_by_encoding[name])) or codepage_test_file.write(\"    assert_eq!(from_encoding(%s), None);\\n\" % to_constant_name(name))",
        "codepage_test_file.write(\"\"\"}\n\"\"\")",
        "codepage_test_file.close()",
        "subprocess.call([\"cargo\", \"fmt\"])"
      ],
      "mapped_sequence": [
        {
          "api_name": "codepage_file.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "codepage_file.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "read_non_generated",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "codepage_test_file.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "codepage_test_file.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "codepage_test_file.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "codepage_test_file.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "codepage_test_file.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "codepage_test_file.close",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        },
        {
          "api_name": "subprocess.call",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        }
      ],
      "contextual_code": "codepage_file.write(codepage_end)\ncodepage_file.close()\n\n(codepage_test_begin, codepage_test_end) = read_non_generated(\"../codepage/src/tests.rs\")\n\ncodepage_test_file = open(\"../codepage/src/tests.rs\", \"w\")\n\ncodepage_test_file.write(codepage_test_begin)\ncodepage_test_file.write(\"\"\"\n// Instead, please regenerate using generate-encoding-data.py\n\n#[test]\nfn test_to_encoding() {\n    assert_eq!(to_encoding(0), None);\n\n\"\"\")\n\nfor code_page in code_pages:\n  codepage_test_file.write(\"    assert_eq!(to_encoding(%d), Some(%s));\\n\" % (code_page, to_constant_name(encodings_by_code_page[code_page])))  \n\ncodepage_test_file.write(\"\"\"}\n\n#[test]\nfn test_from_encoding() {\n\"\"\")\n\nfor name in preferred:\n  if code_pages_by_encoding.has_key(name):\n    codepage_test_file.write(\"    assert_eq!(from_encoding(%s), Some(%d));\\n\" % (to_constant_name(name), code_pages_by_encoding[name]))\n  else:\n    codepage_test_file.write(\"    assert_eq!(from_encoding(%s), None);\\n\" % to_constant_name(name))\n\ncodepage_test_file.write(\"\"\"}\n\"\"\")\n\ncodepage_test_file.write(codepage_test_end)\ncodepage_test_file.close()\n\nsubprocess.call([\"cargo\", \"fmt\"])"
    }
  }
]