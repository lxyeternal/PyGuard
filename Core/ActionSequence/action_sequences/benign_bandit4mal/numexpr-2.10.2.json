[
  {
    "metadata": {
      "package_name": "numexpr-2.10.2",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "test_numexpr.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/numexpr-2.10.2/numexpr-2.10.2/numexpr/tests/test_numexpr.py",
    "line_number": "1317",
    "type_description": "B838:process",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1316\t        qout = mp.Queue()\n1317\t        ps = mp.Process(target=_worker, args=(qout,))\n1318\t        ps.daemon = True",
    "code_snippet": "class test_subprocess(TestCase):\n    def test_multiprocess(self):\n        try:\n            import multiprocessing as mp\n        except ImportError:\n            return\n        # Check for two threads at least\n        numexpr.set_num_threads(2)\n        #print \"**** Running from main process:\"\n        _worker()\n        #print \"**** Running from subprocess:\"\n        qout = mp.Queue()\n        ps = mp.Process(target=_worker, args=(qout,))\n        ps.daemon = True\n        ps.start()\n\n        result = qout.get()\n        #print result",
    "pattern_analysis": {
      "api_sequence": [
        "numexpr.set_num_threads",
        "_worker",
        "multiprocessing.Queue",
        "multiprocessing.Process",
        "multiprocessing.Process.start",
        "multiprocessing.Queue.get"
      ],
      "api_sequence_with_args": [
        "numexpr.set_num_threads(2)",
        "_worker()",
        "multiprocessing.Queue()",
        "multiprocessing.Process(target=_worker, args=(qout,))",
        "multiprocessing.Process.start()",
        "multiprocessing.Queue.get()"
      ],
      "mapped_sequence": [
        {
          "api_name": "numexpr.set_num_threads",
          "id": "create_thread",
          "description": "Creates new thread to execute target function",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_creation"
        },
        {
          "api_name": "_worker",
          "id": "create_thread",
          "description": "Creates new thread to execute target function",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_creation"
        },
        {
          "api_name": "multiprocessing.Queue",
          "id": "create_thread",
          "description": "Creates new thread to execute target function",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_creation"
        },
        {
          "api_name": "multiprocessing.Process",
          "id": "create_thread",
          "description": "Creates new thread to execute target function",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_creation"
        },
        {
          "api_name": "multiprocessing.Process.start",
          "id": "start_thread",
          "description": "Starts thread execution",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_control"
        },
        {
          "api_name": "multiprocessing.Queue.get",
          "id": "read_user_input",
          "description": "Reads user input from standard input",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        }
      ],
      "contextual_code": "class test_subprocess(TestCase):\n    def test_multiprocess(self):\n        try:\n            import multiprocessing as mp\n        except ImportError:\n            return\n        numexpr.set_num_threads(2)\n        _worker()\n        qout = mp.Queue()\n        ps = mp.Process(target=_worker, args=(qout,))\n        ps.daemon = True\n        ps.start()\n        result = qout.get()"
    }
  }
]