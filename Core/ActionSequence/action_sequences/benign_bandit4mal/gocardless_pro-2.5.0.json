[
  {
    "metadata": {
      "package_name": "gocardless_pro-2.5.0",
      "total_matches": 6,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "payer_themes_integration_test.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/gocardless_pro-2.5.0/gocardless_pro-2.5.0/tests/integration/payer_themes_integration_test.py",
    "line_number": "46",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "45\t      assert len(rsps.calls) == 2\n46\t      assert rsps.calls[0].request.headers.get('Idempotency-Key') == rsps.calls[1].request.headers.get('Idempotency-Key')\n47\t    body = fixture['body']['payer_themes']",
    "code_snippet": "@responses.activate\ndef test_timeout_payer_themes_create_for_creditor_retries():\n    fixture = helpers.load_fixture('payer_themes')['create_for_creditor']\n    with helpers.stub_timeout_then_response(fixture) as rsps:\n      response = helpers.client.payer_themes.create_for_creditor(*fixture['url_params'])\n      assert len(rsps.calls) == 2\n      assert rsps.calls[0].request.headers.get('Idempotency-Key') == rsps.calls[1].request.headers.get('Idempotency-Key')\n    body = fixture['body']['payer_themes']\n\n    assert isinstance(response, resources.PayerTheme)",
    "pattern_analysis": {
      "api_sequence": [
        "helpers.load_fixture",
        "helpers.stub_timeout_then_response",
        "helpers.client.payer_themes.create_for_creditor",
        "rsps.calls",
        "rsps.calls[0].request.headers.get",
        "rsps.calls[1].request.headers.get",
        "fixture['body']",
        "isinstance"
      ],
      "api_sequence_with_args": [
        "helpers.load_fixture('payer_themes')",
        "helpers.stub_timeout_then_response(fixture)",
        "helpers.client.payer_themes.create_for_creditor(*fixture['url_params'])",
        "rsps.calls",
        "rsps.calls[0].request.headers.get('Idempotency-Key')",
        "rsps.calls[1].request.headers.get('Idempotency-Key')",
        "fixture['body']['payer_themes']",
        "isinstance(response, resources.PayerTheme)"
      ],
      "mapped_sequence": [
        {
          "api_name": "helpers.load_fixture",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "helpers.stub_timeout_then_response",
          "id": "error_handling_operations",
          "description": "File opening operations with error handling (ignore errors, custom error handling, etc.)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "helpers.client.payer_themes.create_for_creditor",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "rsps.calls",
          "id": "read_response_body",
          "description": "Reads response body from HTTP response",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "rsps.calls[0].request.headers.get",
          "id": "add_http_header",
          "description": "Adds HTTP header to request object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_configuration"
        },
        {
          "api_name": "rsps.calls[1].request.headers.get",
          "id": "add_http_header",
          "description": "Adds HTTP header to request object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_configuration"
        },
        {
          "api_name": "fixture['body']",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "isinstance",
          "id": "check_instance_type",
          "description": "Checks if object is instance of specified type",
          "first_id": "utility_functions",
          "second_id": "logging_exception_handling",
          "third_id": "exception_checking"
        }
      ],
      "contextual_code": "@responses.activate\ndef test_timeout_payer_themes_create_for_creditor_retries():\n    fixture = helpers.load_fixture('payer_themes')['create_for_creditor']\n    with helpers.stub_timeout_then_response(fixture) as rsps:\n        response = helpers.client.payer_themes.create_for_creditor(*fixture['url_params'])\n        assert len(rsps.calls) == 2\n        assert rsps.calls[0].request.headers.get('Idempotency-Key') == rsps.calls[1].request.headers.get('Idempotency-Key')\n    body = fixture['body']['payer_themes']\n    assert isinstance(response, resources.PayerTheme)"
    }
  },
  {
    "pyfile": "billing_requests_integration_test.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/gocardless_pro-2.5.0/gocardless_pro-2.5.0/tests/integration/billing_requests_integration_test.py",
    "line_number": "1125",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1124\t    assert response.mandate_request.verify == body.get('mandate_request')['verify']\n1125\t    assert response.payment_request.amount == body.get('payment_request')['amount']\n1126\t    assert response.payment_request.app_fee == body.get('payment_request')['app_fee']",
    "code_snippet": "@responses.activate\ndef test_billing_requests_get():\n    fixture = helpers.load_fixture('billing_requests')['get']\n    helpers.stub_response(fixture)\n    response = helpers.client.billing_requests.get(*fixture['url_params'])\n    body = fixture['body']['billing_requests']\n\n    assert isinstance(response, resources.BillingRequest)\n    assert responses.calls[-1].request.headers.get('Idempotency-Key') is None\n    assert response.actions == body.get('actions')\n    assert response.created_at == body.get('created_at')\n    assert response.fallback_enabled == body.get('fallback_enabled')\n    assert response.fallback_occurred == body.get('fallback_occurred')\n    assert response.id == body.get('id')\n    assert response.metadata == body.get('metadata')\n    assert response.purpose_code == body.get('purpose_code')\n    assert response.status == body.get('status')\n    assert response.instalment_schedule_request.app_fee == body.get('instalment_schedule_request')['app_fee']\n    assert response.instalment_schedule_request.currency == body.get('instalment_schedule_request')['currency']\n    assert response.instalment_schedule_request.instalments_with_dates == body.get('instalment_schedule_request')['instalments_with_dates']\n    assert response.instalment_schedule_request.instalments_with_schedule == body.get('instalment_schedule_request')['instalments_with_schedule']\n    assert response.instalment_schedule_request.links == body.get('instalment_schedule_request')['links']\n    assert response.instalment_schedule_request.metadata == body.get('instalment_schedule_request')['metadata']\n    assert response.instalment_schedule_request.name == body.get('instalment_schedule_request')['name']\n    assert response.instalment_schedule_request.payment_reference == body.get('instalment_schedule_request')['payment_reference']\n    assert response.instalment_schedule_request.retry_if_possible == body.get('instalment_schedule_request')['retry_if_possible']\n    assert response.instalment_schedule_request.total_amount == body.get('instalment_schedule_request')['total_amount']\n    assert response.links.bank_authorisation == body.get('links')['bank_authorisation']\n    assert response.links.creditor == body.get('links')['creditor']\n    assert response.links.customer == body.get('links')['customer']\n    assert response.links.customer_bank_account == body.get('links')['customer_bank_account']\n    assert response.links.customer_billing_detail == body.get('links')['customer_billing_detail']\n    assert response.links.instalment_schedule_request == body.get('links')['instalment_schedule_request']\n    assert response.links.instalment_schedule_request_instalment_schedule == body.get('links')['instalment_schedule_request_instalment_schedule']\n    assert response.links.mandate_request == body.get('links')['mandate_request']\n    assert response.links.mandate_request_mandate == body.get('links')['mandate_request_mandate']\n    assert response.links.organisation == body.get('links')['organisation']\n    assert response.links.payment_provider == body.get('links')['payment_provider']\n    assert response.links.payment_request == body.get('links')['payment_request']\n    assert response.links.payment_request_payment == body.get('links')['payment_request_payment']\n    assert response.links.subscription_request == body.get('links')['subscription_request']\n    assert response.links.subscription_request_subscription == body.get('links')['subscription_request_subscription']\n    assert response.mandate_request.authorisation_source == body.get('mandate_request')['authorisation_source']\n    assert response.mandate_request.consent_type == body.get('mandate_request')['consent_type']\n    assert response.mandate_request.constraints == body.get('mandate_request')['constraints']\n    assert response.mandate_request.currency == body.get('mandate_request')['currency']\n    assert response.mandate_request.description == body.get('mandate_request')['description']\n    assert response.mandate_request.links == body.get('mandate_request')['links']\n    assert response.mandate_request.metadata == body.get('mandate_request')['metadata']\n    assert response.mandate_request.payer_requested_dual_signature == body.get('mandate_request')['payer_requested_dual_signature']\n    assert response.mandate_request.scheme == body.get('mandate_request')['scheme']\n    assert response.mandate_request.sweeping == body.get('mandate_request')['sweeping']\n    assert response.mandate_request.verify == body.get('mandate_request')['verify']\n    assert response.payment_request.amount == body.get('payment_request')['amount']\n    assert response.payment_request.app_fee == body.get('payment_request')['app_fee']\n    assert response.payment_request.currency == body.get('payment_request')['currency']\n    assert response.payment_request.description == body.get('payment_request')['description']\n    assert response.payment_request.funds_settlement == body.get('payment_request')['funds_settlement']\n    assert response.payment_request.links == body.get('payment_request')['links']\n    assert response.payment_request.metadata == body.get('payment_request')['metadata']\n    assert response.payment_request.reference == body.get('payment_request')['reference']\n    assert response.payment_request.scheme == body.get('payment_request')['scheme']\n    assert response.resources.customer == body.get('resources')['customer']\n    assert response.resources.customer_bank_account == body.get('resources')['customer_bank_account']\n    assert response.resources.customer_billing_detail == body.get('resources')['customer_billing_detail']\n    assert response.subscription_request.amount == body.get('subscription_request')['amount']\n    assert response.subscription_request.app_fee == body.get('subscription_request')['app_fee']\n    assert response.subscription_request.count == body.get('subscription_request')['count']\n    assert response.subscription_request.currency == body.get('subscription_request')['currency']\n    assert response.subscription_request.day_of_month == body.get('subscription_request')['day_of_month']\n    assert response.subscription_request.interval == body.get('subscription_request')['interval']\n    assert response.subscription_request.interval_unit == body.get('subscription_request')['interval_unit']\n    assert response.subscription_request.links == body.get('subscription_request')['links']\n    assert response.subscription_request.metadata == body.get('subscription_request')['metadata']\n    assert response.subscription_request.month == body.get('subscription_request')['month']\n    assert response.subscription_request.name == body.get('subscription_request')['name']\n    assert response.subscription_request.payment_reference == body.get('subscription_request')['payment_reference']\n    assert response.subscription_request.retry_if_possible == body.get('subscription_request')['retry_if_possible']\n    assert response.subscription_request.start_date == body.get('subscription_request')['start_date']",
    "pattern_analysis": {
      "api_sequence": [
        "helpers.load_fixture",
        "helpers.stub_response",
        "helpers.client.billing_requests.get",
        "responses.calls",
        "responses.calls[-1].request.headers.get"
      ],
      "api_sequence_with_args": [
        "helpers.load_fixture('billing_requests')",
        "helpers.stub_response(fixture)",
        "helpers.client.billing_requests.get(*fixture['url_params'])",
        "responses.calls",
        "responses.calls[-1].request.headers.get('Idempotency-Key')"
      ],
      "mapped_sequence": [
        {
          "api_name": "helpers.load_fixture",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "helpers.stub_response",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "helpers.client.billing_requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "responses.calls",
          "id": "read_response_body",
          "description": "Reads response body from HTTP response",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "responses.calls[-1].request.headers.get",
          "id": "add_http_header",
          "description": "Adds HTTP header to request object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_configuration"
        }
      ],
      "contextual_code": "@responses.activate\ndef test_billing_requests_get():\n    fixture = helpers.load_fixture('billing_requests')['get']\n    helpers.stub_response(fixture)\n    response = helpers.client.billing_requests.get(*fixture['url_params'])\n    # ...\n    assert responses.calls[-1].request.headers.get('Idempotency-Key') is None"
    }
  },
  {
    "pyfile": "payer_authorisations_integration_test.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/gocardless_pro-2.5.0/gocardless_pro-2.5.0/tests/integration/payer_authorisations_integration_test.py",
    "line_number": "272",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "271\t    assert response.customer.company_name == body.get('customer')['company_name']\n272\t    assert response.customer.country_code == body.get('customer')['country_code']\n273\t    assert response.customer.danish_identity_number == body.get('customer')['danish_identity_number']",
    "code_snippet": "@responses.activate\ndef test_payer_authorisations_get():\n    fixture = helpers.load_fixture('payer_authorisations')['get']\n    helpers.stub_response(fixture)\n    response = helpers.client.payer_authorisations.get(*fixture['url_params'])\n    body = fixture['body']['payer_authorisations']\n\n    assert isinstance(response, resources.PayerAuthorisation)\n    assert responses.calls[-1].request.headers.get('Idempotency-Key') is None\n    assert response.created_at == body.get('created_at')\n    assert response.id == body.get('id')\n    assert response.incomplete_fields == body.get('incomplete_fields')\n    assert response.status == body.get('status')\n    assert response.bank_account.account_holder_name == body.get('bank_account')['account_holder_name']\n    assert response.bank_account.account_number == body.get('bank_account')['account_number']\n    assert response.bank_account.account_number_ending == body.get('bank_account')['account_number_ending']\n    assert response.bank_account.account_number_suffix == body.get('bank_account')['account_number_suffix']\n    assert response.bank_account.account_type == body.get('bank_account')['account_type']\n    assert response.bank_account.bank_code == body.get('bank_account')['bank_code']\n    assert response.bank_account.branch_code == body.get('bank_account')['branch_code']\n    assert response.bank_account.country_code == body.get('bank_account')['country_code']\n    assert response.bank_account.currency == body.get('bank_account')['currency']\n    assert response.bank_account.iban == body.get('bank_account')['iban']\n    assert response.bank_account.metadata == body.get('bank_account')['metadata']\n    assert response.customer.address_line1 == body.get('customer')['address_line1']\n    assert response.customer.address_line2 == body.get('customer')['address_line2']\n    assert response.customer.address_line3 == body.get('customer')['address_line3']\n    assert response.customer.city == body.get('customer')['city']\n    assert response.customer.company_name == body.get('customer')['company_name']\n    assert response.customer.country_code == body.get('customer')['country_code']\n    assert response.customer.danish_identity_number == body.get('customer')['danish_identity_number']\n    assert response.customer.email == body.get('customer')['email']\n    assert response.customer.family_name == body.get('customer')['family_name']\n    assert response.customer.given_name == body.get('customer')['given_name']\n    assert response.customer.locale == body.get('customer')['locale']\n    assert response.customer.metadata == body.get('customer')['metadata']\n    assert response.customer.postal_code == body.get('customer')['postal_code']\n    assert response.customer.region == body.get('customer')['region']\n    assert response.customer.swedish_identity_number == body.get('customer')['swedish_identity_number']\n    assert response.links.bank_account == body.get('links')['bank_account']\n    assert response.links.customer == body.get('links')['customer']\n    assert response.links.mandate == body.get('links')['mandate']\n    assert response.mandate.metadata == body.get('mandate')['metadata']\n    assert response.mandate.payer_ip_address == body.get('mandate')['payer_ip_address']\n    assert response.mandate.reference == body.get('mandate')['reference']\n    assert response.mandate.scheme == body.get('mandate')['scheme']",
    "pattern_analysis": {
      "api_sequence": [
        "helpers.load_fixture",
        "helpers.stub_response",
        "helpers.client.payer_authorisations.get",
        "isinstance",
        "responses.calls.__getitem__",
        "responses.calls.__getitem__.request.headers.get"
      ],
      "api_sequence_with_args": [
        "helpers.load_fixture('payer_authorisations')",
        "helpers.stub_response(fixture)",
        "helpers.client.payer_authorisations.get(*fixture['url_params'])",
        "isinstance(response, resources.PayerAuthorisation)",
        "responses.calls[-1]",
        "responses.calls[-1].request.headers.get('Idempotency-Key')"
      ],
      "mapped_sequence": [
        {
          "api_name": "helpers.load_fixture",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "helpers.stub_response",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "helpers.client.payer_authorisations.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "isinstance",
          "id": "check_instance_type",
          "description": "Checks if object is instance of specified type",
          "first_id": "utility_functions",
          "second_id": "logging_exception_handling",
          "third_id": "exception_checking"
        },
        {
          "api_name": "responses.calls.__getitem__",
          "id": "get_global_symbols",
          "description": "Retrieves global symbol table as dictionary",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "responses.calls.__getitem__.request.headers.get",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        }
      ],
      "contextual_code": "@responses.activate\ndef test_payer_authorisations_get():\n    fixture = helpers.load_fixture('payer_authorisations')['get']\n    helpers.stub_response(fixture)\n    response = helpers.client.payer_authorisations.get(*fixture['url_params'])\n    body = fixture['body']['payer_authorisations']\n\n    assert isinstance(response, resources.PayerAuthorisation)\n    assert responses.calls[-1].request.headers.get('Idempotency-Key') is None"
    }
  },
  {
    "pyfile": "blocks_integration_test.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/gocardless_pro-2.5.0/gocardless_pro-2.5.0/tests/integration/blocks_integration_test.py",
    "line_number": "60",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "59\t      assert len(rsps.calls) == 2\n60\t      assert rsps.calls[0].request.headers.get('Idempotency-Key') == rsps.calls[1].request.headers.get('Idempotency-Key')\n61\t    body = fixture['body']['blocks']",
    "code_snippet": "@responses.activate\ndef test_timeout_blocks_create_retries():\n    fixture = helpers.load_fixture('blocks')['create']\n    with helpers.stub_timeout_then_response(fixture) as rsps:\n      response = helpers.client.blocks.create(*fixture['url_params'])\n      assert len(rsps.calls) == 2\n      assert rsps.calls[0].request.headers.get('Idempotency-Key') == rsps.calls[1].request.headers.get('Idempotency-Key')\n    body = fixture['body']['blocks']\n\n    assert isinstance(response, resources.Block)\n",
    "pattern_analysis": {
      "api_sequence": [
        "helpers.load_fixture",
        "helpers.stub_timeout_then_response",
        "helpers.client.blocks.create",
        "rsps.calls",
        "rsps.calls",
        "rsps.calls[0].request.headers.get",
        "rsps.calls[1].request.headers.get",
        "fixture['body']",
        "isinstance"
      ],
      "api_sequence_with_args": [
        "helpers.load_fixture('blocks')",
        "helpers.stub_timeout_then_response(fixture)",
        "helpers.client.blocks.create(*fixture['url_params'])",
        "rsps.calls",
        "rsps.calls",
        "rsps.calls[0].request.headers.get('Idempotency-Key')",
        "rsps.calls[1].request.headers.get('Idempotency-Key')",
        "fixture['body']['blocks']",
        "isinstance(response, resources.Block)"
      ],
      "mapped_sequence": [
        {
          "api_name": "helpers.load_fixture",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "helpers.stub_timeout_then_response",
          "id": "error_handling_operations",
          "description": "File opening operations with error handling (ignore errors, custom error handling, etc.)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "helpers.client.blocks.create",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "rsps.calls",
          "id": "get_global_symbols",
          "description": "Retrieves global symbol table as dictionary",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "rsps.calls",
          "id": "get_global_symbols",
          "description": "Retrieves global symbol table as dictionary",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "rsps.calls[0].request.headers.get",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "rsps.calls[1].request.headers.get",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "fixture['body']",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "isinstance",
          "id": "check_instance_type",
          "description": "Checks if object is instance of specified type",
          "first_id": "utility_functions",
          "second_id": "logging_exception_handling",
          "third_id": "exception_checking"
        }
      ],
      "contextual_code": "def test_timeout_blocks_create_retries():\n    fixture = helpers.load_fixture('blocks')['create']\n    with helpers.stub_timeout_then_response(fixture) as rsps:\n        response = helpers.client.blocks.create(*fixture['url_params'])\n        assert len(rsps.calls) == 2\n        assert rsps.calls[0].request.headers.get('Idempotency-Key') == rsps.calls[1].request.headers.get('Idempotency-Key')\n    body = fixture['body']['blocks']\n    assert isinstance(response, resources.Block)"
    }
  },
  {
    "pyfile": "redirect_flows_integration_test.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/gocardless_pro-2.5.0/gocardless_pro-2.5.0/tests/integration/redirect_flows_integration_test.py",
    "line_number": "50",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "49\t    helpers.client.redirect_flows.create(*fixture['url_params'])\n50\t    assert responses.calls[0].request.headers.get('Idempotency-Key') != responses.calls[1].request.headers.get('Idempotency-Key')\n51",
    "code_snippet": "@responses.activate\ndef test_redirect_flows_create_new_idempotency_key_for_each_call():\n    fixture = helpers.load_fixture('redirect_flows')['create']\n    helpers.stub_response(fixture)\n    helpers.client.redirect_flows.create(*fixture['url_params'])\n    helpers.client.redirect_flows.create(*fixture['url_params'])\n    assert responses.calls[0].request.headers.get('Idempotency-Key') != responses.calls[1].request.headers.get('Idempotency-Key')\n",
    "pattern_analysis": {
      "api_sequence": [
        "helpers.load_fixture",
        "helpers.stub_response",
        "helpers.client.redirect_flows.create",
        "helpers.client.redirect_flows.create",
        "responses.calls[0].request.headers.get",
        "responses.calls[1].request.headers.get"
      ],
      "api_sequence_with_args": [
        "helpers.load_fixture('redirect_flows')",
        "helpers.stub_response(fixture)",
        "helpers.client.redirect_flows.create(*fixture['url_params'])",
        "helpers.client.redirect_flows.create(*fixture['url_params'])",
        "responses.calls[0].request.headers.get('Idempotency-Key')",
        "responses.calls[1].request.headers.get('Idempotency-Key')"
      ],
      "mapped_sequence": [
        {
          "api_name": "helpers.load_fixture",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "helpers.stub_response",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "helpers.client.redirect_flows.create",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "helpers.client.redirect_flows.create",
          "id": "send_http_post",
          "description": "Sends HTTP POST request with data and parameters",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "responses.calls[0].request.headers.get",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "responses.calls[1].request.headers.get",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        }
      ],
      "contextual_code": "@responses.activate\ndef test_redirect_flows_create_new_idempotency_key_for_each_call():\n    fixture = helpers.load_fixture('redirect_flows')['create']\n    helpers.stub_response(fixture)\n    helpers.client.redirect_flows.create(*fixture['url_params'])\n    helpers.client.redirect_flows.create(*fixture['url_params'])\n    assert responses.calls[0].request.headers.get('Idempotency-Key') != responses.calls[1].request.headers.get('Idempotency-Key')"
    }
  },
  {
    "pyfile": "billing_request_flows_integration_test.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/gocardless_pro-2.5.0/gocardless_pro-2.5.0/tests/integration/billing_request_flows_integration_test.py",
    "line_number": "97",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "96\t    assert response.expires_at == body.get('expires_at')\n97\t    assert response.id == body.get('id')\n98\t    assert response.language == body.get('language')",
    "code_snippet": "@responses.activate\ndef test_billing_request_flows_create():\n    fixture = helpers.load_fixture('billing_request_flows')['create']\n    helpers.stub_response(fixture)\n    response = helpers.client.billing_request_flows.create(*fixture['url_params'])\n    body = fixture['body']['billing_request_flows']\n\n    assert isinstance(response, resources.BillingRequestFlow)\n    assert responses.calls[-1].request.headers.get('Idempotency-Key') is not None\n    assert response.authorisation_url == body.get('authorisation_url')\n    assert response.auto_fulfil == body.get('auto_fulfil')\n    assert response.created_at == body.get('created_at')\n    assert response.customer_details_captured == body.get('customer_details_captured')\n    assert response.exit_uri == body.get('exit_uri')\n    assert response.expires_at == body.get('expires_at')\n    assert response.id == body.get('id')\n    assert response.language == body.get('language')\n    assert response.lock_bank_account == body.get('lock_bank_account')\n    assert response.lock_currency == body.get('lock_currency')\n    assert response.lock_customer_details == body.get('lock_customer_details')\n    assert response.redirect_uri == body.get('redirect_uri')\n    assert response.session_token == body.get('session_token')\n    assert response.show_redirect_buttons == body.get('show_redirect_buttons')\n    assert response.show_success_redirect_button == body.get('show_success_redirect_button')\n    assert response.skip_success_screen == body.get('skip_success_screen')\n    assert response.links.billing_request == body.get('links')['billing_request']\n    assert response.prefilled_bank_account.account_type == body.get('prefilled_bank_account')['account_type']\n    assert response.prefilled_customer.address_line1 == body.get('prefilled_customer')['address_line1']\n    assert response.prefilled_customer.address_line2 == body.get('prefilled_customer')['address_line2']\n    assert response.prefilled_customer.address_line3 == body.get('prefilled_customer')['address_line3']\n    assert response.prefilled_customer.city == body.get('prefilled_customer')['city']\n    assert response.prefilled_customer.company_name == body.get('prefilled_customer')['company_name']\n    assert response.prefilled_customer.country_code == body.get('prefilled_customer')['country_code']\n    assert response.prefilled_customer.danish_identity_number == body.get('prefilled_customer')['danish_identity_number']\n    assert response.prefilled_customer.email == body.get('prefilled_customer')['email']\n    assert response.prefilled_customer.family_name == body.get('prefilled_customer')['family_name']\n    assert response.prefilled_customer.given_name == body.get('prefilled_customer')['given_name']\n    assert response.prefilled_customer.postal_code == body.get('prefilled_customer')['postal_code']\n    assert response.prefilled_customer.region == body.get('prefilled_customer')['region']\n    assert response.prefilled_customer.swedish_identity_number == body.get('prefilled_customer')['swedish_identity_number']",
    "pattern_analysis": {
      "api_sequence": [
        "helpers.load_fixture",
        "helpers.stub_response",
        "helpers.client.billing_request_flows.create",
        "isinstance",
        "responses.calls.__getitem__",
        "responses.calls.__getitem__.request.headers.get"
      ],
      "api_sequence_with_args": [
        "helpers.load_fixture('billing_request_flows')",
        "helpers.stub_response(fixture)",
        "helpers.client.billing_request_flows.create(*fixture['url_params'])",
        "isinstance(response, resources.BillingRequestFlow)",
        "responses.calls[-1]",
        "responses.calls[-1].request.headers.get('Idempotency-Key')"
      ],
      "mapped_sequence": [
        {
          "api_name": "helpers.load_fixture",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "helpers.stub_response",
          "id": "exec_python_code",
          "description": "Dynamically executes Python code string",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "string_execution"
        },
        {
          "api_name": "helpers.client.billing_request_flows.create",
          "id": "create_http_request",
          "description": "Creates HTTP request object with specified URL, data, and headers",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_creation"
        },
        {
          "api_name": "isinstance",
          "id": "check_instance_type",
          "description": "Checks if object is instance of specified type",
          "first_id": "utility_functions",
          "second_id": "logging_exception_handling",
          "third_id": "exception_checking"
        },
        {
          "api_name": "responses.calls.__getitem__",
          "id": "deserialize_from_bytes",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "responses.calls.__getitem__.request.headers.get",
          "id": "add_http_header",
          "description": "Adds HTTP header to request object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_configuration"
        }
      ],
      "contextual_code": "@responses.activate\ndef test_billing_request_flows_create():\n    fixture = helpers.load_fixture('billing_request_flows')['create']\n    helpers.stub_response(fixture)\n    response = helpers.client.billing_request_flows.create(*fixture['url_params'])\n    # ...\n    assert isinstance(response, resources.BillingRequestFlow)\n    assert responses.calls[-1].request.headers.get('Idempotency-Key') is not None"
    }
  }
]