[
  {
    "metadata": {
      "package_name": "mobly-1.12.4",
      "total_matches": 2,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "terminated_test.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/mobly-1.12.4/mobly-1.12.4/tests/lib/terminated_test.py",
    "line_number": "30",
    "type_description": "B817:system",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "29\t    # for the purpose of this test.\n30\t    if platform.system() == 'Windows':\n31\t      logging.warning('Test received a SIGTERM. Aborting all tests.')",
    "code_snippet": "import logging\nimport os\nimport platform\nimport signal\nfrom mobly import base_test\nfrom mobly import signals\nfrom mobly import test_runner\n\nclass TerminatedTest(base_test.BaseTestClass):\n\n  def test_terminated(self):\n    # SIGTERM handler does not work on Windows. So just simulate the behaviour\n    # for the purpose of this test.\n    if platform.system() == 'Windows':\n      logging.warning('Test received a SIGTERM. Aborting all tests.')\n      raise signals.TestAbortAll('Test received a SIGTERM.')\n    else:\n      os.kill(os.getpid(), signal.SIGTERM)",
    "pattern_analysis": {
      "api_sequence": [
        "platform.system",
        "logging.warning",
        "signals.TestAbortAll",
        "os.getpid",
        "os.kill"
      ],
      "api_sequence_with_args": [
        "platform.system()",
        "logging.warning('Test received a SIGTERM. Aborting all tests.')",
        "signals.TestAbortAll('Test received a SIGTERM.')",
        "os.getpid()",
        "os.kill(os.getpid(), signal.SIGTERM)"
      ],
      "mapped_sequence": [
        {
          "api_name": "platform.system",
          "id": "get_platform_info",
          "description": "Retrieves platform information as string",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "logging.warning",
          "id": "log_error",
          "description": "Logs error message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "signals.TestAbortAll",
          "id": "log_error",
          "description": "Logs error message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "os.getpid",
          "id": "get_process_info",
          "description": "Retrieves process information as dictionary",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_information"
        },
        {
          "api_name": "os.kill",
          "id": "terminate_process",
          "description": "Terminates the process",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_control"
        }
      ],
      "contextual_code": "import logging\nimport os\nimport platform\nimport signal\nfrom mobly import signals\n\nclass TerminatedTest(base_test.BaseTestClass):\n\n  def test_terminated(self):\n    if platform.system() == 'Windows':\n      logging.warning('Test received a SIGTERM. Aborting all tests.')\n      raise signals.TestAbortAll('Test received a SIGTERM.')\n    else:\n      os.kill(os.getpid(), signal.SIGTERM)"
    }
  },
  {
    "pyfile": "config_parser_test.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/mobly-1.12.4/mobly-1.12.4/tests/mobly/config_parser_test.py",
    "line_number": "33",
    "type_description": "B836:rmtree",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "32\t  def tearDown(self):\n33\t    shutil.rmtree(self.tmp_dir)\n34",
    "code_snippet": "import shutil\nimport tempfile\n\nclass OutputTest(unittest.TestCase):\n  def setUp(self):\n    self.tmp_dir = tempfile.mkdtemp()\n\n  def tearDown(self):\n    shutil.rmtree(self.tmp_dir)",
    "pattern_analysis": {
      "api_sequence": [
        "tempfile.mkdtemp",
        "shutil.rmtree"
      ],
      "api_sequence_with_args": [
        "tempfile.mkdtemp()",
        "shutil.rmtree(self.tmp_dir)"
      ],
      "mapped_sequence": [
        {
          "api_name": "tempfile.mkdtemp",
          "id": "create_temp_dir",
          "description": "Creates temporary directory and returns its path",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "shutil.rmtree",
          "id": "delete_directory",
          "description": "Recursively deletes directory and its contents",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        }
      ],
      "contextual_code": "import shutil\nimport tempfile\n\nclass OutputTest(unittest.TestCase):\n  def setUp(self):\n    self.tmp_dir = tempfile.mkdtemp()\n\n  def tearDown(self):\n    shutil.rmtree(self.tmp_dir)"
    }
  }
]