[
  {
    "metadata": {
      "package_name": "gql-3.6.0b4",
      "total_matches": 2,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "test_websocket_exceptions.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/gql-3.6.0b4/gql-3.6.0b4/tests/test_websocket_exceptions.py",
    "line_number": "269",
    "type_description": "B807:close",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "268\tasync def server_closing_directly(ws):\n269\t    await ws.close()\n270",
    "code_snippet": "async def server_closing_directly(ws):\n    await ws.close()",
    "pattern_analysis": {
      "api_sequence": [
        "ws.close"
      ],
      "api_sequence_with_args": [
        "ws.close()"
      ],
      "mapped_sequence": [
        {
          "api_name": "ws.close",
          "id": "close_socket",
          "description": "Closes the socket connection",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "connection_management"
        }
      ],
      "contextual_code": "async def server_closing_directly(ws):\n    await ws.close()"
    }
  },
  {
    "pyfile": "conftest.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/gql-3.6.0b4/gql-3.6.0b4/tests/conftest.py",
    "line_number": "426",
    "type_description": "B831:send",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "425\t    async def send_close(ws):\n426\t        await ws.send('{\"event\":\"phx_close\"}')\n427",
    "code_snippet": "class PhoenixChannelServerHelper:\n    @staticmethod\n    async def send_close(ws):\n        await ws.send('{\"event\":\"phx_close\"}')\n\n    @staticmethod\n    async def send_connection_ack(ws):\n\n        # Line return for easy debugging\n        print(\"\")\n\n        # Wait for init\n        result = await ws.recv()\n        json_result = json.loads(result)\n        assert json_result[\"event\"] == \"phx_join\"\n\n        # Send ack\n        await ws.send('{\"event\":\"phx_reply\", \"payload\": {\"status\": \"ok\"}, \"ref\": 1}')",
    "pattern_analysis": {
      "api_sequence": [
        "ws.recv",
        "json.loads",
        "ws.send"
      ],
      "api_sequence_with_args": [
        "ws.recv()",
        "json.loads(result)",
        "ws.send('{\"event\":\"phx_reply\", \"payload\": {\"status\": \"ok\"}, \"ref\": 1}')"
      ],
      "mapped_sequence": [
        {
          "api_name": "ws.recv",
          "id": "receive_socket_data",
          "description": "Receives data from socket connection",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "data_transmission"
        },
        {
          "api_name": "json.loads",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "ws.send",
          "id": "send_socket_data",
          "description": "Sends data over socket connection",
          "first_id": "basic_network_operations",
          "second_id": "socket_communication",
          "third_id": "data_transmission"
        }
      ],
      "contextual_code": "class PhoenixChannelServerHelper:\n    @staticmethod\n    async def send_connection_ack(ws):\n        print(\"\")\n        result = await ws.recv()\n        json_result = json.loads(result)\n        assert json_result[\"event\"] == \"phx_join\"\n        await ws.send('{\"event\":\"phx_reply\", \"payload\": {\"status\": \"ok\"}, \"ref\": 1}')"
    }
  }
]