[
  {
    "metadata": {
      "package_name": "prov-2.0.1",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "test_xml.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/prov-2.0.1/prov-2.0.1/src/prov/tests/test_xml.py",
    "line_number": "308",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "307\t            with io.StringIO() as xml:\n308\t                xml.write(xml_string)\n309\t                xml.seek(0, 0)",
    "code_snippet": "def test_deserialization_example_04_and_05(self):\n    \"\"\"\n    Example 4 and 5 have a different type specification. They use an\n    xsi:type as an attribute on an entity. This can be read but if\n    written again it will become an XML child element. This is\n    semantically identical but cannot be tested with a round trip.\n    \"\"\"\n    # Example 4.\n    xml_string = \"\"\"\n    <prov:document\n        xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n        xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n        xmlns:prov=\"http://www.w3.org/ns/prov#\"\n        xmlns:ex=\"http://example.com/ns/ex#\"\n        xmlns:tr=\"http://example.com/ns/tr#\">\n\n      <prov:entity prov:id=\"tr:WD-prov-dm-20111215\" xsi:type=\"prov:Plan\">\n        <prov:type xsi:type=\"xsd:QName\">ex:Workflow</prov:type>\n      </prov:entity>\n\n    </prov:document>\n    \"\"\"\n    with io.StringIO() as xml:\n        xml.write(xml_string)\n        xml.seek(0, 0)\n        actual_document = prov.ProvDocument.deserialize(source=xml, format=\"xml\")\n\n    expected_document = prov.ProvDocument()\n    ex_ns = Namespace(*EX_NS)\n    expected_document.add_namespace(ex_ns)\n    expected_document.add_namespace(*EX_TR)\n\n    # The xsi:type attribute is mapped to a proper PROV attribute.\n    expected_document.entity(\n        \"tr:WD-prov-dm-20111215\",\n        (\n            (prov.PROV_TYPE, QualifiedName(ex_ns, \"Workflow\")),\n            (prov.PROV_TYPE, PROV[\"Plan\"]),\n        ),\n    )\n\n    self.assertEqual(actual_document, expected_document, \"example_04\")\n\n    # Example 5.\n    xml_string = \"\"\"\n    <prov:document\n      xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n      xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n      xmlns:prov=\"http://www.w3.org/ns/prov#\"\n      xmlns:ex=\"http://example.com/ns/ex#\"\n      xmlns:tr=\"http://example.com/ns/tr#\">\n\n    <prov:entity prov:id=\"tr:WD-prov-dm-20111215\" xsi:type=\"prov:Plan\">\n      <prov:type xsi:type=\"xsd:QName\">ex:Workflow</prov:type>\n      <prov:type xsi:type=\"xsd:QName\">prov:Plan</prov:type> <!-- inferred -->\n      <prov:type xsi:type=\"xsd:QName\">prov:Entity</prov:type> <!-- inferred -->\n    </prov:entity>\n\n    </prov:document>\n    \"\"\"\n    with io.StringIO() as xml:\n        xml.write(xml_string)\n        xml.seek(0, 0)\n        actual_document = prov.ProvDocument.deserialize(source=xml, format=\"xml\")\n\n    expected_document = prov.ProvDocument()\n    expected_document.add_namespace(*EX_NS)\n    expected_document.add_namespace(*EX_TR)\n\n    # The xsi:type attribute is mapped to a proper PROV attribute.\n    expected_document.entity(\n        \"tr:WD-prov-dm-20111215\",\n        (\n            (prov.PROV_TYPE, QualifiedName(ex_ns, \"Workflow\")),\n            (prov.PROV_TYPE, PROV[\"Entity\"]),\n            (prov.PROV_TYPE, PROV[\"Plan\"]),\n        ),\n    )\n\n    self.assertEqual(actual_document, expected_document, \"example_05\")",
    "pattern_analysis": {
      "api_sequence": [
        "io.StringIO",
        "io.StringIO.write",
        "io.StringIO.seek",
        "prov.ProvDocument.deserialize",
        "prov.ProvDocument",
        "prov.ProvDocument.add_namespace",
        "prov.ProvDocument.add_namespace",
        "prov.ProvDocument.entity",
        "self.assertEqual",
        "io.StringIO",
        "io.StringIO.write",
        "io.StringIO.seek",
        "prov.ProvDocument.deserialize",
        "prov.ProvDocument",
        "prov.ProvDocument.add_namespace",
        "prov.ProvDocument.add_namespace",
        "prov.ProvDocument.entity",
        "self.assertEqual"
      ],
      "api_sequence_with_args": [
        "io.StringIO()",
        "io.StringIO.write(xml_string)",
        "io.StringIO.seek(0, 0)",
        "prov.ProvDocument.deserialize(source=xml, format=\"xml\")",
        "prov.ProvDocument()",
        "prov.ProvDocument.add_namespace(ex_ns)",
        "prov.ProvDocument.add_namespace(*EX_TR)",
        "prov.ProvDocument.entity(\"tr:WD-prov-dm-20111215\", ((prov.PROV_TYPE, QualifiedName(ex_ns, \"Workflow\")), (prov.PROV_TYPE, PROV[\"Plan\"])))",
        "self.assertEqual(actual_document, expected_document, \"example_04\")",
        "io.StringIO()",
        "io.StringIO.write(xml_string)",
        "io.StringIO.seek(0, 0)",
        "prov.ProvDocument.deserialize(source=xml, format=\"xml\")",
        "prov.ProvDocument()",
        "prov.ProvDocument.add_namespace(*EX_NS)",
        "prov.ProvDocument.add_namespace(*EX_TR)",
        "prov.ProvDocument.entity(\"tr:WD-prov-dm-20111215\", ((prov.PROV_TYPE, QualifiedName(ex_ns, \"Workflow\")), (prov.PROV_TYPE, PROV[\"Entity\"]), (prov.PROV_TYPE, PROV[\"Plan\"])))",
        "self.assertEqual(actual_document, expected_document, \"example_05\")"
      ],
      "mapped_sequence": [
        {
          "api_name": "io.StringIO",
          "id": "create_memory_bytes",
          "description": "Creates in-memory bytes buffer from encoded string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "io.StringIO.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "io.StringIO.seek",
          "id": "move_buffer_pointer",
          "description": "Moves buffer pointer to start",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "prov.ProvDocument.deserialize",
          "id": "deserialize_from_bytes",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "prov.ProvDocument",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "prov.ProvDocument.add_namespace",
          "id": "init_config_class",
          "description": "Initializes Config class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "prov.ProvDocument.add_namespace",
          "id": "init_config_class",
          "description": "Initializes Config class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "prov.ProvDocument.entity",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "self.assertEqual",
          "id": "error_handling_operations",
          "description": "File opening operations with error handling (ignore errors, custom error handling, etc.)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "io.StringIO",
          "id": "create_memory_bytes",
          "description": "Creates in-memory bytes buffer from encoded string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "io.StringIO.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "io.StringIO.seek",
          "id": "move_buffer_pointer",
          "description": "Moves buffer pointer to start",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "byte_encoding"
        },
        {
          "api_name": "prov.ProvDocument.deserialize",
          "id": "deserialize_from_bytes",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "prov.ProvDocument",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "prov.ProvDocument.add_namespace",
          "id": "init_config_class",
          "description": "Initializes Config class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "prov.ProvDocument.add_namespace",
          "id": "init_config_class",
          "description": "Initializes Config class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "prov.ProvDocument.entity",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "self.assertEqual",
          "id": "error_handling_operations",
          "description": "File opening operations with error handling (ignore errors, custom error handling, etc.)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        }
      ],
      "contextual_code": "with io.StringIO() as xml:\n    xml.write(xml_string)\n    xml.seek(0, 0)\n    actual_document = prov.ProvDocument.deserialize(source=xml, format=\"xml\")\n\nexpected_document = prov.ProvDocument()\nex_ns = Namespace(*EX_NS)\nexpected_document.add_namespace(ex_ns)\nexpected_document.add_namespace(*EX_TR)\nexpected_document.entity(\n    \"tr:WD-prov-dm-20111215\",\n    (\n        (prov.PROV_TYPE, QualifiedName(ex_ns, \"Workflow\")),\n        (prov.PROV_TYPE, PROV[\"Plan\"]),\n    ),\n)\nself.assertEqual(actual_document, expected_document, \"example_04\")\n\nwith io.StringIO() as xml:\n    xml.write(xml_string)\n    xml.seek(0, 0)\n    actual_document = prov.ProvDocument.deserialize(source=xml, format=\"xml\")\n\nexpected_document = prov.ProvDocument()\nexpected_document.add_namespace(*EX_NS)\nexpected_document.add_namespace(*EX_TR)\nexpected_document.entity(\n    \"tr:WD-prov-dm-20111215\",\n    (\n        (prov.PROV_TYPE, QualifiedName(ex_ns, \"Workflow\")),\n        (prov.PROV_TYPE, PROV[\"Entity\"]),\n        (prov.PROV_TYPE, PROV[\"Plan\"]),\n    ),\n)\nself.assertEqual(actual_document, expected_document, \"example_05\")"
    }
  }
]