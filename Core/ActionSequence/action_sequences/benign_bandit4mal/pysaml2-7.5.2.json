[
  {
    "metadata": {
      "package_name": "pysaml2-7.5.2",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "mdstore.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pysaml2-7.5.2/pysaml2-7.5.2/src/saml2/mdstore.py",
    "line_number": "1588",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1587\t            }\n1588\t            for elem in md.get(\"extensions\", {}).get(\"extension_elements\", [])\n1589\t            if elem.get(\"__class__\") == classnames[\"shibmd_scope\"]",
    "code_snippet": "def shibmd_scopes(self, entity_id, typ=None):\n    try:\n        md = self[entity_id]\n    except KeyError:\n        md = {}\n\n    descriptor_scopes = (\n        {\n            \"regexp\": is_regexp,\n            \"text\": regex_compile(text) if is_regexp else text,\n        }\n        for elem in md.get(\"extensions\", {}).get(\"extension_elements\", [])\n        if elem.get(\"__class__\") == classnames[\"shibmd_scope\"]\n        for is_regexp, text in [\n            (elem.get(\"regexp\", \"\").lower() == \"true\", elem.get(\"text\", \"\")),\n        ]\n    )\n\n    services_of_type = md.get(typ) or []\n    services_of_type_scopes = (\n        {\n            \"regexp\": is_regexp,\n            \"text\": regex_compile(text) if is_regexp else text,\n        }\n        for srv in services_of_type\n        for elem in srv.get(\"extensions\", {}).get(\"extension_elements\", [])\n        if elem.get(\"__class__\") == classnames[\"shibmd_scope\"]\n        for is_regexp, text in [\n            (elem.get(\"regexp\", \"\").lower() == \"true\", elem.get(\"text\", \"\")),\n        ]\n    )\n\n    scopes = chain(descriptor_scopes, services_of_type_scopes)\n    return scopes",
    "pattern_analysis": {
      "api_sequence": [
        "dict.get",
        "dict.get",
        "dict.get",
        "dict.get",
        "dict.get",
        "dict.get",
        "dict.get"
      ],
      "api_sequence_with_args": [
        "md.get(\"extensions\", {})",
        "md.get(\"extensions\", {}).get(\"extension_elements\", [])",
        "elem.get(\"__class__\")",
        "elem.get(\"regexp\", \"\")",
        "elem.get(\"text\", \"\")",
        "srv.get(\"extensions\", {})",
        "srv.get(\"extensions\", {}).get(\"extension_elements\", [])"
      ],
      "mapped_sequence": [
        {
          "api_name": "dict.get",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        }
      ],
      "contextual_code": "def shibmd_scopes(self, entity_id, typ=None):\n    try:\n        md = self[entity_id]\n    except KeyError:\n        md = {}\n\n    descriptor_scopes = (\n        {\n            \"regexp\": is_regexp,\n            \"text\": regex_compile(text) if is_regexp else text,\n        }\n        for elem in md.get(\"extensions\", {}).get(\"extension_elements\", [])\n        if elem.get(\"__class__\") == classnames[\"shibmd_scope\"]\n        for is_regexp, text in [\n            (elem.get(\"regexp\", \"\").lower() == \"true\", elem.get(\"text\", \"\")),\n        ]\n    )\n\n    services_of_type = md.get(typ) or []\n    services_of_type_scopes = (\n        {\n            \"regexp\": is_regexp,\n            \"text\": regex_compile(text) if is_regexp else text,\n        }\n        for srv in services_of_type\n        for elem in srv.get(\"extensions\", {}).get(\"extension_elements\", [])\n        if elem.get(\"__class__\") == classnames[\"shibmd_scope\"]\n        for is_regexp, text in [\n            (elem.get(\"regexp\", \"\").lower() == \"true\", elem.get(\"text\", \"\")),\n        ]\n    )\n\n    scopes = chain(descriptor_scopes, services_of_type_scopes)\n    return scopes"
    }
  }
]