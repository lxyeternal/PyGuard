[
  {
    "metadata": {
      "package_name": "pyfakefs-5.8.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "fake_filesystem_test.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pyfakefs-5.8.0/pyfakefs-5.8.0/pyfakefs/tests/fake_filesystem_test.py",
    "line_number": "2631",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "2630\t        with fake_open(\"/a/b/file_one\", \"w\", encoding=\"utf8\") as handle:\n2631\t            handle.write(\"foo\")\n2632\t        self.assertTrue(self.side_effect_called)",
    "code_snippet": "class FileSideEffectTests(TestCase):\n    def side_effect(self):\n        test_case = self\n        test_case.side_effect_called = False\n\n        def __side_effect(file_object):\n            test_case.side_effect_called = True\n            test_case.side_effect_file_object_content = file_object.contents\n\n        return __side_effect\n\n    def setUp(self):\n        # use the real path separator to work with the real file system\n        self.filesystem = fake_filesystem.FakeFilesystem()\n        self.filesystem.create_file(\"/a/b/file_one\", side_effect=self.side_effect())\n\n    def test_side_effect_called(self):\n        fake_open = fake_filesystem.FakeFileOpen(self.filesystem)\n        self.side_effect_called = False\n        with fake_open(\"/a/b/file_one\", \"w\", encoding=\"utf8\") as handle:\n            handle.write(\"foo\")\n        self.assertTrue(self.side_effect_called)\n",
    "pattern_analysis": {
      "api_sequence": [
        "fake_filesystem.FakeFilesystem",
        "fake_filesystem.FakeFilesystem.create_file",
        "fake_filesystem.FakeFileOpen",
        "fake_filesystem.FakeFileOpen.__call__",
        "fake_filesystem.FakeFileOpen.__enter__",
        "fake_filesystem.FakeFileOpen.write",
        "fake_filesystem.FakeFileOpen.__exit__"
      ],
      "api_sequence_with_args": [
        "fake_filesystem.FakeFilesystem()",
        "fake_filesystem.FakeFilesystem.create_file(\"/a/b/file_one\", side_effect=self.side_effect())",
        "fake_filesystem.FakeFileOpen(self.filesystem)",
        "fake_filesystem.FakeFileOpen.__call__(\"/a/b/file_one\", \"w\", encoding=\"utf8\")",
        "fake_filesystem.FakeFileOpen.__enter__()",
        "fake_filesystem.FakeFileOpen.write(\"foo\")",
        "fake_filesystem.FakeFileOpen.__exit__()"
      ],
      "mapped_sequence": [
        {
          "api_name": "fake_filesystem.FakeFilesystem.create_file",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "fake_filesystem.FakeFileOpen",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "fake_filesystem.FakeFileOpen.__call__",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "fake_filesystem.FakeFileOpen.__enter__",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "fake_filesystem.FakeFileOpen.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "fake_filesystem.FakeFileOpen.__exit__",
          "id": "close_file",
          "description": "Closes the opened file",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_closing"
        }
      ],
      "contextual_code": "class FileSideEffectTests(TestCase):\n    def side_effect(self):\n        test_case = self\n        test_case.side_effect_called = False\n\n        def __side_effect(file_object):\n            test_case.side_effect_called = True\n            test_case.side_effect_file_object_content = file_object.contents\n\n        return __side_effect\n\n    def setUp(self):\n        self.filesystem = fake_filesystem.FakeFilesystem()\n        self.filesystem.create_file(\"/a/b/file_one\", side_effect=self.side_effect())\n\n    def test_side_effect_called(self):\n        fake_open = fake_filesystem.FakeFileOpen(self.filesystem)\n        self.side_effect_called = False\n        with fake_open(\"/a/b/file_one\", \"w\", encoding=\"utf8\") as handle:\n            handle.write(\"foo\")\n"
    }
  }
]