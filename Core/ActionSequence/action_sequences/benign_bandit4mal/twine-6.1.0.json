[
  {
    "metadata": {
      "package_name": "twine-6.1.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "utils.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/twine-6.1.0/twine-6.1.0/twine/utils.py",
    "line_number": "276",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "275\n276\t    elif config.get(key) is not None:\n277\t        logger.info(f\"{key} set from config file\")",
    "code_snippet": "def get_userpass_value(\n    cli_value: Optional[str],\n    config: RepositoryConfig,\n    key: str,\n    prompt_strategy: Optional[Callable[[], str]] = None,\n) -> Optional[str]:\n    \"\"\"Get a credential (e.g. a username or password) from the configuration.\n\n    Uses the following rules:\n\n    1. If ``cli_value`` is specified, use that.\n    2. If ``config[key]`` is specified, use that.\n    3. If ``prompt_strategy`` is specified, use its return value.\n    4. Otherwise return ``None``\n\n    :param cli_value:\n        The value supplied from the command line.\n    :param config:\n        A dictionary of repository configuration values.\n    :param key:\n        The credential to look up in ``config``, e.g. ``\"username\"`` or ``\"password\"``.\n    :param prompt_strategy:\n        An argumentless function to get the value, e.g. from keyring or by prompting\n        the user.\n\n    :return:\n        The credential value, i.e. the username or password.\n    \"\"\"\n    if cli_value is not None:\n        logger.info(f\"{key} set by command options\")\n        return cli_value\n\n    elif config.get(key) is not None:\n        logger.info(f\"{key} set from config file\")\n        return config[key]\n\n    elif prompt_strategy:\n        warning = \"\"\n        value = prompt_strategy()\n\n        if not value:\n            warning = f\"Your {key} is empty\"\n        elif any(unicodedata.category(c).startswith(\"C\") for c in value):\n            # See https://www.unicode.org/reports/tr44/#General_Category_Values\n            # Most common case is \"\\x16\" when pasting in Windows Command Prompt\n            warning = f\"Your {key} contains control characters\"\n\n        if warning:\n            logger.warning(f\"{warning}. Did you enter it correctly?\")\n            logger.warning(\n                \"See https://twine.readthedocs.io/#entering-credentials \"\n                \"for more information.\"\n            )\n\n        return value\n\n    else:\n        return None",
    "pattern_analysis": {
      "api_sequence": [
        "logger.info",
        "logger.info",
        "prompt_strategy",
        "unicodedata.category",
        "logger.warning",
        "logger.warning"
      ],
      "api_sequence_with_args": [
        "logger.info(f\"{key} set by command options\")",
        "logger.info(f\"{key} set from config file\")",
        "prompt_strategy()",
        "unicodedata.category(c)",
        "logger.warning(f\"{warning}. Did you enter it correctly?\")",
        "logger.warning(\"See https://twine.readthedocs.io/#entering-credentials for more information.\")"
      ],
      "mapped_sequence": [
        {
          "api_name": "logger.info",
          "id": "log_info",
          "description": "Logs informational message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "logger.info",
          "id": "log_info",
          "description": "Logs informational message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "prompt_strategy",
          "id": "read_user_input",
          "description": "Reads user input from standard input",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "unicodedata.category",
          "id": "check_instance_type",
          "description": "Checks if object is instance of specified type",
          "first_id": "utility_functions",
          "second_id": "logging_exception_handling",
          "third_id": "exception_checking"
        },
        {
          "api_name": "logger.warning",
          "id": "log_error",
          "description": "Logs error message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "logger.warning",
          "id": "log_error",
          "description": "Logs error message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        }
      ],
      "contextual_code": "def get_userpass_value(\n    cli_value: Optional[str],\n    config: RepositoryConfig,\n    key: str,\n    prompt_strategy: Optional[Callable[[], str]] = None,\n) -> Optional[str]:\n    if cli_value is not None:\n        logger.info(f\"{key} set by command options\")\n        return cli_value\n\n    elif config.get(key) is not None:\n        logger.info(f\"{key} set from config file\")\n        return config[key]\n\n    elif prompt_strategy:\n        warning = \"\"\n        value = prompt_strategy()\n\n        if not value:\n            warning = f\"Your {key} is empty\"\n        elif any(unicodedata.category(c).startswith(\"C\") for c in value):\n            warning = f\"Your {key} contains control characters\"\n\n        if warning:\n            logger.warning(f\"{warning}. Did you enter it correctly?\")\n            logger.warning(\n                \"See https://twine.readthedocs.io/#entering-credentials \"\n                \"for more information.\"\n            )\n\n        return value\n\n    else:\n        return None"
    }
  }
]