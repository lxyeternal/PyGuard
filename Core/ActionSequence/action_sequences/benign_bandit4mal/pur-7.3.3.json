[
  {
    "metadata": {
      "package_name": "pur-7.3.3",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "util.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pur-7.3.3/pur-7.3.3/pur/packages/pip/_vendor/distlib/util.py",
    "line_number": "1592",
    "type_description": "B834:open",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "1591\t        else:\n1592\t            self.stream = _csv_open(kwargs['path'], 'r')\n1593\t        self.reader = csv.reader(self.stream, **self.defaults)",
    "code_snippet": "class CSVReader(CSVBase):\n    def __init__(self, **kwargs):\n        if 'stream' in kwargs:\n            stream = kwargs['stream']\n            if sys.version_info[0] >= 3:\n                # needs to be a text stream\n                stream = codecs.getreader('utf-8')(stream)\n            self.stream = stream\n        else:\n            self.stream = _csv_open(kwargs['path'], 'r')\n        self.reader = csv.reader(self.stream, **self.defaults)\n\n    def __iter__(self):\n        return self\n\n    def next(self):\n        result = next(self.reader)\n        if sys.version_info[0] < 3:\n            for i, item in enumerate(result):\n                if not isinstance(item, text_type):\n                    result[i] = item.decode('utf-8')\n        return result\n\n    __next__ = next",
    "pattern_analysis": {
      "api_sequence": [
        "sys.version_info",
        "codecs.getreader",
        "_csv_open",
        "csv.reader",
        "next",
        "sys.version_info",
        "isinstance",
        "decode"
      ],
      "api_sequence_with_args": [
        "sys.version_info[0]",
        "codecs.getreader('utf-8')(stream)",
        "_csv_open(kwargs['path'], 'r')",
        "csv.reader(self.stream, **self.defaults)",
        "next(self.reader)",
        "sys.version_info[0]",
        "isinstance(item, text_type)",
        "item.decode('utf-8')"
      ],
      "mapped_sequence": [
        {
          "api_name": "_csv_open",
          "id": "basic_read_operations",
          "description": "ic file opening operations for reading (normal reading, binary reading)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "csv.reader",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        }
      ],
      "contextual_code": "class CSVReader(CSVBase):\n    def __init__(self, **kwargs):\n        if 'stream' in kwargs:\n            stream = kwargs['stream']\n            if sys.version_info[0] >= 3:\n                # needs to be a text stream\n                stream = codecs.getreader('utf-8')(stream)\n            self.stream = stream\n        else:\n            self.stream = _csv_open(kwargs['path'], 'r')\n        self.reader = csv.reader(self.stream, **self.defaults)"
    }
  }
]