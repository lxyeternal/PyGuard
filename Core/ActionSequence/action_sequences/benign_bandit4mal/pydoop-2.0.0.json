[
  {
    "metadata": {
      "package_name": "pydoop-2.0.0",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "common_hdfs_tests.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pydoop-2.0.0/pydoop-2.0.0/test/hdfs/common_hdfs_tests.py",
    "line_number": "68",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "67\t            while i < len(content):\n68\t                bytes_written += fo.write(content[i: i + bufsize])\n69\t                i += bufsize",
    "code_snippet": "def _make_random_file(self, where=None, content=None, **kwargs):\n    kwargs[\"mode\"] = \"w\"\n    content = content or utils.make_random_data(printable=True)\n    path = self._make_random_path(where=where)\n    with self.fs.open_file(path, **kwargs) as fo:\n        i = 0\n        bytes_written = 0\n        bufsize = 24 * 1024 * 1024\n        while i < len(content):\n            bytes_written += fo.write(content[i: i + bufsize])\n            i += bufsize\n\n    self.assertEqual(bytes_written, len(content))\n    return path",
    "pattern_analysis": {
      "api_sequence": [
        "utils.make_random_data",
        "self._make_random_path",
        "self.fs.open_file",
        "fo.write"
      ],
      "api_sequence_with_args": [
        "utils.make_random_data(printable=True)",
        "self._make_random_path(where=where)",
        "self.fs.open_file(path, **kwargs)",
        "fo.write(content[i: i + bufsize])"
      ],
      "mapped_sequence": [
        {
          "api_name": "utils.make_random_data",
          "id": "init_encrypter_class",
          "description": "Instantiates Encrypter class",
          "first_id": "encryption_hashing",
          "second_id": "encryption_operations",
          "third_id": "encryption_initialization"
        },
        {
          "api_name": "self._make_random_path",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "self.fs.open_file",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "fo.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        }
      ],
      "contextual_code": "def _make_random_file(self, where=None, content=None, **kwargs):\n    kwargs[\"mode\"] = \"w\"\n    content = content or utils.make_random_data(printable=True)\n    path = self._make_random_path(where=where)\n    with self.fs.open_file(path, **kwargs) as fo:\n        i = 0\n        bytes_written = 0\n        bufsize = 24 * 1024 * 1024\n        while i < len(content):\n            bytes_written += fo.write(content[i: i + bufsize])\n            i += bufsize"
    }
  }
]