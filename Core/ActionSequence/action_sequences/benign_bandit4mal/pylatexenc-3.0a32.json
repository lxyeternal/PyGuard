[
  {
    "metadata": {
      "package_name": "pylatexenc-3.0a32",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "__main__.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pylatexenc-3.0a32/pylatexenc-3.0a32/pylatexenc/latex2text/__main__.py",
    "line_number": "184",
    "type_description": "B833:input",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "183\t    else:\n184\t        for line in fileinput.input(files=args.files):\n185\t            latex += line",
    "code_snippet": "def main(argv=None):\n\n    if argv is None:\n        argv = sys.argv[1:]\n\n    parser = argparse.ArgumentParser(prog='latex2text', add_help=False)\n\n    codegroup = parser.add_argument_group(\"Input options\")\n\n    codegroup.add_argument('--code', '-c', action='store', default=None, metavar=\"LATEX_CODE\",\n                           help=\"Convert the given LATEX_CODE to unicode text instead \"\n                           \"of reading from FILE or standard input.  You cannot specify \"\n                           \"FILEs if you use this option, and any standard input is ignored.\")\n\n\n    codegroup.add_argument('--no-final-newline', '-n',\n                           action='store_true', default=False,\n                           help=\"Do not print a newline after the converted text.\")\n\n\n    codegroup.add_argument('files', metavar=\"FILE\", nargs='*',\n                           help=\"Input files to read LaTeX code from. If no FILE(s) \"\n                           \"is/are specified, LaTeX code is read from standard input \"\n                           \"unless --code is specified\")\n\n\n\n    group = parser.add_argument_group(\"LatexWalker options\")\n\n    group.add_argument('--parser-keep-inline-math', action='store_const', const=True,\n                       dest='parser_keep_inline_math', default=None,\n                       help=argparse.SUPPRESS)\n    group.add_argument('--no-parser-keep-inline-math', action='store_const', const=False,\n                       dest='parser_keep_inline_math',\n                       help=argparse.SUPPRESS)\n\n    group.add_argument('--tolerant-parsing', action='store_const', const=True,\n                       dest='tolerant_parsing', default=True)\n    group.add_argument('--no-tolerant-parsing', action='store_const', const=False,\n                       dest='tolerant_parsing',\n                       help=\"Tolerate syntax errors when parsing, and attempt to continue (default yes)\")\n\n    # I'm not sure this flag is useful and if it should be exposed at all.\n    # Accept it, but make it hidden.\n    parser.add_argument('--strict-braces', action='store_const', const=True,\n                        dest='strict_braces', default=False,\n                        help=argparse.SUPPRESS)\n    parser.add_argument('--no-strict-braces', action='store_const', const=False,\n                        dest='strict_braces',\n                        #help=\"Report errors for mismatching LaTeX braces (default no)\"\n                        help=argparse.SUPPRESS)\n\n    group = parser.add_argument_group(\"LatexNodes2Text options\")\n\n    group.add_argument('--text-keep-inline-math', action='store_const', const=True,\n                       dest='text_keep_inline_math', default=None,\n                       help=argparse.SUPPRESS)\n    group.add_argument('--no-text-keep-inline-math', action='store_const', const=False,\n                       dest='text_keep_inline_math',\n                       help=argparse.SUPPRESS)\n\n    group.add_argument('--math-mode', action='store', dest='math_mode',\n                       choices=['text', 'with-delimiters', 'verbatim', 'remove'],\n                       default='text',\n                       help=\"How to handle chunks of math mode LaTeX code. 'text' = convert \"\n                       \"to text like the rest; 'with-delimiters' = same as 'text' but retain \"\n                       \"the original math mode delimiters; 'verbatim' = keep verbatim LaTeX code; \"\n                       \"'remove' = remove from input entirely\")\n\n    group.add_argument('--fill-text', dest='fill_text', action='store', nargs='?',\n                       default=-1,\n                       help=\"Attempt to wrap text to the given width, or 80 columns if option is \"\n                       \"specified with no argument\")\n\n    group.add_argument('--keep-comments', action='store_const', const=True,\n                       dest='keep_comments', default=False)\n    group.add_argument('--no-keep-comments', action='store_const', const=False,\n                       dest='keep_comments',\n                       help=\"Keep LaTeX comments in text output (default no)\")\n\n    class ListWithHiddenItems(list):\n        def __init__(self, thelist, hiddenitems):\n            super(ListWithHiddenItems, self).__init__(thelist)\n            self.hiddenitems = hiddenitems\n        def __contains__(self, value):\n            return super(ListWithHiddenItems, self).__contains__(value) \\\n                or value in self.hiddenitems\n\n    strict_latex_spaces_choices = ListWithHiddenItems(\n        # the list\n        ['off', 'on']+list(k for k in _strict_latex_spaces_predef.keys() if k != 'default'),\n        # hidden items: Value is accepted, but not shown in list of choices\n        ['default']\n    )\n    group.add_argument('--strict-latex-spaces', choices=strict_latex_spaces_choices,\n                       dest='strict_latex_spaces', default='macros',\n                       help=\"How to handle whitespace. See documentation for the class \"\n                       \"LatexNodes2Text().\")\n\n    group.add_argument('--keep-braced-groups', action='store_const', const=True,\n                       dest='keep_braced_groups', default=False)\n    group.add_argument('--no-keep-braced-groups', action='store_const', const=False,\n                       dest='keep_braced_groups',\n                       help=\"Keep LaTeX {braced groups} in text output (default no)\")\n\n    group.add_argument('--keep-braced-groups-minlen', type=int, default=2,\n                       dest='keep_braced_groups_minlen',\n                       help=\"Only apply --keep-braced-groups to groups that contain at least \"\n                       \"this many characters\")\n\n    group = parser.add_argument_group(\"General options\")\n\n    group.add_argument('-q', '--quiet', dest='logging_level', action='store_const',\n                       const=logging.ERROR, default=logging.INFO,\n                       help=\"Suppress warning messages\")\n    group.add_argument('-v', '--verbose', dest='logging_level', action='store_const',\n                       const=logging.DEBUG,\n                       help=\"Verbose output\")\n    group.add_argument('--version', action='version',\n                       version='pylatexenc {}'.format(version_str),\n                       help=\"Show version information and exit\")\n    group.add_argument('--help', action='help',\n                       help=\"Show this help information and exit\")\n\n    args = parser.parse_args(argv)\n\n    logging.basicConfig()\n    logging.getLogger().setLevel(args.logging_level)\n    logger = logging.getLogger(__name__)\n\n\n    if args.parser_keep_inline_math is not None or args.text_keep_inline_math is not None:\n        logger.warning(\"Options --parser-keep-inline-math and --text-keep-inline-math are \"\n                       \"deprecated and no longer have any effect.  Please use \"\n                       \"--math-mode=... instead.\")\n\n    latex = ''\n    if args.code:\n        if args.files:\n            logger.error(\"Cannot specify both FILEs and --code option. \"\n                         \"Use --help option for more information.\")\n            sys.exit(1)\n        latex = args.code\n    else:\n        for line in fileinput.input(files=args.files):\n            latex += line\n\n    if args.fill_text != -1:\n        if args.fill_text is not None and len(args.fill_text):\n            fill_text = int(args.fill_text)\n        else:\n            fill_text = True\n    else:\n        fill_text = None\n\n    lw = latexwalker.LatexWalker(latex,\n                                 tolerant_parsing=args.tolerant_parsing,\n                                 strict_braces=args.strict_braces)\n\n    nodelist, _ = lw.parse_content(latexnodes_parsers.LatexGeneralNodesParser())\n\n    #(nodelist, pos, len_) = lw.get_latex_nodes()\n\n    ln2t = LatexNodes2Text(math_mode=args.math_mode,\n                           keep_comments=args.keep_comments,\n                           strict_latex_spaces=args.strict_latex_spaces,\n                           keep_braced_groups=args.keep_braced_groups,\n                           keep_braced_groups_minlen=args.keep_braced_groups_minlen,\n                           fill_text=fill_text)\n\n    print_kwargs = {}\n    if args.no_final_newline:\n        print_kwargs['end'] = ''\n\n    print(ln2t.nodelist_to_text(nodelist), **print_kwargs)\n",
    "pattern_analysis": {
      "api_sequence": [
        "sys.argv",
        "argparse.ArgumentParser",
        "argparse.ArgumentParser.add_argument_group",
        "argparse.ArgumentParser.add_argument",
        "fileinput.input",
        "logging.basicConfig",
        "logging.getLogger",
        "logging.getLogger.setLevel",
        "logging.getLogger",
        "sys.exit",
        "latexwalker.LatexWalker",
        "latexwalker.LatexWalker.parse_content",
        "LatexNodes2Text",
        "LatexNodes2Text.nodelist_to_text",
        "print"
      ],
      "api_sequence_with_args": [
        "sys.argv",
        "argparse.ArgumentParser(prog='latex2text', add_help=False)",
        "argparse.ArgumentParser.add_argument_group('Input options')",
        "argparse.ArgumentParser.add_argument('--code', '-c', action='store', default=None, metavar='LATEX_CODE', help=...)",
        "fileinput.input(files=args.files)",
        "logging.basicConfig()",
        "logging.getLogger()",
        "logging.getLogger().setLevel(args.logging_level)",
        "logging.getLogger(__name__)",
        "sys.exit(1)",
        "latexwalker.LatexWalker(latex, tolerant_parsing=args.tolerant_parsing, strict_braces=args.strict_braces)",
        "latexwalker.LatexWalker.parse_content(latexnodes_parsers.LatexGeneralNodesParser())",
        "LatexNodes2Text(math_mode=args.math_mode, keep_comments=args.keep_comments, strict_latex_spaces=args.strict_latex_spaces, keep_braced_groups=args.keep_braced_groups, keep_braced_groups_minlen=args.keep_braced_groups_minlen, fill_text=fill_text)",
        "LatexNodes2Text.nodelist_to_text(nodelist)",
        "print(LatexNodes2Text.nodelist_to_text(nodelist), **print_kwargs)"
      ],
      "mapped_sequence": [
        {
          "api_name": "sys.argv",
          "id": "get_cmd_args",
          "description": "Retrieves command-line arguments passed to script",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "argparse.ArgumentParser",
          "id": "read_user_input",
          "description": "Reads user input from standard input",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "argparse.ArgumentParser.add_argument_group",
          "id": "read_user_input",
          "description": "Reads user input from standard input",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "argparse.ArgumentParser.add_argument",
          "id": "read_user_input",
          "description": "Reads user input from standard input",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "fileinput.input",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "logging.basicConfig",
          "id": "log_info",
          "description": "Logs informational message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "logging.getLogger",
          "id": "log_info",
          "description": "Logs informational message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "logging.getLogger.setLevel",
          "id": "log_info",
          "description": "Logs informational message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "logging.getLogger",
          "id": "log_info",
          "description": "Logs informational message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "sys.exit",
          "id": "exit_program",
          "description": "Exits program with specified status code",
          "first_id": "system_operations",
          "second_id": "process_management",
          "third_id": "process_control"
        },
        {
          "api_name": "latexwalker.LatexWalker",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "latexwalker.LatexWalker.parse_content",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "LatexNodes2Text",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "LatexNodes2Text.nodelist_to_text",
          "id": "init_parent_class",
          "description": "Initializes parent class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "print",
          "id": "log_info",
          "description": "Logs informational message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        }
      ],
      "contextual_code": "def main(argv=None):\n    if argv is None:\n        argv = sys.argv[1:]\n    parser = argparse.ArgumentParser(prog='latex2text', add_help=False)\n    codegroup = parser.add_argument_group(\"Input options\")\n    codegroup.add_argument('--code', '-c', action='store', default=None, metavar=\"LATEX_CODE\", help=...)\n    codegroup.add_argument('files', metavar=\"FILE\", nargs='*', help=...)\n    args = parser.parse_args(argv)\n    logging.basicConfig()\n    logging.getLogger().setLevel(args.logging_level)\n    logger = logging.getLogger(__name__)\n    if args.code:\n        if args.files:\n            logger.error(\"Cannot specify both FILEs and --code option. ...\")\n            sys.exit(1)\n        latex = args.code\n    else:\n        for line in fileinput.input(files=args.files):\n            latex += line\n    lw = latexwalker.LatexWalker(latex, tolerant_parsing=args.tolerant_parsing, strict_braces=args.strict_braces)\n    nodelist, _ = lw.parse_content(latexnodes_parsers.LatexGeneralNodesParser())\n    ln2t = LatexNodes2Text(math_mode=args.math_mode, keep_comments=args.keep_comments, strict_latex_spaces=args.strict_latex_spaces, keep_braced_groups=args.keep_braced_groups, keep_braced_groups_minlen=args.keep_braced_groups_minlen, fill_text=fill_text)\n    print_kwargs = {}\n    if args.no_final_newline:\n        print_kwargs['end'] = ''\n    print(ln2t.nodelist_to_text(nodelist), **print_kwargs)"
    }
  }
]