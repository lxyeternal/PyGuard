[
  {
    "metadata": {
      "package_name": "mlrun-1.9.0rc3-py3-none-any",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:40"
    }
  },
  {
    "pyfile": "packagers_manager.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/package/packagers_manager.py",
    "line_number": "358",
    "type_description": "B836:rmtree",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "357\t                if os.path.isdir(path):\n358\t                    shutil.rmtree(path)\n359\t                else:",
    "code_snippet": "def clear_packagers_outputs(self):\n    \"\"\"\n    Clear the outputs of all packagers. This method should be called at the end of the run, only after logging all\n    artifacts, to ensure that files that require uploading have already been uploaded.\n    \"\"\"\n    for packager in self._get_packagers_with_default_packager():\n        for path in packager.future_clearing_path_list:\n            if not os.path.exists(path):\n                continue\n            if os.path.isdir(path):\n                shutil.rmtree(path)\n            else:\n                os.remove(path)\n        packager.future_clearing_path_list.clear()",
    "pattern_analysis": {
      "api_sequence": [
        "os.path.exists",
        "os.path.isdir",
        "shutil.rmtree",
        "os.remove"
      ],
      "api_sequence_with_args": [
        "os.path.exists(path)",
        "os.path.isdir(path)",
        "shutil.rmtree(path)",
        "os.remove(path)"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "os.path.isdir",
          "id": "check_directory_exists",
          "description": "Checks if specified path exists and is a directory",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "shutil.rmtree",
          "id": "delete_directory",
          "description": "Recursively deletes directory and its contents",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "directory_operations"
        },
        {
          "api_name": "os.remove",
          "id": "delete_file",
          "description": "Deletes specified file from filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_transfer"
        }
      ],
      "contextual_code": "for packager in self._get_packagers_with_default_packager():\n    for path in packager.future_clearing_path_list:\n        if not os.path.exists(path):\n            continue\n        if os.path.isdir(path):\n            shutil.rmtree(path)\n        else:\n            os.remove(path)"
    }
  }
]