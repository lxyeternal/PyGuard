[
  {
    "metadata": {
      "package_name": "agilicus-1.286.0",
      "total_matches": 2,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "hash.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/agilicus-1.286.0/agilicus-1.286.0/agilicus/hash.py",
    "line_number": "10",
    "type_description": "B802:b64encode",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "9\t    binary_string = binascii.unhexlify(hexbytes)\n10\t    return base64.b64encode(binary_string)",
    "code_snippet": "import base64\nimport binascii\nimport hashlib\nimport pathlib\n\ndef get_base64_md5(filename):\n    hexbytes = hashlib.md5(pathlib.Path(filename).read_bytes()).hexdigest()\n    binary_string = binascii.unhexlify(hexbytes)\n    return base64.b64encode(binary_string)\n",
    "pattern_analysis": {
      "api_sequence": [
        "pathlib.Path",
        "pathlib.Path.read_bytes",
        "hashlib.md5",
        "hashlib.md5.hexdigest",
        "binascii.unhexlify",
        "base64.b64encode"
      ],
      "api_sequence_with_args": [
        "pathlib.Path(filename)",
        "pathlib.Path(filename).read_bytes()",
        "hashlib.md5(pathlib.Path(filename).read_bytes())",
        "hashlib.md5(pathlib.Path(filename).read_bytes()).hexdigest()",
        "binascii.unhexlify(hexbytes)",
        "base64.b64encode(binary_string)"
      ],
      "mapped_sequence": [
        {
          "api_name": "pathlib.Path",
          "id": "path_object_operations",
          "description": "Path object and status operations (creating Path objects, retrieving file status)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "pathlib.Path.read_bytes",
          "id": "basic_file_reading",
          "description": "Reading content from files (by lines or entire content)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_reading"
        },
        {
          "api_name": "hashlib.md5",
          "id": "create_md5_hash",
          "description": "Creates MD5 hash object from encoded hostname",
          "first_id": "encryption_hashing",
          "second_id": "hash_calculation",
          "third_id": "hash_object_creation"
        },
        {
          "api_name": "hashlib.md5.hexdigest",
          "id": "get_md5_digest",
          "description": "Returns hexadecimal digest of MD5 hash",
          "first_id": "encryption_hashing",
          "second_id": "hash_calculation",
          "third_id": "hash_value_retrieval"
        },
        {
          "api_name": "binascii.unhexlify",
          "id": "decode_base64_to_bytes",
          "description": "Decodes base64-encoded string to bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        },
        {
          "api_name": "base64.b64encode",
          "id": "encode_bytes_to_base64",
          "description": "Encodes bytes to base64-encoded bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "base_encoding"
        }
      ],
      "contextual_code": "import base64\nimport binascii\nimport hashlib\nimport pathlib\n\ndef get_base64_md5(filename):\n    hexbytes = hashlib.md5(pathlib.Path(filename).read_bytes()).hexdigest()\n    binary_string = binascii.unhexlify(hexbytes)\n    return base64.b64encode(binary_string)"
    }
  },
  {
    "pyfile": "main.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/agilicus-1.286.0/agilicus-1.286.0/agilicus/main.py",
    "line_number": "6617",
    "type_description": "B820:get",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "6616\tdef show_forwarder(ctx, **kwargs):\n6617\t    result = forwarders.get(ctx, **kwargs)\n6618\t    output_entry(ctx, result.to_dict())",
    "code_snippet": "@cli.command(name=\"show-forwarder\")\n@click.argument(\"id\")\n@click.option(\"--org-id\", default=None)\n@click.pass_context\ndef show_forwarder(ctx, **kwargs):\n    result = forwarders.get(ctx, **kwargs)\n    output_entry(ctx, result.to_dict())",
    "pattern_analysis": {
      "api_sequence": [
        "forwarders.get",
        "result.to_dict",
        "output_entry"
      ],
      "api_sequence_with_args": [
        "forwarders.get(ctx, **kwargs)",
        "result.to_dict()",
        "output_entry(ctx, result.to_dict())"
      ],
      "mapped_sequence": [
        {
          "api_name": "forwarders.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "result.to_dict",
          "id": "serialize_to_json",
          "description": "Serializes Python object to JSON string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "output_entry",
          "id": "log_info",
          "description": "Logs informational message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        }
      ],
      "contextual_code": "@cli.command(name=\"show-forwarder\")\n@click.argument(\"id\")\n@click.option(\"--org-id\", default=None)\n@click.pass_context\ndef show_forwarder(ctx, **kwargs):\n    result = forwarders.get(ctx, **kwargs)\n    output_entry(ctx, result.to_dict())"
    }
  }
]