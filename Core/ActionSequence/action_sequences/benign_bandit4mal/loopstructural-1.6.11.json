[
  {
    "metadata": {
      "package_name": "loopstructural-1.6.11",
      "total_matches": 1,
      "processing_date": "2025-05-18 01:49:39"
    }
  },
  {
    "pyfile": "exporters.py",
    "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/loopstructural-1.6.11/loopstructural-1.6.11/LoopStructural/export/exporters.py",
    "line_number": "277",
    "type_description": "B815:write",
    "severity": "High",
    "confidence": "Medium",
    "original_snippet": "276\t                fd.write(f\"TRGL {v_map[face[0]]} {v_map[face[1]]} {v_map[face[2]]} \\n\")\n277\t        fd.write(\"END\\n\")\n278\t    return True",
    "code_snippet": "def _write_feat_surfs_gocad(surf, file_name):\n    \"\"\"\n    Writes out a GOCAD TSURF file for each surface in list\n\n    Parameters\n    ----------\n    surf_list: [ SimpleNamespace() ... ]\n        Details of the surfaces, as a list of SimpleNamespace() objects. Fields are:\n            verts: vertices, numpy ndarray with dtype = float64 & shape = (N,3)\n            faces: faces, numpy ndarray with dtype = int32 & shape = (M,3)\n            values: values, numpy ndarray with dtype = float32 & shape = (N,)\n            normals: normals, numpy ndarray with dtype = float32 & shape = (N,3)\n            name: name of feature e.g. fault or supergroup, string\n\n    file_name: string\n        Desired filename\n\n    Returns\n    -------\n    True if successful\n\n    \"\"\"\n    from pathlib import Path\n\n    file_name = Path(file_name).with_suffix(\".ts\")\n    with open(f\"{file_name}\", \"w\") as fd:\n        fd.write(\n            f\"\"\"GOCAD TSurf 1 \nHEADER {{\n*solid*color: #ffa500\nivolmap: false\nimap: false\nname: {surf.name}\n}}\nGOCAD_ORIGINAL_COORDINATE_SYSTEM\nNAME Default\nPROJECTION Unknown\nDATUM Unknown\nAXIS_NAME X Y Z\nAXIS_UNIT m m m\nZPOSITIVE Elevation\nEND_ORIGINAL_COORDINATE_SYSTEM\nGEOLOGICAL_FEATURE {surf.name}\nGEOLOGICAL_TYPE fault\nPROPERTY_CLASS_HEADER X {{\nkind: X\nunit: m\n}}\nPROPERTY_CLASS_HEADER Y {{\nkind: Y\nunit: m\n}}\nPROPERTY_CLASS_HEADER Z {{\nkind: Z\nunit: m\nis_z: on\n}}\nPROPERTY_CLASS_HEADER vector3d {{\nkind: Length\nunit: m\n}}\nTFACE\n\"\"\"\n        )\n        v_idx = 1\n        v_map = {}\n        for idx, vert in enumerate(surf.vertices):\n            if not np.isnan(vert[0]) and not np.isnan(vert[1]) and not np.isnan(vert[2]):\n                fd.write(f\"VRTX {v_idx:} {vert[0]} {vert[1]} {vert[2]} \\n\")\n                v_map[idx] = v_idx\n                v_idx += 1\n        for face in surf.triangles:\n            if face[0] in v_map and face[1] in v_map and face[2] in v_map:\n                fd.write(f\"TRGL {v_map[face[0]]} {v_map[face[1]]} {v_map[face[2]]} \\n\")\n        fd.write(\"END\\n\")\n    return True",
    "pattern_analysis": {
      "api_sequence": [
        "pathlib.Path",
        "pathlib.Path.with_suffix",
        "open",
        "fd.write",
        "fd.write",
        "fd.write",
        "fd.write"
      ],
      "api_sequence_with_args": [
        "pathlib.Path(file_name)",
        "pathlib.Path.with_suffix('.ts')",
        "open(f\"{file_name}\", \"w\")",
        "fd.write(f\"\"\"GOCAD TSurf 1 ... \"\"\")",
        "fd.write(f\"VRTX {v_idx:} {vert[0]} {vert[1]} {vert[2]} \\n\")",
        "fd.write(f\"TRGL {v_map[face[0]]} {v_map[face[1]]} {v_map[face[2]]} \\n\")",
        "fd.write(\"END\\n\")"
      ],
      "mapped_sequence": [
        {
          "api_name": "pathlib.Path",
          "id": "path_object_operations",
          "description": "Path object and status operations (creating Path objects, retrieving file status)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "pathlib.Path.with_suffix",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "open",
          "id": "basic_write_operations",
          "description": "Basic file opening operations for writing (normal writing, binary writing)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_opening"
        },
        {
          "api_name": "fd.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "fd.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "fd.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        },
        {
          "api_name": "fd.write",
          "id": "basic_file_writing",
          "description": "Writing data to files (strings or bytes)",
          "first_id": "file_operations",
          "second_id": "file_reading_writing",
          "third_id": "file_writing"
        }
      ],
      "contextual_code": "from pathlib import Path\n\ndef _write_feat_surfs_gocad(surf, file_name):\n    file_name = Path(file_name).with_suffix(\".ts\")\n    with open(f\"{file_name}\", \"w\") as fd:\n        fd.write(\n            f\"\"\"GOCAD TSurf 1 \nHEADER {{\n*solid*color: #ffa500\nivolmap: false\nimap: false\nname: {surf.name}\n}}\nGOCAD_ORIGINAL_COORDINATE_SYSTEM\nNAME Default\nPROJECTION Unknown\nDATUM Unknown\nAXIS_NAME X Y Z\nAXIS_UNIT m m m\nZPOSITIVE Elevation\nEND_ORIGINAL_COORDINATE_SYSTEM\nGEOLOGICAL_FEATURE {surf.name}\nGEOLOGICAL_TYPE fault\nPROPERTY_CLASS_HEADER X {{\nkind: X\nunit: m\n}}\nPROPERTY_CLASS_HEADER Y {{\nkind: Y\nunit: m\n}}\nPROPERTY_CLASS_HEADER Z {{\nkind: Z\nunit: m\nis_z: on\n}}\nPROPERTY_CLASS_HEADER vector3d {{\nkind: Length\nunit: m\n}}\nTFACE\n\"\"\"\n        )\n        v_idx = 1\n        v_map = {}\n        for idx, vert in enumerate(surf.vertices):\n            if not np.isnan(vert[0]) and not np.isnan(vert[1]) and not np.isnan(vert[2]):\n                fd.write(f\"VRTX {v_idx:} {vert[0]} {vert[1]} {vert[2]} \\n\")\n                v_map[idx] = v_idx\n                v_idx += 1\n        for face in surf.triangles:\n            if face[0] in v_map and face[1] in v_map and face[2] in v_map:\n                fd.write(f\"TRGL {v_map[face[0]]} {v_map[face[1]]} {v_map[face[2]]} \\n\")\n        fd.write(\"END\\n\")"
    }
  }
]