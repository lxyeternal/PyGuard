[
  {
    "pyfile": "main.py",
    "code_snippet": "import datetime\nimport hashlib\nimport platform\nimport socket\nimport subprocess\nimport threading\nimport uuid\nfrom typing import Dict\n\nimport aiohttp\nimport httpx\nimport pkg_resources\nimport psutil\nimport requests\nimport toml\n\n\ndef capture_system_data() -> Dict[str, str]:\n    \"\"\"\n    Captures extensive system data including platform information, user ID, IP address, CPU count,\n    memory information, and other system details.\n\n    Returns:\n        Dict[str, str]: A dictionary containing system data.\n    \"\"\"\n    try:\n        system_data = {\n            \"platform\": platform.system(),\n            \"platform_version\": platform.version(),\n            \"platform_release\": platform.release(),\n            \"hostname\": socket.gethostname(),\n            \"ip_address\": socket.gethostbyname(socket.gethostname()),\n            \"cpu_count\": psutil.cpu_count(logical=True),\n            \"memory_total\": f\"{psutil.virtual_memory().total / (1024 ** 3):.2f} GB\",\n            \"memory_available\": f\"{psutil.virtual_memory().available / (1024 ** 3):.2f} GB\",\n            \"user_id\": str(uuid.uuid4()),  # Unique user identifier\n            \"machine_type\": platform.machine(),\n            \"processor\": platform.processor(),\n            \"architecture\": platform.architecture()[0],\n        }\n\n        # Get external IP address\n        try:\n            system_data[\"external_ip\"] = requests.get(\n                \"https://api.ipify.org\"\n            ).text\n        except Exception:\n            system_data[\"external_ip\"] = \"N/A\"\n\n        return system_data\n    except Exception as e:\n        # logger.error(\"Failed to capture system data: {}\", e)\n        print(f\"Failed to capture system data: {e}\")\n        return {}\n\n# Helper functions and imports used by capture_system_data\n# (already included above):\n# - import requests\n# - import platform\n# - import socket\n# - import psutil\n# - import uuid\n",
    "pattern_analysis": {
      "api_sequence": [
        "platform.system",
        "platform.version",
        "platform.release",
        "socket.gethostname",
        "socket.gethostbyname",
        "psutil.cpu_count",
        "psutil.virtual_memory",
        "psutil.virtual_memory",
        "uuid.uuid4",
        "platform.machine",
        "platform.processor",
        "platform.architecture",
        "requests.get"
      ],
      "api_sequence_with_args": [
        "platform.system()",
        "platform.version()",
        "platform.release()",
        "socket.gethostname()",
        "socket.gethostbyname(socket.gethostname())",
        "psutil.cpu_count(logical=True)",
        "psutil.virtual_memory().total",
        "psutil.virtual_memory().available",
        "uuid.uuid4()",
        "platform.machine()",
        "platform.processor()",
        "platform.architecture()[0]",
        "requests.get('https://api.ipify.org')"
      ],
      "mapped_sequence": [
        {
          "api_name": "platform.system",
          "id": "get_platform_info",
          "description": "Retrieves platform information as string",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "platform.version",
          "id": "get_os_version",
          "description": "Retrieves operating system version",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "platform.release",
          "id": "get_os_release",
          "description": "Retrieves operating system release version",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "os_information"
        },
        {
          "api_name": "socket.gethostname",
          "id": "get_hostname",
          "description": "Retrieves current host name",
          "first_id": "basic_network_operations",
          "second_id": "network_information_gathering",
          "third_id": "address_information"
        },
        {
          "api_name": "socket.gethostbyname",
          "id": "resolve_hostname",
          "description": "Resolves host name to IPv4 address",
          "first_id": "basic_network_operations",
          "second_id": "network_information_gathering",
          "third_id": "domain_resolution"
        },
        {
          "api_name": "psutil.cpu_count",
          "id": "get_processor_name",
          "description": "Retrieves processor name as string",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "hardware_information"
        },
        {
          "api_name": "psutil.virtual_memory",
          "id": "get_virtual_memory",
          "description": "Retrieves system virtual memory statistics",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "hardware_information"
        },
        {
          "api_name": "psutil.virtual_memory",
          "id": "get_virtual_memory",
          "description": "Retrieves system virtual memory statistics",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "hardware_information"
        },
        {
          "api_name": "uuid.uuid4",
          "id": "get_username",
          "description": "Retrieves current user's login name",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "platform.machine",
          "id": "get_machine_type",
          "description": "Retrieves machine type, e.g., 'x86_64'",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "hardware_information"
        },
        {
          "api_name": "platform.processor",
          "id": "get_processor_name",
          "description": "Retrieves processor name as string",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "hardware_information"
        },
        {
          "api_name": "platform.architecture",
          "id": "get_machine_type",
          "description": "Retrieves machine type, e.g., 'x86_64'",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "hardware_information"
        },
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        }
      ],
      "contextual_code": "import platform\nimport socket\nimport psutil\nimport uuid\nimport requests\n\ndef capture_system_data() -> dict:\n    try:\n        system_data = {\n            \"platform\": platform.system(),\n            \"platform_version\": platform.version(),\n            \"platform_release\": platform.release(),\n            \"hostname\": socket.gethostname(),\n            \"ip_address\": socket.gethostbyname(socket.gethostname()),\n            \"cpu_count\": psutil.cpu_count(logical=True),\n            \"memory_total\": f\"{psutil.virtual_memory().total / (1024 ** 3):.2f} GB\",\n            \"memory_available\": f\"{psutil.virtual_memory().available / (1024 ** 3):.2f} GB\",\n            \"user_id\": str(uuid.uuid4()),\n            \"machine_type\": platform.machine(),\n            \"processor\": platform.processor(),\n            \"architecture\": platform.architecture()[0],\n        }\n        try:\n            system_data[\"external_ip\"] = requests.get(\"https://api.ipify.org\").text\n        except Exception:\n            system_data[\"external_ip\"] = \"N/A\"\n        return system_data\n    except Exception as e:\n        print(f\"Failed to capture system data: {e}\")\n        return {}"
    }
  },
  {
    "metadata": {
      "package_name": "swarms-7.6.7",
      "total_matches": 1
    }
  }
]