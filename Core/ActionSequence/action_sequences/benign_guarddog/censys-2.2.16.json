[
  {
    "pyfile": "hnri.py",
    "code_snippet": "import requests\nfrom typing import Any, List, Optional, Tuple\n\nclass CensysHNRI:\n    \"\"\"Searches the Censys API for the user's current IP to scan for risks.\"\"\"\n\n    HIGH_RISK_DEFINITION: List[str] = [\"TELNET\", \"REDIS\", \"POSTGRES\", \"VNC\"]\n    MEDIUM_RISK_DEFINITION: List[str] = [\"SSH\", \"HTTP\", \"HTTPS\"]\n\n    def __init__(self, api_id: Optional[str] = None, api_secret: Optional[str] = None):\n        \"\"\"Inits CensysHNRI.\n\n        Args:\n            api_id (str): Optional; The API ID provided by Censys.\n            api_secret (str): Optional; The API secret provided by Censys.\n        \"\"\"\n        self.index = CensysHosts(api_id, api_secret)\n\n    @staticmethod\n    def get_current_ip() -> str:\n        \"\"\"Uses ipify.org to get the current IP address.\n\n        Returns:\n            str: IP address.\n        \"\"\"\n        response = requests.get(\"https://api.ipify.org?format=json\")\n        current_ip = str(response.json().get(\"ip\"))\n        return current_ip",
    "pattern_analysis": {
      "api_sequence": [
        "requests.get",
        "requests.models.Response.json"
      ],
      "api_sequence_with_args": [
        "requests.get(\"https://api.ipify.org?format=json\")",
        "requests.models.Response.json()"
      ],
      "mapped_sequence": [
        {
          "api_name": "requests.get",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "requests.models.Response.json",
          "id": "deserialize_json_response",
          "description": "Deserializes JSON response body to Python object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        }
      ],
      "contextual_code": "import requests\n\nclass CensysHNRI:\n    @staticmethod\n    def get_current_ip() -> str:\n        response = requests.get(\"https://api.ipify.org?format=json\")\n        current_ip = str(response.json().get(\"ip\"))\n        return current_ip"
    }
  },
  {
    "metadata": {
      "package_name": "censys-2.2.16",
      "total_matches": 1
    }
  }
]