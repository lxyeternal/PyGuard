[
  {
    "pyfile": "install_7zip.py",
    "code_snippet": "from __future__ import print_function\nimport sys, os\nos.chdir(os.path.join(os.getcwd(), os.path.dirname(sys.argv[0])))\nimport pywinauto\n\napp = pywinauto.Application().Start(r'msiexec.exe /i 7z920-x64.msi')\n\nWizard = app['7-Zip 9.20 (x64 edition) Setup']\nWizard.NextButton.click()\n\nWizard['I &accept the terms in the License Agreement'].wait('enabled').check_by_click()\nWizard.NextButton.click()\n\nWizard['Custom Setup'].wait('enabled')\nWizard.NextButton.click()\n\nWizard.Install.click()\n\nWizard.Finish.wait('enabled', timeout=30)\nWizard.Finish.click()\nWizard.wait_not('visible')\n\n# final check\nif os.path.exists(r\"C:\\Program Files\\7-Zip\\7zFM.exe\"):\n    print('OK')\nelse:\n    print('FAIL')",
    "pattern_analysis": {
      "api_sequence": [
        "os.getcwd",
        "os.path.dirname",
        "os.path.join",
        "os.chdir",
        "sys.argv",
        "pywinauto.Application.Start",
        "pywinauto.Application.__getitem__",
        "pywinauto.controls.uia_controls.ButtonWrapper.click",
        "pywinauto.controls.uia_controls.CheckBoxWrapper.wait",
        "pywinauto.controls.uia_controls.CheckBoxWrapper.check_by_click",
        "pywinauto.controls.uia_controls.ButtonWrapper.click",
        "pywinauto.controls.uia_controls.WindowSpecification.wait",
        "pywinauto.controls.uia_controls.ButtonWrapper.click",
        "pywinauto.controls.uia_controls.ButtonWrapper.click",
        "pywinauto.controls.uia_controls.WindowSpecification.wait",
        "pywinauto.controls.uia_controls.ButtonWrapper.click",
        "pywinauto.controls.uia_controls.WindowSpecification.wait_not",
        "os.path.exists",
        "print",
        "print"
      ],
      "api_sequence_with_args": [
        "os.getcwd()",
        "os.path.dirname(sys.argv[0])",
        "os.path.join(os.getcwd(), os.path.dirname(sys.argv[0]))",
        "os.chdir(os.path.join(os.getcwd(), os.path.dirname(sys.argv[0])))",
        "sys.argv[0]",
        "pywinauto.Application().Start(r'msiexec.exe /i 7z920-x64.msi')",
        "app['7-Zip 9.20 (x64 edition) Setup']",
        "Wizard.NextButton.click()",
        "Wizard['I &accept the terms in the License Agreement'].wait('enabled')",
        "Wizard['I &accept the terms in the License Agreement'].check_by_click()",
        "Wizard.NextButton.click()",
        "Wizard['Custom Setup'].wait('enabled')",
        "Wizard.NextButton.click()",
        "Wizard.Install.click()",
        "Wizard.Finish.wait('enabled', timeout=30)",
        "Wizard.Finish.click()",
        "Wizard.wait_not('visible')",
        "os.path.exists(r\"C:\\Program Files\\7-Zip\\7zFM.exe\")",
        "print('OK')",
        "print('FAIL')"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.getcwd",
          "id": "get_working_dir",
          "description": "Returns current working directory",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "os.path.dirname",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.path.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.chdir",
          "id": "change_working_dir",
          "description": "Changes current working directory",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "sys.argv",
          "id": "get_cmd_args",
          "description": "Retrieves command-line arguments passed to script",
          "first_id": "information_gathering",
          "second_id": "system_information_collection",
          "third_id": "user_information"
        },
        {
          "api_name": "pywinauto.Application.Start",
          "id": "spawn_process_shell",
          "description": "Spawns new process to execute command with shell access",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_reception"
        },
        {
          "api_name": "pywinauto.Application.__getitem__",
          "id": "find_window_by_title",
          "description": "Finds window handle by title",
          "first_id": "system_operations",
          "second_id": "window_management",
          "third_id": "window_finding"
        },
        {
          "api_name": "pywinauto.controls.uia_controls.ButtonWrapper.click",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "pywinauto.controls.uia_controls.CheckBoxWrapper.wait",
          "id": "wait_thread",
          "description": "Waits for thread to finish execution",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_control"
        },
        {
          "api_name": "pywinauto.controls.uia_controls.CheckBoxWrapper.check_by_click",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "pywinauto.controls.uia_controls.ButtonWrapper.click",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "pywinauto.controls.uia_controls.WindowSpecification.wait",
          "id": "wait_thread",
          "description": "Waits for thread to finish execution",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_control"
        },
        {
          "api_name": "pywinauto.controls.uia_controls.ButtonWrapper.click",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "pywinauto.controls.uia_controls.ButtonWrapper.click",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "pywinauto.controls.uia_controls.WindowSpecification.wait",
          "id": "wait_thread",
          "description": "Waits for thread to finish execution",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_control"
        },
        {
          "api_name": "pywinauto.controls.uia_controls.ButtonWrapper.click",
          "id": "execute_shell_command",
          "description": "Executes shell command",
          "first_id": "command_control_communications",
          "second_id": "command_execution",
          "third_id": "command_sending"
        },
        {
          "api_name": "pywinauto.controls.uia_controls.WindowSpecification.wait_not",
          "id": "wait_thread",
          "description": "Waits for thread to finish execution",
          "first_id": "system_operations",
          "second_id": "thread_management",
          "third_id": "thread_control"
        },
        {
          "api_name": "os.path.exists",
          "id": "check_path_exists",
          "description": "Checks if specified path exists in filesystem",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_checking"
        },
        {
          "api_name": "print",
          "id": "log_info",
          "description": "Logs informational message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "print",
          "id": "log_info",
          "description": "Logs informational message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        }
      ],
      "contextual_code": "import sys, os\nos.chdir(os.path.join(os.getcwd(), os.path.dirname(sys.argv[0])))\nimport pywinauto\n\napp = pywinauto.Application().Start(r'msiexec.exe /i 7z920-x64.msi')\n\nWizard = app['7-Zip 9.20 (x64 edition) Setup']\nWizard.NextButton.click()\n\nWizard['I &accept the terms in the License Agreement'].wait('enabled').check_by_click()\nWizard.NextButton.click()\n\nWizard['Custom Setup'].wait('enabled')\nWizard.NextButton.click()\n\nWizard.Install.click()\n\nWizard.Finish.wait('enabled', timeout=30)\nWizard.Finish.click()\nWizard.wait_not('visible')\n\nif os.path.exists(r\"C:\\Program Files\\7-Zip\\7zFM.exe\"):\n    print('OK')\nelse:\n    print('FAIL')"
    }
  },
  {
    "metadata": {
      "package_name": "pywinauto-0.6.9",
      "total_matches": 1
    }
  }
]