[
  {
    "pyfile": "graphql.py",
    "code_snippet": "import json\nimport os\nfrom typing import Any, Dict\n\nimport requests\n\nfrom runpod import error\nfrom runpod.user_agent import USER_AGENT\n\nHTTP_STATUS_UNAUTHORIZED = 401\n\n\ndef run_graphql_query(query: str) -> Dict[str, Any]:\n    \"\"\"\n    Run a GraphQL query\n    \"\"\"\n    from runpod import api_key  # pylint: disable=import-outside-toplevel, cyclic-import\n\n    api_url_base = os.environ.get(\"RUNPOD_API_BASE_URL\", \"https://api.runpod.io\")\n    url = f\"{api_url_base}/graphql\"\n\n    headers = {\n        \"Content-Type\": \"application/json\",\n        \"User-Agent\": USER_AGENT,\n        \"Authorization\": f\"Bearer {api_key}\",\n    }\n\n    data = json.dumps({\"query\": query})\n    response = requests.post(url, headers=headers, data=data, timeout=30)\n\n    if response.status_code == HTTP_STATUS_UNAUTHORIZED:\n        raise error.AuthenticationError(\n            \"Unauthorized request, please check your API key.\"\n        )\n\n    if \"errors\" in response.json():\n        raise error.QueryError(response.json()[\"errors\"][0][\"message\"], query)\n\n    return response.json()\n",
    "pattern_analysis": {
      "api_sequence": [
        "os.environ.get",
        "json.dumps",
        "requests.post",
        "response.status_code",
        "response.json"
      ],
      "api_sequence_with_args": [
        "os.environ.get(\"RUNPOD_API_BASE_URL\", \"https://api.runpod.io\")",
        "json.dumps({\"query\": query})",
        "requests.post(url, headers=headers, data=data, timeout=30)",
        "response.status_code",
        "response.json()"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.environ.get",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "json.dumps",
          "id": "serialize_to_json",
          "description": "Serializes Python object to JSON string",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "requests.post",
          "id": "send_http_post_timeout",
          "description": "Sends HTTP POST request with data and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "response.status_code",
          "id": "get_http_status",
          "description": "Retrieves HTTP response status code",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        },
        {
          "api_name": "response.json",
          "id": "deserialize_json_response",
          "description": "Deserializes JSON response body to Python object",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "response_processing"
        }
      ],
      "contextual_code": "def run_graphql_query(query: str) -> Dict[str, Any]:\n    from runpod import api_key\n    api_url_base = os.environ.get(\"RUNPOD_API_BASE_URL\", \"https://api.runpod.io\")\n    url = f\"{api_url_base}/graphql\"\n    headers = {\n        \"Content-Type\": \"application/json\",\n        \"User-Agent\": USER_AGENT,\n        \"Authorization\": f\"Bearer {api_key}\",\n    }\n    data = json.dumps({\"query\": query})\n    response = requests.post(url, headers=headers, data=data, timeout=30)\n    if response.status_code == HTTP_STATUS_UNAUTHORIZED:\n        raise error.AuthenticationError(\n            \"Unauthorized request, please check your API key.\"\n        )\n    if \"errors\" in response.json():\n        raise error.QueryError(response.json()[\"errors\"][0][\"message\"], query)\n    return response.json()"
    }
  },
  {
    "metadata": {
      "package_name": "runpod-1.7.9",
      "total_matches": 1
    }
  }
]