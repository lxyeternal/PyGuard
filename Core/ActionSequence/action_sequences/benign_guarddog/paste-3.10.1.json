[
  {
    "pyfile": "cgitb_hook.py",
    "code_snippet": "import inspect\nimport keyword\nimport linecache\nimport os\nimport pydoc\nimport sys\nimport tempfile\nimport time\nimport tokenize\nimport traceback\nfrom html import escape as html_escape\n\n__UNDEF__ = object()  # a special sentinel object\n\ndef lookup(name, frame, locals):\n    \"\"\"Find the value for a given name in the given environment.\"\"\"\n    if name in locals:\n        return 'local', locals[name]\n    if name in frame.f_globals:\n        return 'global', frame.f_globals[name]\n    if '__builtins__' in frame.f_globals:\n        builtins = frame.f_globals['__builtins__']\n        if isinstance(builtins, dict):\n            if name in builtins:\n                return 'builtin', builtins[name]\n        else:\n            if hasattr(builtins, name):\n                return 'builtin', getattr(builtins, name)\n    return None, __UNDEF__",
    "pattern_analysis": {
      "api_sequence": [],
      "api_sequence_with_args": [],
      "mapped_sequence": [],
      "contextual_code": "import inspect\nimport keyword\nimport linecache\nimport os\nimport pydoc\nimport sys\nimport tempfile\nimport time\nimport tokenize\nimport traceback\nfrom html import escape as html_escape\n\n__UNDEF__ = object()  # a special sentinel object\n\ndef lookup(name, frame, locals):\n    \"\"\"Find the value for a given name in the given environment.\"\"\"\n    if name in locals:\n        return 'local', locals[name]\n    if name in frame.f_globals:\n        return 'global', frame.f_globals[name]\n    if '__builtins__' in frame.f_globals:\n        builtins = frame.f_globals['__builtins__']\n        if isinstance(builtins, dict):\n            if name in builtins:\n                return 'builtin', builtins[name]\n        else:\n            if hasattr(builtins, name):\n                return 'builtin', getattr(builtins, name)\n    return None, __UNDEF__"
    }
  },
  {
    "metadata": {
      "package_name": "paste-3.10.1",
      "total_matches": 1
    }
  }
]