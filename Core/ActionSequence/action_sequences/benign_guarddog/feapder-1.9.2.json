[
  {
    "pyfile": "create_cookies.py",
    "code_snippet": "import json\n\nimport pyperclip\n\nfrom feapder.utils.tools import get_cookies_from_str, print_pretty\n\nclass CreateCookies:\n    def get_data(self):\n        \"\"\"\n        @summary: 从剪切板中读取内容\n        ---------\n        ---------\n        @result:\n        \"\"\"\n        input(\"请复制浏览器cookie (列表或字符串格式), 复制后按任意键读取剪切板内容\\n\")\n\n        text = pyperclip.paste()\n        print(text + \"\\n\")\n\n        return text\n",
    "pattern_analysis": {
      "api_sequence": [
        "input",
        "pyperclip.paste",
        "print"
      ],
      "api_sequence_with_args": [
        "input('请复制浏览器cookie (列表或字符串格式), 复制后按任意键读取剪切板内容\\n')",
        "pyperclip.paste()",
        "print(text + \"\\n\")"
      ],
      "mapped_sequence": [
        {
          "api_name": "input",
          "id": "read_user_input",
          "description": "Reads user input from standard input",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "pyperclip.paste",
          "id": "get_clipboard_text",
          "description": "Retrieves text from system clipboard",
          "first_id": "information_gathering",
          "second_id": "input_monitoring",
          "third_id": "clipboard_operations"
        }
      ],
      "contextual_code": "import pyperclip\n\nclass CreateCookies:\n    def get_data(self):\n        input(\"请复制浏览器cookie (列表或字符串格式), 复制后按任意键读取剪切板内容\\n\")\n        text = pyperclip.paste()\n        print(text + \"\\n\")\n        return text"
    }
  },
  {
    "pyfile": "create_json.py",
    "code_snippet": "import pyperclip\n\nimport feapder.utils.tools as tools\n\nclass CreateJson:\n    def get_data(self):\n        \"\"\"\n        @summary: 从控制台读取多行\n        ---------\n        ---------\n        @result:\n        \"\"\"\n        input(\"请复制需要转换的内容（xxx:xxx格式，支持多行），复制后按任意键读取剪切板内容\\n\")\n\n        text = pyperclip.paste()\n        print(text + \"\\n\")\n\n        data = []\n        for line in text.split(\"\\n\"):\n            line = line.strip().replace(\"\\t\", \" \" * 4)\n            if not line:\n                break\n\n            data.append(line)\n\n        return data",
    "pattern_analysis": {
      "api_sequence": [
        "input",
        "pyperclip.paste"
      ],
      "api_sequence_with_args": [
        "input('请复制需要转换的内容（xxx:xxx格式，支持多行），复制后按任意键读取剪切板内容\\n')",
        "pyperclip.paste()"
      ],
      "mapped_sequence": [
        {
          "api_name": "input",
          "id": "read_user_input",
          "description": "Reads user input from standard input",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "pyperclip.paste",
          "id": "get_clipboard_text",
          "description": "Retrieves text from system clipboard",
          "first_id": "information_gathering",
          "second_id": "input_monitoring",
          "third_id": "clipboard_operations"
        }
      ],
      "contextual_code": "import pyperclip\n\nclass CreateJson:\n    def get_data(self):\n        input(\"请复制需要转换的内容（xxx:xxx格式，支持多行），复制后按任意键读取剪切板内容\\n\")\n        text = pyperclip.paste()\n        # ... further processing of text"
    }
  },
  {
    "pyfile": "create_table.py",
    "code_snippet": "import time\n\nimport pyperclip\n\nimport feapder.setting as setting\nimport feapder.utils.tools as tools\nfrom feapder.db.mysqldb import MysqlDB\nfrom feapder.utils.tools import key2underline\n\nclass CreateTable:\n    def __init__(self):\n        self._db = MysqlDB()\n\n    def is_valid_date(self, date):\n        try:\n            if \":\" in date:\n                time.strptime(date, \"%Y-%m-%d %H:%M:%S\")\n            else:\n                time.strptime(date, \"%Y-%m-%d\")\n            return True\n        except:\n            return False\n\n    def get_key_type(self, value):\n        if isinstance(value, int):\n            key_type = \"int\"\n        elif isinstance(value, float):\n            key_type = \"double\"\n        elif isinstance(value, str):\n            if self.is_valid_date(value):\n                if \":\" in value:\n                    key_type = \"datetime\"\n                else:\n                    key_type = \"date\"\n            elif len(value) > 50:\n                key_type = \"text\"\n            else:\n                key_type = \"varchar(255)\"\n        elif isinstance(value, (dict, list)):\n            key_type = \"longtext\"\n        else:\n            key_type = \"varchar(255)\"\n\n        return key_type\n\n    def get_data(self):\n        \"\"\"\n        @summary: 从控制台读取多行\n        ---------\n        ---------\n        @result:\n        \"\"\"\n        input(\"请复制json格式数据, 复制后按任意键读取剪切板内容\\n\")\n\n        text = pyperclip.paste()\n        print(text + \"\\n\")\n\n        return tools.get_json(text)\n",
    "pattern_analysis": {
      "api_sequence": [
        "input",
        "pyperclip.paste",
        "tools.get_json"
      ],
      "api_sequence_with_args": [
        "input(\"请复制json格式数据, 复制后按任意键读取剪切板内容\\n\")",
        "pyperclip.paste()",
        "tools.get_json(text)"
      ],
      "mapped_sequence": [
        {
          "api_name": "input",
          "id": "read_user_input",
          "description": "Reads user input from standard input",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "pyperclip.paste",
          "id": "get_clipboard_text",
          "description": "Retrieves text from system clipboard",
          "first_id": "information_gathering",
          "second_id": "input_monitoring",
          "third_id": "clipboard_operations"
        },
        {
          "api_name": "tools.get_json",
          "id": "deserialize_from_json",
          "description": "Deserializes JSON string to Python object",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        }
      ],
      "contextual_code": "import pyperclip\nimport feapder.utils.tools as tools\n\nclass CreateTable:\n    def get_data(self):\n        input(\"请复制json格式数据, 复制后按任意键读取剪切板内容\\n\")\n        text = pyperclip.paste()\n        print(text + \"\\n\")\n        return tools.get_json(text)"
    }
  },
  {
    "pyfile": "shell.py",
    "code_snippet": "import pyperclip\nimport argparse\nimport re\nimport shlex\nimport sys\n\nimport IPython\n\nfrom feapder import Request\nfrom feapder.utils import tools\n\ndef parse_curl(curl_str):\n    parser = argparse.ArgumentParser(description=\"\")\n    parser.add_argument(\"target_url\", type=str, nargs=\"?\")\n    parser.add_argument(\"-X\", \"--request\", type=str, nargs=1, default=\"\")\n    parser.add_argument(\"-H\", \"--header\", nargs=1, action=\"append\", default=[])\n    parser.add_argument(\"-d\", \"--data\", nargs=1, action=\"append\", default=[])\n    parser.add_argument(\"--data-ascii\", nargs=1, action=\"append\", default=[])\n    parser.add_argument(\"--data-binary\", nargs=1, action=\"append\", default=[])\n    parser.add_argument(\"--data-urlencode\", nargs=1, action=\"append\", default=[])\n    parser.add_argument(\"--data-raw\", nargs=1, action=\"append\", default=[])\n    parser.add_argument(\"-F\", \"--form\", nargs=1, action=\"append\", default=[])\n    parser.add_argument(\"--digest\", action=\"store_true\")\n    parser.add_argument(\"--ntlm\", action=\"store_true\")\n    parser.add_argument(\"--anyauth\", action=\"store_true\")\n    parser.add_argument(\"-e\", \"--referer\", type=str)\n    parser.add_argument(\"-G\", \"--get\", action=\"store_true\", default=False)\n    parser.add_argument(\"-I\", \"--head\", action=\"store_true\")\n    parser.add_argument(\"-k\", \"--insecure\", action=\"store_true\")\n    parser.add_argument(\"-o\", \"--output\", type=str)\n    parser.add_argument(\"-O\", \"--remote_name\", action=\"store_true\")\n    parser.add_argument(\"-r\", \"--range\", type=str)\n    parser.add_argument(\"-u\", \"--user\", type=str)\n    parser.add_argument(\"--url\", type=str)\n    parser.add_argument(\"-A\", \"--user-agent\", type=str)\n    parser.add_argument(\"--compressed\", action=\"store_true\", default=False)\n\n    curl_split = shlex.split(curl_str)\n    try:\n        args = parser.parse_known_args(curl_split[1:])[0]\n    except:\n        raise ValueError(\"Could not parse arguments.\")\n\n    # 请求地址\n    url = args.target_url\n\n    # # 请求方法\n    # try:\n    #     method = args.request.lower()\n    # except AttributeError:\n    #     method = args.request[0].lower()\n\n    # 请求头\n    headers = {\n        h[0].split(\":\", 1)[0]: (\"\".join(h[0].split(\":\", 1)[1]).strip())\n        for h in args.header\n    }\n    if args.user_agent:\n        headers[\"User-Agent\"] = args.user_agent\n    if args.referer:\n        headers[\"Referer\"] = args.referer\n    if args.range:\n        headers[\"Range\"] = args.range\n\n    # Cookie\n    cookie_str = headers.pop(\"Cookie\", \"\") or headers.pop(\"cookie\", \"\")\n    cookies = tools.get_cookies_from_str(cookie_str) if cookie_str else {}\n\n    # params\n    url, params = tools.parse_url_params(url)\n\n    # data\n    data = \"\".join(\n        [\n            \"\".join(d)\n            for d in args.data\n            + args.data_ascii\n            + args.data_binary\n            + args.data_raw\n            + args.form\n        ]\n    )\n    if data:\n        data = re.sub(r\"^\\$\", \"\", data)\n\n    # method\n    if args.head:\n        method = \"head\"\n    elif args.get:\n        method = \"get\"\n        params.update(data)\n    elif args.request:\n        method = (\n            args.request[0].lower()\n            if isinstance(args.request, list)\n            else args.request.lower()\n        )\n    elif data:\n        method = \"post\"\n    else:\n        method = \"get\"\n        params.update(data)\n\n    username = None\n    password = None\n    if args.user:\n        u = args.user\n        if \":\" in u:\n            username, password = u.split(\":\")\n        else:\n            username = u\n            password = input(f\"请输入用户{username}的密码\")\n\n    auth = None\n    if args.digest:\n        auth = \"digest\"\n    elif args.ntlm:\n        auth = \"ntlm\"\n    elif username:\n        auth = \"basic\"\n\n    insecure = args.insecure\n\n    return dict(\n        url=url,\n        method=method,\n        cookies=cookies,\n        headers=headers,\n        params=params,\n        data=data,\n        insecure=insecure,\n        username=username,\n        password=password,\n        auth=auth,\n    )\n\ndef request(**kwargs):\n    kwargs.setdefault(\"proxies\", None)\n    response = Request(**kwargs).get_response()\n    print(response)\n\n    IPython.embed(header=\"now you can use response\")\n\ndef fetch_curl():\n    input(\"请复制请求为cURL (bash)，复制后按任意键读取剪切板内容\\n\")\n    curl = pyperclip.paste()\n    if curl:\n        kwargs = parse_curl(curl)\n        request(**kwargs)\n",
    "pattern_analysis": {
      "api_sequence": [
        "input",
        "pyperclip.paste",
        "parse_curl",
        "argparse.ArgumentParser.parse_known_args",
        "tools.get_cookies_from_str",
        "tools.parse_url_params",
        "re.sub",
        "input",
        "Request.get_response",
        "print",
        "IPython.embed"
      ],
      "api_sequence_with_args": [
        "input(\"请复制请求为cURL (bash)，复制后按任意键读取剪切板内容\\n\")",
        "pyperclip.paste()",
        "parse_curl(curl)",
        "argparse.ArgumentParser.parse_known_args(curl_split[1:])",
        "tools.get_cookies_from_str(cookie_str)",
        "tools.parse_url_params(url)",
        "re.sub(r\"^\\$\", \"\", data)",
        "input(f\"请输入用户{username}的密码\")",
        "Request(**kwargs).get_response()",
        "print(response)",
        "IPython.embed(header=\"now you can use response\")"
      ],
      "mapped_sequence": [
        {
          "api_name": "input",
          "id": "read_user_input",
          "description": "Reads user input from standard input",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "pyperclip.paste",
          "id": "get_clipboard_text",
          "description": "Retrieves text from system clipboard",
          "first_id": "information_gathering",
          "second_id": "input_monitoring",
          "third_id": "clipboard_operations"
        },
        {
          "api_name": "parse_curl",
          "id": "deserialize_from_bytes",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "argparse.ArgumentParser.parse_known_args",
          "id": "read_user_input",
          "description": "Reads user input from standard input",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "tools.get_cookies_from_str",
          "id": "deserialize_from_bytes",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "tools.parse_url_params",
          "id": "deserialize_from_bytes",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "re.sub",
          "id": "deserialize_from_bytes",
          "description": "Deserializes Python object from bytes",
          "first_id": "data_transformation_processing",
          "second_id": "data_encoding",
          "third_id": "specific_format_encoding"
        },
        {
          "api_name": "input",
          "id": "read_user_input",
          "description": "Reads user input from standard input",
          "first_id": "persistence_stealth",
          "second_id": "user_interaction",
          "third_id": "interface_control"
        },
        {
          "api_name": "Request.get_response",
          "id": "send_http_get",
          "description": "Sends HTTP GET request with parameters and timeout",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_sending"
        },
        {
          "api_name": "print",
          "id": "log_info",
          "description": "Logs informational message",
          "first_id": "data_exfiltration",
          "second_id": "data_collection_operations",
          "third_id": "data_acquisition"
        },
        {
          "api_name": "IPython.embed",
          "id": "exec_python_code",
          "description": "Dynamically executes Python code string",
          "first_id": "code_execution",
          "second_id": "code_evaluation_execution",
          "third_id": "string_execution"
        }
      ],
      "contextual_code": "def fetch_curl():\n    input(\"请复制请求为cURL (bash)，复制后按任意键读取剪切板内容\\n\")\n    curl = pyperclip.paste()\n    if curl:\n        kwargs = parse_curl(curl)\n        request(**kwargs)\n\ndef parse_curl(curl_str):\n    ...\n    curl_split = shlex.split(curl_str)\n    try:\n        args = parser.parse_known_args(curl_split[1:])[0]\n    except:\n        raise ValueError(\"Could not parse arguments.\")\n    ...\n    cookie_str = headers.pop(\"Cookie\", \"\") or headers.pop(\"cookie\", \"\")\n    cookies = tools.get_cookies_from_str(cookie_str) if cookie_str else {}\n    url, params = tools.parse_url_params(url)\n    ...\n    if data:\n        data = re.sub(r\"^\\$\", \"\", data)\n    ...\n    if args.user:\n        u = args.user\n        if \":\" in u:\n            username, password = u.split(\":\")\n        else:\n            username = u\n            password = input(f\"请输入用户{username}的密码\")\n    ...\n\ndef request(**kwargs):\n    kwargs.setdefault(\"proxies\", None)\n    response = Request(**kwargs).get_response()\n    print(response)\n    IPython.embed(header=\"now you can use response\")"
    }
  },
  {
    "metadata": {
      "package_name": "feapder-1.9.2",
      "total_matches": 4
    }
  }
]