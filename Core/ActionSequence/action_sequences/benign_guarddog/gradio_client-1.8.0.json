[
  {
    "pyfile": "discord_chat.py",
    "code_snippet": "import asyncio\nimport os\nimport threading\nfrom threading import Event\nfrom typing import Optional\n\nimport discord\nimport gradio as gr\nfrom discord import Permissions\nfrom discord.ext import commands\nfrom discord.utils import oauth_url\n\nimport gradio_client as grc\nfrom gradio_client.utils import QueueError\n\nevent = Event()\n\nDISCORD_TOKEN = os.getenv(\"DISCORD_TOKEN\")\n\n...\n\nif not DISCORD_TOKEN:\n    welcome_message = \"\"\"\n\n    ## You have not specified a DISCORD_TOKEN, which means you have not created a bot account. Please follow these steps:\n\n    ### 1. Go to https://discord.com/developers/applications and click 'New Application'\n\n    ### 2. Give your bot a name ü§ñ\n\n    ![](https://gradio-builds.s3.amazonaws.com/demo-files/discordbots/BotName.png)\n\n    ## 3. In Settings > Bot, click the 'Reset Token' button to get a new token. Write it down and keep it safe üîê\n\n    ![](https://gradio-builds.s3.amazonaws.com/demo-files/discordbots/ResetToken.png)\n\n    ## 4. Optionally make the bot public if you want anyone to be able to add it to their servers\n\n    ## 5. Scroll down and enable 'Message Content Intent' under 'Priviledged Gateway Intents'\n\n    ![](https://gradio-builds.s3.amazonaws.com/demo-files/discordbots/MessageContentIntent.png)\n\n    ## 6. Save your changes!\n\n    ## 7. The token from step 3 is the DISCORD_TOKEN. Rerun the deploy_discord command, e.g client.deploy_discord(discord_bot_token=DISCORD_TOKEN, ...), or add the token as a space secret manually.\n\"\"\"\nelse:\n    permissions = Permissions(326417525824)\n    url = oauth_url(bot.user.id, permissions=permissions)\n    welcome_message = f\"\"\"\n    ## Add this bot to your server by clicking this link:\n\n    {url}\n\n    ## How to use it?\n\n    The bot can be triggered via `/<<command-name>>` followed by your text prompt.\n\n    This will create a thread with the bot's response to your text prompt.\n    You can reply in the thread (without `/<<command-name>>`) to continue the conversation.\n    In the thread, the bot will only reply to the original author of the command.\n\n    ‚ö†Ô∏è Note ‚ö†Ô∏è: Please make sure this bot's command does have the same name as another command in your server.\n\n    ‚ö†Ô∏è Note ‚ö†Ô∏è: Bot commands do not work in DMs with the bot as of now.\n    \"\"\"\n",
    "pattern_analysis": {
      "api_sequence": [
        "os.getenv",
        "discord.Permissions",
        "discord.utils.oauth_url",
        "bot.user.id"
      ],
      "api_sequence_with_args": [
        "os.getenv(\"DISCORD_TOKEN\")",
        "discord.Permissions(326417525824)",
        "discord.utils.oauth_url(bot.user.id, permissions=permissions)",
        "bot.user.id"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.getenv",
          "id": "get_env_var",
          "description": "Retrieves value of environment variable",
          "first_id": "system_operations",
          "second_id": "system_environment_operations",
          "third_id": "environment_information"
        },
        {
          "api_name": "discord.Permissions",
          "id": "get_discord_intents",
          "description": "Returns default Discord intents object",
          "first_id": "third_party_platform_abuse",
          "second_id": "discord_abuse",
          "third_id": "discord_control"
        },
        {
          "api_name": "discord.utils.oauth_url",
          "id": "create_http_request",
          "description": "Creates HTTP request object with specified URL, data, and headers",
          "first_id": "basic_network_operations",
          "second_id": "http_requests",
          "third_id": "request_creation"
        },
        {
          "api_name": "bot.user.id",
          "id": "get_discord_guild",
          "description": "Retrieves Discord guild object by ID",
          "first_id": "third_party_platform_abuse",
          "second_id": "discord_abuse",
          "third_id": "discord_message_operations"
        }
      ],
      "contextual_code": "import os\nfrom discord import Permissions\nfrom discord.utils import oauth_url\n\nDISCORD_TOKEN = os.getenv(\"DISCORD_TOKEN\")\n\nif not DISCORD_TOKEN:\n    # ... (no sensitive API calls in this branch)\n    pass\nelse:\n    permissions = Permissions(326417525824)\n    url = oauth_url(bot.user.id, permissions=permissions)\n    # ... (welcome_message construction)"
    }
  },
  {
    "metadata": {
      "package_name": "gradio_client-1.8.0",
      "total_matches": 1
    }
  }
]