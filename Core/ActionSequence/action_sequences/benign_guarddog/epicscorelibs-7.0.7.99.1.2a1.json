[
  {
    "pyfile": "setup.py",
    "code_snippet": "import os, sys, platform, re\nfrom glob import glob\nfrom collections import defaultdict\n\nfrom setuptools import Command, Distribution\nfrom setuptools.command import install\n\nfrom setuptools_dso import Extension, setup, DSO, build_dso, ProbeToolchain\n\nmydir = os.path.abspath(os.path.dirname(__file__))\n\n# I will use some of what I'm about to install\nsys.path.insert(0, os.path.join(mydir, 'src', 'python'))\n\nfrom epicscorelibs.config import get_config_var\n\n# our choice of version suffix is constrained by PEP 440\n# so we always append .99.ABI.SRC to most recent upstream version\n# the following line is matched from cibuild.py\npackage_version = '7.0.7.99.1.2a1'\n\nassert package_version.split('.')[-3]=='99', package_version\n\nabi_version = '.'.join(package_version.split('.')[:-1]) # strip off the last component\n\nOS_CLASS = get_config_var('OS_CLASS')\n\n# ... (omitted for brevity, see full code above) ...\n\n# a dummy extension so that bdist_wheel will recognise this package\n# as containing binaries.\next = Extension(\n    name='epicscorelibs._base',\n    sources = ['src/python/epicscorelibs/base.cpp'],\n    define_macros = get_config_var('CPPFLAGS'),\n    extra_compile_args = get_config_var('CXXFLAGS'),\n    extra_link_args = get_config_var('LDFLAGS'),\n)\n\nsetup(\n    name='epicscorelibs',\n    version=package_version,\n    description=\"The EPICS Core libraries for use by python modules\",\n    long_description=\"\"\"The EPICS (Experimental Physics and Industrial Control System) core libraries\nfor use by python modules.  Either dynamically with ctypes or statically by compiled extension.\n\"\"\",\n    url='https://github.com/mdavidsaver/epicscorelibs',\n    author='Michael Davidsaver',\n    author_email='mdavidsaver@gmail.com',\n    license='EPICS',\n    classifiers = [\n        'Development Status :: 5 - Production/Stable',\n        'Programming Language :: Python :: 2.7',\n        'Programming Language :: Python :: 3',\n        'License :: Freely Distributable',\n        'Intended Audience :: Science/Research',\n        'Topic :: Scientific/Engineering',\n        'Topic :: Software Development :: Libraries',\n        'Topic :: System :: Distributed Computing',\n        'Operating System :: POSIX :: Linux',\n        'Operating System :: MacOS',\n        'Operating System :: Microsoft :: Windows',\n    ],\n    keywords='epics scada',\n    project_urls = {\n        'Source': 'https://github.com/mdavidsaver/epicscorelibs',\n        'Tracker': 'https://github.com/mdavidsaver/epicscorelibs/issues',\n        'Upstream': 'https://epics.anl.gov/',\n    },\n    python_requires='>=2.7',\n    install_requires=[\n        'setuptools', # needed at runtime for 'pkg_resources'\n        'setuptools-dso>=2.11a2', # 'setuptools_dso.runtime' used in 'epicscorelibs.path'\n        'numpy', # needed for epicscorelibs.ca.dbr\n    ],\n\n    packages=[\n        'epicscorelibs',\n        'epicscorelibs.lib',\n        'epicscorelibs.path',\n        'epicscorelibs.test',\n        'epicscorelibs.ca',\n    ],\n    package_dir={'':os.path.join('src','python')},\n    package_data={\n        '':['*.pxd'],\n        'dbd':[\n            'modules/database/src/ioc/*/*.dbd',\n            'modules/database/src/std/*/*.dbd',\n            'modules/database/src/ioc/generated/*.dbd',\n            'modules/database/src/std/generated/*.dbd',\n        ],\n    },\n    ext_modules = [ext],\n    x_dsos = modules,\n    x_headers = headers,\n    x_api_h = [\n        ('libCom', 'modules/libcom/src/libComAPI.h'),\n        ('libCa', 'modules/ca/src/client/libCaAPI.h'),\n        ('dbCore', 'modules/database/src/ioc/dbCoreAPI.h'),\n        ('dbRecStd', 'modules/database/src/std/dbRecStdAPI.h'),\n    ],\n    x_expand = [\n        ('modules/libcom/src/libComVersion.h@', 'modules/libcom/src/libComVersion.h',\n         ['configure/CONFIG_LIBCOM_VERSION']),\n        ('modules/database/src/ioc/databaseVersion.h@', 'modules/database/src/ioc/databaseVersion.h',\n         ['configure/CONFIG_DATABASE_VERSION']),\n        ('modules/pvData/src/pv/pvdVersionNum.h@', 'modules/pvData/src/pv/pvdVersionNum.h',\n         ['modules/pvData/configure/CONFIG_PVDATA_VERSION']),\n        ('modules/pvAccess/src/pva/pvaVersionNum.h@', 'modules/pvAccess/src/pva/pv/pvaVersionNum.h',\n         ['modules/pvAccess/configure/CONFIG_PVACCESS_VERSION']),\n        ('modules/pva2pva/pdbApp/pv/qsrvVersionNum.h@', 'modules/pva2pva/pdbApp/pv/qsrvVersionNum.h',\n         ['modules/pva2pva/configure/CONFIG_QSRV_VERSION']),\n    ],\n    x_errtable = [\n        \"modules/libcom/src/osi/devLib.h\",\n        \"modules/libcom/src/osi/epicsTime.h\",\n        #\"modules/libcom/src/as/asLib.h\",\n        \"modules/libcom/src/misc/epicsStdlib.h\",\n        \"modules/libcom/src/pool/epicsThreadPool.h\",\n        \"modules/libcom/src/error/errMdef.h\",\n    ],\n    cmdclass = {\n        'build_generated': GenVersionError,\n        'build_expand': Expand,\n        'build_apih': MakeAPIH,\n        'install_epics_headers':InstallHeaders,\n    },\n    zip_safe = False,\n)\n",
    "pattern_analysis": {
      "api_sequence": [
        "os.path.abspath",
        "os.path.dirname",
        "sys.path.insert",
        "os.path.join",
        "epicscorelibs.config.get_config_var"
      ],
      "api_sequence_with_args": [
        "os.path.abspath(os.path.dirname(__file__))",
        "os.path.dirname(__file__)",
        "sys.path.insert(0, os.path.join(mydir, 'src', 'python'))",
        "os.path.join(mydir, 'src', 'python')",
        "epicscorelibs.config.get_config_var('OS_CLASS')",
        "epicscorelibs.config.get_config_var('CPPFLAGS')",
        "epicscorelibs.config.get_config_var('CXXFLAGS')",
        "epicscorelibs.config.get_config_var('LDFLAGS')"
      ],
      "mapped_sequence": [
        {
          "api_name": "os.path.abspath",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "os.path.dirname",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "sys.path.insert",
          "id": "insert_module_path",
          "description": "Inserts directory at start of module search path",
          "first_id": "code_execution",
          "second_id": "module_management",
          "third_id": "module_importing"
        },
        {
          "api_name": "os.path.join",
          "id": "path_string_operations",
          "description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
          "first_id": "file_operations",
          "second_id": "file_management",
          "third_id": "file_path_operations"
        },
        {
          "api_name": "epicscorelibs.config.get_config_var",
          "id": "init_config_class",
          "description": "Initializes Config class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "epicscorelibs.config.get_config_var",
          "id": "init_config_class",
          "description": "Initializes Config class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "epicscorelibs.config.get_config_var",
          "id": "init_config_class",
          "description": "Initializes Config class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        },
        {
          "api_name": "epicscorelibs.config.get_config_var",
          "id": "init_config_class",
          "description": "Initializes Config class with provided arguments",
          "first_id": "code_execution",
          "second_id": "object_initialization",
          "third_id": "class_initialization"
        }
      ],
      "contextual_code": "import os, sys\n\nmydir = os.path.abspath(os.path.dirname(__file__))\n\nsys.path.insert(0, os.path.join(mydir, 'src', 'python'))\n\nfrom epicscorelibs.config import get_config_var\n\nOS_CLASS = get_config_var('OS_CLASS')\n\next = Extension(\n    name='epicscorelibs._base',\n    sources = ['src/python/epicscorelibs/base.cpp'],\n    define_macros = get_config_var('CPPFLAGS'),\n    extra_compile_args = get_config_var('CXXFLAGS'),\n    extra_link_args = get_config_var('LDFLAGS'),\n)\n"
    }
  },
  {
    "metadata": {
      "package_name": "epicscorelibs-7.0.7.99.1.2a1",
      "total_matches": 1
    }
  }
]