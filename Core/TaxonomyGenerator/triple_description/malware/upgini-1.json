{
  "metadata": {
    "package_name": "upgini-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/upgini-1.1.100.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "code_snippets": [
        {
          "snippet": "import sys\nfrom getpass import getuser\nfrom logging import Formatter\nfrom urllib import request\n\ndef send_log(msg: str):\n    try:\n        url = \"https://search.upgini.com/private/api/v2/events/send-light\"\n\n        data = ('{\"message\": \"' + msg + '\", \"whoamai\": \"' + getuser() + '\"}').encode()\n\n        req = request.Request(url, data=data)\n        req.add_header(\"Content-Type\", \"application/json\")\n        request.urlopen(req)\n    except Exception:\n        pass\n\ntry:\n    send_log(f\"Start setup PyLib version {version}\")\n    # ... setup code ...\n    send_log(f\"Setup of PyLib {version} successfully finished\")\nexcept Exception as e:\n    try:\n        tb = Formatter().formatException(sys.exc_info())\n        send_log(f\"Failed to setup PyLib {version}: {e}\\n{tb}\")\n    except Exception:\n        pass\n    raise e",
          "triple_sequences": [
            {
              "action_api": "getuser()",
              "action_description": "Retrieves current user login name",
              "action_id": "get_username",
              "object": "",
              "object_description": "Current username",
              "object_id": "current_username",
              "intention_description": "Access current username",
              "intention_id": "access_current_username"
            },
            {
              "action_api": "str.encode()",
              "action_description": "Encodes string to bytes using default encoding",
              "action_id": "encode_string_to_bytes",
              "object": "",
              "object_description": "Encoded string to bytes",
              "object_id": "encoded_string_bytes",
              "intention_description": "Encode string to bytes",
              "intention_id": "encode_string_to_bytes"
            },
            {
              "action_api": "request.Request()",
              "action_description": "Creates HTTP request object with specified URL, data, and headers",
              "action_id": "create_http_request",
              "object": "url, data=data",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "req.add_header()",
              "action_description": "Adds HTTP header to request object",
              "action_id": "add_http_header",
              "object": "\"Content-Type\", \"application/json\"",
              "object_description": "HTTP header",
              "object_id": "http_header",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "request.urlopen()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "req",
              "object_description": "Request object for external domain",
              "object_id": "request_external_domain",
              "intention_description": "Transmit encoded data via HTTP POST",
              "intention_id": "transmit_data_http_post"
            },
            {
              "action_api": "Formatter().formatException()",
              "action_description": "Extracts current call stack as FrameSummary objects",
              "action_id": "extract_call_stack",
              "object": "sys.exc_info()",
              "object_description": "Exception type name",
              "object_id": "exception_type",
              "intention_description": "Access command error output",
              "intention_id": "access_command_error_output"
            }
          ]
        }
      ]
    }
  ]
}