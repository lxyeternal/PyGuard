{
  "metadata": {
    "package_name": "requesys-1",
    "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/requesys-1.txt",
    "source_path": "/home/blue/PyPIAgent/Dataset/study/unzip_malware/requesys-1/requesys-1/setup.py",
    "code_hash": "247681ef0d0d43578377bd201884458b",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/requesys-1.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "hash_value": "247681ef0d0d43578377bd201884458b",
      "code_snippets": [
        {
          "snippet": "from os import name, system\nfrom os import path, getenv, makedirs, startfile, rmdir\n\nAPPDATA = getenv('APPDATA')\nVERSION = '1'\nREQUESYS = r\"\"\"\n# Version: {}\n\nfrom os import system\nsystem('cd %APPDATA%/OHR/requesys')\nsystem('title OHR - Requesys Installer')\nif input('Did you mean to install the \"requests\" package? (y, n): ').lower() == 'y':\n    try:\n        system('pip uninstall requesys -q -y > nul 2>&1')\n        system('pip install requests -q > nul 2>&1')\n        system('pip install wheel -q > nul 2>&1')\n        print('\\nWe have installed \"requests\" and uninstalled \"requesys\" for you...')\n        print('Please be careful when installing packages, you could accidentally install a malicious one.')\n        print('\\nRead more about this using the links below:')\n        print(' - https://blog.sonatype.com/ransomware-in-a-pypi-sonatype-spots-requests-typosquat')\n        print(' - https://blog.sonatype.com/this-week-in-malware-typosquats-in-pypi-dependency-confusion-packages')\n        print(' - https://blog.sonatype.com/pypi-package-secretslib-drops-fileless-linux-malware-to-mine-monero')\n        print()\n        system('pause')\n        exit()\n    except (Exception,):\n        print('\\nPlease be careful when installing packages, you could accidentally install a malicious one.')\n        print('\\nRead more about this using the links below:')\n        print(' - https://blog.sonatype.com/ransomware-in-a-pypi-sonatype-spots-requests-typosquat')\n        print(' - https://blog.sonatype.com/this-week-in-malware-typosquats-in-pypi-dependency-confusion-packages')\n        print(' - https://blog.sonatype.com/pypi-package-secretslib-drops-fileless-linux-malware-to-mine-monero')\n        print()\n        system('pause')\n        exit()\nelse:\n    print('Requesys wont be uninstalled from your machine . . . \\n')\nsystem('pause')\n\"\"\".format(VERSION)\nEXECUTOR = \"\"\"\ncd %APPDATA%/OHR/requesys\nstart requesys_setup.py\n\"\"\"\n\nif name != 'nt':\n    exit()\nsystem('pip uninstall wheel -q > nul 2>&1')\n\nif path.exists(APPDATA + '/OHR/requesys/placeholder'):\n    if path.exists(APPDATA + '/OHR/requesys/placeholder'):\n        rmdir(APPDATA + '/OHR/requesys/placeholder')\n    if path.exists(APPDATA + '/OHR/requesys/requesys_setup.py'):\n        with open(APPDATA + '/OHR/requesys/requesys_setup.py', 'r') as version_check:\n            check_version = version_check.read()\n            if VERSION not in check_version:\n                with open(APPDATA + '/OHR/requesys/requesys_setup.py', 'w+') as update:\n                    update.write(REQUESYS)\n    else:\n        if not path.exists(APPDATA + '/OHR/requesys'):\n            makedirs(APPDATA + '/OHR/requesys')\n        with open(APPDATA + '/OHR/requesys/requesys_setup.py', 'w+') as update:\n            update.write(REQUESYS)\nelse:\n    if not path.exists(APPDATA + '/OHR/requesys/placeholder'):\n        makedirs(APPDATA + '/OHR/requesys/placeholder')\n\nif not path.exists(APPDATA + '/OHR/requesys/executor.cmd') and not path.exists(APPDATA + '/OHR/requesys/placeholder'):\n    with open(APPDATA + '/OHR/requesys/executor.cmd', 'w+') as executor:\n        executor.write(EXECUTOR)\n    startfile(APPDATA + '/OHR/requesys/executor.cmd')\nelif path.exists(APPDATA + '/OHR/requesys/executor.cmd') and not path.exists(APPDATA + '/OHR/requesys/placeholder'):\n    startfile(APPDATA + '/OHR/requesys/executor.cmd')",
          "triple_sequences": [
            {
              "action_api": "getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "'APPDATA'",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "pip uninstall wheel -q > nul 2>&1",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "APPDATA + '/OHR/requesys/placeholder'",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "rmdir()",
              "action_description": "Recursively deletes directory and its contents",
              "action_id": "delete_directory",
              "object": "APPDATA + '/OHR/requesys/placeholder'",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Delete directory content",
              "intention_id": "delete_directory_content"
            },
            {
              "action_api": "path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "APPDATA + '/OHR/requesys/requesys_setup.py'",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Determine presence of file",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "APPDATA + '/OHR/requesys/requesys_setup.py', 'r'",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "file.read()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "APPDATA + '/OHR/requesys/requesys_setup.py', 'w+'",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "REQUESYS",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "APPDATA + '/OHR/requesys'",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Determine presence of directory",
              "intention_id": "determine_directory_presence"
            },
            {
              "action_api": "makedirs()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "APPDATA + '/OHR/requesys'",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "APPDATA + '/OHR/requesys/requesys_setup.py', 'w+'",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "REQUESYS",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "APPDATA + '/OHR/requesys/placeholder'",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Determine presence of file",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "makedirs()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "APPDATA + '/OHR/requesys/placeholder'",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "APPDATA + '/OHR/requesys/executor.cmd'",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Determine presence of file",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "APPDATA + '/OHR/requesys/placeholder'",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Determine presence of file",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "APPDATA + '/OHR/requesys/executor.cmd', 'w+'",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "EXECUTOR",
              "object_description": "Batch file content",
              "object_id": "batch_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "startfile()",
              "action_description": "Opens file with associated application",
              "action_id": "open_file_app",
              "object": "APPDATA + '/OHR/requesys/executor.cmd'",
              "object_description": "Batch file path",
              "object_id": "batch_file_path",
              "intention_description": "Execute file",
              "intention_id": "execute_file"
            },
            {
              "action_api": "path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "APPDATA + '/OHR/requesys/executor.cmd'",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Determine presence of file",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "APPDATA + '/OHR/requesys/placeholder'",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Determine presence of file",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "startfile()",
              "action_description": "Opens file with associated application",
              "action_id": "open_file_app",
              "object": "APPDATA + '/OHR/requesys/executor.cmd'",
              "object_description": "Batch file path",
              "object_id": "batch_file_path",
              "intention_description": "Execute file",
              "intention_id": "execute_file"
            }
          ]
        }
      ]
    }
  ]
}