{
  "metadata": {
    "package_name": "pyexasol-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/pyexasol-0.27.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "http_transport.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pyexasol-0.27.0/pyexasol-0.27.0/pyexasol/http_transport.py",
      "line_number": "558",
      "type_description": "B830:read",
      "context_snippet": "def method_get_compressed(self):\n    try:\n        self.write_success_headers()\n        c = zlib.compressobj(wbits=16 + zlib.MAX_WBITS)\n\n        while not self.server.is_terminated:\n            #  Linux common pipe buffer, 64Kb\n            data = self.server.read_pipe.read(65536)\n\n            if data is None or len(data) == 0:\n                self.write_chunk(c.flush(zlib.Z_FINISH))\n                break\n\n            self.write_chunk(c.compress(data))\n\n    except Exception as e:\n        raise e\n\n    finally:\n        self.server.read_pipe.close()\n\n    if self.server.can_finish_get.wait() and not self.server.is_terminated:\n        self.write_final_chunk()",
      "hash_value": "77522b9266b2e25e37d30613ad202e10",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def method_get_compressed(self):\n    try:\n        self.write_success_headers()\n        c = zlib.compressobj(wbits=16 + zlib.MAX_WBITS)\n\n        while not self.server.is_terminated:\n            #  Linux common pipe buffer, 64Kb\n            data = self.server.read_pipe.read(65536)\n\n            if data is None or len(data) == 0:\n                self.write_chunk(c.flush(zlib.Z_FINISH))\n                break\n\n            self.write_chunk(c.compress(data))\n\n    except Exception as e:\n        raise e\n\n    finally:\n        self.server.read_pipe.close()\n\n    if self.server.can_finish_get.wait() and not self.server.is_terminated:\n        self.write_final_chunk()",
          "triple_sequences": [
            {
              "action_api": "self.server.read_pipe.read()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "65536",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "zlib.compressobj()",
              "action_description": "Compresses data using zlib compression",
              "action_id": "compress_data_zlib",
              "object": "wbits=16 + zlib.MAX_WBITS",
              "object_description": "Compression format specification",
              "object_id": "compression_format",
              "intention_description": "Compress data",
              "intention_id": "compress_data"
            },
            {
              "action_api": "c.compress()",
              "action_description": "Compresses data using zlib compression",
              "action_id": "compress_data_zlib",
              "object": "data",
              "object_description": "Decompressed data",
              "object_id": "decompressed_data",
              "intention_description": "Compress data",
              "intention_id": "compress_data"
            },
            {
              "action_api": "c.flush()",
              "action_description": "Compresses data using zlib compression",
              "action_id": "compress_data_zlib",
              "object": "zlib.Z_FINISH",
              "object_description": "Compression format specification",
              "object_id": "compression_format",
              "intention_description": "Compress data",
              "intention_id": "compress_data"
            },
            {
              "action_api": "self.write_chunk()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "c.compress(data) or c.flush(zlib.Z_FINISH)",
              "object_description": "Compressed data",
              "object_id": "compressed_data",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "self.server.read_pipe.close()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Close file",
              "intention_id": "close_file"
            },
            {
              "action_api": "self.server.can_finish_get.wait()",
              "action_description": "Waits for process to complete execution",
              "action_id": "wait_process_completion",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Wait for events",
              "intention_id": "wait_for_events"
            },
            {
              "action_api": "self.write_final_chunk()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            }
          ]
        }
      ]
    }
  ]
}