{
  "metadata": {
    "package_name": "vllm_nccl_cu12-2",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/vllm_nccl_cu12-2.18.1.0.4.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/vllm_nccl_cu12-2.18.1.0.4.0/vllm_nccl_cu12-2.18.1.0.4.0/setup.py",
      "line_number": "78",
      "type_description": "B819:urlretrieve",
      "context_snippet": "while True:\n    if os.path.exists(destination):\n        print(f\"nccl package already exists at {destination}\")\n    else:\n        print(f\"Downloading nccl package from {url}\")\n        try:\n            import urllib.request\n            urllib.request.urlretrieve(url, destination)\n            print(f\"nccl package downloaded to {destination}\")\n        except Exception as e:\n            print(f\"Failed to download nccl package from {url}\")\n            print(e)\n    if get_md5_hash(destination) != file_hash:\n        print(f\"md5 hash of downloaded file does not match expected hash, retrying\")\n        os.remove(destination)\n    else:\n        print(f\"md5 hash of downloaded file matches expected hash\")\n        break",
      "hash_value": "4fdc6879b61118900e25a7f2ed036ca6",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "while True:\n    if os.path.exists(destination):\n        print(f\"nccl package already exists at {destination}\")\n    else:\n        print(f\"Downloading nccl package from {url}\")\n        try:\n            import urllib.request\n            urllib.request.urlretrieve(url, destination)\n            print(f\"nccl package downloaded to {destination}\")\n        except Exception as e:\n            print(f\"Failed to download nccl package from {url}\")\n            print(e)\n    if get_md5_hash(destination) != file_hash:\n        print(f\"md5 hash of downloaded file does not match expected hash, retrying\")\n        os.remove(destination)\n    else:\n        print(f\"md5 hash of downloaded file matches expected hash\")\n        break",
          "triple_sequences": [
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "destination",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "urllib.request.urlretrieve()",
              "action_description": "Downloads file from URL to local path",
              "action_id": "download_file_url",
              "object": "url, destination",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "get_md5_hash()",
              "action_description": "Returns hexadecimal digest of MD5 hash",
              "action_id": "get_md5_digest",
              "object": "destination",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Get file size",
              "intention_id": "get_file_size"
            },
            {
              "action_api": "os.remove()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "destination",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            }
          ]
        }
      ]
    }
  ]
}