{
  "metadata": {
    "package_name": "bpython-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/bpython-0.25.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "repl.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/bpython-0.25/bpython-0.25/bpython/curtsiesfrontend/repl.py",
      "line_number": "2102",
      "type_description": "B828:signal",
      "context_snippet": "def focus_on_subprocess(self, args):\n    prev_sigwinch_handler = signal.getsignal(signal.SIGWINCH)\n    try:\n        signal.signal(signal.SIGWINCH, self.orig_sigwinch_handler)\n        with Termmode(self.orig_stdin, self.orig_tcattrs):\n            terminal = self.window.t\n            with terminal.fullscreen():\n                sys.__stdout__.write(terminal.save)\n                sys.__stdout__.write(terminal.move(0, 0))\n                sys.__stdout__.flush()\n                p = subprocess.Popen(\n                    args,\n                    stdin=self.orig_stdin,\n                    stderr=sys.__stderr__,\n                    stdout=sys.__stdout__,\n                )\n                p.wait()\n                sys.__stdout__.write(terminal.restore)\n                sys.__stdout__.flush()\n    finally:\n        signal.signal(signal.SIGWINCH, prev_sigwinch_handler)",
      "hash_value": "0ccfa763a9501475496e29ecc25f071c",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def focus_on_subprocess(self, args):\n    prev_sigwinch_handler = signal.getsignal(signal.SIGWINCH)\n    try:\n        signal.signal(signal.SIGWINCH, self.orig_sigwinch_handler)\n        with Termmode(self.orig_stdin, self.orig_tcattrs):\n            terminal = self.window.t\n            with terminal.fullscreen():\n                sys.__stdout__.write(terminal.save)\n                sys.__stdout__.write(terminal.move(0, 0))\n                sys.__stdout__.flush()\n                p = subprocess.Popen(\n                    args,\n                    stdin=self.orig_stdin,\n                    stderr=sys.__stderr__,\n                    stdout=sys.__stdout__,\n                )\n                p.wait()\n                sys.__stdout__.write(terminal.restore)\n                sys.__stdout__.flush()\n    finally:\n        signal.signal(signal.SIGWINCH, prev_sigwinch_handler)",
          "triple_sequences": [
            {
              "action_api": "signal.getsignal()",
              "action_description": "Retrieves signal handler for specified signal",
              "action_id": "get_signal_handler",
              "object": "signal.SIGWINCH",
              "object_description": "Exception type name",
              "object_id": "exception_type",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "signal.signal()",
              "action_description": "Sets signal handler for specified signal",
              "action_id": "set_signal_handler",
              "object": "signal.SIGWINCH, self.orig_sigwinch_handler",
              "object_description": "Exception type name",
              "object_id": "exception_type",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "sys.__stdout__.write()",
              "action_description": "Writes data to standard output stream",
              "action_id": "write_stdout_stream",
              "object": "terminal.save",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "sys.__stdout__.write()",
              "action_description": "Writes data to standard output stream",
              "action_id": "write_stdout_stream",
              "object": "terminal.move(0, 0)",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "sys.__stdout__.flush()",
              "action_description": "Flushes standard output stream",
              "action_id": "flush_stdout_stream",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Release system resource",
              "intention_id": "release_system_resource"
            },
            {
              "action_api": "subprocess.Popen()",
              "action_description": "Spawns new process to execute command with shell access",
              "action_id": "spawn_process_shell",
              "object": "args, stdin=self.orig_stdin, stderr=sys.__stderr__, stdout=sys.__stdout__",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Create child process",
              "intention_id": "create_child_process"
            },
            {
              "action_api": "p.wait()",
              "action_description": "Waits for process to complete execution",
              "action_id": "wait_process_completion",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Wait for events",
              "intention_id": "wait_for_events"
            },
            {
              "action_api": "sys.__stdout__.write()",
              "action_description": "Writes data to standard output stream",
              "action_id": "write_stdout_stream",
              "object": "terminal.restore",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "sys.__stdout__.flush()",
              "action_description": "Flushes standard output stream",
              "action_id": "flush_stdout_stream",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Release system resource",
              "intention_id": "release_system_resource"
            },
            {
              "action_api": "signal.signal()",
              "action_description": "Sets signal handler for specified signal",
              "action_id": "set_signal_handler",
              "object": "signal.SIGWINCH, prev_sigwinch_handler",
              "object_description": "Exception type name",
              "object_id": "exception_type",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            }
          ]
        }
      ]
    }
  ]
}