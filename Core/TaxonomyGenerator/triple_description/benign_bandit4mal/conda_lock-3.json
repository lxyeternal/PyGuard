{
  "metadata": {
    "package_name": "conda_lock-3",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/conda_lock-3.0.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "exports.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/conda_lock-3.0.0/conda_lock-3.0.0/conda_lock/_vendor/conda/exports.py",
      "line_number": "302",
      "type_description": "B815:write",
      "context_snippet": "@deprecated(\"25.3\", \"25.9\", addendum=\"Use `conda.activate` instead.\")\ndef win_conda_bat_redirect(src, dst, shell):\n    \"\"\"Special function for Windows XP where the `CreateSymbolicLink`\n    function is not available.\n\n    Simply creates a `.bat` file at `dst` which calls `src` together with\n    all command line arguments.\n\n    Works of course only with callable files, e.g. `.bat` or `.exe` files.\n    \"\"\"\n    from .utils import _SHELLS\n\n    try:\n        os.makedirs(os.path.dirname(dst))\n    except OSError as exc:  # Python >2.5\n        if exc.errno == errno.EEXIST and os.path.isdir(os.path.dirname(dst)):\n            pass\n        else:\n            raise\n\n    # bat file redirect\n    if not os.path.isfile(dst + \".bat\"):\n        with open(dst + \".bat\", \"w\") as f:\n            f.write(f'@echo off\\ncall \"{src}\" %*\\n')\n\n    # TODO: probably need one here for powershell at some point\n\n    # This one is for bash/cygwin/msys\n    # set default shell to bash.exe when not provided, as that's most common\n    if not shell:\n        shell = \"bash.exe\"\n\n    # technically these are \"links\" - but islink doesn't work on win\n    if not os.path.isfile(dst):\n        with open(dst, \"w\") as f:\n            f.write(\"#!/usr/bin/env bash \\n\")\n            if src.endswith(\"conda\"):\n                f.write('{} \"$@\"'.format(_SHELLS[shell][\"path_to\"](src + \".exe\")))\n            else:\n                f.write('source {} \"$@\"'.format(_SHELLS[shell][\"path_to\"](src)))\n        # Make the new file executable\n        # http://stackoverflow.com/a/30463972/1170370\n        mode = os.stat(dst).st_mode\n        mode |= (mode & 292) >> 2  # copy R bits to X\n        os.chmod(dst, mode)",
      "hash_value": "51e1517e8a4983e1c6ff35351acd2761",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "@deprecated(\"25.3\", \"25.9\", addendum=\"Use `conda.activate` instead.\")\ndef win_conda_bat_redirect(src, dst, shell):\n    \"\"\"Special function for Windows XP where the `CreateSymbolicLink`\n    function is not available.\n\n    Simply creates a `.bat` file at `dst` which calls `src` together with\n    all command line arguments.\n\n    Works of course only with callable files, e.g. `.bat` or `.exe` files.\n    \"\"\"\n    from .utils import _SHELLS\n\n    try:\n        os.makedirs(os.path.dirname(dst))\n    except OSError as exc:  # Python >2.5\n        if exc.errno == errno.EEXIST and os.path.isdir(os.path.dirname(dst)):\n            pass\n        else:\n            raise\n\n    # bat file redirect\n    if not os.path.isfile(dst + \".bat\"):\n        with open(dst + \".bat\", \"w\") as f:\n            f.write(f'@echo off\\ncall \"{src}\" %*\\n')\n\n    # TODO: probably need one here for powershell at some point\n\n    # This one is for bash/cygwin/msys\n    # set default shell to bash.exe when not provided, as that's most common\n    if not shell:\n        shell = \"bash.exe\"\n\n    # technically these are \"links\" - but islink doesn't work on win\n    if not os.path.isfile(dst):\n        with open(dst, \"w\") as f:\n            f.write(\"#!/usr/bin/env bash \\n\")\n            if src.endswith(\"conda\"):\n                f.write('{} \"$@\"'.format(_SHELLS[shell][\"path_to\"](src + \".exe\")))\n            else:\n                f.write('source {} \"$@\"'.format(_SHELLS[shell][\"path_to\"](src)))\n        # Make the new file executable\n        # http://stackoverflow.com/a/30463972/1170370\n        mode = os.stat(dst).st_mode\n        mode |= (mode & 292) >> 2  # copy R bits to X\n        os.chmod(dst, mode)",
          "triple_sequences": [
            {
              "action_api": "os.makedirs()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "os.path.dirname(dst)",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "os.path.isdir()",
              "action_description": "Checks if specified path exists and is a directory",
              "action_id": "check_directory_exists",
              "object": "os.path.dirname(dst)",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Determine presence of directory",
              "intention_id": "determine_directory_presence"
            },
            {
              "action_api": "os.path.isfile()",
              "action_description": "Checks if specified path exists and is a file",
              "action_id": "check_file_is_file",
              "object": "dst + \".bat\"",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Determine presence of file",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "dst + \".bat\"",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f'@echo off\\ncall \"{src}\" %*\\n'",
              "object_description": "Batch file content",
              "object_id": "batch_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "os.path.isfile()",
              "action_description": "Checks if specified path exists and is a file",
              "action_id": "check_file_is_file",
              "object": "dst",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Determine presence of file",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "dst",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "#!/usr/bin/env bash \n",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "str.endswith()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "src",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Prepare path for file operations",
              "intention_id": "prepare_path_file_operations"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "{} \"$@\".format(_SHELLS[shell][\"path_to\"](src + \".exe\"))",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "source {} \"$@\".format(_SHELLS[shell][\"path_to\"](src))",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "os.stat()",
              "action_description": "Retrieves file status",
              "action_id": "path_object_operations",
              "object": "dst",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Access file content",
              "intention_id": "access_file_content"
            },
            {
              "action_api": "os.chmod()",
              "action_description": "Changes file mode to add execute permission",
              "action_id": "change_file_mode_execute",
              "object": "dst, mode",
              "object_description": "File permission",
              "object_id": "file_permission",
              "intention_description": "Modify file attributes",
              "intention_id": "modify_file_attributes"
            }
          ]
        }
      ]
    }
  ]
}