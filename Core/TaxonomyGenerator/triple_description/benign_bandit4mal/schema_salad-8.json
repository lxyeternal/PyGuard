{
  "metadata": {
    "package_name": "schema_salad-8",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/schema_salad-8.9.20250408123006.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "cpp_codegen.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/schema_salad-8.9.20250408123006/schema_salad-8.9.20250408123006/schema_salad/cpp_codegen.py",
      "line_number": "196",
      "type_description": "B815:write",
      "context_snippet": "def writeImplDefinition(\n    self, target: IO[str], fullInd: str, ind: str, common_namespace: str\n) -> None:\n    \"\"\"Write definition with implementation.\"\"\"\n    extends = list(map(safename2, self.extends))\n\n    # Declaring default destructor\n    if self.abstract:\n        target.write(\n            f\"{fullInd}inline {self.namespace}::{self.classname}::~{self.classname}() = default;\\n\"\n        )\n\n    # Write toYaml function\n    target.write(\n        f\"{fullInd}inline auto {self.namespace}::{self.classname}::toYaml([[maybe_unused]] \"\n        f\"::{common_namespace}::store_config const& config) const -> YAML::Node {{\\n\"\n        f\"{fullInd}{ind}using ::{common_namespace}::toYaml;\\n\"\n        f\"{fullInd}{ind}auto n = YAML::Node{{}};\\n\"\n        f\"{fullInd}{ind}if (config.generateTags) {{\\n\"\n        f'{fullInd}{ind}{ind}n.SetTag(\"{self.classname}\");\\n'\n        f\"{fullInd}{ind}}}\\n\"\n    )\n    for e in extends:\n        target.write(f\"{fullInd}{ind}n = mergeYaml(n, {e}::toYaml(config));\\n\")\n\n    for field in self.fields:\n        fieldname = safename(field.name)\n\n        target.write(f\"{fullInd}{ind}{{\\n\")\n        target.write(f\"{fullInd}{ind}{ind} auto member = toYaml(*{fieldname}, config);\\n\")\n        if field.typeDSL:\n            target.write(f\"{fullInd}{ind}{ind} member = simplifyType(member, config);\\n\")\n        target.write(\n            f\"{fullInd}{ind}{ind} member = convertListToMap(member, \"\n            f\"{q(field.mapSubject)}, {q(field.mapPredicate)}, config);\\n\"\n        )\n        target.write(f\"{fullInd}{ind}{ind}addYamlField(n, {q(field.name)}, member);\\n\")\n        target.write(f\"{fullInd}{ind}}}\\n\")\n\n    target.write(f\"{fullInd}{ind}return n;\\n{fullInd}}}\\n\")\n\n    # Write fromYaml function\n    functionname = f\"{self.namespace}::{self.classname}::fromYaml\"\n    target.write(\n        f\"{fullInd}inline void {functionname}([[maybe_unused]] YAML::Node const& n) {{\\n\"\n        f\"{fullInd}{ind}using ::{common_namespace}::fromYaml;\\n\"\n    )\n    for e in extends:\n        target.write(f\"{fullInd}{ind}{e}::fromYaml(n);\\n\")\n\n    for field in self.fields:\n        fieldname = safename(field.name)\n        expandType = \"\"\n        if field.typeDSL:\n            expandType = \"expandType\"\n\n        target.write(\n            f\"{fullInd}{ind}{{\\n\"\n            f\"{fullInd}{ind}{ind}auto nodeAsList = convertMapToList(\"\n            f\"n[{q(field.name)}], {q(field.mapSubject)}, {q(field.mapPredicate)});\\n\"\n            f\"{fullInd}{ind}{ind}auto expandedNode = {expandType}(nodeAsList);\\n\"\n            f\"{fullInd}{ind}{ind}fromYaml(expandedNode, *{fieldname});\\n\"\n            f\"{fullInd}{ind}}}\\n\"\n        )\n\n    target.write(f\"{fullInd}}}\\n\")\n\n    # write type detection function\n    if not self.abstract:\n        e = f\"::{self.namespace}::{self.classname}\"\n        target.write(\n            f\"namespace {common_namespace} {{\\n\"\n            f\"template <>\\n\"\n            f\"struct DetectAndExtractFromYaml<{e}> {{\\n\"\n            f\"    auto operator()(YAML::Node const& n) const -> std::optional<{e}> {{\\n\"\n            f\"        if (!n.IsDefined()) return std::nullopt;\\n\"\n            f\"        if (!n.IsMap()) return std::nullopt;\\n\"\n            f\"        auto res = {e}{{}};\\n\\n\"\n        )\n        for field in self.fields:\n            fieldname = safename(field.name)\n            target.write(\n                f\"        if constexpr (::{common_namespace}::IsConstant<\"\n                f\"decltype(res.{fieldname})::value_t>::value) try {{\\n\"\n                f\"            fromYaml(n[{q(field.name)}], *res.{fieldname});\\n\"\n                \"            fromYaml(n, res);\\n\"\n                \"            return res;\\n\"\n                f\"        }} catch(...) {{}}\\n\\n\"\n            )\n        target.write(\"        return std::nullopt;\\n    }\\n};\\n}\\n\")",
      "hash_value": "2f455c58ed0706c1ad6687c5cf4fca4a",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def writeImplDefinition(\n    self, target: IO[str], fullInd: str, ind: str, common_namespace: str\n) -> None:\n    \"\"\"Write definition with implementation.\"\"\"\n    extends = list(map(safename2, self.extends))\n\n    # Declaring default destructor\n    if self.abstract:\n        target.write(\n            f\"{fullInd}inline {self.namespace}::{self.classname}::~{self.classname}() = default;\\n\"\n        )\n\n    # Write toYaml function\n    target.write(\n        f\"{fullInd}inline auto {self.namespace}::{self.classname}::toYaml([[maybe_unused]] \"\n        f\"::{common_namespace}::store_config const& config) const -> YAML::Node {{\\n\"\n        f\"{fullInd}{ind}using ::{common_namespace}::toYaml;\\n\"\n        f\"{fullInd}{ind}auto n = YAML::Node{{}};\\n\"\n        f\"{fullInd}{ind}if (config.generateTags) {{\\n\"\n        f'{fullInd}{ind}{ind}n.SetTag(\"{self.classname}\");\\n'\n        f\"{fullInd}{ind}}}\\n\"\n    )\n    for e in extends:\n        target.write(f\"{fullInd}{ind}n = mergeYaml(n, {e}::toYaml(config));\\n\")\n\n    for field in self.fields:\n        fieldname = safename(field.name)\n\n        target.write(f\"{fullInd}{ind}{{\\n\")\n        target.write(f\"{fullInd}{ind}{ind} auto member = toYaml(*{fieldname}, config);\\n\")\n        if field.typeDSL:\n            target.write(f\"{fullInd}{ind}{ind} member = simplifyType(member, config);\\n\")\n        target.write(\n            f\"{fullInd}{ind}{ind} member = convertListToMap(member, \"\n            f\"{q(field.mapSubject)}, {q(field.mapPredicate)}, config);\\n\"\n        )\n        target.write(f\"{fullInd}{ind}{ind}addYamlField(n, {q(field.name)}, member);\\n\")\n        target.write(f\"{fullInd}{ind}}}\\n\")\n\n    target.write(f\"{fullInd}{ind}return n;\\n{fullInd}}}\\n\")\n\n    # Write fromYaml function\n    functionname = f\"{self.namespace}::{self.classname}::fromYaml\"\n    target.write(\n        f\"{fullInd}inline void {functionname}([[maybe_unused]] YAML::Node const& n) {{\\n\"\n        f\"{fullInd}{ind}using ::{common_namespace}::fromYaml;\\n\"\n    )\n    for e in extends:\n        target.write(f\"{fullInd}{ind}{e}::fromYaml(n);\\n\")\n\n    for field in self.fields:\n        fieldname = safename(field.name)\n        expandType = \"\"\n        if field.typeDSL:\n            expandType = \"expandType\"\n\n        target.write(\n            f\"{fullInd}{ind}{{\\n\"\n            f\"{fullInd}{ind}{ind}auto nodeAsList = convertMapToList(\"\n            f\"n[{q(field.name)}], {q(field.mapSubject)}, {q(field.mapPredicate)});\\n\"\n            f\"{fullInd}{ind}{ind}auto expandedNode = {expandType}(nodeAsList);\\n\"\n            f\"{fullInd}{ind}{ind}fromYaml(expandedNode, *{fieldname});\\n\"\n            f\"{fullInd}{ind}}}\\n\"\n        )\n\n    target.write(f\"{fullInd}}}\\n\")\n\n    # write type detection function\n    if not self.abstract:\n        e = f\"::{self.namespace}::{self.classname}\"\n        target.write(\n            f\"namespace {common_namespace} {{\\n\"\n            f\"template <>\\n\"\n            f\"struct DetectAndExtractFromYaml<{e}> {{\\n\"\n            f\"    auto operator()(YAML::Node const& n) const -> std::optional<{e}> {{\\n\"\n            f\"        if (!n.IsDefined()) return std::nullopt;\\n\"\n            f\"        if (!n.IsMap()) return std::nullopt;\\n\"\n            f\"        auto res = {e}{{}};\\n\\n\"\n        )\n        for field in self.fields:\n            fieldname = safename(field.name)\n            target.write(\n                f\"        if constexpr (::{common_namespace}::IsConstant<\"\n                f\"decltype(res.{fieldname})::value_t>::value) try {{\\n\"\n                f\"            fromYaml(n[{q(field.name)}], *res.{fieldname});\\n\"\n                \"            fromYaml(n, res);\\n\"\n                \"            return res;\\n\"\n                f\"        }} catch(...) {{}}\\n\\n\"\n            )\n        target.write(\"        return std::nullopt;\\n    }\\n};\\n}\\n\")",
          "triple_sequences": [
            {
              "action_api": "target.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f\"{fullInd}inline {self.namespace}::{self.classname}::~{self.classname}() = default;\\n\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "target.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f\"{fullInd}inline auto {self.namespace}::{self.classname}::toYaml([[maybe_unused]] ::{common_namespace}::store_config const& config) const -> YAML::Node {{\\n{fullInd}{ind}using ::{common_namespace}::toYaml;\\n{fullInd}{ind}auto n = YAML::Node{{}};\\n{fullInd}{ind}if (config.generateTags) {{\\n{fullInd}{ind}{ind}n.SetTag(\\\"{self.classname}\\\");\\n{fullInd}{ind}}}\\n\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "target.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f\"{fullInd}{ind}n = mergeYaml(n, {e}::toYaml(config));\\n\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "target.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f\"{fullInd}{ind}{{\\n\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "target.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f\"{fullInd}{ind}{ind} auto member = toYaml(*{fieldname}, config);\\n\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "target.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f\"{fullInd}{ind}{ind} member = simplifyType(member, config);\\n\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "target.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f\"{fullInd}{ind}{ind} member = convertListToMap(member, {q(field.mapSubject)}, {q(field.mapPredicate)}, config);\\n\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "target.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f\"{fullInd}{ind}{ind}addYamlField(n, {q(field.name)}, member);\\n\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "target.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f\"{fullInd}{ind}}}\\n\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "target.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f\"{fullInd}{ind}return n;\\n{fullInd}}}\\n\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "target.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f\"{fullInd}inline void {functionname}([[maybe_unused]] YAML::Node const& n) {{\\n{fullInd}{ind}using ::{common_namespace}::fromYaml;\\n\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "target.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f\"{fullInd}{ind}{e}::fromYaml(n);\\n\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "target.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f\"{fullInd}{ind}{{\\n{fullInd}{ind}{ind}auto nodeAsList = convertMapToList(n[{q(field.name)}], {q(field.mapSubject)}, {q(field.mapPredicate)});\\n{fullInd}{ind}{ind}auto expandedNode = {expandType}(nodeAsList);\\n{fullInd}{ind}{ind}fromYaml(expandedNode, *{fieldname});\\n{fullInd}{ind}}}\\n\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "target.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f\"{fullInd}}}\\n\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "target.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f\"namespace {common_namespace} {{\\ntemplate <>\nstruct DetectAndExtractFromYaml<{e}> {{\\n    auto operator()(YAML::Node const& n) const -> std::optional<{e}> {{\\n        if (!n.IsDefined()) return std::nullopt;\\n        if (!n.IsMap()) return std::nullopt;\\n        auto res = {e}{{}};\\n\\n\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "target.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f\"        if constexpr (::{common_namespace}::IsConstant<decltype(res.{fieldname})::value_t>::value) try {{\\n            fromYaml(n[{q(field.name)}], *res.{fieldname});\\n            fromYaml(n, res);\\n            return res;\\n        }} catch(...) {{}}\\n\\n\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "target.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"        return std::nullopt;\\n    }\\n};\\n}\\n\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            }
          ]
        }
      ]
    }
  ]
}