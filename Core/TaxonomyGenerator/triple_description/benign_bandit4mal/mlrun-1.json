{
  "metadata": {
    "package_name": "mlrun-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/mlrun-1.9.0rc3-py3-none-any.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "packagers_manager.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/mlrun-1.9.0rc3-py3-none-any/mlrun/package/packagers_manager.py",
      "line_number": "358",
      "type_description": "B836:rmtree",
      "context_snippet": "def clear_packagers_outputs(self):\n    \"\"\"\n    Clear the outputs of all packagers. This method should be called at the end of the run, only after logging all\n    artifacts, to ensure that files that require uploading have already been uploaded.\n    \"\"\"\n    for packager in self._get_packagers_with_default_packager():\n        for path in packager.future_clearing_path_list:\n            if not os.path.exists(path):\n                continue\n            if os.path.isdir(path):\n                shutil.rmtree(path)\n            else:\n                os.remove(path)\n        packager.future_clearing_path_list.clear()",
      "hash_value": "0be9fbc3474c2ce4b9775094e72234b0",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def clear_packagers_outputs(self):\n    \"\"\"\n    Clear the outputs of all packagers. This method should be called at the end of the run, only after logging all\n    artifacts, to ensure that files that require uploading have already been uploaded.\n    \"\"\"\n    for packager in self._get_packagers_with_default_packager():\n        for path in packager.future_clearing_path_list:\n            if not os.path.exists(path):\n                continue\n            if os.path.isdir(path):\n                shutil.rmtree(path)\n            else:\n                os.remove(path)\n        packager.future_clearing_path_list.clear()",
          "triple_sequences": [
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "path",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "os.path.isdir()",
              "action_description": "Checks if specified path exists and is a directory",
              "action_id": "check_directory_exists",
              "object": "path",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Determine presence of directory",
              "intention_id": "determine_directory_presence"
            },
            {
              "action_api": "shutil.rmtree()",
              "action_description": "Recursively deletes directory and its contents",
              "action_id": "delete_directory",
              "object": "path",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Delete directory content",
              "intention_id": "delete_directory_content"
            },
            {
              "action_api": "os.remove()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "path",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            },
            {
              "action_api": "packager.future_clearing_path_list.clear()",
              "action_description": "Deletes all items from list object",
              "action_id": "delete_directory",
              "object": "packager.future_clearing_path_list",
              "object_description": "",
              "object_id": "",
              "intention_description": "Delete directory content",
              "intention_id": "delete_directory_content"
            }
          ]
        }
      ]
    }
  ]
}