{
  "metadata": {
    "package_name": "python_telegram_bot-22",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/python_telegram_bot-22.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "encryptedpassportelement.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/python_telegram_bot-22.0/python_telegram_bot-22.0/telegram/_passport/encryptedpassportelement.py",
      "line_number": "244",
      "type_description": "B801:b64decode",
      "context_snippet": "from base64 import b64decode\nfrom telegram._passport.credentials import decrypt_json\nfrom telegram._passport.data import IdDocumentData, PersonalDetails, ResidentialAddress\nfrom telegram._passport.passportfile import PassportFile\nfrom telegram._utils.argumentparsing import (\n    de_json_decrypted_optional,\n    de_json_optional,\n    de_list_decrypted_optional,\n    de_list_optional,\n    parse_sequence_arg,\n)\n\n@classmethod\ndef de_json_decrypted(\n    cls, data: JSONDict, bot: Optional[\"Bot\"], credentials: \"Credentials\"\n) -> \"EncryptedPassportElement\":\n    \"\"\"Variant of :meth:`telegram.TelegramObject.de_json` that also takes into account\n    passport credentials.\n\n    Args:\n        data (dict[:obj:`str`, ...]): The JSON data.\n        bot (:class:`telegram.Bot` | :obj:`None`): The bot associated with these object.\n            May be :obj:`None`, in which case shortcut methods will not be available.\n\n            .. versionchanged:: 21.4\n               :paramref:`bot` is now optional and defaults to :obj:`None`\n\n            .. deprecated:: 21.4\n               This argument will be converted to an optional argument in future versions.\n        credentials (:class:`telegram.FileCredentials`): The credentials\n\n    Returns:\n        :class:`telegram.EncryptedPassportElement`:\n\n    \"\"\"\n\n    if data[\"type\"] not in (\"phone_number\", \"email\"):\n        secure_data = getattr(credentials.secure_data, data[\"type\"])\n\n        if secure_data.data is not None:\n            # If not already decrypted\n            if not isinstance(data[\"data\"], dict):\n                data[\"data\"] = decrypt_json(\n                    b64decode(secure_data.data.secret),\n                    b64decode(secure_data.data.hash),\n                    b64decode(data[\"data\"]),\n                )\n            if data[\"type\"] == \"personal_details\":\n                data[\"data\"] = PersonalDetails.de_json(data[\"data\"], bot=bot)\n            elif data[\"type\"] in (\n                \"passport\",\n                \"internal_passport\",\n                \"driver_license\",\n                \"identity_card\",\n            ):\n                data[\"data\"] = IdDocumentData.de_json(data[\"data\"], bot=bot)\n            elif data[\"type\"] == \"address\":\n                data[\"data\"] = ResidentialAddress.de_json(data[\"data\"], bot=bot)\n\n        data[\"files\"] = (\n            de_list_decrypted_optional(data.get(\"files\"), PassportFile, bot, secure_data.files)\n            or None\n        )\n        data[\"front_side\"] = de_json_decrypted_optional(\n            data.get(\"front_side\"), PassportFile, bot, secure_data.front_side\n        )\n        data[\"reverse_side\"] = de_json_decrypted_optional(\n            data.get(\"reverse_side\"), PassportFile, bot, secure_data.reverse_side\n        )\n        data[\"selfie\"] = de_json_decrypted_optional(\n            data.get(\"selfie\"), PassportFile, bot, secure_data.selfie\n        )\n        data[\"translation\"] = (\n            de_list_decrypted_optional(\n                data.get(\"translation\"), PassportFile, bot, secure_data.translation\n            )\n            or None\n        )\n\n    return super().de_json(data=data, bot=bot)\n",
      "hash_value": "d6d947cbd02445b28e1c249bbab8b35d",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "from base64 import b64decode\nfrom telegram._passport.credentials import decrypt_json\nfrom telegram._passport.data import IdDocumentData, PersonalDetails, ResidentialAddress\nfrom telegram._passport.passportfile import PassportFile\nfrom telegram._utils.argumentparsing import (\n    de_json_decrypted_optional,\n    de_json_optional,\n    de_list_decrypted_optional,\n    de_list_optional,\n    parse_sequence_arg,\n)\n\n@classmethod\ndef de_json_decrypted(\n    cls, data: JSONDict, bot: Optional[\"Bot\"], credentials: \"Credentials\"\n) -> \"EncryptedPassportElement\":\n    \"\"\"Variant of :meth:`telegram.TelegramObject.de_json` that also takes into account\n    passport credentials.\n\n    Args:\n        data (dict[:obj:`str`, ...]): The JSON data.\n        bot (:class:`telegram.Bot` | :obj:`None`): The bot associated with these object.\n            May be :obj:`None`, in which case shortcut methods will not be available.\n\n            .. versionchanged:: 21.4\n               :paramref:`bot` is now optional and defaults to :obj:`None`\n\n            .. deprecated:: 21.4\n               This argument will be converted to an optional argument in future versions.\n        credentials (:class:`telegram.FileCredentials`): The credentials\n\n    Returns:\n        :class:`telegram.EncryptedPassportElement`:\n\n    \"\"\"\n\n    if data[\"type\"] not in (\"phone_number\", \"email\"):\n        secure_data = getattr(credentials.secure_data, data[\"type\"])\n\n        if secure_data.data is not None:\n            # If not already decrypted\n            if not isinstance(data[\"data\"], dict):\n                data[\"data\"] = decrypt_json(\n                    b64decode(secure_data.data.secret),\n                    b64decode(secure_data.data.hash),\n                    b64decode(data[\"data\"]),\n                )\n            if data[\"type\"] == \"personal_details\":\n                data[\"data\"] = PersonalDetails.de_json(data[\"data\"], bot=bot)\n            elif data[\"type\"] in (\n                \"passport\",\n                \"internal_passport\",\n                \"driver_license\",\n                \"identity_card\",\n            ):\n                data[\"data\"] = IdDocumentData.de_json(data[\"data\"], bot=bot)\n            elif data[\"type\"] == \"address\":\n                data[\"data\"] = ResidentialAddress.de_json(data[\"data\"], bot=bot)\n\n        data[\"files\"] = (\n            de_list_decrypted_optional(data.get(\"files\"), PassportFile, bot, secure_data.files)\n            or None\n        )\n        data[\"front_side\"] = de_json_decrypted_optional(\n            data.get(\"front_side\"), PassportFile, bot, secure_data.front_side\n        )\n        data[\"reverse_side\"] = de_json_decrypted_optional(\n            data.get(\"reverse_side\"), PassportFile, bot, secure_data.reverse_side\n        )\n        data[\"selfie\"] = de_json_decrypted_optional(\n            data.get(\"selfie\"), PassportFile, bot, secure_data.selfie\n        )\n        data[\"translation\"] = (\n            de_list_decrypted_optional(\n                data.get(\"translation\"), PassportFile, bot, secure_data.translation\n            )\n            or None\n        )\n\n    return super().de_json(data=data, bot=bot)\n",
          "triple_sequences": [
            {
              "action_api": "b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_to_bytes",
              "object": "secure_data.data.secret",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Prepare data for base64 decoding",
              "intention_id": "prepare_data_base64_decoding"
            },
            {
              "action_api": "b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_to_bytes",
              "object": "secure_data.data.hash",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Prepare data for base64 decoding",
              "intention_id": "prepare_data_base64_decoding"
            },
            {
              "action_api": "b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_to_bytes",
              "object": "data[\"data\"]",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Prepare data for base64 decoding",
              "intention_id": "prepare_data_base64_decoding"
            },
            {
              "action_api": "decrypt_json()",
              "action_description": "Decrypts Fernet-encrypted data",
              "action_id": "decrypt_fernet_data",
              "object": "b64decode(secure_data.data.secret), b64decode(secure_data.data.hash), b64decode(data[\"data\"])",
              "object_description": "Fernet-encrypted byte string",
              "object_id": "fernet_encrypted_bytes",
              "intention_description": "Decrypt encrypted data",
              "intention_id": "decrypt_encrypted_data"
            },
            {
              "action_api": "PersonalDetails.de_json()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "data[\"data\"]",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "IdDocumentData.de_json()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "data[\"data\"]",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "ResidentialAddress.de_json()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "data[\"data\"]",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "de_list_decrypted_optional()",
              "action_description": "Deserializes Python object from bytes",
              "action_id": "deserialize_from_bytes",
              "object": "data.get(\"files\"), PassportFile, bot, secure_data.files",
              "object_description": "Local file or directory",
              "object_id": "local_file_or_directory",
              "intention_description": "Extract structured data from file",
              "intention_id": "extract_structured_file_data"
            },
            {
              "action_api": "de_json_decrypted_optional()",
              "action_description": "Deserializes Python object from bytes",
              "action_id": "deserialize_from_bytes",
              "object": "data.get(\"front_side\"), PassportFile, bot, secure_data.front_side",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Extract structured data from file",
              "intention_id": "extract_structured_file_data"
            },
            {
              "action_api": "de_json_decrypted_optional()",
              "action_description": "Deserializes Python object from bytes",
              "action_id": "deserialize_from_bytes",
              "object": "data.get(\"reverse_side\"), PassportFile, bot, secure_data.reverse_side",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Extract structured data from file",
              "intention_id": "extract_structured_file_data"
            },
            {
              "action_api": "de_json_decrypted_optional()",
              "action_description": "Deserializes Python object from bytes",
              "action_id": "deserialize_from_bytes",
              "object": "data.get(\"selfie\"), PassportFile, bot, secure_data.selfie",
              "object_description": "Image file",
              "object_id": "image_file",
              "intention_description": "Extract structured data from file",
              "intention_id": "extract_structured_file_data"
            },
            {
              "action_api": "de_list_decrypted_optional()",
              "action_description": "Deserializes Python object from bytes",
              "action_id": "deserialize_from_bytes",
              "object": "data.get(\"translation\"), PassportFile, bot, secure_data.translation",
              "object_description": "Local file or directory",
              "object_id": "local_file_or_directory",
              "intention_description": "Extract structured data from file",
              "intention_id": "extract_structured_file_data"
            },
            {
              "action_api": "super().de_json()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "data=data, bot=bot",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            }
          ]
        }
      ]
    }
  ]
}