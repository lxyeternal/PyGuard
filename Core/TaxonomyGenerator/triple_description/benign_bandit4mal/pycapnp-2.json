{
  "metadata": {
    "package_name": "pycapnp-2",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/pycapnp-2.0.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "async_ssl_calculator_client.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pycapnp-2.0.0/pycapnp-2.0.0/examples/async_ssl_calculator_client.py",
      "line_number": "197",
      "type_description": "B831:send",
      "context_snippet": "async def main(host):\n    addr, port = host.split(\":\")\n\n    # Setup SSL context\n    ctx = ssl.create_default_context(\n        ssl.Purpose.SERVER_AUTH, cafile=os.path.join(this_dir, \"selfsigned.cert\")\n    )\n\n    # Handle both IPv4 and IPv6 cases\n    try:\n        print(\"Try IPv4\")\n        stream = await capnp.AsyncIoStream.create_connection(\n            addr, port, ssl=ctx, family=socket.AF_INET\n        )\n    except Exception:\n        print(\"Try IPv6\")\n        stream = await capnp.AsyncIoStream.create_connection(\n            addr, port, ssl=ctx, family=socket.AF_INET6\n        )\n\n    client = capnp.TwoPartyClient(stream)\n\n    # Bootstrap the Calculator interface\n    calculator = client.bootstrap().cast_as(calculator_capnp.Calculator)\n\n    ...\n\n    # Get the \"add\" function from the server.\n    add = calculator.getOperator(op=\"add\").func\n    # Get the \"multiply\" function from the server.\n    multiply = calculator.getOperator(op=\"multiply\").func\n\n    # Build the request to evaluate 4 * 6\n    request = calculator.evaluate_request()\n\n    multiply_call = request.expression.init(\"call\")\n    multiply_call.function = multiply\n    multiply_params = multiply_call.init(\"params\", 2)\n    multiply_params[0].literal = 4\n    multiply_params[1].literal = 6\n\n    multiply_result = request.send().value\n\n    # Use the result in two calls that add 3 and add 5.\n\n    add_3_request = calculator.evaluate_request()\n    add_3_call = add_3_request.expression.init(\"call\")\n    add_3_call.function = add\n    add_3_params = add_3_call.init(\"params\", 2)\n    add_3_params[0].previousResult = multiply_result\n    add_3_params[1].literal = 3\n    add_3_promise = add_3_request.send().value.read()\n\n    add_5_request = calculator.evaluate_request()\n    add_5_call = add_5_request.expression.init(\"call\")\n    add_5_call.function = add\n    add_5_params = add_5_call.init(\"params\", 2)\n    add_5_params[0].previousResult = multiply_result\n    add_5_params[1].literal = 5\n    add_5_promise = add_5_request.send().value.read()\n\n    # Now wait for the results.\n    assert (await add_3_promise).value == 27\n    assert (await add_5_promise).value == 29\n\n    print(\"PASS\")",
      "hash_value": "f2699ef94e58d6bc096276f9cd4d535f",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "async def main(host):\n    addr, port = host.split(\":\")\n\n    # Setup SSL context\n    ctx = ssl.create_default_context(\n        ssl.Purpose.SERVER_AUTH, cafile=os.path.join(this_dir, \"selfsigned.cert\")\n    )\n\n    # Handle both IPv4 and IPv6 cases\n    try:\n        print(\"Try IPv4\")\n        stream = await capnp.AsyncIoStream.create_connection(\n            addr, port, ssl=ctx, family=socket.AF_INET\n        )\n    except Exception:\n        print(\"Try IPv6\")\n        stream = await capnp.AsyncIoStream.create_connection(\n            addr, port, ssl=ctx, family=socket.AF_INET6\n        )\n\n    client = capnp.TwoPartyClient(stream)\n\n    # Bootstrap the Calculator interface\n    calculator = client.bootstrap().cast_as(calculator_capnp.Calculator)\n\n    ...\n\n    # Get the \"add\" function from the server.\n    add = calculator.getOperator(op=\"add\").func\n    # Get the \"multiply\" function from the server.\n    multiply = calculator.getOperator(op=\"multiply\").func\n\n    # Build the request to evaluate 4 * 6\n    request = calculator.evaluate_request()\n\n    multiply_call = request.expression.init(\"call\")\n    multiply_call.function = multiply\n    multiply_params = multiply_call.init(\"params\", 2)\n    multiply_params[0].literal = 4\n    multiply_params[1].literal = 6\n\n    multiply_result = request.send().value\n\n    # Use the result in two calls that add 3 and add 5.\n\n    add_3_request = calculator.evaluate_request()\n    add_3_call = add_3_request.expression.init(\"call\")\n    add_3_call.function = add\n    add_3_params = add_3_call.init(\"params\", 2)\n    add_3_params[0].previousResult = multiply_result\n    add_3_params[1].literal = 3\n    add_3_promise = add_3_request.send().value.read()\n\n    add_5_request = calculator.evaluate_request()\n    add_5_call = add_5_request.expression.init(\"call\")\n    add_5_call.function = add\n    add_5_params = add_5_call.init(\"params\", 2)\n    add_5_params[0].previousResult = multiply_result\n    add_5_params[1].literal = 5\n    add_5_promise = add_5_request.send().value.read()\n\n    # Now wait for the results.\n    assert (await add_3_promise).value == 27\n    assert (await add_5_promise).value == 29\n\n    print(\"PASS\")",
          "triple_sequences": [
            {
              "action_api": "ssl.create_default_context()",
              "action_description": "Creates SSL context with specified protocol",
              "action_id": "create_ssl_context",
              "object": "ssl.Purpose.SERVER_AUTH, cafile=os.path.join(this_dir, \"selfsigned.cert\")",
              "object_description": "System configuration file",
              "object_id": "system_config_file",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "this_dir, \"selfsigned.cert\"",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "capnp.AsyncIoStream.create_connection()",
              "action_description": "Establishes TCP connection to specified address",
              "action_id": "establish_tcp_connection",
              "object": "addr, port, ssl=ctx, family=socket.AF_INET",
              "object_description": "Public IP address and port",
              "object_id": "public_ip_port",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "capnp.AsyncIoStream.create_connection()",
              "action_description": "Establishes TCP connection to specified address",
              "action_id": "establish_tcp_connection",
              "object": "addr, port, ssl=ctx, family=socket.AF_INET6",
              "object_description": "Public IP address and port",
              "object_id": "public_ip_port",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "capnp.TwoPartyClient()",
              "action_description": "Creates new socket object",
              "action_id": "create_socket",
              "object": "stream",
              "object_description": "Socket address",
              "object_id": "socket_address",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "client.bootstrap()",
              "action_description": "Creates new socket object",
              "action_id": "create_socket",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "calculator.getOperator()",
              "action_description": "Creates HTTP request object with specified URL, data, and headers",
              "action_id": "create_http_request",
              "object": "op=\"add\"",
              "object_description": "Function and arguments",
              "object_id": "function_with_arguments",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "calculator.getOperator()",
              "action_description": "Creates HTTP request object with specified URL, data, and headers",
              "action_id": "create_http_request",
              "object": "op=\"multiply\"",
              "object_description": "Function and arguments",
              "object_id": "function_with_arguments",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "calculator.evaluate_request()",
              "action_description": "Creates HTTP request object with specified URL, data, and headers",
              "action_id": "create_http_request",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "request.expression.init()",
              "action_description": "Creates new socket object",
              "action_id": "create_socket",
              "object": "\"call\"",
              "object_description": "Function and arguments",
              "object_id": "function_with_arguments",
              "intention_description": "Prepare argument for shortcut",
              "intention_id": "prepare_shortcut_argument"
            },
            {
              "action_api": "multiply_call.init()",
              "action_description": "Creates new socket object",
              "action_id": "create_socket",
              "object": "\"params\", 2",
              "object_description": "Function and arguments",
              "object_id": "function_with_arguments",
              "intention_description": "Prepare argument for shortcut",
              "intention_id": "prepare_shortcut_argument"
            },
            {
              "action_api": "request.send()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Send data to server",
              "intention_id": "send_data_server"
            },
            {
              "action_api": "calculator.evaluate_request()",
              "action_description": "Creates HTTP request object with specified URL, data, and headers",
              "action_id": "create_http_request",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "add_3_call.init()",
              "action_description": "Creates new socket object",
              "action_id": "create_socket",
              "object": "\"params\", 2",
              "object_description": "Function and arguments",
              "object_id": "function_with_arguments",
              "intention_description": "Prepare argument for shortcut",
              "intention_id": "prepare_shortcut_argument"
            },
            {
              "action_api": "add_3_request.send()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Send data to server",
              "intention_id": "send_data_server"
            },
            {
              "action_api": "add_3_promise.read()",
              "action_description": "Receives data from socket connection",
              "action_id": "receive_socket_data",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Receive file data from server",
              "intention_id": "receive_file_data_from_server"
            },
            {
              "action_api": "calculator.evaluate_request()",
              "action_description": "Creates HTTP request object with specified URL, data, and headers",
              "action_id": "create_http_request",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "add_5_call.init()",
              "action_description": "Creates new socket object",
              "action_id": "create_socket",
              "object": "\"params\", 2",
              "object_description": "Function and arguments",
              "object_id": "function_with_arguments",
              "intention_description": "Prepare argument for shortcut",
              "intention_id": "prepare_shortcut_argument"
            },
            {
              "action_api": "add_5_request.send()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Send data to server",
              "intention_id": "send_data_server"
            },
            {
              "action_api": "add_5_promise.read()",
              "action_description": "Receives data from socket connection",
              "action_id": "receive_socket_data",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Receive file data from server",
              "intention_id": "receive_file_data_from_server"
            }
          ]
        }
      ]
    }
  ]
}