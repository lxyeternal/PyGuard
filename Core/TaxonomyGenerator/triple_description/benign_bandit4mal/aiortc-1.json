{
  "metadata": {
    "package_name": "aiortc-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/aiortc-1.11.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "webcam.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/aiortc-1.11.0/aiortc-1.11.0/examples/webcam/webcam.py",
      "line_number": "29",
      "type_description": "B817:system",
      "context_snippet": "import platform\nfrom aiortc.contrib.media import MediaPlayer, MediaRelay\n\nrelay = None\nwebcam = None\n\ndef create_local_tracks(play_from, decode):\n    global relay, webcam\n\n    if play_from:\n        player = MediaPlayer(play_from, decode=decode)\n        return player.audio, player.video\n    else:\n        options = {\"framerate\": \"30\", \"video_size\": \"640x480\"}\n        if relay is None:\n            if platform.system() == \"Darwin\":\n                webcam = MediaPlayer(\n                    \"default:none\", format=\"avfoundation\", options=options\n                )\n            elif platform.system() == \"Windows\":\n                webcam = MediaPlayer(\n                    \"video=Integrated Camera\", format=\"dshow\", options=options\n                )\n            else:\n                webcam = MediaPlayer(\"/dev/video0\", format=\"v4l2\", options=options)\n            relay = MediaRelay()\n        return None, relay.subscribe(webcam.video)",
      "hash_value": "d996d51c1b4ff43af90e1a0cb309c5f2",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "import platform\nfrom aiortc.contrib.media import MediaPlayer, MediaRelay\n\nrelay = None\nwebcam = None\n\ndef create_local_tracks(play_from, decode):\n    global relay, webcam\n\n    if play_from:\n        player = MediaPlayer(play_from, decode=decode)\n        return player.audio, player.video\n    else:\n        options = {\"framerate\": \"30\", \"video_size\": \"640x480\"}\n        if relay is None:\n            if platform.system() == \"Darwin\":\n                webcam = MediaPlayer(\n                    \"default:none\", format=\"avfoundation\", options=options\n                )\n            elif platform.system() == \"Windows\":\n                webcam = MediaPlayer(\n                    \"video=Integrated Camera\", format=\"dshow\", options=options\n                )\n            else:\n                webcam = MediaPlayer(\"/dev/video0\", format=\"v4l2\", options=options)\n            relay = MediaRelay()\n        return None, relay.subscribe(webcam.video)",
          "triple_sequences": [
            {
              "action_api": "platform.system()",
              "action_description": "Retrieves operating system identifier",
              "action_id": "get_os_id",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Determine operating system",
              "intention_id": "determine_operating_system"
            },
            {
              "action_api": "MediaPlayer()",
              "action_description": "Creates video capture object",
              "action_id": "create_video_capture",
              "object": "\"default:none\", format=\"avfoundation\", options=options",
              "object_description": "Camera device index",
              "object_id": "camera_device_index",
              "intention_description": "Access system camera",
              "intention_id": "access_system_camera"
            },
            {
              "action_api": "MediaPlayer()",
              "action_description": "Creates video capture object",
              "action_id": "create_video_capture",
              "object": "\"video=Integrated Camera\", format=\"dshow\", options=options",
              "object_description": "Camera device index",
              "object_id": "camera_device_index",
              "intention_description": "Access system camera",
              "intention_id": "access_system_camera"
            },
            {
              "action_api": "MediaPlayer()",
              "action_description": "Creates video capture object",
              "action_id": "create_video_capture",
              "object": "\"/dev/video0\", format=\"v4l2\", options=options",
              "object_description": "Camera device index",
              "object_id": "camera_device_index",
              "intention_description": "Access system camera",
              "intention_id": "access_system_camera"
            },
            {
              "action_api": "MediaRelay()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Concurrent execution preparation",
              "intention_id": "concurrent_execution_preparation"
            },
            {
              "action_api": "relay.subscribe()",
              "action_description": "Access camera frame",
              "action_id": "access_camera_frame",
              "object": "webcam.video",
              "object_description": "Access camera frame",
              "object_id": "access_camera_frame",
              "intention_description": "Access screen content",
              "intention_id": "access_screen_content"
            }
          ]
        }
      ]
    }
  ]
}