{
  "metadata": {
    "package_name": "smbprotocol-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/smbprotocol-1.15.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "test_smbclient_shutil.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/smbprotocol-1.15.0/smbprotocol-1.15.0/tests/test_smbclient_shutil.py",
      "line_number": "840",
      "type_description": "B810:chmod",
      "context_snippet": "def test_copymode_local_to_remote(smb_share, tmpdir):\n    test_dir = tmpdir.mkdir(\"test\")\n    src_filename = \"%s\\\\source.txt\" % test_dir\n    dst_filename = \"%s\\\\target.txt\" % smb_share\n\n    with open(src_filename, mode=\"w\") as fd:\n        fd.write(\"content\")\n    os.chmod(src_filename, stat.S_IREAD)\n\n    with open_file(dst_filename, mode=\"w\") as fd:\n        fd.write(\"content\")\n\n    copymode(src_filename, dst_filename)\n\n    actual = smbclient_stat(dst_filename).st_file_attributes\n    assert actual & FileAttributes.FILE_ATTRIBUTE_READONLY == FileAttributes.FILE_ATTRIBUTE_READONLY\n\n    os.chmod(src_filename, stat.S_IWRITE)  # Needed when running on Windows as os.remove will fail to remove.\n    os.remove(src_filename)\n    with open(src_filename, mode=\"w\") as fd:\n        fd.write(\"content\")\n\n    copymode(src_filename, dst_filename)\n\n    actual = smbclient_stat(dst_filename).st_file_attributes\n    assert actual & FileAttributes.FILE_ATTRIBUTE_READONLY == 0",
      "hash_value": "cac5e8859814b29a1537b25915b9533d",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def test_copymode_local_to_remote(smb_share, tmpdir):\n    test_dir = tmpdir.mkdir(\"test\")\n    src_filename = \"%s\\\\source.txt\" % test_dir\n    dst_filename = \"%s\\\\target.txt\" % smb_share\n\n    with open(src_filename, mode=\"w\") as fd:\n        fd.write(\"content\")\n    os.chmod(src_filename, stat.S_IREAD)\n\n    with open_file(dst_filename, mode=\"w\") as fd:\n        fd.write(\"content\")\n\n    copymode(src_filename, dst_filename)\n\n    actual = smbclient_stat(dst_filename).st_file_attributes\n    assert actual & FileAttributes.FILE_ATTRIBUTE_READONLY == FileAttributes.FILE_ATTRIBUTE_READONLY\n\n    os.chmod(src_filename, stat.S_IWRITE)  # Needed when running on Windows as os.remove will fail to remove.\n    os.remove(src_filename)\n    with open(src_filename, mode=\"w\") as fd:\n        fd.write(\"content\")\n\n    copymode(src_filename, dst_filename)\n\n    actual = smbclient_stat(dst_filename).st_file_attributes\n    assert actual & FileAttributes.FILE_ATTRIBUTE_READONLY == 0",
          "triple_sequences": [
            {
              "action_api": "tmpdir.mkdir()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "test",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "src_filename",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "fd.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"content\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "os.chmod()",
              "action_description": "Sets file attributes for specified file",
              "action_id": "set_file_attributes",
              "object": "src_filename, stat.S_IREAD",
              "object_description": "File permission settings",
              "object_id": "file_permission",
              "intention_description": "Modify file attributes",
              "intention_id": "modify_file_attributes"
            },
            {
              "action_api": "open_file()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "dst_filename",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "fd.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"content\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "copymode()",
              "action_description": "Sets file attributes for specified file",
              "action_id": "set_file_attributes",
              "object": "src_filename, dst_filename",
              "object_description": "File permission settings",
              "object_id": "file_permission",
              "intention_description": "Modify file attributes",
              "intention_id": "modify_file_attributes"
            },
            {
              "action_api": "smbclient_stat()",
              "action_description": "Retrieves file status",
              "action_id": "path_object_operations",
              "object": "dst_filename",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "os.chmod()",
              "action_description": "Sets file attributes for specified file",
              "action_id": "set_file_attributes",
              "object": "src_filename, stat.S_IWRITE",
              "object_description": "File permission settings",
              "object_id": "file_permission",
              "intention_description": "Modify file attributes",
              "intention_id": "modify_file_attributes"
            },
            {
              "action_api": "os.remove()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "src_filename",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "src_filename",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "fd.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"content\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "copymode()",
              "action_description": "Sets file attributes for specified file",
              "action_id": "set_file_attributes",
              "object": "src_filename, dst_filename",
              "object_description": "File permission settings",
              "object_id": "file_permission",
              "intention_description": "Modify file attributes",
              "intention_id": "modify_file_attributes"
            },
            {
              "action_api": "smbclient_stat()",
              "action_description": "Retrieves file status",
              "action_id": "path_object_operations",
              "object": "dst_filename",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            }
          ]
        }
      ]
    }
  ]
}