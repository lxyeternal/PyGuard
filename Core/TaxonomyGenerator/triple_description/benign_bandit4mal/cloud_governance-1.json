{
  "metadata": {
    "package_name": "cloud_governance-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/cloud_governance-1.1.357.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "jira.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/cloud_governance-1.1.357/cloud_governance-1.1.357/cloud_governance/common/jira/jira.py",
      "line_number": "260",
      "type_description": "B825:request",
      "context_snippet": "import aiohttp\nimport logging\n\nlogger = logging.getLogger(__name__)\n\nclass Jira(object):\n    ...\n    async def search_tickets(self, query=None):\n        project = {\"project\": self.ticket_queue}\n        prefix = \"/search?jql=\"\n        query_items = []\n\n        if not query:\n            query = project\n        else:\n            query.update(project)\n\n        for k, v in query.items():\n            query_items.append(f\"{k}={v}\")\n\n        jql = \" AND \".join(query_items)\n        endpoint = f\"{prefix}{jql}\"\n        logger.debug(\"GET pending tickets: %s\" % endpoint)\n        result = await self.get_request(endpoint)\n        if not result:\n            logger.error(\"Failed to get pending tickets\")\n            return None\n        return result\n\n    async def get_request(self, endpoint):\n        logger.debug(\"GET: %s\" % endpoint)\n        try:\n            async with aiohttp.ClientSession(\n                headers=self.headers,\n                loop=self.loop,\n            ) as session:\n                async with session.get(\n                    self.url + endpoint,\n                    verify_ssl=False,\n                ) as response:\n                    result = await response.json(content_type=\"application/json\")\n        except Exception as ex:\n            logger.debug(ex)\n            logger.error(\"There was something wrong with your request.\")\n            return None\n        if response.status == 404:\n            logger.error(\"Resource not found: %s\" % self.url + endpoint)\n            return None\n        return result",
      "hash_value": "aeeb0f6a4e963ce14954680faa6e46fc",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "import aiohttp\nimport logging\n\nlogger = logging.getLogger(__name__)\n\nclass Jira(object):\n    ...\n    async def search_tickets(self, query=None):\n        project = {\"project\": self.ticket_queue}\n        prefix = \"/search?jql=\"\n        query_items = []\n\n        if not query:\n            query = project\n        else:\n            query.update(project)\n\n        for k, v in query.items():\n            query_items.append(f\"{k}={v}\")\n\n        jql = \" AND \".join(query_items)\n        endpoint = f\"{prefix}{jql}\"\n        logger.debug(\"GET pending tickets: %s\" % endpoint)\n        result = await self.get_request(endpoint)\n        if not result:\n            logger.error(\"Failed to get pending tickets\")\n            return None\n        return result\n\n    async def get_request(self, endpoint):\n        logger.debug(\"GET: %s\" % endpoint)\n        try:\n            async with aiohttp.ClientSession(\n                headers=self.headers,\n                loop=self.loop,\n            ) as session:\n                async with session.get(\n                    self.url + endpoint,\n                    verify_ssl=False,\n                ) as response:\n                    result = await response.json(content_type=\"application/json\")\n        except Exception as ex:\n            logger.debug(ex)\n            logger.error(\"There was something wrong with your request.\")\n            return None\n        if response.status == 404:\n            logger.error(\"Resource not found: %s\" % self.url + endpoint)\n            return None\n        return result",
          "triple_sequences": [
            {
              "action_api": "logger.debug()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "\"GET pending tickets: %s\" % endpoint",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "self.get_request()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "endpoint",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "logger.error()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "\"Failed to get pending tickets\"",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "logger.debug()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "\"GET: %s\" % endpoint",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "aiohttp.ClientSession()",
              "action_description": "Creates HTTP session for making asynchronous requests",
              "action_id": "create_http_session",
              "object": "headers=self.headers, loop=self.loop",
              "object_description": "HTTP request/response headers",
              "object_id": "http_headers",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "session.get()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "self.url + endpoint, verify_ssl=False",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "response.json()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "content_type=\"application/json\"",
              "object_description": "Content type string",
              "object_id": "content_type",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "logger.debug()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "ex",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "logger.error()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "\"There was something wrong with your request.\"",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "logger.error()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "\"Resource not found: %s\" % self.url + endpoint",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            }
          ]
        }
      ]
    }
  ]
}