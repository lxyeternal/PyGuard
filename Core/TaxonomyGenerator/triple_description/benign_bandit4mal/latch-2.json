{
  "metadata": {
    "package_name": "latch-2",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/latch-2.58.2.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "ctx.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/latch-2.58.2/latch-2.58.2/src/latch_cli/centromere/ctx.py",
      "line_number": "316",
      "type_description": "B817:system",
      "context_snippet": "if metadata_root is None:\n    metadata_root = pkg_root / \"latch_metadata\"\nself.metadata_root = metadata_root\n\nmeta_file = load_snakemake_metadata(pkg_root, metadata_root)\nif meta_file is not None:\n    click.echo(\n        f\"Using metadata file {click.style(meta_file, italic=True)}\"\n    )\nelse:\n    new_meta = pkg_root / \"latch_metadata\" / \"__init__.py\"\n    click.echo(\"Trying to extract metadata from the Snakefile\")\n    try:\n        snakemake_workflow_extractor(pkg_root, metadata_root, snakefile)\n    except (ImportError, FileNotFoundError):\n        traceback.print_exc()\n        click.secho(\n            \"\\n\\n\\n\"\n            + \"The above error occured when reading \"\n            + \"the Snakefile to extract workflow metadata.\",\n            bold=True,\n            fg=\"red\",\n        )\n        click.secho(\n            \"\\nIt is possible to avoid including the Snakefile\"\n            \" prior to registration by providing a\"\n            \" `latch_metadata.py` file in the workflow root.\\nThis\"\n            \" way it is not necessary to install dependencies or\"\n            \" ensure that Snakemake inputs locally.\",\n            fg=\"red\",\n        )\n        click.secho(\"\\nExample \", fg=\"red\", nl=False)\n\n        snakemake_metadata_example = get_snakemake_metadata_example(\n            pkg_root.name\n        )\n        click.secho(f\"`{new_meta}`\", bold=True, fg=\"red\", nl=False)\n        click.secho(\n            f\" file:\\n```\\n{snakemake_metadata_example}```\", fg=\"red\"\n        )\n        if click.confirm(\n            click.style(\n                \"Generate example metadata file now?\",\n                bold=True,\n                fg=\"red\",\n            ),\n            default=True,\n        ):\n            new_meta.write_text(snakemake_metadata_example)\n\n            import platform\n\n            system = platform.system()\n            if system in {\n                \"Windows\",\n                \"Linux\",\n                \"Darwin\",\n            } and click.confirm(\n                click.style(\n                    \"Open the generated file?\", bold=True, fg=\"red\"\n                ),\n                default=True,\n            ):\n                import subprocess\n\n                if system == \"Linux\":\n                    res = subprocess.run([\n                        \"xdg-open\",\n                        new_meta,\n                    ]).returncode\n                elif system == \"Darwin\":\n                    res = subprocess.run([\"open\", new_meta]).returncode\n                elif system == \"Windows\":\n                    import os\n\n                    res = os.system(str(new_meta.resolve()))\n                else:\n                    res = None\n\n                if res is not None and res != 0:\n                    click.secho(\"Failed to open file\", fg=\"red\")\n        sys.exit(1)",
      "hash_value": "a95262d129ecff770cb33d1156504c07",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "if metadata_root is None:\n    metadata_root = pkg_root / \"latch_metadata\"\nself.metadata_root = metadata_root\n\nmeta_file = load_snakemake_metadata(pkg_root, metadata_root)\nif meta_file is not None:\n    click.echo(\n        f\"Using metadata file {click.style(meta_file, italic=True)}\"\n    )\nelse:\n    new_meta = pkg_root / \"latch_metadata\" / \"__init__.py\"\n    click.echo(\"Trying to extract metadata from the Snakefile\")\n    try:\n        snakemake_workflow_extractor(pkg_root, metadata_root, snakefile)\n    except (ImportError, FileNotFoundError):\n        traceback.print_exc()\n        click.secho(\n            \"\\n\\n\\n\"\n            + \"The above error occured when reading \"\n            + \"the Snakefile to extract workflow metadata.\",\n            bold=True,\n            fg=\"red\",\n        )\n        click.secho(\n            \"\\nIt is possible to avoid including the Snakefile\"\n            \" prior to registration by providing a\"\n            \" `latch_metadata.py` file in the workflow root.\\nThis\"\n            \" way it is not necessary to install dependencies or\"\n            \" ensure that Snakemake inputs locally.\",\n            fg=\"red\",\n        )\n        click.secho(\"\\nExample \", fg=\"red\", nl=False)\n\n        snakemake_metadata_example = get_snakemake_metadata_example(\n            pkg_root.name\n        )\n        click.secho(f\"`{new_meta}`\", bold=True, fg=\"red\", nl=False)\n        click.secho(\n            f\" file:\\n```\\n{snakemake_metadata_example}```\", fg=\"red\"\n        )\n        if click.confirm(\n            click.style(\n                \"Generate example metadata file now?\",\n                bold=True,\n                fg=\"red\",\n            ),\n            default=True,\n        ):\n            new_meta.write_text(snakemake_metadata_example)\n\n            import platform\n\n            system = platform.system()\n            if system in {\n                \"Windows\",\n                \"Linux\",\n                \"Darwin\",\n            } and click.confirm(\n                click.style(\n                    \"Open the generated file?\", bold=True, fg=\"red\"\n                ),\n                default=True,\n            ):\n                import subprocess\n\n                if system == \"Linux\":\n                    res = subprocess.run([\n                        \"xdg-open\",\n                        new_meta,\n                    ]).returncode\n                elif system == \"Darwin\":\n                    res = subprocess.run([\"open\", new_meta]).returncode\n                elif system == \"Windows\":\n                    import os\n\n                    res = os.system(str(new_meta.resolve()))\n                else:\n                    res = None\n\n                if res is not None and res != 0:\n                    click.secho(\"Failed to open file\", fg=\"red\")\n        sys.exit(1)",
          "triple_sequences": [
            {
              "action_api": "load_snakemake_metadata()",
              "action_description": "Import module dynamically",
              "action_id": "import_dynamic",
              "object": "pkg_root, metadata_root",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Import module dynamically",
              "intention_id": "import_module_dynamically"
            },
            {
              "action_api": "click.echo()",
              "action_description": "Writes file content",
              "action_id": "basic_write_operations",
              "object": "f\"Using metadata file {click.style(meta_file, italic=True)}\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "click.echo()",
              "action_description": "Writes file content",
              "action_id": "basic_write_operations",
              "object": "\"Trying to extract metadata from the Snakefile\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "snakemake_workflow_extractor()",
              "action_description": "Import module dynamically",
              "action_id": "import_dynamic",
              "object": "pkg_root, metadata_root, snakefile",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Import module dynamically",
              "intention_id": "import_module_dynamically"
            },
            {
              "action_api": "traceback.print_exc()",
              "action_description": "Writes file content",
              "action_id": "basic_write_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "click.secho()",
              "action_description": "Writes file content",
              "action_id": "basic_write_operations",
              "object": "\"\\n\\n\\nThe above error occured when reading the Snakefile to extract workflow metadata.\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "click.secho()",
              "action_description": "Writes file content",
              "action_id": "basic_write_operations",
              "object": "\"\\nIt is possible to avoid including the Snakefile prior to registration by providing a `latch_metadata.py` file in the workflow root.\\nThis way it is not necessary to install dependencies or ensure that Snakemake inputs locally.\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "click.secho()",
              "action_description": "Writes file content",
              "action_id": "basic_write_operations",
              "object": "\"\\nExample \"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "get_snakemake_metadata_example()",
              "action_description": "Import module dynamically",
              "action_id": "import_dynamic",
              "object": "pkg_root.name",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Import module dynamically",
              "intention_id": "import_module_dynamically"
            },
            {
              "action_api": "click.secho()",
              "action_description": "Writes file content",
              "action_id": "basic_write_operations",
              "object": "f\"`{new_meta}`\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "click.secho()",
              "action_description": "Writes file content",
              "action_id": "basic_write_operations",
              "object": "f\" file:\\n```\\n{snakemake_metadata_example}```\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "click.confirm()",
              "action_description": "Reads user input from standard input",
              "action_id": "read_user_input",
              "object": "click.style(\"Generate example metadata file now?\", bold=True, fg=\"red\")",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Collect user input",
              "intention_id": "collect_user_input"
            },
            {
              "action_api": "new_meta.write_text()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "snakemake_metadata_example",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "platform.system()",
              "action_description": "Retrieves operating system information",
              "action_id": "get_os_info",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get operating system name",
              "intention_id": "get_operating_system_name"
            },
            {
              "action_api": "click.confirm()",
              "action_description": "Reads user input from standard input",
              "action_id": "read_user_input",
              "object": "click.style(\"Open the generated file?\", bold=True, fg=\"red\")",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Collect user input",
              "intention_id": "collect_user_input"
            },
            {
              "action_api": "subprocess.run()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "[\"xdg-open\", new_meta]",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Open file",
              "intention_id": "open_file"
            },
            {
              "action_api": "subprocess.run()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "[\"open\", new_meta]",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Open file",
              "intention_id": "open_file"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "str(new_meta.resolve())",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Open file",
              "intention_id": "open_file"
            },
            {
              "action_api": "click.secho()",
              "action_description": "Writes file content",
              "action_id": "basic_write_operations",
              "object": "\"Failed to open file\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "sys.exit()",
              "action_description": "Exits program",
              "action_id": "exit_program",
              "object": "1",
              "object_description": "",
              "object_id": "",
              "intention_description": "Terminate program execution",
              "intention_id": "terminate_program_execution"
            }
          ]
        }
      ]
    }
  ]
}