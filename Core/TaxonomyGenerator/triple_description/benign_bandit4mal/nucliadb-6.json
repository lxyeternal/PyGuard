{
  "metadata": {
    "package_name": "nucliadb-6",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/nucliadb-6.3.5.post4010-py3-none-any.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "audit.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/nucliadb-6.3.5.post4010-py3-none-any/nucliadb/writer/resource/audit.py",
      "line_number": "32",
      "type_description": "B820:get",
      "context_snippet": "from datetime import datetime\n\nfrom starlette.requests import Request\n\nfrom nucliadb_protos.writer_pb2 import Audit\n\n\ndef parse_audit(audit: Audit, request: Request):\n    audit.user = request.headers.get(\"X-NUCLIADB-USER\", \"\")\n\n    audit.when.FromDatetime(datetime.now())\n\n    agents = request.headers.get(\"USER-AGENT\", \"\").lower()\n    if \"dashboard\" in agents:\n        audit.source = Audit.Source.HTTP\n    elif \"desktop\" in agents:\n        audit.source = Audit.Source.DESKTOP\n    else:\n        audit.source = Audit.Source.HTTP\n\n    audit.origin = request.headers.get(\"X-FORWARDED-FOR\", \"\")\n",
      "hash_value": "bcf21be90c6eb6a0868873cda4820b0d",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "from datetime import datetime\n\nfrom starlette.requests import Request\n\nfrom nucliadb_protos.writer_pb2 import Audit\n\n\ndef parse_audit(audit: Audit, request: Request):\n    audit.user = request.headers.get(\"X-NUCLIADB-USER\", \"\")\n\n    audit.when.FromDatetime(datetime.now())\n\n    agents = request.headers.get(\"USER-AGENT\", \"\").lower()\n    if \"dashboard\" in agents:\n        audit.source = Audit.Source.HTTP\n    elif \"desktop\" in agents:\n        audit.source = Audit.Source.DESKTOP\n    else:\n        audit.source = Audit.Source.HTTP\n\n    audit.origin = request.headers.get(\"X-FORWARDED-FOR\", \"\")\n",
          "triple_sequences": [
            {
              "action_api": "request.headers.get()",
              "action_description": "Retrieves HTTP header",
              "action_id": "add_http_header",
              "object": "\"X-NUCLIADB-USER\", \"\"",
              "object_description": "HTTP header",
              "object_id": "http_header",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "datetime.now()",
              "action_description": "Returns current time",
              "action_id": "get_current_time",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get datetime epoch",
              "intention_id": "get_datetime_epoch"
            },
            {
              "action_api": "request.headers.get()",
              "action_description": "Retrieves HTTP header",
              "action_id": "add_http_header",
              "object": "\"USER-AGENT\", \"\"",
              "object_description": "HTTP header",
              "object_id": "http_header",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "str.lower()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "request.headers.get()",
              "action_description": "Retrieves HTTP header",
              "action_id": "add_http_header",
              "object": "\"X-FORWARDED-FOR\", \"\"",
              "object_description": "HTTP header",
              "object_id": "http_header",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            }
          ]
        }
      ]
    }
  ]
}