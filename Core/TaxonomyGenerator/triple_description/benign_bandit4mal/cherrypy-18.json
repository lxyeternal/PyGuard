{
  "metadata": {
    "package_name": "cherrypy-18",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/cherrypy-18.10.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "plugins.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/cherrypy-18.10.0/cherrypy-18.10.0/cherrypy/process/plugins.py",
      "line_number": "296",
      "type_description": "B811:getuid",
      "context_snippet": "def start(self):\n    # uid/gid\n    def current_ids():\n        \"\"\"Return the current (uid, gid) if available.\"\"\"\n        name, group = None, None\n        if pwd:\n            name = pwd.getpwuid(os.getuid())[0]\n        if grp:\n            group = grp.getgrgid(os.getgid())[0]\n        return name, group\n\n    if self.finalized:\n        if not (self.uid is None and self.gid is None):\n            self.bus.log('Already running as uid: %r gid: %r' %\n                         current_ids())\n    else:\n        if self.uid is None and self.gid is None:\n            if pwd or grp:\n                self.bus.log('uid/gid not set', level=30)\n        else:\n            self.bus.log('Started as uid: %r gid: %r' % current_ids())\n            if self.gid is not None:\n                os.setgid(self.gid)\n                os.setgroups([])\n            if self.uid is not None:\n                os.setuid(self.uid)\n            self.bus.log('Running as uid: %r gid: %r' % current_ids())\n\n    # umask\n    if self.finalized:\n        if self.umask is not None:\n            self.bus.log('umask already set to: %03o' % self.umask)\n    else:\n        if self.umask is None:\n            self.bus.log('umask not set', level=30)\n        else:\n            old_umask = os.umask(self.umask)\n            self.bus.log('umask old: %03o, new: %03o' %\n                         (old_umask, self.umask))\n\n    self.finalized = True\n# This is slightly higher than the priority for server.start\n# in order to facilitate the most common use: starting on a low\n# port (which requires root) and then dropping to another user.\nstart.priority = 77",
      "hash_value": "b94ab560b09cdce62a8c9b9816b167a1",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def start(self):\n    # uid/gid\n    def current_ids():\n        \"\"\"Return the current (uid, gid) if available.\"\"\"\n        name, group = None, None\n        if pwd:\n            name = pwd.getpwuid(os.getuid())[0]\n        if grp:\n            group = grp.getgrgid(os.getgid())[0]\n        return name, group\n\n    if self.finalized:\n        if not (self.uid is None and self.gid is None):\n            self.bus.log('Already running as uid: %r gid: %r' %\n                         current_ids())\n    else:\n        if self.uid is None and self.gid is None:\n            if pwd or grp:\n                self.bus.log('uid/gid not set', level=30)\n        else:\n            self.bus.log('Started as uid: %r gid: %r' % current_ids())\n            if self.gid is not None:\n                os.setgid(self.gid)\n                os.setgroups([])\n            if self.uid is not None:\n                os.setuid(self.uid)\n            self.bus.log('Running as uid: %r gid: %r' % current_ids())\n\n    # umask\n    if self.finalized:\n        if self.umask is not None:\n            self.bus.log('umask already set to: %03o' % self.umask)\n    else:\n        if self.umask is None:\n            self.bus.log('umask not set', level=30)\n        else:\n            old_umask = os.umask(self.umask)\n            self.bus.log('umask old: %03o, new: %03o' %\n                         (old_umask, self.umask))\n\n    self.finalized = True\n# This is slightly higher than the priority for server.start\n# in order to facilitate the most common use: starting on a low\n# port (which requires root) and then dropping to another user.\nstart.priority = 77",
          "triple_sequences": [
            {
              "action_api": "os.getuid()",
              "action_description": "Retrieves current user login name",
              "action_id": "get_username",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access current username",
              "intention_id": "access_current_username"
            },
            {
              "action_api": "pwd.getpwuid()",
              "action_description": "Retrieves current user login name",
              "action_id": "get_username",
              "object": "os.getuid()",
              "object_description": "Current username",
              "object_id": "current_username",
              "intention_description": "Access current username",
              "intention_id": "access_current_username"
            },
            {
              "action_api": "os.getgid()",
              "action_description": "Retrieves group id",
              "action_id": "get_username",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "grp.getgrgid()",
              "action_description": "Retrieves group id",
              "action_id": "get_username",
              "object": "os.getgid()",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "os.setgid()",
              "action_description": "Adjusts process privilege for system operation",
              "action_id": "adjust_process_privilege",
              "object": "self.gid",
              "object_description": "Process ID",
              "object_id": "process_id",
              "intention_description": "Determine administrator status",
              "intention_id": "determine_administrator_status"
            },
            {
              "action_api": "os.setgroups()",
              "action_description": "Adjusts process privilege for system operation",
              "action_id": "adjust_process_privilege",
              "object": "[]",
              "object_description": "",
              "object_id": "",
              "intention_description": "Determine administrator status",
              "intention_id": "determine_administrator_status"
            },
            {
              "action_api": "os.setuid()",
              "action_description": "Adjusts process privilege for system operation",
              "action_id": "adjust_process_privilege",
              "object": "self.uid",
              "object_description": "Process ID",
              "object_id": "process_id",
              "intention_description": "Determine administrator status",
              "intention_id": "determine_administrator_status"
            },
            {
              "action_api": "os.umask()",
              "action_description": "Sets file attributes for specified file",
              "action_id": "set_file_attributes",
              "object": "self.umask",
              "object_description": "File permission",
              "object_id": "file_permission",
              "intention_description": "Modify file attributes",
              "intention_id": "modify_file_attributes"
            }
          ]
        }
      ]
    }
  ]
}