{
  "metadata": {
    "package_name": "ibm_watsonx_ai-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/ibm_watsonx_ai-1.3.6.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "hybrid_artifact_loader.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/ibm_watsonx_ai-1.3.6/ibm_watsonx_ai-1.3.6/ibm_watsonx_ai/libs/repo/mlrepositoryartifact/hybrid_artifact_loader.py",
      "line_number": "43",
      "type_description": "B814:read",
      "context_snippet": "def extract_content(self, queryparam_val, callback):\n    directory_name = 'artifact'\n    try:\n        shutil.rmtree(directory_name)\n    except:\n        pass\n\n    try:\n        id_length = 20\n        dir_id = uid_generate(id_length)\n        model_dir_name = directory_name + dir_id\n\n        gz_file_name = '{}/artifact_content.tar.gz'.format(model_dir_name)\n\n        input_stream = None\n        os.makedirs(model_dir_name)\n        if queryparam_val is None:\n            input_stream = self.reader().read()\n        if queryparam_val is not None and queryparam_val == 'full':\n            input_stream = self._content_reader_gzip()\n        file_content = input_stream.read()\n        gz_f = open(gz_file_name, 'wb+')\n        gz_f.write(file_content)\n        gz_f.close()\n        if queryparam_val is None:\n            self.reader().close()\n\n        with zipfile.ZipFile(gz_file_name) as zip_ref:\n            zip_ref.extractall(model_dir_name)\n        artifact_instance = callback(model_dir_name)\n\n        shutil.rmtree(model_dir_name)\n        return artifact_instance\n    except Exception as ex:\n        shutil.rmtree(model_dir_name)\n        raise ex",
      "hash_value": "92d19f364d9776d5c1cb6c6093b41426",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def extract_content(self, queryparam_val, callback):\n    directory_name = 'artifact'\n    try:\n        shutil.rmtree(directory_name)\n    except:\n        pass\n\n    try:\n        id_length = 20\n        dir_id = uid_generate(id_length)\n        model_dir_name = directory_name + dir_id\n\n        gz_file_name = '{}/artifact_content.tar.gz'.format(model_dir_name)\n\n        input_stream = None\n        os.makedirs(model_dir_name)\n        if queryparam_val is None:\n            input_stream = self.reader().read()\n        if queryparam_val is not None and queryparam_val == 'full':\n            input_stream = self._content_reader_gzip()\n        file_content = input_stream.read()\n        gz_f = open(gz_file_name, 'wb+')\n        gz_f.write(file_content)\n        gz_f.close()\n        if queryparam_val is None:\n            self.reader().close()\n\n        with zipfile.ZipFile(gz_file_name) as zip_ref:\n            zip_ref.extractall(model_dir_name)\n        artifact_instance = callback(model_dir_name)\n\n        shutil.rmtree(model_dir_name)\n        return artifact_instance\n    except Exception as ex:\n        shutil.rmtree(model_dir_name)\n        raise ex",
          "triple_sequences": [
            {
              "action_api": "shutil.rmtree()",
              "action_description": "Recursively deletes directory and its contents",
              "action_id": "delete_directory",
              "object": "artifact",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Delete directory content",
              "intention_id": "delete_directory_content"
            },
            {
              "action_api": "uid_generate()",
              "action_description": "Generate random integer",
              "action_id": "generate_random_integer",
              "object": "id_length",
              "object_description": "Random string",
              "object_id": "random_string",
              "intention_description": "Create random file name",
              "intention_id": "create_random_filename"
            },
            {
              "action_api": "os.makedirs()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "model_dir_name",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "self.reader().read()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "self._content_reader_gzip()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "input_stream.read()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "gz_file_name, 'wb+'",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "gz_f.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "file_content",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "gz_f.close()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close file",
              "intention_id": "close_file"
            },
            {
              "action_api": "self.reader().close()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close file",
              "intention_id": "close_file"
            },
            {
              "action_api": "zipfile.ZipFile()",
              "action_description": "Opens ZIP archive for reading",
              "action_id": "open_zip_read",
              "object": "gz_file_name",
              "object_description": "ZIP archive file",
              "object_id": "zip_archive",
              "intention_description": "Open database for reading",
              "intention_id": "open_database_reading"
            },
            {
              "action_api": "zip_ref.extractall()",
              "action_description": "Extracts all files from ZIP archive to specified directory",
              "action_id": "extract_zip_files",
              "object": "model_dir_name",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Decompress downloaded archive",
              "intention_id": "decompress_downloaded_archive"
            },
            {
              "action_api": "callback()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "model_dir_name",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Trigger main behavioral logic",
              "intention_id": "trigger_main_behavioral_logic"
            },
            {
              "action_api": "shutil.rmtree()",
              "action_description": "Recursively deletes directory and its contents",
              "action_id": "delete_directory",
              "object": "model_dir_name",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Delete directory content",
              "intention_id": "delete_directory_content"
            }
          ]
        }
      ]
    }
  ]
}