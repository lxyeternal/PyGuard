{
  "metadata": {
    "package_name": "spiceypy-6",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/spiceypy-6.0.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "test_wrapper.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/spiceypy-6.0.0/spiceypy-6.0.0/src/spiceypy/tests/test_wrapper.py",
      "line_number": "4671",
      "type_description": "B815:write",
      "context_snippet": "def test_gfsntc():\n    kernel = os.path.join(cwd, \"gfnstc_test.tf\")\n    cleanup_kernel(kernel)\n    with open(kernel, \"w\") as kernelFile:\n        kernelFile.write(\"\\\\begindata\\n\")\n        kernelFile.write(\"FRAME_SEM                     =  10100000\\n\")\n        kernelFile.write(\"FRAME_10100000_NAME           = 'SEM'\\n\")\n        kernelFile.write(\"FRAME_10100000_CLASS          =  5\\n\")\n        kernelFile.write(\"FRAME_10100000_CLASS_ID       =  10100000\\n\")\n        kernelFile.write(\"FRAME_10100000_CENTER         =  10\\n\")\n        kernelFile.write(\"FRAME_10100000_RELATIVE       = 'J2000'\\n\")\n        kernelFile.write(\"FRAME_10100000_DEF_STYLE      = 'PARAMETERIZED'\\n\")\n        kernelFile.write(\"FRAME_10100000_FAMILY         = 'TWO-VECTOR'\\n\")\n        kernelFile.write(\"FRAME_10100000_PRI_AXIS       = 'X'\\n\")\n        kernelFile.write(\"FRAME_10100000_PRI_VECTOR_DEF = 'OBSERVER_TARGET_POSITION'\\n\")\n        kernelFile.write(\"FRAME_10100000_PRI_OBSERVER   = 'SUN'\\n\")\n        kernelFile.write(\"FRAME_10100000_PRI_TARGET     = 'EARTH'\\n\")\n        kernelFile.write(\"FRAME_10100000_PRI_ABCORR     = 'NONE'\\n\")\n        kernelFile.write(\"FRAME_10100000_SEC_AXIS       = 'Y'\\n\")\n        kernelFile.write(\"FRAME_10100000_SEC_VECTOR_DEF = 'OBSERVER_TARGET_VELOCITY'\\n\")\n        kernelFile.write(\"FRAME_10100000_SEC_OBSERVER   = 'SUN'\\n\")\n        kernelFile.write(\"FRAME_10100000_SEC_TARGET     = 'EARTH'\\n\")\n        kernelFile.write(\"FRAME_10100000_SEC_ABCORR     = 'NONE'\\n\")\n        kernelFile.write(\"FRAME_10100000_SEC_FRAME      = 'J2000'\\n\")\n        kernelFile.close()\n    spice.furnsh(CoreKernels.testMetaKernel)\n    spice.furnsh(kernel)\n    et0 = spice.str2et(\"2007 JAN 01\")\n    et1 = spice.str2et(\"2008 JAN 01\")\n    cnfine = spice.cell_double(2)\n    spice.wninsd(et0, et1, cnfine)\n    result = spice.cell_double(2000)\n    spice.gfsntc(\n        \"EARTH\",\n        \"IAU_EARTH\",\n        \"Ellipsoid\",\n        \"NONE\",\n        \"SUN\",\n        \"SEM\",\n        [1.0, 0.0, 0.0],\n        \"LATITUDINAL\",\n        \"LATITUDE\",\n        \"=\",\n        0.0,\n        0.0,\n        90.0 * spice.spd(),\n        1000,\n        cnfine,\n        result,\n    )\n    count = spice.wncard(result)\n    assert count > 0\n    beg, end = spice.wnfetd(result, 0)\n    begstr = spice.timout(beg, \"YYYY-MON-DD HR:MN:SC.###### (TDB) ::TDB ::RND\", 80)\n    endstr = spice.timout(end, \"YYYY-MON-DD HR:MN:SC.###### (TDB) ::TDB ::RND\", 80)\n    assert begstr == \"2007-MAR-21 00:01:25.527303 (TDB)\"\n    assert endstr == \"2007-MAR-21 00:01:25.527303 (TDB)\"\n    beg, end = spice.wnfetd(result, 1)\n    begstr = spice.timout(beg, \"YYYY-MON-DD HR:MN:SC.###### (TDB) ::TDB ::RND\", 80)\n    endstr = spice.timout(end, \"YYYY-MON-DD HR:MN:SC.###### (TDB) ::TDB ::RND\", 80)\n    # uncertainty below is due to difference on arm vs x86 IEEE floating point issues\n    assert begstr == \"2007-SEP-23 09:46:39.606982 (TDB)\" or begstr == \"2007-SEP-23 09:46:39.606981 (TDB)\"\n    assert endstr == \"2007-SEP-23 09:46:39.606982 (TDB)\" or endstr == \"2007-SEP-23 09:46:39.606981 (TDB)\"\n    cleanup_kernel(kernel)",
      "hash_value": "7782502f98b8a603156cc86ed6d682f6",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def test_gfsntc():\n    kernel = os.path.join(cwd, \"gfnstc_test.tf\")\n    cleanup_kernel(kernel)\n    with open(kernel, \"w\") as kernelFile:\n        kernelFile.write(\"\\\\begindata\\n\")\n        kernelFile.write(\"FRAME_SEM                     =  10100000\\n\")\n        kernelFile.write(\"FRAME_10100000_NAME           = 'SEM'\\n\")\n        kernelFile.write(\"FRAME_10100000_CLASS          =  5\\n\")\n        kernelFile.write(\"FRAME_10100000_CLASS_ID       =  10100000\\n\")\n        kernelFile.write(\"FRAME_10100000_CENTER         =  10\\n\")\n        kernelFile.write(\"FRAME_10100000_RELATIVE       = 'J2000'\\n\")\n        kernelFile.write(\"FRAME_10100000_DEF_STYLE      = 'PARAMETERIZED'\\n\")\n        kernelFile.write(\"FRAME_10100000_FAMILY         = 'TWO-VECTOR'\\n\")\n        kernelFile.write(\"FRAME_10100000_PRI_AXIS       = 'X'\\n\")\n        kernelFile.write(\"FRAME_10100000_PRI_VECTOR_DEF = 'OBSERVER_TARGET_POSITION'\\n\")\n        kernelFile.write(\"FRAME_10100000_PRI_OBSERVER   = 'SUN'\\n\")\n        kernelFile.write(\"FRAME_10100000_PRI_TARGET     = 'EARTH'\\n\")\n        kernelFile.write(\"FRAME_10100000_PRI_ABCORR     = 'NONE'\\n\")\n        kernelFile.write(\"FRAME_10100000_SEC_AXIS       = 'Y'\\n\")\n        kernelFile.write(\"FRAME_10100000_SEC_VECTOR_DEF = 'OBSERVER_TARGET_VELOCITY'\\n\")\n        kernelFile.write(\"FRAME_10100000_SEC_OBSERVER   = 'SUN'\\n\")\n        kernelFile.write(\"FRAME_10100000_SEC_TARGET     = 'EARTH'\\n\")\n        kernelFile.write(\"FRAME_10100000_SEC_ABCORR     = 'NONE'\\n\")\n        kernelFile.write(\"FRAME_10100000_SEC_FRAME      = 'J2000'\\n\")\n        kernelFile.close()\n    spice.furnsh(CoreKernels.testMetaKernel)\n    spice.furnsh(kernel)\n    et0 = spice.str2et(\"2007 JAN 01\")\n    et1 = spice.str2et(\"2008 JAN 01\")\n    cnfine = spice.cell_double(2)\n    spice.wninsd(et0, et1, cnfine)\n    result = spice.cell_double(2000)\n    spice.gfsntc(\n        \"EARTH\",\n        \"IAU_EARTH\",\n        \"Ellipsoid\",\n        \"NONE\",\n        \"SUN\",\n        \"SEM\",\n        [1.0, 0.0, 0.0],\n        \"LATITUDINAL\",\n        \"LATITUDE\",\n        \"=\",\n        0.0,\n        0.0,\n        90.0 * spice.spd(),\n        1000,\n        cnfine,\n        result,\n    )\n    count = spice.wncard(result)\n    assert count > 0\n    beg, end = spice.wnfetd(result, 0)\n    begstr = spice.timout(beg, \"YYYY-MON-DD HR:MN:SC.###### (TDB) ::TDB ::RND\", 80)\n    endstr = spice.timout(end, \"YYYY-MON-DD HR:MN:SC.###### (TDB) ::TDB ::RND\", 80)\n    assert begstr == \"2007-MAR-21 00:01:25.527303 (TDB)\"\n    assert endstr == \"2007-MAR-21 00:01:25.527303 (TDB)\"\n    beg, end = spice.wnfetd(result, 1)\n    begstr = spice.timout(beg, \"YYYY-MON-DD HR:MN:SC.###### (TDB) ::TDB ::RND\", 80)\n    endstr = spice.timout(end, \"YYYY-MON-DD HR:MN:SC.###### (TDB) ::TDB ::RND\", 80)\n    # uncertainty below is due to difference on arm vs x86 IEEE floating point issues\n    assert begstr == \"2007-SEP-23 09:46:39.606982 (TDB)\" or begstr == \"2007-SEP-23 09:46:39.606981 (TDB)\"\n    assert endstr == \"2007-SEP-23 09:46:39.606982 (TDB)\" or endstr == \"2007-SEP-23 09:46:39.606981 (TDB)\"\n    cleanup_kernel(kernel)",
          "triple_sequences": [
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "cwd, \"gfnstc_test.tf\"",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "cleanup_kernel()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "kernel",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "kernel, \"w\"",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "kernelFile.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\\begindata\n",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "kernelFile.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "FRAME_SEM                     =  10100000\n",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "kernelFile.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "FRAME_10100000_NAME           = 'SEM'\n",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "kernelFile.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "FRAME_10100000_CLASS          =  5\n",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "kernelFile.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "FRAME_10100000_CLASS_ID       =  10100000\n",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "kernelFile.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "FRAME_10100000_CENTER         =  10\n",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "kernelFile.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "FRAME_10100000_RELATIVE       = 'J2000'\n",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "kernelFile.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "FRAME_10100000_DEF_STYLE      = 'PARAMETERIZED'\n",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "kernelFile.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "FRAME_10100000_FAMILY         = 'TWO-VECTOR'\n",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "kernelFile.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "FRAME_10100000_PRI_AXIS       = 'X'\n",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "kernelFile.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "FRAME_10100000_PRI_VECTOR_DEF = 'OBSERVER_TARGET_POSITION'\n",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "kernelFile.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "FRAME_10100000_PRI_OBSERVER   = 'SUN'\n",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "kernelFile.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "FRAME_10100000_PRI_TARGET     = 'EARTH'\n",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "kernelFile.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "FRAME_10100000_PRI_ABCORR     = 'NONE'\n",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "kernelFile.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "FRAME_10100000_SEC_AXIS       = 'Y'\n",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "kernelFile.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "FRAME_10100000_SEC_VECTOR_DEF = 'OBSERVER_TARGET_VELOCITY'\n",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "kernelFile.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "FRAME_10100000_SEC_OBSERVER   = 'SUN'\n",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "kernelFile.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "FRAME_10100000_SEC_TARGET     = 'EARTH'\n",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "kernelFile.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "FRAME_10100000_SEC_ABCORR     = 'NONE'\n",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "kernelFile.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "FRAME_10100000_SEC_FRAME      = 'J2000'\n",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "kernelFile.close()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close file",
              "intention_id": "close_file"
            },
            {
              "action_api": "spice.furnsh()",
              "action_description": "Import dynamic module",
              "action_id": "import_dynamic",
              "object": "CoreKernels.testMetaKernel",
              "object_description": "Module name string",
              "object_id": "module_name_string",
              "intention_description": "Import required module",
              "intention_id": "import_required_module"
            },
            {
              "action_api": "spice.furnsh()",
              "action_description": "Import dynamic module",
              "action_id": "import_dynamic",
              "object": "kernel",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Import required module",
              "intention_id": "import_required_module"
            },
            {
              "action_api": "spice.str2et()",
              "action_description": "Parse string into datetime object",
              "action_id": "parse_datetime",
              "object": "\"2007 JAN 01\"",
              "object_description": "String containing environment data",
              "object_id": "string_environment_data",
              "intention_description": "Get datetime epoch",
              "intention_id": "get_datetime_epoch"
            },
            {
              "action_api": "spice.str2et()",
              "action_description": "Parse string into datetime object",
              "action_id": "parse_datetime",
              "object": "\"2008 JAN 01\"",
              "object_description": "String containing environment data",
              "object_id": "string_environment_data",
              "intention_description": "Get datetime epoch",
              "intention_id": "get_datetime_epoch"
            },
            {
              "action_api": "spice.cell_double()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "2",
              "object_description": "",
              "object_id": "",
              "intention_description": "Create database cursor",
              "intention_id": "create_database_cursor"
            },
            {
              "action_api": "spice.wninsd()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "et0, et1, cnfine",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "spice.cell_double()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "2000",
              "object_description": "",
              "object_id": "",
              "intention_description": "Create database cursor",
              "intention_id": "create_database_cursor"
            },
            {
              "action_api": "spice.gfsntc()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "\"EARTH\", \"IAU_EARTH\", \"Ellipsoid\", \"NONE\", \"SUN\", \"SEM\", [1.0, 0.0, 0.0], \"LATITUDINAL\", \"LATITUDE\", \"=\", 0.0, 0.0, 90.0 * spice.spd(), 1000, cnfine, result",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "spice.wncard()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "result",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "spice.wnfetd()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "result, 0",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "spice.timout()",
              "action_description": "Parse string into datetime object",
              "action_id": "parse_datetime",
              "object": "beg, \"YYYY-MON-DD HR:MN:SC.###### (TDB) ::TDB ::RND\", 80",
              "object_description": "String containing environment data",
              "object_id": "string_environment_data",
              "intention_description": "Get datetime epoch",
              "intention_id": "get_datetime_epoch"
            },
            {
              "action_api": "spice.timout()",
              "action_description": "Parse string into datetime object",
              "action_id": "parse_datetime",
              "object": "end, \"YYYY-MON-DD HR:MN:SC.###### (TDB) ::TDB ::RND\", 80",
              "object_description": "String containing environment data",
              "object_id": "string_environment_data",
              "intention_description": "Get datetime epoch",
              "intention_id": "get_datetime_epoch"
            },
            {
              "action_api": "spice.wnfetd()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "result, 1",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "spice.timout()",
              "action_description": "Parse string into datetime object",
              "action_id": "parse_datetime",
              "object": "beg, \"YYYY-MON-DD HR:MN:SC.###### (TDB) ::TDB ::RND\", 80",
              "object_description": "String containing environment data",
              "object_id": "string_environment_data",
              "intention_description": "Get datetime epoch",
              "intention_id": "get_datetime_epoch"
            },
            {
              "action_api": "spice.timout()",
              "action_description": "Parse string into datetime object",
              "action_id": "parse_datetime",
              "object": "end, \"YYYY-MON-DD HR:MN:SC.###### (TDB) ::TDB ::RND\", 80",
              "object_description": "String containing environment data",
              "object_id": "string_environment_data",
              "intention_description": "Get datetime epoch",
              "intention_id": "get_datetime_epoch"
            },
            {
              "action_api": "cleanup_kernel()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "kernel",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            }
          ]
        }
      ]
    }
  ]
}