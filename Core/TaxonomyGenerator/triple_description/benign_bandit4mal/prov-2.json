{
  "metadata": {
    "package_name": "prov-2",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/prov-2.0.1.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "test_xml.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/prov-2.0.1/prov-2.0.1/src/prov/tests/test_xml.py",
      "line_number": "308",
      "type_description": "B815:write",
      "context_snippet": "def test_deserialization_example_04_and_05(self):\n    \"\"\"\n    Example 4 and 5 have a different type specification. They use an\n    xsi:type as an attribute on an entity. This can be read but if\n    written again it will become an XML child element. This is\n    semantically identical but cannot be tested with a round trip.\n    \"\"\"\n    # Example 4.\n    xml_string = \"\"\"\n    <prov:document\n        xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n        xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n        xmlns:prov=\"http://www.w3.org/ns/prov#\"\n        xmlns:ex=\"http://example.com/ns/ex#\"\n        xmlns:tr=\"http://example.com/ns/tr#\">\n\n      <prov:entity prov:id=\"tr:WD-prov-dm-20111215\" xsi:type=\"prov:Plan\">\n        <prov:type xsi:type=\"xsd:QName\">ex:Workflow</prov:type>\n      </prov:entity>\n\n    </prov:document>\n    \"\"\"\n    with io.StringIO() as xml:\n        xml.write(xml_string)\n        xml.seek(0, 0)\n        actual_document = prov.ProvDocument.deserialize(source=xml, format=\"xml\")\n\n    expected_document = prov.ProvDocument()\n    ex_ns = Namespace(*EX_NS)\n    expected_document.add_namespace(ex_ns)\n    expected_document.add_namespace(*EX_TR)\n\n    # The xsi:type attribute is mapped to a proper PROV attribute.\n    expected_document.entity(\n        \"tr:WD-prov-dm-20111215\",\n        (\n            (prov.PROV_TYPE, QualifiedName(ex_ns, \"Workflow\")),\n            (prov.PROV_TYPE, PROV[\"Plan\"]),\n        ),\n    )\n\n    self.assertEqual(actual_document, expected_document, \"example_04\")\n\n    # Example 5.\n    xml_string = \"\"\"\n    <prov:document\n      xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n      xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n      xmlns:prov=\"http://www.w3.org/ns/prov#\"\n      xmlns:ex=\"http://example.com/ns/ex#\"\n      xmlns:tr=\"http://example.com/ns/tr#\">\n\n    <prov:entity prov:id=\"tr:WD-prov-dm-20111215\" xsi:type=\"prov:Plan\">\n      <prov:type xsi:type=\"xsd:QName\">ex:Workflow</prov:type>\n      <prov:type xsi:type=\"xsd:QName\">prov:Plan</prov:type> <!-- inferred -->\n      <prov:type xsi:type=\"xsd:QName\">prov:Entity</prov:type> <!-- inferred -->\n    </prov:entity>\n\n    </prov:document>\n    \"\"\"\n    with io.StringIO() as xml:\n        xml.write(xml_string)\n        xml.seek(0, 0)\n        actual_document = prov.ProvDocument.deserialize(source=xml, format=\"xml\")\n\n    expected_document = prov.ProvDocument()\n    expected_document.add_namespace(*EX_NS)\n    expected_document.add_namespace(*EX_TR)\n\n    # The xsi:type attribute is mapped to a proper PROV attribute.\n    expected_document.entity(\n        \"tr:WD-prov-dm-20111215\",\n        (\n            (prov.PROV_TYPE, QualifiedName(ex_ns, \"Workflow\")),\n            (prov.PROV_TYPE, PROV[\"Entity\"]),\n            (prov.PROV_TYPE, PROV[\"Plan\"]),\n        ),\n    )\n\n    self.assertEqual(actual_document, expected_document, \"example_05\")",
      "hash_value": "b37367cc7811aabf5f5a7254eeb83810",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def test_deserialization_example_04_and_05(self):\n    \"\"\"\n    Example 4 and 5 have a different type specification. They use an\n    xsi:type as an attribute on an entity. This can be read but if\n    written again it will become an XML child element. This is\n    semantically identical but cannot be tested with a round trip.\n    \"\"\"\n    # Example 4.\n    xml_string = \"\"\"\n    <prov:document\n        xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n        xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n        xmlns:prov=\"http://www.w3.org/ns/prov#\"\n        xmlns:ex=\"http://example.com/ns/ex#\"\n        xmlns:tr=\"http://example.com/ns/tr#\">\n\n      <prov:entity prov:id=\"tr:WD-prov-dm-20111215\" xsi:type=\"prov:Plan\">\n        <prov:type xsi:type=\"xsd:QName\">ex:Workflow</prov:type>\n      </prov:entity>\n\n    </prov:document>\n    \"\"\"\n    with io.StringIO() as xml:\n        xml.write(xml_string)\n        xml.seek(0, 0)\n        actual_document = prov.ProvDocument.deserialize(source=xml, format=\"xml\")\n\n    expected_document = prov.ProvDocument()\n    ex_ns = Namespace(*EX_NS)\n    expected_document.add_namespace(ex_ns)\n    expected_document.add_namespace(*EX_TR)\n\n    # The xsi:type attribute is mapped to a proper PROV attribute.\n    expected_document.entity(\n        \"tr:WD-prov-dm-20111215\",\n        (\n            (prov.PROV_TYPE, QualifiedName(ex_ns, \"Workflow\")),\n            (prov.PROV_TYPE, PROV[\"Plan\"]),\n        ),\n    )\n\n    self.assertEqual(actual_document, expected_document, \"example_04\")\n\n    # Example 5.\n    xml_string = \"\"\"\n    <prov:document\n      xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n      xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"\n      xmlns:prov=\"http://www.w3.org/ns/prov#\"\n      xmlns:ex=\"http://example.com/ns/ex#\"\n      xmlns:tr=\"http://example.com/ns/tr#\">\n\n    <prov:entity prov:id=\"tr:WD-prov-dm-20111215\" xsi:type=\"prov:Plan\">\n      <prov:type xsi:type=\"xsd:QName\">ex:Workflow</prov:type>\n      <prov:type xsi:type=\"xsd:QName\">prov:Plan</prov:type> <!-- inferred -->\n      <prov:type xsi:type=\"xsd:QName\">prov:Entity</prov:type> <!-- inferred -->\n    </prov:entity>\n\n    </prov:document>\n    \"\"\"\n    with io.StringIO() as xml:\n        xml.write(xml_string)\n        xml.seek(0, 0)\n        actual_document = prov.ProvDocument.deserialize(source=xml, format=\"xml\")\n\n    expected_document = prov.ProvDocument()\n    expected_document.add_namespace(*EX_NS)\n    expected_document.add_namespace(*EX_TR)\n\n    # The xsi:type attribute is mapped to a proper PROV attribute.\n    expected_document.entity(\n        \"tr:WD-prov-dm-20111215\",\n        (\n            (prov.PROV_TYPE, QualifiedName(ex_ns, \"Workflow\")),\n            (prov.PROV_TYPE, PROV[\"Entity\"]),\n            (prov.PROV_TYPE, PROV[\"Plan\"]),\n        ),\n    )\n\n    self.assertEqual(actual_document, expected_document, \"example_05\")",
          "triple_sequences": [
            {
              "action_api": "io.StringIO()",
              "action_description": "Creates in-memory bytes buffer from encoded string",
              "action_id": "create_memory_bytes",
              "object": "xml_string",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Prepare file for temporary storage",
              "intention_id": "prepare_file_temp_storage"
            },
            {
              "action_api": "xml.write()",
              "action_description": "Saves image to in-memory buffer",
              "action_id": "save_image_buffer",
              "object": "xml_string",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "xml.seek()",
              "action_description": "Moves buffer pointer to start",
              "action_id": "move_buffer_pointer",
              "object": "0, 0",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare file for temporary storage",
              "intention_id": "prepare_file_temp_storage"
            },
            {
              "action_api": "prov.ProvDocument.deserialize()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "source=xml, format=\"xml\"",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "prov.ProvDocument()",
              "action_description": "Instantiates ProvDocument class",
              "action_id": "init_grabber_class",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare file for temporary storage",
              "intention_id": "prepare_file_temp_storage"
            },
            {
              "action_api": "Namespace()",
              "action_description": "Instantiates Namespace class",
              "action_id": "init_grabber_class",
              "object": "*EX_NS",
              "object_description": "Namespace string",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "expected_document.add_namespace()",
              "action_description": "Instantiates Namespace class",
              "action_id": "init_grabber_class",
              "object": "ex_ns",
              "object_description": "Namespace string",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "expected_document.add_namespace()",
              "action_description": "Instantiates Namespace class",
              "action_id": "init_grabber_class",
              "object": "*EX_TR",
              "object_description": "Namespace string",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "expected_document.entity()",
              "action_description": "Instantiates Entity class",
              "action_id": "init_grabber_class",
              "object": "\"tr:WD-prov-dm-20111215\", ((prov.PROV_TYPE, QualifiedName(ex_ns, \"Workflow\")), (prov.PROV_TYPE, PROV[\"Plan\"]))",
              "object_description": "Account name and token",
              "object_id": "account_credentials",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "self.assertEqual()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "actual_document, expected_document, \"example_04\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "prov.ProvDocument()",
              "action_description": "Instantiates ProvDocument class",
              "action_id": "init_grabber_class",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare file for temporary storage",
              "intention_id": "prepare_file_temp_storage"
            },
            {
              "action_api": "expected_document.add_namespace()",
              "action_description": "Instantiates Namespace class",
              "action_id": "init_grabber_class",
              "object": "*EX_NS",
              "object_description": "Namespace string",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "expected_document.add_namespace()",
              "action_description": "Instantiates Namespace class",
              "action_id": "init_grabber_class",
              "object": "*EX_TR",
              "object_description": "Namespace string",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "expected_document.entity()",
              "action_description": "Instantiates Entity class",
              "action_id": "init_grabber_class",
              "object": "\"tr:WD-prov-dm-20111215\", ((prov.PROV_TYPE, QualifiedName(ex_ns, \"Workflow\")), (prov.PROV_TYPE, PROV[\"Entity\"]), (prov.PROV_TYPE, PROV[\"Plan\"]))",
              "object_description": "Account name and token",
              "object_id": "account_credentials",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "self.assertEqual()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "actual_document, expected_document, \"example_05\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            }
          ]
        }
      ]
    }
  ]
}