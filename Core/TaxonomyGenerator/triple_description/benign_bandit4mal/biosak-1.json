{
  "metadata": {
    "package_name": "biosak-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/biosak-1.115.5.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "link_16s.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/biosak-1.115.5/BioSAK-1.115.5/BioSAK/link_16s.py",
      "line_number": "1511",
      "type_description": "B815:write",
      "context_snippet": "def qc_16s(file_in, file_out_ffn, uclust_op_fasta, uclust_op_uc, uclust_op_txt, no_polish, min_16s_len, no_cluster, uclust_iden_cutoff):\n\n    file_out_path, file_out_base, file_out_ext = sep_path_basename_ext(file_out_ffn)\n    barrnap_stdout      = '%s/%s.log'       % (file_out_path, file_out_base)\n    file_out_ffn_tmp    = '%s/%s_tmp%s'     % (file_out_path, file_out_base, file_out_ext)\n    file_out_gff        = '%s/%s.gff'       % (file_out_path, file_out_base)\n\n    # remove non-16S sequences, then filter by length\n    if no_polish is False:\n\n        barrnap_cmd = 'barrnap --quiet -o %s %s 2> %s > %s' % (file_out_ffn_tmp, file_in, barrnap_stdout, file_out_gff)\n        os.system(barrnap_cmd)\n\n        wrote_id = []\n        file_out_ffn_handle = open(file_out_ffn, 'w')\n        for each_16s in SeqIO.parse(file_out_ffn_tmp, 'fasta'):\n            seq_id = each_16s.id\n            if seq_id.startswith('16S_rRNA::'):\n                seq_id_polished = seq_id[10:].split(':')[0]\n                if len(each_16s.seq) >= min_16s_len:\n                    if seq_id_polished not in wrote_id:\n                        file_out_ffn_handle.write('>%s\\n' % seq_id_polished)\n                        file_out_ffn_handle.write('%s\\n' % str(each_16s.seq))\n                        wrote_id.append(seq_id_polished)\n                    else:\n                        file_out_ffn_handle.write('>%s_%s\\n' % (seq_id_polished, (wrote_id.count(seq_id_polished) + 1)))\n                        file_out_ffn_handle.write('%s\\n' % str(each_16s.seq))\n                        wrote_id.append(seq_id_polished)\n        file_out_ffn_handle.close()\n\n        # remove tmp files\n        os.system('rm %s' % file_out_ffn_tmp)\n        os.system('rm %s.fai' % file_in)\n\n    # only filter input 16S by length\n    else:\n        file_out_ffn_handle = open(file_out_ffn, 'w')\n        for each_16s in SeqIO.parse(file_in, 'fasta'):\n            if len(each_16s.seq) >= min_16s_len:\n                file_out_ffn_handle.write('>%s\\n' % each_16s.id)\n                file_out_ffn_handle.write('%s\\n' % str(each_16s.seq))\n        file_out_ffn_handle.close()\n\n    # check if there are no qualified sequences\n    if os.stat(file_out_ffn).st_size == 0:\n        print('No input 16S rRNA gene sequences passed quality control, program exited!')\n        exit()\n\n    # cluster 16S\n    if no_cluster is False:\n        uclust_cmd = 'usearch -cluster_fast %s -id %s -centroids %s -uc %s -sort length -quiet' % (file_out_ffn, (uclust_iden_cutoff/100), uclust_op_fasta, uclust_op_uc)\n        os.system(uclust_cmd)\n\n        # get readable cluster results\n        parse_uclust_output(uclust_op_uc, uclust_op_txt)\n",
      "hash_value": "8a4050759a224f772d1a455d9afdd538",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def qc_16s(file_in, file_out_ffn, uclust_op_fasta, uclust_op_uc, uclust_op_txt, no_polish, min_16s_len, no_cluster, uclust_iden_cutoff):\n\n    file_out_path, file_out_base, file_out_ext = sep_path_basename_ext(file_out_ffn)\n    barrnap_stdout      = '%s/%s.log'       % (file_out_path, file_out_base)\n    file_out_ffn_tmp    = '%s/%s_tmp%s'     % (file_out_path, file_out_base, file_out_ext)\n    file_out_gff        = '%s/%s.gff'       % (file_out_path, file_out_base)\n\n    # remove non-16S sequences, then filter by length\n    if no_polish is False:\n\n        barrnap_cmd = 'barrnap --quiet -o %s %s 2> %s > %s' % (file_out_ffn_tmp, file_in, barrnap_stdout, file_out_gff)\n        os.system(barrnap_cmd)\n\n        wrote_id = []\n        file_out_ffn_handle = open(file_out_ffn, 'w')\n        for each_16s in SeqIO.parse(file_out_ffn_tmp, 'fasta'):\n            seq_id = each_16s.id\n            if seq_id.startswith('16S_rRNA::'):\n                seq_id_polished = seq_id[10:].split(':')[0]\n                if len(each_16s.seq) >= min_16s_len:\n                    if seq_id_polished not in wrote_id:\n                        file_out_ffn_handle.write('>%s\\n' % seq_id_polished)\n                        file_out_ffn_handle.write('%s\\n' % str(each_16s.seq))\n                        wrote_id.append(seq_id_polished)\n                    else:\n                        file_out_ffn_handle.write('>%s_%s\\n' % (seq_id_polished, (wrote_id.count(seq_id_polished) + 1)))\n                        file_out_ffn_handle.write('%s\\n' % str(each_16s.seq))\n                        wrote_id.append(seq_id_polished)\n        file_out_ffn_handle.close()\n\n        # remove tmp files\n        os.system('rm %s' % file_out_ffn_tmp)\n        os.system('rm %s.fai' % file_in)\n\n    # only filter input 16S by length\n    else:\n        file_out_ffn_handle = open(file_out_ffn, 'w')\n        for each_16s in SeqIO.parse(file_in, 'fasta'):\n            if len(each_16s.seq) >= min_16s_len:\n                file_out_ffn_handle.write('>%s\\n' % each_16s.id)\n                file_out_ffn_handle.write('%s\\n' % str(each_16s.seq))\n        file_out_ffn_handle.close()\n\n    # check if there are no qualified sequences\n    if os.stat(file_out_ffn).st_size == 0:\n        print('No input 16S rRNA gene sequences passed quality control, program exited!')\n        exit()\n\n    # cluster 16S\n    if no_cluster is False:\n        uclust_cmd = 'usearch -cluster_fast %s -id %s -centroids %s -uc %s -sort length -quiet' % (file_out_ffn, (uclust_iden_cutoff/100), uclust_op_fasta, uclust_op_uc)\n        os.system(uclust_cmd)\n\n        # get readable cluster results\n        parse_uclust_output(uclust_op_uc, uclust_op_txt)\n",
          "triple_sequences": [
            {
              "action_api": "sep_path_basename_ext()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "file_out_ffn",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "barrnap --quiet -o %s %s 2> %s > %s",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "file_out_ffn, 'w'",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "SeqIO.parse()",
              "action_description": "Basic read operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "file_out_ffn_tmp, 'fasta'",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for reading",
              "intention_id": "open_file_reading"
            },
            {
              "action_api": "file_out_ffn_handle.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "'>%s\\n' % seq_id_polished",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file_out_ffn_handle.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "'%s\\n' % str(each_16s.seq)",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file_out_ffn_handle.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "'>%s_%s\\n' % (seq_id_polished, (wrote_id.count(seq_id_polished) + 1))",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file_out_ffn_handle.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "'%s\\n' % str(each_16s.seq)",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file_out_ffn_handle.close()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "file_out_ffn_handle",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Close file",
              "intention_id": "close_file"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "'rm %s' % file_out_ffn_tmp",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "'rm %s.fai' % file_in",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "file_out_ffn, 'w'",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "SeqIO.parse()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "file_in, 'fasta'",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for reading",
              "intention_id": "open_file_reading"
            },
            {
              "action_api": "file_out_ffn_handle.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "'>%s\\n' % each_16s.id",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file_out_ffn_handle.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "'%s\\n' % str(each_16s.seq)",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file_out_ffn_handle.close()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "file_out_ffn_handle",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Close file",
              "intention_id": "close_file"
            },
            {
              "action_api": "os.stat()",
              "action_description": "Path object and status operations (creating Path objects, retrieving file status)",
              "action_id": "path_object_operations",
              "object": "file_out_ffn",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "print()",
              "action_description": "Reads user input from standard input",
              "action_id": "read_user_input",
              "object": "'No input 16S rRNA gene sequences passed quality control, program exited!'",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Stop execution on invalid input",
              "intention_id": "stop_execution_invalid_input"
            },
            {
              "action_api": "exit()",
              "action_description": "Exits program",
              "action_id": "exit_program",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Terminate program execution",
              "intention_id": "terminate_program_execution"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "usearch -cluster_fast %s -id %s -centroids %s -uc %s -sort length -quiet",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "parse_uclust_output()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "uclust_op_uc, uclust_op_txt",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            }
          ]
        }
      ]
    }
  ]
}