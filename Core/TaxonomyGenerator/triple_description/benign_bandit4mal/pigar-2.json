{
  "metadata": {
    "package_name": "pigar-2",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/pigar-2.1.7.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "misc.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pigar-2.1.7/pigar-2.1.7/pigar/_vendor/pip/_internal/utils/misc.py",
      "line_number": "769",
      "type_description": "B811:getuid",
      "context_snippet": "def warn_if_run_as_root() -> None:\n    \"\"\"Output a warning for sudo users on Unix.\n\n    In a virtual environment, sudo pip still writes to virtualenv.\n    On Windows, users may run pip as Administrator without issues.\n    This warning only applies to Unix root users outside of virtualenv.\n    \"\"\"\n    if running_under_virtualenv():\n        return\n    if not hasattr(os, \"getuid\"):\n        return\n    # On Windows, there are no \"system managed\" Python packages. Installing as\n    # Administrator via pip is the correct way of updating system environments.\n    #\n    # We choose sys.platform over utils.compat.WINDOWS here to enable Mypy platform\n    # checks: https://mypy.readthedocs.io/en/stable/common_issues.html\n    if sys.platform == \"win32\" or sys.platform == \"cygwin\":\n        return\n\n    if os.getuid() != 0:\n        return\n\n    logger.warning(\n        \"Running pip as the 'root' user can result in broken permissions and \"\n        \"conflicting behaviour with the system package manager, possibly \"\n        \"rendering your system unusable.\"\n        \"It is recommended to use a virtual environment instead: \"\n        \"https://pip.pypa.io/warnings/venv. \"\n        \"Use the --root-user-action option if you know what you are doing and \"\n        \"want to suppress this warning.\"\n    )",
      "hash_value": "ce515c0e0890813f7cf0b86bbc4c1063",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def warn_if_run_as_root() -> None:\n    \"\"\"Output a warning for sudo users on Unix.\n\n    In a virtual environment, sudo pip still writes to virtualenv.\n    On Windows, users may run pip as Administrator without issues.\n    This warning only applies to Unix root users outside of virtualenv.\n    \"\"\"\n    if running_under_virtualenv():\n        return\n    if not hasattr(os, \"getuid\"):\n        return\n    # On Windows, there are no \"system managed\" Python packages. Installing as\n    # Administrator via pip is the correct way of updating system environments.\n    #\n    # We choose sys.platform over utils.compat.WINDOWS here to enable Mypy platform\n    # checks: https://mypy.readthedocs.io/en/stable/common_issues.html\n    if sys.platform == \"win32\" or sys.platform == \"cygwin\":\n        return\n\n    if os.getuid() != 0:\n        return\n\n    logger.warning(\n        \"Running pip as the 'root' user can result in broken permissions and \"\n        \"conflicting behaviour with the system package manager, possibly \"\n        \"rendering your system unusable.\"\n        \"It is recommended to use a virtual environment instead: \"\n        \"https://pip.pypa.io/warnings/venv. \"\n        \"Use the --root-user-action option if you know what you are doing and \"\n        \"want to suppress this warning.\"\n    )",
          "triple_sequences": [
            {
              "action_api": "hasattr()",
              "action_description": "Checks if object is instance of specified type",
              "action_id": "check_instance_type",
              "object": "os, \"getuid\"",
              "object_description": "Builtin module",
              "object_id": "builtin_module",
              "intention_description": "Determine required module presence",
              "intention_id": "determine_required_module_presence"
            },
            {
              "action_api": "sys.platform",
              "action_description": "Retrieves operating system identifier",
              "action_id": "get_os_id",
              "object": "sys.platform",
              "object_description": "Operating system identifier",
              "object_id": "",
              "intention_description": "Determine operating system",
              "intention_id": "determine_operating_system"
            },
            {
              "action_api": "os.getuid()",
              "action_description": "Checks if process is running with administrator privileges",
              "action_id": "check_admin_privileges",
              "object": "os.getuid()",
              "object_description": "Current user ID",
              "object_id": "",
              "intention_description": "Determine administrator status",
              "intention_id": "determine_administrator_status"
            },
            {
              "action_api": "logger.warning()",
              "action_description": "Writes file content",
              "action_id": "basic_write_operations",
              "object": "\"Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable.It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.\"",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            }
          ]
        }
      ]
    }
  ]
}