{
  "metadata": {
    "package_name": "airbyte_cdk-6",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/airbyte_cdk-6.45.0.post24.dev14387467928.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "simple_retriever.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/airbyte_cdk-6.45.0.post24.dev14387467928/airbyte_cdk-6.45.0.post24.dev14387467928/airbyte_cdk/sources/declarative/retrievers/simple_retriever.py",
      "line_number": "766",
      "type_description": "B820:get",
      "context_snippet": "def _read_pages(\n    self,\n    records_generator_fn: Callable[[Optional[requests.Response]], Iterable[Record]],\n    stream_state: Mapping[str, Any],\n    stream_slice: StreamSlice,\n) -> Iterable[Record]:\n    pagination_complete = False\n    initial_token = self._paginator.get_initial_token()\n    next_page_token: Optional[Mapping[str, Any]] = (\n        {\"next_page_token\": initial_token} if initial_token else None\n    )\n    while not pagination_complete:\n        response = self._fetch_next_page(stream_state, stream_slice, next_page_token)\n\n        last_page_size = 0\n        last_record: Optional[Record] = None\n        for record in records_generator_fn(response):\n            last_page_size += 1\n            last_record = record\n            yield record\n\n        if not response:\n            pagination_complete = True\n        else:\n            last_page_token_value = (\n                next_page_token.get(\"next_page_token\") if next_page_token else None\n            )\n            next_page_token = self._next_page_token(\n                response=response,\n                last_page_size=last_page_size,\n                last_record=last_record,\n                last_page_token_value=last_page_token_value,\n            )\n            if not next_page_token:\n                pagination_complete = True\n\n    # Always return an empty generator just in case no records were ever yielded\n    yield from []",
      "hash_value": "0e26067d5e7871c1b76796116b80273b",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def _read_pages(\n    self,\n    records_generator_fn: Callable[[Optional[requests.Response]], Iterable[Record]],\n    stream_state: Mapping[str, Any],\n    stream_slice: StreamSlice,\n) -> Iterable[Record]:\n    pagination_complete = False\n    initial_token = self._paginator.get_initial_token()\n    next_page_token: Optional[Mapping[str, Any]] = (\n        {\"next_page_token\": initial_token} if initial_token else None\n    )\n    while not pagination_complete:\n        response = self._fetch_next_page(stream_state, stream_slice, next_page_token)\n\n        last_page_size = 0\n        last_record: Optional[Record] = None\n        for record in records_generator_fn(response):\n            last_page_size += 1\n            last_record = record\n            yield record\n\n        if not response:\n            pagination_complete = True\n        else:\n            last_page_token_value = (\n                next_page_token.get(\"next_page_token\") if next_page_token else None\n            )\n            next_page_token = self._next_page_token(\n                response=response,\n                last_page_size=last_page_size,\n                last_record=last_record,\n                last_page_token_value=last_page_token_value,\n            )\n            if not next_page_token:\n                pagination_complete = True\n\n    # Always return an empty generator just in case no records were ever yielded\n    yield from []",
          "triple_sequences": [
            {
              "action_api": "self._paginator.get_initial_token()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "self._fetch_next_page()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "stream_state, stream_slice, next_page_token",
              "object_description": "",
              "object_id": "",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "records_generator_fn()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "response",
              "object_description": "HTTP response content from remote server",
              "object_id": "http_response_remote_content",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "self._next_page_token()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "response, last_page_size, last_record, last_page_token_value",
              "object_description": "",
              "object_id": "",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            }
          ]
        }
      ]
    }
  ]
}