{
  "metadata": {
    "package_name": "stac_fastapi_pgstac-5",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/stac_fastapi_pgstac-5.0.2.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "test_item.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/stac_fastapi_pgstac-5.0.2/stac_fastapi_pgstac-5.0.2/tests/resources/test_item.py",
      "line_number": "643",
      "type_description": "B820:get",
      "context_snippet": "async def test_item_search_by_id_get(app_client, load_test_data, load_test_collection):\n    \"\"\"Test GET search by item id (core)\"\"\"\n    ids = [\"test1\", \"test2\", \"test3\"]\n    for id in ids:\n        test_item = load_test_data(\"test_item.json\")\n        test_item[\"id\"] = id\n        resp = await app_client.post(\n            f\"/collections/{test_item['collection']}/items\", json=test_item\n        )\n        assert resp.status_code == 201\n\n    params = {\"collections\": test_item[\"collection\"], \"ids\": \",\".join(ids)}\n    resp = await app_client.get(\"/search\", params=params)\n    assert resp.status_code == 200\n    resp_json = resp.json()\n    assert len(resp_json[\"features\"]) == len(ids)\n    assert {feat[\"id\"] for feat in resp_json[\"features\"]} == set(ids)\n",
      "hash_value": "6281b5fb19f1d1463f87fc8bcb1be641",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "async def test_item_search_by_id_get(app_client, load_test_data, load_test_collection):\n    \"\"\"Test GET search by item id (core)\"\"\"\n    ids = [\"test1\", \"test2\", \"test3\"]\n    for id in ids:\n        test_item = load_test_data(\"test_item.json\")\n        test_item[\"id\"] = id\n        resp = await app_client.post(\n            f\"/collections/{test_item['collection']}/items\", json=test_item\n        )\n        assert resp.status_code == 201\n\n    params = {\"collections\": test_item[\"collection\"], \"ids\": \",\".join(ids)}\n    resp = await app_client.get(\"/search\", params=params)\n    assert resp.status_code == 200\n    resp_json = resp.json()\n    assert len(resp_json[\"features\"]) == len(ids)\n    assert {feat[\"id\"] for feat in resp_json[\"features\"]} == set(ids)\n",
          "triple_sequences": [
            {
              "action_api": "load_test_data()",
              "action_description": "Deserializes JSON string to Python object",
              "action_id": "deserialize_from_json",
              "object": "\"test_item.json\"",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "app_client.post()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "f\"/collections/{test_item['collection']}/items\", json=test_item",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "app_client.get()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "\"/search\", params=params",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "resp.json()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            }
          ]
        }
      ]
    }
  ]
}