{
  "metadata": {
    "package_name": "naked-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/naked-0.1.32.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "shell.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/naked-0.1.32/Naked-0.1.32/lib/Naked/toolshed/shell.py",
      "line_number": "238",
      "type_description": "B815:write",
      "context_snippet": "import os\nimport sys\nfrom Naked.settings import debug as DEBUG_FLAG\n\nclass Environment():\n    def __init__(self):\n        self.env = os.environ\n        self.vars = list(os.environ.keys())\n\n    #------------------------------------------------------------------------------\n    # [ get_var method ] (string)\n    #   get the variable value for a variable in the shell environment list\n    #   returns empty string if the variable is not included in the environment variable list\n    #------------------------------------------------------------------------------\n    def get_var(self, var_name):\n        try:\n            if var_name in self.vars:\n                return self.env[var_name]\n            else:\n                return \"\"\n        except Exception as e:\n            if DEBUG_FLAG:\n                sys.stderr.write(\"Naked Framework Error: unable to return the requested shell variable with the get_var() method (Naked.toolshed.shell).\")\n            raise e",
      "hash_value": "9e0fbe51392a20245d843d2a44018514",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "import os\nimport sys\nfrom Naked.settings import debug as DEBUG_FLAG\n\nclass Environment():\n    def __init__(self):\n        self.env = os.environ\n        self.vars = list(os.environ.keys())\n\n    #------------------------------------------------------------------------------\n    # [ get_var method ] (string)\n    #   get the variable value for a variable in the shell environment list\n    #   returns empty string if the variable is not included in the environment variable list\n    #------------------------------------------------------------------------------\n    def get_var(self, var_name):\n        try:\n            if var_name in self.vars:\n                return self.env[var_name]\n            else:\n                return \"\"\n        except Exception as e:\n            if DEBUG_FLAG:\n                sys.stderr.write(\"Naked Framework Error: unable to return the requested shell variable with the get_var() method (Naked.toolshed.shell).\")\n            raise e",
          "triple_sequences": [
            {
              "action_api": "os.environ",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "os.environ",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.environ.keys()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "os.environ.keys()",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "self.env[var_name]",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "var_name",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Access configuration value",
              "intention_id": "access_configuration_value"
            },
            {
              "action_api": "sys.stderr.write()",
              "action_description": "Writes file content",
              "action_id": "basic_write_operations",
              "object": "Naked Framework Error: unable to return the requested shell variable with the get_var() method (Naked.toolshed.shell).",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Access command error output",
              "intention_id": "access_command_error_output"
            }
          ]
        }
      ]
    }
  ]
}