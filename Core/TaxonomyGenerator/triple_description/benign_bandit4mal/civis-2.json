{
  "metadata": {
    "package_name": "civis-2",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/civis-2.5.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "test_io.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/civis-2.5.0/civis-2.5.0/tests/test_io.py",
      "line_number": "1068",
      "type_description": "B832:write",
      "context_snippet": "@mock.patch(\"civis.io._tables.CivisFuture\")\n@mock.patch(\"civis.io._tables.civis_to_file\")\n@mock.patch(\"civis.io._tables._sql_script\")\ndef test_civis_to_multifile_passes_client(\n    m_sql_script, m_civis_to_file, m_CivisFuture, *mocks\n):\n    \"\"\"Ensure the client kwarg is passed forward.\"\"\"\n    m_sql_script.return_value = (mock.MagicMock(), mock.MagicMock())\n    # We need to write some JSON into the buffer to avoid errors.\n    m_civis_to_file.side_effect = lambda _, buf, *args, **kwargs: buf.write(b\"{}\")\n    mock_client = mock.MagicMock()\n\n    civis.io.civis_to_multifile_csv(\"sql\", \"db\", client=mock_client)\n\n    m_civis_to_file.assert_called_once_with(mock.ANY, mock.ANY, client=mock_client)\n",
      "hash_value": "df0846590c2aedeae553e9e2f6c45579",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "@mock.patch(\"civis.io._tables.CivisFuture\")\n@mock.patch(\"civis.io._tables.civis_to_file\")\n@mock.patch(\"civis.io._tables._sql_script\")\ndef test_civis_to_multifile_passes_client(\n    m_sql_script, m_civis_to_file, m_CivisFuture, *mocks\n):\n    \"\"\"Ensure the client kwarg is passed forward.\"\"\"\n    m_sql_script.return_value = (mock.MagicMock(), mock.MagicMock())\n    # We need to write some JSON into the buffer to avoid errors.\n    m_civis_to_file.side_effect = lambda _, buf, *args, **kwargs: buf.write(b\"{}\")\n    mock_client = mock.MagicMock()\n\n    civis.io.civis_to_multifile_csv(\"sql\", \"db\", client=mock_client)\n\n    m_civis_to_file.assert_called_once_with(mock.ANY, mock.ANY, client=mock_client)\n",
          "triple_sequences": [
            {
              "action_api": "buf.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "b\"{}\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "civis.io.civis_to_multifile_csv()",
              "action_description": "Executes SQL query",
              "action_id": "execute_sql_query",
              "object": "\"sql\", \"db\", client=mock_client",
              "object_description": "SQL query string",
              "object_id": "sql_query_string",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "m_civis_to_file.assert_called_once_with()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "mock.ANY, mock.ANY, client=mock_client",
              "object_description": "",
              "object_id": "",
              "intention_description": "Determine_required_module_presence",
              "intention_id": "determine_required_module_presence"
            }
          ]
        }
      ]
    }
  ]
}