{
  "metadata": {
    "package_name": "hashin-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/hashin-1.0.3.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "hashin.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/hashin-1.0.3/hashin-1.0.3/hashin.py",
      "line_number": "311",
      "type_description": "B815:write",
      "context_snippet": "def interactive_upgrade_request(\n    package, old_version, new_version, print_header=False, force_yes=False\n):\n    def print_version(v):\n        return str(v).replace(\"==\", \"\").ljust(15)\n\n    if print_header:\n        print(\n            \"PACKAGE\".ljust(30),\n            print_version(\"YOUR VERSION\"),\n            print_version(\"NEW VERSION\"),\n        )\n\n    def print_line(checkbox=None):\n        if checkbox is None:\n            checkboxed = \"?\"\n        elif checkbox:\n            checkboxed = \"✓\"\n        else:\n            checkboxed = \"✘\"\n        print(\n            package.ljust(30),\n            print_version(old_version),\n            print_version(new_version),\n            checkboxed,\n        )\n\n    if force_yes:\n        print_line(True)\n        return \"YES\"\n    else:\n        print_line()\n\n    printed_help = []\n\n    def print_help():\n        print(\n            \"y - Include this update (default)\\n\"\n            \"n - Skip this update\\n\"\n            \"a - Include this and all following upgrades\\n\"\n            \"q - Skip this and all following upgrades\\n\"\n            \"? - Print this help\\n\"\n        )\n        printed_help.append(1)\n\n    def clear_line():\n        sys.stdout.write(\"\\033[F\")  # Cursor up one line\n        sys.stdout.write(\"\\033[K\")  # Clear to the end of line\n\n    def ask():\n        answer = input(\"Update? [Y/n/a/q/?]: \").lower().strip()\n        if printed_help:\n            # Because the print_help() prints 5 lines to stdout.\n            # Plus 2 because of the original question line and the extra blank line.\n            for i in range(5 + 2):\n                clear_line()\n            # printed_help.clear()\n            del printed_help[:]\n\n        if answer == \"n\":\n            clear_line()\n            clear_line()\n            print_line(False)\n            return \"NO\"\n        if answer == \"a\":\n            clear_line()\n            clear_line()\n            print_line(True)\n            return \"ALL\"\n        if answer == \"q\":\n            return \"QUIT\"\n        if answer == \"y\" or answer == \"\" or answer == \"yes\":\n            clear_line()\n            clear_line()\n            print_line(True)\n            return \"YES\"\n        if answer == \"?\":\n            print_help()\n\n        return ask()\n\n    return ask()",
      "hash_value": "4ec0a2a86e362f033ca4a06182095f01",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def interactive_upgrade_request(\n    package, old_version, new_version, print_header=False, force_yes=False\n):\n    def print_version(v):\n        return str(v).replace(\"==\", \"\").ljust(15)\n\n    if print_header:\n        print(\n            \"PACKAGE\".ljust(30),\n            print_version(\"YOUR VERSION\"),\n            print_version(\"NEW VERSION\"),\n        )\n\n    def print_line(checkbox=None):\n        if checkbox is None:\n            checkboxed = \"?\"\n        elif checkbox:\n            checkboxed = \"✓\"\n        else:\n            checkboxed = \"✘\"\n        print(\n            package.ljust(30),\n            print_version(old_version),\n            print_version(new_version),\n            checkboxed,\n        )\n\n    if force_yes:\n        print_line(True)\n        return \"YES\"\n    else:\n        print_line()\n\n    printed_help = []\n\n    def print_help():\n        print(\n            \"y - Include this update (default)\\n\"\n            \"n - Skip this update\\n\"\n            \"a - Include this and all following upgrades\\n\"\n            \"q - Skip this and all following upgrades\\n\"\n            \"? - Print this help\\n\"\n        )\n        printed_help.append(1)\n\n    def clear_line():\n        sys.stdout.write(\"\\033[F\")  # Cursor up one line\n        sys.stdout.write(\"\\033[K\")  # Clear to the end of line\n\n    def ask():\n        answer = input(\"Update? [Y/n/a/q/?]: \").lower().strip()\n        if printed_help:\n            # Because the print_help() prints 5 lines to stdout.\n            # Plus 2 because of the original question line and the extra blank line.\n            for i in range(5 + 2):\n                clear_line()\n            # printed_help.clear()\n            del printed_help[:]\n\n        if answer == \"n\":\n            clear_line()\n            clear_line()\n            print_line(False)\n            return \"NO\"\n        if answer == \"a\":\n            clear_line()\n            clear_line()\n            print_line(True)\n            return \"ALL\"\n        if answer == \"q\":\n            return \"QUIT\"\n        if answer == \"y\" or answer == \"\" or answer == \"yes\":\n            clear_line()\n            clear_line()\n            print_line(True)\n            return \"YES\"\n        if answer == \"?\":\n            print_help()\n\n        return ask()\n\n    return ask()",
          "triple_sequences": [
            {
              "action_api": "print()",
              "action_description": "Retrieves standard output stream object",
              "action_id": "get_stdout_stream",
              "object": "\"PACKAGE\".ljust(30), print_version(\"YOUR VERSION\"), print_version(\"NEW VERSION\")",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Collect command output",
              "intention_id": "collect_command_output"
            },
            {
              "action_api": "print()",
              "action_description": "Retrieves standard output stream object",
              "action_id": "get_stdout_stream",
              "object": "package.ljust(30), print_version(old_version), print_version(new_version), checkboxed",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Collect command output",
              "intention_id": "collect_command_output"
            },
            {
              "action_api": "print()",
              "action_description": "Retrieves standard output stream object",
              "action_id": "get_stdout_stream",
              "object": "\"y - Include this update (default)\\n\" \"n - Skip this update\\n\" \"a - Include this and all following upgrades\\n\" \"q - Skip this and all following upgrades\\n\" \"? - Print this help\\n\"",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Collect command output",
              "intention_id": "collect_command_output"
            },
            {
              "action_api": "input()",
              "action_description": "Reads user input from standard input",
              "action_id": "read_user_input",
              "object": "\"Update? [Y/n/a/q/?]: \"",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Collect user input",
              "intention_id": "collect_user_input"
            },
            {
              "action_api": "sys.stdout.write()",
              "action_description": "Retrieves standard output stream object",
              "action_id": "get_stdout_stream",
              "object": "\"\\033[F\"",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Collect command output",
              "intention_id": "collect_command_output"
            },
            {
              "action_api": "sys.stdout.write()",
              "action_description": "Retrieves standard output stream object",
              "action_id": "get_stdout_stream",
              "object": "\"\\033[K\"",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Collect command output",
              "intention_id": "collect_command_output"
            }
          ]
        }
      ]
    }
  ]
}