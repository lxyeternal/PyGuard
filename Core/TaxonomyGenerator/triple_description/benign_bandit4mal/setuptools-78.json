{
  "metadata": {
    "package_name": "setuptools-78",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/setuptools-78.1.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "test_pkg_resources.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/setuptools-78.1.0/setuptools-78.1.0/pkg_resources/tests/test_pkg_resources.py",
      "line_number": "349",
      "type_description": "B810:chmod",
      "context_snippet": "@pytest.fixture\n    def env(self, tmpdir):\n        \"\"\"\n        Create a package environment, similar to a virtualenv,\n        in which packages are installed.\n        \"\"\"\n\n        class Environment(str):\n            pass\n\n        env = Environment(tmpdir)\n        tmpdir.chmod(stat.S_IRWXU)\n        subs = 'home', 'lib', 'scripts', 'data', 'egg-base'\n        env.paths = dict((dirname, str(tmpdir / dirname)) for dirname in subs)\n        list(map(os.mkdir, env.paths.values()))\n        return env",
      "hash_value": "20862f096e1b56c3177b7e1d554a532e",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "@pytest.fixture\n    def env(self, tmpdir):\n        \"\"\"\n        Create a package environment, similar to a virtualenv,\n        in which packages are installed.\n        \"\"\"\n\n        class Environment(str):\n            pass\n\n        env = Environment(tmpdir)\n        tmpdir.chmod(stat.S_IRWXU)\n        subs = 'home', 'lib', 'scripts', 'data', 'egg-base'\n        env.paths = dict((dirname, str(tmpdir / dirname)) for dirname in subs)\n        list(map(os.mkdir, env.paths.values()))\n        return env",
          "triple_sequences": [
            {
              "action_api": "tmpdir.chmod()",
              "action_description": "Changes file mode to add execute permission",
              "action_id": "change_file_mode_execute",
              "object": "stat.S_IRWXU",
              "object_description": "File permission settings",
              "object_id": "file_permission",
              "intention_description": "Modify file attributes",
              "intention_id": "modify_file_attributes"
            },
            {
              "action_api": "os.mkdir()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "env.paths.values()",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            }
          ]
        }
      ]
    }
  ]
}