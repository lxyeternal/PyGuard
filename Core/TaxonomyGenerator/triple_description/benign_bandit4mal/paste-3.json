{
  "metadata": {
    "package_name": "paste-3",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/paste-3.10.1.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "test_fileapp.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/paste-3.10.1/paste-3.10.1/tests/test_fileapp.py",
      "line_number": "120",
      "type_description": "B832:write",
      "context_snippet": "def test_file():\n    tempfile = \"test_fileapp.%s.txt\" % (random.random())\n    content = LETTERS * 20\n    content = content.encode('utf8')\n    with open(tempfile, \"wb\") as fp:\n        fp.write(content)\n    try:\n        app = fileapp.FileApp(tempfile)\n        res = TestApp(app).get(\"/\")\n        assert len(content) == int(res.header('content-length'))\n        assert 'text/plain' == res.header('content-type')\n        assert content == res.body\n        assert content == app.content  # this is cashed\n        lastmod = res.header('last-modified')\n        print(\"updating\", tempfile)\n        file = open(tempfile,\"a+\")\n        file.write(\"0123456789\")\n        file.close()\n        res = TestApp(app).get(\"/\",headers={'Cache-Control': 'max-age=0'})\n        assert len(content)+10 == int(res.header('content-length'))\n        assert 'text/plain' == res.header('content-type')\n        assert content + b\"0123456789\" == res.body\n        assert app.content # we are still cached\n        file = open(tempfile,\"a+\")\n        file.write(\"X\" * fileapp.CACHE_SIZE) # exceed the cashe size\n        file.write(\"YZ\")\n        file.close()\n        res = TestApp(app).get(\"/\",headers={'Cache-Control': 'max-age=0'})\n        newsize = fileapp.CACHE_SIZE + len(content)+12\n        assert newsize == int(res.header('content-length'))\n        assert newsize == len(res.body)\n        assert res.body.startswith(content) and res.body.endswith(b'XYZ')\n        assert not app.content # we are no longer cached\n    finally:\n        os.unlink(tempfile)",
      "hash_value": "084db38692f3476e127e6a52572642dc",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def test_file():\n    tempfile = \"test_fileapp.%s.txt\" % (random.random())\n    content = LETTERS * 20\n    content = content.encode('utf8')\n    with open(tempfile, \"wb\") as fp:\n        fp.write(content)\n    try:\n        app = fileapp.FileApp(tempfile)\n        res = TestApp(app).get(\"/\")\n        assert len(content) == int(res.header('content-length'))\n        assert 'text/plain' == res.header('content-type')\n        assert content == res.body\n        assert content == app.content  # this is cashed\n        lastmod = res.header('last-modified')\n        print(\"updating\", tempfile)\n        file = open(tempfile,\"a+\")\n        file.write(\"0123456789\")\n        file.close()\n        res = TestApp(app).get(\"/\",headers={'Cache-Control': 'max-age=0'})\n        assert len(content)+10 == int(res.header('content-length'))\n        assert 'text/plain' == res.header('content-type')\n        assert content + b\"0123456789\" == res.body\n        assert app.content # we are still cached\n        file = open(tempfile,\"a+\")\n        file.write(\"X\" * fileapp.CACHE_SIZE) # exceed the cashe size\n        file.write(\"YZ\")\n        file.close()\n        res = TestApp(app).get(\"/\",headers={'Cache-Control': 'max-age=0'})\n        newsize = fileapp.CACHE_SIZE + len(content)+12\n        assert newsize == int(res.header('content-length'))\n        assert newsize == len(res.body)\n        assert res.body.startswith(content) and res.body.endswith(b'XYZ')\n        assert not app.content # we are no longer cached\n    finally:\n        os.unlink(tempfile)",
          "triple_sequences": [
            {
              "action_api": "random.random()",
              "action_description": "Generate random number",
              "action_id": "generate_random_number",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Create random file name",
              "intention_id": "create_random_filename"
            },
            {
              "action_api": "str.encode()",
              "action_description": "Encodes string to bytes using default encoding",
              "action_id": "encode_string_to_bytes",
              "object": "'utf8'",
              "object_description": "Character encoding type",
              "object_id": "character_encoding_type",
              "intention_description": "Encode string to bytes",
              "intention_id": "encode_string_to_bytes"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "tempfile, \"wb\"",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "fp.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "content",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "fileapp.FileApp()",
              "action_description": "Instantiates Fileapp class",
              "action_id": "init_filezilla_class",
              "object": "tempfile",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Prepare path for file operations",
              "intention_id": "prepare_path_file_operations"
            },
            {
              "action_api": "TestApp().get()",
              "action_description": "Opens URL with GET parameters",
              "action_id": "open_url_get",
              "object": "\"/\"",
              "object_description": "Path segment",
              "object_id": "path_segment",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "res.header()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "'content-length'",
              "object_description": "HTTP header",
              "object_id": "http_header",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "res.header()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "'content-type'",
              "object_description": "HTTP header",
              "object_id": "http_header",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "res.body",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "app.content",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "res.header()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "'last-modified'",
              "object_description": "HTTP header",
              "object_id": "http_header",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "tempfile, \"a+\"",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"0123456789\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.close()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close file",
              "intention_id": "close_file"
            },
            {
              "action_api": "TestApp().get()",
              "action_description": "Opens URL with GET parameters",
              "action_id": "open_url_get",
              "object": "\"/\", headers={'Cache-Control': 'max-age=0'}",
              "object_description": "HTTP header",
              "object_id": "http_header",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "tempfile, \"a+\"",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"X\" * fileapp.CACHE_SIZE",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"YZ\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.close()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close file",
              "intention_id": "close_file"
            },
            {
              "action_api": "TestApp().get()",
              "action_description": "Opens URL with GET parameters",
              "action_id": "open_url_get",
              "object": "\"/\", headers={'Cache-Control': 'max-age=0'}",
              "object_description": "HTTP header",
              "object_id": "http_header",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "os.unlink()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "tempfile",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            }
          ]
        }
      ]
    }
  ]
}