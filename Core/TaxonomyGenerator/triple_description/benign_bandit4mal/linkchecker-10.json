{
  "metadata": {
    "package_name": "linkchecker-10",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/linkchecker-10.5.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "console.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/linkchecker-10.5.0/LinkChecker-10.5.0/linkcheck/director/console.py",
      "line_number": "56",
      "type_description": "B815:write",
      "context_snippet": "class StatusLogger:\n    \"\"\"Standard status logger. Default output is stderr.\"\"\"\n\n    def __init__(self, fd=stderr):\n        \"\"\"Save file descriptor for logging.\"\"\"\n        self.fd = fd\n\n    def log_status(self, checked, in_progress, queue, duration, num_urls):\n        \"\"\"Write status message to file descriptor.\"\"\"\n        msg = _n(\"%2d thread active\", \"%2d threads active\", in_progress) % in_progress\n        self.write(\"%s, \" % msg)\n        msg = _n(\"%5d link queued\", \"%5d links queued\", queue) % queue\n        self.write(\"%s, \" % msg)\n        msg = _n(\"%4d link\", \"%4d links\", checked) % checked\n        self.write(\"%s\" % msg)\n        msg = _n(\"%3d URL\", \"%3d URLs\", num_urls) % num_urls\n        self.write(\" in %s checked, \" % msg)\n        msg = _(\"runtime %s\") % strformat.strduration_long(duration)\n        self.writeln(msg)\n        self.flush()\n\n    def write(self, msg):\n        \"\"\"Write message to file descriptor.\"\"\"\n        self.fd.write(msg)\n\n    def writeln(self, msg):\n        \"\"\"Write status message and line break to file descriptor.\"\"\"\n        self.fd.write(f\"{msg}{os.linesep}\")\n\n    def flush(self):\n        \"\"\"Flush file descriptor.\"\"\"\n        self.fd.flush()",
      "hash_value": "db308672405610db501a9b076f603ac4",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "class StatusLogger:\n    \"\"\"Standard status logger. Default output is stderr.\"\"\"\n\n    def __init__(self, fd=stderr):\n        \"\"\"Save file descriptor for logging.\"\"\"\n        self.fd = fd\n\n    def log_status(self, checked, in_progress, queue, duration, num_urls):\n        \"\"\"Write status message to file descriptor.\"\"\"\n        msg = _n(\"%2d thread active\", \"%2d threads active\", in_progress) % in_progress\n        self.write(\"%s, \" % msg)\n        msg = _n(\"%5d link queued\", \"%5d links queued\", queue) % queue\n        self.write(\"%s, \" % msg)\n        msg = _n(\"%4d link\", \"%4d links\", checked) % checked\n        self.write(\"%s\" % msg)\n        msg = _n(\"%3d URL\", \"%3d URLs\", num_urls) % num_urls\n        self.write(\" in %s checked, \" % msg)\n        msg = _(\"runtime %s\") % strformat.strduration_long(duration)\n        self.writeln(msg)\n        self.flush()\n\n    def write(self, msg):\n        \"\"\"Write message to file descriptor.\"\"\"\n        self.fd.write(msg)\n\n    def writeln(self, msg):\n        \"\"\"Write status message and line break to file descriptor.\"\"\"\n        self.fd.write(f\"{msg}{os.linesep}\")\n\n    def flush(self):\n        \"\"\"Flush file descriptor.\"\"\"\n        self.fd.flush()",
          "triple_sequences": [
            {
              "action_api": "self.fd.write()",
              "action_description": "Writes file content",
              "action_id": "basic_write_operations",
              "object": "msg",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "self.fd.write()",
              "action_description": "Writes file content",
              "action_id": "basic_write_operations",
              "object": "f\"{msg}{os.linesep}\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "self.fd.flush()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close file",
              "intention_id": "close_file"
            }
          ]
        }
      ]
    }
  ]
}