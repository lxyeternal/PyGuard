{
  "metadata": {
    "package_name": "pydoop-2",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/pydoop-2.0.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "common_hdfs_tests.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pydoop-2.0.0/pydoop-2.0.0/test/hdfs/common_hdfs_tests.py",
      "line_number": "68",
      "type_description": "B815:write",
      "context_snippet": "def _make_random_file(self, where=None, content=None, **kwargs):\n    kwargs[\"mode\"] = \"w\"\n    content = content or utils.make_random_data(printable=True)\n    path = self._make_random_path(where=where)\n    with self.fs.open_file(path, **kwargs) as fo:\n        i = 0\n        bytes_written = 0\n        bufsize = 24 * 1024 * 1024\n        while i < len(content):\n            bytes_written += fo.write(content[i: i + bufsize])\n            i += bufsize\n\n    self.assertEqual(bytes_written, len(content))\n    return path",
      "hash_value": "6b1fa2397a3462b805e60a29c1ee27ee",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def _make_random_file(self, where=None, content=None, **kwargs):\n    kwargs[\"mode\"] = \"w\"\n    content = content or utils.make_random_data(printable=True)\n    path = self._make_random_path(where=where)\n    with self.fs.open_file(path, **kwargs) as fo:\n        i = 0\n        bytes_written = 0\n        bufsize = 24 * 1024 * 1024\n        while i < len(content):\n            bytes_written += fo.write(content[i: i + bufsize])\n            i += bufsize\n\n    self.assertEqual(bytes_written, len(content))\n    return path",
          "triple_sequences": [
            {
              "action_api": "utils.make_random_data()",
              "action_description": "Generate random number",
              "action_id": "generate_random_number",
              "object": "printable=True",
              "object_description": "Random string",
              "object_id": "random_string",
              "intention_description": "Generate random number",
              "intention_id": "generate_random_number"
            },
            {
              "action_api": "self._make_random_path()",
              "action_description": "Generate random integer",
              "action_id": "generate_random_integer",
              "object": "where=where",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Create random file name",
              "intention_id": "create_random_filename"
            },
            {
              "action_api": "self.fs.open_file()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "path, mode='w'",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "fo.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "content[i: i + bufsize]",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            }
          ]
        }
      ]
    }
  ]
}