{
  "metadata": {
    "package_name": "vosk-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/vosk-0.3.45-py3-none-win_amd64.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "__init__.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/vosk-0.3.45-py3-none-win_amd64/vosk/__init__.py",
      "line_number": "115",
      "type_description": "B819:urlretrieve",
      "context_snippet": "from urllib.request import urlretrieve\nfrom zipfile import ZipFile\nfrom tqdm import tqdm\nMODEL_PRE_URL = \"https://alphacephei.com/vosk/models/\"\nclass Model:\n    def download_model(self, model_name):\n        if not (model_name.parent).exists():\n            (model_name.parent).mkdir(parents=True)\n        with tqdm(unit=\"B\", unit_scale=True, unit_divisor=1024, miniters=1,\n                desc=(MODEL_PRE_URL + str(model_name.name) + \".zip\").rsplit(\"/\",\n                    maxsplit=1)[-1]) as t:\n            reporthook = self.download_progress_hook(t)\n            urlretrieve(MODEL_PRE_URL + str(model_name.name) + \".zip\",\n                    str(model_name) + \".zip\", reporthook=reporthook, data=None)\n            t.total = t.n\n            with ZipFile(str(model_name) + \".zip\", \"r\") as model_ref:\n                model_ref.extractall(model_name.parent)\n            Path(str(model_name) + \".zip\").unlink()\n    def download_progress_hook(self, t):\n        last_b = [0]\n        def update_to(b=1, bsize=1, tsize=None):\n            if tsize not in (None, -1):\n                t.total = tsize\n            displayed = t.update((b - last_b[0]) * bsize)\n            last_b[0] = b\n            return displayed\n        return update_to",
      "hash_value": "db53f06991cb0f5c6c12fe846cb764de",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "from urllib.request import urlretrieve\nfrom zipfile import ZipFile\nfrom tqdm import tqdm\nMODEL_PRE_URL = \"https://alphacephei.com/vosk/models/\"\nclass Model:\n    def download_model(self, model_name):\n        if not (model_name.parent).exists():\n            (model_name.parent).mkdir(parents=True)\n        with tqdm(unit=\"B\", unit_scale=True, unit_divisor=1024, miniters=1,\n                desc=(MODEL_PRE_URL + str(model_name.name) + \".zip\").rsplit(\"/\",\n                    maxsplit=1)[-1]) as t:\n            reporthook = self.download_progress_hook(t)\n            urlretrieve(MODEL_PRE_URL + str(model_name.name) + \".zip\",\n                    str(model_name) + \".zip\", reporthook=reporthook, data=None)\n            t.total = t.n\n            with ZipFile(str(model_name) + \".zip\", \"r\") as model_ref:\n                model_ref.extractall(model_name.parent)\n            Path(str(model_name) + \".zip\").unlink()\n    def download_progress_hook(self, t):\n        last_b = [0]\n        def update_to(b=1, bsize=1, tsize=None):\n            if tsize not in (None, -1):\n                t.total = tsize\n            displayed = t.update((b - last_b[0]) * bsize)\n            last_b[0] = b\n            return displayed\n        return update_to",
          "triple_sequences": [
            {
              "action_api": "Path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "model_name.parent",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "Path.mkdir()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "model_name.parent",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "urlretrieve()",
              "action_description": "Downloads file from URL to local path",
              "action_id": "download_file_url",
              "object": "MODEL_PRE_URL + str(model_name.name) + \".zip\", str(model_name) + \".zip\"",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "ZipFile()",
              "action_description": "Opens ZIP archive for reading",
              "action_id": "open_zip_read",
              "object": "str(model_name) + \".zip\"",
              "object_description": "ZIP archive file",
              "object_id": "zip_archive",
              "intention_description": "Open database for reading",
              "intention_id": "open_database_reading"
            },
            {
              "action_api": "ZipFile.extractall()",
              "action_description": "Extracts all files from ZIP archive to specified directory",
              "action_id": "extract_zip_files",
              "object": "model_name.parent",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Decompress downloaded archive",
              "intention_id": "decompress_downloaded_archive"
            },
            {
              "action_api": "Path.unlink()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "str(model_name) + \".zip\"",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            }
          ]
        }
      ]
    }
  ]
}