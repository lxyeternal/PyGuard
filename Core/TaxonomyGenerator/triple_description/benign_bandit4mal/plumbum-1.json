{
  "metadata": {
    "package_name": "plumbum-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/plumbum-1.9.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "daemons.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/plumbum-1.9.0/plumbum-1.9.0/plumbum/commands/daemons.py",
      "line_number": "121",
      "type_description": "B813:popen",
      "context_snippet": "def win32_daemonize(command, cwd, stdout=None, stderr=None, append=True):\n    if stdout is None:\n        stdout = os.devnull\n    if stderr is None:\n        stderr = stdout\n    DETACHED_PROCESS = 0x00000008\n    stdin = open(os.devnull, encoding=\"utf-8\")\n    stdout = open(stdout, \"a\" if append else \"w\", encoding=\"utf-8\")\n    stderr = open(stderr, \"a\" if append else \"w\", encoding=\"utf-8\")\n    return command.popen(\n        cwd=cwd,\n        stdin=stdin.fileno(),\n        stdout=stdout.fileno(),\n        stderr=stderr.fileno(),\n        creationflags=subprocess.CREATE_NEW_PROCESS_GROUP | DETACHED_PROCESS,\n    )",
      "hash_value": "c7107352ad7d916a37e8800951e442bb",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def win32_daemonize(command, cwd, stdout=None, stderr=None, append=True):\n    if stdout is None:\n        stdout = os.devnull\n    if stderr is None:\n        stderr = stdout\n    DETACHED_PROCESS = 0x00000008\n    stdin = open(os.devnull, encoding=\"utf-8\")\n    stdout = open(stdout, \"a\" if append else \"w\", encoding=\"utf-8\")\n    stderr = open(stderr, \"a\" if append else \"w\", encoding=\"utf-8\")\n    return command.popen(\n        cwd=cwd,\n        stdin=stdin.fileno(),\n        stdout=stdout.fileno(),\n        stderr=stderr.fileno(),\n        creationflags=subprocess.CREATE_NEW_PROCESS_GROUP | DETACHED_PROCESS,\n    )",
          "triple_sequences": [
            {
              "action_api": "open()",
              "action_description": "Opens null device for writing",
              "action_id": "open_null_device",
              "object": "os.devnull",
              "object_description": "System null device",
              "object_id": "system_null_device",
              "intention_description": "Redirect stdout to null device",
              "intention_id": "redirect_stdout_null"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "stdout",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "stderr",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "stdin.fileno()",
              "action_description": "Retrieves file descriptor for socket object",
              "action_id": "get_socket_fd",
              "object": "stdin",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Prepare file for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "stdout.fileno()",
              "action_description": "Retrieves file descriptor for socket object",
              "action_id": "get_socket_fd",
              "object": "stdout",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Prepare file for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "stderr.fileno()",
              "action_description": "Retrieves file descriptor for socket object",
              "action_id": "get_socket_fd",
              "object": "stderr",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Prepare file for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "command.popen()",
              "action_description": "Spawns new process to execute command without shell access",
              "action_id": "spawn_process_no_shell",
              "object": "command, cwd, stdin.fileno(), stdout.fileno(), stderr.fileno(), creationflags",
              "object_description": "Background process",
              "object_id": "background_process",
              "intention_description": "Create child process",
              "intention_id": "create_child_process"
            }
          ]
        }
      ]
    }
  ]
}