{
  "metadata": {
    "package_name": "ais_dom-2023",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/ais_dom-2023.11.0-py3-none-any.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "device_tracker.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/ais_dom-2023.11.0-py3-none-any/homeassistant/components/ddwrt/device_tracker.py",
      "line_number": "109",
      "type_description": "B820:get",
      "context_snippet": "    def get_device_name(self, device):\n        \"\"\"Return the name of the given device or None if we don't know.\"\"\"\n        # If not initialised and not already scanned and not found.\n        if device not in self.mac2name:\n            url = f\"{self.protocol}://{self.host}/Status_Lan.live.asp\"\n\n            if not (data := self.get_ddwrt_data(url)):\n                return None\n\n            if not (dhcp_leases := data.get(\"dhcp_leases\")):\n                return None\n\n            # Remove leading and trailing quotes and spaces\n            cleaned_str = dhcp_leases.replace('\"', \"\").replace(\"'\", \"\").replace(\" \", \"\")\n            elements = cleaned_str.split(\",\")\n            num_clients = int(len(elements) / 5)\n            self.mac2name = {}\n            for idx in range(0, num_clients):\n                # The data is a single array\n                # every 5 elements represents one host, the MAC\n                # is the third element and the name is the first.\n                mac_index = (idx * 5) + 2\n                if mac_index < len(elements):\n                    mac = elements[mac_index]\n                    self.mac2name[mac] = elements[idx * 5]\n\n        return self.mac2name.get(device)",
      "hash_value": "8feb16c9791d3e7d12286d6d97d52a69",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "    def get_device_name(self, device):\n        \"\"\"Return the name of the given device or None if we don't know.\"\"\"\n        # If not initialised and not already scanned and not found.\n        if device not in self.mac2name:\n            url = f\"{self.protocol}://{self.host}/Status_Lan.live.asp\"\n\n            if not (data := self.get_ddwrt_data(url)):\n                return None\n\n            if not (dhcp_leases := data.get(\"dhcp_leases\")):\n                return None\n\n            # Remove leading and trailing quotes and spaces\n            cleaned_str = dhcp_leases.replace('\"', \"\").replace(\"'\", \"\").replace(\" \", \"\")\n            elements = cleaned_str.split(\",\")\n            num_clients = int(len(elements) / 5)\n            self.mac2name = {}\n            for idx in range(0, num_clients):\n                # The data is a single array\n                # every 5 elements represents one host, the MAC\n                # is the third element and the name is the first.\n                mac_index = (idx * 5) + 2\n                if mac_index < len(elements):\n                    mac = elements[mac_index]\n                    self.mac2name[mac] = elements[idx * 5]\n\n        return self.mac2name.get(device)",
          "triple_sequences": [
            {
              "action_api": "self.get_ddwrt_data()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "f\"{self.protocol}://{self.host}/Status_Lan.live.asp\"",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "data.get()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "\"dhcp_leases\"",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "str.replace()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "dhcp_leases.replace('\"', '').replace(\"'\", '').replace(' ', '')",
              "object_description": "Cookie data string",
              "object_id": "cookie_data_string",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "str.split()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "cleaned_str.split(',')",
              "object_description": "Cookie data string",
              "object_id": "cookie_data_string",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "int()",
              "action_description": "Convert integer to bytes with specified length and byte order",
              "action_id": "convert_int_to_bytes",
              "object": "len(elements) / 5",
              "object_description": "Character code array",
              "object_id": "character_code_array",
              "intention_description": "Convert string to integer",
              "intention_id": "convert_string_to_integer"
            }
          ]
        }
      ]
    }
  ]
}