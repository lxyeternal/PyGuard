{
  "metadata": {
    "package_name": "oci-2",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/oci-2.150.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "kms_management_client.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/oci-2.150.0/oci-2.150.0/src/oci/key_management/kms_management_client.py",
      "line_number": "2313",
      "type_description": "B820:get",
      "context_snippet": "def restore_key_from_object_store(self, **kwargs):\n    \"\"\"\n    Restores the specified key to the specified vault from an Oracle Cloud Infrastructure\n    Object Storage location. If the vault doesn't exist, the operation returns a response with a\n    404 HTTP status error code. You need to first restore the vault associated with the key.\n\n\n    :param str if_match: (optional)\n        For optimistic concurrency control. In the PUT or DELETE call for a\n        resource, set the `if-match` parameter to the value of the etag from a\n        previous GET or POST response for that resource. The resource will be\n        updated or deleted only if the etag you provide matches the resource's\n        current etag value.\n\n    :param str opc_request_id: (optional)\n        Unique identifier for the request. If provided, the returned request ID\n        will include this value. Otherwise, a random request ID will be\n        generated by the service.\n\n    :param str opc_retry_token: (optional)\n        A token that uniquely identifies a request so it can be retried in case\n        of a timeout or server error without risk of executing that same action\n        again. Retry tokens expire after 24 hours, but can be invalidated\n        before then due to conflicting operations (e.g., if a resource has been\n        deleted and purged from the system, then a retry of the original\n        creation request may be rejected).\n\n    :param oci.key_management.models.RestoreKeyFromObjectStoreDetails restore_key_from_object_store_details: (optional)\n        Location to restore the backup from\n\n    :param obj retry_strategy: (optional)\n        A retry strategy to apply to this specific operation/call. This will override any retry strategy set at the client-level.\n\n        This should be one of the strategies available in the :py:mod:`~oci.retry` module. This operation will not retry by default, users can also use the convenient :py:data:`~oci.retry.DEFAULT_RETRY_STRATEGY` provided by the SDK to enable retries for it.\n        The specifics of the default retry strategy are described `here <https://docs.oracle.com/en-us/iaas/tools/python/latest/sdk_behaviors/retries.html>`__.\n\n        To have this operation explicitly not perform any retries, pass an instance of :py:class:`~oci.retry.NoneRetryStrategy`.\n\n    :param bool allow_control_chars: (optional)\n        allow_control_chars is a boolean to indicate whether or not this request should allow control characters in the response object.\n        By default, the response will not allow control characters in strings\n\n    :return: A :class:`~oci.response.Response` object with data of type :class:`~oci.key_management.models.Key`\n    :rtype: :class:`~oci.response.Response`\n\n    :example:\n    Click `here <https://docs.cloud.oracle.com/en-us/iaas/tools/python-sdk-examples/2.150.0/keymanagement/restore_key_from_object_store.py.html>`__ to see an example of how to use restore_key_from_object_store API.\n    \"\"\"\n    # Required path and query arguments. These are in camelCase to replace values in service endpoints.\n    required_arguments = []\n    resource_path = \"/20180608/keys/actions/restoreFromObjectStore\"\n    method = \"POST\"\n    operation_name = \"restore_key_from_object_store\"\n    api_reference_link = \"https://docs.oracle.com/iaas/api/#/en/key/release/Key/RestoreKeyFromObjectStore\"\n\n    # Don't accept unknown kwargs\n    expected_kwargs = [\n        \"allow_control_chars\",\n        \"retry_strategy\",\n        \"if_match\",\n        \"opc_request_id\",\n        \"opc_retry_token\",\n        \"restore_key_from_object_store_details\"\n    ]\n    extra_kwargs = [_key for _key in six.iterkeys(kwargs) if _key not in expected_kwargs]\n    if extra_kwargs:\n        raise ValueError(\n            f\"restore_key_from_object_store got unknown kwargs: {extra_kwargs!r}\")\n\n    header_params = {\n        \"accept\": \"application/json\",\n        \"content-type\": \"application/json\",\n        \"if-match\": kwargs.get(\"if_match\", missing),\n        \"opc-request-id\": kwargs.get(\"opc_request_id\", missing),\n        \"opc-retry-token\": kwargs.get(\"opc_retry_token\", missing)\n    }\n    header_params = {k: v for (k, v) in six.iteritems(header_params) if v is not missing and v is not None}\n\n    retry_strategy = self.base_client.get_preferred_retry_strategy(\n        operation_retry_strategy=kwargs.get('retry_strategy'),\n        client_retry_strategy=self.retry_strategy\n    )\n\n    if retry_strategy:\n        if not isinstance(retry_strategy, retry.NoneRetryStrategy):\n            self.base_client.add_opc_retry_token_if_needed(header_params)\n            self.base_client.add_opc_client_retries_header(header_params)\n            retry_strategy.add_circuit_breaker_callback(self.circuit_breaker_callback)\n        return retry_strategy.make_retrying_call(\n            self.base_client.call_api,\n            resource_path=resource_path,\n            method=method,\n            header_params=header_params,\n            body=kwargs.get('restore_key_from_object_store_details'),\n            response_type=\"Key\",\n            allow_control_chars=kwargs.get('allow_control_chars'),\n            operation_name=operation_name,\n            api_reference_link=api_reference_link,\n            required_arguments=required_arguments)\n    else:\n        return self.base_client.call_api(\n            resource_path=resource_path,\n            method=method,\n            header_params=header_params,\n            body=kwargs.get('restore_key_from_object_store_details'),\n            response_type=\"Key\",\n            allow_control_chars=kwargs.get('allow_control_chars'),\n            operation_name=operation_name,\n            api_reference_link=api_reference_link,\n            required_arguments=required_arguments)\n",
      "hash_value": "e6b68e1f47741df12c3e4e54671a8841",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def restore_key_from_object_store(self, **kwargs):\n    \"\"\"\n    Restores the specified key to the specified vault from an Oracle Cloud Infrastructure\n    Object Storage location. If the vault doesn't exist, the operation returns a response with a\n    404 HTTP status error code. You need to first restore the vault associated with the key.\n\n\n    :param str if_match: (optional)\n        For optimistic concurrency control. In the PUT or DELETE call for a\n        resource, set the `if-match` parameter to the value of the etag from a\n        previous GET or POST response for that resource. The resource will be\n        updated or deleted only if the etag you provide matches the resource's\n        current etag value.\n\n    :param str opc_request_id: (optional)\n        Unique identifier for the request. If provided, the returned request ID\n        will include this value. Otherwise, a random request ID will be\n        generated by the service.\n\n    :param str opc_retry_token: (optional)\n        A token that uniquely identifies a request so it can be retried in case\n        of a timeout or server error without risk of executing that same action\n        again. Retry tokens expire after 24 hours, but can be invalidated\n        before then due to conflicting operations (e.g., if a resource has been\n        deleted and purged from the system, then a retry of the original\n        creation request may be rejected).\n\n    :param oci.key_management.models.RestoreKeyFromObjectStoreDetails restore_key_from_object_store_details: (optional)\n        Location to restore the backup from\n\n    :param obj retry_strategy: (optional)\n        A retry strategy to apply to this specific operation/call. This will override any retry strategy set at the client-level.\n\n        This should be one of the strategies available in the :py:mod:`~oci.retry` module. This operation will not retry by default, users can also use the convenient :py:data:`~oci.retry.DEFAULT_RETRY_STRATEGY` provided by the SDK to enable retries for it.\n        The specifics of the default retry strategy are described `here <https://docs.oracle.com/en-us/iaas/tools/python/latest/sdk_behaviors/retries.html>`__.\n\n        To have this operation explicitly not perform any retries, pass an instance of :py:class:`~oci.retry.NoneRetryStrategy`.\n\n    :param bool allow_control_chars: (optional)\n        allow_control_chars is a boolean to indicate whether or not this request should allow control characters in the response object.\n        By default, the response will not allow control characters in strings\n\n    :return: A :class:`~oci.response.Response` object with data of type :class:`~oci.key_management.models.Key`\n    :rtype: :class:`~oci.response.Response`\n\n    :example:\n    Click `here <https://docs.cloud.oracle.com/en-us/iaas/tools/python-sdk-examples/2.150.0/keymanagement/restore_key_from_object_store.py.html>`__ to see an example of how to use restore_key_from_object_store API.\n    \"\"\"\n    # Required path and query arguments. These are in camelCase to replace values in service endpoints.\n    required_arguments = []\n    resource_path = \"/20180608/keys/actions/restoreFromObjectStore\"\n    method = \"POST\"\n    operation_name = \"restore_key_from_object_store\"\n    api_reference_link = \"https://docs.oracle.com/iaas/api/#/en/key/release/Key/RestoreKeyFromObjectStore\"\n\n    # Don't accept unknown kwargs\n    expected_kwargs = [\n        \"allow_control_chars\",\n        \"retry_strategy\",\n        \"if_match\",\n        \"opc_request_id\",\n        \"opc_retry_token\",\n        \"restore_key_from_object_store_details\"\n    ]\n    extra_kwargs = [_key for _key in six.iterkeys(kwargs) if _key not in expected_kwargs]\n    if extra_kwargs:\n        raise ValueError(\n            f\"restore_key_from_object_store got unknown kwargs: {extra_kwargs!r}\")\n\n    header_params = {\n        \"accept\": \"application/json\",\n        \"content-type\": \"application/json\",\n        \"if-match\": kwargs.get(\"if_match\", missing),\n        \"opc-request-id\": kwargs.get(\"opc_request_id\", missing),\n        \"opc-retry-token\": kwargs.get(\"opc_retry_token\", missing)\n    }\n    header_params = {k: v for (k, v) in six.iteritems(header_params) if v is not missing and v is not None}\n\n    retry_strategy = self.base_client.get_preferred_retry_strategy(\n        operation_retry_strategy=kwargs.get('retry_strategy'),\n        client_retry_strategy=self.retry_strategy\n    )\n\n    if retry_strategy:\n        if not isinstance(retry_strategy, retry.NoneRetryStrategy):\n            self.base_client.add_opc_retry_token_if_needed(header_params)\n            self.base_client.add_opc_client_retries_header(header_params)\n            retry_strategy.add_circuit_breaker_callback(self.circuit_breaker_callback)\n        return retry_strategy.make_retrying_call(\n            self.base_client.call_api,\n            resource_path=resource_path,\n            method=method,\n            header_params=header_params,\n            body=kwargs.get('restore_key_from_object_store_details'),\n            response_type=\"Key\",\n            allow_control_chars=kwargs.get('allow_control_chars'),\n            operation_name=operation_name,\n            api_reference_link=api_reference_link,\n            required_arguments=required_arguments)\n    else:\n        return self.base_client.call_api(\n            resource_path=resource_path,\n            method=method,\n            header_params=header_params,\n            body=kwargs.get('restore_key_from_object_store_details'),\n            response_type=\"Key\",\n            allow_control_chars=kwargs.get('allow_control_chars'),\n            operation_name=operation_name,\n            api_reference_link=api_reference_link,\n            required_arguments=required_arguments)\n",
          "triple_sequences": [
            {
              "action_api": "six.iterkeys()",
              "action_description": "Lists all currently alive threads",
              "action_id": "list_threads",
              "object": "kwargs",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "six.iteritems()",
              "action_description": "Lists all currently alive threads",
              "action_id": "list_threads",
              "object": "header_params",
              "object_description": "HTTP request/response headers",
              "object_id": "http_headers",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "self.base_client.get_preferred_retry_strategy()",
              "action_description": "Creates HTTP session for making asynchronous requests",
              "action_id": "create_http_session",
              "object": "operation_retry_strategy=kwargs.get('retry_strategy'), client_retry_strategy=self.retry_strategy",
              "object_description": "Retry attempt count",
              "object_id": "retry_count",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "self.base_client.add_opc_retry_token_if_needed()",
              "action_description": "Adds HTTP header to request object",
              "action_id": "add_http_header",
              "object": "header_params",
              "object_description": "HTTP request/response headers",
              "object_id": "http_headers",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "self.base_client.add_opc_client_retries_header()",
              "action_description": "Adds HTTP header to request object",
              "action_id": "add_http_header",
              "object": "header_params",
              "object_description": "HTTP request/response headers",
              "object_id": "http_headers",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "retry_strategy.add_circuit_breaker_callback()",
              "action_description": "Creates HTTP session for making asynchronous requests",
              "action_id": "create_http_session",
              "object": "self.circuit_breaker_callback",
              "object_description": "Function and arguments",
              "object_id": "function_with_arguments",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "retry_strategy.make_retrying_call()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "self.base_client.call_api, resource_path=resource_path, method=method, header_params=header_params, body=kwargs.get('restore_key_from_object_store_details'), response_type=\"Key\", allow_control_chars=kwargs.get('allow_control_chars'), operation_name=operation_name, api_reference_link=api_reference_link, required_arguments=required_arguments",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "self.base_client.call_api()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "resource_path=resource_path, method=method, header_params=header_params, body=kwargs.get('restore_key_from_object_store_details'), response_type=\"Key\", allow_control_chars=kwargs.get('allow_control_chars'), operation_name=operation_name, api_reference_link=api_reference_link, required_arguments=required_arguments",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            }
          ]
        }
      ]
    }
  ]
}