{
  "metadata": {
    "package_name": "datumaro-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/datumaro-1.10.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "base.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/datumaro-1.10.0/datumaro-1.10.0/src/datumaro/plugins/data_formats/datumaro_binary/base.py",
      "line_number": "122",
      "type_description": "B814:read",
      "context_snippet": "def _read_items(self) -> None:\n    (n_blob_sizes_bytes,) = struct.unpack(\"<I\", self._fp.read(4))\n    blob_sizes_bytes = self._crypter.decrypt(self._fp.read(n_blob_sizes_bytes))\n    blob_sizes, _ = IntListMapper.backward(blob_sizes_bytes, 0)\n\n    media_path_prefix = {\n        MediaType.IMAGE: osp.join(self._images_dir, self._subset),\n        MediaType.POINT_CLOUD: osp.join(self._pcd_dir, self._subset),\n        MediaType.VIDEO: osp.join(self._video_dir, self._subset),\n        MediaType.VIDEO_FRAME: osp.join(self._video_dir, self._subset),\n    }\n\n    if self._num_workers > 0:\n        self._items = self._read_items_mp(blob_sizes, media_path_prefix)\n    else:\n        self._items = self._read_items_sp(blob_sizes, media_path_prefix)\n\n    for item in self._items:\n        if item.media is not None and self._media_encryption:\n            item.media.set_crypter(self._crypter)\n\n        for ann in item.annotations:\n            self._ann_types.add(ann.type)",
      "hash_value": "62d6ec1572cc255b634fdae9464ef2e3",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def _read_items(self) -> None:\n    (n_blob_sizes_bytes,) = struct.unpack(\"<I\", self._fp.read(4))\n    blob_sizes_bytes = self._crypter.decrypt(self._fp.read(n_blob_sizes_bytes))\n    blob_sizes, _ = IntListMapper.backward(blob_sizes_bytes, 0)\n\n    media_path_prefix = {\n        MediaType.IMAGE: osp.join(self._images_dir, self._subset),\n        MediaType.POINT_CLOUD: osp.join(self._pcd_dir, self._subset),\n        MediaType.VIDEO: osp.join(self._video_dir, self._subset),\n        MediaType.VIDEO_FRAME: osp.join(self._video_dir, self._subset),\n    }\n\n    if self._num_workers > 0:\n        self._items = self._read_items_mp(blob_sizes, media_path_prefix)\n    else:\n        self._items = self._read_items_sp(blob_sizes, media_path_prefix)\n\n    for item in self._items:\n        if item.media is not None and self._media_encryption:\n            item.media.set_crypter(self._crypter)\n\n        for ann in item.annotations:\n            self._ann_types.add(ann.type)",
          "triple_sequences": [
            {
              "action_api": "self._fp.read()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "4",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "struct.unpack()",
              "action_description": "Packs values into bytes using specified format",
              "action_id": "pack_values",
              "object": "\"<I\", self._fp.read(4)",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "self._fp.read()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "n_blob_sizes_bytes",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "self._crypter.decrypt()",
              "action_description": "Decrypts data using initialized AES cipher",
              "action_id": "decrypt_aes_data",
              "object": "self._fp.read(n_blob_sizes_bytes)",
              "object_description": "Encrypted data",
              "object_id": "encrypted_data",
              "intention_description": "Decrypt encrypted data",
              "intention_id": "decrypt_encrypted_data"
            },
            {
              "action_api": "IntListMapper.backward()",
              "action_description": "Deserializes Python object from bytes",
              "action_id": "deserialize_from_bytes",
              "object": "blob_sizes_bytes, 0",
              "object_description": "Decompressed data",
              "object_id": "decompressed_data",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "osp.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "self._images_dir, self._subset",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Prepare directory path",
              "intention_id": "prepare_directory_path"
            },
            {
              "action_api": "osp.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "self._pcd_dir, self._subset",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Prepare directory path",
              "intention_id": "prepare_directory_path"
            },
            {
              "action_api": "osp.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "self._video_dir, self._subset",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Prepare directory path",
              "intention_id": "prepare_directory_path"
            },
            {
              "action_api": "self._read_items_mp()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "blob_sizes, media_path_prefix",
              "object_description": "Thread target and arguments",
              "object_id": "thread_target_arguments",
              "intention_description": "Run function in thread pool",
              "intention_id": "run_function_thread_pool"
            },
            {
              "action_api": "self._read_items_sp()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "blob_sizes, media_path_prefix",
              "object_description": "Thread target and arguments",
              "object_id": "thread_target_arguments",
              "intention_description": "Run function in thread pool",
              "intention_id": "run_function_thread_pool"
            },
            {
              "action_api": "item.media.set_crypter()",
              "action_description": "Initializes symmetric encryption with provided key",
              "action_id": "init_symmetric_encryption",
              "object": "self._crypter",
              "object_description": "Encryption key",
              "object_id": "encryption_key",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "self._ann_types.add()",
              "action_description": "Adds field to Discord embed",
              "action_id": "add_discord_embed_field",
              "object": "ann.type",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            }
          ]
        }
      ]
    }
  ]
}