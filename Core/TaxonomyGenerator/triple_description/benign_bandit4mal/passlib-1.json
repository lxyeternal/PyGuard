{
  "metadata": {
    "package_name": "passlib-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/passlib-1.7.4.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "ldap_digests.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/passlib-1.7.4/passlib-1.7.4/passlib/handlers/ldap_digests.py",
      "line_number": "59",
      "type_description": "B802:b64encode",
      "context_snippet": "class _Base64DigestHelper(uh.StaticHandler):\n    \"\"\"helper for ldap_md5 / ldap_sha1\"\"\"\n    # XXX: could combine this with hex digests in digests.py\n\n    ident = None # required - prefix identifier\n    _hash_func = None # required - hash function\n    _hash_regex = None # required - regexp to recognize hash\n    checksum_chars = uh.PADDED_BASE64_CHARS\n\n    @classproperty\n    def _hash_prefix(cls):\n        \"\"\"tell StaticHandler to strip ident from checksum\"\"\"\n        return cls.ident\n\n    def _calc_checksum(self, secret):\n        if isinstance(secret, unicode):\n            secret = secret.encode(\"utf-8\")\n        chk = self._hash_func(secret).digest()\n        return b64encode(chk).decode(\"ascii\")",
      "hash_value": "9d7a61fce86db35b8a6e76a98e1ce62a",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "class _Base64DigestHelper(uh.StaticHandler):\n    \"\"\"helper for ldap_md5 / ldap_sha1\"\"\"\n    # XXX: could combine this with hex digests in digests.py\n\n    ident = None # required - prefix identifier\n    _hash_func = None # required - hash function\n    _hash_regex = None # required - regexp to recognize hash\n    checksum_chars = uh.PADDED_BASE64_CHARS\n\n    @classproperty\n    def _hash_prefix(cls):\n        \"\"\"tell StaticHandler to strip ident from checksum\"\"\"\n        return cls.ident\n\n    def _calc_checksum(self, secret):\n        if isinstance(secret, unicode):\n            secret = secret.encode(\"utf-8\")\n        chk = self._hash_func(secret).digest()\n        return b64encode(chk).decode(\"ascii\")",
          "triple_sequences": [
            {
              "action_api": "isinstance()",
              "action_description": "Checks if object is instance of specified type",
              "action_id": "check_instance_type",
              "object": "secret, unicode",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare character for further processing",
              "intention_id": "prepare_character_processing"
            },
            {
              "action_api": "str.encode()",
              "action_description": "Encodes string to bytes using default encoding",
              "action_id": "encode_string_to_bytes",
              "object": "\"utf-8\"",
              "object_description": "Character encoding type",
              "object_id": "character_encoding_type",
              "intention_description": "Encode string to bytes",
              "intention_id": "encode_string_to_bytes"
            },
            {
              "action_api": "self._hash_func()",
              "action_description": "Creates SHA-1 hash object",
              "action_id": "create_sha1_hash",
              "object": "secret",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "hashlib_hash_object.digest()",
              "action_description": "Returns hexadecimal digest of SHA-1 hash",
              "action_id": "get_sha1_digest",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "b64encode()",
              "action_description": "Encodes bytes to base64-encoded bytes",
              "action_id": "encode_bytes_to_base64",
              "object": "chk",
              "object_description": "Encoded string to bytes",
              "object_id": "encoded_string_bytes",
              "intention_description": "Prepare data for base64 encoding",
              "intention_id": "prepare_data_base64_encoding"
            },
            {
              "action_api": "bytes.decode()",
              "action_description": "Decodes bytes using specified codec",
              "action_id": "decode_bytes_codec",
              "object": "\"ascii\"",
              "object_description": "Character encoding type",
              "object_id": "character_encoding_type",
              "intention_description": "Decode bytes to string",
              "intention_id": "decode_bytes_to_string"
            }
          ]
        }
      ]
    }
  ]
}