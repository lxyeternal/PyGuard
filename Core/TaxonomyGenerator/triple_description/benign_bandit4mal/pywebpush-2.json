{
  "metadata": {
    "package_name": "pywebpush-2",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/pywebpush-2.0.3.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "test_webpush.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pywebpush-2.0.3/pywebpush-2.0.3/pywebpush/tests/test_webpush.py",
      "line_number": "384",
      "type_description": "B820:get",
      "context_snippet": "@patch(\"aiohttp.ClientSession.post\", new_callable=AsyncMock)\nasync def test_send_empty(self, mock_post):\n    subscription_info = self._gen_subscription_info()\n    headers = {\"Crypto-Key\": \"pre-existing\", \"Authentication\": \"bear vapid\"}\n    await WebPusher(subscription_info).send_async(\"\", headers)\n    assert subscription_info.get(\"endpoint\") == mock_post.call_args[0][0]\n    pheaders = mock_post.call_args[1].get(\"headers\")\n    assert pheaders.get(\"ttl\") == \"0\"\n    assert \"encryption\" not in pheaders\n    assert pheaders.get(\"AUTHENTICATION\") == headers.get(\"Authentication\")\n    ckey = pheaders.get(\"crypto-key\")\n    assert \"pre-existing\" in ckey\n",
      "hash_value": "391eef1b7644f2d3ceaf8ad77e19a258",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "@patch(\"aiohttp.ClientSession.post\", new_callable=AsyncMock)\nasync def test_send_empty(self, mock_post):\n    subscription_info = self._gen_subscription_info()\n    headers = {\"Crypto-Key\": \"pre-existing\", \"Authentication\": \"bear vapid\"}\n    await WebPusher(subscription_info).send_async(\"\", headers)\n    assert subscription_info.get(\"endpoint\") == mock_post.call_args[0][0]\n    pheaders = mock_post.call_args[1].get(\"headers\")\n    assert pheaders.get(\"ttl\") == \"0\"\n    assert \"encryption\" not in pheaders\n    assert pheaders.get(\"AUTHENTICATION\") == headers.get(\"Authentication\")\n    ckey = pheaders.get(\"crypto-key\")\n    assert \"pre-existing\" in ckey\n",
          "triple_sequences": [
            {
              "action_api": "WebPusher(subscription_info).send_async()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "\"\", headers",
              "object_description": "HTTP request/response headers",
              "object_id": "http_headers",
              "intention_description": "Transmit encoded data via HTTP POST",
              "intention_id": "transmit_data_http_post"
            },
            {
              "action_api": "subscription_info.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"endpoint\"",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "mock_post.call_args[0][0]",
              "action_description": "Retrieves command-line arguments passed to script",
              "action_id": "get_cmd_args",
              "object": "mock_post.call_args[0][0]",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "mock_post.call_args[1].get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"headers\"",
              "object_description": "HTTP request/response headers",
              "object_id": "http_headers",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "pheaders.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"ttl\"",
              "object_description": "Timeout duration value",
              "object_id": "timeout_value",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "pheaders.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"AUTHENTICATION\"",
              "object_description": "Authorization header value",
              "object_id": "authorization_header",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "headers.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"Authentication\"",
              "object_description": "Authorization header value",
              "object_id": "authorization_header",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "pheaders.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"crypto-key\"",
              "object_description": "API key or token",
              "object_id": "api_key",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            }
          ]
        }
      ]
    }
  ]
}