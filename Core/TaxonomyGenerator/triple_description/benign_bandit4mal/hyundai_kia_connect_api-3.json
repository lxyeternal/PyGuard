{
  "metadata": {
    "package_name": "hyundai_kia_connect_api-3",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/hyundai_kia_connect_api-3.35.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "KiaUvoApiCN.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/hyundai_kia_connect_api-3.35.0/hyundai_kia_connect_api-3.35.0/hyundai_kia_connect_api/KiaUvoApiCN.py",
      "line_number": "928",
      "type_description": "B821:post",
      "context_snippet": "def _get_driving_info(self, token: Token, vehicle: Vehicle) -> dict:\n    url = self.SPA_API_URL + \"vehicles/\" + vehicle.id + \"/drvhistory\"\n\n    responseAlltime = requests.post(\n        url,\n        json={\"periodTarget\": 1},\n        headers=self._get_authenticated_headers(token),\n    )\n    responseAlltime = responseAlltime.json()\n    _LOGGER.debug(f\"{DOMAIN} - get_driving_info responseAlltime {responseAlltime}\")\n    _check_response_for_errors(responseAlltime)\n\n    response30d = requests.post(\n        url,\n        json={\"periodTarget\": 0},\n        headers=self._get_authenticated_headers(token),\n    )\n    response30d = response30d.json()\n    _LOGGER.debug(f\"{DOMAIN} - get_driving_info response30d {response30d}\")\n    _check_response_for_errors(response30d)\n    if get_child_value(responseAlltime, \"resMsg.drivingInfoDetail.0\"):\n        drivingInfo = responseAlltime[\"resMsg\"][\"drivingInfoDetail\"][0]\n\n        drivingInfo[\"dailyStats\"] = []\n        for day in response30d[\"resMsg\"][\"drivingInfoDetail\"]:\n            processedDay = DailyDrivingStats(\n                date=dt.datetime.strptime(day[\"drivingDate\"], \"%Y%m%d\"),\n                total_consumed=day[\"totalPwrCsp\"],\n                engine_consumption=day[\"motorPwrCsp\"],\n                climate_consumption=day[\"climatePwrCsp\"],\n                onboard_electronics_consumption=day[\"eDPwrCsp\"],\n                battery_care_consumption=day[\"batteryMgPwrCsp\"],\n                regenerated_energy=day[\"regenPwr\"],\n                distance=day[\"calculativeOdo\"],\n                distance_unit=vehicle.odometer_unit,\n            )\n            drivingInfo[\"dailyStats\"].append(processedDay)\n\n        for drivingInfoItem in response30d[\"resMsg\"][\"drivingInfo\"]:\n            if drivingInfoItem[\"drivingPeriod\"] == 0:\n                drivingInfo[\"consumption30d\"] = round(\n                    drivingInfoItem[\"totalPwrCsp\"]\n                    / drivingInfoItem[\"calculativeOdo\"]\n                )\n                break\n\n        return drivingInfo\n    else:\n        _LOGGER.debug(\n            f\"{DOMAIN} - Driving info didn't return valid data. This may be normal if the car doesn't support it.\"\n        )\n        return None",
      "hash_value": "2f553799b03f6bf2a60ed5ba25a579fd",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def _get_driving_info(self, token: Token, vehicle: Vehicle) -> dict:\n    url = self.SPA_API_URL + \"vehicles/\" + vehicle.id + \"/drvhistory\"\n\n    responseAlltime = requests.post(\n        url,\n        json={\"periodTarget\": 1},\n        headers=self._get_authenticated_headers(token),\n    )\n    responseAlltime = responseAlltime.json()\n    _LOGGER.debug(f\"{DOMAIN} - get_driving_info responseAlltime {responseAlltime}\")\n    _check_response_for_errors(responseAlltime)\n\n    response30d = requests.post(\n        url,\n        json={\"periodTarget\": 0},\n        headers=self._get_authenticated_headers(token),\n    )\n    response30d = response30d.json()\n    _LOGGER.debug(f\"{DOMAIN} - get_driving_info response30d {response30d}\")\n    _check_response_for_errors(response30d)\n    if get_child_value(responseAlltime, \"resMsg.drivingInfoDetail.0\"):\n        drivingInfo = responseAlltime[\"resMsg\"][\"drivingInfoDetail\"][0]\n\n        drivingInfo[\"dailyStats\"] = []\n        for day in response30d[\"resMsg\"][\"drivingInfoDetail\"]:\n            processedDay = DailyDrivingStats(\n                date=dt.datetime.strptime(day[\"drivingDate\"], \"%Y%m%d\"),\n                total_consumed=day[\"totalPwrCsp\"],\n                engine_consumption=day[\"motorPwrCsp\"],\n                climate_consumption=day[\"climatePwrCsp\"],\n                onboard_electronics_consumption=day[\"eDPwrCsp\"],\n                battery_care_consumption=day[\"batteryMgPwrCsp\"],\n                regenerated_energy=day[\"regenPwr\"],\n                distance=day[\"calculativeOdo\"],\n                distance_unit=vehicle.odometer_unit,\n            )\n            drivingInfo[\"dailyStats\"].append(processedDay)\n\n        for drivingInfoItem in response30d[\"resMsg\"][\"drivingInfo\"]:\n            if drivingInfoItem[\"drivingPeriod\"] == 0:\n                drivingInfo[\"consumption30d\"] = round(\n                    drivingInfoItem[\"totalPwrCsp\"]\n                    / drivingInfoItem[\"calculativeOdo\"]\n                )\n                break\n\n        return drivingInfo\n    else:\n        _LOGGER.debug(\n            f\"{DOMAIN} - Driving info didn't return valid data. This may be normal if the car doesn't support it.\"\n        )\n        return None",
          "triple_sequences": [
            {
              "action_api": "requests.post()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "self.SPA_API_URL + \"vehicles/\" + vehicle.id + \"/drvhistory\", json={\"periodTarget\": 1}, headers=self._get_authenticated_headers(token)",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "responseAlltime.json()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "responseAlltime",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "_LOGGER.debug()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "f\"{DOMAIN} - get_driving_info responseAlltime {responseAlltime}\"",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Collect command output",
              "intention_id": "collect_command_output"
            },
            {
              "action_api": "_check_response_for_errors()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "responseAlltime",
              "object_description": "HTTP response remote content",
              "object_id": "http_response_remote_content",
              "intention_description": "Decode command output",
              "intention_id": "decode_command_output"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "self.SPA_API_URL + \"vehicles/\" + vehicle.id + \"/drvhistory\", json={\"periodTarget\": 0}, headers=self._get_authenticated_headers(token)",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "response30d.json()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "response30d",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "_LOGGER.debug()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "f\"{DOMAIN} - get_driving_info response30d {response30d}\"",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Collect command output",
              "intention_id": "collect_command_output"
            },
            {
              "action_api": "_check_response_for_errors()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "response30d",
              "object_description": "HTTP response remote content",
              "object_id": "http_response_remote_content",
              "intention_description": "Decode command output",
              "intention_id": "decode_command_output"
            },
            {
              "action_api": "get_child_value()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "responseAlltime, \"resMsg.drivingInfoDetail.0\"",
              "object_description": "Structured_file_data",
              "object_id": "structured_file_data",
              "intention_description": "Extract structured file data",
              "intention_id": "extract_structured_file_data"
            },
            {
              "action_api": "dt.datetime.strptime()",
              "action_description": "Parses string into datetime object",
              "action_id": "parse_datetime",
              "object": "day[\"drivingDate\"], \"%Y%m%d\"",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Prepare data processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "round()",
              "action_description": "Generate random number",
              "action_id": "generate_random_number",
              "object": "drivingInfoItem[\"totalPwrCsp\"] / drivingInfoItem[\"calculativeOdo\"]",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Prepare data processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "_LOGGER.debug()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "f\"{DOMAIN} - Driving info didn't return valid data. This may be normal if the car doesn't support it.\"",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Collect command output",
              "intention_id": "collect_command_output"
            }
          ]
        }
      ]
    }
  ]
}