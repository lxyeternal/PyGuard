{
  "metadata": {
    "package_name": "meltano-3",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/meltano-3.7.2.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "__init__.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/meltano-3.7.2/meltano-3.7.2/src/meltano/core/utils/__init__.py",
      "line_number": "873",
      "type_description": "B812:system",
      "context_snippet": "_sanitize_filename_transformations = (\n    # Normalize unicode data in the string:\n    lambda x: unicodedata.normalize(\"NFKD\", x),\n    # Limit the string to ASCII characters:\n    lambda x: x.encode(\"ascii\", \"ignore\").decode(\"ascii\"),\n    # Replace each path separator with a space:\n    lambda x: x.replace(os.path.sep, \" \"),\n    lambda x: x.replace(os.path.altsep, \" \") if os.path.altsep else x,\n    # Replace each whitespace character with an underscore:\n    lambda x: \"_\".join(x.split()),\n    # Limit the string to alphanumeric characters, underscores, hyphens, and dots:\n    lambda x: _filename_restriction_pattern.sub(\"\", x),\n    # Remove Remove illegal character combination `._` from front and back:\n    lambda x: x.strip(\"._\"),\n    # Add a leading `_` if necessary to avoid conflict with reserved Windows filenames:\n    lambda x: f\"_{x}\"\n    if platform.system() == \"Windows\"\n    and x\n    and x.split(\".\")[0].upper() in _reserved_windows_filenames\n    else x,\n)",
      "hash_value": "3d9ba490555e094731b5877a6e935ab1",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "_sanitize_filename_transformations = (\n    # Normalize unicode data in the string:\n    lambda x: unicodedata.normalize(\"NFKD\", x),\n    # Limit the string to ASCII characters:\n    lambda x: x.encode(\"ascii\", \"ignore\").decode(\"ascii\"),\n    # Replace each path separator with a space:\n    lambda x: x.replace(os.path.sep, \" \"),\n    lambda x: x.replace(os.path.altsep, \" \") if os.path.altsep else x,\n    # Replace each whitespace character with an underscore:\n    lambda x: \"_\".join(x.split()),\n    # Limit the string to alphanumeric characters, underscores, hyphens, and dots:\n    lambda x: _filename_restriction_pattern.sub(\"\", x),\n    # Remove Remove illegal character combination `._` from front and back:\n    lambda x: x.strip(\"._\"),\n    # Add a leading `_` if necessary to avoid conflict with reserved Windows filenames:\n    lambda x: f\"_{x}\"\n    if platform.system() == \"Windows\"\n    and x\n    and x.split(\".\")[0].upper() in _reserved_windows_filenames\n    else x,\n)",
          "triple_sequences": [
            {
              "action_api": "unicodedata.normalize()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "\"NFKD\", x",
              "object_description": "Character encoding type",
              "object_id": "character_encoding_type",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "str.encode()",
              "action_description": "Encodes string to bytes using default encoding",
              "action_id": "encode_string_to_bytes",
              "object": "\"ascii\", \"ignore\"",
              "object_description": "Character encoding type",
              "object_id": "character_encoding_type",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "bytes.decode()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "\"ascii\"",
              "object_description": "Character encoding type",
              "object_id": "character_encoding_type",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "str.replace()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "os.path.sep, \" \"",
              "object_description": "Directory separator",
              "object_id": "directory_separator",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "str.replace()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "os.path.altsep, \" \"",
              "object_description": "Directory separator",
              "object_id": "directory_separator",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "str.split()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "str.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "\"_\"",
              "object_description": "Space delimiter",
              "object_id": "space_delimiter",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "_filename_restriction_pattern.sub()",
              "action_description": "Compile regular expression pattern",
              "action_id": "compile_regex",
              "object": "\"\", x",
              "object_description": "Regex pattern",
              "object_id": "regex_pattern",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "str.strip()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "\"._\"",
              "object_description": "Character code array",
              "object_id": "character_code_array",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "platform.system()",
              "action_description": "Retrieves operating system identifier",
              "action_id": "get_os_id",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Determine operating system",
              "intention_id": "get_operating_system_name"
            }
          ]
        }
      ]
    }
  ]
}