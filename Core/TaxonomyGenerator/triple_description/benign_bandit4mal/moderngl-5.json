{
  "metadata": {
    "package_name": "moderngl-5",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/moderngl-5.12.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "_moderngl.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/moderngl-5.12.0/moderngl-5.12.0/_moderngl.py",
      "line_number": "214",
      "type_description": "B841:cdll",
      "context_snippet": "class DefaultLoader:\n    def __init__(self):\n        import ctypes\n        import sys\n\n        def funcptr(lib, name):\n            return ctypes.cast(getattr(lib, name, 0), ctypes.c_void_p).value or 0\n\n        if sys.platform.startswith(\"win\"):\n            lib = ctypes.WinDLL(\"opengl32.dll\")\n            proc = ctypes.cast(lib.wglGetProcAddress, ctypes.WINFUNCTYPE(ctypes.c_ulonglong, ctypes.c_char_p))\n            if not lib.wglGetCurrentContext():\n                raise RuntimeError(\"Cannot detect window with OpenGL support\")\n\n            def loader(name):\n                return proc(name.encode()) or funcptr(lib, name)\n\n        elif sys.platform.startswith(\"linux\"):\n            try:\n                lib = ctypes.CDLL(\"libEGL.so\")\n                proc = ctypes.cast(lib.eglGetProcAddress, ctypes.CFUNCTYPE(ctypes.c_ulonglong, ctypes.c_char_p))\n                if not lib.eglGetCurrentContext():\n                    raise RuntimeError(\"Cannot detect window with OpenGL support\")\n\n                def loader(name):\n                    return proc(name.encode())\n\n            except:\n                lib = ctypes.CDLL(\"libGL.so\")\n                proc = ctypes.cast(lib.glXGetProcAddress, ctypes.CFUNCTYPE(ctypes.c_ulonglong, ctypes.c_char_p))\n                if not lib.glXGetCurrentContext():\n                    raise RuntimeError(\"Cannot detect window with OpenGL support\")\n\n                def loader(name):\n                    return proc(name.encode()) or funcptr(lib, name)\n\n        elif sys.platform.startswith(\"darwin\"):\n            lib = ctypes.CDLL(\"/System/Library/Frameworks/OpenGL.framework/OpenGL\")\n\n            def loader(name):\n                return funcptr(lib, name)\n\n        elif sys.platform.startswith(\"emscripten\"):\n            lib = ctypes.CDLL(None)\n\n            def loader(name):\n                return funcptr(lib, name)\n\n        elif sys.platform.startswith(\"wasi\"):\n            lib = ctypes.CDLL(None)\n\n            def loader(name):\n                return funcptr(lib, name)\n\n        self.load_opengl_function = loader\n\n    def __enter__(self):\n        pass\n\n    def __exit__(self, *args):\n        pass\n\n    def release(self):\n        pass",
      "hash_value": "d9a933bc77435f9ec7fb2960367400c4",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "class DefaultLoader:\n    def __init__(self):\n        import ctypes\n        import sys\n\n        def funcptr(lib, name):\n            return ctypes.cast(getattr(lib, name, 0), ctypes.c_void_p).value or 0\n\n        if sys.platform.startswith(\"win\"):\n            lib = ctypes.WinDLL(\"opengl32.dll\")\n            proc = ctypes.cast(lib.wglGetProcAddress, ctypes.WINFUNCTYPE(ctypes.c_ulonglong, ctypes.c_char_p))\n            if not lib.wglGetCurrentContext():\n                raise RuntimeError(\"Cannot detect window with OpenGL support\")\n\n            def loader(name):\n                return proc(name.encode()) or funcptr(lib, name)\n\n        elif sys.platform.startswith(\"linux\"):\n            try:\n                lib = ctypes.CDLL(\"libEGL.so\")\n                proc = ctypes.cast(lib.eglGetProcAddress, ctypes.CFUNCTYPE(ctypes.c_ulonglong, ctypes.c_char_p))\n                if not lib.eglGetCurrentContext():\n                    raise RuntimeError(\"Cannot detect window with OpenGL support\")\n\n                def loader(name):\n                    return proc(name.encode())\n\n            except:\n                lib = ctypes.CDLL(\"libGL.so\")\n                proc = ctypes.cast(lib.glXGetProcAddress, ctypes.CFUNCTYPE(ctypes.c_ulonglong, ctypes.c_char_p))\n                if not lib.glXGetCurrentContext():\n                    raise RuntimeError(\"Cannot detect window with OpenGL support\")\n\n                def loader(name):\n                    return proc(name.encode()) or funcptr(lib, name)\n\n        elif sys.platform.startswith(\"darwin\"):\n            lib = ctypes.CDLL(\"/System/Library/Frameworks/OpenGL.framework/OpenGL\")\n\n            def loader(name):\n                return funcptr(lib, name)\n\n        elif sys.platform.startswith(\"emscripten\"):\n            lib = ctypes.CDLL(None)\n\n            def loader(name):\n                return funcptr(lib, name)\n\n        elif sys.platform.startswith(\"wasi\"):\n            lib = ctypes.CDLL(None)\n\n            def loader(name):\n                return funcptr(lib, name)\n\n        self.load_opengl_function = loader\n\n    def __enter__(self):\n        pass\n\n    def __exit__(self, *args):\n        pass\n\n    def release(self):\n        pass",
          "triple_sequences": [
            {
              "action_api": "ctypes.WinDLL()",
              "action_description": "Instantiates WMI interface for system management",
              "action_id": "instantiate_wmi",
              "object": "\"opengl32.dll\"",
              "object_description": "Dynamic library name",
              "object_id": "library_name",
              "intention_description": "Import required module",
              "intention_id": "import_required_module"
            },
            {
              "action_api": "ctypes.CDLL()",
              "action_description": "Instantiates WMI interface for system management",
              "action_id": "instantiate_wmi",
              "object": "\"libEGL.so\"",
              "object_description": "Dynamic library name",
              "object_id": "library_name",
              "intention_description": "Import required module",
              "intention_id": "import_required_module"
            },
            {
              "action_api": "ctypes.CDLL()",
              "action_description": "Instantiates WMI interface for system management",
              "action_id": "instantiate_wmi",
              "object": "\"libGL.so\"",
              "object_description": "Dynamic library name",
              "object_id": "library_name",
              "intention_description": "Import required module",
              "intention_id": "import_required_module"
            },
            {
              "action_api": "ctypes.CDLL()",
              "action_description": "Instantiates WMI interface for system management",
              "action_id": "instantiate_wmi",
              "object": "\"/System/Library/Frameworks/OpenGL.framework/OpenGL\"",
              "object_description": "Dynamic library name",
              "object_id": "library_name",
              "intention_description": "Import required module",
              "intention_id": "import_required_module"
            },
            {
              "action_api": "ctypes.CDLL()",
              "action_description": "Instantiates WMI interface for system management",
              "action_id": "instantiate_wmi",
              "object": "None",
              "object_description": "Dynamic library name",
              "object_id": "library_name",
              "intention_description": "Import required module",
              "intention_id": "import_required_module"
            },
            {
              "action_api": "getattr()",
              "action_description": "Checks if object is instance of specified type",
              "action_id": "check_instance_type",
              "object": "lib, name, 0",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "ctypes.cast()",
              "action_description": "Checks if object is instance of specified type",
              "action_id": "check_instance_type",
              "object": "lib.wglGetProcAddress, ctypes.WINFUNCTYPE(ctypes.c_ulonglong, ctypes.c_char_p)",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "ctypes.cast()",
              "action_description": "Checks if object is instance of specified type",
              "action_id": "check_instance_type",
              "object": "lib.eglGetProcAddress, ctypes.CFUNCTYPE(ctypes.c_ulonglong, ctypes.c_char_p)",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "ctypes.cast()",
              "action_description": "Checks if object is instance of specified type",
              "action_id": "check_instance_type",
              "object": "lib.glXGetProcAddress, ctypes.CFUNCTYPE(ctypes.c_ulonglong, ctypes.c_char_p)",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "lib.wglGetCurrentContext()",
              "action_description": "Checks if window handle is valid",
              "action_id": "check_window_handle",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Detect image file",
              "intention_id": "detect_image_file"
            },
            {
              "action_api": "lib.eglGetCurrentContext()",
              "action_description": "Checks if window handle is valid",
              "action_id": "check_window_handle",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Detect image file",
              "intention_id": "detect_image_file"
            },
            {
              "action_api": "lib.glXGetCurrentContext()",
              "action_description": "Checks if window handle is valid",
              "action_id": "check_window_handle",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Detect image file",
              "intention_id": "detect_image_file"
            },
            {
              "action_api": "name.encode()",
              "action_description": "Encodes string to bytes using default encoding",
              "action_id": "encode_string_to_bytes",
              "object": "name",
              "object_description": "Encoded string to bytes",
              "object_id": "encoded_string_bytes",
              "intention_description": "Encode string to bytes",
              "intention_id": "encode_string_to_bytes"
            }
          ]
        }
      ]
    }
  ]
}