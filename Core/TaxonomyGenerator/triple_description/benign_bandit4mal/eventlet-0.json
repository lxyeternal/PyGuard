{
  "metadata": {
    "package_name": "eventlet-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/eventlet-0.39.1.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "wsgi_test.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/eventlet-0.39.1/eventlet-0.39.1/tests/wsgi_test.py",
      "line_number": "1581",
      "type_description": "B804:connect",
      "context_snippet": "def test_007_get_arg(self):\n    # define a new handler that does a get_arg as well as a read_body\n    def new_app(env, start_response):\n        body = bytes_to_str(env['wsgi.input'].read())\n        a = parse.parse_qs(body).get('a', [1])[0]\n        start_response('200 OK', [('Content-type', 'text/plain')])\n        return [('a is %s, body is %s' % (a, body)).encode()]\n\n    self.site.application = new_app\n    sock = eventlet.connect(self.server_addr)\n    request = b'\\r\\n'.join((\n        b'POST / HTTP/1.0',\n        b'Host: localhost',\n        b'Content-Length: 3',\n        b'',\n        b'a=a'))\n    sock.sendall(request)\n\n    # send some junk after the actual request\n    sock.sendall(b'01234567890123456789')\n    result = read_http(sock)\n    self.assertEqual(result.body, b'a is a, body is a=a')",
      "hash_value": "284c9f85d95c4da044c987f3536a402e",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def test_007_get_arg(self):\n    # define a new handler that does a get_arg as well as a read_body\n    def new_app(env, start_response):\n        body = bytes_to_str(env['wsgi.input'].read())\n        a = parse.parse_qs(body).get('a', [1])[0]\n        start_response('200 OK', [('Content-type', 'text/plain')])\n        return [('a is %s, body is %s' % (a, body)).encode()]\n\n    self.site.application = new_app\n    sock = eventlet.connect(self.server_addr)\n    request = b'\\r\\n'.join((\n        b'POST / HTTP/1.0',\n        b'Host: localhost',\n        b'Content-Length: 3',\n        b'',\n        b'a=a'))\n    sock.sendall(request)\n\n    # send some junk after the actual request\n    sock.sendall(b'01234567890123456789')\n    result = read_http(sock)\n    self.assertEqual(result.body, b'a is a, body is a=a')",
          "triple_sequences": [
            {
              "action_api": "env['wsgi.input'].read()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "env['wsgi.input']",
              "object_description": "",
              "object_id": "",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "bytes_to_str()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "env['wsgi.input'].read()",
              "object_description": "",
              "object_id": "",
              "intention_description": "Decode bytes to string",
              "intention_id": "decode_bytes_to_string"
            },
            {
              "action_api": "parse.parse_qs()",
              "action_description": "Deserializes JSON string to Python object",
              "action_id": "deserialize_from_json",
              "object": "body",
              "object_description": "",
              "object_id": "",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "start_response()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "'200 OK', [('Content-type', 'text/plain')]",
              "object_description": "HTTP headers",
              "object_id": "http_headers",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "str.encode()",
              "action_description": "Encodes string to bytes using default encoding",
              "action_id": "encode_string_to_bytes",
              "object": "'a is %s, body is %s' % (a, body)",
              "object_description": "Encoded string to bytes",
              "object_id": "encoded_string_bytes",
              "intention_description": "Encode string to bytes",
              "intention_id": "encode_string_to_bytes"
            },
            {
              "action_api": "eventlet.connect()",
              "action_description": "Establishes TCP connection to specified address",
              "action_id": "establish_tcp_connection",
              "object": "self.server_addr",
              "object_description": "Socket address",
              "object_id": "socket_address",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "sock.sendall()",
              "action_description": "Sends data over socket connection",
              "action_id": "send_socket_data",
              "object": "request",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Send data to server",
              "intention_id": "send_data_server"
            },
            {
              "action_api": "sock.sendall()",
              "action_description": "Sends data over socket connection",
              "action_id": "send_socket_data",
              "object": "b'01234567890123456789'",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Send data to server",
              "intention_id": "send_data_server"
            },
            {
              "action_api": "read_http()",
              "action_description": "Receives data from socket connection",
              "action_id": "receive_socket_data",
              "object": "sock",
              "object_description": "Socket address",
              "object_id": "socket_address",
              "intention_description": "Receive command from server",
              "intention_id": "receive_command_from_server"
            },
            {
              "action_api": "self.assertEqual()",
              "action_description": "Checks if object is instance of specified type",
              "action_id": "check_instance_type",
              "object": "result.body, b'a is a, body is a=a'",
              "object_description": "",
              "object_id": "",
              "intention_description": "Stop execution on invalid input",
              "intention_id": "stop_execution_invalid_input"
            }
          ]
        }
      ]
    }
  ]
}