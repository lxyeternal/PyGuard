{
  "metadata": {
    "package_name": "bioregistry-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/bioregistry-0.12.10.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "__init__.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/bioregistry-0.12.10/bioregistry-0.12.10/src/bioregistry/external/obofoundry/__init__.py",
      "line_number": "79",
      "type_description": "B820:get",
      "context_snippet": "def _process(record: dict[str, Any]) -> dict[str, Any]:\n    for key in (\"browsers\", \"usages\", \"build\", \"layout\", \"taxon\"):\n        record.pop(key, None)\n\n    oid = record[\"id\"].lower()\n\n    # added to throw away placeholder contact\n    contact_github = record.get(\"contact\", {}).get(\"github\")\n    if contact_github == \"ghost\":\n        del record[\"contact\"]\n\n    rv = {\n        \"name\": record[\"title\"],\n        \"description\": record.get(\"description\"),\n        \"deprecated\": record[\"activity_status\"] != \"active\",\n        \"homepage\": record.get(\"homepage\") or record.get(\"repository\"),\n        \"preferredPrefix\": record.get(\"preferredPrefix\"),\n        \"license\": record.get(\"license\", {}).get(\"label\"),\n        \"license.url\": record.get(\"license\", {}).get(\"url\"),\n        \"contact\": record.get(\"contact\", {}).get(\"email\"),\n        \"contact.label\": record.get(\"contact\", {}).get(\"label\"),\n        \"contact.github\": record.get(\"contact\", {}).get(\"github\"),\n        \"contact.orcid\": record.get(\"contact\", {}).get(\"orcid\"),\n        \"repository\": record.get(\"repository\"),\n        \"domain\": record.get(\"domain\"),\n    }\n\n    for key in (\"publications\", \"twitter\"):\n        value = record.get(key)\n        if value:\n            rv[key] = value\n\n    dependencies = record.get(\"dependencies\")\n    if dependencies:\n        rv[\"depends_on\"] = sorted(\n            dependency[\"id\"]\n            for dependency in record.get(\"dependencies\", [])\n            if dependency.get(\"type\") not in {\"BridgeOntology\"}\n        )\n\n    for product in record.get(\"products\", []):\n        if product[\"id\"] == f\"{oid}.obo\":\n            rv[\"download.obo\"] = product[\"ontology_purl\"]\n        elif product[\"id\"] == f\"{oid}.json\":\n            rv[\"download.json\"] = product[\"ontology_purl\"]\n        elif product[\"id\"] == f\"{oid}.owl\":\n            rv[\"download.owl\"] = product[\"ontology_purl\"]\n\n    logo = record.get(\"depicted_by\")\n    if logo:\n        if logo.startswith(\"/images/\"):\n            logo = f\"https://obofoundry.org{logo}\"\n        rv[\"logo\"] = logo\n\n    return {k: v for k, v in rv.items() if v is not None}\n",
      "hash_value": "6d8250e36a1709a90f78f57f3bd2f658",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def _process(record: dict[str, Any]) -> dict[str, Any]:\n    for key in (\"browsers\", \"usages\", \"build\", \"layout\", \"taxon\"):\n        record.pop(key, None)\n\n    oid = record[\"id\"].lower()\n\n    # added to throw away placeholder contact\n    contact_github = record.get(\"contact\", {}).get(\"github\")\n    if contact_github == \"ghost\":\n        del record[\"contact\"]\n\n    rv = {\n        \"name\": record[\"title\"],\n        \"description\": record.get(\"description\"),\n        \"deprecated\": record[\"activity_status\"] != \"active\",\n        \"homepage\": record.get(\"homepage\") or record.get(\"repository\"),\n        \"preferredPrefix\": record.get(\"preferredPrefix\"),\n        \"license\": record.get(\"license\", {}).get(\"label\"),\n        \"license.url\": record.get(\"license\", {}).get(\"url\"),\n        \"contact\": record.get(\"contact\", {}).get(\"email\"),\n        \"contact.label\": record.get(\"contact\", {}).get(\"label\"),\n        \"contact.github\": record.get(\"contact\", {}).get(\"github\"),\n        \"contact.orcid\": record.get(\"contact\", {}).get(\"orcid\"),\n        \"repository\": record.get(\"repository\"),\n        \"domain\": record.get(\"domain\"),\n    }\n\n    for key in (\"publications\", \"twitter\"):\n        value = record.get(key)\n        if value:\n            rv[key] = value\n\n    dependencies = record.get(\"dependencies\")\n    if dependencies:\n        rv[\"depends_on\"] = sorted(\n            dependency[\"id\"]\n            for dependency in record.get(\"dependencies\", [])\n            if dependency.get(\"type\") not in {\"BridgeOntology\"}\n        )\n\n    for product in record.get(\"products\", []):\n        if product[\"id\"] == f\"{oid}.obo\":\n            rv[\"download.obo\"] = product[\"ontology_purl\"]\n        elif product[\"id\"] == f\"{oid}.json\":\n            rv[\"download.json\"] = product[\"ontology_purl\"]\n        elif product[\"id\"] == f\"{oid}.owl\":\n            rv[\"download.owl\"] = product[\"ontology_purl\"]\n\n    logo = record.get(\"depicted_by\")\n    if logo:\n        if logo.startswith(\"/images/\"):\n            logo = f\"https://obofoundry.org{logo}\"\n        rv[\"logo\"] = logo\n\n    return {k: v for k, v in rv.items() if v is not None}\n",
          "triple_sequences": [
            {
              "action_api": "dict.pop()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "key, None",
              "object_description": "",
              "object_id": "",
              "intention_description": "Delete file content",
              "intention_id": "delete_file_content"
            },
            {
              "action_api": "dict.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"contact\", {}",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "dict.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"github\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "del record[\"contact\"]",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "\"contact\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Delete file content",
              "intention_id": "delete_file_content"
            },
            {
              "action_api": "dict.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"description\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "dict.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"homepage\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "dict.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"repository\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "dict.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"preferredPrefix\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "dict.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"license\", {}",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "dict.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"label\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "dict.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"url\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "dict.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"contact\", {}",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "dict.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"email\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "dict.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"label\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "dict.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"github\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "dict.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"orcid\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "dict.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"repository\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "dict.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"domain\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "dict.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"publications\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "dict.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"twitter\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "dict.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"dependencies\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "sorted()",
              "action_description": "Lists all currently alive threads",
              "action_id": "list_threads",
              "object": "[dependency[\"id\"] for dependency in record.get(\"dependencies\", []) if dependency.get(\"type\") not in {\"BridgeOntology\"}]",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "dict.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"products\", []",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "str.startswith()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "logo.startswith(\"/images/\")",
              "object_description": "",
              "object_id": "",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "dict.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"depicted_by\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "dict.items()",
              "action_description": "Lists all currently alive threads",
              "action_id": "list_threads",
              "object": "rv.items()",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            }
          ]
        }
      ]
    }
  ]
}