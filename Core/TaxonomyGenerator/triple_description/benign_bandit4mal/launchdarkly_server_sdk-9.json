{
  "metadata": {
    "package_name": "launchdarkly_server_sdk-9",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/launchdarkly_server_sdk-9.10.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "migrator.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/launchdarkly_server_sdk-9.10.0/launchdarkly_server_sdk-9.10.0/ldclient/migrations/migrator.py",
      "line_number": "97",
      "type_description": "B840:executor",
      "context_snippet": "def write(self, key: str, context: Context, default_stage: Stage, payload: Optional[Any] = None) -> WriteResult:\n    stage, tracker = self.__client.migration_variation(key, context, default_stage)\n    tracker.operation(Operation.WRITE)\n\n    old = Executor(Origin.OLD, self.__write_config.old, tracker, self.__measure_latency, self.__measure_errors, payload)\n    new = Executor(Origin.NEW, self.__write_config.new, tracker, self.__measure_latency, self.__measure_errors, payload)\n\n    if stage == Stage.OFF:\n        result = old.run()\n        write_result = WriteResult(result)\n    elif stage == Stage.DUALWRITE:\n        authoritative_result, nonauthoritative_result = self.__write_both(old, new, tracker)\n        write_result = WriteResult(authoritative_result, nonauthoritative_result)\n    elif stage == Stage.SHADOW:\n        authoritative_result, nonauthoritative_result = self.__write_both(old, new, tracker)\n        write_result = WriteResult(authoritative_result, nonauthoritative_result)\n    elif stage == Stage.LIVE:\n        authoritative_result, nonauthoritative_result = self.__write_both(new, old, tracker)\n        write_result = WriteResult(authoritative_result, nonauthoritative_result)\n    elif stage == Stage.RAMPDOWN:\n        authoritative_result, nonauthoritative_result = self.__write_both(new, old, tracker)\n        write_result = WriteResult(authoritative_result, nonauthoritative_result)\n    else:\n        result = new.run()\n        write_result = WriteResult(result)\n\n    self.__client.track_migration_op(tracker)\n\n    return write_result",
      "hash_value": "976e4e216724ad02c7bb1e646dbc7b7c",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def write(self, key: str, context: Context, default_stage: Stage, payload: Optional[Any] = None) -> WriteResult:\n    stage, tracker = self.__client.migration_variation(key, context, default_stage)\n    tracker.operation(Operation.WRITE)\n\n    old = Executor(Origin.OLD, self.__write_config.old, tracker, self.__measure_latency, self.__measure_errors, payload)\n    new = Executor(Origin.NEW, self.__write_config.new, tracker, self.__measure_latency, self.__measure_errors, payload)\n\n    if stage == Stage.OFF:\n        result = old.run()\n        write_result = WriteResult(result)\n    elif stage == Stage.DUALWRITE:\n        authoritative_result, nonauthoritative_result = self.__write_both(old, new, tracker)\n        write_result = WriteResult(authoritative_result, nonauthoritative_result)\n    elif stage == Stage.SHADOW:\n        authoritative_result, nonauthoritative_result = self.__write_both(old, new, tracker)\n        write_result = WriteResult(authoritative_result, nonauthoritative_result)\n    elif stage == Stage.LIVE:\n        authoritative_result, nonauthoritative_result = self.__write_both(new, old, tracker)\n        write_result = WriteResult(authoritative_result, nonauthoritative_result)\n    elif stage == Stage.RAMPDOWN:\n        authoritative_result, nonauthoritative_result = self.__write_both(new, old, tracker)\n        write_result = WriteResult(authoritative_result, nonauthoritative_result)\n    else:\n        result = new.run()\n        write_result = WriteResult(result)\n\n    self.__client.track_migration_op(tracker)\n\n    return write_result",
          "triple_sequences": [
            {
              "action_api": "self.__client.migration_variation()",
              "action_description": "Retrieves operating system information",
              "action_id": "get_os_info",
              "object": "key, context, default_stage",
              "object_description": "",
              "object_id": "",
              "intention_description": "Gather system information",
              "intention_id": "gather_system_information"
            },
            {
              "action_api": "tracker.operation()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "Operation.WRITE",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "Executor()",
              "action_description": "Creates child process",
              "action_id": "create_child_process",
              "object": "Origin.OLD, self.__write_config.old, tracker, self.__measure_latency, self.__measure_errors, payload",
              "object_description": "Thread target and arguments",
              "object_id": "thread_target_arguments",
              "intention_description": "Create child process",
              "intention_id": "create_child_process"
            },
            {
              "action_api": "Executor()",
              "action_description": "Creates child process",
              "action_id": "create_child_process",
              "object": "Origin.NEW, self.__write_config.new, tracker, self.__measure_latency, self.__measure_errors, payload",
              "object_description": "Thread target and arguments",
              "object_id": "thread_target_arguments",
              "intention_description": "Create child process",
              "intention_id": "create_child_process"
            },
            {
              "action_api": "old.run()",
              "action_description": "Spawns new process to execute command without shell access",
              "action_id": "spawn_process_no_shell",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Create child process",
              "intention_id": "create_child_process"
            },
            {
              "action_api": "WriteResult()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "result",
              "object_description": "",
              "object_id": "",
              "intention_description": "Create child process",
              "intention_id": "create_child_process"
            },
            {
              "action_api": "self.__write_both()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "old, new, tracker",
              "object_description": "Thread target and arguments",
              "object_id": "thread_target_arguments",
              "intention_description": "Create child process",
              "intention_id": "create_child_process"
            },
            {
              "action_api": "WriteResult()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "authoritative_result, nonauthoritative_result",
              "object_description": "",
              "object_id": "",
              "intention_description": "Create child process",
              "intention_id": "create_child_process"
            },
            {
              "action_api": "self.__write_both()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "new, old, tracker",
              "object_description": "Thread target and arguments",
              "object_id": "thread_target_arguments",
              "intention_description": "Create child process",
              "intention_id": "create_child_process"
            },
            {
              "action_api": "WriteResult()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "authoritative_result, nonauthoritative_result",
              "object_description": "",
              "object_id": "",
              "intention_description": "Create child process",
              "intention_id": "create_child_process"
            },
            {
              "action_api": "new.run()",
              "action_description": "Spawns new process to execute command without shell access",
              "action_id": "spawn_process_no_shell",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Create child process",
              "intention_id": "create_child_process"
            },
            {
              "action_api": "WriteResult()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "result",
              "object_description": "",
              "object_id": "",
              "intention_description": "Create child process",
              "intention_id": "create_child_process"
            },
            {
              "action_api": "self.__client.track_migration_op()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "tracker",
              "object_description": "",
              "object_id": "",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            }
          ]
        }
      ]
    }
  ]
}