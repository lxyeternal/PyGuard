{
  "metadata": {
    "package_name": "resource-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/resource-0.2.1.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "django.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/resource-0.2.1/Resource-0.2.1/rsrc/framework/django.py",
      "line_number": "95",
      "type_description": "B835:load",
      "context_snippet": "def get_data(self, request):\n    return payload(request)\n\ndef payload(request):\n    \"\"\"\n    Inspired by `Django REST framework` - https://github.com/tomchristie/django-rest-framework\n    \"\"\"\n\n    # get the content body of the request, as a stream.\n    try:\n        content_length = int(request.META.get('CONTENT_LENGTH',\n                             request.META.get('HTTP_CONTENT_LENGTH')))\n    except (ValueError, TypeError):\n        content_length = 0\n\n    if content_length == 0:\n        stream = None\n    else:\n        stream = request\n\n    content_type = request.META.get('HTTP_CONTENT_TYPE',\n                                    request.META.get('CONTENT_TYPE'))\n\n    if stream is None or content_type is None:\n        return {}\n\n    encoding = settings.DEFAULT_CHARSET\n    try:\n        data = stream.read().decode(encoding)\n        return json.loads(data)\n    except ValueError:\n        return {}",
      "hash_value": "b23f310a6f54418f8b70269d66b8f2e4",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def get_data(self, request):\n    return payload(request)\n\ndef payload(request):\n    \"\"\"\n    Inspired by `Django REST framework` - https://github.com/tomchristie/django-rest-framework\n    \"\"\"\n\n    # get the content body of the request, as a stream.\n    try:\n        content_length = int(request.META.get('CONTENT_LENGTH',\n                             request.META.get('HTTP_CONTENT_LENGTH')))\n    except (ValueError, TypeError):\n        content_length = 0\n\n    if content_length == 0:\n        stream = None\n    else:\n        stream = request\n\n    content_type = request.META.get('HTTP_CONTENT_TYPE',\n                                    request.META.get('CONTENT_TYPE'))\n\n    if stream is None or content_type is None:\n        return {}\n\n    encoding = settings.DEFAULT_CHARSET\n    try:\n        data = stream.read().decode(encoding)\n        return json.loads(data)\n    except ValueError:\n        return {}",
          "triple_sequences": [
            {
              "action_api": "request.META.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "'CONTENT_LENGTH', request.META.get('HTTP_CONTENT_LENGTH')",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "int()",
              "action_description": "Converts string to integer",
              "action_id": "convert_string_to_integer",
              "object": "request.META.get('CONTENT_LENGTH', request.META.get('HTTP_CONTENT_LENGTH'))",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Convert string to integer",
              "intention_id": "convert_string_to_integer"
            },
            {
              "action_api": "request.META.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "'HTTP_CONTENT_TYPE', request.META.get('CONTENT_TYPE')",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "stream.read()",
              "action_description": "Reads all bytes from process standard output",
              "action_id": "read_process_stdout",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "str.decode()",
              "action_description": "Decodes bytes using specified codec",
              "action_id": "decode_bytes_codec",
              "object": "encoding",
              "object_description": "Character encoding type",
              "object_id": "character_encoding_type",
              "intention_description": "Decode bytes to string",
              "intention_id": "decode_bytes_to_string"
            },
            {
              "action_api": "json.loads()",
              "action_description": "Deserializes JSON string to Python object",
              "action_id": "deserialize_from_json",
              "object": "data",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            }
          ]
        }
      ]
    }
  ]
}