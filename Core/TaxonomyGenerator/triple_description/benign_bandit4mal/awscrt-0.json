{
  "metadata": {
    "package_name": "awscrt-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/awscrt-0.26.1.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "test_http_client.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/awscrt-0.26.1/awscrt-0.26.1/test/test_http_client.py",
      "line_number": "58",
      "type_description": "B827:httpserver",
      "context_snippet": "    def _start_server(self, secure, http_1_0=False):\n        # HTTP/1.0 closes the connection at the end of each request\n        # HTTP/1.1 will keep the connection alive\n        if http_1_0:\n            TestRequestHandler.protocol_version = \"HTTP/1.0\"\n        else:\n            TestRequestHandler.protocol_version = \"HTTP/1.1\"\n\n        self.server = HTTPServer((self.hostname, 0), TestRequestHandler)\n        if secure:\n            context = ssl.SSLContext(ssl.PROTOCOL_TLS_SERVER)\n            context.load_cert_chain(certfile='test/resources/unittest.crt', keyfile=\"test/resources/unittest.key\")\n            self.server.socket = context.wrap_socket(self.server.socket, server_side=True)\n        self.port = self.server.server_address[1]\n\n        # put requests are stored in this dict\n        self.server.put_requests = {}\n\n        self.server_thread = threading.Thread(target=self.server.serve_forever, name='test_server')\n        self.server_thread.start()",
      "hash_value": "648488db5156c9198d9a4f8d7057049f",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "    def _start_server(self, secure, http_1_0=False):\n        # HTTP/1.0 closes the connection at the end of each request\n        # HTTP/1.1 will keep the connection alive\n        if http_1_0:\n            TestRequestHandler.protocol_version = \"HTTP/1.0\"\n        else:\n            TestRequestHandler.protocol_version = \"HTTP/1.1\"\n\n        self.server = HTTPServer((self.hostname, 0), TestRequestHandler)\n        if secure:\n            context = ssl.SSLContext(ssl.PROTOCOL_TLS_SERVER)\n            context.load_cert_chain(certfile='test/resources/unittest.crt', keyfile=\"test/resources/unittest.key\")\n            self.server.socket = context.wrap_socket(self.server.socket, server_side=True)\n        self.port = self.server.server_address[1]\n\n        # put requests are stored in this dict\n        self.server.put_requests = {}\n\n        self.server_thread = threading.Thread(target=self.server.serve_forever, name='test_server')\n        self.server_thread.start()",
          "triple_sequences": [
            {
              "action_api": "HTTPServer()",
              "action_description": "Creates HTTP connection to specified host",
              "action_id": "create_http_connection",
              "object": "(self.hostname, 0), TestRequestHandler",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "ssl.SSLContext()",
              "action_description": "Creates SSL context with specified protocol",
              "action_id": "create_ssl_context",
              "object": "ssl.PROTOCOL_TLS_SERVER",
              "object_description": "Protocol string",
              "object_id": "protocol_string",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "context.load_cert_chain()",
              "action_description": "Sets file attributes for specified file",
              "action_id": "set_file_attributes",
              "object": "certfile='test/resources/unittest.crt', keyfile='test/resources/unittest.key'",
              "object_description": "Certificate file",
              "object_id": "",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "context.wrap_socket()",
              "action_description": "Wraps socket for SSL/TLS communication",
              "action_id": "wrap_socket_ssl",
              "object": "self.server.socket, server_side=True",
              "object_description": "Socket address",
              "object_id": "socket_address",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "threading.Thread()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "target=self.server.serve_forever, name='test_server'",
              "object_description": "Thread target and arguments",
              "object_id": "thread_target_arguments",
              "intention_description": "Concurrent execution preparation",
              "intention_id": "concurrent_execution_preparation"
            },
            {
              "action_api": "self.server_thread.start()",
              "action_description": "Starts thread execution",
              "action_id": "start_thread",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Concurrent execution preparation",
              "intention_id": "concurrent_execution_preparation"
            }
          ]
        }
      ]
    }
  ]
}