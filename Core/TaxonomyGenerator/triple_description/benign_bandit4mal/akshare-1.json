{
  "metadata": {
    "package_name": "akshare-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/akshare-1.16.75.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "macro_constitute.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/akshare-1.16.75/akshare-1.16.75/akshare/economic/macro_constitute.py",
      "line_number": "183",
      "type_description": "B820:get",
      "context_snippet": "def macro_cons_opec_month() -> pd.DataFrame:\n    \"\"\"\n    欧佩克报告-月度, 数据区间从 20170118-至今\n    这里返回的具体索引日期的数据为上一个月的数据, 由于某些国家的数据有缺失\n    只选择有数据的国家返回\n    20200312:fix:由于 “厄瓜多尔” 已经有几个月没有更新数据，在这里加以剔除\n    https://datacenter.jin10.com/reportType/dc_opec_report\n    :return: 欧佩克报告-月度\n    :rtype: pandas.DataFrame\n    \"\"\"\n    t = time.time()\n    big_df = pd.DataFrame()\n    headers = {\n        \"accept\": \"*/*\",\n        \"accept-encoding\": \"gzip, deflate, br\",\n        \"accept-language\": \"zh-CN,zh;q=0.9,en;q=0.8\",\n        \"cache-control\": \"no-cache\",\n        \"origin\": \"https://datacenter.jin10.com\",\n        \"pragma\": \"no-cache\",\n        \"referer\": \"https://datacenter.jin10.com/reportType/dc_opec_report\",\n        \"sec-fetch-mode\": \"cors\",\n        \"sec-fetch-site\": \"same-site\",\n        \"user-agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) \"\n        \"Chrome/79.0.3945.117 Safari/537.36\",\n        \"x-app-id\": \"rU6QIu7JHe2gOUeR\",\n        \"x-csrf-token\": \"\",\n        \"x-version\": \"1.0.0\",\n    }\n    res = requests.get(\n        url=f\"https://datacenter-api.jin10.com/reports/dates?category=opec&_={str(int(round(t * 1000)))}\",\n        headers=headers,\n    )  # 日期序列\n    all_date_list = res.json()[\"data\"]\n    bar = tqdm(reversed(all_date_list))\n    for item in bar:\n        bar.set_description(f\"Please wait for a moment, now downloading {item}'s data\")\n        res = requests.get(\n            url=f\"https://datacenter-api.jin10.com/reports/list?\"\n            f\"category=opec&date={item}&_={str(int(round(t * 1000)))}\",\n            headers=headers,\n        )\n        temp_df = pd.DataFrame(\n            res.json()[\"data\"][\"values\"],\n            columns=pd.DataFrame(res.json()[\"data\"][\"keys\"])[\"name\"].tolist(),\n        ).T\n        temp_df.columns = temp_df.iloc[0, :]\n        temp_df = temp_df.iloc[1:, :]\n        try:\n            temp_df = temp_df[\n                [\n                    \"阿尔及利亚\",\n                    \"安哥拉\",\n                    \"加蓬\",\n                    \"伊朗\",\n                    \"伊拉克\",\n                    \"科威特\",\n                    \"利比亚\",\n                    \"尼日利亚\",\n                    \"沙特\",\n                    \"阿联酋\",\n                    \"委内瑞拉\",\n                    \"欧佩克产量\",\n                ]\n            ].iloc[-2, :]\n        except:  # noqa: E722\n            temp_df = temp_df[\n                [\n                    \"阿尔及利亚\",\n                    \"安哥拉\",\n                    \"加蓬\",\n                    \"伊朗\",\n                    \"伊拉克\",\n                    \"科威特\",\n                    \"利比亚\",\n                    \"尼日利亚\",\n                    \"沙特\",\n                    \"阿联酋\",\n                    \"委内瑞拉\",\n                    \"欧佩克产量\",\n                ]\n            ].iloc[-1, :]\n        temp_df.dropna(inplace=True)\n        big_df[temp_df.name] = temp_df\n    big_df = big_df.T\n    big_df = big_df.astype(float)\n    big_df.reset_index(inplace=True)\n    big_df.rename(columns={\"index\": \"日期\"}, inplace=True)\n    big_df.columns.name = None\n    return big_df",
      "hash_value": "00374edb02ad5cf653dd83f0e3994164",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def macro_cons_opec_month() -> pd.DataFrame:\n    \"\"\"\n    欧佩克报告-月度, 数据区间从 20170118-至今\n    这里返回的具体索引日期的数据为上一个月的数据, 由于某些国家的数据有缺失\n    只选择有数据的国家返回\n    20200312:fix:由于 “厄瓜多尔” 已经有几个月没有更新数据，在这里加以剔除\n    https://datacenter.jin10.com/reportType/dc_opec_report\n    :return: 欧佩克报告-月度\n    :rtype: pandas.DataFrame\n    \"\"\"\n    t = time.time()\n    big_df = pd.DataFrame()\n    headers = {\n        \"accept\": \"*/*\",\n        \"accept-encoding\": \"gzip, deflate, br\",\n        \"accept-language\": \"zh-CN,zh;q=0.9,en;q=0.8\",\n        \"cache-control\": \"no-cache\",\n        \"origin\": \"https://datacenter.jin10.com\",\n        \"pragma\": \"no-cache\",\n        \"referer\": \"https://datacenter.jin10.com/reportType/dc_opec_report\",\n        \"sec-fetch-mode\": \"cors\",\n        \"sec-fetch-site\": \"same-site\",\n        \"user-agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) \"\n        \"Chrome/79.0.3945.117 Safari/537.36\",\n        \"x-app-id\": \"rU6QIu7JHe2gOUeR\",\n        \"x-csrf-token\": \"\",\n        \"x-version\": \"1.0.0\",\n    }\n    res = requests.get(\n        url=f\"https://datacenter-api.jin10.com/reports/dates?category=opec&_={str(int(round(t * 1000)))}\",\n        headers=headers,\n    )  # 日期序列\n    all_date_list = res.json()[\"data\"]\n    bar = tqdm(reversed(all_date_list))\n    for item in bar:\n        bar.set_description(f\"Please wait for a moment, now downloading {item}'s data\")\n        res = requests.get(\n            url=f\"https://datacenter-api.jin10.com/reports/list?\"\n            f\"category=opec&date={item}&_={str(int(round(t * 1000)))}\",\n            headers=headers,\n        )\n        temp_df = pd.DataFrame(\n            res.json()[\"data\"][\"values\"],\n            columns=pd.DataFrame(res.json()[\"data\"][\"keys\"])[\"name\"].tolist(),\n        ).T\n        temp_df.columns = temp_df.iloc[0, :]\n        temp_df = temp_df.iloc[1:, :]\n        try:\n            temp_df = temp_df[\n                [\n                    \"阿尔及利亚\",\n                    \"安哥拉\",\n                    \"加蓬\",\n                    \"伊朗\",\n                    \"伊拉克\",\n                    \"科威特\",\n                    \"利比亚\",\n                    \"尼日利亚\",\n                    \"沙特\",\n                    \"阿联酋\",\n                    \"委内瑞拉\",\n                    \"欧佩克产量\",\n                ]\n            ].iloc[-2, :]\n        except:  # noqa: E722\n            temp_df = temp_df[\n                [\n                    \"阿尔及利亚\",\n                    \"安哥拉\",\n                    \"加蓬\",\n                    \"伊朗\",\n                    \"伊拉克\",\n                    \"科威特\",\n                    \"利比亚\",\n                    \"尼日利亚\",\n                    \"沙特\",\n                    \"阿联酋\",\n                    \"委内瑞拉\",\n                    \"欧佩克产量\",\n                ]\n            ].iloc[-1, :]\n        temp_df.dropna(inplace=True)\n        big_df[temp_df.name] = temp_df\n    big_df = big_df.T\n    big_df = big_df.astype(float)\n    big_df.reset_index(inplace=True)\n    big_df.rename(columns={\"index\": \"日期\"}, inplace=True)\n    big_df.columns.name = None\n    return big_df",
          "triple_sequences": [
            {
              "action_api": "time.time()",
              "action_description": "Returns current time",
              "action_id": "get_current_time",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get datetime epoch",
              "intention_id": "get_datetime_epoch"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP GET request to URL",
              "action_id": "open_url_get",
              "object": "https://datacenter-api.jin10.com/reports/dates?category=opec&_={str(int(round(t * 1000)))}",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "res.json()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "tqdm()",
              "action_description": "Iterates over response content in chunks",
              "action_id": "iterate_response_chunks",
              "object": "reversed(all_date_list)",
              "object_description": "",
              "object_id": "",
              "intention_description": "Wait for events",
              "intention_id": "wait_for_events"
            },
            {
              "action_api": "bar.set_description()",
              "action_description": "Sets attribute on builtins object",
              "action_id": "set_builtin_attr",
              "object": "f\"Please wait for a moment, now downloading {item}'s data\"",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP GET request to URL",
              "action_id": "open_url_get",
              "object": "https://datacenter-api.jin10.com/reports/list?category=opec&date={item}&_={str(int(round(t * 1000)))}",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "res.json()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "pd.DataFrame()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "res.json()[\"data\"][\"values\"], columns=pd.DataFrame(res.json()[\"data\"][\"keys\"])[\"name\"].tolist()",
              "object_description": "Structured file data",
              "object_id": "structured_file_data",
              "intention_description": "Extract structured file data",
              "intention_id": "extract_structured_file_data"
            },
            {
              "action_api": "temp_df.dropna()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Delete file content",
              "intention_id": "delete_file_content"
            },
            {
              "action_api": "big_df.astype()",
              "action_description": "Sets attribute on builtins object",
              "action_id": "set_builtin_attr",
              "object": "float",
              "object_description": "Content type string",
              "object_id": "content_type",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "big_df.reset_index()",
              "action_description": "Sets attribute on builtins object",
              "action_id": "set_builtin_attr",
              "object": "inplace=True",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "big_df.rename()",
              "action_description": "Sets attribute on builtins object",
              "action_id": "set_builtin_attr",
              "object": "columns={\"index\": \"日期\"}, inplace=True",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            }
          ]
        }
      ]
    }
  ]
}