{
  "metadata": {
    "package_name": "scikit_build_core-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/scikit_build_core-0.11.1.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "test_pyproject_pep517.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/scikit_build_core-0.11.1/scikit_build_core-0.11.1/tests/test_pyproject_pep517.py",
      "line_number": "212",
      "type_description": "B834:open",
      "context_snippet": "@pytest.mark.compile\n@pytest.mark.configure\n@pytest.mark.usefixtures(\"package_simple_pyproject_ext\")\ndef test_pep517_wheel(virtualenv, tmp_path: Path):\n    dist = tmp_path / \"dist\"\n    out = build_wheel(\n        str(dist), {\"cmake.targets\": [\"cmake_example\"]}\n    )  # Could leave empty\n    (wheel,) = dist.glob(\"cmake_example-0.0.1-*.whl\")\n    assert wheel == dist / out\n\n    with zipfile.ZipFile(wheel) as zf:\n        file_paths = {Path(p) for p in zf.namelist()}\n        file_names = {p.parts[0] for p in file_paths}\n\n        with zf.open(\"cmake_example-0.0.1.dist-info/METADATA\") as f:\n            metadata = f.read().decode(\"utf-8\")\n\n        with zf.open(\"cmake_example-0.0.1.dist-info/entry_points.txt\") as f:\n            entry_points = f.read().decode(\"utf-8\")\n\n    assert Path(\"cmake_example-0.0.1.dist-info/licenses/LICENSE\") in file_paths\n\n    assert len(file_names) == 2\n    assert \"cmake_example-0.0.1.dist-info\" in file_names\n    file_names.remove(\"cmake_example-0.0.1.dist-info\")\n    (so_file,) = file_names\n\n    assert so_file.startswith(\"cmake_example\")\n    print(\"SOFILE:\", so_file)\n\n    print(entry_points == ENTRYPOINTS)\n    assert 'Requires-Dist: pytest>=6.0; extra == \"test\"' in metadata\n    assert \"Metadata-Version: 2.2\" in metadata\n    assert \"Name: CMake.Example\" in metadata\n    assert \"Version: 0.0.1\" in metadata\n    assert \"Requires-Python: >=3.8\" in metadata\n    assert \"Provides-Extra: test\" in metadata\n\n    virtualenv.install(wheel)\n\n    version = virtualenv.execute(\n        \"import cmake_example; print(cmake_example.__version__)\",\n    )\n    assert version.strip() == \"0.0.1\"\n\n    add = virtualenv.execute(\n        \"import cmake_example; print(cmake_example.add(1, 2))\",\n    )\n    assert add.strip() == \"3\"",
      "hash_value": "f9554c9125a31fbbc7925d0b7f49351a",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "@pytest.mark.compile\n@pytest.mark.configure\n@pytest.mark.usefixtures(\"package_simple_pyproject_ext\")\ndef test_pep517_wheel(virtualenv, tmp_path: Path):\n    dist = tmp_path / \"dist\"\n    out = build_wheel(\n        str(dist), {\"cmake.targets\": [\"cmake_example\"]}\n    )  # Could leave empty\n    (wheel,) = dist.glob(\"cmake_example-0.0.1-*.whl\")\n    assert wheel == dist / out\n\n    with zipfile.ZipFile(wheel) as zf:\n        file_paths = {Path(p) for p in zf.namelist()}\n        file_names = {p.parts[0] for p in file_paths}\n\n        with zf.open(\"cmake_example-0.0.1.dist-info/METADATA\") as f:\n            metadata = f.read().decode(\"utf-8\")\n\n        with zf.open(\"cmake_example-0.0.1.dist-info/entry_points.txt\") as f:\n            entry_points = f.read().decode(\"utf-8\")\n\n    assert Path(\"cmake_example-0.0.1.dist-info/licenses/LICENSE\") in file_paths\n\n    assert len(file_names) == 2\n    assert \"cmake_example-0.0.1.dist-info\" in file_names\n    file_names.remove(\"cmake_example-0.0.1.dist-info\")\n    (so_file,) = file_names\n\n    assert so_file.startswith(\"cmake_example\")\n    print(\"SOFILE:\", so_file)\n\n    print(entry_points == ENTRYPOINTS)\n    assert 'Requires-Dist: pytest>=6.0; extra == \"test\"' in metadata\n    assert \"Metadata-Version: 2.2\" in metadata\n    assert \"Name: CMake.Example\" in metadata\n    assert \"Version: 0.0.1\" in metadata\n    assert \"Requires-Python: >=3.8\" in metadata\n    assert \"Provides-Extra: test\" in metadata\n\n    virtualenv.install(wheel)\n\n    version = virtualenv.execute(\n        \"import cmake_example; print(cmake_example.__version__)\",\n    )\n    assert version.strip() == \"0.0.1\"\n\n    add = virtualenv.execute(\n        \"import cmake_example; print(cmake_example.add(1, 2))\",\n    )\n    assert add.strip() == \"3\"",
          "triple_sequences": [
            {
              "action_api": "build_wheel()",
              "action_description": "Executes setuptools installation procedure",
              "action_id": "exec_setuptools_install",
              "object": "str(dist), {\"cmake.targets\": [\"cmake_example\"]}",
              "object_description": "Function and arguments",
              "object_id": "function_with_arguments",
              "intention_description": "Install required Python package",
              "intention_id": "install_required_python_package"
            },
            {
              "action_api": "dist.glob()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "\"cmake_example-0.0.1-*.whl\"",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "zipfile.ZipFile()",
              "action_description": "Opens ZIP archive for reading",
              "action_id": "open_zip_read",
              "object": "wheel",
              "object_description": "ZIP archive file",
              "object_id": "zip_archive",
              "intention_description": "Open zip archive",
              "intention_id": "create_zip_archive"
            },
            {
              "action_api": "zf.namelist()",
              "action_description": "Extracts all files from ZIP archive to specified directory",
              "action_id": "extract_zip_files",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "zf.open()",
              "action_description": "Opens ZIP archive for reading",
              "action_id": "open_zip_read",
              "object": "\"cmake_example-0.0.1.dist-info/METADATA\"",
              "object_description": "ZIP archive file",
              "object_id": "zip_archive",
              "intention_description": "Open file for reading",
              "intention_id": "open_file_reading"
            },
            {
              "action_api": "f.read()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "str.decode()",
              "action_description": "Decodes bytes using specified codec",
              "action_id": "decode_bytes_codec",
              "object": "\"utf-8\"",
              "object_description": "Character encoding type",
              "object_id": "character_encoding_type",
              "intention_description": "Decode bytes to string",
              "intention_id": "decode_bytes_to_string"
            },
            {
              "action_api": "zf.open()",
              "action_description": "Opens ZIP archive for reading",
              "action_id": "open_zip_read",
              "object": "\"cmake_example-0.0.1.dist-info/entry_points.txt\"",
              "object_description": "ZIP archive file",
              "object_id": "zip_archive",
              "intention_description": "Open file for reading",
              "intention_id": "open_file_reading"
            },
            {
              "action_api": "f.read()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "str.decode()",
              "action_description": "Decodes bytes using specified codec",
              "action_id": "decode_bytes_codec",
              "object": "\"utf-8\"",
              "object_description": "Character encoding type",
              "object_id": "character_encoding_type",
              "intention_description": "Decode bytes to string",
              "intention_id": "decode_bytes_to_string"
            },
            {
              "action_api": "file_names.remove()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "\"cmake_example-0.0.1.dist-info\"",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "virtualenv.install()",
              "action_description": "Configures and initiates Python package installation",
              "action_id": "configure_package_install",
              "object": "wheel",
              "object_description": "ZIP archive file",
              "object_id": "zip_archive",
              "intention_description": "Install required Python package",
              "intention_id": "install_required_python_package"
            },
            {
              "action_api": "virtualenv.execute()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "\"import cmake_example; print(cmake_example.__version__)\"",
              "object_description": "Python command",
              "object_id": "python_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "str.strip()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "virtualenv.execute()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "\"import cmake_example; print(cmake_example.add(1, 2))\"",
              "object_description": "Python command",
              "object_id": "python_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "str.strip()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            }
          ]
        }
      ]
    }
  ]
}