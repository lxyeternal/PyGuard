{
  "metadata": {
    "package_name": "python_openstackclient-8",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/python_openstackclient-8.0.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "server.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/python_openstackclient-8.0.0/python_openstackclient-8.0.0/openstackclient/compute/v2/server.py",
      "line_number": "4258",
      "type_description": "B815:write",
      "context_snippet": "class RebootServer(command.Command):\n    _description = _(\"Perform a hard or soft server reboot\")\n\n    def get_parser(self, prog_name):\n        parser = super().get_parser(prog_name)\n        parser.add_argument(\n            'server',\n            metavar='<server>',\n            help=_('Server (name or ID)'),\n        )\n        group = parser.add_mutually_exclusive_group()\n        group.add_argument(\n            '--hard',\n            dest='reboot_type',\n            action='store_const',\n            const='HARD',\n            default='SOFT',\n            help=_('Perform a hard reboot'),\n        )\n        group.add_argument(\n            '--soft',\n            dest='reboot_type',\n            action='store_const',\n            const='SOFT',\n            default='SOFT',\n            help=_('Perform a soft reboot'),\n        )\n        parser.add_argument(\n            '--wait',\n            action='store_true',\n            help=_('Wait for reboot to complete'),\n        )\n        return parser\n\n    def take_action(self, parsed_args):\n        def _show_progress(progress):\n            if progress:\n                self.app.stdout.write(f'\\rProgress: {progress}')\n                self.app.stdout.flush()\n\n        compute_client = self.app.client_manager.compute\n        server_id = compute_client.find_server(\n            parsed_args.server,\n            ignore_missing=False,\n        ).id\n        compute_client.reboot_server(server_id, parsed_args.reboot_type)\n\n        if parsed_args.wait:\n            # We use osc-lib's wait_for_status since that allows for a callback\n            if utils.wait_for_status(\n                compute_client.get_server,\n                server_id,\n                callback=_show_progress,\n            ):\n                self.app.stdout.write(_('Complete\\n'))\n            else:\n                msg = _('Error rebooting server: %s') % server_id\n                raise exceptions.CommandError(msg)",
      "hash_value": "509fafd2b6572014a38906f653d7dafa",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "class RebootServer(command.Command):\n    _description = _(\"Perform a hard or soft server reboot\")\n\n    def get_parser(self, prog_name):\n        parser = super().get_parser(prog_name)\n        parser.add_argument(\n            'server',\n            metavar='<server>',\n            help=_('Server (name or ID)'),\n        )\n        group = parser.add_mutually_exclusive_group()\n        group.add_argument(\n            '--hard',\n            dest='reboot_type',\n            action='store_const',\n            const='HARD',\n            default='SOFT',\n            help=_('Perform a hard reboot'),\n        )\n        group.add_argument(\n            '--soft',\n            dest='reboot_type',\n            action='store_const',\n            const='SOFT',\n            default='SOFT',\n            help=_('Perform a soft reboot'),\n        )\n        parser.add_argument(\n            '--wait',\n            action='store_true',\n            help=_('Wait for reboot to complete'),\n        )\n        return parser\n\n    def take_action(self, parsed_args):\n        def _show_progress(progress):\n            if progress:\n                self.app.stdout.write(f'\\rProgress: {progress}')\n                self.app.stdout.flush()\n\n        compute_client = self.app.client_manager.compute\n        server_id = compute_client.find_server(\n            parsed_args.server,\n            ignore_missing=False,\n        ).id\n        compute_client.reboot_server(server_id, parsed_args.reboot_type)\n\n        if parsed_args.wait:\n            # We use osc-lib's wait_for_status since that allows for a callback\n            if utils.wait_for_status(\n                compute_client.get_server,\n                server_id,\n                callback=_show_progress,\n            ):\n                self.app.stdout.write(_('Complete\\n'))\n            else:\n                msg = _('Error rebooting server: %s') % server_id\n                raise exceptions.CommandError(msg)",
          "triple_sequences": [
            {
              "action_api": "parser.add_argument()",
              "action_description": "Adds argument to command-line parser",
              "action_id": "get_cmd_args",
              "object": "'server', metavar='<server>', help=_('Server (name or ID)')",
              "object_description": "Command-line arguments passed to script",
              "object_id": "cmd_args",
              "intention_description": "Access command line arguments",
              "intention_id": "access_command_line_arguments"
            },
            {
              "action_api": "parser.add_mutually_exclusive_group()",
              "action_description": "Creates mutually exclusive argument group in parser",
              "action_id": "get_cmd_args",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access command line arguments",
              "intention_id": "access_command_line_arguments"
            },
            {
              "action_api": "group.add_argument()",
              "action_description": "Adds argument to command-line parser",
              "action_id": "get_cmd_args",
              "object": "'--hard', dest='reboot_type', action='store_const', const='HARD', default='SOFT', help=_('Perform a hard reboot')",
              "object_description": "Command-line arguments passed to script",
              "object_id": "cmd_args",
              "intention_description": "Access command line arguments",
              "intention_id": "access_command_line_arguments"
            },
            {
              "action_api": "group.add_argument()",
              "action_description": "Adds argument to command-line parser",
              "action_id": "get_cmd_args",
              "object": "'--soft', dest='reboot_type', action='store_const', const='SOFT', default='SOFT', help=_('Perform a soft reboot')",
              "object_description": "Command-line arguments passed to script",
              "object_id": "cmd_args",
              "intention_description": "Access command line arguments",
              "intention_id": "access_command_line_arguments"
            },
            {
              "action_api": "parser.add_argument()",
              "action_description": "Adds argument to command-line parser",
              "action_id": "get_cmd_args",
              "object": "'--wait', action='store_true', help=_('Wait for reboot to complete')",
              "object_description": "Command-line arguments passed to script",
              "object_id": "cmd_args",
              "intention_description": "Access command line arguments",
              "intention_id": "access_command_line_arguments"
            },
            {
              "action_api": "self.app.stdout.write()",
              "action_description": "Writes data to standard output stream",
              "action_id": "get_stdout_stream",
              "object": "f'\\rProgress: {progress}'",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Collect command output",
              "intention_id": "collect_command_output"
            },
            {
              "action_api": "self.app.stdout.flush()",
              "action_description": "Flushes standard output stream",
              "action_id": "get_stdout_stream",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Collect command output",
              "intention_id": "collect_command_output"
            },
            {
              "action_api": "compute_client.find_server()",
              "action_description": "Retrieves server object by name or ID",
              "action_id": "get_process_info",
              "object": "parsed_args.server, ignore_missing=False",
              "object_description": "User process",
              "object_id": "user_process",
              "intention_description": "Collect process name",
              "intention_id": "collect_process_name"
            },
            {
              "action_api": "compute_client.reboot_server()",
              "action_description": "Executes server reboot operation",
              "action_id": "execute_shutdown_restart",
              "object": "server_id, parsed_args.reboot_type",
              "object_description": "Process ID",
              "object_id": "process_id",
              "intention_description": "Execute shutdown or restart",
              "intention_id": "execute_shutdown_restart"
            },
            {
              "action_api": "utils.wait_for_status()",
              "action_description": "Waits for process to complete execution",
              "action_id": "wait_process_completion",
              "object": "compute_client.get_server, server_id, callback=_show_progress",
              "object_description": "Process ID",
              "object_id": "process_id",
              "intention_description": "Wait for events",
              "intention_id": "wait_for_events"
            },
            {
              "action_api": "self.app.stdout.write()",
              "action_description": "Writes data to standard output stream",
              "action_id": "get_stdout_stream",
              "object": "_('Complete\\n')",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Collect command output",
              "intention_id": "collect_command_output"
            },
            {
              "action_api": "raise exceptions.CommandError()",
              "action_description": "Raises command error exception",
              "action_id": "raise_http_error",
              "object": "msg",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Stop execution on invalid input",
              "intention_id": "stop_execution_invalid_input"
            }
          ]
        }
      ]
    }
  ]
}