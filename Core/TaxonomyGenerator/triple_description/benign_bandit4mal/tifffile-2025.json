{
  "metadata": {
    "package_name": "tifffile-2025",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/tifffile-2025.3.30.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "test_tifffile.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/tifffile-2025.3.30/tifffile-2025.3.30/tests/test_tifffile.py",
      "line_number": "17906",
      "type_description": "B815:write",
      "context_snippet": "def test_issue_write_separated():\n    \"\"\"Test write SEPARATED colorspace.\"\"\"\n    # https://github.com/cgohlke/tifffile/issues/37\n    contig = random_data(numpy.uint8, (63, 95, 4))\n    separate = random_data(numpy.uint8, (4, 63, 95))\n    extrasample = random_data(numpy.uint8, (63, 95, 5))\n    with TempFileName('issue_write_separated') as fname:\n        with TiffWriter(fname) as tif:\n            tif.write(contig, photometric=PHOTOMETRIC.SEPARATED)\n            tif.write(separate, photometric=PHOTOMETRIC.SEPARATED)\n            tif.write(\n                extrasample,\n                photometric=PHOTOMETRIC.SEPARATED,\n                extrasamples=[1],\n            )\n        assert_valid_tiff(fname)\n        with TiffFile(fname) as tif:\n            assert len(tif.pages) == 3\n            assert len(tif.series) == 3\n            page = tif.pages.first\n            assert page.photometric == PHOTOMETRIC.SEPARATED\n            assert_array_equal(page.asarray(), contig)\n            page = tif.pages[1]\n            assert page.photometric == PHOTOMETRIC.SEPARATED\n            assert_array_equal(page.asarray(), separate)\n            page = tif.pages[2]\n            assert page.photometric == PHOTOMETRIC.SEPARATED\n            assert page.extrasamples == (1,)\n            assert_array_equal(page.asarray(), extrasample)",
      "hash_value": "32d4447ef4434f40c32d3e49bbe7bafc",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def test_issue_write_separated():\n    \"\"\"Test write SEPARATED colorspace.\"\"\"\n    # https://github.com/cgohlke/tifffile/issues/37\n    contig = random_data(numpy.uint8, (63, 95, 4))\n    separate = random_data(numpy.uint8, (4, 63, 95))\n    extrasample = random_data(numpy.uint8, (63, 95, 5))\n    with TempFileName('issue_write_separated') as fname:\n        with TiffWriter(fname) as tif:\n            tif.write(contig, photometric=PHOTOMETRIC.SEPARATED)\n            tif.write(separate, photometric=PHOTOMETRIC.SEPARATED)\n            tif.write(\n                extrasample,\n                photometric=PHOTOMETRIC.SEPARATED,\n                extrasamples=[1],\n            )\n        assert_valid_tiff(fname)\n        with TiffFile(fname) as tif:\n            assert len(tif.pages) == 3\n            assert len(tif.series) == 3\n            page = tif.pages.first\n            assert page.photometric == PHOTOMETRIC.SEPARATED\n            assert_array_equal(page.asarray(), contig)\n            page = tif.pages[1]\n            assert page.photometric == PHOTOMETRIC.SEPARATED\n            assert_array_equal(page.asarray(), separate)\n            page = tif.pages[2]\n            assert page.photometric == PHOTOMETRIC.SEPARATED\n            assert page.extrasamples == (1,)\n            assert_array_equal(page.asarray(), extrasample)",
          "triple_sequences": [
            {
              "action_api": "TempFileName()",
              "action_description": "Creates temporary file that is not deleted on close",
              "action_id": "create_temp_file",
              "object": "'issue_write_separated'",
              "object_description": "Temporary file path",
              "object_id": "temporary_file_path",
              "intention_description": "Create temporary file",
              "intention_id": "create_temporary_file"
            },
            {
              "action_api": "TiffWriter()",
              "action_description": "Opens file for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "fname",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "tif.write()",
              "action_description": "Saves image to file",
              "action_id": "save_image_file",
              "object": "contig, photometric=PHOTOMETRIC.SEPARATED",
              "object_description": "Image file",
              "object_id": "image_file",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "tif.write()",
              "action_description": "Saves image to file",
              "action_id": "save_image_file",
              "object": "separate, photometric=PHOTOMETRIC.SEPARATED",
              "object_description": "Image file",
              "object_id": "image_file",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "tif.write()",
              "action_description": "Saves image to file",
              "action_id": "save_image_file",
              "object": "extrasample, photometric=PHOTOMETRIC.SEPARATED, extrasamples=[1]",
              "object_description": "Image file",
              "object_id": "image_file",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "assert_valid_tiff()",
              "action_description": "Checks if specified path exists and is a file",
              "action_id": "check_file_is_file",
              "object": "fname",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "TiffFile()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "fname",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for reading",
              "intention_id": "open_file_reading"
            },
            {
              "action_api": "tif.pages.first",
              "action_description": "Retrieves value of attribute",
              "action_id": "access_attribute_value",
              "object": "tif.pages.first",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "page.photometric",
              "action_description": "Retrieves value of attribute",
              "action_id": "access_attribute_value",
              "object": "page.photometric",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "page.asarray()",
              "action_description": "Retrieves value of attribute",
              "action_id": "access_attribute_value",
              "object": "page.asarray()",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "assert_array_equal()",
              "action_description": "Checks if specified path exists and is a file",
              "action_id": "check_file_is_file",
              "object": "page.asarray(), contig",
              "object_description": "",
              "object_id": "",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "tif.pages[1]",
              "action_description": "Retrieves value of attribute",
              "action_id": "access_attribute_value",
              "object": "tif.pages[1]",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "page.photometric",
              "action_description": "Retrieves value of attribute",
              "action_id": "access_attribute_value",
              "object": "page.photometric",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "assert_array_equal()",
              "action_description": "Checks if specified path exists and is a file",
              "action_id": "check_file_is_file",
              "object": "page.asarray(), separate",
              "object_description": "",
              "object_id": "",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "tif.pages[2]",
              "action_description": "Retrieves value of attribute",
              "action_id": "access_attribute_value",
              "object": "tif.pages[2]",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "page.photometric",
              "action_description": "Retrieves value of attribute",
              "action_id": "access_attribute_value",
              "object": "page.photometric",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "page.extrasamples",
              "action_description": "Retrieves value of attribute",
              "action_id": "access_attribute_value",
              "object": "page.extrasamples",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "assert_array_equal()",
              "action_description": "Checks if specified path exists and is a file",
              "action_id": "check_file_is_file",
              "object": "page.asarray(), extrasample",
              "object_description": "",
              "object_id": "",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            }
          ]
        }
      ]
    }
  ]
}