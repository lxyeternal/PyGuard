{
  "metadata": {
    "package_name": "nipype-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/nipype-1.10.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "generate_classes.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/nipype-1.10.0/nipype-1.10.0/nipype/interfaces/slicer/generate_classes.py",
      "line_number": "47",
      "type_description": "B815:write",
      "context_snippet": "def add_class_to_package(class_codes, class_names, module_name, package_dir):\n    module_python_filename = os.path.join(package_dir, \"%s.py\" % module_name)\n    with open(module_python_filename, \"w\") as f_m:\n        f_m.write(\n            \"\"\"# -*- coding: utf-8 -*-\\n\\\"\\\"\\\"Autogenerated file - DO NOT EDIT\\nIf you spot a bug, please report it on the mailing list and/or change the generator.\\\"\\\"\\\"\\n\\n\"\"\"\n        )\n        imports = \"\"\"\\\nfrom ..base import (CommandLine, CommandLineInputSpec, SEMLikeCommandLine, TraitedSpec,\n                    File, Directory, traits, isdefined, InputMultiPath, OutputMultiPath)\nimport os\\n\\n\\n\"\"\"\n        f_m.write(imports)\n        f_m.write(\"\\n\\n\".join(class_codes))\n    with open(os.path.join(package_dir, \"__init__.py\"), \"a+\") as f_i:\n        f_i.write(\"from {} import {}\\n\".format(module_name, \", \".join(class_names)))",
      "hash_value": "e96909c5e353f31febdf2f315d6ee814",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def add_class_to_package(class_codes, class_names, module_name, package_dir):\n    module_python_filename = os.path.join(package_dir, \"%s.py\" % module_name)\n    with open(module_python_filename, \"w\") as f_m:\n        f_m.write(\n            \"\"\"# -*- coding: utf-8 -*-\\n\\\"\\\"\\\"Autogenerated file - DO NOT EDIT\\nIf you spot a bug, please report it on the mailing list and/or change the generator.\\\"\\\"\\\"\\n\\n\"\"\"\n        )\n        imports = \"\"\"\\\nfrom ..base import (CommandLine, CommandLineInputSpec, SEMLikeCommandLine, TraitedSpec,\n                    File, Directory, traits, isdefined, InputMultiPath, OutputMultiPath)\nimport os\\n\\n\\n\"\"\"\n        f_m.write(imports)\n        f_m.write(\"\\n\\n\".join(class_codes))\n    with open(os.path.join(package_dir, \"__init__.py\"), \"a+\") as f_i:\n        f_i.write(\"from {} import {}\\n\".format(module_name, \", \".join(class_names)))",
          "triple_sequences": [
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "package_dir, \"%s.py\" % module_name",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "module_python_filename, \"w\"",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"\"\"# -*- coding: utf-8 -*-\\n\\\"\\\"\\\"Autogenerated file - DO NOT EDIT\\nIf you spot a bug, please report it on the mailing list and/or change the generator.\\\"\\\"\\\"\\n\\n\"\"\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "imports",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "str.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "\"\\n\\n\", class_codes",
              "object_description": "Character code array",
              "object_id": "character_code_array",
              "intention_description": "Join characters into string",
              "intention_id": "join_characters_into_string"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "str.join(\"\\n\\n\", class_codes)",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "package_dir, \"__init__.py\"",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "os.path.join(package_dir, \"__init__.py\"), \"a+\"",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "str.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "\", \".join(class_names)",
              "object_description": "Character code array",
              "object_id": "character_code_array",
              "intention_description": "Join characters into string",
              "intention_id": "join_characters_into_string"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"from {} import {}\\n\".format(module_name, \", \".join(class_names))",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            }
          ]
        }
      ]
    }
  ]
}