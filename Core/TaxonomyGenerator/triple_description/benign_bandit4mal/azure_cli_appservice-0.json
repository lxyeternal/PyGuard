{
  "metadata": {
    "package_name": "azure_cli_appservice-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/azure_cli_appservice-0.2.21-py2.py3-none-any.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "custom.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/azure_cli_appservice-0.2.21-py2.py3-none-any/azure/cli/command_modules/appservice/custom.py",
      "line_number": "1700",
      "type_description": "B830:read",
      "context_snippet": "def get_streaming_log(cmd, resource_group_name, name, provider=None, slot=None):\n    scm_url = _get_scm_url(cmd, resource_group_name, name, slot)\n    streaming_url = scm_url + '/logstream'\n    if provider:\n        streaming_url += ('/' + provider.lstrip('/'))\n\n    user, password = _get_site_credential(cmd.cli_ctx, resource_group_name, name, slot)\n    t = threading.Thread(target=_get_log, args=(streaming_url, user, password))\n    t.daemon = True\n    t.start()\n\n    while True:\n        time.sleep(100)  # so that ctrl+c can stop the command\n",
      "hash_value": "abb13739b26af8b3146dacb5792afe95",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def get_streaming_log(cmd, resource_group_name, name, provider=None, slot=None):\n    scm_url = _get_scm_url(cmd, resource_group_name, name, slot)\n    streaming_url = scm_url + '/logstream'\n    if provider:\n        streaming_url += ('/' + provider.lstrip('/'))\n\n    user, password = _get_site_credential(cmd.cli_ctx, resource_group_name, name, slot)\n    t = threading.Thread(target=_get_log, args=(streaming_url, user, password))\n    t.daemon = True\n    t.start()\n\n    while True:\n        time.sleep(100)  # so that ctrl+c can stop the command\n",
          "triple_sequences": [
            {
              "action_api": "_get_scm_url()",
              "action_description": "Retrieves operating system identifier",
              "action_id": "get_os_id",
              "object": "cmd, resource_group_name, name, slot",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare path for file operations",
              "intention_id": "prepare_path_file_operations"
            },
            {
              "action_api": "_get_site_credential()",
              "action_description": "Retrieves operating system identifier",
              "action_id": "get_os_id",
              "object": "cmd.cli_ctx, resource_group_name, name, slot",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "threading.Thread()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "target=_get_log, args=(streaming_url, user, password)",
              "object_description": "Thread target and arguments",
              "object_id": "thread_target_arguments",
              "intention_description": "Run function in thread pool",
              "intention_id": "run_function_thread_pool"
            },
            {
              "action_api": "t.start()",
              "action_description": "Starts thread execution",
              "action_id": "start_thread",
              "object": "t",
              "object_description": "",
              "object_id": "",
              "intention_description": "Run function in thread pool",
              "intention_id": "run_function_thread_pool"
            },
            {
              "action_api": "time.sleep()",
              "action_description": "Suspends execution",
              "action_id": "suspend_execution",
              "object": "100",
              "object_description": "Delay duration in seconds",
              "object_id": "delay_duration",
              "intention_description": "Pause execution",
              "intention_id": "pause_execution"
            }
          ]
        }
      ]
    }
  ]
}