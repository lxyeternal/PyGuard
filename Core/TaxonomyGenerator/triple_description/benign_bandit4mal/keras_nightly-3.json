{
  "metadata": {
    "package_name": "keras_nightly-3",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/keras_nightly-3.9.0.dev2025032003.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "saving_lib.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/keras_nightly-3.9.0.dev2025032003/keras_nightly-3.9.0.dev2025032003/keras/src/saving/saving_lib.py",
      "line_number": "168",
      "type_description": "B815:write",
      "context_snippet": "def _save_model_to_dir(model, dirpath, weights_format):\n    if not file_utils.exists(dirpath):\n        file_utils.makedirs(dirpath)\n    config_json, metadata_json = _serialize_model_as_json(model)\n    with open(file_utils.join(dirpath, _METADATA_FILENAME), \"w\") as f:\n        f.write(metadata_json)\n    with open(file_utils.join(dirpath, _CONFIG_FILENAME), \"w\") as f:\n        f.write(config_json)\n    weights_filepath = file_utils.join(dirpath, _VARS_FNAME_H5)\n    assert_dirpath = file_utils.join(dirpath, _ASSETS_DIRNAME)\n    try:\n        if weights_format == \"h5\":\n            weights_store = H5IOStore(weights_filepath, mode=\"w\")\n        elif weights_format == \"npz\":\n            weights_store = NpzIOStore(weights_filepath, mode=\"w\")\n        else:\n            raise ValueError(\n                \"Unknown `weights_format` argument. \"\n                \"Expected 'h5' or 'npz'. \"\n                f\"Received: weights_format={weights_format}\"\n            )\n        asset_store = DiskIOStore(assert_dirpath, mode=\"w\")\n        _save_state(\n            model,\n            weights_store=weights_store,\n            assets_store=asset_store,\n            inner_path=\"\",\n            visited_saveables=set(),\n        )\n    finally:\n        weights_store.close()\n        asset_store.close()",
      "hash_value": "1b4eb9d1858890e236d49c15d8970362",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def _save_model_to_dir(model, dirpath, weights_format):\n    if not file_utils.exists(dirpath):\n        file_utils.makedirs(dirpath)\n    config_json, metadata_json = _serialize_model_as_json(model)\n    with open(file_utils.join(dirpath, _METADATA_FILENAME), \"w\") as f:\n        f.write(metadata_json)\n    with open(file_utils.join(dirpath, _CONFIG_FILENAME), \"w\") as f:\n        f.write(config_json)\n    weights_filepath = file_utils.join(dirpath, _VARS_FNAME_H5)\n    assert_dirpath = file_utils.join(dirpath, _ASSETS_DIRNAME)\n    try:\n        if weights_format == \"h5\":\n            weights_store = H5IOStore(weights_filepath, mode=\"w\")\n        elif weights_format == \"npz\":\n            weights_store = NpzIOStore(weights_filepath, mode=\"w\")\n        else:\n            raise ValueError(\n                \"Unknown `weights_format` argument. \"\n                \"Expected 'h5' or 'npz'. \"\n                f\"Received: weights_format={weights_format}\"\n            )\n        asset_store = DiskIOStore(assert_dirpath, mode=\"w\")\n        _save_state(\n            model,\n            weights_store=weights_store,\n            assets_store=asset_store,\n            inner_path=\"\",\n            visited_saveables=set(),\n        )\n    finally:\n        weights_store.close()\n        asset_store.close()",
          "triple_sequences": [
            {
              "action_api": "file_utils.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "dirpath",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "file_utils.makedirs()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "dirpath",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "_serialize_model_as_json()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "model",
              "object_description": "",
              "object_id": "",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "file_utils.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "dirpath, _METADATA_FILENAME",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "file_utils.join(dirpath, _METADATA_FILENAME), \"w\"",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "metadata_json",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file_utils.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "dirpath, _CONFIG_FILENAME",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "file_utils.join(dirpath, _CONFIG_FILENAME), \"w\"",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "config_json",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file_utils.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "dirpath, _VARS_FNAME_H5",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "file_utils.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "dirpath, _ASSETS_DIRNAME",
              "object_description": "Directory path and temporary directory",
              "object_id": "directory_path_with_temp",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "H5IOStore()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "weights_filepath, mode=\"w\"",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "NpzIOStore()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "weights_filepath, mode=\"w\"",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "DiskIOStore()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "assert_dirpath, mode=\"w\"",
              "object_description": "Directory path and temporary directory",
              "object_id": "directory_path_with_temp",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "_save_state()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "model, weights_store, assets_store, inner_path=\"\", visited_saveables=set()",
              "object_description": "",
              "object_id": "",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "weights_store.close()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "weights_store",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close file",
              "intention_id": "close_file"
            },
            {
              "action_api": "asset_store.close()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "asset_store",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close file",
              "intention_id": "close_file"
            }
          ]
        }
      ]
    }
  ]
}