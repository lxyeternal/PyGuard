{
  "metadata": {
    "package_name": "cos_python_sdk_v5-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/cos_python_sdk_v5-1.9.36.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "cos_client.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/cos_python_sdk_v5-1.9.36/cos_python_sdk_v5-1.9.36/qcloud_cos/cos_client.py",
      "line_number": "3573",
      "type_description": "B822:request",
      "context_snippet": "def list_objects(self, Bucket, Prefix=\"\", Delimiter=\"\", Marker=\"\", MaxKeys=1000, EncodingType=\"\", **kwargs):\n    \"\"\"获取文件列表\n\n    :param Bucket(string): 存储桶名称.\n    :param Prefix(string): 设置匹配文件的前缀.\n    :param Delimiter(string): 分隔符.\n    :param Marker(string): 从marker开始列出条目.\n    :param MaxKeys(int): 设置单次返回最大的数量,最大为1000.\n    :param EncodingType(string): 设置返回结果编码方式,只能设置为url.\n    :param kwargs(dict): 设置请求headers.\n    :return(dict): 文件的相关信息，包括Etag等信息.\n\n    .. code-block:: python\n\n        config = CosConfig(Region=region, SecretId=secret_id, SecretKey=secret_key, Token=token)  # 获取配置对象\n        client = CosS3Client(config)\n        # 列出bucket\n        response = client.list_objects(\n            Bucket='bucket',\n            MaxKeys=100,\n            Prefix='中文',\n            Delimiter='/'\n        )\n    \"\"\"\n    decodeflag = True  # 是否需要对结果进行decode\n    headers = mapped(kwargs)\n    url = self._conf.uri(bucket=Bucket)\n    logger.info(\"list objects, url=:{url} ,headers=:{headers}\".format(\n        url=url,\n        headers=headers))\n    params = {\n        'prefix': Prefix,\n        'delimiter': Delimiter,\n        'marker': Marker,\n        'max-keys': MaxKeys\n    }\n    if EncodingType:\n        if EncodingType != 'url':\n            raise CosClientError('EncodingType must be url')\n        decodeflag = False  # 用户自己设置了EncodingType不需要去decode\n        params['encoding-type'] = EncodingType\n    else:\n        params['encoding-type'] = 'url'\n    params = format_values(params)\n    rt = self.send_request(\n        method='GET',\n        url=url,\n        bucket=Bucket,\n        params=params,\n        headers=headers,\n        auth=CosS3Auth(self._conf, params=params))\n    data = xml_to_dict(rt.content)\n    format_dict(data, ['Contents', 'CommonPrefixes'])\n    if decodeflag:\n        decode_result(\n            data,\n            [\n                'Prefix',\n                'Marker',\n                'NextMarker'\n            ],\n            [\n                ['Contents', 'Key'],\n                ['CommonPrefixes', 'Prefix']\n            ]\n        )\n    return data",
      "hash_value": "96b956b2d2f20ed9f16a99a70c35f783",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def list_objects(self, Bucket, Prefix=\"\", Delimiter=\"\", Marker=\"\", MaxKeys=1000, EncodingType=\"\", **kwargs):\n    \"\"\"获取文件列表\n\n    :param Bucket(string): 存储桶名称.\n    :param Prefix(string): 设置匹配文件的前缀.\n    :param Delimiter(string): 分隔符.\n    :param Marker(string): 从marker开始列出条目.\n    :param MaxKeys(int): 设置单次返回最大的数量,最大为1000.\n    :param EncodingType(string): 设置返回结果编码方式,只能设置为url.\n    :param kwargs(dict): 设置请求headers.\n    :return(dict): 文件的相关信息，包括Etag等信息.\n\n    .. code-block:: python\n\n        config = CosConfig(Region=region, SecretId=secret_id, SecretKey=secret_key, Token=token)  # 获取配置对象\n        client = CosS3Client(config)\n        # 列出bucket\n        response = client.list_objects(\n            Bucket='bucket',\n            MaxKeys=100,\n            Prefix='中文',\n            Delimiter='/'\n        )\n    \"\"\"\n    decodeflag = True  # 是否需要对结果进行decode\n    headers = mapped(kwargs)\n    url = self._conf.uri(bucket=Bucket)\n    logger.info(\"list objects, url=:{url} ,headers=:{headers}\".format(\n        url=url,\n        headers=headers))\n    params = {\n        'prefix': Prefix,\n        'delimiter': Delimiter,\n        'marker': Marker,\n        'max-keys': MaxKeys\n    }\n    if EncodingType:\n        if EncodingType != 'url':\n            raise CosClientError('EncodingType must be url')\n        decodeflag = False  # 用户自己设置了EncodingType不需要去decode\n        params['encoding-type'] = EncodingType\n    else:\n        params['encoding-type'] = 'url'\n    params = format_values(params)\n    rt = self.send_request(\n        method='GET',\n        url=url,\n        bucket=Bucket,\n        params=params,\n        headers=headers,\n        auth=CosS3Auth(self._conf, params=params))\n    data = xml_to_dict(rt.content)\n    format_dict(data, ['Contents', 'CommonPrefixes'])\n    if decodeflag:\n        decode_result(\n            data,\n            [\n                'Prefix',\n                'Marker',\n                'NextMarker'\n            ],\n            [\n                ['Contents', 'Key'],\n                ['CommonPrefixes', 'Prefix']\n            ]\n        )\n    return data",
          "triple_sequences": [
            {
              "action_api": "self._conf.uri()",
              "action_description": "Path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "bucket=Bucket",
              "object_description": "Bucket name string",
              "object_id": "",
              "intention_description": "Prepare directory path",
              "intention_id": "prepare_directory_path"
            },
            {
              "action_api": "logger.info()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "\"list objects, url=:{url} ,headers=:{headers}\".format(url=url, headers=headers)",
              "object_description": "Log message text",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "format_values()",
              "action_description": "Path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "params",
              "object_description": "Dictionary containing request parameters",
              "object_id": "",
              "intention_description": "Prepare data processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "self.send_request()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "method='GET', url=url, bucket=Bucket, params=params, headers=headers, auth=CosS3Auth(self._conf, params=params)",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "xml_to_dict()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "rt.content",
              "object_description": "HTTP response content from remote server",
              "object_id": "http_response_remote_content",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "format_dict()",
              "action_description": "Path object and status operations (creating Path objects, retrieving file status)",
              "action_id": "path_object_operations",
              "object": "data, ['Contents', 'CommonPrefixes']",
              "object_description": "Dictionary containing file list and common prefixes",
              "object_id": "",
              "intention_description": "Prepare data processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "decode_result()",
              "action_description": "Decode obfuscated data",
              "action_id": "decode_obfuscated_data",
              "object": "data, ['Prefix', 'Marker', 'NextMarker'], [['Contents', 'Key'], ['CommonPrefixes', 'Prefix']]",
              "object_description": "Decoded obfuscated data",
              "object_id": "decoded_obfuscated_data",
              "intention_description": "Decode obfuscated data",
              "intention_id": "decode_obfuscated_data"
            }
          ]
        }
      ]
    }
  ]
}