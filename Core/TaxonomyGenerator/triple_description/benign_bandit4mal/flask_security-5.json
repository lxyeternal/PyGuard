{
  "metadata": {
    "package_name": "flask_security-5",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/flask_security-5.6.1.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "test_context_processors.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/flask_security-5.6.1/flask_security-5.6.1/tests/test_context_processors.py",
      "line_number": "222",
      "type_description": "B820:get",
      "context_snippet": "@pytest.mark.unified_signin()\n@pytest.mark.settings(\n    us_setup_template=\"custom_security/us_setup.html\",\n    us_signin_template=\"custom_security/us_signin.html\",\n    us_verify_template=\"custom_security/us_verify.html\",\n)\ndef test_unified_signin_context_processors(client, app):\n    @app.security.context_processor\n    def default_ctx_processor():\n        return {\"global\": \"global\"}\n\n    @app.security.us_signin_context_processor\n    def signin_ctx():\n        return {\"foo\": \"signin\"}\n\n    # signin template is used in 3 places (TODO test POST us-send-code)\n    response = client.get(\"/us-signin\")\n    assert b\"CUSTOM UNIFIED SIGN IN\" in response.data\n    assert b\"global\" in response.data\n    assert b\"signin\" in response.data\n\n    response = client.post(\"/us-signin/send-code\")\n    assert b\"CUSTOM UNIFIED SIGN IN\" in response.data\n    assert b\"global\" in response.data\n    assert b\"signin\" in response.data\n\n    @app.security.us_setup_context_processor\n    def setup_ctx():\n        return {\"foo\": \"setup\"}\n\n    us_authenticate(client)\n    response = client.get(\"us-setup\")\n    assert b\"CUSTOM UNIFIED SIGNIN SETUP\" in response.data\n    assert b\"global\" in response.data\n    assert b\"setup\" in response.data\n\n    response = client.post(\"us-setup\", data=dict(chosen_method=\"sms\", phone=\"555-1212\"))\n    assert b\"CUSTOM UNIFIED SIGNIN SETUP\" in response.data\n    assert b\"global\" in response.data\n    assert b\"setup\" in response.data\n\n    @app.security.us_verify_context_processor\n    def verify_ctx():\n        return {\"foo\": \"setup\"}\n\n    us_authenticate(client)\n    response = client.get(\"us-verify\")\n    assert b\"CUSTOM UNIFIED VERIFY\" in response.data\n    assert b\"global\" in response.data\n    assert b\"setup\" in response.data\n\n    response = client.post(\n        \"us-verify\", data=dict(chosen_method=\"sms\", phone=\"555-1212\")\n    )\n    assert b\"CUSTOM UNIFIED VERIFY\" in response.data\n    assert b\"global\" in response.data\n    assert b\"setup\" in response.data\n",
      "hash_value": "4083797e04e5c9e4fa7acd1e9d66b2c1",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "@pytest.mark.unified_signin()\n@pytest.mark.settings(\n    us_setup_template=\"custom_security/us_setup.html\",\n    us_signin_template=\"custom_security/us_signin.html\",\n    us_verify_template=\"custom_security/us_verify.html\",\n)\ndef test_unified_signin_context_processors(client, app):\n    @app.security.context_processor\n    def default_ctx_processor():\n        return {\"global\": \"global\"}\n\n    @app.security.us_signin_context_processor\n    def signin_ctx():\n        return {\"foo\": \"signin\"}\n\n    # signin template is used in 3 places (TODO test POST us-send-code)\n    response = client.get(\"/us-signin\")\n    assert b\"CUSTOM UNIFIED SIGN IN\" in response.data\n    assert b\"global\" in response.data\n    assert b\"signin\" in response.data\n\n    response = client.post(\"/us-signin/send-code\")\n    assert b\"CUSTOM UNIFIED SIGN IN\" in response.data\n    assert b\"global\" in response.data\n    assert b\"signin\" in response.data\n\n    @app.security.us_setup_context_processor\n    def setup_ctx():\n        return {\"foo\": \"setup\"}\n\n    us_authenticate(client)\n    response = client.get(\"us-setup\")\n    assert b\"CUSTOM UNIFIED SIGNIN SETUP\" in response.data\n    assert b\"global\" in response.data\n    assert b\"setup\" in response.data\n\n    response = client.post(\"us-setup\", data=dict(chosen_method=\"sms\", phone=\"555-1212\"))\n    assert b\"CUSTOM UNIFIED SIGNIN SETUP\" in response.data\n    assert b\"global\" in response.data\n    assert b\"setup\" in response.data\n\n    @app.security.us_verify_context_processor\n    def verify_ctx():\n        return {\"foo\": \"setup\"}\n\n    us_authenticate(client)\n    response = client.get(\"us-verify\")\n    assert b\"CUSTOM UNIFIED VERIFY\" in response.data\n    assert b\"global\" in response.data\n    assert b\"setup\" in response.data\n\n    response = client.post(\n        \"us-verify\", data=dict(chosen_method=\"sms\", phone=\"555-1212\")\n    )\n    assert b\"CUSTOM UNIFIED VERIFY\" in response.data\n    assert b\"global\" in response.data\n    assert b\"setup\" in response.data\n",
          "triple_sequences": [
            {
              "action_api": "client.get()",
              "action_description": "Opens URL with GET parameters",
              "action_id": "open_url_get",
              "object": "/us-signin",
              "object_description": "URL string",
              "object_id": "url_string",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "client.post()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "/us-signin/send-code",
              "object_description": "URL string",
              "object_id": "url_string",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "client.get()",
              "action_description": "Opens URL with GET parameters",
              "action_id": "open_url_get",
              "object": "us-setup",
              "object_description": "URL string",
              "object_id": "url_string",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "client.post()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "us-setup",
              "object_description": "URL string",
              "object_id": "url_string",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "client.get()",
              "action_description": "Opens URL with GET parameters",
              "action_id": "open_url_get",
              "object": "us-verify",
              "object_description": "URL string",
              "object_id": "url_string",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "client.post()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "us-verify",
              "object_description": "URL string",
              "object_id": "url_string",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            }
          ]
        }
      ]
    }
  ]
}