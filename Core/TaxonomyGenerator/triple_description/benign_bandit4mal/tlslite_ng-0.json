{
  "metadata": {
    "package_name": "tlslite_ng-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/tlslite_ng-0.8.2.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "tlstest.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/tlslite_ng-0.8.2/tlslite_ng-0.8.2/tests/tlstest.py",
      "line_number": "949",
      "type_description": "B807:close",
      "context_snippet": "def clientTestCmd(argv):\n\n    address = argv[0]\n    dir = argv[1]\n\n    #Split address into hostname/port tuple\n    address = address.split(\":\")\n    address = ( address[0], int(address[1]) )\n\n    #open synchronisation FIFO\n    synchro = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    synchro.settimeout(60)\n    synchro.connect((address[0], address[1]-1))\n\n    def connect():\n        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n        sock.settimeout(15)\n        sock.connect(address)\n        c = TLSConnection(sock)\n        return c\n\n    test_no = 0\n\n    badFault = False\n\n    print(\"Test {0} - anonymous handshake\".format(test_no))\n    synchro.recv(1)\n    connection = connect()\n    settings = HandshakeSettings()\n    settings.maxVersion = (3, 3)\n    connection.handshakeClientAnonymous(settings=settings)\n    testConnClient(connection)\n    connection.close()\n\n    # ... (function continues for hundreds of lines, with repeated usage of connection.close())\n",
      "hash_value": "39e56ec316660b54be93a9e9da6e2972",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def clientTestCmd(argv):\n\n    address = argv[0]\n    dir = argv[1]\n\n    #Split address into hostname/port tuple\n    address = address.split(\":\")\n    address = ( address[0], int(address[1]) )\n\n    #open synchronisation FIFO\n    synchro = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    synchro.settimeout(60)\n    synchro.connect((address[0], address[1]-1))\n\n    def connect():\n        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n        sock.settimeout(15)\n        sock.connect(address)\n        c = TLSConnection(sock)\n        return c\n\n    test_no = 0\n\n    badFault = False\n\n    print(\"Test {0} - anonymous handshake\".format(test_no))\n    synchro.recv(1)\n    connection = connect()\n    settings = HandshakeSettings()\n    settings.maxVersion = (3, 3)\n    connection.handshakeClientAnonymous(settings=settings)\n    testConnClient(connection)\n    connection.close()\n\n    # ... (function continues for hundreds of lines, with repeated usage of connection.close())\n",
          "triple_sequences": [
            {
              "action_api": "socket.socket()",
              "action_description": "Creates new socket object",
              "action_id": "create_socket",
              "object": "socket.AF_INET, socket.SOCK_STREAM",
              "object_description": "Socket address",
              "object_id": "socket_address",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "socket.settimeout()",
              "action_description": "Sets timeout for socket operations",
              "action_id": "set_socket_timeout",
              "object": "60",
              "object_description": "Timeout duration value",
              "object_id": "timeout_value",
              "intention_description": "Delay next operation",
              "intention_id": "delay_next_operation"
            },
            {
              "action_api": "socket.connect()",
              "action_description": "Establishes TCP connection to specified address",
              "action_id": "establish_tcp_connection",
              "object": "(address[0], address[1]-1)",
              "object_description": "Socket address",
              "object_id": "socket_address",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "socket.socket()",
              "action_description": "Creates new socket object",
              "action_id": "create_socket",
              "object": "socket.AF_INET, socket.SOCK_STREAM",
              "object_description": "Socket address",
              "object_id": "socket_address",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "socket.settimeout()",
              "action_description": "Sets timeout for socket operations",
              "action_id": "set_socket_timeout",
              "object": "15",
              "object_description": "Timeout duration value",
              "object_id": "timeout_value",
              "intention_description": "Delay next operation",
              "intention_id": "delay_next_operation"
            },
            {
              "action_api": "socket.connect()",
              "action_description": "Establishes TCP connection to specified address",
              "action_id": "establish_tcp_connection",
              "object": "address",
              "object_description": "Socket address",
              "object_id": "socket_address",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "TLSConnection()",
              "action_description": "Wraps socket for SSL/TLS communication",
              "action_id": "wrap_socket_ssl",
              "object": "sock",
              "object_description": "Socket address",
              "object_id": "socket_address",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "synchro.recv()",
              "action_description": "Receives data from socket connection",
              "action_id": "receive_socket_data",
              "object": "1",
              "object_description": "Timeout duration value",
              "object_id": "timeout_value",
              "intention_description": "Wait for events",
              "intention_id": "wait_for_events"
            },
            {
              "action_api": "connection.handshakeClientAnonymous()",
              "action_description": "Creates HTTP session for making asynchronous requests",
              "action_id": "create_http_session",
              "object": "settings=settings",
              "object_description": "",
              "object_id": "",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "testConnClient()",
              "action_description": "Creates asynchronous task",
              "action_id": "create_async_task",
              "object": "connection",
              "object_description": "Socket address",
              "object_id": "socket_address",
              "intention_description": "Trigger main behavioral logic",
              "intention_id": "trigger_main_behavioral_logic"
            },
            {
              "action_api": "connection.close()",
              "action_description": "Closes the socket connection",
              "action_id": "close_socket",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Release connection resource",
              "intention_id": "release_connection_resource"
            }
          ]
        }
      ]
    }
  ]
}