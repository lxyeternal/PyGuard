{
  "metadata": {
    "package_name": "subprocrunner-2",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/subprocrunner-2.0.1.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "test_subproc_runner.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/subprocrunner-2.0.1/subprocrunner-2.0.1/test/test_subproc_runner.py",
      "line_number": "294",
      "type_description": "B812:system",
      "context_snippet": "@pytest.mark.skipif(platform.system() == \"Windows\", reason=\"platform dependent tests\")\n@pytest.mark.parametrize([\"command\", \"pipe_input\", \"expected\"], [[\"grep a\", b\"aaa\", 0]])\ndef test_normal_stdin(self, command, pipe_input, expected):\n    proc = SubprocessRunner(command).popen(PIPE)\n    assert isinstance(proc, subprocess.Popen)\n    ret_stdout, ret_stderr = proc.communicate(input=pipe_input)\n\n    assert is_not_null_string(ret_stdout)\n    assert is_null_string(ret_stderr)\n    assert proc.returncode == expected",
      "hash_value": "225c26d280df9e1906ffe0b1c12e2a6a",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "@pytest.mark.skipif(platform.system() == \"Windows\", reason=\"platform dependent tests\")\n@pytest.mark.parametrize([\"command\", \"pipe_input\", \"expected\"], [[\"grep a\", b\"aaa\", 0]])\ndef test_normal_stdin(self, command, pipe_input, expected):\n    proc = SubprocessRunner(command).popen(PIPE)\n    assert isinstance(proc, subprocess.Popen)\n    ret_stdout, ret_stderr = proc.communicate(input=pipe_input)\n\n    assert is_not_null_string(ret_stdout)\n    assert is_null_string(ret_stderr)\n    assert proc.returncode == expected",
          "triple_sequences": [
            {
              "action_api": "platform.system()",
              "action_description": "Retrieves operating system identifier",
              "action_id": "get_os_id",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Determine operating system",
              "intention_id": "get_operating_system_name"
            },
            {
              "action_api": "SubprocessRunner().popen()",
              "action_description": "Spawns new process to execute command without shell access",
              "action_id": "spawn_process_no_shell",
              "object": "grep a",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Create child process",
              "intention_id": "create_child_process"
            },
            {
              "action_api": "isinstance()",
              "action_description": "Checks if object is instance of specified type",
              "action_id": "check_instance_type",
              "object": "proc, subprocess.Popen",
              "object_description": "System process",
              "object_id": "system_process",
              "intention_description": "Determine_required_module_presence",
              "intention_id": "determine_required_module_presence"
            },
            {
              "action_api": "proc.communicate()",
              "action_description": "Reads all bytes from process standard output",
              "action_id": "read_process_stdout",
              "object": "pipe_input: b\"aaa\"",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Collect command output",
              "intention_id": "collect_command_output"
            }
          ]
        }
      ]
    }
  ]
}