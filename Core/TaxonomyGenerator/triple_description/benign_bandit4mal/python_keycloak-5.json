{
  "metadata": {
    "package_name": "python_keycloak-5",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/python_keycloak-5.5.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "keycloak_admin.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/python_keycloak-5.5.0/python_keycloak-5.5.0/src/keycloak/keycloak_admin.py",
      "line_number": "1789",
      "type_description": "B820:get",
      "context_snippet": "def get_group(self, group_id: str, full_hierarchy: bool = False) -> dict:\n    \"\"\"\n    Get group by id.\n\n    Returns full group details\n\n    GroupRepresentation\n    https://www.keycloak.org/docs-api/24.0.2/rest-api/#_grouprepresentation\n\n    :param group_id: The group id\n    :type group_id: str\n    :param full_hierarchy: If True, return all of the nested children groups, otherwise only\n        the first level children are returned\n    :type full_hierarchy: bool\n    :return: Keycloak server response (GroupRepresentation)\n    :rtype: dict\n    \"\"\"\n    params_path = {\"realm-name\": self.connection.realm_name, \"id\": group_id}\n    response = self.connection.raw_get(urls_patterns.URL_ADMIN_GROUP.format(**params_path))\n\n    if response.status_code >= HTTP_BAD_REQUEST:\n        return raise_error_from_response(response, KeycloakGetError)\n\n    # For version +23.0.0\n    group = response.json()\n    if group.get(\"subGroupCount\"):\n        group[\"subGroups\"] = self.get_group_children(\n            group.get(\"id\"),\n            full_hierarchy=full_hierarchy,\n        )\n\n    return group",
      "hash_value": "f7f094c725f70fb46ce6fa7c9ae3e807",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def get_group(self, group_id: str, full_hierarchy: bool = False) -> dict:\n    \"\"\"\n    Get group by id.\n\n    Returns full group details\n\n    GroupRepresentation\n    https://www.keycloak.org/docs-api/24.0.2/rest-api/#_grouprepresentation\n\n    :param group_id: The group id\n    :type group_id: str\n    :param full_hierarchy: If True, return all of the nested children groups, otherwise only\n        the first level children are returned\n    :type full_hierarchy: bool\n    :return: Keycloak server response (GroupRepresentation)\n    :rtype: dict\n    \"\"\"\n    params_path = {\"realm-name\": self.connection.realm_name, \"id\": group_id}\n    response = self.connection.raw_get(urls_patterns.URL_ADMIN_GROUP.format(**params_path))\n\n    if response.status_code >= HTTP_BAD_REQUEST:\n        return raise_error_from_response(response, KeycloakGetError)\n\n    # For version +23.0.0\n    group = response.json()\n    if group.get(\"subGroupCount\"):\n        group[\"subGroups\"] = self.get_group_children(\n            group.get(\"id\"),\n            full_hierarchy=full_hierarchy,\n        )\n\n    return group",
          "triple_sequences": [
            {
              "action_api": "self.connection.raw_get()",
              "action_description": "Sends HTTP GET request to URL",
              "action_id": "open_url_get",
              "object": "urls_patterns.URL_ADMIN_GROUP.format(**params_path)",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "response.status_code",
              "action_description": "Retrieves HTTP response status code",
              "action_id": "get_http_status",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "raise_error_from_response()",
              "action_description": "Raises HTTPError if response status code indicates error",
              "action_id": "raise_http_error",
              "object": "response, KeycloakGetError",
              "object_description": "HTTP response content from remote server",
              "object_id": "http_response_remote_content",
              "intention_description": "Terminate program execution",
              "intention_id": "terminate_program_execution"
            },
            {
              "action_api": "response.json()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "group.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"subGroupCount\"",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "self.get_group_children()",
              "action_description": "Dynamically imports specified module",
              "action_id": "import_dynamic",
              "object": "group.get(\"id\"), full_hierarchy=full_hierarchy",
              "object_description": "Function and arguments",
              "object_id": "function_with_arguments",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            }
          ]
        }
      ]
    }
  ]
}