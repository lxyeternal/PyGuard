{
  "metadata": {
    "package_name": "localstack_ext-4",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/localstack_ext-4.3.1.dev58.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "pods_client.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/localstack_ext-4.3.1.dev58/localstack_ext-4.3.1.dev58/localstack/pro/core/bootstrap/pods_client.py",
      "line_number": "114",
      "type_description": "B835:load",
      "context_snippet": "def save(C,pod_name,attributes=_A,remote=_A,local=_B,version=_A,secret=_A):\n    H=version;E=secret;D=pod_name;F=f\"{get_runtime_pods_endpoint(E)}/{D}?\"\n    if local:F+='&local=true'\n    if H:F+=f\"&version={H}\"\n    I=_get_remote_params_payload(remote);I.update({'attributes':attributes});J=_get_headers()\n    if E:J[HEADER_POD_SECRET]=E\n    B=requests.post(url=F,json=I,headers=J,stream=C.interactive)\n    if not B.ok:_raise_exception_with_formatted_message(f\"Unable to save pod {D}\",B)\n    G={}\n    if C.interactive:G=C._process_response(B,message=f\"Saving Cloud Pod {D}\")\n    else:\n        for A in B.iter_lines():\n            A=json.loads(A)\n            if A[_D]=='pod_info':G=PodInfo(**A['extra'])\n            elif A[_D]=='exception':raise Exception(A[_F])\n    return G",
      "hash_value": "849ac10ed3f35bc312a92adbb20bdd18",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def save(C,pod_name,attributes=_A,remote=_A,local=_B,version=_A,secret=_A):\n    H=version;E=secret;D=pod_name;F=f\"{get_runtime_pods_endpoint(E)}/{D}?\"\n    if local:F+='&local=true'\n    if H:F+=f\"&version={H}\"\n    I=_get_remote_params_payload(remote);I.update({'attributes':attributes});J=_get_headers()\n    if E:J[HEADER_POD_SECRET]=E\n    B=requests.post(url=F,json=I,headers=J,stream=C.interactive)\n    if not B.ok:_raise_exception_with_formatted_message(f\"Unable to save pod {D}\",B)\n    G={}\n    if C.interactive:G=C._process_response(B,message=f\"Saving Cloud Pod {D}\")\n    else:\n        for A in B.iter_lines():\n            A=json.loads(A)\n            if A[_D]=='pod_info':G=PodInfo(**A['extra'])\n            elif A[_D]=='exception':raise Exception(A[_F])\n    return G",
          "triple_sequences": [
            {
              "action_api": "get_runtime_pods_endpoint()",
              "action_description": "Retrieves operating system information",
              "action_id": "get_os_info",
              "object": "secret",
              "object_description": "API key or token",
              "object_id": "api_key",
              "intention_description": "Prepare path for file operations",
              "intention_id": "prepare_path_file_operations"
            },
            {
              "action_api": "_get_remote_params_payload()",
              "action_description": "Creates HTTP request object with specified URL, data, and headers",
              "action_id": "create_http_request",
              "object": "remote",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "_get_headers()",
              "action_description": "Adds HTTP header to request object",
              "action_id": "add_http_header",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "url=F, json=I, headers=J, stream=C.interactive",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Transmit data HTTP POST",
              "intention_id": "transmit_data_http_post"
            },
            {
              "action_api": "_raise_exception_with_formatted_message()",
              "action_description": "Raises HTTPError if response status code indicates error",
              "action_id": "raise_http_error",
              "object": "f\"Unable to save pod {D}\", B",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Stop execution on invalid input",
              "intention_id": "stop_execution_invalid_input"
            },
            {
              "action_api": "C._process_response()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "B, message=f\"Saving Cloud Pod {D}\"",
              "object_description": "HTTP response remote content",
              "object_id": "http_response_remote_content",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "B.iter_lines()",
              "action_description": "Iterates over response content in chunks",
              "action_id": "iterate_response_chunks",
              "object": "B",
              "object_description": "HTTP response remote content",
              "object_id": "http_response_remote_content",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "json.loads()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "A",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            }
          ]
        }
      ]
    }
  ]
}