{
  "metadata": {
    "package_name": "kodexa-7",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/kodexa-7.4.414330611518.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "client.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/kodexa-7.4.414330611518/kodexa-7.4.414330611518/kodexa/platform/client.py",
      "line_number": "6418",
      "type_description": "B820:get",
      "context_snippet": "def process_response(response) -> requests.Response:\n    \"\"\"\n    This function processes the server response. It checks the status code of the response and raises an exception with\n    a specific message depending on the status code. If the status code is 401, it raises an \"Unauthorized\" exception.\n    If the status code is 404, it raises a \"Not found\" exception.\n    If the status code is 405, it raises a \"Method not allowed\" exception.\n    If the status code is 500, it raises an \"Internal server error\" exception.\n    If the status code is 400, it checks if the response has a JSON body with an \"errors\" field.\n    If so, it raises an exception with a message containing all the errors.\n    If not, it raises a \"Bad request\" exception.\n    If the status code is anything other than 200, it raises an \"Unexpected response\" exception.\n    If the status code is 200, it returns the response as is.\n\n    Args:\n        response (requests.Response): The server response to process.\n\n    Returns:\n        requests.Response: The original server response if the status code is 200.\n\n    Raises:\n        Exception: If the status code is not 200, an exception is raised with a message specific to the status code.\n    \"\"\"\n    if response.status_code == 401:\n        raise Exception(f\"Unauthorized ({response.text})\")\n    if response.status_code == 404:\n        raise Exception(f\"Not found ({response.text})\")\n    if response.status_code in [301, 302]:\n        raise Exception(f\"Redirected ({response.text})\")\n    if response.status_code == 405:\n        raise Exception(\"Method not allowed\")\n    if response.status_code == 500:\n        raise Exception(\"Internal server error: \\n\" + response.text)\n    if response.status_code == 400:\n        if response.json() and response.json().get(\"errors\"):\n            messages = []\n            for key, value in response.json()[\"errors\"].items():\n                messages.append(f\"{key}: {value}\")\n            raise Exception(\", \".join(messages))\n\n        raise Exception(\"Bad request \" + response.text)\n\n    return response",
      "hash_value": "d6d3a6d70982f14ce391b25fa533fd08",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def process_response(response) -> requests.Response:\n    \"\"\"\n    This function processes the server response. It checks the status code of the response and raises an exception with\n    a specific message depending on the status code. If the status code is 401, it raises an \"Unauthorized\" exception.\n    If the status code is 404, it raises a \"Not found\" exception.\n    If the status code is 405, it raises a \"Method not allowed\" exception.\n    If the status code is 500, it raises an \"Internal server error\" exception.\n    If the status code is 400, it checks if the response has a JSON body with an \"errors\" field.\n    If so, it raises an exception with a message containing all the errors.\n    If not, it raises a \"Bad request\" exception.\n    If the status code is anything other than 200, it raises an \"Unexpected response\" exception.\n    If the status code is 200, it returns the response as is.\n\n    Args:\n        response (requests.Response): The server response to process.\n\n    Returns:\n        requests.Response: The original server response if the status code is 200.\n\n    Raises:\n        Exception: If the status code is not 200, an exception is raised with a message specific to the status code.\n    \"\"\"\n    if response.status_code == 401:\n        raise Exception(f\"Unauthorized ({response.text})\")\n    if response.status_code == 404:\n        raise Exception(f\"Not found ({response.text})\")\n    if response.status_code in [301, 302]:\n        raise Exception(f\"Redirected ({response.text})\")\n    if response.status_code == 405:\n        raise Exception(\"Method not allowed\")\n    if response.status_code == 500:\n        raise Exception(\"Internal server error: \\n\" + response.text)\n    if response.status_code == 400:\n        if response.json() and response.json().get(\"errors\"):\n            messages = []\n            for key, value in response.json()[\"errors\"].items():\n                messages.append(f\"{key}: {value}\")\n            raise Exception(\", \".join(messages))\n\n        raise Exception(\"Bad request \" + response.text)\n\n    return response",
          "triple_sequences": [
            {
              "action_api": "response.status_code",
              "action_description": "Retrieves HTTP response status code",
              "action_id": "get_http_status",
              "object": "response",
              "object_description": "HTTP response content from remote server",
              "object_id": "http_response_remote_content",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "raise Exception()",
              "action_description": "Raises HTTPError if response status code indicates error",
              "action_id": "raise_http_error",
              "object": "Unauthorized ({response.text}) / Not found ({response.text}) / Redirected ({response.text}) / Method not allowed / Internal server error: \\n{response.text} / Bad request {response.text} / ', '.join(messages)",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Stop execution on invalid input",
              "intention_id": "stop_execution_invalid_input"
            },
            {
              "action_api": "response.json()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "response",
              "object_description": "HTTP response content from remote server",
              "object_id": "http_response_remote_content",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "response.json().get(\"errors\")",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "\"errors\" field from response.json()",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "response.text",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "response",
              "object_description": "HTTP response content from remote server",
              "object_id": "http_response_remote_content",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "return response",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "response",
              "object_description": "HTTP response content from remote server",
              "object_id": "http_response_remote_content",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            }
          ]
        }
      ]
    }
  ]
}