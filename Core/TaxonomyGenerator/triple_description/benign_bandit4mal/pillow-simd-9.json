{
  "metadata": {
    "package_name": "pillow-simd-9",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/pillow-simd-9.5.0.post2.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "EpsImagePlugin.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pillow-simd-9.5.0.post2/Pillow-SIMD-9.5.0.post2/src/PIL/EpsImagePlugin.py",
      "line_number": "190",
      "type_description": "B814:read",
      "context_snippet": "class PSFile:\n    \"\"\"\n    Wrapper for bytesio object that treats either CR or LF as end of line.\n    This class is no longer used internally, but kept for backwards compatibility.\n    \"\"\"\n\n    def __init__(self, fp):\n        deprecate(\n            \"PSFile\",\n            11,\n            action=\"If you need the functionality of this class \"\n            \"you will need to implement it yourself.\",\n        )\n        self.fp = fp\n        self.char = None\n\n    def seek(self, offset, whence=io.SEEK_SET):\n        self.char = None\n        self.fp.seek(offset, whence)\n\n    def readline(self):\n        s = [self.char or b\"\"]\n        self.char = None\n\n        c = self.fp.read(1)\n        while (c not in b\"\\r\\n\") and len(c):\n            s.append(c)\n            c = self.fp.read(1)\n\n        self.char = self.fp.read(1)\n        # line endings can be 1 or 2 of \\r \\n, in either order\n        if self.char in b\"\\r\\n\":\n            self.char = None\n\n        return b\"\".join(s).decode(\"latin-1\")",
      "hash_value": "17126e856a82d53c4d066be9833f6007",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "class PSFile:\n    \"\"\"\n    Wrapper for bytesio object that treats either CR or LF as end of line.\n    This class is no longer used internally, but kept for backwards compatibility.\n    \"\"\"\n\n    def __init__(self, fp):\n        deprecate(\n            \"PSFile\",\n            11,\n            action=\"If you need the functionality of this class \"\n            \"you will need to implement it yourself.\",\n        )\n        self.fp = fp\n        self.char = None\n\n    def seek(self, offset, whence=io.SEEK_SET):\n        self.char = None\n        self.fp.seek(offset, whence)\n\n    def readline(self):\n        s = [self.char or b\"\"]\n        self.char = None\n\n        c = self.fp.read(1)\n        while (c not in b\"\\r\\n\") and len(c):\n            s.append(c)\n            c = self.fp.read(1)\n\n        self.char = self.fp.read(1)\n        # line endings can be 1 or 2 of \\r \\n, in either order\n        if self.char in b\"\\r\\n\":\n            self.char = None\n\n        return b\"\".join(s).decode(\"latin-1\")",
          "triple_sequences": [
            {
              "action_api": "deprecate()",
              "action_description": "Dynamically executes Python code string",
              "action_id": "exec_python_code",
              "object": "\"PSFile\", 11, action=\"If you need the functionality of this class you will need to implement it yourself.\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Evaluate constructed code",
              "intention_id": "evaluate_constructed_code"
            },
            {
              "action_api": "self.fp.seek()",
              "action_description": "Basic file opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "offset, whence",
              "object_description": "",
              "object_id": "",
              "intention_description": "Open file for reading",
              "intention_id": "open_file_reading"
            },
            {
              "action_api": "self.fp.read()",
              "action_description": "Basic file opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "1",
              "object_description": "",
              "object_id": "",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "b\"\".join()",
              "action_description": "Join characters into string",
              "action_id": "convert_integers_to_chars",
              "object": "s",
              "object_description": "",
              "object_id": "",
              "intention_description": "Join characters into string",
              "intention_id": "join_characters_into_string"
            },
            {
              "action_api": "str.decode()",
              "action_description": "Decodes bytes using specified codec",
              "action_id": "decode_bytes_codec",
              "object": "\"latin-1\"",
              "object_description": "Character encoding type",
              "object_id": "character_encoding_type",
              "intention_description": "Decode bytes to string",
              "intention_id": "decode_bytes_to_string"
            }
          ]
        }
      ]
    }
  ]
}