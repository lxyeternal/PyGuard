{
  "metadata": {
    "package_name": "twine-6",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/twine-6.1.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "utils.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/twine-6.1.0/twine-6.1.0/twine/utils.py",
      "line_number": "276",
      "type_description": "B820:get",
      "context_snippet": "def get_userpass_value(\n    cli_value: Optional[str],\n    config: RepositoryConfig,\n    key: str,\n    prompt_strategy: Optional[Callable[[], str]] = None,\n) -> Optional[str]:\n    \"\"\"Get a credential (e.g. a username or password) from the configuration.\n\n    Uses the following rules:\n\n    1. If ``cli_value`` is specified, use that.\n    2. If ``config[key]`` is specified, use that.\n    3. If ``prompt_strategy`` is specified, use its return value.\n    4. Otherwise return ``None``\n\n    :param cli_value:\n        The value supplied from the command line.\n    :param config:\n        A dictionary of repository configuration values.\n    :param key:\n        The credential to look up in ``config``, e.g. ``\"username\"`` or ``\"password\"``.\n    :param prompt_strategy:\n        An argumentless function to get the value, e.g. from keyring or by prompting\n        the user.\n\n    :return:\n        The credential value, i.e. the username or password.\n    \"\"\"\n    if cli_value is not None:\n        logger.info(f\"{key} set by command options\")\n        return cli_value\n\n    elif config.get(key) is not None:\n        logger.info(f\"{key} set from config file\")\n        return config[key]\n\n    elif prompt_strategy:\n        warning = \"\"\n        value = prompt_strategy()\n\n        if not value:\n            warning = f\"Your {key} is empty\"\n        elif any(unicodedata.category(c).startswith(\"C\") for c in value):\n            # See https://www.unicode.org/reports/tr44/#General_Category_Values\n            # Most common case is \"\\x16\" when pasting in Windows Command Prompt\n            warning = f\"Your {key} contains control characters\"\n\n        if warning:\n            logger.warning(f\"{warning}. Did you enter it correctly?\")\n            logger.warning(\n                \"See https://twine.readthedocs.io/#entering-credentials \"\n                \"for more information.\"\n            )\n\n        return value\n\n    else:\n        return None",
      "hash_value": "9df4bbd64b3843e0cd59375608111050",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def get_userpass_value(\n    cli_value: Optional[str],\n    config: RepositoryConfig,\n    key: str,\n    prompt_strategy: Optional[Callable[[], str]] = None,\n) -> Optional[str]:\n    \"\"\"Get a credential (e.g. a username or password) from the configuration.\n\n    Uses the following rules:\n\n    1. If ``cli_value`` is specified, use that.\n    2. If ``config[key]`` is specified, use that.\n    3. If ``prompt_strategy`` is specified, use its return value.\n    4. Otherwise return ``None``\n\n    :param cli_value:\n        The value supplied from the command line.\n    :param config:\n        A dictionary of repository configuration values.\n    :param key:\n        The credential to look up in ``config``, e.g. ``\"username\"`` or ``\"password\"``.\n    :param prompt_strategy:\n        An argumentless function to get the value, e.g. from keyring or by prompting\n        the user.\n\n    :return:\n        The credential value, i.e. the username or password.\n    \"\"\"\n    if cli_value is not None:\n        logger.info(f\"{key} set by command options\")\n        return cli_value\n\n    elif config.get(key) is not None:\n        logger.info(f\"{key} set from config file\")\n        return config[key]\n\n    elif prompt_strategy:\n        warning = \"\"\n        value = prompt_strategy()\n\n        if not value:\n            warning = f\"Your {key} is empty\"\n        elif any(unicodedata.category(c).startswith(\"C\") for c in value):\n            # See https://www.unicode.org/reports/tr44/#General_Category_Values\n            # Most common case is \"\\x16\" when pasting in Windows Command Prompt\n            warning = f\"Your {key} contains control characters\"\n\n        if warning:\n            logger.warning(f\"{warning}. Did you enter it correctly?\")\n            logger.warning(\n                \"See https://twine.readthedocs.io/#entering-credentials \"\n                \"for more information.\"\n            )\n\n        return value\n\n    else:\n        return None",
          "triple_sequences": [
            {
              "action_api": "config.get()",
              "action_description": "Retrieves value and data type for registry value",
              "action_id": "get_registry_value",
              "object": "key",
              "object_description": "Registry value name",
              "object_id": "registry_value_name",
              "intention_description": "Access configuration value",
              "intention_id": "access_configuration_value"
            },
            {
              "action_api": "prompt_strategy()",
              "action_description": "Reads user input from standard input",
              "action_id": "read_user_input",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Collect user input",
              "intention_id": "collect_user_input"
            },
            {
              "action_api": "unicodedata.category()",
              "action_description": "Checks if object is instance of specified type",
              "action_id": "check_instance_type",
              "object": "c",
              "object_description": "Character from obfuscated string",
              "object_id": "character_from_obfuscated_string",
              "intention_description": "Prepare character for further processing",
              "intention_id": "prepare_character_processing"
            },
            {
              "action_api": "logger.info()",
              "action_description": "Writes file content",
              "action_id": "basic_write_operations",
              "object": "f\"{key} set by command options\"",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "logger.info()",
              "action_description": "Writes file content",
              "action_id": "basic_write_operations",
              "object": "f\"{key} set from config file\"",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "logger.warning()",
              "action_description": "Writes file content",
              "action_id": "basic_write_operations",
              "object": "f\"{warning}. Did you enter it correctly?\"",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "logger.warning()",
              "action_description": "Writes file content",
              "action_id": "basic_write_operations",
              "object": "\"See https://twine.readthedocs.io/#entering-credentials for more information.\"",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            }
          ]
        }
      ]
    }
  ]
}