{
  "metadata": {
    "package_name": "cookiecutter-2",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/cookiecutter-2.6.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "test_hooks.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/cookiecutter-2.6.0/cookiecutter-2.6.0/tests/test_hooks.py",
      "line_number": "28",
      "type_description": "B815:write",
      "context_snippet": "def make_test_repo(name, multiple_hooks=False):\n    \"\"\"Create test repository for test setup methods.\"\"\"\n    hook_dir = os.path.join(name, 'hooks')\n    template = os.path.join(name, 'input{{hooks}}')\n    os.mkdir(name)\n    os.mkdir(hook_dir)\n    os.mkdir(template)\n\n    Path(template, 'README.rst').write_text(\"foo\\n===\\n\\nbar\\n\")\n\n    with Path(hook_dir, 'pre_gen_project.py').open('w') as f:\n        f.write(\"#!/usr/bin/env python\\n\")\n        f.write(\"# -*- coding: utf-8 -*-\\n\")\n        f.write(\"from __future__ import print_function\\n\")\n        f.write(\"\\n\")\n        f.write(\"print('pre generation hook')\\n\")\n        f.write(\"f = open('python_pre.txt', 'w')\\n\")\n        f.write(\"f.close()\\n\")\n\n    if sys.platform.startswith('win'):\n        post = 'post_gen_project.bat'\n        with Path(hook_dir, post).open('w') as f:\n            f.write(\"@echo off\\n\")\n            f.write(\"\\n\")\n            f.write(\"echo post generation hook\\n\")\n            f.write(\"echo. >shell_post.txt\\n\")\n    else:\n        post = 'post_gen_project.sh'\n        filename = os.path.join(hook_dir, post)\n        with Path(filename).open('w') as f:\n            f.write(\"#!/bin/bash\\n\")\n            f.write(\"\\n\")\n            f.write(\"echo 'post generation hook';\\n\")\n            f.write(\"touch 'shell_post.txt'\\n\")\n        # Set the execute bit\n        os.chmod(filename, os.stat(filename).st_mode | stat.S_IXUSR)\n\n    # Adding an additional pre script\n    if multiple_hooks:\n        if sys.platform.startswith('win'):\n            pre = 'pre_gen_project.bat'\n            with Path(hook_dir, pre).open('w') as f:\n                f.write(\"@echo off\\n\")\n                f.write(\"\\n\")\n                f.write(\"echo post generation hook\\n\")\n                f.write(\"echo. >shell_pre.txt\\n\")\n        else:\n            pre = 'pre_gen_project.sh'\n            filename = os.path.join(hook_dir, pre)\n            with Path(filename).open('w') as f:\n                f.write(\"#!/bin/bash\\n\")\n                f.write(\"\\n\")\n                f.write(\"echo 'post generation hook';\\n\")\n                f.write(\"touch 'shell_pre.txt'\\n\")\n            # Set the execute bit\n            os.chmod(filename, os.stat(filename).st_mode | stat.S_IXUSR)\n\n    return post",
      "hash_value": "36268a8ff88f6a1c35c27844f1a8e8d1",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def make_test_repo(name, multiple_hooks=False):\n    \"\"\"Create test repository for test setup methods.\"\"\"\n    hook_dir = os.path.join(name, 'hooks')\n    template = os.path.join(name, 'input{{hooks}}')\n    os.mkdir(name)\n    os.mkdir(hook_dir)\n    os.mkdir(template)\n\n    Path(template, 'README.rst').write_text(\"foo\\n===\\n\\nbar\\n\")\n\n    with Path(hook_dir, 'pre_gen_project.py').open('w') as f:\n        f.write(\"#!/usr/bin/env python\\n\")\n        f.write(\"# -*- coding: utf-8 -*-\\n\")\n        f.write(\"from __future__ import print_function\\n\")\n        f.write(\"\\n\")\n        f.write(\"print('pre generation hook')\\n\")\n        f.write(\"f = open('python_pre.txt', 'w')\\n\")\n        f.write(\"f.close()\\n\")\n\n    if sys.platform.startswith('win'):\n        post = 'post_gen_project.bat'\n        with Path(hook_dir, post).open('w') as f:\n            f.write(\"@echo off\\n\")\n            f.write(\"\\n\")\n            f.write(\"echo post generation hook\\n\")\n            f.write(\"echo. >shell_post.txt\\n\")\n    else:\n        post = 'post_gen_project.sh'\n        filename = os.path.join(hook_dir, post)\n        with Path(filename).open('w') as f:\n            f.write(\"#!/bin/bash\\n\")\n            f.write(\"\\n\")\n            f.write(\"echo 'post generation hook';\\n\")\n            f.write(\"touch 'shell_post.txt'\\n\")\n        # Set the execute bit\n        os.chmod(filename, os.stat(filename).st_mode | stat.S_IXUSR)\n\n    # Adding an additional pre script\n    if multiple_hooks:\n        if sys.platform.startswith('win'):\n            pre = 'pre_gen_project.bat'\n            with Path(hook_dir, pre).open('w') as f:\n                f.write(\"@echo off\\n\")\n                f.write(\"\\n\")\n                f.write(\"echo post generation hook\\n\")\n                f.write(\"echo. >shell_pre.txt\\n\")\n        else:\n            pre = 'pre_gen_project.sh'\n            filename = os.path.join(hook_dir, pre)\n            with Path(filename).open('w') as f:\n                f.write(\"#!/bin/bash\\n\")\n                f.write(\"\\n\")\n                f.write(\"echo 'post generation hook';\\n\")\n                f.write(\"touch 'shell_pre.txt'\\n\")\n            # Set the execute bit\n            os.chmod(filename, os.stat(filename).st_mode | stat.S_IXUSR)\n\n    return post",
          "triple_sequences": [
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "name, 'hooks'",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Prepare directory path",
              "intention_id": "prepare_directory_path"
            },
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "name, 'input{{hooks}}'",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Prepare directory path",
              "intention_id": "prepare_directory_path"
            },
            {
              "action_api": "os.mkdir()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "name",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "os.mkdir()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "hook_dir",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "os.mkdir()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "template",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "Path().write_text()",
              "action_description": "Saves image to file",
              "action_id": "save_image_file",
              "object": "Path(template, 'README.rst'), \"foo\\n===\\n\\nbar\\n\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "Path().open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "Path(hook_dir, 'pre_gen_project.py'), 'w'",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"#!/usr/bin/env python\\n\"",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"# -*- coding: utf-8 -*-\\n\"",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"from __future__ import print_function\\n\"",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"\\n\"",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"print('pre generation hook')\\n\"",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"f = open('python_pre.txt', 'w')\\n\"",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"f.close()\\n\"",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "Path().open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "Path(hook_dir, post), 'w'",
              "object_description": "Batch file path",
              "object_id": "batch_file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"@echo off\\n\"",
              "object_description": "Batch file content",
              "object_id": "batch_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"\\n\"",
              "object_description": "Batch file content",
              "object_id": "batch_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"echo post generation hook\\n\"",
              "object_description": "Batch file content",
              "object_id": "batch_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"echo. >shell_post.txt\\n\"",
              "object_description": "Batch file content",
              "object_id": "batch_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "hook_dir, post",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "Path().open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "filename, 'w'",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"#!/bin/bash\\n\"",
              "object_description": "Shell script content",
              "object_id": "shell_script",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"\\n\"",
              "object_description": "Shell script content",
              "object_id": "shell_script",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"echo 'post generation hook';\\n\"",
              "object_description": "Shell script content",
              "object_id": "shell_script",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"touch 'shell_post.txt'\\n\"",
              "object_description": "Shell script content",
              "object_id": "shell_script",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "os.stat()",
              "action_description": "Path object and status operations (creating Path objects, retrieving file status)",
              "action_id": "path_object_operations",
              "object": "filename",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "os.chmod()",
              "action_description": "Changes file mode to add execute permission",
              "action_id": "change_file_mode_execute",
              "object": "filename, os.stat(filename).st_mode | stat.S_IXUSR",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Modify file attributes",
              "intention_id": "modify_file_attributes"
            },
            {
              "action_api": "Path().open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "Path(hook_dir, pre), 'w'",
              "object_description": "Batch file path",
              "object_id": "batch_file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"@echo off\\n\"",
              "object_description": "Batch file content",
              "object_id": "batch_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"\\n\"",
              "object_description": "Batch file content",
              "object_id": "batch_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"echo post generation hook\\n\"",
              "object_description": "Batch file content",
              "object_id": "batch_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"echo. >shell_pre.txt\\n\"",
              "object_description": "Batch file content",
              "object_id": "batch_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "hook_dir, pre",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "Path().open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "filename, 'w'",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"#!/bin/bash\\n\"",
              "object_description": "Shell script content",
              "object_id": "shell_script",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"\\n\"",
              "object_description": "Shell script content",
              "object_id": "shell_script",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"echo 'post generation hook';\\n\"",
              "object_description": "Shell script content",
              "object_id": "shell_script",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"touch 'shell_pre.txt'\\n\"",
              "object_description": "Shell script content",
              "object_id": "shell_script",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "os.stat()",
              "action_description": "Path object and status operations (creating Path objects, retrieving file status)",
              "action_id": "path_object_operations",
              "object": "filename",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "os.chmod()",
              "action_description": "Changes file mode to add execute permission",
              "action_id": "change_file_mode_execute",
              "object": "filename, os.stat(filename).st_mode | stat.S_IXUSR",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Modify file attributes",
              "intention_id": "modify_file_attributes"
            }
          ]
        }
      ]
    }
  ]
}