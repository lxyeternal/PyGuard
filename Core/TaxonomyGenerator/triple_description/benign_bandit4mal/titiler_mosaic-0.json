{
  "metadata": {
    "package_name": "titiler_mosaic-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/titiler_mosaic-0.21.1.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "factory.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/titiler_mosaic-0.21.1/titiler_mosaic-0.21.1/titiler/mosaic/factory.py",
      "line_number": "720",
      "type_description": "B820:get",
      "context_snippet": "def map_viewer(self):  # noqa: C901\n    \"\"\"Register /map endpoint.\"\"\"\n\n    @self.router.get(\"/{tileMatrixSetId}/map\", response_class=HTMLResponse)\n    def map_viewer(\n        request: Request,\n        tileMatrixSetId: Annotated[\n            Literal[tuple(self.supported_tms.list())],\n            Path(\n                description=\"Identifier selecting one of the TileMatrixSetId supported.\"\n            ),\n        ],\n        tile_format: Annotated[\n            Optional[ImageType],\n            Query(\n                description=\"Default will be automatically defined if the output image needs a mask (png) or not (jpeg).\",\n            ),\n        ] = None,\n        tile_scale: Annotated[\n            int,\n            Query(\n                gt=0, lt=4, description=\"Tile size scale. 1=256x256, 2=512x512...\"\n            ),\n        ] = 1,\n        minzoom: Annotated[\n            Optional[int],\n            Query(description=\"Overwrite default minzoom.\"),\n        ] = None,\n        maxzoom: Annotated[\n            Optional[int],\n            Query(description=\"Overwrite default maxzoom.\"),\n        ] = None,\n        src_path=Depends(self.path_dependency),\n        backend_params=Depends(self.backend_dependency),\n        reader_params=Depends(self.reader_dependency),\n        layer_params=Depends(self.layer_dependency),\n        dataset_params=Depends(self.dataset_dependency),\n        pixel_selection=Depends(self.pixel_selection_dependency),\n        tile_params=Depends(self.tile_dependency),\n        post_process=Depends(self.process_dependency),\n        colormap=Depends(self.colormap_dependency),\n        render_params=Depends(self.render_dependency),\n        env=Depends(self.environment_dependency),\n    ):\n        \"\"\"Return TileJSON document for a dataset.\"\"\"\n        tilejson_url = self.url_for(\n            request,\n            \"tilejson\",\n            tileMatrixSetId=tileMatrixSetId,\n        )\n        if request.query_params._list:\n            tilejson_url += f\"?{urlencode(request.query_params._list, doseq=True)}\"\n\n        tms = self.supported_tms.get(tileMatrixSetId)\n        return self.templates.TemplateResponse(\n            request,\n            name=\"map.html\",\n            context={\n                \"tilejson_endpoint\": tilejson_url,\n                \"tms\": tms,\n                \"resolutions\": [matrix.cellSize for matrix in tms],\n            },\n            media_type=\"text/html\",\n        )",
      "hash_value": "54922a3c9980efaec4a5247f1d57a3b8",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def map_viewer(self):  # noqa: C901\n    \"\"\"Register /map endpoint.\"\"\"\n\n    @self.router.get(\"/{tileMatrixSetId}/map\", response_class=HTMLResponse)\n    def map_viewer(\n        request: Request,\n        tileMatrixSetId: Annotated[\n            Literal[tuple(self.supported_tms.list())],\n            Path(\n                description=\"Identifier selecting one of the TileMatrixSetId supported.\"\n            ),\n        ],\n        tile_format: Annotated[\n            Optional[ImageType],\n            Query(\n                description=\"Default will be automatically defined if the output image needs a mask (png) or not (jpeg).\",\n            ),\n        ] = None,\n        tile_scale: Annotated[\n            int,\n            Query(\n                gt=0, lt=4, description=\"Tile size scale. 1=256x256, 2=512x512...\"\n            ),\n        ] = 1,\n        minzoom: Annotated[\n            Optional[int],\n            Query(description=\"Overwrite default minzoom.\"),\n        ] = None,\n        maxzoom: Annotated[\n            Optional[int],\n            Query(description=\"Overwrite default maxzoom.\"),\n        ] = None,\n        src_path=Depends(self.path_dependency),\n        backend_params=Depends(self.backend_dependency),\n        reader_params=Depends(self.reader_dependency),\n        layer_params=Depends(self.layer_dependency),\n        dataset_params=Depends(self.dataset_dependency),\n        pixel_selection=Depends(self.pixel_selection_dependency),\n        tile_params=Depends(self.tile_dependency),\n        post_process=Depends(self.process_dependency),\n        colormap=Depends(self.colormap_dependency),\n        render_params=Depends(self.render_dependency),\n        env=Depends(self.environment_dependency),\n    ):\n        \"\"\"Return TileJSON document for a dataset.\"\"\"\n        tilejson_url = self.url_for(\n            request,\n            \"tilejson\",\n            tileMatrixSetId=tileMatrixSetId,\n        )\n        if request.query_params._list:\n            tilejson_url += f\"?{urlencode(request.query_params._list, doseq=True)}\"\n\n        tms = self.supported_tms.get(tileMatrixSetId)\n        return self.templates.TemplateResponse(\n            request,\n            name=\"map.html\",\n            context={\n                \"tilejson_endpoint\": tilejson_url,\n                \"tms\": tms,\n                \"resolutions\": [matrix.cellSize for matrix in tms],\n            },\n            media_type=\"text/html\",\n        )",
          "triple_sequences": [
            {
              "action_api": "self.router.get()",
              "action_description": "Creates HTTP request object with specified URL, data, and headers",
              "action_id": "create_http_request",
              "object": "/{tileMatrixSetId}/map",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "self.url_for()",
              "action_description": "Path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "\"tilejson\", tileMatrixSetId=tileMatrixSetId",
              "object_description": "Path segment",
              "object_id": "path_segment",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "urlencode()",
              "action_description": "Encodes mapping object to URL query string",
              "action_id": "encode_url_query",
              "object": "request.query_params._list",
              "object_description": "Query parameter",
              "object_id": "query_parameter",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "self.supported_tms.get()",
              "action_description": "Path object and status operations (creating Path objects, retrieving file status)",
              "action_id": "path_object_operations",
              "object": "tileMatrixSetId",
              "object_description": "Path segment",
              "object_id": "path_segment",
              "intention_description": "Prepare path for browser data access",
              "intention_id": "prepare_path_browser_data"
            },
            {
              "action_api": "self.templates.TemplateResponse()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "request, name=\"map.html\", context={...}, media_type=\"text/html\"",
              "object_description": "Script file path and image file",
              "object_id": "script_path_with_image",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            }
          ]
        }
      ]
    }
  ]
}