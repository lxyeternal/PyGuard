{
  "metadata": {
    "package_name": "tecton-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/tecton-1.2.0b10.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "okta.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/tecton-1.2.0b10/tecton-1.2.0b10/tecton/identities/okta.py",
      "line_number": "203",
      "type_description": "B820:get",
      "context_snippet": "    def _session_token_auth(self, authorize_url: str, state: str) -> str:\n        # We disallow redirects so that we can extract the code from the\n        # redirect location.\n        r = http.session().get(authorize_url, allow_redirects=False)\n        r.raise_for_status()\n        if r.status_code != 302:\n            print(\"Unsuccessful headless Okta auth.\", file=sys.stderr)\n            sys.exit(1)\n        url = r.headers.get(\"location\")\n        return self._extract_code_from_url(url, state)",
      "hash_value": "3be7d9892d9b0af1c80962165218f5ac",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "    def _session_token_auth(self, authorize_url: str, state: str) -> str:\n        # We disallow redirects so that we can extract the code from the\n        # redirect location.\n        r = http.session().get(authorize_url, allow_redirects=False)\n        r.raise_for_status()\n        if r.status_code != 302:\n            print(\"Unsuccessful headless Okta auth.\", file=sys.stderr)\n            sys.exit(1)\n        url = r.headers.get(\"location\")\n        return self._extract_code_from_url(url, state)",
          "triple_sequences": [
            {
              "action_api": "http.session().get()",
              "action_description": "Sends HTTP GET request to URL",
              "action_id": "open_url_get",
              "object": "authorize_url",
              "object_description": "URL string",
              "object_id": "url_string",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "r.raise_for_status()",
              "action_description": "Raises HTTPError if response status code indicates error",
              "action_id": "raise_http_error",
              "object": "r.status_code",
              "object_description": "HTTP status code",
              "object_id": "status_code",
              "intention_description": "Stop execution on invalid input",
              "intention_id": "stop_execution_invalid_input"
            },
            {
              "action_api": "r.headers.get()",
              "action_description": "Retrieves HTTP header value from response object",
              "action_id": "add_http_header",
              "object": "\"location\"",
              "object_description": "Redirect location URL",
              "object_id": "redirect_location",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "print()",
              "action_description": "Writes text to standard error output",
              "action_id": "read_process_stderr",
              "object": "\"Unsuccessful headless Okta auth.\"",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Access command error output",
              "intention_id": "access_command_error_output"
            },
            {
              "action_api": "sys.exit()",
              "action_description": "Exits program",
              "action_id": "exit_program",
              "object": "1",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Terminate program execution",
              "intention_id": "terminate_program_execution"
            },
            {
              "action_api": "self._extract_code_from_url()",
              "action_description": "Extracts current call stack as FrameSummary objects",
              "action_id": "extract_call_stack",
              "object": "url, state",
              "object_description": "URL string",
              "object_id": "url_string",
              "intention_description": "Extract structured data from file",
              "intention_id": "extract_structured_file_data"
            }
          ]
        }
      ]
    }
  ]
}