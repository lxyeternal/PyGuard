{
  "metadata": {
    "package_name": "mindsdb-25",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/mindsdb-25.4.2.1.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "initialize.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/mindsdb-25.4.2.1/mindsdb-25.4.2.1/mindsdb/api/http/initialize.py",
      "line_number": "312",
      "type_description": "B820:get",
      "context_snippet": "@app.before_request\n    def before_request():\n        logger.debug(f\"HTTP {request.method}: {request.path}\")\n        ctx.set_default()\n        config = Config()\n\n        # region routes where auth is required\n        if (\n            config['auth']['http_auth_enabled'] is True\n            and any(request.path.startswith(f'/api{ns.path}') for ns in protected_namespaces)\n            and check_auth() is False\n        ):\n            return http_error(\n                HTTPStatus.UNAUTHORIZED, 'Unauthorized',\n                'Authorization is required to complete the request'\n            )\n        # endregion\n\n        company_id = request.headers.get('company-id')\n        user_class = request.headers.get('user-class')\n\n        try:\n            email_confirmed = int(request.headers.get('email-confirmed', 1))\n        except Exception:\n            email_confirmed = 1\n\n        try:\n            user_id = int(request.headers.get('user-id', 0))\n        except Exception:\n            user_id = 0\n\n        try:\n            session_id = request.cookies.get('session')\n        except Exception:\n            session_id = \"unknown\"\n\n        if company_id is not None:\n            try:\n                company_id = int(company_id)\n            except Exception as e:\n                logger.error(\n                    f\"Cloud not parse company id: {company_id} | exception: {e}\"\n                )\n                company_id = None\n\n        if user_class is not None:\n            try:\n                user_class = int(user_class)\n            except Exception as e:\n                logger.error(\n                    f\"Cloud not parse user_class: {user_class} | exception: {e}\"\n                )\n                user_class = 0\n        else:\n            user_class = 0\n\n        ctx.user_id = user_id\n        ctx.session_id = session_id\n        ctx.company_id = company_id\n        ctx.user_class = user_class\n        ctx.email_confirmed = email_confirmed",
      "hash_value": "7a541a41025fd76926f2726c8dad8b13",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "@app.before_request\n    def before_request():\n        logger.debug(f\"HTTP {request.method}: {request.path}\")\n        ctx.set_default()\n        config = Config()\n\n        # region routes where auth is required\n        if (\n            config['auth']['http_auth_enabled'] is True\n            and any(request.path.startswith(f'/api{ns.path}') for ns in protected_namespaces)\n            and check_auth() is False\n        ):\n            return http_error(\n                HTTPStatus.UNAUTHORIZED, 'Unauthorized',\n                'Authorization is required to complete the request'\n            )\n        # endregion\n\n        company_id = request.headers.get('company-id')\n        user_class = request.headers.get('user-class')\n\n        try:\n            email_confirmed = int(request.headers.get('email-confirmed', 1))\n        except Exception:\n            email_confirmed = 1\n\n        try:\n            user_id = int(request.headers.get('user-id', 0))\n        except Exception:\n            user_id = 0\n\n        try:\n            session_id = request.cookies.get('session')\n        except Exception:\n            session_id = \"unknown\"\n\n        if company_id is not None:\n            try:\n                company_id = int(company_id)\n            except Exception as e:\n                logger.error(\n                    f\"Cloud not parse company id: {company_id} | exception: {e}\"\n                )\n                company_id = None\n\n        if user_class is not None:\n            try:\n                user_class = int(user_class)\n            except Exception as e:\n                logger.error(\n                    f\"Cloud not parse user_class: {user_class} | exception: {e}\"\n                )\n                user_class = 0\n        else:\n            user_class = 0\n\n        ctx.user_id = user_id\n        ctx.session_id = session_id\n        ctx.company_id = company_id\n        ctx.user_class = user_class\n        ctx.email_confirmed = email_confirmed",
          "triple_sequences": [
            {
              "action_api": "request.headers.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "'company-id'",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "request.headers.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "'user-class'",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "request.headers.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "'email-confirmed', 1",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "request.headers.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "'user-id', 0",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "request.cookies.get()",
              "action_description": "Retrieve browser cookies",
              "action_id": "get_browser_cookies",
              "object": "'session'",
              "object_description": "Cookie data string",
              "object_id": "cookie_data_string",
              "intention_description": "Collect browser cookies for specified domain",
              "intention_id": "collect_browser_cookies_domain"
            },
            {
              "action_api": "int()",
              "action_description": "Converts string to integer",
              "action_id": "convert_int_to_bytes",
              "object": "request.headers.get('email-confirmed', 1)",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Convert string to integer",
              "intention_id": "convert_string_to_integer"
            },
            {
              "action_api": "int()",
              "action_description": "Converts string to integer",
              "action_id": "convert_int_to_bytes",
              "object": "request.headers.get('user-id', 0)",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Convert string to integer",
              "intention_id": "convert_string_to_integer"
            },
            {
              "action_api": "int()",
              "action_description": "Converts string to integer",
              "action_id": "convert_int_to_bytes",
              "object": "company_id",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Convert string to integer",
              "intention_id": "convert_string_to_integer"
            },
            {
              "action_api": "int()",
              "action_description": "Converts string to integer",
              "action_id": "convert_int_to_bytes",
              "object": "user_class",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Convert string to integer",
              "intention_id": "convert_string_to_integer"
            }
          ]
        }
      ]
    }
  ]
}