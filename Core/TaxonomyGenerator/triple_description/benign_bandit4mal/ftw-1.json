{
  "metadata": {
    "package_name": "ftw-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/ftw-1.3.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "http.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/ftw-1.3.0/ftw-1.3.0/ftw/http.py",
      "line_number": "62",
      "type_description": "B814:read",
      "context_snippet": "def parse_content_encoding(self, response_headers, response_data):\n    \"\"\"\n    Parses a response that contains Content-Encoding to retrieve\n    response_data\n    \"\"\"\n    if response_headers['content-encoding'] == 'br':\n        try:\n            response_data = brotli.decompress(response_data)\n        except brotli.error:\n            raise errors.TestError(\n                'Invalid or missing brotli data found',\n                {\n                    'response_data': str(response_data),\n                    'function': 'http.HttpResponse.parse_content_encoding'\n                })\n    elif response_headers['content-encoding'] == 'gzip':\n        buf = BytesIO(response_data)\n        zipbuf = gzip.GzipFile(fileobj=buf)\n        try:\n            response_data = zipbuf.read()\n        except IOError:\n            raise errors.TestError(\n                'Invalid or missing gzip data found',\n                {\n                    'response_data': str(response_data),\n                    'function': 'http.HttpResponse.parse_content_encoding'\n                })\n    elif response_headers['content-encoding'] == 'deflate':\n        try:\n            response_data = zlib.decompress(response_data, -zlib.MAX_WBITS)\n        except zlib.error:\n            raise errors.TestError(\n                'Invalid or missing deflate data found',\n                {\n                    'response_data': str(response_data),\n                    'function': 'http.HttpResponse.parse_content_encoding'\n                })\n    else:\n        raise errors.TestError(\n            'Received unknown Content-Encoding',\n            {\n                'content-encoding':\n                    str(response_headers['content-encoding']),\n                'function': 'http.HttpResponse.parse_content_encoding'\n            })\n    return response_data",
      "hash_value": "653ef034bd3d67aca2b0fbc8b82f1c6c",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def parse_content_encoding(self, response_headers, response_data):\n    \"\"\"\n    Parses a response that contains Content-Encoding to retrieve\n    response_data\n    \"\"\"\n    if response_headers['content-encoding'] == 'br':\n        try:\n            response_data = brotli.decompress(response_data)\n        except brotli.error:\n            raise errors.TestError(\n                'Invalid or missing brotli data found',\n                {\n                    'response_data': str(response_data),\n                    'function': 'http.HttpResponse.parse_content_encoding'\n                })\n    elif response_headers['content-encoding'] == 'gzip':\n        buf = BytesIO(response_data)\n        zipbuf = gzip.GzipFile(fileobj=buf)\n        try:\n            response_data = zipbuf.read()\n        except IOError:\n            raise errors.TestError(\n                'Invalid or missing gzip data found',\n                {\n                    'response_data': str(response_data),\n                    'function': 'http.HttpResponse.parse_content_encoding'\n                })\n    elif response_headers['content-encoding'] == 'deflate':\n        try:\n            response_data = zlib.decompress(response_data, -zlib.MAX_WBITS)\n        except zlib.error:\n            raise errors.TestError(\n                'Invalid or missing deflate data found',\n                {\n                    'response_data': str(response_data),\n                    'function': 'http.HttpResponse.parse_content_encoding'\n                })\n    else:\n        raise errors.TestError(\n            'Received unknown Content-Encoding',\n            {\n                'content-encoding':\n                    str(response_headers['content-encoding']),\n                'function': 'http.HttpResponse.parse_content_encoding'\n            })\n    return response_data",
          "triple_sequences": [
            {
              "action_api": "brotli.decompress()",
              "action_description": "Decompresses zlib-compressed data",
              "action_id": "decompress_data_zlib",
              "object": "response_data",
              "object_description": "Decompressed data",
              "object_id": "decompressed_data",
              "intention_description": "Decompress_zlib_data",
              "intention_id": "decompress_zlib_data"
            },
            {
              "action_api": "BytesIO()",
              "action_description": "Creates in-memory bytes buffer from encoded string",
              "action_id": "create_memory_bytes",
              "object": "response_data",
              "object_description": "Image binary stream",
              "object_id": "image_binary_stream",
              "intention_description": "Prepare_data_processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "gzip.GzipFile()",
              "action_description": "Decompresses zlib-compressed data",
              "action_id": "decompress_data_zlib",
              "object": "buf",
              "object_description": "Decompressed data",
              "object_id": "decompressed_data",
              "intention_description": "Decompress_zlib_data",
              "intention_id": "decompress_zlib_data"
            },
            {
              "action_api": "zipbuf.read()",
              "action_description": "Reads all bytes from process standard output",
              "action_id": "read_process_stdout",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Read_file_content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "zlib.decompress()",
              "action_description": "Decompresses zlib-compressed data",
              "action_id": "decompress_data_zlib",
              "object": "response_data, -zlib.MAX_WBITS",
              "object_description": "Decompressed data",
              "object_id": "decompressed_data",
              "intention_description": "Decompress_zlib_data",
              "intention_id": "decompress_zlib_data"
            },
            {
              "action_api": "str()",
              "action_description": "Converts bytes to string using default codec",
              "action_id": "decode_bytes_default",
              "object": "response_data",
              "object_description": "",
              "object_id": "",
              "intention_description": "Decode_bytes_to_string",
              "intention_id": "decode_bytes_to_string"
            }
          ]
        }
      ]
    }
  ]
}