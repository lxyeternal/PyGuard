{
  "metadata": {
    "package_name": "azure_storage_blob-12",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/azure_storage_blob-12.25.1.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "test_container.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/azure_storage_blob-12.25.1/azure_storage_blob-12.25.1/tests/test_container.py",
      "line_number": "765",
      "type_description": "B820:get",
      "context_snippet": "@BlobPreparer()\n@recorded_by_proxy\ndef test_set_container_acl_with_signed_identifiers(self, **kwargs):\n    storage_account_name = kwargs.pop(\"storage_account_name\")\n    storage_account_key = kwargs.pop(\"storage_account_key\")\n    variables = kwargs.pop(\"variables\", {})\n\n    bsc = BlobServiceClient(self.account_url(storage_account_name, \"blob\"), storage_account_key)\n    container = self._create_container(bsc)\n\n    # Act\n    expiry_time = self.get_datetime_variable(variables, 'expiry_time', datetime.utcnow() + timedelta(hours=1))\n    start_time = self.get_datetime_variable(variables, 'start_time', datetime.utcnow() - timedelta(minutes=1))\n    access_policy = AccessPolicy(permission=ContainerSasPermissions(read=True),\n                                 expiry=expiry_time,\n                                 start=start_time)\n    identifiers = {'testid': access_policy}\n    container.set_container_access_policy(identifiers)\n\n    # Assert\n    acl = container.get_container_access_policy()\n    assert acl is not None\n    assert 'testid' == acl.get('signed_identifiers')[0].id\n    assert acl.get('public_access') is None\n\n    return variables",
      "hash_value": "11dcd5ff541b508e7da8a7516ff544d5",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "@BlobPreparer()\n@recorded_by_proxy\ndef test_set_container_acl_with_signed_identifiers(self, **kwargs):\n    storage_account_name = kwargs.pop(\"storage_account_name\")\n    storage_account_key = kwargs.pop(\"storage_account_key\")\n    variables = kwargs.pop(\"variables\", {})\n\n    bsc = BlobServiceClient(self.account_url(storage_account_name, \"blob\"), storage_account_key)\n    container = self._create_container(bsc)\n\n    # Act\n    expiry_time = self.get_datetime_variable(variables, 'expiry_time', datetime.utcnow() + timedelta(hours=1))\n    start_time = self.get_datetime_variable(variables, 'start_time', datetime.utcnow() - timedelta(minutes=1))\n    access_policy = AccessPolicy(permission=ContainerSasPermissions(read=True),\n                                 expiry=expiry_time,\n                                 start=start_time)\n    identifiers = {'testid': access_policy}\n    container.set_container_access_policy(identifiers)\n\n    # Assert\n    acl = container.get_container_access_policy()\n    assert acl is not None\n    assert 'testid' == acl.get('signed_identifiers')[0].id\n    assert acl.get('public_access') is None\n\n    return variables",
          "triple_sequences": [
            {
              "action_api": "BlobServiceClient()",
              "action_description": "Instantiates BlobServiceClient class",
              "action_id": "init_grabber_class",
              "object": "self.account_url(storage_account_name, \"blob\"), storage_account_key",
              "object_description": "API key or token",
              "object_id": "api_key",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "self._create_container()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "bsc",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "self.get_datetime_variable()",
              "action_description": "Parses string into datetime object",
              "action_id": "parse_datetime",
              "object": "variables, 'expiry_time', datetime.utcnow() + timedelta(hours=1)",
              "object_description": "Delay duration in seconds",
              "object_id": "delay_duration",
              "intention_description": "Get datetime epoch",
              "intention_id": "get_datetime_epoch"
            },
            {
              "action_api": "self.get_datetime_variable()",
              "action_description": "Parses string into datetime object",
              "action_id": "parse_datetime",
              "object": "variables, 'start_time', datetime.utcnow() - timedelta(minutes=1)",
              "object_description": "Delay duration in seconds",
              "object_id": "delay_duration",
              "intention_description": "Get datetime epoch",
              "intention_id": "get_datetime_epoch"
            },
            {
              "action_api": "AccessPolicy()",
              "action_description": "Instantiates AccessPolicy class",
              "action_id": "init_grabber_class",
              "object": "permission=ContainerSasPermissions(read=True), expiry=expiry_time, start=start_time",
              "object_description": "API key or token",
              "object_id": "api_key",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "container.set_container_access_policy()",
              "action_description": "Sets file attributes for specified file",
              "action_id": "set_file_attributes",
              "object": "identifiers",
              "object_description": "Backup codes data",
              "object_id": "backup_codes",
              "intention_description": "Modify file attributes",
              "intention_id": "modify_file_attributes"
            },
            {
              "action_api": "container.get_container_access_policy()",
              "action_description": "Retrieves value and data type for registry value",
              "action_id": "get_registry_value",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "acl.get()",
              "action_description": "Retrieves value and data type for registry value",
              "action_id": "get_registry_value",
              "object": "'signed_identifiers'",
              "object_description": "Backup codes data",
              "object_id": "backup_codes",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "acl.get()",
              "action_description": "Retrieves value and data type for registry value",
              "action_id": "get_registry_value",
              "object": "'public_access'",
              "object_description": "API key or token",
              "object_id": "api_key",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            }
          ]
        }
      ]
    }
  ]
}