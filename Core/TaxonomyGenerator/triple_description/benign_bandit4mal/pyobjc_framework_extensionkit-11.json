{
  "metadata": {
    "package_name": "pyobjc_framework_extensionkit-11",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/pyobjc_framework_extensionkit-11.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "pyobjc_setup.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pyobjc_framework_extensionkit-11.0/pyobjc_framework_extensionkit-11.0/pyobjc_setup.py",
      "line_number": "87",
      "type_description": "B815:write",
      "context_snippet": "class oc_egg_info(egg_info.egg_info):\n    def run(self):\n        egg_info.egg_info.run(self)\n        self.write_build_info()\n\n        path = os.path.join(self.egg_info, \"PKG-INFO\")\n        with open(path) as fp:\n            contents = fp.read()\n\n        first, middle, last = contents.partition(\"\\n\\n\")\n\n        with open(path, \"w\") as fp:\n            fp.write(first)\n            fp.write(\n                \"\\nProject-URL: Documentation, \"\n                \"https://%s.readthedocs.io/en/latest/\\n\" % (REPO_NAME,)\n            )\n            fp.write(\n                \"Project-URL: Issue tracker, \"\n                \"https://github.com/ronaldoussoren/%s/issues\\n\" % (REPO_NAME,)\n            )\n            fp.write(\n                \"Project-URL: Repository, \"\n                \"https://github.com/ronaldoussoren/%s\" % (REPO_NAME,)\n            )\n            fp.write(middle)\n            fp.write(last)\n\n    def write_build_info(self):\n        macos_version = subprocess.check_output(\n            [\"sw_vers\", \"-productversion\"], text=True\n        ).strip()\n        macos_build = subprocess.check_output(\n            [\"sw_vers\", \"-buildversion\"], text=True\n        ).strip()\n        clang_version = (\n            subprocess.check_output([\"clang\", \"--version\"], text=True)\n            .splitlines()[0]\n            .strip()\n        )\n\n        sdk_root = get_sdk()\n        if sdk_root is None:\n            sdk_root = subprocess.check_output(\n                [\"xcrun\", \"-sdk\", \"macosx\", \"--show-sdk-path\"], text=True\n            ).strip()\n        sdk_info = os.path.join(sdk_root, \"SDKSettings.plist\")\n        if os.path.exists(sdk_info):\n            pl = plistlib.load(open(sdk_info, \"rb\"))\n            sdk_version = pl[\"DisplayName\"]\n        else:\n            sdk_version = os.path.basename(sdk_root)\n\n        build_info = textwrap.dedent(\n            f\"\"\"\\\n            macOS {macos_version} ({macos_build})\n            {clang_version}\n            SDK: {sdk_version}\n            \"\"\"\n        )\n\n        self.write_file(\n            \"pyobjc-build-info.txt\",\n            os.path.join(self.egg_info, \"pyobjc-build-info.txt\"),\n            build_info,\n        )",
      "hash_value": "4d706f4e39eb18b39e84756b6bc1f801",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "class oc_egg_info(egg_info.egg_info):\n    def run(self):\n        egg_info.egg_info.run(self)\n        self.write_build_info()\n\n        path = os.path.join(self.egg_info, \"PKG-INFO\")\n        with open(path) as fp:\n            contents = fp.read()\n\n        first, middle, last = contents.partition(\"\\n\\n\")\n\n        with open(path, \"w\") as fp:\n            fp.write(first)\n            fp.write(\n                \"\\nProject-URL: Documentation, \"\n                \"https://%s.readthedocs.io/en/latest/\\n\" % (REPO_NAME,)\n            )\n            fp.write(\n                \"Project-URL: Issue tracker, \"\n                \"https://github.com/ronaldoussoren/%s/issues\\n\" % (REPO_NAME,)\n            )\n            fp.write(\n                \"Project-URL: Repository, \"\n                \"https://github.com/ronaldoussoren/%s\" % (REPO_NAME,)\n            )\n            fp.write(middle)\n            fp.write(last)\n\n    def write_build_info(self):\n        macos_version = subprocess.check_output(\n            [\"sw_vers\", \"-productversion\"], text=True\n        ).strip()\n        macos_build = subprocess.check_output(\n            [\"sw_vers\", \"-buildversion\"], text=True\n        ).strip()\n        clang_version = (\n            subprocess.check_output([\"clang\", \"--version\"], text=True)\n            .splitlines()[0]\n            .strip()\n        )\n\n        sdk_root = get_sdk()\n        if sdk_root is None:\n            sdk_root = subprocess.check_output(\n                [\"xcrun\", \"-sdk\", \"macosx\", \"--show-sdk-path\"], text=True\n            ).strip()\n        sdk_info = os.path.join(sdk_root, \"SDKSettings.plist\")\n        if os.path.exists(sdk_info):\n            pl = plistlib.load(open(sdk_info, \"rb\"))\n            sdk_version = pl[\"DisplayName\"]\n        else:\n            sdk_version = os.path.basename(sdk_root)\n\n        build_info = textwrap.dedent(\n            f\"\"\"\\\n            macOS {macos_version} ({macos_build})\n            {clang_version}\n            SDK: {sdk_version}\n            \"\"\"\n        )\n\n        self.write_file(\n            \"pyobjc-build-info.txt\",\n            os.path.join(self.egg_info, \"pyobjc-build-info.txt\"),\n            build_info,\n        )",
          "triple_sequences": [
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "self.egg_info, \"PKG-INFO\"",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "path",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for reading",
              "intention_id": "open_file_reading"
            },
            {
              "action_api": "fp.read()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "path, \"w\"",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "fp.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "first",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "fp.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"\\nProject-URL: Documentation, https://%s.readthedocs.io/en/latest/\\n\" % (REPO_NAME,)",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "fp.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"Project-URL: Issue tracker, https://github.com/ronaldoussoren/%s/issues\\n\" % (REPO_NAME,)",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "fp.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"Project-URL: Repository, https://github.com/ronaldoussoren/%s\" % (REPO_NAME,)",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "fp.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "middle",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "fp.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "last",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "subprocess.check_output()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "[\"sw_vers\", \"-productversion\"], text=True",
              "object_description": "System command",
              "object_id": "system_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "str.strip()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Decode command output",
              "intention_id": "decode_command_output"
            },
            {
              "action_api": "subprocess.check_output()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "[\"sw_vers\", \"-buildversion\"], text=True",
              "object_description": "System command",
              "object_id": "system_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "str.strip()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Decode command output",
              "intention_id": "decode_command_output"
            },
            {
              "action_api": "subprocess.check_output()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "[\"clang\", \"--version\"], text=True",
              "object_description": "System command",
              "object_id": "system_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "str.splitlines()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Decode command output",
              "intention_id": "decode_command_output"
            },
            {
              "action_api": "str.strip()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Decode command output",
              "intention_id": "decode_command_output"
            },
            {
              "action_api": "get_sdk()",
              "action_description": "Retrieves operating system information",
              "action_id": "get_os_info",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get operating system name",
              "intention_id": "get_operating_system_name"
            },
            {
              "action_api": "subprocess.check_output()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "[\"xcrun\", \"-sdk\", \"macosx\", \"--show-sdk-path\"], text=True",
              "object_description": "System command",
              "object_id": "system_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "str.strip()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Decode command output",
              "intention_id": "decode_command_output"
            },
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "sdk_root, \"SDKSettings.plist\"",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "sdk_info",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "sdk_info, \"rb\"",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for reading",
              "intention_id": "open_file_reading"
            },
            {
              "action_api": "plistlib.load()",
              "action_description": "Deserializes Python object from bytes",
              "action_id": "deserialize_from_bytes",
              "object": "open(sdk_info, \"rb\")",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "os.path.basename()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "sdk_root",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "textwrap.dedent()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "f\"\"\"\\nmacOS {macos_version} ({macos_build})\\n{clang_version}\\nSDK: {sdk_version}\\n\"\"\"",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "self.egg_info, \"pyobjc-build-info.txt\"",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "self.write_file()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"pyobjc-build-info.txt\", os.path.join(self.egg_info, \"pyobjc-build-info.txt\"), build_info",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            }
          ]
        }
      ]
    }
  ]
}