{
  "metadata": {
    "package_name": "ytsaurus_client-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/ytsaurus_client-0.13.26-py2.py3-none-any.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "_dill.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/ytsaurus_client-0.13.26-py2.py3-none-any/yt/packages/dill/_dill.py",
      "line_number": "1867",
      "type_description": "B815:write",
      "context_snippet": "@register(TypeType)\ndef save_type(pickler, obj, postproc_list=None):\n    if obj in _typemap:\n        log.info(\"T1: %s\" % obj)\n        pickler.save_reduce(_load_type, (_typemap[obj],), obj=obj)\n        log.info(\"# T1\")\n    elif obj.__bases__ == (tuple,) and all([hasattr(obj, attr) for attr in ('_fields','_asdict','_make','_replace')]):\n        # special case: namedtuples\n        log.info(\"T6: %s\" % obj)\n        if OLD37 or (not obj._field_defaults):\n            pickler.save_reduce(_create_namedtuple, (obj.__name__, obj._fields, obj.__module__), obj=obj)\n        else:\n            defaults = [obj._field_defaults[field] for field in obj._fields if field in obj._field_defaults]\n            pickler.save_reduce(_create_namedtuple, (obj.__name__, obj._fields, obj.__module__, defaults), obj=obj)\n        log.info(\"# T6\")\n        return\n\n    # special cases: NoneType, NotImplementedType, EllipsisType\n    elif obj is type(None):\n        log.info(\"T7: %s\" % obj)\n        #XXX: pickler.save_reduce(type, (None,), obj=obj)\n        if PY3:\n            pickler.write(bytes('c__builtin__\\nNoneType\\n', 'UTF-8'))\n        else:\n            pickler.write('c__builtin__\\nNoneType\\n')\n        log.info(\"# T7\")\n    elif obj is NotImplementedType:\n        log.info(\"T7: %s\" % obj)\n        pickler.save_reduce(type, (NotImplemented,), obj=obj)\n        log.info(\"# T7\")\n    elif obj is EllipsisType:\n        log.info(\"T7: %s\" % obj)\n        pickler.save_reduce(type, (Ellipsis,), obj=obj)\n        log.info(\"# T7\")\n\n    else:\n        obj_name = getattr(obj, '__qualname__', getattr(obj, '__name__', None))\n        _byref = getattr(pickler, '_byref', None)\n        obj_recursive = id(obj) in getattr(pickler, '_postproc', ())\n        incorrectly_named = not _locate_function(obj, pickler)\n        if not _byref and not obj_recursive and incorrectly_named: # not a function, but the name was held over\n            if issubclass(type(obj), type):\n                # thanks to Tom Stepleton pointing out pickler._session unneeded\n                _t = 'T2'\n                log.info(\"%s: %s\" % (_t, obj))\n                _dict = _dict_from_dictproxy(obj.__dict__)\n            else:\n                _t = 'T3'\n                log.info(\"%s: %s\" % (_t, obj))\n                _dict = obj.__dict__\n           #print (_dict)\n           #print (\"%s\\n%s\" % (type(obj), obj.__name__))\n           #print (\"%s\\n%s\" % (obj.__bases__, obj.__dict__))\n            for name in _dict.get(\"__slots__\", []):\n                del _dict[name]\n            if PY3 and obj_name != obj.__name__:\n                if postproc_list is None:\n                    postproc_list = []\n                postproc_list.append((setattr, (obj, '__qualname__', obj_name)))\n            _save_with_postproc(pickler, (_create_type, (\n                type(obj), obj.__name__, obj.__bases__, _dict\n            )), obj=obj, postproc_list=postproc_list)\n            log.info(\"# %s\" % _t)\n        else:\n            log.info(\"T4: %s\" % obj)\n            if incorrectly_named:\n                warnings.warn('Cannot locate reference to %r.' % (obj,), PicklingWarning)\n            if obj_recursive:\n                warnings.warn('Cannot pickle %r: %s.%s has recursive self-references that trigger a RecursionError.' % (obj, obj.__module__, obj_name), PicklingWarning)\n           #print (obj.__dict__)\n           #print (\"%s\\n%s\" % (type(obj), obj.__name__))\n           #print (\"%s\\n%s\" % (obj.__bases__, obj.__dict__))\n            StockPickler.save_global(pickler, obj, name=obj_name)\n            log.info(\"# T4\")\n    return",
      "hash_value": "82561f65c7b608ffe2ba9852d27a28b5",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "@register(TypeType)\ndef save_type(pickler, obj, postproc_list=None):\n    if obj in _typemap:\n        log.info(\"T1: %s\" % obj)\n        pickler.save_reduce(_load_type, (_typemap[obj],), obj=obj)\n        log.info(\"# T1\")\n    elif obj.__bases__ == (tuple,) and all([hasattr(obj, attr) for attr in ('_fields','_asdict','_make','_replace')]):\n        # special case: namedtuples\n        log.info(\"T6: %s\" % obj)\n        if OLD37 or (not obj._field_defaults):\n            pickler.save_reduce(_create_namedtuple, (obj.__name__, obj._fields, obj.__module__), obj=obj)\n        else:\n            defaults = [obj._field_defaults[field] for field in obj._fields if field in obj._field_defaults]\n            pickler.save_reduce(_create_namedtuple, (obj.__name__, obj._fields, obj.__module__, defaults), obj=obj)\n        log.info(\"# T6\")\n        return\n\n    # special cases: NoneType, NotImplementedType, EllipsisType\n    elif obj is type(None):\n        log.info(\"T7: %s\" % obj)\n        #XXX: pickler.save_reduce(type, (None,), obj=obj)\n        if PY3:\n            pickler.write(bytes('c__builtin__\\nNoneType\\n', 'UTF-8'))\n        else:\n            pickler.write('c__builtin__\\nNoneType\\n')\n        log.info(\"# T7\")\n    elif obj is NotImplementedType:\n        log.info(\"T7: %s\" % obj)\n        pickler.save_reduce(type, (NotImplemented,), obj=obj)\n        log.info(\"# T7\")\n    elif obj is EllipsisType:\n        log.info(\"T7: %s\" % obj)\n        pickler.save_reduce(type, (Ellipsis,), obj=obj)\n        log.info(\"# T7\")\n\n    else:\n        obj_name = getattr(obj, '__qualname__', getattr(obj, '__name__', None))\n        _byref = getattr(pickler, '_byref', None)\n        obj_recursive = id(obj) in getattr(pickler, '_postproc', ())\n        incorrectly_named = not _locate_function(obj, pickler)\n        if not _byref and not obj_recursive and incorrectly_named: # not a function, but the name was held over\n            if issubclass(type(obj), type):\n                # thanks to Tom Stepleton pointing out pickler._session unneeded\n                _t = 'T2'\n                log.info(\"%s: %s\" % (_t, obj))\n                _dict = _dict_from_dictproxy(obj.__dict__)\n            else:\n                _t = 'T3'\n                log.info(\"%s: %s\" % (_t, obj))\n                _dict = obj.__dict__\n           #print (_dict)\n           #print (\"%s\\n%s\" % (type(obj), obj.__name__))\n           #print (\"%s\\n%s\" % (obj.__bases__, obj.__dict__))\n            for name in _dict.get(\"__slots__\", []):\n                del _dict[name]\n            if PY3 and obj_name != obj.__name__:\n                if postproc_list is None:\n                    postproc_list = []\n                postproc_list.append((setattr, (obj, '__qualname__', obj_name)))\n            _save_with_postproc(pickler, (_create_type, (\n                type(obj), obj.__name__, obj.__bases__, _dict\n            )), obj=obj, postproc_list=postproc_list)\n            log.info(\"# %s\" % _t)\n        else:\n            log.info(\"T4: %s\" % obj)\n            if incorrectly_named:\n                warnings.warn('Cannot locate reference to %r.' % (obj,), PicklingWarning)\n            if obj_recursive:\n                warnings.warn('Cannot pickle %r: %s.%s has recursive self-references that trigger a RecursionError.' % (obj, obj.__module__, obj_name), PicklingWarning)\n           #print (obj.__dict__)\n           #print (\"%s\\n%s\" % (type(obj), obj.__name__))\n           #print (\"%s\\n%s\" % (obj.__bases__, obj.__dict__))\n            StockPickler.save_global(pickler, obj, name=obj_name)\n            log.info(\"# T4\")\n    return",
          "triple_sequences": [
            {
              "action_api": "log.info()",
              "action_description": "Writes log message to file or output",
              "action_id": "write_file_content",
              "object": "\"T1: %s\" % obj",
              "object_description": "Log file content",
              "object_id": "file_text",
              "intention_description": "Access log file content",
              "intention_id": "access_log_file_content"
            },
            {
              "action_api": "pickler.save_reduce()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "(_load_type, (_typemap[obj],), obj=obj)",
              "object_description": "Serialized embed object",
              "object_id": "serialized_embed_object",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "log.info()",
              "action_description": "Writes log message to file or output",
              "action_id": "write_file_content",
              "object": "\"# T1\"",
              "object_description": "Log file content",
              "object_id": "file_text",
              "intention_description": "Access log file content",
              "intention_id": "access_log_file_content"
            },
            {
              "action_api": "log.info()",
              "action_description": "Writes log message to file or output",
              "action_id": "write_file_content",
              "object": "\"T6: %s\" % obj",
              "object_description": "Log file content",
              "object_id": "file_text",
              "intention_description": "Access log file content",
              "intention_id": "access_log_file_content"
            },
            {
              "action_api": "pickler.save_reduce()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "(_create_namedtuple, (obj.__name__, obj._fields, obj.__module__), obj=obj)",
              "object_description": "Serialized embed object",
              "object_id": "serialized_embed_object",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "pickler.save_reduce()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "(_create_namedtuple, (obj.__name__, obj._fields, obj.__module__, defaults), obj=obj)",
              "object_description": "Serialized embed object",
              "object_id": "serialized_embed_object",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "log.info()",
              "action_description": "Writes log message to file or output",
              "action_id": "write_file_content",
              "object": "\"# T6\"",
              "object_description": "Log file content",
              "object_id": "file_text",
              "intention_description": "Access log file content",
              "intention_id": "access_log_file_content"
            },
            {
              "action_api": "log.info()",
              "action_description": "Writes log message to file or output",
              "action_id": "write_file_content",
              "object": "\"T7: %s\" % obj",
              "object_description": "Log file content",
              "object_id": "file_text",
              "intention_description": "Access log file content",
              "intention_id": "access_log_file_content"
            },
            {
              "action_api": "pickler.write()",
              "action_description": "Writes file content",
              "action_id": "write_file_content",
              "object": "bytes('c__builtin__\\nNoneType\\n', 'UTF-8')",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "pickler.write()",
              "action_description": "Writes file content",
              "action_id": "write_file_content",
              "object": "'c__builtin__\\nNoneType\\n'",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "log.info()",
              "action_description": "Writes log message to file or output",
              "action_id": "write_file_content",
              "object": "\"# T7\"",
              "object_description": "Log file content",
              "object_id": "file_text",
              "intention_description": "Access log file content",
              "intention_id": "access_log_file_content"
            },
            {
              "action_api": "log.info()",
              "action_description": "Writes log message to file or output",
              "action_id": "write_file_content",
              "object": "\"T7: %s\" % obj",
              "object_description": "Log file content",
              "object_id": "file_text",
              "intention_description": "Access log file content",
              "intention_id": "access_log_file_content"
            },
            {
              "action_api": "pickler.save_reduce()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "(type, (NotImplemented,), obj=obj)",
              "object_description": "Serialized embed object",
              "object_id": "serialized_embed_object",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "log.info()",
              "action_description": "Writes log message to file or output",
              "action_id": "write_file_content",
              "object": "\"# T7\"",
              "object_description": "Log file content",
              "object_id": "file_text",
              "intention_description": "Access log file content",
              "intention_id": "access_log_file_content"
            },
            {
              "action_api": "log.info()",
              "action_description": "Writes log message to file or output",
              "action_id": "write_file_content",
              "object": "\"T7: %s\" % obj",
              "object_description": "Log file content",
              "object_id": "file_text",
              "intention_description": "Access log file content",
              "intention_id": "access_log_file_content"
            },
            {
              "action_api": "pickler.save_reduce()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "(type, (Ellipsis,), obj=obj)",
              "object_description": "Serialized embed object",
              "object_id": "serialized_embed_object",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "log.info()",
              "action_description": "Writes log message to file or output",
              "action_id": "write_file_content",
              "object": "\"# T7\"",
              "object_description": "Log file content",
              "object_id": "file_text",
              "intention_description": "Access log file content",
              "intention_id": "access_log_file_content"
            },
            {
              "action_api": "getattr()",
              "action_description": "Access attribute value",
              "action_id": "access_attribute_value",
              "object": "obj, '__qualname__', getattr(obj, '__name__', None)",
              "object_description": "Attribute value",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "getattr()",
              "action_description": "Access attribute value",
              "action_id": "access_attribute_value",
              "object": "pickler, '_byref', None",
              "object_description": "Attribute value",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "getattr()",
              "action_description": "Access attribute value",
              "action_id": "access_attribute_value",
              "object": "pickler, '_postproc', ()",
              "object_description": "Attribute value",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "_locate_function()",
              "action_description": "Checks if object is instance of specified type",
              "action_id": "check_instance_type",
              "object": "obj, pickler",
              "object_description": "",
              "object_id": "",
              "intention_description": "Determine required module presence",
              "intention_id": "determine_required_module_presence"
            },
            {
              "action_api": "issubclass()",
              "action_description": "Checks if object is instance of specified type",
              "action_id": "check_instance_type",
              "object": "type(obj), type",
              "object_description": "",
              "object_id": "",
              "intention_description": "Determine required module presence",
              "intention_id": "determine_required_module_presence"
            },
            {
              "action_api": "log.info()",
              "action_description": "Writes log message to file or output",
              "action_id": "write_file_content",
              "object": "\"%s: %s\" % (_t, obj)",
              "object_description": "Log file content",
              "object_id": "file_text",
              "intention_description": "Access log file content",
              "intention_id": "access_log_file_content"
            },
            {
              "action_api": "_dict_from_dictproxy()",
              "action_description": "Deserializes JSON string to Python object",
              "action_id": "deserialize_from_json",
              "object": "obj.__dict__",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Extract structured file data",
              "intention_id": "extract_structured_file_data"
            },
            {
              "action_api": "log.info()",
              "action_description": "Writes log message to file or output",
              "action_id": "write_file_content",
              "object": "\"%s: %s\" % (_t, obj)",
              "object_description": "Log file content",
              "object_id": "file_text",
              "intention_description": "Access log file content",
              "intention_id": "access_log_file_content"
            },
            {
              "action_api": "del _dict[name]",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "name",
              "object_description": "Local file or directory name",
              "object_id": "local_file_or_directory_name",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            },
            {
              "action_api": "setattr()",
              "action_description": "Sets attribute on builtins object",
              "action_id": "set_builtin_attr",
              "object": "(obj, '__qualname__', obj_name)",
              "object_description": "Attribute value",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "postproc_list.append()",
              "action_description": "Adds field to multipart HTTP request",
              "action_id": "add_multipart_field",
              "object": "(setattr, (obj, '__qualname__', obj_name))",
              "object_description": "Function and arguments",
              "object_id": "function_with_arguments",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "_save_with_postproc()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "(pickler, (_create_type, (type(obj), obj.__name__, obj.__bases__, _dict)), obj=obj, postproc_list=postproc_list)",
              "object_description": "Serialized embed object",
              "object_id": "serialized_embed_object",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "log.info()",
              "action_description": "Writes log message to file or output",
              "action_id": "write_file_content",
              "object": "\"# %s\" % _t",
              "object_description": "Log file content",
              "object_id": "file_text",
              "intention_description": "Access log file content",
              "intention_id": "access_log_file_content"
            },
            {
              "action_api": "log.info()",
              "action_description": "Writes log message to file or output",
              "action_id": "write_file_content",
              "object": "\"T4: %s\" % obj",
              "object_description": "Log file content",
              "object_id": "file_text",
              "intention_description": "Access log file content",
              "intention_id": "access_log_file_content"
            },
            {
              "action_api": "warnings.warn()",
              "action_description": "Raises HTTPError if response status code indicates error",
              "action_id": "raise_http_error",
              "object": "'Cannot locate reference to %r.' % (obj,), PicklingWarning",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Stop execution on invalid input",
              "intention_id": "stop_execution_invalid_input"
            },
            {
              "action_api": "warnings.warn()",
              "action_description": "Raises HTTPError if response status code indicates error",
              "action_id": "raise_http_error",
              "object": "'Cannot pickle %r: %s.%s has recursive self-references that trigger a RecursionError.' % (obj, obj.__module__, obj_name), PicklingWarning",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Stop execution on invalid input",
              "intention_id": "stop_execution_invalid_input"
            },
            {
              "action_api": "StockPickler.save_global()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "pickler, obj, name=obj_name",
              "object_description": "Serialized embed object",
              "object_id": "serialized_embed_object",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "log.info()",
              "action_description": "Writes log message to file or output",
              "action_id": "write_file_content",
              "object": "\"# T4\"",
              "object_description": "Log file content",
              "object_id": "file_text",
              "intention_description": "Access log file content",
              "intention_id": "access_log_file_content"
            }
          ]
        }
      ]
    }
  ]
}