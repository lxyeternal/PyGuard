{
  "metadata": {
    "package_name": "datadog-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/datadog-0.51.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "test_statsd.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/datadog-0.51.0/datadog-0.51.0/tests/unit/dogstatsd/test_statsd.py",
      "line_number": "1842",
      "type_description": "B809:recv",
      "context_snippet": "def test_flush(self):\n    dogstatsd = DogStatsd(disable_buffering=False, telemetry_min_flush_interval=0)\n    fake_socket = FakeSocket()\n    dogstatsd.socket = fake_socket\n\n    dogstatsd.increment('page.views')\n    self.assertIsNone(fake_socket.recv(no_wait=True))\n    dogstatsd.flush()\n    payload = dogstatsd.socket.recv(2)\n    self.assert_equal_telemetry('page.views:1|c\\n', payload)",
      "hash_value": "d6b7f44f5f6d06168a17b046bf704fac",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "def test_flush(self):\n    dogstatsd = DogStatsd(disable_buffering=False, telemetry_min_flush_interval=0)\n    fake_socket = FakeSocket()\n    dogstatsd.socket = fake_socket\n\n    dogstatsd.increment('page.views')\n    self.assertIsNone(fake_socket.recv(no_wait=True))\n    dogstatsd.flush()\n    payload = dogstatsd.socket.recv(2)\n    self.assert_equal_telemetry('page.views:1|c\\n', payload)",
          "triple_sequences": [
            {
              "action_api": "DogStatsd()",
              "action_description": "Instantiates class",
              "action_id": "init_grabber_class",
              "object": "disable_buffering=False, telemetry_min_flush_interval=0",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "FakeSocket()",
              "action_description": "Instantiates class",
              "action_id": "init_grabber_class",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "dogstatsd.increment()",
              "action_description": "Sends data over socket connection",
              "action_id": "send_socket_data",
              "object": "'page.views'",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "fake_socket.recv()",
              "action_description": "Receives data from socket connection",
              "action_id": "receive_socket_data",
              "object": "no_wait=True",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "dogstatsd.flush()",
              "action_description": "Sends data over socket connection",
              "action_id": "send_socket_data",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "dogstatsd.socket.recv()",
              "action_description": "Receives data from socket connection",
              "action_id": "receive_socket_data",
              "object": "2",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            }
          ]
        }
      ]
    }
  ]
}