{
  "metadata": {
    "package_name": "cumulusci-4",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/cumulusci-4.3.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "test_apex_tasks.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/cumulusci-4.3.0/cumulusci-4.3.0/cumulusci/tasks/apex/tests/test_apex_tasks.py",
      "line_number": "937",
      "type_description": "B832:write",
      "context_snippet": "@patch(\n    \"cumulusci.core.tasks.BaseSalesforceTask._update_credentials\",\n    MagicMock(return_value=None),\n)\nclass TestAnonymousApexTask:\n    def setup_method(self):\n        self.api_version = 42.0\n        self.universal_config = UniversalConfig(\n            {\"project\": {\"api_version\": self.api_version}}\n        )\n        self.tmpdir = tempfile.mkdtemp(dir=\".\")\n        apex_path = os.path.join(self.tmpdir, \"test.apex\")\n        with open(apex_path, \"w\") as f:\n            f.write('System.debug(\"from file\")')\n        self.task_config = TaskConfig()\n        self.task_config.config[\"options\"] = {\n            \"path\": apex_path,\n            \"apex\": 'system.debug(\"Hello World!\")',\n            \"param1\": \"StringValue\",\n        }\n        self.project_config = BaseProjectConfig(\n            self.universal_config, config={\"noyaml\": True}\n        )\n        self.project_config.config = {\n            \"project\": {\n                \"package\": {\"namespace\": \"abc\", \"api_version\": self.api_version}\n            }\n        }\n        keychain = BaseProjectKeychain(self.project_config, \"\")\n        self.project_config.set_keychain(keychain)\n        self.org_config = OrgConfig(\n            {\n                \"id\": \"foo/1\",\n                \"instance_url\": \"https://example.com\",\n                \"access_token\": \"abc123\",\n                \"namespace\": \"abc\",\n            },\n            \"test\",\n        )\n        self.org_config._installed_packages = {}\n        self.base_tooling_url = \"{}/services/data/v{}/tooling/\".format(\n            self.org_config.instance_url, self.api_version\n        )",
      "hash_value": "61d8c3fe40d7e5291ca4fdcd4e99cc7a",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "@patch(\n    \"cumulusci.core.tasks.BaseSalesforceTask._update_credentials\",\n    MagicMock(return_value=None),\n)\nclass TestAnonymousApexTask:\n    def setup_method(self):\n        self.api_version = 42.0\n        self.universal_config = UniversalConfig(\n            {\"project\": {\"api_version\": self.api_version}}\n        )\n        self.tmpdir = tempfile.mkdtemp(dir=\".\")\n        apex_path = os.path.join(self.tmpdir, \"test.apex\")\n        with open(apex_path, \"w\") as f:\n            f.write('System.debug(\"from file\")')\n        self.task_config = TaskConfig()\n        self.task_config.config[\"options\"] = {\n            \"path\": apex_path,\n            \"apex\": 'system.debug(\"Hello World!\")',\n            \"param1\": \"StringValue\",\n        }\n        self.project_config = BaseProjectConfig(\n            self.universal_config, config={\"noyaml\": True}\n        )\n        self.project_config.config = {\n            \"project\": {\n                \"package\": {\"namespace\": \"abc\", \"api_version\": self.api_version}\n            }\n        }\n        keychain = BaseProjectKeychain(self.project_config, \"\")\n        self.project_config.set_keychain(keychain)\n        self.org_config = OrgConfig(\n            {\n                \"id\": \"foo/1\",\n                \"instance_url\": \"https://example.com\",\n                \"access_token\": \"abc123\",\n                \"namespace\": \"abc\",\n            },\n            \"test\",\n        )\n        self.org_config._installed_packages = {}\n        self.base_tooling_url = \"{}/services/data/v{}/tooling/\".format(\n            self.org_config.instance_url, self.api_version\n        )",
          "triple_sequences": [
            {
              "action_api": "tempfile.mkdtemp()",
              "action_description": "Creates temporary directory and returns its path",
              "action_id": "create_temp_dir",
              "object": "dir=\".\"",
              "object_description": "Temporary directory",
              "object_id": "temporary_directory",
              "intention_description": "Create temporary directory",
              "intention_id": "create_temporary_directory"
            },
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "self.tmpdir, \"test.apex\"",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "apex_path, \"w\"",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "'System.debug(\"from file\")'",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "BaseProjectConfig()",
              "action_description": "Instantiates Setup class",
              "action_id": "init_setup_class",
              "object": "self.universal_config, config={\"noyaml\": True}",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Prepare directory path",
              "intention_id": "prepare_directory_path"
            },
            {
              "action_api": "BaseProjectKeychain()",
              "action_description": "Instantiates Setup class",
              "action_id": "init_setup_class",
              "object": "self.project_config, \"\"",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Prepare directory path",
              "intention_id": "prepare_directory_path"
            },
            {
              "action_api": "self.project_config.set_keychain()",
              "action_description": "Sets attribute on builtins object",
              "action_id": "set_builtin_attr",
              "object": "keychain",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "OrgConfig()",
              "action_description": "Instantiates Setup class",
              "action_id": "init_setup_class",
              "object": "{...}, \"test\"",
              "object_description": "Account name and token",
              "object_id": "account_credentials",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            }
          ]
        }
      ]
    }
  ]
}