{
  "metadata": {
    "package_name": "quart-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/quart-0.20.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "asgi.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/quart-0.20.0/quart-0.20.0/src/quart/asgi.py",
      "line_number": "391",
      "type_description": "B805:send",
      "context_snippet": "class ASGILifespan:\n    def __init__(self, app: Quart, scope: LifespanScope) -> None:\n        self.app = app\n\n    async def __call__(\n        self, receive: ASGIReceiveCallable, send: ASGISendCallable\n    ) -> None:\n        while True:\n            event = await receive()\n            if event[\"type\"] == \"lifespan.startup\":\n                try:\n                    await self.app.startup()\n                except Exception as error:\n                    await send(\n                        cast(\n                            LifespanStartupFailedEvent,\n                            {\"type\": \"lifespan.startup.failed\", \"message\": str(error)},\n                        ),\n                    )\n                else:\n                    await send(\n                        cast(\n                            LifespanStartupCompleteEvent,\n                            {\"type\": \"lifespan.startup.complete\"},\n                        )\n                    )\n            elif event[\"type\"] == \"lifespan.shutdown\":\n                try:\n                    await self.app.shutdown()\n                except Exception as error:\n                    await send(\n                        cast(\n                            LifespanShutdownFailedEvent,\n                            {\"type\": \"lifespan.shutdown.failed\", \"message\": str(error)},\n                        ),\n                    )\n                else:\n                    await send(\n                        cast(\n                            LifespanShutdownCompleteEvent,\n                            {\"type\": \"lifespan.shutdown.complete\"},\n                        ),\n                    )\n                break",
      "hash_value": "ae1ddf812a53b9ea120c2dd18f8b2750",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "class ASGILifespan:\n    def __init__(self, app: Quart, scope: LifespanScope) -> None:\n        self.app = app\n\n    async def __call__(\n        self, receive: ASGIReceiveCallable, send: ASGISendCallable\n    ) -> None:\n        while True:\n            event = await receive()\n            if event[\"type\"] == \"lifespan.startup\":\n                try:\n                    await self.app.startup()\n                except Exception as error:\n                    await send(\n                        cast(\n                            LifespanStartupFailedEvent,\n                            {\"type\": \"lifespan.startup.failed\", \"message\": str(error)},\n                        ),\n                    )\n                else:\n                    await send(\n                        cast(\n                            LifespanStartupCompleteEvent,\n                            {\"type\": \"lifespan.startup.complete\"},\n                        )\n                    )\n            elif event[\"type\"] == \"lifespan.shutdown\":\n                try:\n                    await self.app.shutdown()\n                except Exception as error:\n                    await send(\n                        cast(\n                            LifespanShutdownFailedEvent,\n                            {\"type\": \"lifespan.shutdown.failed\", \"message\": str(error)},\n                        ),\n                    )\n                else:\n                    await send(\n                        cast(\n                            LifespanShutdownCompleteEvent,\n                            {\"type\": \"lifespan.shutdown.complete\"},\n                        ),\n                    )\n                break",
          "triple_sequences": [
            {
              "action_api": "receive()",
              "action_description": "Receives data from socket connection",
              "action_id": "receive_socket_data",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Wait for events",
              "intention_id": "wait_for_events"
            },
            {
              "action_api": "self.app.startup()",
              "action_description": "Runs asynchronous function until completion",
              "action_id": "run_async_function",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Trigger main behavioral logic",
              "intention_id": "trigger_main_behavioral_logic"
            },
            {
              "action_api": "send()",
              "action_description": "Sends data over socket connection",
              "action_id": "send_socket_data",
              "object": "{\"type\": \"lifespan.startup.failed\", \"message\": str(error)}",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Send data to server",
              "intention_id": "send_data_server"
            },
            {
              "action_api": "send()",
              "action_description": "Sends data over socket connection",
              "action_id": "send_socket_data",
              "object": "{\"type\": \"lifespan.startup.complete\"}",
              "object_description": "",
              "object_id": "",
              "intention_description": "Send data to server",
              "intention_id": "send_data_server"
            },
            {
              "action_api": "self.app.shutdown()",
              "action_description": "Runs asynchronous function until completion",
              "action_id": "run_async_function",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Trigger main behavioral logic",
              "intention_id": "trigger_main_behavioral_logic"
            },
            {
              "action_api": "send()",
              "action_description": "Sends data over socket connection",
              "action_id": "send_socket_data",
              "object": "{\"type\": \"lifespan.shutdown.failed\", \"message\": str(error)}",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Send data to server",
              "intention_id": "send_data_server"
            },
            {
              "action_api": "send()",
              "action_description": "Sends data over socket connection",
              "action_id": "send_socket_data",
              "object": "{\"type\": \"lifespan.shutdown.complete\"}",
              "object_description": "",
              "object_id": "",
              "intention_description": "Send data to server",
              "intention_id": "send_data_server"
            }
          ]
        }
      ]
    }
  ]
}