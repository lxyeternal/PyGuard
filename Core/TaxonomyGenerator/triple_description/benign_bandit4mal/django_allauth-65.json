{
  "metadata": {
    "package_name": "django_allauth-65",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign_bandit4mal/django_allauth-65.7.0.json",
    "dataset_type": "benign_bandit4mal"
  },
  "code_files": [
    {
      "pyfile": "__init__.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/django_allauth-65.7.0/django_allauth-65.7.0/allauth/socialaccount/tests/__init__.py",
      "line_number": "228",
      "type_description": "B820:get",
      "context_snippet": "@override_settings(SOCIALACCOUNT_AUTO_SIGNUP=False)\ndef test_login_with_pkce_disabled(self):\n    provider_settings = app_settings.PROVIDERS.get(self.app.provider, {})\n    provider_settings_with_pkce_disabled = provider_settings.copy()\n    provider_settings_with_pkce_disabled[\"OAUTH_PKCE_ENABLED\"] = False\n\n    with self.settings(\n        SOCIALACCOUNT_PROVIDERS={\n            self.app.provider: provider_settings_with_pkce_disabled\n        }\n    ):\n        resp_mock = self.get_mocked_response()\n        if not resp_mock:\n            warnings.warn(\n                \"Cannot test provider %s, no oauth mock\" % self.provider.id\n            )\n            return\n        resp = self.login(\n            resp_mock,\n        )\n        self.assertRedirects(resp, reverse(\"socialaccount_signup\"))",
      "hash_value": "5af635f98eb500f094184c3523b1da22",
      "severity": "High",
      "confidence": "Medium",
      "code_snippets": [
        {
          "snippet": "@override_settings(SOCIALACCOUNT_AUTO_SIGNUP=False)\ndef test_login_with_pkce_disabled(self):\n    provider_settings = app_settings.PROVIDERS.get(self.app.provider, {})\n    provider_settings_with_pkce_disabled = provider_settings.copy()\n    provider_settings_with_pkce_disabled[\"OAUTH_PKCE_ENABLED\"] = False\n\n    with self.settings(\n        SOCIALACCOUNT_PROVIDERS={\n            self.app.provider: provider_settings_with_pkce_disabled\n        }\n    ):\n        resp_mock = self.get_mocked_response()\n        if not resp_mock:\n            warnings.warn(\n                \"Cannot test provider %s, no oauth mock\" % self.provider.id\n            )\n            return\n        resp = self.login(\n            resp_mock,\n        )\n        self.assertRedirects(resp, reverse(\"socialaccount_signup\"))",
          "triple_sequences": [
            {
              "action_api": "app_settings.PROVIDERS.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "self.app.provider",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Access configuration value",
              "intention_id": "access_configuration_value"
            },
            {
              "action_api": "provider_settings.copy()",
              "action_description": "Basic read operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "provider_settings",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Access configuration value",
              "intention_id": "access_configuration_value"
            },
            {
              "action_api": "self.settings()",
              "action_description": "Sets value for registry key",
              "action_id": "set_registry_value",
              "object": "SOCIALACCOUNT_PROVIDERS={self.app.provider: provider_settings_with_pkce_disabled}",
              "object_description": "Registry value",
              "object_id": "registry_value",
              "intention_description": "Access configuration value",
              "intention_id": "access_configuration_value"
            },
            {
              "action_api": "self.get_mocked_response()",
              "action_description": "Reads user input from standard input",
              "action_id": "read_user_input",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Collect user input",
              "intention_id": "collect_user_input"
            },
            {
              "action_api": "warnings.warn()",
              "action_description": "Raises HTTPError if response status code indicates error",
              "action_id": "raise_http_error",
              "object": "\"Cannot test provider %s, no oauth mock\" % self.provider.id",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Stop execution on invalid input",
              "intention_id": "stop_execution_invalid_input"
            },
            {
              "action_api": "self.login()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "resp_mock",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "self.assertRedirects()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "reverse(\"socialaccount_signup\")",
              "object_description": "Path segment",
              "object_id": "path_segment",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            }
          ]
        }
      ]
    }
  ]
}