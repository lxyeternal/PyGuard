{
  "metadata": {
    "package_name": "noblesse-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/tool_detect/false_negative/llm_analysis/noblesse-0.0.5.json",
    "dataset_type": "malware_fn"
  },
  "code_files": [
    {
      "pyfile": "noblesse.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_malware/noblesse-0.0.5/noblesse-0.0.5/src/noblesse.py",
      "code_snippets": [
        {
          "snippet": "import requests\nimport os\nimport datetime\nimport json\n\ndef DMChannel(image,message):\n    src = requests.get(image.url)\n    author = str(message.channel).replace(\"/\",\" \").replace(\":\",\" \").replace(\"*\",\" \").replace(\"?\",\" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    if not os.path.exists(\"files/DMChannels/\" + author):\n        os.mkdir('files/DMChannels/' + author)\n    with open(f'files/DMChannels/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}',\"wb+\") as handle:\n        handle.write(src.content)\n        handle.flush()\n        handle.close()\n\ndef GroupChannel(image,message):\n    src = requests.get(image.url)\n    author = str(message.channel).replace(\"/\",\" \").replace(\":\",\" \").replace(\"*\",\" \").replace(\"?\",\" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    if not os.path.exists(\"files/GroupChannels/\" + author):\n        os.mkdir('files/GroupChannels/' + author)\n    with open(f'files/GroupChannels/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}',\"wb+\") as handle:\n        handle.write(src.content)\n        handle.flush()\n        handle.close()\n\ndef GuildChannel(image,message):\n    src = requests.get(image.url)\n    guild = str(message.guild.name).replace(\"/\",\" \").replace(\":\",\" \").replace(\"*\",\" \").replace(\"?\",\" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    author = str(message.author.name).replace(\"/\",\" \").replace(\":\",\" \").replace(\"*\",\" \").replace(\"?\",\" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    channel = str(message.channel.name).replace(\"/\",\" \").replace(\":\",\" \").replace(\"*\",\" \").replace(\"?\",\" \").replace('\"',' ').replace(\"<\",\" \").replace(\">\",\" \").replace(\"|\",\" \")\n    if not os.path.exists(f\"files/Servers/{guild}\"):\n       os.mkdir(f\"files/Servers/{guild}\") \n    if not os.path.exists(f\"files/Servers/{guild}/{channel}\"):\n        os.mkdir(f\"files/Servers/{guild}/{channel}\")\n    if not os.path.exists(f\"files/Servers/{guild}/{channel}/{author}\"):\n        os.mkdir(f\"files/Servers/{guild}/{channel}/{author}\")\n    with open(f'files/Servers/{guild}/{channel}/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}',\"wb+\") as handle:\n        handle.write(src.content)\n        handle.flush()\n        handle.close()\n\ndef log_attachments(attachment,message,config):\n    payload = {\n        \"username\" : message.author.name,\n        \"avatar_url\" : str(message.author.avatar_url),\n        \"content\" : message.content,\n        \"embeds\" : [\n            {\n                \"author\" : {\n                    \"name\" : message.author.name,\n                    \"url\" : str(message.author.avatar_url),\n                    \"icon_url\" : str(message.author.avatar_url)\n                },\n                \"title\" : attachment.filename,\n                \"description\" : f\"```URL HERE: {attachment.url}```\",\n                \"image\" : {\n                    \"url\" : attachment.url\n                },\n                \"footer\" : {\n                    \"text\" : f\"Message ID: {message.id}\",\n                    \"icon_url\" : str(message.author.avatar_url)\n                }\n            }\n        ]       \n    }\n    requests.post(config['attachment_webhook'],json=payload)\n",
          "triple_sequences": [
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP GET request to URL",
              "action_id": "open_url_get",
              "object": "image.url",
              "object_description": "URL string",
              "object_id": "url_string",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "\"files/DMChannels/\" + author",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "os.mkdir()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "'files/DMChannels/' + author",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f'files/DMChannels/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}', \"wb+\"",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "handle.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "src.content",
              "object_description": "Image binary stream",
              "object_id": "image_binary_stream",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "handle.flush()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "handle.close()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close file",
              "intention_id": "close_file"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP GET request to URL",
              "action_id": "open_url_get",
              "object": "image.url",
              "object_description": "URL string",
              "object_id": "url_string",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "\"files/GroupChannels/\" + author",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "os.mkdir()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "'files/GroupChannels/' + author",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f'files/GroupChannels/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}', \"wb+\"",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "handle.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "src.content",
              "object_description": "Image binary stream",
              "object_id": "image_binary_stream",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "handle.flush()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "handle.close()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close file",
              "intention_id": "close_file"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP GET request to URL",
              "action_id": "open_url_get",
              "object": "image.url",
              "object_description": "URL string",
              "object_id": "url_string",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "f\"files/Servers/{guild}\"",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "os.mkdir()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "f\"files/Servers/{guild}\"",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "f\"files/Servers/{guild}/{channel}\"",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "os.mkdir()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "f\"files/Servers/{guild}/{channel}\"",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "f\"files/Servers/{guild}/{channel}/{author}\"",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "os.mkdir()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "f\"files/Servers/{guild}/{channel}/{author}\"",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "open()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "f'files/Servers/{guild}/{channel}/{author}/{datetime.datetime.now().strftime(\"%Y-%m-%d %H.%M.%S\")} - {image.filename}', \"wb+\"",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Open file for writing",
              "intention_id": "open_file_writing"
            },
            {
              "action_api": "handle.write()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "src.content",
              "object_description": "Image binary stream",
              "object_id": "image_binary_stream",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "handle.flush()",
              "action_description": "File opening operations for writing (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            },
            {
              "action_api": "handle.close()",
              "action_description": "Closes the opened file",
              "action_id": "close_file",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Close file",
              "intention_id": "close_file"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "config['attachment_webhook'], json=payload",
              "object_description": "Webhook endpoint",
              "object_id": "webhook_endpoint",
              "intention_description": "Send data to server",
              "intention_id": "send_data_server"
            }
          ]
        }
      ]
    }
  ]
}