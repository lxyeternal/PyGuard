{
  "metadata": {
    "package_name": "opendatasets-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/opendatasets-0.1.22.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "kaggle_api.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/opendatasets-0.1.22/opendatasets-0.1.22/opendatasets/utils/kaggle_api.py",
      "line_number": "45",
      "type_description": "shady-links",
      "context_snippet": "import os\nfrom opendatasets.utils.kaggle_direct import get_kaggle_dataset_id, is_kaggle_url\nfrom opendatasets.utils.archive import extract_archive\nimport click\nimport json\n\n\ndef download_kaggle_dataset(dataset_url, data_dir, force=False, dry_run=False):\n    dataset_id = get_kaggle_dataset_id(dataset_url)\n    id = dataset_id.split('/')[1]\n    target_dir = os.path.join(data_dir, id)\n\n    if not force and os.path.exists(target_dir) and len(os.listdir(target_dir)) > 0:\n        print('Skipping, found downloaded files in \"{}\" (use force=True to force download)'.format(\n            target_dir))\n        return\n\n    if not read_kaggle_creds():\n        print(\"Please provide your Kaggle credentials to download this dataset. Learn more: http://bit.ly/kaggle-creds\")\n        os.environ['KAGGLE_USERNAME'] = click.prompt(\"Your Kaggle username\")\n        os.environ['KAGGLE_KEY'] = _get_kaggle_key()\n\n    if not dry_run:\n        from kaggle import api\n        api.authenticate()\n        if dataset_id.split('/')[0] == 'competitions' or dataset_id.split('/')[0] == 'c':\n            api.competition_download_files(\n                id,\n                target_dir,\n                force=force,\n                quiet=False)\n            zip_fname = target_dir + '/' + id + '.zip'\n            extract_archive(zip_fname, target_dir)\n            try:\n                os.remove(zip_fname)\n            except OSError as e:\n                print('Could not delete zip file, got' + str(e))\n        else:\n            api.dataset_download_files(\n                dataset_id,\n                target_dir,\n                force=force,\n                quiet=False,\n                unzip=True)\n\n    else:\n        print(\"This is a dry run, skipping..\")",
      "hash_value": "9986b24d6e8e24168f4e2382ae1cff9f",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "import os\nfrom opendatasets.utils.kaggle_direct import get_kaggle_dataset_id, is_kaggle_url\nfrom opendatasets.utils.archive import extract_archive\nimport click\nimport json\n\n\ndef download_kaggle_dataset(dataset_url, data_dir, force=False, dry_run=False):\n    dataset_id = get_kaggle_dataset_id(dataset_url)\n    id = dataset_id.split('/')[1]\n    target_dir = os.path.join(data_dir, id)\n\n    if not force and os.path.exists(target_dir) and len(os.listdir(target_dir)) > 0:\n        print('Skipping, found downloaded files in \"{}\" (use force=True to force download)'.format(\n            target_dir))\n        return\n\n    if not read_kaggle_creds():\n        print(\"Please provide your Kaggle credentials to download this dataset. Learn more: http://bit.ly/kaggle-creds\")\n        os.environ['KAGGLE_USERNAME'] = click.prompt(\"Your Kaggle username\")\n        os.environ['KAGGLE_KEY'] = _get_kaggle_key()\n\n    if not dry_run:\n        from kaggle import api\n        api.authenticate()\n        if dataset_id.split('/')[0] == 'competitions' or dataset_id.split('/')[0] == 'c':\n            api.competition_download_files(\n                id,\n                target_dir,\n                force=force,\n                quiet=False)\n            zip_fname = target_dir + '/' + id + '.zip'\n            extract_archive(zip_fname, target_dir)\n            try:\n                os.remove(zip_fname)\n            except OSError as e:\n                print('Could not delete zip file, got' + str(e))\n        else:\n            api.dataset_download_files(\n                dataset_id,\n                target_dir,\n                force=force,\n                quiet=False,\n                unzip=True)\n\n    else:\n        print(\"This is a dry run, skipping..\")",
          "triple_sequences": [
            {
              "action_api": "get_kaggle_dataset_id()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "dataset_url",
              "object_description": "URL string",
              "object_id": "url_string",
              "intention_description": "Prepare path for browser data access",
              "intention_id": "prepare_path_browser_data"
            },
            {
              "action_api": "str.split()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "dataset_id",
              "object_description": "String containing environment data",
              "object_id": "string_environment_data",
              "intention_description": "Prepare path for browser data access",
              "intention_id": "prepare_path_browser_data"
            },
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "data_dir, id",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "target_dir",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "os.listdir()",
              "action_description": "List directory contents",
              "action_id": "list_directory_contents",
              "object": "target_dir",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "read_kaggle_creds()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "click.prompt()",
              "action_description": "Reads user input from standard input",
              "action_id": "read_user_input",
              "object": "\"Your Kaggle username\"",
              "object_description": "Username string",
              "object_id": "username_string",
              "intention_description": "Collect user input",
              "intention_id": "collect_user_input"
            },
            {
              "action_api": "_get_kaggle_key()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "api.authenticate()",
              "action_description": "Establishes connection",
              "action_id": "establish_connection",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Establish connection",
              "intention_id": "establish_connection"
            },
            {
              "action_api": "api.competition_download_files()",
              "action_description": "Downloads file from URL to local path",
              "action_id": "download_file_url",
              "object": "id, target_dir, force=force, quiet=False",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "extract_archive()",
              "action_description": "Extracts all files from ZIP archive to specified directory",
              "action_id": "extract_zip_files",
              "object": "zip_fname, target_dir",
              "object_description": "ZIP archive file",
              "object_id": "zip_archive",
              "intention_description": "Decompress downloaded archive",
              "intention_id": "decompress_downloaded_archive"
            },
            {
              "action_api": "os.remove()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "zip_fname",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            },
            {
              "action_api": "api.dataset_download_files()",
              "action_description": "Downloads file from URL to local path",
              "action_id": "download_file_url",
              "object": "dataset_id, target_dir, force=force, quiet=False, unzip=True",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            }
          ]
        }
      ]
    }
  ]
}