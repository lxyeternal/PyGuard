{
  "metadata": {
    "package_name": "dycw_utilities-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/dycw_utilities-0.105.0.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "http.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/dycw_utilities-0.105.0/dycw_utilities-0.105.0/src/utilities/http.py",
      "line_number": "14",
      "type_description": "shady-links",
      "context_snippet": "from __future__ import annotations\n\nfrom contextlib import contextmanager\nfrom http.client import HTTPSConnection\nfrom ipaddress import IPv4Address\nfrom typing import TYPE_CHECKING\n\nif TYPE_CHECKING:\n    from collections.abc import Iterator\n\n\ndef get_public_ip(*, timeout: float | None = None) -> IPv4Address:\n    \"\"\"Get your public IP address.\"\"\"\n    with yield_connection(\"api.ipify.org\", timeout=timeout) as conn:  # pragma: no cover\n        conn.request(\"GET\", \"/?format=text\")\n        response = conn.getresponse()\n        address = response.read().decode(\"utf8\")\n    return IPv4Address(address)  # pragma: no cover\n\n\n@contextmanager\ndef yield_connection(\n    host: str, /, *, timeout: float | None = None\n) -> Iterator[HTTPSConnection]:\n    \"\"\"Yield an HTTP connection.\"\"\"\n    conn = HTTPSConnection(host, timeout=timeout)\n    try:\n        yield conn\n    finally:\n        conn.close()",
      "hash_value": "d6de9150db253c3d737c6a9142ea3cd7",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "from __future__ import annotations\n\nfrom contextlib import contextmanager\nfrom http.client import HTTPSConnection\nfrom ipaddress import IPv4Address\nfrom typing import TYPE_CHECKING\n\nif TYPE_CHECKING:\n    from collections.abc import Iterator\n\n\ndef get_public_ip(*, timeout: float | None = None) -> IPv4Address:\n    \"\"\"Get your public IP address.\"\"\"\n    with yield_connection(\"api.ipify.org\", timeout=timeout) as conn:  # pragma: no cover\n        conn.request(\"GET\", \"/?format=text\")\n        response = conn.getresponse()\n        address = response.read().decode(\"utf8\")\n    return IPv4Address(address)  # pragma: no cover\n\n\n@contextmanager\ndef yield_connection(\n    host: str, /, *, timeout: float | None = None\n) -> Iterator[HTTPSConnection]:\n    \"\"\"Yield an HTTP connection.\"\"\"\n    conn = HTTPSConnection(host, timeout=timeout)\n    try:\n        yield conn\n    finally:\n        conn.close()",
          "triple_sequences": [
            {
              "action_api": "HTTPSConnection()",
              "action_description": "Creates HTTP connection to specified host",
              "action_id": "create_http_connection",
              "object": "api.ipify.org",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Connect to remote server",
              "intention_id": "connect_remote_server"
            },
            {
              "action_api": "HTTPSConnection.request()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "\"GET\", \"/?format=text\"",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "HTTPSConnection.getresponse()",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Decode downloaded content",
              "intention_id": "decode_downloaded_content"
            },
            {
              "action_api": "HTTPResponse.read()",
              "action_description": "Receives data from socket connection",
              "action_id": "receive_socket_data",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "str.decode()",
              "action_description": "Decodes bytes using specified codec",
              "action_id": "decode_bytes_codec",
              "object": "\"utf8\"",
              "object_description": "Character encoding type",
              "object_id": "character_encoding_type",
              "intention_description": "Decode downloaded content",
              "intention_id": "decode_downloaded_content"
            },
            {
              "action_api": "IPv4Address()",
              "action_description": "Converts 32-bit packed IPv4 address to string",
              "action_id": "convert_ipv4_addr",
              "object": "address",
              "object_description": "Public IP address",
              "object_id": "public_ip_address",
              "intention_description": "Extract public IP address",
              "intention_id": "extract_public_ip_address"
            },
            {
              "action_api": "HTTPSConnection.close()",
              "action_description": "Closes the socket connection",
              "action_id": "close_socket",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Release connection resource",
              "intention_id": "release_connection_resource"
            }
          ]
        }
      ]
    }
  ]
}