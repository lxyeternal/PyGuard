{
  "metadata": {
    "package_name": "serial-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/serial-0.0.97.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "__init__.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/serial-0.0.97/serial-0.0.97/serial/utilities/__init__.py",
      "line_number": "179",
      "type_description": "obfuscation",
      "context_snippet": "def calling_function_qualified_name(depth=1):\n    # type: (int) -> Optional[str]\n    \"\"\"\n    >>> def my_function(): return calling_function_qualified_name()\n    >>> print(my_function())\n    \"\"\"\n\n    if not isinstance(depth, int):\n\n        depth_representation = repr(depth)\n\n        raise TypeError(\n            'The parameter `depth` for `serial.utilities.calling_function_qualified_name` must be an `int`, not' +\n            (\n                (':\\n%s' if '\\n' in depth_representation else ' %s.') %\n                depth_representation\n            )\n        )\n    try:\n        stack = inspect.stack()\n    except IndexError:\n        return None\n\n    if len(stack) < (depth + 1):\n        return None\n\n    name_list = []\n    frame_info = stack[depth]  # type: inspect.FrameInfo\n\n    try:\n        frame_function = frame_info.function\n    except AttributeError:\n        frame_function = frame_info[3]\n\n    if frame_function != '<module>':\n\n        try:\n            frame = frame_info.frame\n        except AttributeError:\n            frame = frame_info[0]\n\n        name_list.append(frame_function)\n        arguments, _, _, frame_locals = inspect.getargvalues(frame)\n\n        if arguments:\n\n            argument = arguments[0]\n            argument_value = frame_locals[argument]\n            argument_value_type = type(argument_value)\n\n            if (\n                hasattr(argument_value_type, '__name__') and\n                hasattr(argument_value_type, '__module__') and\n                (\n                    (argument_value_type.__name__ not in dir(builtins)) or\n                    (getattr(builtins, argument_value_type.__name__) is not argument_value_type)\n                )\n            ):\n                name_list.append(qualified_name(argument_value_type))\n\n    if len(name_list) < 2:\n\n        try:\n            file_name = frame_info.filename\n        except AttributeError:\n            file_name = frame_info[1]\n\n        module_name = inspect.getmodulename(file_name)\n\n        if (module_name is not None) and (module_name not in sys.modules):\n\n            path_parts = list(os.path.split(file_name))\n            path_parts.pop()\n\n            while path_parts:\n\n                parent = path_parts.pop()\n                module_name = parent + '.' + module_name\n\n                if module_name in sys.modules:\n                    break\n\n        if module_name is None:\n            raise ValueError('The path \"%s\" is not a python module' % file_name)\n        else:\n            if module_name in sys.modules:\n                qualified_module_name = qualified_name(sys.modules[module_name])\n                name_list.append(qualified_module_name)\n\n    return '.'.join(reversed(name_list))\n\n# Data dependencies:\n# - 'builtins' is imported at the top: import builtins\n# - 'argument_value_type' is set as type(argument_value) in this function\n# - 'qualified_name' is a helper function defined above\n# - 'inspect' is imported at the top\n# - 'os', 'sys' are imported at the top\n",
      "hash_value": "435c316d7c00213c209be573d29c208d",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "def calling_function_qualified_name(depth=1):\n    # type: (int) -> Optional[str]\n    \"\"\"\n    >>> def my_function(): return calling_function_qualified_name()\n    >>> print(my_function())\n    \"\"\"\n\n    if not isinstance(depth, int):\n\n        depth_representation = repr(depth)\n\n        raise TypeError(\n            'The parameter `depth` for `serial.utilities.calling_function_qualified_name` must be an `int`, not' +\n            (\n                (':\\n%s' if '\\n' in depth_representation else ' %s.') %\n                depth_representation\n            )\n        )\n    try:\n        stack = inspect.stack()\n    except IndexError:\n        return None\n\n    if len(stack) < (depth + 1):\n        return None\n\n    name_list = []\n    frame_info = stack[depth]  # type: inspect.FrameInfo\n\n    try:\n        frame_function = frame_info.function\n    except AttributeError:\n        frame_function = frame_info[3]\n\n    if frame_function != '<module>':\n\n        try:\n            frame = frame_info.frame\n        except AttributeError:\n            frame = frame_info[0]\n\n        name_list.append(frame_function)\n        arguments, _, _, frame_locals = inspect.getargvalues(frame)\n\n        if arguments:\n\n            argument = arguments[0]\n            argument_value = frame_locals[argument]\n            argument_value_type = type(argument_value)\n\n            if (\n                hasattr(argument_value_type, '__name__') and\n                hasattr(argument_value_type, '__module__') and\n                (\n                    (argument_value_type.__name__ not in dir(builtins)) or\n                    (getattr(builtins, argument_value_type.__name__) is not argument_value_type)\n                )\n            ):\n                name_list.append(qualified_name(argument_value_type))\n\n    if len(name_list) < 2:\n\n        try:\n            file_name = frame_info.filename\n        except AttributeError:\n            file_name = frame_info[1]\n\n        module_name = inspect.getmodulename(file_name)\n\n        if (module_name is not None) and (module_name not in sys.modules):\n\n            path_parts = list(os.path.split(file_name))\n            path_parts.pop()\n\n            while path_parts:\n\n                parent = path_parts.pop()\n                module_name = parent + '.' + module_name\n\n                if module_name in sys.modules:\n                    break\n\n        if module_name is None:\n            raise ValueError('The path \"%s\" is not a python module' % file_name)\n        else:\n            if module_name in sys.modules:\n                qualified_module_name = qualified_name(sys.modules[module_name])\n                name_list.append(qualified_module_name)\n\n    return '.'.join(reversed(name_list))\n\n# Data dependencies:\n# - 'builtins' is imported at the top: import builtins\n# - 'argument_value_type' is set as type(argument_value) in this function\n# - 'qualified_name' is a helper function defined above\n# - 'inspect' is imported at the top\n# - 'os', 'sys' are imported at the top\n",
          "triple_sequences": [
            {
              "action_api": "isinstance()",
              "action_description": "Checks if object is instance of specified type",
              "action_id": "check_instance_type",
              "object": "depth, int",
              "object_description": "",
              "object_id": "",
              "intention_description": "Determine required module presence",
              "intention_id": "determine_required_module_presence"
            },
            {
              "action_api": "repr()",
              "action_description": "Converts object to string representation",
              "action_id": "prepare_string_processing",
              "object": "depth",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "inspect.stack()",
              "action_description": "Extracts current call stack as FrameSummary objects",
              "action_id": "extract_call_stack",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "len()",
              "action_description": "Returns length of object",
              "action_id": "prepare_data_processing",
              "object": "stack",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "hasattr()",
              "action_description": "Checks if object has specified attribute",
              "action_id": "prepare_data_processing",
              "object": "argument_value_type, '__name__'",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "hasattr()",
              "action_description": "Checks if object has specified attribute",
              "action_id": "prepare_data_processing",
              "object": "argument_value_type, '__module__'",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "dir()",
              "action_description": "Returns list of attributes for object",
              "action_id": "prepare_data_processing",
              "object": "builtins",
              "object_description": "Built-in module or package",
              "object_id": "builtin_module",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "getattr()",
              "action_description": "Retrieves attribute value from object",
              "action_id": "prepare_data_processing",
              "object": "builtins, argument_value_type.__name__",
              "object_description": "Built-in module or package",
              "object_id": "builtin_module",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "os.path.split()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "file_name",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Prepare path for file operations",
              "intention_id": "prepare_path_file_operations"
            },
            {
              "action_api": "inspect.getmodulename()",
              "action_description": "Special path operations (home directory expansion, temporary directory path, executable path, directory tree generation)",
              "action_id": "path_special_operations",
              "object": "file_name",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Prepare path for browser data access",
              "intention_id": "prepare_path_browser_data"
            },
            {
              "action_api": "sys.modules",
              "action_description": "Dynamically imports specified module",
              "action_id": "import_dynamic",
              "object": "module_name",
              "object_description": "Module name string",
              "object_id": "module_name_string",
              "intention_description": "Import module dynamically",
              "intention_id": "import_module_dynamically"
            },
            {
              "action_api": "qualified_name()",
              "action_description": "Constructs qualified name for object",
              "action_id": "prepare_string_processing",
              "object": "argument_value_type or sys.modules[module_name]",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "str.join()",
              "action_description": "Joins characters into string",
              "action_id": "join_characters_into_string",
              "object": "reversed(name_list)",
              "object_description": "",
              "object_id": "",
              "intention_description": "Join characters into string",
              "intention_id": "join_characters_into_string"
            }
          ]
        }
      ]
    }
  ]
}