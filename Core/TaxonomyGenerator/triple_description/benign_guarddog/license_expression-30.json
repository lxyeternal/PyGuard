{
  "metadata": {
    "package_name": "license_expression-30",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/license_expression-30.4.1.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "utils_dejacode.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/license_expression-30.4.1/license_expression-30.4.1/etc/scripts/utils_dejacode.py",
      "line_number": "51",
      "type_description": "exfiltrate-sensitive-data",
      "context_snippet": "import requests\n\nDEJACODE_API_KEY = os.environ.get(\"DEJACODE_API_KEY\", \"\")\nDEJACODE_API_URL = os.environ.get(\"DEJACODE_API_URL\", \"\")\n\nDEJACODE_API_URL_PACKAGES = f\"{DEJACODE_API_URL}packages/\"\nDEJACODE_API_HEADERS = {\n    \"Authorization\": \"Token {}\".format(DEJACODE_API_KEY),\n    \"Accept\": \"application/json; indent=4\",\n}\n\ndef can_do_api_calls():\n    if not DEJACODE_API_KEY and DEJACODE_API_URL:\n        print(\n            \"DejaCode DEJACODE_API_KEY and DEJACODE_API_URL not configured. Doing nothing\")\n        return False\n    else:\n        return True\n\ndef fetch_dejacode_packages(params):\n    \"\"\"\n    Return a list of package data mappings calling the package API with using\n    `params` or an empty list.\n    \"\"\"\n    if not can_do_api_calls():\n        return []\n\n    response = requests.get(\n        DEJACODE_API_URL_PACKAGES,\n        params=params,\n        headers=DEJACODE_API_HEADERS,\n    )\n\n    return response.json()[\"results\"]",
      "hash_value": "15c5f6856345eae5ab4375652f12184b",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "import requests\n\nDEJACODE_API_KEY = os.environ.get(\"DEJACODE_API_KEY\", \"\")\nDEJACODE_API_URL = os.environ.get(\"DEJACODE_API_URL\", \"\")\n\nDEJACODE_API_URL_PACKAGES = f\"{DEJACODE_API_URL}packages/\"\nDEJACODE_API_HEADERS = {\n    \"Authorization\": \"Token {}\".format(DEJACODE_API_KEY),\n    \"Accept\": \"application/json; indent=4\",\n}\n\ndef can_do_api_calls():\n    if not DEJACODE_API_KEY and DEJACODE_API_URL:\n        print(\n            \"DejaCode DEJACODE_API_KEY and DEJACODE_API_URL not configured. Doing nothing\")\n        return False\n    else:\n        return True\n\ndef fetch_dejacode_packages(params):\n    \"\"\"\n    Return a list of package data mappings calling the package API with using\n    `params` or an empty list.\n    \"\"\"\n    if not can_do_api_calls():\n        return []\n\n    response = requests.get(\n        DEJACODE_API_URL_PACKAGES,\n        params=params,\n        headers=DEJACODE_API_HEADERS,\n    )\n\n    return response.json()[\"results\"]",
          "triple_sequences": [
            {
              "action_api": "os.environ.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"DEJACODE_API_KEY\", \"\"",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.environ.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"DEJACODE_API_URL\", \"\"",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP GET request to URL",
              "action_id": "open_url_get",
              "object": "DEJACODE_API_URL_PACKAGES, params=params, headers=DEJACODE_API_HEADERS",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "response.json()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            }
          ]
        }
      ]
    }
  ]
}