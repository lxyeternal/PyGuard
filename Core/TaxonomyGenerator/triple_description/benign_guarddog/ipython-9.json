{
  "metadata": {
    "package_name": "ipython-9",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/ipython-9.1.0.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "guarded_eval.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/ipython-9.1.0/ipython-9.1.0/IPython/core/guarded_eval.py",
      "line_number": "721",
      "type_description": "obfuscation",
      "context_snippet": "def _eval_node_name(node_id: str, context: EvaluationContext):\n    policy = EVALUATION_POLICIES[context.evaluation]\n    if policy.allow_locals_access and node_id in context.locals:\n        return context.locals[node_id]\n    if policy.allow_globals_access and node_id in context.globals:\n        return context.globals[node_id]\n    if policy.allow_builtins_access and hasattr(builtins, node_id):\n        # note: do not use __builtins__, it is implementation detail of cPython\n        return getattr(builtins, node_id)\n    if not policy.allow_globals_access and not policy.allow_locals_access:\n        raise GuardRejection(\n            f\"Namespace access not allowed in {context.evaluation} mode\"\n        )\n    else:\n        raise NameError(f\"{node_id} not found in locals, globals, nor builtins\")",
      "hash_value": "fd356d510f80374559895c1f558534fc",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "def _eval_node_name(node_id: str, context: EvaluationContext):\n    policy = EVALUATION_POLICIES[context.evaluation]\n    if policy.allow_locals_access and node_id in context.locals:\n        return context.locals[node_id]\n    if policy.allow_globals_access and node_id in context.globals:\n        return context.globals[node_id]\n    if policy.allow_builtins_access and hasattr(builtins, node_id):\n        # note: do not use __builtins__, it is implementation detail of cPython\n        return getattr(builtins, node_id)\n    if not policy.allow_globals_access and not policy.allow_locals_access:\n        raise GuardRejection(\n            f\"Namespace access not allowed in {context.evaluation} mode\"\n        )\n    else:\n        raise NameError(f\"{node_id} not found in locals, globals, nor builtins\")",
          "triple_sequences": [
            {
              "action_api": "hasattr()",
              "action_description": "Checks if object is instance of specified type",
              "action_id": "check_instance_type",
              "object": "builtins, node_id",
              "object_description": "Built-in module or package",
              "object_id": "builtin_module",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "getattr()",
              "action_description": "Sets attribute on builtins object",
              "action_id": "set_builtin_attr",
              "object": "builtins, node_id",
              "object_description": "Built-in module or package",
              "object_id": "builtin_module",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "raise GuardRejection",
              "action_description": "Raises HTTPError if response status code indicates error",
              "action_id": "raise_http_error",
              "object": "f\"Namespace access not allowed in {context.evaluation} mode\"",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Stop execution on invalid input",
              "intention_id": "stop_execution_invalid_input"
            },
            {
              "action_api": "raise NameError",
              "action_description": "Raises HTTPError if response status code indicates error",
              "action_id": "raise_http_error",
              "object": "f\"{node_id} not found in locals, globals, nor builtins\"",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Stop execution on invalid input",
              "intention_id": "stop_execution_invalid_input"
            }
          ]
        }
      ]
    }
  ]
}