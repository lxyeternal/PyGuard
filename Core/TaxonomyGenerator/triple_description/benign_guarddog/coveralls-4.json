{
  "metadata": {
    "package_name": "coveralls-4",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/coveralls-4.0.1.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "api.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/coveralls-4.0.1/coveralls-4.0.1/coveralls/api.py",
      "line_number": "280",
      "type_description": "exfiltrate-sensitive-data",
      "context_snippet": "def submit_report(self, json_string):\n    endpoint = f'{self._coveralls_host.rstrip(\"/\")}/api/v1/jobs'\n    verify = not bool(os.environ.get('COVERALLS_SKIP_SSL_VERIFY'))\n    response = requests.post(\n        endpoint, files={'json_file': json_string}, verify=verify,\n    )\n\n    if response.status_code == 422:\n        if self.config['service_name'].startswith('github'):\n            print(\n                'Received 422 submitting job via Github Actions. By '\n                'default, coveralls-python uses the \"github\" service '\n                'name, which requires you to set the $GITHUB_TOKEN '\n                'environment variable. If you want to use a '\n                'COVERALLS_REPO_TOKEN instead, please manually override '\n                '$COVERALLS_SERVICE_NAME to \"github-actions\". For more '\n                'info, see https://coveralls-python.readthedocs.io/en'\n                '/latest/usage/configuration.html#github-actions-support',\n            )\n\n    try:\n        response.raise_for_status()\n        data = response.json()\n    except Exception as e:\n        raise CoverallsException(\n            f'Could not submit coverage: {e}',\n        ) from e\n\n    return data",
      "hash_value": "694caa149f0f7c5630aae5ecb5661c8d",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "def submit_report(self, json_string):\n    endpoint = f'{self._coveralls_host.rstrip(\"/\")}/api/v1/jobs'\n    verify = not bool(os.environ.get('COVERALLS_SKIP_SSL_VERIFY'))\n    response = requests.post(\n        endpoint, files={'json_file': json_string}, verify=verify,\n    )\n\n    if response.status_code == 422:\n        if self.config['service_name'].startswith('github'):\n            print(\n                'Received 422 submitting job via Github Actions. By '\n                'default, coveralls-python uses the \"github\" service '\n                'name, which requires you to set the $GITHUB_TOKEN '\n                'environment variable. If you want to use a '\n                'COVERALLS_REPO_TOKEN instead, please manually override '\n                '$COVERALLS_SERVICE_NAME to \"github-actions\". For more '\n                'info, see https://coveralls-python.readthedocs.io/en'\n                '/latest/usage/configuration.html#github-actions-support',\n            )\n\n    try:\n        response.raise_for_status()\n        data = response.json()\n    except Exception as e:\n        raise CoverallsException(\n            f'Could not submit coverage: {e}',\n        ) from e\n\n    return data",
          "triple_sequences": [
            {
              "action_api": "os.environ.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "COVERALLS_SKIP_SSL_VERIFY",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "endpoint, files={'json_file': json_string}, verify=verify",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Transmit encoded data via HTTP POST",
              "intention_id": "transmit_data_http_post"
            },
            {
              "action_api": "response.status_code",
              "action_description": "Retrieves HTTP response status code",
              "action_id": "get_http_status",
              "object": "response",
              "object_description": "HTTP response remote content",
              "object_id": "http_response_remote_content",
              "intention_description": "Extract file upload response",
              "intention_id": "extract_file_upload_response"
            },
            {
              "action_api": "response.raise_for_status()",
              "action_description": "Raises HTTPError if response status code indicates error",
              "action_id": "raise_http_error",
              "object": "response",
              "object_description": "HTTP response remote content",
              "object_id": "http_response_remote_content",
              "intention_description": "Stop execution on invalid input",
              "intention_id": "stop_execution_invalid_input"
            },
            {
              "action_api": "response.json()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "response",
              "object_description": "HTTP response remote content",
              "object_id": "http_response_remote_content",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            }
          ]
        }
      ]
    }
  ]
}