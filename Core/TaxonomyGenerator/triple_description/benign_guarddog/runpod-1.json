{
  "metadata": {
    "package_name": "runpod-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/runpod-1.7.9.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "graphql.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/runpod-1.7.9/runpod-1.7.9/runpod/api/graphql.py",
      "line_number": "33",
      "type_description": "exfiltrate-sensitive-data",
      "context_snippet": "import json\nimport os\nfrom typing import Any, Dict\n\nimport requests\n\nfrom runpod import error\nfrom runpod.user_agent import USER_AGENT\n\nHTTP_STATUS_UNAUTHORIZED = 401\n\n\ndef run_graphql_query(query: str) -> Dict[str, Any]:\n    \"\"\"\n    Run a GraphQL query\n    \"\"\"\n    from runpod import api_key  # pylint: disable=import-outside-toplevel, cyclic-import\n\n    api_url_base = os.environ.get(\"RUNPOD_API_BASE_URL\", \"https://api.runpod.io\")\n    url = f\"{api_url_base}/graphql\"\n\n    headers = {\n        \"Content-Type\": \"application/json\",\n        \"User-Agent\": USER_AGENT,\n        \"Authorization\": f\"Bearer {api_key}\",\n    }\n\n    data = json.dumps({\"query\": query})\n    response = requests.post(url, headers=headers, data=data, timeout=30)\n\n    if response.status_code == HTTP_STATUS_UNAUTHORIZED:\n        raise error.AuthenticationError(\n            \"Unauthorized request, please check your API key.\"\n        )\n\n    if \"errors\" in response.json():\n        raise error.QueryError(response.json()[\"errors\"][0][\"message\"], query)\n\n    return response.json()",
      "hash_value": "ac56a545c554054ee81f8d2381ea2096",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "import json\nimport os\nfrom typing import Any, Dict\n\nimport requests\n\nfrom runpod import error\nfrom runpod.user_agent import USER_AGENT\n\nHTTP_STATUS_UNAUTHORIZED = 401\n\n\ndef run_graphql_query(query: str) -> Dict[str, Any]:\n    \"\"\"\n    Run a GraphQL query\n    \"\"\"\n    from runpod import api_key  # pylint: disable=import-outside-toplevel, cyclic-import\n\n    api_url_base = os.environ.get(\"RUNPOD_API_BASE_URL\", \"https://api.runpod.io\")\n    url = f\"{api_url_base}/graphql\"\n\n    headers = {\n        \"Content-Type\": \"application/json\",\n        \"User-Agent\": USER_AGENT,\n        \"Authorization\": f\"Bearer {api_key}\",\n    }\n\n    data = json.dumps({\"query\": query})\n    response = requests.post(url, headers=headers, data=data, timeout=30)\n\n    if response.status_code == HTTP_STATUS_UNAUTHORIZED:\n        raise error.AuthenticationError(\n            \"Unauthorized request, please check your API key.\"\n        )\n\n    if \"errors\" in response.json():\n        raise error.QueryError(response.json()[\"errors\"][0][\"message\"], query)\n\n    return response.json()",
          "triple_sequences": [
            {
              "action_api": "os.environ.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "RUNPOD_API_BASE_URL",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "json.dumps()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "{\"query\": query}",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "url, headers=headers, data=data, timeout=30",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Transmit encoded data via HTTP POST",
              "intention_id": "transmit_data_http_post"
            },
            {
              "action_api": "response.status_code",
              "action_description": "Retrieves HTTP response status code",
              "action_id": "get_http_status",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "response.json()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "raise error.AuthenticationError()",
              "action_description": "Raises HTTPError if response status code indicates error",
              "action_id": "raise_http_error",
              "object": "\"Unauthorized request, please check your API key.\"",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Stop execution on invalid input",
              "intention_id": "stop_execution_invalid_input"
            },
            {
              "action_api": "raise error.QueryError()",
              "action_description": "Raises HTTPError if response status code indicates error",
              "action_id": "raise_http_error",
              "object": "response.json()[\"errors\"][0][\"message\"], query",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Stop execution on invalid input",
              "intention_id": "stop_execution_invalid_input"
            }
          ]
        }
      ]
    }
  ]
}