{
  "metadata": {
    "package_name": "autotrain_advanced-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/autotrain_advanced-0.8.36.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "ngc.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/autotrain_advanced-0.8.36/autotrain_advanced-0.8.36/src/autotrain/backends/ngc.py",
      "line_number": "61",
      "type_description": "exfiltrate-sensitive-data",
      "context_snippet": "import base64\nimport json\nimport os\n\nimport requests\nfrom requests.exceptions import HTTPError\n\nfrom autotrain import logger\nfrom autotrain.backends.base import BaseBackend\n\nNGC_API = os.environ.get(\"NGC_API\", \"https://api.ngc.nvidia.com/v2/org\")\nNGC_AUTH = os.environ.get(\"NGC_AUTH\", \"https://authn.nvidia.com\")\nNGC_ACE = os.environ.get(\"NGC_ACE\")\nNGC_ORG = os.environ.get(\"NGC_ORG\")\nNGC_API_KEY = os.environ.get(\"NGC_CLI_API_KEY\")\nNGC_TEAM = os.environ.get(\"NGC_TEAM\")\n\nclass NGCRunner(BaseBackend):\n    def _user_authentication_ngc(self):\n        logger.info(\"Authenticating NGC user...\")\n        scope = \"group/ngc\"\n\n        querystring = {\"service\": \"ngc\", \"scope\": scope}\n        auth = f\"$oauthtoken:{NGC_API_KEY}\"\n        headers = {\n            \"Authorization\": f\"Basic {base64.b64encode(auth.encode('utf-8')).decode('utf-8')}\",\n            \"Content-Type\": \"application/json\",\n            \"Cache-Control\": \"no-cache\",\n        }\n        try:\n            response = requests.get(NGC_AUTH + \"/token\", headers=headers, params=querystring, timeout=30)\n        except HTTPError as http_err:\n            logger.error(f\"HTTP error occurred: {http_err}\")\n            raise Exception(\"HTTP Error %d: from '%s'\" % (response.status_code, NGC_AUTH))\n        except (requests.Timeout, ConnectionError) as err:\n            logger.error(f\"Failed to request NGC token - {repr(err)}\")\n            raise Exception(\"%s is unreachable, please try again later.\" % NGC_AUTH)\n        return json.loads(response.text.encode(\"utf8\"))[\"token\"]",
      "hash_value": "66dc77ed8c23ec6f915557c012e1c421",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "import base64\nimport json\nimport os\n\nimport requests\nfrom requests.exceptions import HTTPError\n\nfrom autotrain import logger\nfrom autotrain.backends.base import BaseBackend\n\nNGC_API = os.environ.get(\"NGC_API\", \"https://api.ngc.nvidia.com/v2/org\")\nNGC_AUTH = os.environ.get(\"NGC_AUTH\", \"https://authn.nvidia.com\")\nNGC_ACE = os.environ.get(\"NGC_ACE\")\nNGC_ORG = os.environ.get(\"NGC_ORG\")\nNGC_API_KEY = os.environ.get(\"NGC_CLI_API_KEY\")\nNGC_TEAM = os.environ.get(\"NGC_TEAM\")\n\nclass NGCRunner(BaseBackend):\n    def _user_authentication_ngc(self):\n        logger.info(\"Authenticating NGC user...\")\n        scope = \"group/ngc\"\n\n        querystring = {\"service\": \"ngc\", \"scope\": scope}\n        auth = f\"$oauthtoken:{NGC_API_KEY}\"\n        headers = {\n            \"Authorization\": f\"Basic {base64.b64encode(auth.encode('utf-8')).decode('utf-8')}\",\n            \"Content-Type\": \"application/json\",\n            \"Cache-Control\": \"no-cache\",\n        }\n        try:\n            response = requests.get(NGC_AUTH + \"/token\", headers=headers, params=querystring, timeout=30)\n        except HTTPError as http_err:\n            logger.error(f\"HTTP error occurred: {http_err}\")\n            raise Exception(\"HTTP Error %d: from '%s'\" % (response.status_code, NGC_AUTH))\n        except (requests.Timeout, ConnectionError) as err:\n            logger.error(f\"Failed to request NGC token - {repr(err)}\")\n            raise Exception(\"%s is unreachable, please try again later.\" % NGC_AUTH)\n        return json.loads(response.text.encode(\"utf8\"))[\"token\"]",
          "triple_sequences": [
            {
              "action_api": "os.environ.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "NGC_API",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.environ.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "NGC_AUTH",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.environ.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "NGC_ACE",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.environ.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "NGC_ORG",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.environ.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "NGC_CLI_API_KEY",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.environ.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "NGC_TEAM",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "base64.b64encode()",
              "action_description": "Encodes bytes to base64-encoded bytes",
              "action_id": "encode_bytes_to_base64",
              "object": "auth.encode('utf-8')",
              "object_description": "Encoded string to bytes",
              "object_id": "encoded_string_bytes",
              "intention_description": "Prepare data for base64 encoding",
              "intention_id": "prepare_data_base64_encoding"
            },
            {
              "action_api": "str.encode()",
              "action_description": "Encodes string to bytes using default encoding",
              "action_id": "encode_string_to_bytes",
              "object": "auth",
              "object_description": "Encoded string to bytes",
              "object_id": "encoded_string_bytes",
              "intention_description": "Encode string to bytes",
              "intention_id": "encode_string_to_bytes"
            },
            {
              "action_api": "str.decode()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Decode bytes to string",
              "intention_id": "decode_bytes_to_string"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "NGC_AUTH + \"/token\"",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "json.loads()",
              "action_description": "Deserializes JSON string to Python object",
              "action_id": "deserialize_from_json",
              "object": "response.text.encode(\"utf8\")",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            }
          ]
        }
      ]
    }
  ]
}