{
  "metadata": {
    "package_name": "tiledbsoma-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/tiledbsoma-1.16.1.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/tiledbsoma-1.16.1/tiledbsoma-1.16.1/setup.py",
      "line_number": "188",
      "type_description": "code-execution",
      "context_snippet": "import shutil\nimport subprocess\nimport sys\n\n# ... (other code and imports)\n\ndef find_or_build_package_data(setuptools_cmd):\n    # check if libtiledbsoma is installed\n    lib_dir = libtiledbsoma_exists()\n\n    # if not then build from source\n    if lib_dir is None:\n        # Note: The GitHub build process uses the contents of `bld` as a key\n        # to cache the native binaries. Using non-default options here will\n        # cause that cache to fall out of sync.\n        #\n        # See `.github/workflows/python-ci-single.yml` for configuration.\n        if os.name == \"nt\":\n            bld_command = [\"pwsh.exe\", \"./bld.ps1\"]\n            if tiledb_dir is not None:\n                bld_command.append(f\"TileDBLocation={tiledb_dir}\")\n            if no_tiledb_dep:\n                bld_command.append(\"RemoveTileDBDeprecated=ON\")\n\n        else:\n            bld_command = [\"./bld\"]\n            if tiledb_dir is not None:\n                bld_command.append(f\"--tiledb={tiledb_dir}\")\n            if no_tiledb_dep:\n                bld_command.append(\"--no-tiledb-deprecated=true\")\n\n        subprocess.run(bld_command, cwd=scripts_dir, check=True)\n\n        lib_dir = libtiledbsoma_exists()\n        assert lib_dir, \"error when building libtiledbsoma from source\"\n\n        # If we are building from source, then we are likely building wheels.\n        # Copy both the tiledbsoma and tiledb shared objects into the\n        # package dir so they can be found by package_data\n        package_data = []\n        src_dir = this_dir / \"src\" / \"tiledbsoma\"\n        for f in lib_dir.glob(\"*tiledbsoma.*\"):\n            if f.suffix != \".a\":  # skip static library\n                print(f\"  copying file {f} to {src_dir}\")\n                shutil.copy(f, src_dir)\n                package_data.append(f.name)\n        assert package_data, f\"tiledbsoma artifacts absent from {lib_dir}\"\n\n        if not tiledb_given:\n            for f in lib_dir.glob(\"*tiledb.*\"):\n                if f.suffix != \".a\":  # skip static library\n                    print(f\"  copying file {f} to {src_dir}\")\n                    shutil.copy(f, src_dir)\n                    package_data.append(f.name)\n                assert package_data, f\"tiledb artifacts absent from {lib_dir}\"\n\n        # Install shared libraries inside the Python module via package_data.\n        print(f\"  adding to package_data: {package_data}\")\n        setuptools_cmd.distribution.package_data[\"tiledbsoma\"] = package_data\n",
      "hash_value": "3544854386149a078694c21f29808228",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "import shutil\nimport subprocess\nimport sys\n\n# ... (other code and imports)\n\ndef find_or_build_package_data(setuptools_cmd):\n    # check if libtiledbsoma is installed\n    lib_dir = libtiledbsoma_exists()\n\n    # if not then build from source\n    if lib_dir is None:\n        # Note: The GitHub build process uses the contents of `bld` as a key\n        # to cache the native binaries. Using non-default options here will\n        # cause that cache to fall out of sync.\n        #\n        # See `.github/workflows/python-ci-single.yml` for configuration.\n        if os.name == \"nt\":\n            bld_command = [\"pwsh.exe\", \"./bld.ps1\"]\n            if tiledb_dir is not None:\n                bld_command.append(f\"TileDBLocation={tiledb_dir}\")\n            if no_tiledb_dep:\n                bld_command.append(\"RemoveTileDBDeprecated=ON\")\n\n        else:\n            bld_command = [\"./bld\"]\n            if tiledb_dir is not None:\n                bld_command.append(f\"--tiledb={tiledb_dir}\")\n            if no_tiledb_dep:\n                bld_command.append(\"--no-tiledb-deprecated=true\")\n\n        subprocess.run(bld_command, cwd=scripts_dir, check=True)\n\n        lib_dir = libtiledbsoma_exists()\n        assert lib_dir, \"error when building libtiledbsoma from source\"\n\n        # If we are building from source, then we are likely building wheels.\n        # Copy both the tiledbsoma and tiledb shared objects into the\n        # package dir so they can be found by package_data\n        package_data = []\n        src_dir = this_dir / \"src\" / \"tiledbsoma\"\n        for f in lib_dir.glob(\"*tiledbsoma.*\"):\n            if f.suffix != \".a\":  # skip static library\n                print(f\"  copying file {f} to {src_dir}\")\n                shutil.copy(f, src_dir)\n                package_data.append(f.name)\n        assert package_data, f\"tiledbsoma artifacts absent from {lib_dir}\"\n\n        if not tiledb_given:\n            for f in lib_dir.glob(\"*tiledb.*\"):\n                if f.suffix != \".a\":  # skip static library\n                    print(f\"  copying file {f} to {src_dir}\")\n                    shutil.copy(f, src_dir)\n                    package_data.append(f.name)\n                assert package_data, f\"tiledb artifacts absent from {lib_dir}\"\n\n        # Install shared libraries inside the Python module via package_data.\n        print(f\"  adding to package_data: {package_data}\")\n        setuptools_cmd.distribution.package_data[\"tiledbsoma\"] = package_data\n",
          "triple_sequences": [
            {
              "action_api": "subprocess.run()",
              "action_description": "Spawns new process to execute command without shell access",
              "action_id": "spawn_process_no_shell",
              "object": "bld_command",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "shutil.copy()",
              "action_description": "Copies file to destination",
              "action_id": "copy_file",
              "object": "f, src_dir",
              "object_description": "Local file or directory",
              "object_id": "local_file_or_directory",
              "intention_description": "Copy file to temporary directory",
              "intention_id": "copy_file_temp_directory"
            }
          ]
        }
      ]
    }
  ]
}