{
  "metadata": {
    "package_name": "google_re2-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/google_re2-1.1.20240702.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/google_re2-1.1.20240702/google_re2-1.1.20240702/setup.py",
      "line_number": "71",
      "type_description": "code-execution",
      "context_snippet": "class BuildExt(setuptools.command.build_ext.build_ext):\n\n  def build_extension(self, ext):\n    if 'GITHUB_ACTIONS' not in os.environ:\n      return super().build_extension(ext)\n\n    cmd = ['bazel', 'build']\n    try:\n      cpu = os.environ['BAZEL_CPU']\n      cmd.append(f'--cpu={cpu}')\n      cmd.append(f'--platforms=//python:{cpu}')\n      if cpu == 'x64_x86_windows':\n        # Register the local 32-bit C++ toolchain with highest priority.\n        # (This is likely to break in some release of Bazel after 7.0.0,\n        # but this special case can hopefully be entirely removed then.)\n        cmd.append(f'--extra_toolchains=@local_config_cc//:cc-toolchain-{cpu}')\n    except KeyError:\n      pass\n    try:\n      ver = os.environ['MACOSX_DEPLOYMENT_TARGET']\n      cmd.append(f'--macos_minimum_os={ver}')\n    except KeyError:\n      pass\n    # Register the local Python toolchains with highest priority.\n    cmd.append('--extra_toolchains=//python/toolchains:all')\n    cmd += ['--compilation_mode=opt', '--', ':all']\n    self.spawn(cmd)\n\n    # This ensures that f'_re2.{importlib.machinery.EXTENSION_SUFFIXES[0]}'\n    # is the filename in the destination directory, which is what's needed.\n    shutil.copyfile('../bazel-bin/python/_re2.so',\n                    self.get_ext_fullpath(ext.name))\n\n    cmd = ['bazel', 'clean', '--expunge']\n    self.spawn(cmd)",
      "hash_value": "f6fddd3966d894424109f79c58f4edd1",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "class BuildExt(setuptools.command.build_ext.build_ext):\n\n  def build_extension(self, ext):\n    if 'GITHUB_ACTIONS' not in os.environ:\n      return super().build_extension(ext)\n\n    cmd = ['bazel', 'build']\n    try:\n      cpu = os.environ['BAZEL_CPU']\n      cmd.append(f'--cpu={cpu}')\n      cmd.append(f'--platforms=//python:{cpu}')\n      if cpu == 'x64_x86_windows':\n        # Register the local 32-bit C++ toolchain with highest priority.\n        # (This is likely to break in some release of Bazel after 7.0.0,\n        # but this special case can hopefully be entirely removed then.)\n        cmd.append(f'--extra_toolchains=@local_config_cc//:cc-toolchain-{cpu}')\n    except KeyError:\n      pass\n    try:\n      ver = os.environ['MACOSX_DEPLOYMENT_TARGET']\n      cmd.append(f'--macos_minimum_os={ver}')\n    except KeyError:\n      pass\n    # Register the local Python toolchains with highest priority.\n    cmd.append('--extra_toolchains=//python/toolchains:all')\n    cmd += ['--compilation_mode=opt', '--', ':all']\n    self.spawn(cmd)\n\n    # This ensures that f'_re2.{importlib.machinery.EXTENSION_SUFFIXES[0]}'\n    # is the filename in the destination directory, which is what's needed.\n    shutil.copyfile('../bazel-bin/python/_re2.so',\n                    self.get_ext_fullpath(ext.name))\n\n    cmd = ['bazel', 'clean', '--expunge']\n    self.spawn(cmd)",
          "triple_sequences": [
            {
              "action_api": "os.environ.__contains__()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "'GITHUB_ACTIONS'",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.environ.__getitem__()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "'BAZEL_CPU'",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.environ.__getitem__()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "'MACOSX_DEPLOYMENT_TARGET'",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "self.spawn()",
              "action_description": "Spawns new process to execute command without shell access",
              "action_id": "spawn_process_no_shell",
              "object": "cmd",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "shutil.copyfile()",
              "action_description": "Copies file to destination",
              "action_id": "copy_file",
              "object": "'../bazel-bin/python/_re2.so', self.get_ext_fullpath(ext.name)",
              "object_description": "Local file or directory",
              "object_id": "local_file_or_directory",
              "intention_description": "Copy file to startup directory",
              "intention_id": "copy_file_startup_directory"
            },
            {
              "action_api": "self.spawn()",
              "action_description": "Spawns new process to execute command without shell access",
              "action_id": "spawn_process_no_shell",
              "object": "cmd",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            }
          ]
        }
      ]
    }
  ]
}