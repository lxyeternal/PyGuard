{
  "metadata": {
    "package_name": "macholib-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/macholib-1.16.3.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/macholib-1.16.3/macholib-1.16.3/setup.py",
      "line_number": "68",
      "type_description": "code-execution",
      "context_snippet": "def eval_marker(value):\n    \"\"\"\n    Evaluate an distutils2 environment marker.\n\n    This code is unsafe when used with hostile setup.cfg files,\n    but that's not a problem for our own files.\n    \"\"\"\n    value = value.strip()\n\n    class M:\n        def __init__(self, **kwds):\n            for k, v in kwds.items():\n                setattr(self, k, v)\n\n    variables = {\n        \"python_version\": \"%d.%d\" % (sys.version_info[0], sys.version_info[1]),\n        \"python_full_version\": sys.version.split()[0],\n        \"os\": M(name=os.name),\n        \"sys\": M(platform=sys.platform),\n        \"platform\": M(version=platform.version(), machine=platform.machine()),\n    }\n\n    return bool(eval(value, variables, variables))\n\n    return True",
      "hash_value": "77cb0be6426dca21c37567ddc987f604",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "def eval_marker(value):\n    \"\"\"\n    Evaluate an distutils2 environment marker.\n\n    This code is unsafe when used with hostile setup.cfg files,\n    but that's not a problem for our own files.\n    \"\"\"\n    value = value.strip()\n\n    class M:\n        def __init__(self, **kwds):\n            for k, v in kwds.items():\n                setattr(self, k, v)\n\n    variables = {\n        \"python_version\": \"%d.%d\" % (sys.version_info[0], sys.version_info[1]),\n        \"python_full_version\": sys.version.split()[0],\n        \"os\": M(name=os.name),\n        \"sys\": M(platform=sys.platform),\n        \"platform\": M(version=platform.version(), machine=platform.machine()),\n    }\n\n    return bool(eval(value, variables, variables))\n\n    return True",
          "triple_sequences": [
            {
              "action_api": "str.strip()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "value",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare string for further processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "sys.version_info",
              "action_description": "Retrieves Python interpreter version",
              "action_id": "get_python_version",
              "object": "sys.version_info",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get operating system version",
              "intention_id": "get_operating_system_version"
            },
            {
              "action_api": "sys.version.split()",
              "action_description": "Retrieves Python interpreter version",
              "action_id": "get_python_version",
              "object": "sys.version.split()[0]",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get operating system version",
              "intention_id": "get_operating_system_version"
            },
            {
              "action_api": "os.name",
              "action_description": "Retrieves operating system identifier",
              "action_id": "get_os_id",
              "object": "os.name",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get operating system name",
              "intention_id": "get_operating_system_name"
            },
            {
              "action_api": "sys.platform",
              "action_description": "Retrieves platform information",
              "action_id": "get_platform_info",
              "object": "sys.platform",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get operating system name",
              "intention_id": "get_operating_system_name"
            },
            {
              "action_api": "platform.version()",
              "action_description": "Retrieves operating system release version",
              "action_id": "get_os_release",
              "object": "platform.version()",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get operating system version",
              "intention_id": "get_operating_system_version"
            },
            {
              "action_api": "platform.machine()",
              "action_description": "Retrieves machine type",
              "action_id": "get_machine_type",
              "object": "platform.machine()",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get system info",
              "intention_id": "get_system_info"
            },
            {
              "action_api": "eval()",
              "action_description": "Evaluates string as Python expression",
              "action_id": "eval_python_expr",
              "object": "value, variables, variables",
              "object_description": "Python code string",
              "object_id": "python_code_string",
              "intention_description": "Evaluate constructed code",
              "intention_id": "evaluate_constructed_code"
            }
          ]
        }
      ]
    }
  ]
}