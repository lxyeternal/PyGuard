{
  "metadata": {
    "package_name": "kodexa-7",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/kodexa-7.4.414330611518.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "client.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/kodexa-7.4.414330611518/kodexa-7.4.414330611518/kodexa/platform/client.py",
      "line_number": "6775",
      "type_description": "exfiltrate-sensitive-data",
      "context_snippet": "    @staticmethod\n    def login(url, token):\n        \"\"\"\n        A static method to login to the Kodexa platform.\n\n        Args:\n            url (str): The URL for the Kodexa platform.\n            token (str): The email for the user.\n\n        Returns:\n            KodexaClient: A KodexaClient instance.\n\n        Raises:\n            Exception: If the status code is not 200.\n        \"\"\"\n\n        obj_response = requests.get(\n            f\"{url}/api/account/me\",\n            headers={\"content-type\": \"application/json\",\n                     \"x-access-token\": token,\n                     \"cf-access-token\": os.environ.get(\"CF_TOKEN\", \"\")}\n        )\n        if obj_response.status_code == 200:\n            return KodexaClient(url, obj_response.text)\n\n        raise Exception(f\"Check your URL and password [{obj_response.status_code}]\")",
      "hash_value": "aa7d5a1365310aaec1f5ff19dce5945a",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "    @staticmethod\n    def login(url, token):\n        \"\"\"\n        A static method to login to the Kodexa platform.\n\n        Args:\n            url (str): The URL for the Kodexa platform.\n            token (str): The email for the user.\n\n        Returns:\n            KodexaClient: A KodexaClient instance.\n\n        Raises:\n            Exception: If the status code is not 200.\n        \"\"\"\n\n        obj_response = requests.get(\n            f\"{url}/api/account/me\",\n            headers={\"content-type\": \"application/json\",\n                     \"x-access-token\": token,\n                     \"cf-access-token\": os.environ.get(\"CF_TOKEN\", \"\")}\n        )\n        if obj_response.status_code == 200:\n            return KodexaClient(url, obj_response.text)\n\n        raise Exception(f\"Check your URL and password [{obj_response.status_code}]\")",
          "triple_sequences": [
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP GET request to URL",
              "action_id": "open_url_get",
              "object": "f\"{url}/api/account/me\"",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "os.environ.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"CF_TOKEN\"",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            }
          ]
        }
      ]
    }
  ]
}