{
  "metadata": {
    "package_name": "gallery_dl-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/gallery_dl-1.29.3.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "everia.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/gallery_dl-1.29.3/gallery_dl-1.29.3/gallery_dl/extractor/everia.py",
      "line_number": "50",
      "type_description": "shady-links",
      "context_snippet": "class EveriaPostExtractor(EveriaExtractor):\n    subcategory = \"post\"\n    directory_fmt = (\"{category}\", \"{title}\")\n    archive_fmt = \"{post_url}_{num}\"\n    pattern = BASE_PATTERN + r\"(/\\d{4}/\\d{2}/\\d{2}/[^/?#]+)\"\n    example = \"https://everia.club/0000/00/00/TITLE\"\n\n    def items(self):\n        url = self.root + self.groups[0]\n        page = self.request(url).text\n        content = text.extr(page, 'itemprop=\"text\">', \"</div>\")\n        urls = re.findall(r'img.*?src=\"([^\"]+)', content)\n\n        data = {\n            \"title\": text.unescape(\n                text.extr(page, 'itemprop=\"headline\">', \"</h1>\")),\n            \"tags\": list(text.extract_iter(page, 'rel=\"tag\">', \"</a>\")),\n            \"post_url\": url,\n            \"post_category\": text.extr(\n                page, \"post-in-category-\", \" \").capitalize(),\n            \"count\": len(urls),\n        }\n\n        yield Message.Directory, data\n        for data[\"num\"], url in enumerate(urls, 1):\n            yield Message.Url, url, text.nameext_from_url(url, data)",
      "hash_value": "1c9485dbf73b3ec540e38faaba6e5431",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "class EveriaPostExtractor(EveriaExtractor):\n    subcategory = \"post\"\n    directory_fmt = (\"{category}\", \"{title}\")\n    archive_fmt = \"{post_url}_{num}\"\n    pattern = BASE_PATTERN + r\"(/\\d{4}/\\d{2}/\\d{2}/[^/?#]+)\"\n    example = \"https://everia.club/0000/00/00/TITLE\"\n\n    def items(self):\n        url = self.root + self.groups[0]\n        page = self.request(url).text\n        content = text.extr(page, 'itemprop=\"text\">', \"</div>\")\n        urls = re.findall(r'img.*?src=\"([^\"]+)', content)\n\n        data = {\n            \"title\": text.unescape(\n                text.extr(page, 'itemprop=\"headline\">', \"</h1>\")),\n            \"tags\": list(text.extract_iter(page, 'rel=\"tag\">', \"</a>\")),\n            \"post_url\": url,\n            \"post_category\": text.extr(\n                page, \"post-in-category-\", \" \").capitalize(),\n            \"count\": len(urls),\n        }\n\n        yield Message.Directory, data\n        for data[\"num\"], url in enumerate(urls, 1):\n            yield Message.Url, url, text.nameext_from_url(url, data)",
          "triple_sequences": [
            {
              "action_api": "self.request()",
              "action_description": "Sends HTTP request",
              "action_id": "send_http_request",
              "object": "self.root + self.groups[0]",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "str.text",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Decode downloaded content",
              "intention_id": "decode_downloaded_content"
            },
            {
              "action_api": "text.extr()",
              "action_description": "Extracts current call stack as FrameSummary objects",
              "action_id": "extract_call_stack",
              "object": "page, 'itemprop=\"text\">', \"</div>\"",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Extract structured file data",
              "intention_id": "extract_structured_file_data"
            },
            {
              "action_api": "re.findall()",
              "action_description": "Compiles regular expression pattern",
              "action_id": "compile_regex",
              "object": "r'img.*?src=\"([^\"]+)'",
              "object_description": "Regular expression pattern",
              "object_id": "regex_pattern",
              "intention_description": "Extract structured file data",
              "intention_id": "extract_structured_file_data"
            },
            {
              "action_api": "text.unescape()",
              "action_description": "Decode obfuscated data",
              "action_id": "decode_obfuscated_data",
              "object": "text.extr(page, 'itemprop=\"headline\">', \"</h1>\")",
              "object_description": "Decoded obfuscated data",
              "object_id": "decoded_obfuscated_data",
              "intention_description": "Decode obfuscated data",
              "intention_id": "decode_obfuscated_data"
            },
            {
              "action_api": "text.extract_iter()",
              "action_description": "Extracts current call stack as FrameSummary objects",
              "action_id": "extract_call_stack",
              "object": "page, 'rel=\"tag\">', \"</a>\"",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Extract structured file data",
              "intention_id": "extract_structured_file_data"
            },
            {
              "action_api": "text.extr()",
              "action_description": "Extracts current call stack as FrameSummary objects",
              "action_id": "extract_call_stack",
              "object": "page, \"post-in-category-\", \" \"",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Extract structured file data",
              "intention_id": "extract_structured_file_data"
            },
            {
              "action_api": "len()",
              "action_description": "Generate product of sequence",
              "action_id": "generate_sequence_product",
              "object": "urls",
              "object_description": "URL string",
              "object_id": "url_string",
              "intention_description": "Generate sequence product",
              "intention_id": "generate_sequence_product"
            },
            {
              "action_api": "enumerate()",
              "action_description": "Generate product of sequence",
              "action_id": "generate_sequence_product",
              "object": "urls, 1",
              "object_description": "URL string",
              "object_id": "url_string",
              "intention_description": "Generate sequence product",
              "intention_id": "generate_sequence_product"
            },
            {
              "action_api": "text.nameext_from_url()",
              "action_description": "Path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "url, data",
              "object_description": "URL string",
              "object_id": "url_string",
              "intention_description": "Prepare path for file operations",
              "intention_id": "prepare_path_file_operations"
            }
          ]
        }
      ]
    }
  ]
}