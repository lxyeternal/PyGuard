{
  "metadata": {
    "package_name": "erppeek-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/erppeek-1.7.1.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "erppeek.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/erppeek-1.7.1/ERPpeek-1.7.1/erppeek.py",
      "line_number": "1673",
      "type_description": "obfuscation",
      "context_snippet": "def _interact(global_vars, use_pprint=True, usage=USAGE):\n    import code\n    import pprint\n    if PY2:\n        import __builtin__ as builtins\n\n        def _exec(code, g):\n            exec('exec code in g')\n    else:\n        import builtins\n        _exec = getattr(builtins, 'exec')\n\n    if use_pprint:\n        def displayhook(value, _printer=pprint.pprint, _builtins=builtins):\n            # Pretty-format the output\n            if value is None:\n                return\n            _printer(value)\n            _builtins._ = value\n        sys.displayhook = displayhook\n\n    class Usage(object):\n        def __call__(self):\n            print(usage)\n        __repr__ = lambda s: usage\n    builtins.usage = Usage()\n\n    try:\n        import readline as rl\n        import rlcompleter\n        rl.parse_and_bind('tab: complete')\n        # IOError if file missing, or broken Apple readline\n        rl.read_history_file(HIST_FILE)\n    except Exception:\n        pass\n    else:\n        if rl.get_history_length() < 0:\n            rl.set_history_length(int(os.getenv('HISTSIZE', 500)))\n        # better append instead of replace?\n        atexit.register(rl.write_history_file, HIST_FILE)\n\n    class Console(code.InteractiveConsole):\n        def runcode(self, code):\n            try:\n                _exec(code, global_vars)\n            except SystemExit:\n                raise\n            except:\n                # Print readable 'Fault' errors\n                # Work around http://bugs.python.org/issue12643\n                (exc_type, exc, tb) = sys.exc_info()\n                msg = ''.join(format_exception(exc_type, exc, tb, chain=False))\n                print(msg.strip())\n\n    sys.exc_clear() if hasattr(sys, 'exc_clear') else None  # Python 2.x\n    # Key UP to avoid an empty line\n    Console().interact('\\033[A')",
      "hash_value": "a63c21e1225fd9e4bd2de1fdb58e9dbd",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "def _interact(global_vars, use_pprint=True, usage=USAGE):\n    import code\n    import pprint\n    if PY2:\n        import __builtin__ as builtins\n\n        def _exec(code, g):\n            exec('exec code in g')\n    else:\n        import builtins\n        _exec = getattr(builtins, 'exec')\n\n    if use_pprint:\n        def displayhook(value, _printer=pprint.pprint, _builtins=builtins):\n            # Pretty-format the output\n            if value is None:\n                return\n            _printer(value)\n            _builtins._ = value\n        sys.displayhook = displayhook\n\n    class Usage(object):\n        def __call__(self):\n            print(usage)\n        __repr__ = lambda s: usage\n    builtins.usage = Usage()\n\n    try:\n        import readline as rl\n        import rlcompleter\n        rl.parse_and_bind('tab: complete')\n        # IOError if file missing, or broken Apple readline\n        rl.read_history_file(HIST_FILE)\n    except Exception:\n        pass\n    else:\n        if rl.get_history_length() < 0:\n            rl.set_history_length(int(os.getenv('HISTSIZE', 500)))\n        # better append instead of replace?\n        atexit.register(rl.write_history_file, HIST_FILE)\n\n    class Console(code.InteractiveConsole):\n        def runcode(self, code):\n            try:\n                _exec(code, global_vars)\n            except SystemExit:\n                raise\n            except:\n                # Print readable 'Fault' errors\n                # Work around http://bugs.python.org/issue12643\n                (exc_type, exc, tb) = sys.exc_info()\n                msg = ''.join(format_exception(exc_type, exc, tb, chain=False))\n                print(msg.strip())\n\n    sys.exc_clear() if hasattr(sys, 'exc_clear') else None  # Python 2.x\n    # Key UP to avoid an empty line\n    Console().interact('\\033[A')",
          "triple_sequences": [
            {
              "action_api": "getattr()",
              "action_description": "Checks if object is instance of specified type",
              "action_id": "check_instance_type",
              "object": "builtins, 'exec'",
              "object_description": "Builtin module",
              "object_id": "builtin_module",
              "intention_description": "Import module dynamically",
              "intention_id": "import_module_dynamically"
            },
            {
              "action_api": "pprint.pprint()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "value",
              "object_description": "",
              "object_id": "",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "sys.displayhook = displayhook",
              "action_description": "Sets attribute on builtins object",
              "action_id": "set_builtin_attr",
              "object": "sys.displayhook, displayhook",
              "object_description": "",
              "object_id": "",
              "intention_description": "Modify builtins and execute code",
              "intention_id": "modify_builtins_execute_code"
            },
            {
              "action_api": "builtins.usage = Usage()",
              "action_description": "Sets attribute on builtins object",
              "action_id": "set_builtin_attr",
              "object": "builtins.usage, Usage()",
              "object_description": "",
              "object_id": "",
              "intention_description": "Modify builtins and execute code",
              "intention_id": "modify_builtins_execute_code"
            },
            {
              "action_api": "rl.parse_and_bind()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "'tab: complete'",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "rl.read_history_file()",
              "action_description": "Basic read operations for reading file",
              "action_id": "basic_read_operations",
              "object": "HIST_FILE",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "rl.get_history_length()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "rl.set_history_length()",
              "action_description": "Sets attribute on builtins object",
              "action_id": "set_builtin_attr",
              "object": "int(os.getenv('HISTSIZE', 500))",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Modify builtins and execute code",
              "intention_id": "modify_builtins_execute_code"
            },
            {
              "action_api": "atexit.register()",
              "action_description": "Registers function to be called at program exit",
              "action_id": "register_exit_function",
              "object": "rl.write_history_file, HIST_FILE",
              "object_description": "Function with arguments",
              "object_id": "function_with_arguments",
              "intention_description": "Register keylogger event handler",
              "intention_id": "register_keylogger_handler"
            },
            {
              "action_api": "sys.exc_clear()",
              "action_description": "Removes all keyboard hooks",
              "action_id": "remove_keyboard_hooks",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Release keyboard hook",
              "intention_id": "release_keyboard_hook"
            },
            {
              "action_api": "Console().interact()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "'\\033[A'",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            }
          ]
        }
      ]
    }
  ]
}