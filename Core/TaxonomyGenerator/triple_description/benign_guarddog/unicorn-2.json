{
  "metadata": {
    "package_name": "unicorn-2",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/unicorn-2.1.3.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/unicorn-2.1.3/unicorn-2.1.3/setup.py",
      "line_number": "116",
      "type_description": "code-execution",
      "context_snippet": "def build_libraries():\n    \"\"\"\n    Prepare the unicorn directory for a binary distribution or installation.\n    Builds shared libraries and copies header files.\n\n    Will use a src/ dir if one exists in the current directory, otherwise assumes it's in the repo\n    \"\"\"\n    clean_bins()\n    os.mkdir(HEADERS_DIR)\n    os.mkdir(LIBS_DIR)\n\n    # copy public headers\n    shutil.copytree(os.path.join(UC_DIR, 'include', 'unicorn'), os.path.join(HEADERS_DIR, 'unicorn'))\n\n    # check if a prebuilt library exists and if so, use it instead of building\n    if os.path.exists(os.path.join(ROOT_DIR, 'prebuilt', LIBRARY_FILE)):\n        shutil.copy(os.path.join(ROOT_DIR, 'prebuilt', LIBRARY_FILE), LIBS_DIR)\n        if STATIC_LIBRARY_FILE is not None and os.path.exists(os.path.join(ROOT_DIR, 'prebuilt', STATIC_LIBRARY_FILE)):\n            shutil.copy(os.path.join(ROOT_DIR, 'prebuilt', STATIC_LIBRARY_FILE), LIBS_DIR)\n        return\n\n    # otherwise, build\n    if not os.path.exists(BUILD_DIR):\n        os.mkdir(BUILD_DIR)\n\n    has_msbuild = shutil.which('msbuild') is not None\n    conf = 'Debug' if int(os.getenv('DEBUG', 0)) else 'Release'\n    cmake_args = ['cmake', '-B', BUILD_DIR, \"-DCMAKE_BUILD_TYPE=\" + conf, \"-DUNICORN_BUILD_TESTS=off\"]\n    if os.getenv(\"UNICORN_TRACER\"):\n        cmake_args += [\"-DUNICORN_TRACER=on\"]\n    if conf == 'Debug':\n        cmake_args += [\"-DUNICORN_LOGGING=on\"]\n\n    if has_msbuild and sys.platform == 'win32':\n        generators = os.getenv('GENERATORS') or 'Visual Studio 16 2019'\n        plat = 'Win32' if platform.architecture()[0] == '32bit' else 'x64'\n        cmake_args += ['-G', generators, \"-A\", plat]\n        subprocess.check_call(cmake_args, cwd=UC_DIR)\n        subprocess.check_call(['msbuild', 'unicorn.sln', '-m', '-p:Platform=' + plat, '-p:Configuration=' + conf],\n                              cwd=BUILD_DIR)\n\n        obj_dir = os.path.join(BUILD_DIR, conf)\n        shutil.copy(os.path.join(obj_dir, LIBRARY_FILE), LIBS_DIR)\n        shutil.copy(os.path.join(obj_dir, STATIC_LIBRARY_FILE), LIBS_DIR)\n    else:\n        cmake_args += ['-S', UC_DIR]\n        subprocess.check_call(cmake_args, cwd=UC_DIR)\n        threads = os.getenv(\"THREADS\", \"4\")\n        subprocess.check_call([\"cmake\", \"--build\", \".\", \"-j\" + threads], cwd=BUILD_DIR)\n\n        shutil.copy(os.path.join(BUILD_DIR, LIBRARY_FILE), LIBS_DIR)\n        shutil.copy(os.path.join(BUILD_DIR, STATIC_LIBRARY_FILE), LIBS_DIR)\n",
      "hash_value": "d62a0d584ade3493fd17d99c5ba43e8e",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "def build_libraries():\n    \"\"\"\n    Prepare the unicorn directory for a binary distribution or installation.\n    Builds shared libraries and copies header files.\n\n    Will use a src/ dir if one exists in the current directory, otherwise assumes it's in the repo\n    \"\"\"\n    clean_bins()\n    os.mkdir(HEADERS_DIR)\n    os.mkdir(LIBS_DIR)\n\n    # copy public headers\n    shutil.copytree(os.path.join(UC_DIR, 'include', 'unicorn'), os.path.join(HEADERS_DIR, 'unicorn'))\n\n    # check if a prebuilt library exists and if so, use it instead of building\n    if os.path.exists(os.path.join(ROOT_DIR, 'prebuilt', LIBRARY_FILE)):\n        shutil.copy(os.path.join(ROOT_DIR, 'prebuilt', LIBRARY_FILE), LIBS_DIR)\n        if STATIC_LIBRARY_FILE is not None and os.path.exists(os.path.join(ROOT_DIR, 'prebuilt', STATIC_LIBRARY_FILE)):\n            shutil.copy(os.path.join(ROOT_DIR, 'prebuilt', STATIC_LIBRARY_FILE), LIBS_DIR)\n        return\n\n    # otherwise, build\n    if not os.path.exists(BUILD_DIR):\n        os.mkdir(BUILD_DIR)\n\n    has_msbuild = shutil.which('msbuild') is not None\n    conf = 'Debug' if int(os.getenv('DEBUG', 0)) else 'Release'\n    cmake_args = ['cmake', '-B', BUILD_DIR, \"-DCMAKE_BUILD_TYPE=\" + conf, \"-DUNICORN_BUILD_TESTS=off\"]\n    if os.getenv(\"UNICORN_TRACER\"):\n        cmake_args += [\"-DUNICORN_TRACER=on\"]\n    if conf == 'Debug':\n        cmake_args += [\"-DUNICORN_LOGGING=on\"]\n\n    if has_msbuild and sys.platform == 'win32':\n        generators = os.getenv('GENERATORS') or 'Visual Studio 16 2019'\n        plat = 'Win32' if platform.architecture()[0] == '32bit' else 'x64'\n        cmake_args += ['-G', generators, \"-A\", plat]\n        subprocess.check_call(cmake_args, cwd=UC_DIR)\n        subprocess.check_call(['msbuild', 'unicorn.sln', '-m', '-p:Platform=' + plat, '-p:Configuration=' + conf],\n                              cwd=BUILD_DIR)\n\n        obj_dir = os.path.join(BUILD_DIR, conf)\n        shutil.copy(os.path.join(obj_dir, LIBRARY_FILE), LIBS_DIR)\n        shutil.copy(os.path.join(obj_dir, STATIC_LIBRARY_FILE), LIBS_DIR)\n    else:\n        cmake_args += ['-S', UC_DIR]\n        subprocess.check_call(cmake_args, cwd=UC_DIR)\n        threads = os.getenv(\"THREADS\", \"4\")\n        subprocess.check_call([\"cmake\", \"--build\", \".\", \"-j\" + threads], cwd=BUILD_DIR)\n\n        shutil.copy(os.path.join(BUILD_DIR, LIBRARY_FILE), LIBS_DIR)\n        shutil.copy(os.path.join(BUILD_DIR, STATIC_LIBRARY_FILE), LIBS_DIR)\n",
          "triple_sequences": [
            {
              "action_api": "os.mkdir()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "HEADERS_DIR",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "os.mkdir()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "LIBS_DIR",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "shutil.copytree()",
              "action_description": "Copies file to destination",
              "action_id": "copy_file",
              "object": "os.path.join(UC_DIR, 'include', 'unicorn'), os.path.join(HEADERS_DIR, 'unicorn')",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Copy file to temporary directory",
              "intention_id": "copy_file_temp_directory"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "os.path.join(ROOT_DIR, 'prebuilt', LIBRARY_FILE)",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "shutil.copy()",
              "action_description": "Copies file to destination",
              "action_id": "copy_file",
              "object": "os.path.join(ROOT_DIR, 'prebuilt', LIBRARY_FILE), LIBS_DIR",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Copy file to temporary directory",
              "intention_id": "copy_file_temp_directory"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "os.path.join(ROOT_DIR, 'prebuilt', STATIC_LIBRARY_FILE)",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "shutil.copy()",
              "action_description": "Copies file to destination",
              "action_id": "copy_file",
              "object": "os.path.join(ROOT_DIR, 'prebuilt', STATIC_LIBRARY_FILE), LIBS_DIR",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Copy file to temporary directory",
              "intention_id": "copy_file_temp_directory"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "BUILD_DIR",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "os.mkdir()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "BUILD_DIR",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "'DEBUG', 0",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"UNICORN_TRACER\"",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "'GENERATORS'",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "platform.architecture()",
              "action_description": "Retrieves machine type",
              "action_id": "get_machine_type",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Get system info",
              "intention_id": "get_system_info"
            },
            {
              "action_api": "subprocess.check_call()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "cmake_args, cwd=UC_DIR",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "subprocess.check_call()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "['msbuild', 'unicorn.sln', '-m', '-p:Platform=' + plat, '-p:Configuration=' + conf], cwd=BUILD_DIR",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "BUILD_DIR, conf",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "shutil.copy()",
              "action_description": "Copies file to destination",
              "action_id": "copy_file",
              "object": "os.path.join(obj_dir, LIBRARY_FILE), LIBS_DIR",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Copy file to temporary directory",
              "intention_id": "copy_file_temp_directory"
            },
            {
              "action_api": "shutil.copy()",
              "action_description": "Copies file to destination",
              "action_id": "copy_file",
              "object": "os.path.join(obj_dir, STATIC_LIBRARY_FILE), LIBS_DIR",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Copy file to temporary directory",
              "intention_id": "copy_file_temp_directory"
            },
            {
              "action_api": "subprocess.check_call()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "cmake_args, cwd=UC_DIR",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "os.getenv()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "\"THREADS\", \"4\"",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "subprocess.check_call()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "[\"cmake\", \"--build\", \".\", \"-j\" + threads], cwd=BUILD_DIR",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "shutil.copy()",
              "action_description": "Copies file to destination",
              "action_id": "copy_file",
              "object": "os.path.join(BUILD_DIR, LIBRARY_FILE), LIBS_DIR",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Copy file to temporary directory",
              "intention_id": "copy_file_temp_directory"
            },
            {
              "action_api": "shutil.copy()",
              "action_description": "Copies file to destination",
              "action_id": "copy_file",
              "object": "os.path.join(BUILD_DIR, STATIC_LIBRARY_FILE), LIBS_DIR",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Copy file to temporary directory",
              "intention_id": "copy_file_temp_directory"
            }
          ]
        }
      ]
    }
  ]
}