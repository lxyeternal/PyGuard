{
  "metadata": {
    "package_name": "monty-2025",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/monty-2025.3.3.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "tasks.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/monty-2025.3.3/monty-2025.3.3/tasks.py",
      "line_number": "120",
      "type_description": "exfiltrate-sensitive-data",
      "context_snippet": "import os\nimport json\nimport re\nimport requests\nfrom invoke import task\n\nNEW_VER = datetime.datetime.today().strftime(\"%Y.%-m.%-d\")\n\n@task\ndef release_github(ctx: Context) -> None:\n    with open(\"docs/changelog.md\", encoding=\"utf-8\") as f:\n        contents = f.read()\n    toks = re.split(\"##\", contents)\n    desc = toks[1].strip()\n    payload = {\n        \"tag_name\": f\"v{NEW_VER}\",\n        \"target_commitish\": \"master\",\n        \"name\": f\"v{NEW_VER}\",\n        \"body\": desc,\n        \"draft\": False,\n        \"prerelease\": False,\n    }\n\n    response = requests.post(\n        \"https://api.github.com/repos/materialsvirtuallab/monty/releases\",\n        data=json.dumps(payload),\n        headers={\"Authorization\": \"token \" + os.environ[\"GITHUB_RELEASES_TOKEN\"]},\n    )\n    print(response.text)",
      "hash_value": "992d227b6417f7c0ea02a4bad305e1ae",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "import os\nimport json\nimport re\nimport requests\nfrom invoke import task\n\nNEW_VER = datetime.datetime.today().strftime(\"%Y.%-m.%-d\")\n\n@task\ndef release_github(ctx: Context) -> None:\n    with open(\"docs/changelog.md\", encoding=\"utf-8\") as f:\n        contents = f.read()\n    toks = re.split(\"##\", contents)\n    desc = toks[1].strip()\n    payload = {\n        \"tag_name\": f\"v{NEW_VER}\",\n        \"target_commitish\": \"master\",\n        \"name\": f\"v{NEW_VER}\",\n        \"body\": desc,\n        \"draft\": False,\n        \"prerelease\": False,\n    }\n\n    response = requests.post(\n        \"https://api.github.com/repos/materialsvirtuallab/monty/releases\",\n        data=json.dumps(payload),\n        headers={\"Authorization\": \"token \" + os.environ[\"GITHUB_RELEASES_TOKEN\"]},\n    )\n    print(response.text)",
          "triple_sequences": [
            {
              "action_api": "open()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "docs/changelog.md",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "file.read()",
              "action_description": "File opening operations for reading (normal reading, binary reading)",
              "action_id": "basic_read_operations",
              "object": "",
              "object_description": "Script file content",
              "object_id": "script_file_content",
              "intention_description": "Read file content",
              "intention_id": "read_file_content"
            },
            {
              "action_api": "re.split()",
              "action_description": "Compiles regular expression pattern",
              "action_id": "compile_regex",
              "object": "\"##\", contents",
              "object_description": "Regex file content",
              "object_id": "regex_file_content",
              "intention_description": "Prepare string processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "str.strip()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare string processing",
              "intention_id": "prepare_string_processing"
            },
            {
              "action_api": "json.dumps()",
              "action_description": "Serializes Python object to JSON string",
              "action_id": "serialize_to_json",
              "object": "payload",
              "object_description": "JSON string",
              "object_id": "json_string",
              "intention_description": "Serialize data",
              "intention_id": "serialize_data"
            },
            {
              "action_api": "os.environ[]",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "GITHUB_RELEASES_TOKEN",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "requests.post()",
              "action_description": "Opens URL with POST data",
              "action_id": "open_url_post",
              "object": "https://api.github.com/repos/materialsvirtuallab/monty/releases",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Transmit data HTTP POST",
              "intention_id": "transmit_data_http_post"
            },
            {
              "action_api": "print()",
              "action_description": "Reads user input from standard input",
              "action_id": "read_user_input",
              "object": "response.text",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Collect command output",
              "intention_id": "collect_command_output"
            }
          ]
        }
      ]
    }
  ]
}