{
  "metadata": {
    "package_name": "pygit2-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/pygit2-1.17.0.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pygit2-1.17.0/pygit2-1.17.0/setup.py",
      "line_number": "49",
      "type_description": "code-execution",
      "context_snippet": "from subprocess import Popen, PIPE\nimport sys\n\nclass sdist_files_from_git(sdist):\n    def get_file_list(self):\n        popen = Popen(\n            ['git', 'ls-files'], stdout=PIPE, stderr=PIPE, universal_newlines=True\n        )\n        stdoutdata, stderrdata = popen.communicate()\n        if popen.returncode != 0:\n            print(stderrdata)\n            sys.exit()\n\n        def exclude(line):\n            for prefix in ['.', 'appveyor.yml', 'docs/', 'misc/']:\n                if line.startswith(prefix):\n                    return True\n            return False\n\n        for line in stdoutdata.splitlines():\n            if not exclude(line):\n                self.filelist.append(line)\n\n        # Ok\n        self.filelist.sort()\n        self.filelist.remove_duplicates()\n        self.write_manifest()",
      "hash_value": "0cee34e93cda86376b929a71b68c83a5",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "from subprocess import Popen, PIPE\nimport sys\n\nclass sdist_files_from_git(sdist):\n    def get_file_list(self):\n        popen = Popen(\n            ['git', 'ls-files'], stdout=PIPE, stderr=PIPE, universal_newlines=True\n        )\n        stdoutdata, stderrdata = popen.communicate()\n        if popen.returncode != 0:\n            print(stderrdata)\n            sys.exit()\n\n        def exclude(line):\n            for prefix in ['.', 'appveyor.yml', 'docs/', 'misc/']:\n                if line.startswith(prefix):\n                    return True\n            return False\n\n        for line in stdoutdata.splitlines():\n            if not exclude(line):\n                self.filelist.append(line)\n\n        # Ok\n        self.filelist.sort()\n        self.filelist.remove_duplicates()\n        self.write_manifest()",
          "triple_sequences": [
            {
              "action_api": "subprocess.Popen()",
              "action_description": "Spawns new process to execute command without shell access",
              "action_id": "spawn_process_no_shell",
              "object": "['git', 'ls-files']",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Create child process",
              "intention_id": "create_child_process"
            },
            {
              "action_api": "popen.communicate()",
              "action_description": "Reads all bytes from process standard output",
              "action_id": "read_process_stdout",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Collect command output",
              "intention_id": "collect_command_output"
            },
            {
              "action_api": "print()",
              "action_description": "Retrieves standard output stream object",
              "action_id": "get_stdout_stream",
              "object": "stderrdata",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Access command error output",
              "intention_id": "access_command_error_output"
            },
            {
              "action_api": "sys.exit()",
              "action_description": "Exits program",
              "action_id": "exit_program",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Terminate program execution",
              "intention_id": "terminate_program_execution"
            },
            {
              "action_api": "str.splitlines()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "stdoutdata",
              "object_description": "Command output",
              "object_id": "command_output",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "self.filelist.append()",
              "action_description": "Basic write operations (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "line",
              "object_description": "Local file or directory name",
              "object_id": "local_file_or_directory_name",
              "intention_description": "Prepare file for temporary storage",
              "intention_id": "prepare_file_temp_storage"
            },
            {
              "action_api": "self.filelist.sort()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "self.filelist.remove_duplicates()",
              "action_description": "Basic write operations (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Prepare file for temporary storage",
              "intention_id": "prepare_file_temp_storage"
            },
            {
              "action_api": "self.write_manifest()",
              "action_description": "Basic write operations (normal writing, binary writing)",
              "action_id": "basic_write_operations",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Write file content",
              "intention_id": "write_file_content"
            }
          ]
        }
      ]
    }
  ]
}