{
  "metadata": {
    "package_name": "pywinauto-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/pywinauto-0.6.9.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "install_7zip.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/pywinauto-0.6.9/pywinauto-0.6.9/examples/install_7zip.py",
      "line_number": "15",
      "type_description": "dll-hijacking",
      "context_snippet": "from __future__ import print_function\nimport sys, os\nos.chdir(os.path.join(os.getcwd(), os.path.dirname(sys.argv[0])))\nimport pywinauto\n\napp = pywinauto.Application().Start(r'msiexec.exe /i 7z920-x64.msi')\n\nWizard = app['7-Zip 9.20 (x64 edition) Setup']\nWizard.NextButton.click()\n\nWizard['I &accept the terms in the License Agreement'].wait('enabled').check_by_click()\nWizard.NextButton.click()\n\nWizard['Custom Setup'].wait('enabled')\nWizard.NextButton.click()\n\nWizard.Install.click()\n\nWizard.Finish.wait('enabled', timeout=30)\nWizard.Finish.click()\nWizard.wait_not('visible')",
      "hash_value": "a3e49c6e6c1d43b622846d32a29953d7",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "from __future__ import print_function\nimport sys, os\nos.chdir(os.path.join(os.getcwd(), os.path.dirname(sys.argv[0])))\nimport pywinauto\n\napp = pywinauto.Application().Start(r'msiexec.exe /i 7z920-x64.msi')\n\nWizard = app['7-Zip 9.20 (x64 edition) Setup']\nWizard.NextButton.click()\n\nWizard['I &accept the terms in the License Agreement'].wait('enabled').check_by_click()\nWizard.NextButton.click()\n\nWizard['Custom Setup'].wait('enabled')\nWizard.NextButton.click()\n\nWizard.Install.click()\n\nWizard.Finish.wait('enabled', timeout=30)\nWizard.Finish.click()\nWizard.wait_not('visible')",
          "triple_sequences": [
            {
              "action_api": "os.getcwd()",
              "action_description": "Returns current working directory",
              "action_id": "get_working_dir",
              "object": "",
              "object_description": "Current working directory",
              "object_id": "current_working_directory",
              "intention_description": "Collect working directory",
              "intention_id": "collect_working_directory"
            },
            {
              "action_api": "sys.argv[0]",
              "action_description": "Retrieves command-line arguments passed to script",
              "action_id": "get_cmd_args",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access command line arguments",
              "intention_id": "access_command_line_arguments"
            },
            {
              "action_api": "os.path.dirname()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "sys.argv[0]",
              "object_description": "Script file path",
              "object_id": "script_file_path",
              "intention_description": "Prepare directory path",
              "intention_id": "prepare_directory_path"
            },
            {
              "action_api": "os.path.join()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "os.getcwd(), os.path.dirname(sys.argv[0])",
              "object_description": "Current working directory",
              "object_id": "current_working_directory",
              "intention_description": "Construct file or directory path",
              "intention_id": "construct_file_path"
            },
            {
              "action_api": "os.chdir()",
              "action_description": "Changes current working directory",
              "action_id": "change_working_dir",
              "object": "os.path.join(os.getcwd(), os.path.dirname(sys.argv[0]))",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Change working directory",
              "intention_id": "change_working_directory"
            },
            {
              "action_api": "pywinauto.Application().Start()",
              "action_description": "Spawns new process to execute command with shell access",
              "action_id": "spawn_process_shell",
              "object": "r'msiexec.exe /i 7z920-x64.msi'",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute file",
              "intention_id": "execute_file"
            },
            {
              "action_api": "Wizard.NextButton.click()",
              "action_description": "Changes window position",
              "action_id": "change_window_position",
              "object": "NextButton",
              "object_description": "Window title string",
              "object_id": "window_title_string",
              "intention_description": "Prepare argument for shortcut",
              "intention_id": "prepare_shortcut_argument"
            },
            {
              "action_api": "Wizard['I &accept the terms in the License Agreement'].wait('enabled').check_by_click()",
              "action_description": "Checks if window is enabled",
              "action_id": "check_window_enabled",
              "object": "I &accept the terms in the License Agreement",
              "object_description": "Window title string",
              "object_id": "window_title_string",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "Wizard.NextButton.click()",
              "action_description": "Changes window position",
              "action_id": "change_window_position",
              "object": "NextButton",
              "object_description": "Window title string",
              "object_id": "window_title_string",
              "intention_description": "Prepare argument for shortcut",
              "intention_id": "prepare_shortcut_argument"
            },
            {
              "action_api": "Wizard['Custom Setup'].wait('enabled')",
              "action_description": "Checks if window is enabled",
              "action_id": "check_window_enabled",
              "object": "Custom Setup",
              "object_description": "Window title string",
              "object_id": "window_title_string",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "Wizard.NextButton.click()",
              "action_description": "Changes window position",
              "action_id": "change_window_position",
              "object": "NextButton",
              "object_description": "Window title string",
              "object_id": "window_title_string",
              "intention_description": "Prepare argument for shortcut",
              "intention_id": "prepare_shortcut_argument"
            },
            {
              "action_api": "Wizard.Install.click()",
              "action_description": "Changes window position",
              "action_id": "change_window_position",
              "object": "Install",
              "object_description": "Window title string",
              "object_id": "window_title_string",
              "intention_description": "Prepare argument for shortcut",
              "intention_id": "prepare_shortcut_argument"
            },
            {
              "action_api": "Wizard.Finish.wait('enabled', timeout=30)",
              "action_description": "Checks if window is enabled",
              "action_id": "check_window_enabled",
              "object": "Finish",
              "object_description": "Window title string",
              "object_id": "window_title_string",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "Wizard.Finish.click()",
              "action_description": "Changes window position",
              "action_id": "change_window_position",
              "object": "Finish",
              "object_description": "Window title string",
              "object_id": "window_title_string",
              "intention_description": "Prepare argument for shortcut",
              "intention_id": "prepare_shortcut_argument"
            },
            {
              "action_api": "Wizard.wait_not('visible')",
              "action_description": "Checks if window is visible",
              "action_id": "check_window_visible",
              "object": "Wizard",
              "object_description": "Window title string",
              "object_id": "window_title_string",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            }
          ]
        }
      ]
    }
  ]
}