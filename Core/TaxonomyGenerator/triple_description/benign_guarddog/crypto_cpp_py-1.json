{
  "metadata": {
    "package_name": "crypto_cpp_py-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/crypto_cpp_py-1.4.5.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/crypto_cpp_py-1.4.5/crypto_cpp_py-1.4.5/setup.py",
      "line_number": "30",
      "type_description": "code-execution",
      "context_snippet": "import os\nimport subprocess\n\nfrom setuptools import Extension, setup\nfrom setuptools.command.build_ext import build_ext\nfrom setuptools.command.build_py import build_py\n\n\nclass CryptoExtension(Extension):\n    def __init__(self):\n        self.name = \"crypto_cpp\"\n        Extension.__init__(self, self.name, sources=[])\n\n\nclass BuildPy(build_py):\n    def run(self):\n        self.run_command(\"build_ext\")\n        return super().run()\n\n\nclass BuildCrypto(build_ext):\n    already_built = False\n\n    def build_extension(self, ext):\n        if self.already_built:\n            print(\"was already built, skipping...\")\n            return\n\n        if os.name != \"nt\":\n            subprocess.run(\"chmod a+x ./build_extension.sh\", shell=True, check=True)\n            subprocess.run(\n                \"./build_extension.sh\",\n                shell=True,\n                check=True,\n            )\n        else:\n            with subprocess.Popen(\n                [\"powershell.exe\", \".\\\\build_extension.ps1\"]\n            ) as process:\n                process.wait()\n                if process.returncode != 0:\n                    raise Exception(\"Build returned a non-zero code\")\n\n        self.already_built = True",
      "hash_value": "44c8f8cc24bc6f21d1140d59c471e99d",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "import os\nimport subprocess\n\nfrom setuptools import Extension, setup\nfrom setuptools.command.build_ext import build_ext\nfrom setuptools.command.build_py import build_py\n\n\nclass CryptoExtension(Extension):\n    def __init__(self):\n        self.name = \"crypto_cpp\"\n        Extension.__init__(self, self.name, sources=[])\n\n\nclass BuildPy(build_py):\n    def run(self):\n        self.run_command(\"build_ext\")\n        return super().run()\n\n\nclass BuildCrypto(build_ext):\n    already_built = False\n\n    def build_extension(self, ext):\n        if self.already_built:\n            print(\"was already built, skipping...\")\n            return\n\n        if os.name != \"nt\":\n            subprocess.run(\"chmod a+x ./build_extension.sh\", shell=True, check=True)\n            subprocess.run(\n                \"./build_extension.sh\",\n                shell=True,\n                check=True,\n            )\n        else:\n            with subprocess.Popen(\n                [\"powershell.exe\", \".\\\\build_extension.ps1\"]\n            ) as process:\n                process.wait()\n                if process.returncode != 0:\n                    raise Exception(\"Build returned a non-zero code\")\n\n        self.already_built = True",
          "triple_sequences": [
            {
              "action_api": "os.name",
              "action_description": "Retrieves operating system identifier",
              "action_id": "get_os_id",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Determine operating system",
              "intention_id": "get_operating_system_name"
            },
            {
              "action_api": "subprocess.run()",
              "action_description": "Spawns new process to execute command with shell access",
              "action_id": "spawn_process_shell",
              "object": "chmod a+x ./build_extension.sh",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Modify file attributes",
              "intention_id": "modify_file_attributes"
            },
            {
              "action_api": "subprocess.run()",
              "action_description": "Spawns new process to execute command with shell access",
              "action_id": "spawn_process_shell",
              "object": "./build_extension.sh",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute file",
              "intention_id": "execute_file"
            },
            {
              "action_api": "subprocess.Popen()",
              "action_description": "Spawns new process to execute command with shell access",
              "action_id": "spawn_process_shell",
              "object": "[\"powershell.exe\", \".\\\\build_extension.ps1\"]",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute file",
              "intention_id": "execute_file"
            },
            {
              "action_api": "process.wait()",
              "action_description": "Waits for process to complete execution",
              "action_id": "wait_process_completion",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Wait for events",
              "intention_id": "wait_for_events"
            }
          ]
        }
      ]
    }
  ]
}