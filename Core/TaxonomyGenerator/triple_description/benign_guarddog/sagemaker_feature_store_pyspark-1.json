{
  "metadata": {
    "package_name": "sagemaker_feature_store_pyspark-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/sagemaker_feature_store_pyspark-1.1.3.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/sagemaker_feature_store_pyspark-1.1.3/sagemaker_feature_store_pyspark-1.1.3/setup.py",
      "line_number": "61",
      "type_description": "code-execution",
      "context_snippet": "import os\nimport shutil\nimport sys\nimport subprocess\n\nfrom pathlib import Path\n\nSPARK_HOME = os.getenv('SPARK_HOME')\nTEMP_PATH = \"deps\"\nVERSION_PATH = \"VERSION\"\nJARS_TARGET = os.path.join(TEMP_PATH, \"jars\")\nSCALA_SPARK_DIR = Path(\"../scala-spark-sdk\")\nUBER_JAR_NAME_PREFIX = \"sagemaker-feature-store-spark-sdk\"\nUBER_JAR_NAME = f\"{UBER_JAR_NAME_PREFIX}.jar\"\n\nin_spark_sdk = os.path.isfile(SCALA_SPARK_DIR / \"build.sbt\")\n\n...\n\nif in_spark_sdk:\n    shutil.copyfile(os.path.join(\"..\", VERSION_PATH), VERSION_PATH)\n\n    if not os.path.exists(TEMP_PATH):\n        os.mkdir(TEMP_PATH)\n\n    # use sbt to package the scala uber jar\n    p = subprocess.Popen(\"sbt assembly\".split(),\n                         stdout=subprocess.PIPE,\n                         stderr=subprocess.PIPE,\n                         cwd=SCALA_SPARK_DIR)\n    p.communicate()\n",
      "hash_value": "97e1c6cb2ac3562ec68769fd9148d4ca",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "import os\nimport shutil\nimport sys\nimport subprocess\n\nfrom pathlib import Path\n\nSPARK_HOME = os.getenv('SPARK_HOME')\nTEMP_PATH = \"deps\"\nVERSION_PATH = \"VERSION\"\nJARS_TARGET = os.path.join(TEMP_PATH, \"jars\")\nSCALA_SPARK_DIR = Path(\"../scala-spark-sdk\")\nUBER_JAR_NAME_PREFIX = \"sagemaker-feature-store-spark-sdk\"\nUBER_JAR_NAME = f\"{UBER_JAR_NAME_PREFIX}.jar\"\n\nin_spark_sdk = os.path.isfile(SCALA_SPARK_DIR / \"build.sbt\")\n\n...\n\nif in_spark_sdk:\n    shutil.copyfile(os.path.join(\"..\", VERSION_PATH), VERSION_PATH)\n\n    if not os.path.exists(TEMP_PATH):\n        os.mkdir(TEMP_PATH)\n\n    # use sbt to package the scala uber jar\n    p = subprocess.Popen(\"sbt assembly\".split(),\n                         stdout=subprocess.PIPE,\n                         stderr=subprocess.PIPE,\n                         cwd=SCALA_SPARK_DIR)\n    p.communicate()\n",
          "triple_sequences": [
            {
              "action_api": "os.path.isfile()",
              "action_description": "Checks if specified path exists and is a file",
              "action_id": "check_file_is_file",
              "object": "SCALA_SPARK_DIR / \"build.sbt\"",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Determine file presence",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "shutil.copyfile()",
              "action_description": "Copies file to destination",
              "action_id": "copy_file",
              "object": "os.path.join(\"..\", VERSION_PATH), VERSION_PATH",
              "object_description": "Local file or directory",
              "object_id": "local_file_or_directory",
              "intention_description": "Copy file to temporary directory",
              "intention_id": "copy_file_temp_directory"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "TEMP_PATH",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Determine directory presence",
              "intention_id": "determine_directory_presence"
            },
            {
              "action_api": "os.mkdir()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "TEMP_PATH",
              "object_description": "Directory path",
              "object_id": "directory_path",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "subprocess.Popen()",
              "action_description": "Spawns new process to execute command with shell access",
              "action_id": "spawn_process_shell",
              "object": "\"sbt assembly\".split(), stdout=subprocess.PIPE, stderr=subprocess.PIPE, cwd=SCALA_SPARK_DIR",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "p.communicate()",
              "action_description": "Waits for process to complete execution",
              "action_id": "wait_process_completion",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Wait for events",
              "intention_id": "wait_for_events"
            }
          ]
        }
      ]
    }
  ]
}