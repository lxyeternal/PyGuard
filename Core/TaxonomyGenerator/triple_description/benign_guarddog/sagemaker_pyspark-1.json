{
  "metadata": {
    "package_name": "sagemaker_pyspark-1",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/sagemaker_pyspark-1.4.5.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "setup.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/sagemaker_pyspark-1.4.5/sagemaker_pyspark-1.4.5/setup.py",
      "line_number": "39",
      "type_description": "code-execution",
      "context_snippet": "try:  # noqa\n    if in_sagemaker_sdk:\n        try:\n            shutil.copyfile(os.path.join(\"..\", VERSION_PATH), VERSION_PATH)\n        except OSError:\n            print(\"Could not copy VERSION file\")\n            exit(1)\n\n        try:\n            os.mkdir(TEMP_PATH)\n        except OSError:\n            print(\"Could not create dir {0}\".format(TEMP_PATH), file=sys.stderr)\n            exit(1)\n\n        p = subprocess.Popen(\n            \"sbt printClasspath\".split(),\n            stdout=subprocess.PIPE,\n            stderr=subprocess.PIPE,\n            cwd=\"../sagemaker-spark-sdk/\",\n        )\n\n        output, errors = p.communicate()\n\n        classpath = []\n        # Java Libraries to include.\n        java_libraries = [\"aws\", \"sagemaker\", \"hadoop\", \"htrace\"]\n        for line in output.decode(\"utf-8\").splitlines():\n            path = str(line.strip())\n            if path.endswith(\".jar\") and os.path.exists(path):\n                jar = os.path.basename(path).lower()\n                if any(lib in jar for lib in java_libraries):\n                    classpath.append(path)\n\n        os.mkdir(JARS_TARGET)\n        for jar in classpath:\n            target_path = os.path.join(JARS_TARGET, os.path.basename(jar))\n            if not os.path.exists(target_path):\n                shutil.copy(jar, target_path)\n\n        if len(classpath) == 0:\n            print(\"Failed to retrieve the jar classpath. Can't package\")\n            exit(-1)\n\n    else:\n        if not os.path.exists(JARS_TARGET):\n            print(\n                \"You need to be in the sagemaker-pyspark-sdk root folder to package\",\n                file=sys.stderr,\n            )\n            exit(-1)\n\n    setup(\n        name=\"sagemaker_pyspark\",\n        version=read_version(),\n        description=\"Amazon SageMaker PySpark Bindings\",\n        author=\"Amazon Web Services\",\n        url=\"https://github.com/aws/sagemaker-spark\",\n        license=\"Apache License 2.0\",\n        python_requires=\">= 3.7\",\n        zip_safe=False,\n        packages=[\n            \"sagemaker_pyspark\",\n            \"sagemaker_pyspark.algorithms\",\n            \"sagemaker_pyspark.transformation\",\n            \"sagemaker_pyspark.transformation.deserializers\",\n            \"sagemaker_pyspark.transformation.serializers\",\n            \"sagemaker_pyspark.jars\",\n            \"sagemaker_pyspark.licenses\",\n        ],\n        package_dir={\n            \"sagemaker_pyspark\": \"src/sagemaker_pyspark\",\n            \"sagemaker_pyspark.jars\": \"deps/jars\",\n            \"sagemaker_pyspark.licenses\": \"licenses\",\n        },\n        include_package_data=True,\n        package_data={\n            \"sagemaker_pyspark.jars\": [\"*.jar\"],\n            \"sagemaker_pyspark.licenses\": [\"*.txt\"],\n        },\n        scripts=[\"bin/sagemakerpyspark-jars\", \"bin/sagemakerpyspark-emr-jars\"],\n        install_requires=[\n            \"pyspark==3.3.0\",\n            \"numpy\",\n        ],\n    )\n\nfinally:\n    if in_sagemaker_sdk:\n        if os.path.exists(JARS_TARGET):\n            shutil.rmtree(JARS_TARGET)\n\n        if os.path.exists(TEMP_PATH):\n            os.rmdir(TEMP_PATH)\n\n        if os.path.exists(VERSION_PATH):\n            os.remove(VERSION_PATH)\n",
      "hash_value": "c6357473374e034d47a40c938589d8cb",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "try:  # noqa\n    if in_sagemaker_sdk:\n        try:\n            shutil.copyfile(os.path.join(\"..\", VERSION_PATH), VERSION_PATH)\n        except OSError:\n            print(\"Could not copy VERSION file\")\n            exit(1)\n\n        try:\n            os.mkdir(TEMP_PATH)\n        except OSError:\n            print(\"Could not create dir {0}\".format(TEMP_PATH), file=sys.stderr)\n            exit(1)\n\n        p = subprocess.Popen(\n            \"sbt printClasspath\".split(),\n            stdout=subprocess.PIPE,\n            stderr=subprocess.PIPE,\n            cwd=\"../sagemaker-spark-sdk/\",\n        )\n\n        output, errors = p.communicate()\n\n        classpath = []\n        # Java Libraries to include.\n        java_libraries = [\"aws\", \"sagemaker\", \"hadoop\", \"htrace\"]\n        for line in output.decode(\"utf-8\").splitlines():\n            path = str(line.strip())\n            if path.endswith(\".jar\") and os.path.exists(path):\n                jar = os.path.basename(path).lower()\n                if any(lib in jar for lib in java_libraries):\n                    classpath.append(path)\n\n        os.mkdir(JARS_TARGET)\n        for jar in classpath:\n            target_path = os.path.join(JARS_TARGET, os.path.basename(jar))\n            if not os.path.exists(target_path):\n                shutil.copy(jar, target_path)\n\n        if len(classpath) == 0:\n            print(\"Failed to retrieve the jar classpath. Can't package\")\n            exit(-1)\n\n    else:\n        if not os.path.exists(JARS_TARGET):\n            print(\n                \"You need to be in the sagemaker-pyspark-sdk root folder to package\",\n                file=sys.stderr,\n            )\n            exit(-1)\n\n    setup(\n        name=\"sagemaker_pyspark\",\n        version=read_version(),\n        description=\"Amazon SageMaker PySpark Bindings\",\n        author=\"Amazon Web Services\",\n        url=\"https://github.com/aws/sagemaker-spark\",\n        license=\"Apache License 2.0\",\n        python_requires=\">= 3.7\",\n        zip_safe=False,\n        packages=[\n            \"sagemaker_pyspark\",\n            \"sagemaker_pyspark.algorithms\",\n            \"sagemaker_pyspark.transformation\",\n            \"sagemaker_pyspark.transformation.deserializers\",\n            \"sagemaker_pyspark.transformation.serializers\",\n            \"sagemaker_pyspark.jars\",\n            \"sagemaker_pyspark.licenses\",\n        ],\n        package_dir={\n            \"sagemaker_pyspark\": \"src/sagemaker_pyspark\",\n            \"sagemaker_pyspark.jars\": \"deps/jars\",\n            \"sagemaker_pyspark.licenses\": \"licenses\",\n        },\n        include_package_data=True,\n        package_data={\n            \"sagemaker_pyspark.jars\": [\"*.jar\"],\n            \"sagemaker_pyspark.licenses\": [\"*.txt\"],\n        },\n        scripts=[\"bin/sagemakerpyspark-jars\", \"bin/sagemakerpyspark-emr-jars\"],\n        install_requires=[\n            \"pyspark==3.3.0\",\n            \"numpy\",\n        ],\n    )\n\nfinally:\n    if in_sagemaker_sdk:\n        if os.path.exists(JARS_TARGET):\n            shutil.rmtree(JARS_TARGET)\n\n        if os.path.exists(TEMP_PATH):\n            os.rmdir(TEMP_PATH)\n\n        if os.path.exists(VERSION_PATH):\n            os.remove(VERSION_PATH)\n",
          "triple_sequences": [
            {
              "action_api": "shutil.copyfile()",
              "action_description": "Copies file to destination",
              "action_id": "copy_file",
              "object": "os.path.join(\"..\", VERSION_PATH), VERSION_PATH",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Copy file to temporary directory",
              "intention_id": "copy_file_temp_directory"
            },
            {
              "action_api": "os.mkdir()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "TEMP_PATH",
              "object_description": "Temporary directory",
              "object_id": "temporary_directory",
              "intention_description": "Create temporary directory",
              "intention_id": "create_temporary_directory"
            },
            {
              "action_api": "subprocess.Popen()",
              "action_description": "Spawns new process to execute command without shell access",
              "action_id": "spawn_process_no_shell",
              "object": "\"sbt printClasspath\".split(), stdout=subprocess.PIPE, stderr=subprocess.PIPE, cwd=\"../sagemaker-spark-sdk/\"",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Execute command",
              "intention_id": "execute_command"
            },
            {
              "action_api": "p.communicate()",
              "action_description": "Reads all bytes from process standard output",
              "action_id": "read_process_stdout",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Collect command output",
              "intention_id": "collect_command_output"
            },
            {
              "action_api": "output.decode()",
              "action_description": "Decodes bytes using default codec",
              "action_id": "decode_bytes_default",
              "object": "\"utf-8\"",
              "object_description": "Character encoding type",
              "object_id": "character_encoding_type",
              "intention_description": "Decode command output",
              "intention_id": "decode_command_output"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "path",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Check if file or directory exists",
              "intention_id": "check_file_existence"
            },
            {
              "action_api": "os.path.basename()",
              "action_description": "Basic path string operations (getting absolute path, base name, parent directory, splitting and joining paths)",
              "action_id": "path_string_operations",
              "object": "path",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Prepare path for file operations",
              "intention_id": "prepare_path_file_operations"
            },
            {
              "action_api": "os.mkdir()",
              "action_description": "Creates directory, ignoring if it already exists",
              "action_id": "create_directory",
              "object": "JARS_TARGET",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Ensure directory exists",
              "intention_id": "ensure_directory_exists"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "target_path",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Determine file presence",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "shutil.copy()",
              "action_description": "Copies file to destination",
              "action_id": "copy_file",
              "object": "jar, target_path",
              "object_description": "Directory path and file name",
              "object_id": "directory_path_with_file",
              "intention_description": "Copy file to temporary directory",
              "intention_id": "copy_file_temp_directory"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "JARS_TARGET",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Determine directory presence",
              "intention_id": "determine_directory_presence"
            },
            {
              "action_api": "setup()",
              "action_description": "Executes setuptools installation procedure",
              "action_id": "exec_setuptools_install",
              "object": "name=\"sagemaker_pyspark\", ...",
              "object_description": "Module name string",
              "object_id": "module_name_string",
              "intention_description": "Install required Python package",
              "intention_id": "install_required_python_package"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "JARS_TARGET",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Determine directory presence",
              "intention_id": "determine_directory_presence"
            },
            {
              "action_api": "shutil.rmtree()",
              "action_description": "Recursively deletes directory and its contents",
              "action_id": "delete_directory",
              "object": "JARS_TARGET",
              "object_description": "Custom directory",
              "object_id": "custom_directory",
              "intention_description": "Delete directory content",
              "intention_id": "delete_directory_content"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "TEMP_PATH",
              "object_description": "Temporary directory",
              "object_id": "temporary_directory",
              "intention_description": "Determine directory presence",
              "intention_id": "determine_directory_presence"
            },
            {
              "action_api": "os.rmdir()",
              "action_description": "Recursively deletes directory and its contents",
              "action_id": "delete_directory",
              "object": "TEMP_PATH",
              "object_description": "Temporary directory",
              "object_id": "temporary_directory",
              "intention_description": "Delete directory content",
              "intention_id": "delete_directory_content"
            },
            {
              "action_api": "os.path.exists()",
              "action_description": "Checks if specified path exists in filesystem",
              "action_id": "check_path_exists",
              "object": "VERSION_PATH",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Determine file presence",
              "intention_id": "determine_file_presence"
            },
            {
              "action_api": "os.remove()",
              "action_description": "Deletes specified file from filesystem",
              "action_id": "delete_file",
              "object": "VERSION_PATH",
              "object_description": "File path",
              "object_id": "file_path",
              "intention_description": "Delete file",
              "intention_id": "delete_file"
            }
          ]
        }
      ]
    }
  ]
}