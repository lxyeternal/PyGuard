{
  "metadata": {
    "package_name": "praat_parselmouth-0",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/praat_parselmouth-0.4.5.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "conf.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/praat_parselmouth-0.4.5/praat_parselmouth-0.4.5/docs/conf.py",
      "line_number": "86",
      "type_description": "exfiltrate-sensitive-data",
      "context_snippet": "import git\nimport github\nimport requests\n\nimport io\nimport os\nimport subprocess\nimport sys\nimport tempfile\nimport zipfile\n\non_rtd = os.environ.get('READTHEDOCS') == 'True'\n\nif on_rtd:\n    rtd_version = os.environ.get('READTHEDOCS_VERSION')\n    branch = 'master' if rtd_version == 'latest' else rtd_version\n\n    github_token = os.environ['GITHUB_TOKEN']\n    head_sha = git.Repo(search_parent_directories=True).head.commit.hexsha\n    g = github.Github()\n    runs = g.get_repo('YannickJadoul/Parselmouth').get_workflow(\"wheels.yml\").get_runs(branch=branch)\n    artifacts_url = next(r for r in runs if r.head_sha == head_sha).artifacts_url\n\n    archive_download_url = next(artifact for artifact in requests.get(artifacts_url).json()['artifacts'] if artifact['name'] == 'rtd-wheel')['archive_download_url']\n    artifact_bin = io.BytesIO(requests.get(archive_download_url, headers={'Authorization': f'token {github_token}'}, stream=True).content)\n\n    with zipfile.ZipFile(artifact_bin) as zf, tempfile.TemporaryDirectory() as tmpdir:\n        assert len(zf.namelist()) == 1\n        zf.extractall(tmpdir)\n        subprocess.check_call([sys.executable, '-m', 'pip', 'install', '--force-reinstall', tmpdir + '/' + zf.namelist()[0]])",
      "hash_value": "36a2fb819a1964d0f6a24a5caea30467",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "import git\nimport github\nimport requests\n\nimport io\nimport os\nimport subprocess\nimport sys\nimport tempfile\nimport zipfile\n\non_rtd = os.environ.get('READTHEDOCS') == 'True'\n\nif on_rtd:\n    rtd_version = os.environ.get('READTHEDOCS_VERSION')\n    branch = 'master' if rtd_version == 'latest' else rtd_version\n\n    github_token = os.environ['GITHUB_TOKEN']\n    head_sha = git.Repo(search_parent_directories=True).head.commit.hexsha\n    g = github.Github()\n    runs = g.get_repo('YannickJadoul/Parselmouth').get_workflow(\"wheels.yml\").get_runs(branch=branch)\n    artifacts_url = next(r for r in runs if r.head_sha == head_sha).artifacts_url\n\n    archive_download_url = next(artifact for artifact in requests.get(artifacts_url).json()['artifacts'] if artifact['name'] == 'rtd-wheel')['archive_download_url']\n    artifact_bin = io.BytesIO(requests.get(archive_download_url, headers={'Authorization': f'token {github_token}'}, stream=True).content)\n\n    with zipfile.ZipFile(artifact_bin) as zf, tempfile.TemporaryDirectory() as tmpdir:\n        assert len(zf.namelist()) == 1\n        zf.extractall(tmpdir)\n        subprocess.check_call([sys.executable, '-m', 'pip', 'install', '--force-reinstall', tmpdir + '/' + zf.namelist()[0]])",
          "triple_sequences": [
            {
              "action_api": "os.environ.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "'READTHEDOCS'",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.environ.get()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "'READTHEDOCS_VERSION'",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "os.environ.__getitem__()",
              "action_description": "Retrieves value of environment variable",
              "action_id": "get_env_var",
              "object": "'GITHUB_TOKEN'",
              "object_description": "Environment variable",
              "object_id": "environment_variable",
              "intention_description": "Collect environment variable",
              "intention_id": "collect_environment_variable"
            },
            {
              "action_api": "git.Repo()",
              "action_description": "Initializes Git command wrapper",
              "action_id": "init_git_wrapper",
              "object": "search_parent_directories=True",
              "object_description": "Repository reference",
              "object_id": "repository_reference",
              "intention_description": "Import required module",
              "intention_id": "import_required_module"
            },
            {
              "action_api": "git.Repo().head.commit.hexsha",
              "action_description": "Retrieves current HEAD reference of repository",
              "action_id": "get_git_head",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Extract structured data from file",
              "intention_id": "extract_structured_file_data"
            },
            {
              "action_api": "github.Github()",
              "action_description": "Instantiates GitHub class",
              "action_id": "import_dynamic",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Import required module",
              "intention_id": "import_required_module"
            },
            {
              "action_api": "g.get_repo()",
              "action_description": "Retrieves object from repository",
              "action_id": "get_git_object",
              "object": "'YannickJadoul/Parselmouth'",
              "object_description": "Repository reference",
              "object_id": "repository_reference",
              "intention_description": "Extract structured data from file",
              "intention_id": "extract_structured_file_data"
            },
            {
              "action_api": "repo.get_workflow()",
              "action_description": "Retrieves object from repository",
              "action_id": "get_git_object",
              "object": "\"wheels.yml\"",
              "object_description": "Repository reference",
              "object_id": "repository_reference",
              "intention_description": "Extract structured data from file",
              "intention_id": "extract_structured_file_data"
            },
            {
              "action_api": "workflow.get_runs()",
              "action_description": "Retrieves object from repository",
              "action_id": "get_git_object",
              "object": "branch=branch",
              "object_description": "Repository reference",
              "object_id": "repository_reference",
              "intention_description": "Extract structured data from file",
              "intention_id": "extract_structured_file_data"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP GET request to URL",
              "action_id": "open_url_get",
              "object": "artifacts_url",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "requests.get().json()",
              "action_description": "Deserializes JSON response body to Python object",
              "action_id": "deserialize_json_response",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Parse JSON data",
              "intention_id": "parse_json_data"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP GET request to URL",
              "action_id": "open_url_get",
              "object": "archive_download_url, headers={'Authorization': f'token {github_token}'}, stream=True",
              "object_description": "External domain",
              "object_id": "external_domain",
              "intention_description": "Download remote content",
              "intention_id": "download_remote_content"
            },
            {
              "action_api": "io.BytesIO()",
              "action_description": "Creates in-memory bytes buffer from encoded string",
              "action_id": "create_memory_bytes",
              "object": "requests.get(...).content",
              "object_description": "Image binary stream",
              "object_id": "image_binary_stream",
              "intention_description": "Prepare data for further processing",
              "intention_id": "prepare_data_processing"
            },
            {
              "action_api": "zipfile.ZipFile()",
              "action_description": "Opens ZIP archive for reading",
              "action_id": "open_zip_read",
              "object": "artifact_bin",
              "object_description": "ZIP archive file",
              "object_id": "zip_archive",
              "intention_description": "Open database for reading",
              "intention_id": "open_database_reading"
            },
            {
              "action_api": "tempfile.TemporaryDirectory()",
              "action_description": "Creates temporary directory and returns its path",
              "action_id": "create_temp_dir",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Create temporary directory",
              "intention_id": "create_temporary_directory"
            },
            {
              "action_api": "zipfile.ZipFile().namelist()",
              "action_description": "Lists all currently alive threads",
              "action_id": "list_threads",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "List files in directory",
              "intention_id": "list_directory_files"
            },
            {
              "action_api": "zipfile.ZipFile().extractall()",
              "action_description": "Extracts all files from ZIP archive to specified directory",
              "action_id": "extract_zip_files",
              "object": "tmpdir",
              "object_description": "Temporary directory",
              "object_id": "temporary_directory",
              "intention_description": "Decompress downloaded archive",
              "intention_id": "decompress_downloaded_archive"
            },
            {
              "action_api": "subprocess.check_call()",
              "action_description": "Executes shell command",
              "action_id": "execute_shell_command",
              "object": "[sys.executable, '-m', 'pip', 'install', '--force-reinstall', tmpdir + '/' + zf.namelist()[0]]",
              "object_description": "Shell command",
              "object_id": "shell_command",
              "intention_description": "Install required Python package",
              "intention_id": "install_required_python_package"
            }
          ]
        }
      ]
    }
  ]
}