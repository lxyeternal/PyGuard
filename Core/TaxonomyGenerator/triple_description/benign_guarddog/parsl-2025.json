{
  "metadata": {
    "package_name": "parsl-2025",
    "original_json_path": "/home2/blue/Documents/PyPIAgent/Codes/code_contexral/codesnippets/benign/parsl-2025.4.7.json",
    "dataset_type": "benign"
  },
  "code_files": [
    {
      "pyfile": "addresses.py",
      "full_path": "/home2/blue/Documents/PyPIAgent/Dataset/study/unzip_benign/parsl-2025.4.7/parsl-2025.4.7/parsl/addresses.py",
      "line_number": "60",
      "type_description": "shady-links",
      "context_snippet": "import requests\nimport logging\nimport typeguard\n\nlogger = logging.getLogger(__name__)\n\n@typeguard.typechecked\ndef address_by_query(timeout: float = 30) -> str:\n    \"\"\"Finds an address for the local host by querying ipify. This may\n       return an unusable value when the host is behind NAT, or when the\n       internet-facing address is not reachable from workers.\n       Parameters:\n       -----------\n\n       timeout : float\n          Timeout for the request in seconds. Default: 30s\n    \"\"\"\n    logger.debug(\"Finding address by querying remote service\")\n    response = requests.get('https://api.ipify.org', timeout=timeout)\n\n    if response.status_code == 200:\n        addr = response.text\n        logger.debug(\"Address found: {}\".format(addr))\n        return addr\n    else:\n        raise RuntimeError(\"Remote service returned unexpected HTTP status code {}\".format(response.status_code))",
      "hash_value": "b7181ca521cf29f537e5eb07c266347d",
      "detection_index": 1,
      "code_snippets": [
        {
          "snippet": "import requests\nimport logging\nimport typeguard\n\nlogger = logging.getLogger(__name__)\n\n@typeguard.typechecked\ndef address_by_query(timeout: float = 30) -> str:\n    \"\"\"Finds an address for the local host by querying ipify. This may\n       return an unusable value when the host is behind NAT, or when the\n       internet-facing address is not reachable from workers.\n       Parameters:\n       -----------\n\n       timeout : float\n          Timeout for the request in seconds. Default: 30s\n    \"\"\"\n    logger.debug(\"Finding address by querying remote service\")\n    response = requests.get('https://api.ipify.org', timeout=timeout)\n\n    if response.status_code == 200:\n        addr = response.text\n        logger.debug(\"Address found: {}\".format(addr))\n        return addr\n    else:\n        raise RuntimeError(\"Remote service returned unexpected HTTP status code {}\".format(response.status_code))",
          "triple_sequences": [
            {
              "action_api": "logging.getLogger()",
              "action_description": "Retrieves standard output stream object",
              "action_id": "get_stdout_stream",
              "object": "__name__",
              "object_description": "Module name string",
              "object_id": "module_name_string",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "typeguard.typechecked",
              "action_description": "Checks if object is instance of specified type",
              "action_id": "check_instance_type",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Stop execution on invalid input",
              "intention_id": "stop_execution_invalid_input"
            },
            {
              "action_api": "logger.debug()",
              "action_description": "Retrieves standard output stream object",
              "action_id": "get_stdout_stream",
              "object": "\"Finding address by querying remote service\"",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "requests.get()",
              "action_description": "Sends HTTP GET request to URL",
              "action_id": "open_url_get",
              "object": "'https://api.ipify.org'",
              "object_description": "API endpoint",
              "object_id": "api_endpoint",
              "intention_description": "Collect public IP address",
              "intention_id": "collect_public_ip"
            },
            {
              "action_api": "response.status_code",
              "action_description": "Retrieves HTTP response status code",
              "action_id": "get_http_status",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "response.text",
              "action_description": "Process HTTP response content",
              "action_id": "process_http_response",
              "object": "",
              "object_description": "",
              "object_id": "",
              "intention_description": "Extract public IP address",
              "intention_id": "extract_public_ip_address"
            },
            {
              "action_api": "logger.debug()",
              "action_description": "Retrieves standard output stream object",
              "action_id": "get_stdout_stream",
              "object": "\"Address found: {}\".format(addr)",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Access attribute value",
              "intention_id": "access_attribute_value"
            },
            {
              "action_api": "raise RuntimeError()",
              "action_description": "Raises HTTPError if response status code indicates error",
              "action_id": "raise_http_error",
              "object": "\"Remote service returned unexpected HTTP status code {}\".format(response.status_code)",
              "object_description": "Error message text",
              "object_id": "error_message",
              "intention_description": "Stop execution on invalid input",
              "intention_id": "stop_execution_invalid_input"
            }
          ]
        }
      ]
    }
  ]
}