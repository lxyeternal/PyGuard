[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m140 | [0m[35m                info.get("database", None),[0m
[30;1m141 | [0m[35m            )[0m
[30;1m142 | [0m[35m            return "mysql", create_engine([0m
[30;1m143 | [0m[35m                f"mysql://{username}:{password}@{host}:{port}/{database}"[0m
[30;1m144 | [0m[35m            )[0m
[30;1m145 | [0m[35m        elif "sqlite" in info["type"]:[0m
[30;1m146 | [0m[35m            dbfile = info.get("dbfile", None)[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m134 | [0m[35m        elif "mysql" in info["type"]:[0m
[30;1m135 | [0m[35m            username, password, host, port, database = ([0m
[30;1m136 | [0m[35m                info.get("username", None),[0m
[30;1m137 | [0m[35m                info.get("password", None),[0m
[30;1m138 | [0m[35m                info.get("host", None),[0m
[30;1m139 | [0m[35m                info.get("port", None),[0m
[30;1m140 | [0m[35m                info.get("database", None),[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m132 | [0m[35m                f"mssql+pyodbc://{username}:{password}@{dsn}"[0m
[30;1m133 | [0m[35m            )[0m
[30;1m134 | [0m[35m        elif "mysql" in info["type"]:[0m
[30;1m135 | [0m[35m            username, password, host, port, database = ([0m
[30;1m136 | [0m[35m                info.get("username", None),[0m
[30;1m137 | [0m[35m                info.get("password", None),[0m
[30;1m138 | [0m[35m                info.get("host", None),[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m129 | [0m[35m                info.get("dsn", None),[0m
[30;1m130 | [0m[35m            )[0m
[30;1m131 | [0m[35m            return "myssql", create_engine([0m
[30;1m132 | [0m[35m                f"mssql+pyodbc://{username}:{password}@{dsn}"[0m
[30;1m133 | [0m[35m            )[0m
[30;1m134 | [0m[35m        elif "mysql" in info["type"]:[0m
[30;1m135 | [0m[35m            username, password, host, port, database = ([0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m124 | [0m[35m        elif "mssql" in info["type"]:[0m
[30;1m125 | [0m[35m            username, password, port, dsn = ([0m
[30;1m126 | [0m[35m                info.get("username", None),[0m
[30;1m127 | [0m[35m                info.get("password", None),[0m
[30;1m128 | [0m[35m                info.get("port", None),[0m
[30;1m129 | [0m[35m                info.get("dsn", None),[0m
[30;1m130 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m122 | [0m[35m                f"""{driver_type}://{username}:{password}@{host}/{database}?driver={driver_path}&por[0m
[30;1m123 | [0m[35m            )[0m
[30;1m124 | [0m[35m        elif "mssql" in info["type"]:[0m
[30;1m125 | [0m[35m            username, password, port, dsn = ([0m
[30;1m126 | [0m[35m                info.get("username", None),[0m
[30;1m127 | [0m[35m                info.get("password", None),[0m
[30;1m128 | [0m[35m                info.get("port", None),[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m119 | [0m[35m            )[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m            return "odbc", create_engine([0m
[30;1m122 | [0m[35m                f"""{driver_type}://{username}:{password}@{host}/{database}?driver={driver_path}&por[0m
[30;1m123 | [0m[35m            )[0m
[30;1m124 | [0m[35m        elif "mssql" in info["type"]:[0m
[30;1m125 | [0m[35m            username, password, port, dsn = ([0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m110 | [0m[35m        elif "odbc" in info["type"]:[0m
[30;1m111 | [0m[35m            username, password, host, port, database, driver_path, driver_type = ([0m
[30;1m112 | [0m[35m                info.get("username", None),[0m
[30;1m113 | [0m[35m                info.get("password", None),[0m
[30;1m114 | [0m[35m                info.get("host", None),[0m
[30;1m115 | [0m[35m                info.get("port", None),[0m
[30;1m116 | [0m[35m                info.get("database", None),[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m108 | [0m[35m            connection = cx_Oracle.connect(username, password, db_alias)[0m
[30;1m109 | [0m[35m            return "oracle", connection[0m
[30;1m110 | [0m[35m        elif "odbc" in info["type"]:[0m
[30;1m111 | [0m[35m            username, password, host, port, database, driver_path, driver_type = ([0m
[30;1m112 | [0m[35m                info.get("username", None),[0m
[30;1m113 | [0m[35m                info.get("password", None),[0m
[30;1m114 | [0m[35m                info.get("host", None),[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m105 | [0m[35m                info.get("db_alias", None),[0m
[30;1m106 | [0m[35m            )[0m
[30;1m107 | [0m[35m            cx_Oracle.makedsn(host, port, service_name=service_name)[0m
[30;1m108 | [0m[35m            connection = cx_Oracle.connect(username, password, db_alias)[0m
[30;1m109 | [0m[35m            return "oracle", connection[0m
[30;1m110 | [0m[35m        elif "odbc" in info["type"]:[0m
[30;1m111 | [0m[35m            username, password, host, port, database, driver_path, driver_type = ([0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m            username, password, host, port, service_name, db_alias = ([0m
[30;1m100 | [0m[35m                info.get("username", None),[0m
[30;1m101 | [0m[35m                info.get("password", None),[0m
[30;1m102 | [0m[35m                info.get("host", None),[0m
[30;1m103 | [0m[35m                info.get("port", None),[0m
[30;1m104 | [0m[35m                info.get("service_name", None),[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m96 | [0m[35m        elif "oracle" in info["type"]:[0m
[30;1m97 | [0m[35m            import cx_Oracle[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m            username, password, host, port, service_name, db_alias = ([0m
[30;1m100 | [0m[35m                info.get("username", None),[0m
[30;1m101 | [0m[35m                info.get("password", None),[0m
[30;1m102 | [0m[35m                info.get("host", None),[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m91 | [0m[35m                info.get("database", None),[0m
[30;1m92 | [0m[35m            )[0m
[30;1m93 | [0m[35m            return "postgres", create_engine([0m
[30;1m94 | [0m[35m                f"postgresql://{username}:{password}@{host}:{port}/{database}"[0m
[30;1m95 | [0m[35m            )[0m
[30;1m96 | [0m[35m        elif "oracle" in info["type"]:[0m
[30;1m97 | [0m[35m            import cx_Oracle[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m85 | [0m[35m        if "postgres" in info["type"]:[0m
[30;1m86 | [0m[35m            username, password, host, port, database = ([0m
[30;1m87 | [0m[35m                info.get("username", None),[0m
[30;1m88 | [0m[35m                info.get("password", None),[0m
[30;1m89 | [0m[35m                info.get("host", None),[0m
[30;1m90 | [0m[35m                info.get("port", None),[0m
[30;1m91 | [0m[35m                info.get("database", None),[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m        info = self.secrets.get(self.target_host)[0m
[30;1m85 | [0m[35m        if "postgres" in info["type"]:[0m
[30;1m86 | [0m[35m            username, password, host, port, database = ([0m
[30;1m87 | [0m[35m                info.get("username", None),[0m
[30;1m88 | [0m[35m                info.get("password", None),[0m
[30;1m89 | [0m[35m                info.get("host", None),[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/etl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m                        **process, secrets=conf.secrets[0m
[30;1m26 | [0m[35m                    )[0m
[30;1m27 | [0m[35m                    if conf.meta_output and process.get("file_output", None):[0m
[30;1m28 | [0m[35m                        file_information(process.get("file_output"), conf.meta_output)[0m
[30;1m29 | [0m[35m            except KeyError as ex:[0m
[30;1m30 | [0m[35m                logger.error("Got key error, skipping...")[0m
[30;1m31 | [0m[35m                logger.error(ex)[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/etl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m                    FUNCTIONS[process.get("function", None)]([0m
[30;1m25 | [0m[35m                        **process, secrets=conf.secrets[0m
[30;1m26 | [0m[35m                    )[0m
[30;1m27 | [0m[35m                    if conf.meta_output and process.get("file_output", None):[0m
[30;1m28 | [0m[35m                        file_information(process.get("file_output"), conf.meta_output)[0m
[30;1m29 | [0m[35m            except KeyError as ex:[0m
[30;1m30 | [0m[35m                logger.error("Got key error, skipping...")[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/etl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m                for sub_step in step:[0m
[30;1m22 | [0m[35m                    logger.info("Running %s" % (sub_step))[0m
[30;1m23 | [0m[35m                    process: dict = step[sub_step][0m
[30;1m24 | [0m[35m                    FUNCTIONS[process.get("function", None)]([0m
[30;1m25 | [0m[35m                        **process, secrets=conf.secrets[0m
[30;1m26 | [0m[35m                    )[0m
[30;1m27 | [0m[35m                    if conf.meta_output and process.get("file_output", None):[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m                f"mysql://{username}:{password}@{host}:{port}/{database}"[0m
[30;1m144 | [0m[35m            )[0m
[30;1m145 | [0m[35m        elif "sqlite" in info["type"]:[0m
[30;1m146 | [0m[35m            dbfile = info.get("dbfile", None)[0m
[30;1m147 | [0m[35m            return "sqlite", create_engine(f"sqlite:////{os.path.abspath(dbfile)}")[0m
[30;1m148 | [0m[35m        else:[0m
[30;1m149 | [0m[35m            raise NotImplementedError(f"{info['type']} is not supported yet")[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m137 | [0m[35m                info.get("password", None),[0m
[30;1m138 | [0m[35m                info.get("host", None),[0m
[30;1m139 | [0m[35m                info.get("port", None),[0m
[30;1m140 | [0m[35m                info.get("database", None),[0m
[30;1m141 | [0m[35m            )[0m
[30;1m142 | [0m[35m            return "mysql", create_engine([0m
[30;1m143 | [0m[35m                f"mysql://{username}:{password}@{host}:{port}/{database}"[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m                info.get("username", None),[0m
[30;1m137 | [0m[35m                info.get("password", None),[0m
[30;1m138 | [0m[35m                info.get("host", None),[0m
[30;1m139 | [0m[35m                info.get("port", None),[0m
[30;1m140 | [0m[35m                info.get("database", None),[0m
[30;1m141 | [0m[35m            )[0m
[30;1m142 | [0m[35m            return "mysql", create_engine([0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m            username, password, host, port, database = ([0m
[30;1m136 | [0m[35m                info.get("username", None),[0m
[30;1m137 | [0m[35m                info.get("password", None),[0m
[30;1m138 | [0m[35m                info.get("host", None),[0m
[30;1m139 | [0m[35m                info.get("port", None),[0m
[30;1m140 | [0m[35m                info.get("database", None),[0m
[30;1m141 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35m        elif "mysql" in info["type"]:[0m
[30;1m135 | [0m[35m            username, password, host, port, database = ([0m
[30;1m136 | [0m[35m                info.get("username", None),[0m
[30;1m137 | [0m[35m                info.get("password", None),[0m
[30;1m138 | [0m[35m                info.get("host", None),[0m
[30;1m139 | [0m[35m                info.get("port", None),[0m
[30;1m140 | [0m[35m                info.get("database", None),[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m            )[0m
[30;1m134 | [0m[35m        elif "mysql" in info["type"]:[0m
[30;1m135 | [0m[35m            username, password, host, port, database = ([0m
[30;1m136 | [0m[35m                info.get("username", None),[0m
[30;1m137 | [0m[35m                info.get("password", None),[0m
[30;1m138 | [0m[35m                info.get("host", None),[0m
[30;1m139 | [0m[35m                info.get("port", None),[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m126 | [0m[35m                info.get("username", None),[0m
[30;1m127 | [0m[35m                info.get("password", None),[0m
[30;1m128 | [0m[35m                info.get("port", None),[0m
[30;1m129 | [0m[35m                info.get("dsn", None),[0m
[30;1m130 | [0m[35m            )[0m
[30;1m131 | [0m[35m            return "myssql", create_engine([0m
[30;1m132 | [0m[35m                f"mssql+pyodbc://{username}:{password}@{dsn}"[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m            username, password, port, dsn = ([0m
[30;1m126 | [0m[35m                info.get("username", None),[0m
[30;1m127 | [0m[35m                info.get("password", None),[0m
[30;1m128 | [0m[35m                info.get("port", None),[0m
[30;1m129 | [0m[35m                info.get("dsn", None),[0m
[30;1m130 | [0m[35m            )[0m
[30;1m131 | [0m[35m            return "myssql", create_engine([0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m        elif "mssql" in info["type"]:[0m
[30;1m125 | [0m[35m            username, password, port, dsn = ([0m
[30;1m126 | [0m[35m                info.get("username", None),[0m
[30;1m127 | [0m[35m                info.get("password", None),[0m
[30;1m128 | [0m[35m                info.get("port", None),[0m
[30;1m129 | [0m[35m                info.get("dsn", None),[0m
[30;1m130 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m123 | [0m[35m            )[0m
[30;1m124 | [0m[35m        elif "mssql" in info["type"]:[0m
[30;1m125 | [0m[35m            username, password, port, dsn = ([0m
[30;1m126 | [0m[35m                info.get("username", None),[0m
[30;1m127 | [0m[35m                info.get("password", None),[0m
[30;1m128 | [0m[35m                info.get("port", None),[0m
[30;1m129 | [0m[35m                info.get("dsn", None),[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m                info.get("port", None),[0m
[30;1m116 | [0m[35m                info.get("database", None),[0m
[30;1m117 | [0m[35m                info.get("driver_path", None),[0m
[30;1m118 | [0m[35m                info.get("driver_type", None),[0m
[30;1m119 | [0m[35m            )[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m            return "odbc", create_engine([0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m114 | [0m[35m                info.get("host", None),[0m
[30;1m115 | [0m[35m                info.get("port", None),[0m
[30;1m116 | [0m[35m                info.get("database", None),[0m
[30;1m117 | [0m[35m                info.get("driver_path", None),[0m
[30;1m118 | [0m[35m                info.get("driver_type", None),[0m
[30;1m119 | [0m[35m            )[0m
[30;1m120 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m113 | [0m[35m                info.get("password", None),[0m
[30;1m114 | [0m[35m                info.get("host", None),[0m
[30;1m115 | [0m[35m                info.get("port", None),[0m
[30;1m116 | [0m[35m                info.get("database", None),[0m
[30;1m117 | [0m[35m                info.get("driver_path", None),[0m
[30;1m118 | [0m[35m                info.get("driver_type", None),[0m
[30;1m119 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m                info.get("username", None),[0m
[30;1m113 | [0m[35m                info.get("password", None),[0m
[30;1m114 | [0m[35m                info.get("host", None),[0m
[30;1m115 | [0m[35m                info.get("port", None),[0m
[30;1m116 | [0m[35m                info.get("database", None),[0m
[30;1m117 | [0m[35m                info.get("driver_path", None),[0m
[30;1m118 | [0m[35m                info.get("driver_type", None),[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m            username, password, host, port, database, driver_path, driver_type = ([0m
[30;1m112 | [0m[35m                info.get("username", None),[0m
[30;1m113 | [0m[35m                info.get("password", None),[0m
[30;1m114 | [0m[35m                info.get("host", None),[0m
[30;1m115 | [0m[35m                info.get("port", None),[0m
[30;1m116 | [0m[35m                info.get("database", None),[0m
[30;1m117 | [0m[35m                info.get("driver_path", None),[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m        elif "odbc" in info["type"]:[0m
[30;1m111 | [0m[35m            username, password, host, port, database, driver_path, driver_type = ([0m
[30;1m112 | [0m[35m                info.get("username", None),[0m
[30;1m113 | [0m[35m                info.get("password", None),[0m
[30;1m114 | [0m[35m                info.get("host", None),[0m
[30;1m115 | [0m[35m                info.get("port", None),[0m
[30;1m116 | [0m[35m                info.get("database", None),[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m            return "oracle", connection[0m
[30;1m110 | [0m[35m        elif "odbc" in info["type"]:[0m
[30;1m111 | [0m[35m            username, password, host, port, database, driver_path, driver_type = ([0m
[30;1m112 | [0m[35m                info.get("username", None),[0m
[30;1m113 | [0m[35m                info.get("password", None),[0m
[30;1m114 | [0m[35m                info.get("host", None),[0m
[30;1m115 | [0m[35m                info.get("port", None),[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m                info.get("host", None),[0m
[30;1m103 | [0m[35m                info.get("port", None),[0m
[30;1m104 | [0m[35m                info.get("service_name", None),[0m
[30;1m105 | [0m[35m                info.get("db_alias", None),[0m
[30;1m106 | [0m[35m            )[0m
[30;1m107 | [0m[35m            cx_Oracle.makedsn(host, port, service_name=service_name)[0m
[30;1m108 | [0m[35m            connection = cx_Oracle.connect(username, password, db_alias)[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m                info.get("password", None),[0m
[30;1m102 | [0m[35m                info.get("host", None),[0m
[30;1m103 | [0m[35m                info.get("port", None),[0m
[30;1m104 | [0m[35m                info.get("service_name", None),[0m
[30;1m105 | [0m[35m                info.get("db_alias", None),[0m
[30;1m106 | [0m[35m            )[0m
[30;1m107 | [0m[35m            cx_Oracle.makedsn(host, port, service_name=service_name)[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m                info.get("username", None),[0m
[30;1m101 | [0m[35m                info.get("password", None),[0m
[30;1m102 | [0m[35m                info.get("host", None),[0m
[30;1m103 | [0m[35m                info.get("port", None),[0m
[30;1m104 | [0m[35m                info.get("service_name", None),[0m
[30;1m105 | [0m[35m                info.get("db_alias", None),[0m
[30;1m106 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m            username, password, host, port, service_name, db_alias = ([0m
[30;1m100 | [0m[35m                info.get("username", None),[0m
[30;1m101 | [0m[35m                info.get("password", None),[0m
[30;1m102 | [0m[35m                info.get("host", None),[0m
[30;1m103 | [0m[35m                info.get("port", None),[0m
[30;1m104 | [0m[35m                info.get("service_name", None),[0m
[30;1m105 | [0m[35m                info.get("db_alias", None),[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m            username, password, host, port, service_name, db_alias = ([0m
[30;1m100 | [0m[35m                info.get("username", None),[0m
[30;1m101 | [0m[35m                info.get("password", None),[0m
[30;1m102 | [0m[35m                info.get("host", None),[0m
[30;1m103 | [0m[35m                info.get("port", None),[0m
[30;1m104 | [0m[35m                info.get("service_name", None),[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m            import cx_Oracle[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m            username, password, host, port, service_name, db_alias = ([0m
[30;1m100 | [0m[35m                info.get("username", None),[0m
[30;1m101 | [0m[35m                info.get("password", None),[0m
[30;1m102 | [0m[35m                info.get("host", None),[0m
[30;1m103 | [0m[35m                info.get("port", None),[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m                info.get("password", None),[0m
[30;1m89 | [0m[35m                info.get("host", None),[0m
[30;1m90 | [0m[35m                info.get("port", None),[0m
[30;1m91 | [0m[35m                info.get("database", None),[0m
[30;1m92 | [0m[35m            )[0m
[30;1m93 | [0m[35m            return "postgres", create_engine([0m
[30;1m94 | [0m[35m                f"postgresql://{username}:{password}@{host}:{port}/{database}"[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m                info.get("username", None),[0m
[30;1m88 | [0m[35m                info.get("password", None),[0m
[30;1m89 | [0m[35m                info.get("host", None),[0m
[30;1m90 | [0m[35m                info.get("port", None),[0m
[30;1m91 | [0m[35m                info.get("database", None),[0m
[30;1m92 | [0m[35m            )[0m
[30;1m93 | [0m[35m            return "postgres", create_engine([0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m            username, password, host, port, database = ([0m
[30;1m87 | [0m[35m                info.get("username", None),[0m
[30;1m88 | [0m[35m                info.get("password", None),[0m
[30;1m89 | [0m[35m                info.get("host", None),[0m
[30;1m90 | [0m[35m                info.get("port", None),[0m
[30;1m91 | [0m[35m                info.get("database", None),[0m
[30;1m92 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m        if "postgres" in info["type"]:[0m
[30;1m86 | [0m[35m            username, password, host, port, database = ([0m
[30;1m87 | [0m[35m                info.get("username", None),[0m
[30;1m88 | [0m[35m                info.get("password", None),[0m
[30;1m89 | [0m[35m                info.get("host", None),[0m
[30;1m90 | [0m[35m                info.get("port", None),[0m
[30;1m91 | [0m[35m                info.get("database", None),[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m        info = self.secrets.get(self.target_host)[0m
[30;1m85 | [0m[35m        if "postgres" in info["type"]:[0m
[30;1m86 | [0m[35m            username, password, host, port, database = ([0m
[30;1m87 | [0m[35m                info.get("username", None),[0m
[30;1m88 | [0m[35m                info.get("password", None),[0m
[30;1m89 | [0m[35m                info.get("host", None),[0m
[30;1m90 | [0m[35m                info.get("port", None),[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m        if self.target_host not in self.secrets.keys():[0m
[30;1m82 | [0m[35m            raise KeyError(f"Missing {self.target_host} in secrets")[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m        info = self.secrets.get(self.target_host)[0m
[30;1m85 | [0m[35m        if "postgres" in info["type"]:[0m
[30;1m86 | [0m[35m            username, password, host, port, database = ([0m
[30;1m87 | [0m[35m                info.get("username", None),[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m        """[0m
[30;1m58 | [0m[35m        df = None[0m
[30;1m59 | [0m[35m        if basic:[0m
[30;1m60 | [0m[35m            sql: str = BASICS.get(self.host_type, {}).get(basic, None)[0m
[30;1m61 | [0m[35m            sql = sql.format(table=table)[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        if os.path.exists(os.path.dirname(sql)):[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/utils/database.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m        """[0m
[30;1m58 | [0m[35m        df = None[0m
[30;1m59 | [0m[35m        if basic:[0m
[30;1m60 | [0m[35m            sql: str = BASICS.get(self.host_type, {}).get(basic, None)[0m
[30;1m61 | [0m[35m            sql = sql.format(table=table)[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        if os.path.exists(os.path.dirname(sql)):[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/functions/ccsv.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    for key, value in pipeline.items():[0m
[30;1m70 | [0m[35m        logger.info("%s" % key)[0m
[30;1m71 | [0m[35m        cmd, out = (value.get("cmd"), value.get("output"))[0m
[30;1m72 | [0m[35m        if out:[0m
[30;1m73 | [0m[35m            with open(out, "w") as outfile:[0m
[30;1m74 | [0m[35m                subprocess.run(cmd, stdout=outfile)[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m51[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/etl/functions/ccsv.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    for key, value in pipeline.items():[0m
[30;1m70 | [0m[35m        logger.info("%s" % key)[0m
[30;1m71 | [0m[35m        cmd, out = (value.get("cmd"), value.get("output"))[0m
[30;1m72 | [0m[35m        if out:[0m
[30;1m73 | [0m[35m            with open(out, "w") as outfile:[0m
[30;1m74 | [0m[35m                subprocess.run(cmd, stdout=outfile)[0m

51 matches found.
