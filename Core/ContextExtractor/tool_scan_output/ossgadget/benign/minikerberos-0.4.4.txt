[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/dtypes.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m467 | [0m[35m    def fromCanonical(self, canonical):[0m
[30;1m468 | [0m[35m        items = canonical.split('-')[0m
[30;1m469 | [0m[35m        self['Revision'] = int(items[1])[0m
[30;1m470 | [0m[35m        self['IdentifierAuthority'] = b'\x00\x00\x00\x00\x00' + pack('B',int(items[2]))[0m
[30;1m471 | [0m[35m        self['SubAuthorityCount'] = len(items) - 3[0m
[30;1m472 | [0m[35m        for i in range(self['SubAuthorityCount']):[0m
[30;1m473 | [0m[35m            self['SubAuthority'].append(int(items[i+3]))[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/CVE_2022_33647.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m41 | [0m[35m}[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35mdef format_kirbi(data, n = 100):[0m
[30;1m44 | [0m[35m	kd = base64.b64encode(data).decode()[0m
[30;1m45 | [0m[35m	return '    ' + '\r\n    '.join([kd[i:i+n] for i in range(0, len(kd), n)])[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/CVE_2022_33647.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m18 | [0m[35mimport asyncio[0m
[30;1m19 | [0m[35mimport traceback[0m
[30;1m20 | [0m[35mimport datetime[0m
[30;1m21 | [0m[35mimport base64[0m
[30;1m22 | [0m[35mfrom minikerberos.protocol.asn1_structs import KerberosMessage, \[0m
[30;1m23 | [0m[35m	METHOD_DATA, ETYPE_INFO, ETYPE_INFO2, PA_DATA, KRB_ERROR,\[0m
[30;1m24 | [0m[35m	PrincipalName, EncryptedData, HostAddress, AS_REQ, EncryptionKey,\[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/CVE_2022_33647.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m100 | [0m[35m		sl = b'\x81' + second_len.to_bytes(1, byteorder='big', signed=False)[0m
[30;1m101 | [0m[35m	else:[0m
[30;1m102 | [0m[35m		sl = b'\x82' + second_len.to_bytes(2, byteorder='big', signed=False)[0m
[30;1m103 | [0m[35m	return b'\x79' + fl + b'\x30'+ sl +b'\xA0\x1B\x30\x19\xA0\x03\x02\x01\x80\xA1\x12\x04\x10'[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35mdef get_padding_data():[0m
[30;1m106 | [0m[35m	# for the attack to work, we need a TGT with a larger-than-normal AS-REP enc-data[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/CVE_2022_33647.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m249 | [0m[35m			credential = KerberosCredential()[0m
[30;1m250 | [0m[35m			credential.username = ticketnative['req-body']['cname']['name-string'][0][0m
[30;1m251 | [0m[35m			credential.domain = ticketnative['req-body']['realm'][0m
[30;1m252 | [0m[35m			credential.password = 'A'[0m
[30;1m253 | [0m[35m			client = AIOKerberosClient(credential, target)[0m
[30;1m254 | [0m[35m			client.kerberos_TGT = rticketnative[0m
[30;1m255 | [0m[35m			for i in range(256):[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos.egg-info/entry_points.txt[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m3 | [0m[35mminikerberos-ccache2kirbi = minikerberos.examples.ccache2kirbi:main[0m
[30;1m4 | [0m[35mminikerberos-ccacheedit = minikerberos.examples.ccache_editor:main[0m
[30;1m5 | [0m[35mminikerberos-ccacheroast = minikerberos.examples.ccacheroast:main[0m
[30;1m6 | [0m[35mminikerberos-changepw = minikerberos.examples.changepassword:main[0m
[30;1m7 | [0m[35mminikerberos-cve202233647 = minikerberos.examples.CVE_2022_33647:main[0m
[30;1m8 | [0m[35mminikerberos-cve202233679 = minikerberos.examples.CVE_2022_33679:main[0m
[30;1m9 | [0m[35mminikerberos-getNTPKInit = minikerberos.examples.getNT:main[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/changepassword.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m54 | [0m[35m	else:[0m
[30;1m55 | [0m[35m		logging.basicConfig(level=1)[0m
[30;1m56 | [0m[35m	[0m
[30;1m57 | [0m[35m	await change_password(args.kerberos_connection_url, args.newpassword, args.targetuser, args.etypes)[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35mdef main():[0m
[30;1m60 | [0m[35m	asyncio.run(amain())[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/changepassword.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m54 | [0m[35m	else:[0m
[30;1m55 | [0m[35m		logging.basicConfig(level=1)[0m
[30;1m56 | [0m[35m	[0m
[30;1m57 | [0m[35m	await change_password(args.kerberos_connection_url, args.newpassword, args.targetuser, args.etypes)[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35mdef main():[0m
[30;1m60 | [0m[35m	asyncio.run(amain())[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/changepassword.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m42 | [0m[35mg)[0m
[30;1m43 | [0m[35m	parser.add_argument('kerberos_connection_url', help='the kerberos target string in the following fo[0m
[30;1m44 | [0m[35m	parser.add_argument('newpassword', help='New password')[0m
[30;1m45 | [0m[35m	parser.add_argument('-u', '--targetuser', help='Target user to change password for. If not specifie[0m
[30;1m46 | [0m[35m	parser.add_argument('-e', '--etypes', default='23,17,18', help='Encryption types to use. Default: 2[0m
[30;1m47 | [0m[35m	parser.add_argument('-v', '--verbose', action='count', default=0)[0m
[30;1m48 | [0m[35m	[0m
[30;1m49 | [0m[35m	args = parser.parse_args()[0m
[30;1m50 | [0m[35m	if args.verbose == 0:[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/changepassword.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m42 | [0m[35matter_class=argparse.RawDescriptionHelpFormatter, epilog = kerberos_url_help_epilog)[0m
[30;1m43 | [0m[35m	parser.add_argument('kerberos_connection_url', help='the kerberos target string in the following fo[0m
[30;1m44 | [0m[35m	parser.add_argument('newpassword', help='New password')[0m
[30;1m45 | [0m[35m	parser.add_argument('-u', '--targetuser', help='Target user to change password for. If not specifie[0m
[30;1m46 | [0m[35m	parser.add_argument('-e', '--etypes', default='23,17,18', help='Encryption types to use. Default: 2[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/changepassword.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m42 | [0m[35mon='Kerberoast', formatter_class=argparse.RawDescriptionHelpFormatter, epilog = kerberos_url_help_ep[0m
[30;1m43 | [0m[35m	parser.add_argument('kerberos_connection_url', help='the kerberos target string in the following fo[0m
[30;1m44 | [0m[35m	parser.add_argument('newpassword', help='New password')[0m
[30;1m45 | [0m[35m	parser.add_argument('-u', '--targetuser', help='Target user to change password for. If not specifie[0m
[30;1m46 | [0m[35m	parser.add_argument('-e', '--etypes', default='23,17,18', help='Encryption types to use. Default: 2[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/changepassword.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m28 | [0m[35m			print('Password changed successfully!')[0m
[30;1m29 | [0m[35m			return[0m
[30;1m30 | [0m[35m		[0m
[30;1m31 | [0m[35m		print('Error changing password!')[0m
[30;1m32 | [0m[35m		print(response)[0m
[30;1m33 | [0m[35m		return[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/changepassword.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m25 | [0m[35m		await client.get_TGT(override_etype=etypes)[0m
[30;1m26 | [0m[35m		response = await client.change_password(newpass, targetuser=targetuser)[0m
[30;1m27 | [0m[35m		if response.result_code == 0:[0m
[30;1m28 | [0m[35m			print('Password changed successfully!')[0m
[30;1m29 | [0m[35m			return[0m
[30;1m30 | [0m[35m		[0m
[30;1m31 | [0m[35m		print('Error changing password!')[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/changepassword.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m23 | [0m[35m		cu = KerberosClientFactory.from_url(connection_url)[0m
[30;1m24 | [0m[35m		client = cu.get_client()[0m
[30;1m25 | [0m[35m		await client.get_TGT(override_etype=etypes)[0m
[30;1m26 | [0m[35m		response = await client.change_password(newpass, targetuser=targetuser)[0m
[30;1m27 | [0m[35m		if response.result_code == 0:[0m
[30;1m28 | [0m[35m			print('Password changed successfully!')[0m
[30;1m29 | [0m[35m			return[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/changepassword.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m6 | [0m[35mfrom typing import List[0m
[30;1m7 | [0m[35mimport traceback[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35masync def change_password(connection_url:str, newpass:str = None, targetuser:str=None, etypes:List[i[0m
[30;1m10 | [0m[35m	try:[0m
[30;1m11 | [0m[35m		etypes_final = [][0m
[30;1m12 | [0m[35m		if isinstance(etypes, list) is False:[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/pkinit.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m119 | [0m[35m			pfxpass = pfxpass.encode()[0m
[30;1m120 | [0m[35m		with open(pfxfile, 'rb') as f:[0m
[30;1m121 | [0m[35m			pkinit.privkeyinfo, pkinit.certificate, pkinit.extra_certs = parse_pkcs12(f.read(), password = pf[0m
[30;1m122 | [0m[35m			pkinit.privkey = load_private_key(pkinit.privkeyinfo)[0m
[30;1m123 | [0m[35m		#print('pfx12 loaded!')[0m
[30;1m124 | [0m[35m		pkinit.setup(dh_params = dh_params)[0m
[30;1m125 | [0m[35m		return pkinit[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/pkinit.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m118 | [0m[35m		if isinstance(pfxpass, str):[0m
[30;1m119 | [0m[35m			pfxpass = pfxpass.encode()[0m
[30;1m120 | [0m[35m		with open(pfxfile, 'rb') as f:[0m
[30;1m121 | [0m[35m			pkinit.privkeyinfo, pkinit.certificate, pkinit.extra_certs = parse_pkcs12(f.read(), password = pf[0m
[30;1m122 | [0m[35m			pkinit.privkey = load_private_key(pkinit.privkeyinfo)[0m
[30;1m123 | [0m[35m		#print('pfx12 loaded!')[0m
[30;1m124 | [0m[35m		pkinit.setup(dh_params = dh_params)[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/pkinit.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m77 | [0m[35m		return pow(self.g, self.private_key_int, self.p)[0m
[30;1m78 | [0m[35m	[0m
[30;1m79 | [0m[35m	def exchange(self, bob_int):[0m
[30;1m80 | [0m[35m		self.shared_key_int = pow(bob_int, self.private_key_int, self.p)[0m
[30;1m81 | [0m[35m		x = hex(self.shared_key_int)[2:][0m
[30;1m82 | [0m[35m		if len(x) % 2 != 0:[0m
[30;1m83 | [0m[35m			x = '0' + x[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/pkinit.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m74 | [0m[35m	[0m
[30;1m75 | [0m[35m	def get_public_key(self):[0m
[30;1m76 | [0m[35m		#y = g^x mod p[0m
[30;1m77 | [0m[35m		return pow(self.g, self.private_key_int, self.p)[0m
[30;1m78 | [0m[35m	[0m
[30;1m79 | [0m[35m	def exchange(self, bob_int):[0m
[30;1m80 | [0m[35m		self.shared_key_int = pow(bob_int, self.private_key_int, self.p)[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/pkinit.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m49 | [0m[35m		self.shared_key = None[0m
[30;1m50 | [0m[35m		self.shared_key_int = None[0m
[30;1m51 | [0m[35m		self.private_key = os.urandom(32)[0m
[30;1m52 | [0m[35m		self.private_key_int = int(self.private_key.hex(), 16)[0m
[30;1m53 | [0m[35m		self.dh_nonce = os.urandom(32)[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m	@staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/pkinit.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m49 | [0m[35m		self.shared_key = None[0m
[30;1m50 | [0m[35m		self.shared_key_int = None[0m
[30;1m51 | [0m[35m		self.private_key = os.urandom(32)[0m
[30;1m52 | [0m[35m		self.private_key_int = int(self.private_key.hex(), 16)[0m
[30;1m53 | [0m[35m		self.dh_nonce = os.urandom(32)[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m	@staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/pkinit.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m48 | [0m[35m		self.g = None[0m
[30;1m49 | [0m[35m		self.shared_key = None[0m
[30;1m50 | [0m[35m		self.shared_key_int = None[0m
[30;1m51 | [0m[35m		self.private_key = os.urandom(32)[0m
[30;1m52 | [0m[35m		self.private_key_int = int(self.private_key.hex(), 16)[0m
[30;1m53 | [0m[35m		self.dh_nonce = os.urandom(32)[0m
[30;1m54 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/pkinit.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m20 | [0m[35mfrom asn1crypto import keys[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mfrom oscrypto.keys import parse_pkcs12[0m
[30;1m23 | [0m[35mfrom oscrypto.asymmetric import rsa_pkcs1v15_sign, load_private_key[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mfrom minikerberos.protocol.constants import NAME_TYPE, MESSAGE_TYPE, PaDataType[0m
[30;1m26 | [0m[35mfrom minikerberos.protocol.encryption import Enctype, _checksum_table, _enctype_table, Key[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/dirtydh.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m36 | [0m[35m		return pow(self.g, self.private_key_int, self.p)[0m
[30;1m37 | [0m[35m	[0m
[30;1m38 | [0m[35m	def exchange(self, bob_int):[0m
[30;1m39 | [0m[35m		self.shared_key_int = pow(bob_int, self.private_key_int, self.p)[0m
[30;1m40 | [0m[35m		x = hex(self.shared_key_int)[2:][0m
[30;1m41 | [0m[35m		if len(x) % 2 != 0:[0m
[30;1m42 | [0m[35m			x = '0' + x[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/dirtydh.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m33 | [0m[35m	[0m
[30;1m34 | [0m[35m	def get_public_key(self):[0m
[30;1m35 | [0m[35m		#y = g^x mod p[0m
[30;1m36 | [0m[35m		return pow(self.g, self.private_key_int, self.p)[0m
[30;1m37 | [0m[35m	[0m
[30;1m38 | [0m[35m	def exchange(self, bob_int):[0m
[30;1m39 | [0m[35m		self.shared_key_int = pow(bob_int, self.private_key_int, self.p)[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/dirtydh.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m8 | [0m[35m		self.shared_key = None[0m
[30;1m9 | [0m[35m		self.shared_key_int = None[0m
[30;1m10 | [0m[35m		self.private_key = os.urandom(32)[0m
[30;1m11 | [0m[35m		self.private_key_int = int(self.private_key.hex(), 16)[0m
[30;1m12 | [0m[35m		self.dh_nonce = os.urandom(32)[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m	@staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/dirtydh.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m8 | [0m[35m		self.shared_key = None[0m
[30;1m9 | [0m[35m		self.shared_key_int = None[0m
[30;1m10 | [0m[35m		self.private_key = os.urandom(32)[0m
[30;1m11 | [0m[35m		self.private_key_int = int(self.private_key.hex(), 16)[0m
[30;1m12 | [0m[35m		self.dh_nonce = os.urandom(32)[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m	@staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/dirtydh.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m7 | [0m[35m		self.g = None[0m
[30;1m8 | [0m[35m		self.shared_key = None[0m
[30;1m9 | [0m[35m		self.shared_key_int = None[0m
[30;1m10 | [0m[35m		self.private_key = os.urandom(32)[0m
[30;1m11 | [0m[35m		self.private_key_int = int(self.private_key.hex(), 16)[0m
[30;1m12 | [0m[35m		self.dh_nonce = os.urandom(32)[0m
[30;1m13 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/CVE_2022_33679.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m74 | [0m[35m	return timestamp[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35mdef format_kirbi(data, n = 100):[0m
[30;1m77 | [0m[35m	kd = base64.b64encode(data).decode()[0m
[30;1m78 | [0m[35m	return '    ' + '\r\n    '.join([kd[i:i+n] for i in range(0, len(kd), n)])[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35mdef tgt_to_kirbi(tgt, sessionkey, now):[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/CVE_2022_33679.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m18 | [0m[35mimport datetime[0m
[30;1m19 | [0m[35mimport logging[0m
[30;1m20 | [0m[35mimport asyncio[0m
[30;1m21 | [0m[35mimport base64[0m
[30;1m22 | [0m[35mfrom minikerberos.common.factory import KerberosClientFactory, kerberos_url_help_epilog[0m
[30;1m23 | [0m[35mfrom minikerberos.aioclient import AIOKerberosClient[0m
[30;1m24 | [0m[35mfrom minikerberos.protocol.constants import EncryptionType[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/CVE_2022_33679.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m54 | [0m[35m	data_length = cipher_length - header_length[0m
[30;1m55 | [0m[35m	first_len = data_length - 4[0m
[30;1m56 | [0m[35m	second_len = first_len - 4[0m
[30;1m57 | [0m[35m	return b'\x00'*24 + b'\x79\x82' + first_len.to_bytes(2, byteorder='big', signed=False) + b'\x30\x82[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35mdef get_crafted_timestamp(n, now):[0m
[30;1m60 | [0m[35m	# manually crafting a timestamp field for this exploit to work is an [0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/CVE_2022_33679.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m215 | [0m[35mdef main():[0m
[30;1m216 | [0m[35m	import argparse[0m
[30;1m217 | [0m[35m	[0m
[30;1m218 | [0m[35m	parser = argparse.ArgumentParser(description='Fetches TGT&session key for user who doesnt need kerb[0m
[30;1m219 | [0m[35m	parser.add_argument('kerberos_url', help='the kerberos target string. ')[0m
[30;1m220 | [0m[35m	parser.add_argument('-v', '--verbose', action='count', default=0)[0m
[30;1m221 | [0m[35m	[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/gssapi/gssapi.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m155 | [0m[35m		[0m
[30;1m156 | [0m[35m	[0m
[30;1m157 | [0m[35m	def GSS_Wrap(self, data, seq_num, direction = 'init', encrypt=True, auth_data=None):[0m
[30;1m158 | [0m[35m		GSS_WRAP_HEADER = b'\x60\x2b\x06\x09\x2a\x86\x48\x86\xf7\x12\x01\x02\x02'[0m
[30;1m159 | [0m[35m		[0m
[30;1m160 | [0m[35m		pad = (8 - (len(data) % 8)) & 0x7[0m
[30;1m161 | [0m[35m		padStr = bytes([pad]) * pad[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/gssapi/gssapi.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m117 | [0m[35m		self.session_key = session_key[0m
[30;1m118 | [0m[35m	[0m
[30;1m119 | [0m[35m	def GSS_GetMIC(self, data, sequenceNumber, direction = 'init'):[0m
[30;1m120 | [0m[35m		GSS_GETMIC_HEADER = b'\x60\x23\x06\x09\x2a\x86\x48\x86\xf7\x12\x01\x02\x02'[0m
[30;1m121 | [0m[35m		[0m
[30;1m122 | [0m[35m		# Let's pad the data[0m
[30;1m123 | [0m[35m		pad = (4 - (len(data) % 4)) & 0x3[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/gssapi/gssapi.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m12 | [0m[35m# https://tools.ietf.org/html/rfc2478[0m
[30;1m13 | [0m[35m# https://tools.ietf.org/html/draft-ietf-krb-wg-gssapi-cfx-02[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mGSS_WRAP_HEADER = b'\x60\x2b\x06\x09\x2a\x86\x48\x86\xf7\x12\x01\x02\x02'[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mclass GSSAPIFlags(enum.IntFlag):[0m
[30;1m18 | [0m[35m	GSS_C_DCE_STYLE     = 0x1000[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/pac.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m171 | [0m[35m        ('Version', ULONG),[0m
[30;1m172 | [0m[35m        ('Flags', ULONG),[0m
[30;1m173 | [0m[35m        ('LmPassword', '16s=b""'),[0m
[30;1m174 | [0m[35m        ('NtPassword', '16s=b""'),[0m
[30;1m175 | [0m[35m    )[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m# 2.7 PAC_CLIENT_INFO[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/pac.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m170 | [0m[35m    structure = ([0m
[30;1m171 | [0m[35m        ('Version', ULONG),[0m
[30;1m172 | [0m[35m        ('Flags', ULONG),[0m
[30;1m173 | [0m[35m        ('LmPassword', '16s=b""'),[0m
[30;1m174 | [0m[35m        ('NtPassword', '16s=b""'),[0m
[30;1m175 | [0m[35m    )[0m
[30;1m176 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/pac.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m105 | [0m[35m        ('HomeDirectory', RPC_UNICODE_STRING),[0m
[30;1m106 | [0m[35m        ('HomeDirectoryDrive', RPC_UNICODE_STRING),[0m
[30;1m107 | [0m[35m        ('LogonCount', USHORT),[0m
[30;1m108 | [0m[35m        ('BadPasswordCount', USHORT),[0m
[30;1m109 | [0m[35m        ('UserId', ULONG),[0m
[30;1m110 | [0m[35m        ('PrimaryGroupId', ULONG),[0m
[30;1m111 | [0m[35m        ('GroupCount', ULONG),[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/pac.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m97 | [0m[35m        ('KickOffTime', FILETIME),[0m
[30;1m98 | [0m[35m        ('PasswordLastSet', FILETIME),[0m
[30;1m99 | [0m[35m        ('PasswordCanChange', FILETIME),[0m
[30;1m100 | [0m[35m        ('PasswordMustChange', FILETIME),[0m
[30;1m101 | [0m[35m        ('EffectiveName', RPC_UNICODE_STRING),[0m
[30;1m102 | [0m[35m        ('FullName', RPC_UNICODE_STRING),[0m
[30;1m103 | [0m[35m        ('LogonScript', RPC_UNICODE_STRING),[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/pac.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m96 | [0m[35m        ('LogoffTime', FILETIME),[0m
[30;1m97 | [0m[35m        ('KickOffTime', FILETIME),[0m
[30;1m98 | [0m[35m        ('PasswordLastSet', FILETIME),[0m
[30;1m99 | [0m[35m        ('PasswordCanChange', FILETIME),[0m
[30;1m100 | [0m[35m        ('PasswordMustChange', FILETIME),[0m
[30;1m101 | [0m[35m        ('EffectiveName', RPC_UNICODE_STRING),[0m
[30;1m102 | [0m[35m        ('FullName', RPC_UNICODE_STRING),[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/pac.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m95 | [0m[35m        ('LogonTime', FILETIME),[0m
[30;1m96 | [0m[35m        ('LogoffTime', FILETIME),[0m
[30;1m97 | [0m[35m        ('KickOffTime', FILETIME),[0m
[30;1m98 | [0m[35m        ('PasswordLastSet', FILETIME),[0m
[30;1m99 | [0m[35m        ('PasswordCanChange', FILETIME),[0m
[30;1m100 | [0m[35m        ('PasswordMustChange', FILETIME),[0m
[30;1m101 | [0m[35m        ('EffectiveName', RPC_UNICODE_STRING),[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m## minikerberos-kerb23hashdecrypt[0m
[30;1m52 | [0m[35mThis tool attempts to recover the user's NT hash for a list of kerberoast hashes.  [0m
[30;1m53 | [0m[35mWhen you performed a kerberoast attack against one or multiple users, and have a huge list of NT has[0m
[30;1m54 | [0m[35mFull disclosure, those are not hashes and it hurt me writing the previous sentence.  [0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m## minikerberos-getS4U2self[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/README.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m27 | [0m[35mConsider to use a Python virtual environment.[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m## Information for developers[0m
[30;1m30 | [0m[35m`minikerberos` library contains both asynchronous and blocking versions of the kerberos client with [0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m## Information for pentesters[0m
[30;1m33 | [0m[35m`minikerberos` comes with examples which can be used to perform the usual pentest activities out-of-[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_ccache.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m88 | [0m[35mdef test_stupid_kirbifile():[0m
[30;1m89 | [0m[35m	for kirbifile in get_testfiles_kirbi():[0m
[30;1m90 | [0m[35m		with open(kirbifile, 'rb') as f:[0m
[30;1m91 | [0m[35m			kirbifile = base64.b64encode(f.read())[0m
[30;1m92 | [0m[35m		with tempfile.NamedTemporaryFile() as f:[0m
[30;1m93 | [0m[35m			f.write(kirbifile)[0m
[30;1m94 | [0m[35m			f.flush()[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_ccache.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35m# tests for ccache file[0m
[30;1m2 | [0m[35mimport pathlib[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport tempfile[0m
[30;1m5 | [0m[35mfrom minikerberos.common.kirbi import Kirbi[0m
[30;1m6 | [0m[35mfrom minikerberos.common.ccache import CCACHE, Header, DateTime, Times,\[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/windows/defines.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m57 | [0m[35m                from kernel32 import GetLastError as _gle[0m
[30;1m58 | [0m[35m            self.winerror = _gle()[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    from os import getenv as _real_getenv[0m
[30;1m61 | [0m[35m    def getenv(key, default=None):[0m
[30;1m62 | [0m[35m        value = _real_getenv(key, None)[0m
[30;1m63 | [0m[35m        if value is None:[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/rfc3244.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m103 | [0m[35m		t += 'Password history: %s\r\n' % self.pw_history[0m
[30;1m104 | [0m[35m		t += 'Password maximum age: %s\r\n' % self.pw_max_age[0m
[30;1m105 | [0m[35m		t += 'Password minimum age: %s\r\n' % self.pw_min_age[0m
[30;1m106 | [0m[35m		t += 'Password flags: %s\r\n' % self.pw_flags[0m
[30;1m107 | [0m[35m		return t[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/rfc3244.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m102 | [0m[35m		t += 'Password minimum length: %s\r\n' % self.pw_min_length[0m
[30;1m103 | [0m[35m		t += 'Password history: %s\r\n' % self.pw_history[0m
[30;1m104 | [0m[35m		t += 'Password maximum age: %s\r\n' % self.pw_max_age[0m
[30;1m105 | [0m[35m		t += 'Password minimum age: %s\r\n' % self.pw_min_age[0m
[30;1m106 | [0m[35m		t += 'Password flags: %s\r\n' % self.pw_flags[0m
[30;1m107 | [0m[35m		return t[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/rfc3244.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m101 | [0m[35m		t += 'Result message: %s\r\n' % self.result_message[0m
[30;1m102 | [0m[35m		t += 'Password minimum length: %s\r\n' % self.pw_min_length[0m
[30;1m103 | [0m[35m		t += 'Password history: %s\r\n' % self.pw_history[0m
[30;1m104 | [0m[35m		t += 'Password maximum age: %s\r\n' % self.pw_max_age[0m
[30;1m105 | [0m[35m		t += 'Password minimum age: %s\r\n' % self.pw_min_age[0m
[30;1m106 | [0m[35m		t += 'Password flags: %s\r\n' % self.pw_flags[0m
[30;1m107 | [0m[35m		return t[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/rfc3244.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m100 | [0m[35m		t += 'Result code: %s %s \r\n' % (self.result_code, KRB5CHPWResultCode.get(self.result_code, 'Unkn[0m
[30;1m101 | [0m[35m		t += 'Result message: %s\r\n' % self.result_message[0m
[30;1m102 | [0m[35m		t += 'Password minimum length: %s\r\n' % self.pw_min_length[0m
[30;1m103 | [0m[35m		t += 'Password history: %s\r\n' % self.pw_history[0m
[30;1m104 | [0m[35m		t += 'Password maximum age: %s\r\n' % self.pw_max_age[0m
[30;1m105 | [0m[35m		t += 'Password minimum age: %s\r\n' % self.pw_min_age[0m
[30;1m106 | [0m[35m		t += 'Password flags: %s\r\n' % self.pw_flags[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/rfc3244.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m99 | [0m[35m		t = '=== KRB5CHPWReply ===\r\n'[0m
[30;1m100 | [0m[35m		t += 'Result code: %s %s \r\n' % (self.result_code, KRB5CHPWResultCode.get(self.result_code, 'Unkn[0m
[30;1m101 | [0m[35m		t += 'Result message: %s\r\n' % self.result_message[0m
[30;1m102 | [0m[35m		t += 'Password minimum length: %s\r\n' % self.pw_min_length[0m
[30;1m103 | [0m[35m		t += 'Password history: %s\r\n' % self.pw_history[0m
[30;1m104 | [0m[35m		t += 'Password maximum age: %s\r\n' % self.pw_max_age[0m
[30;1m105 | [0m[35m		t += 'Password minimum age: %s\r\n' % self.pw_min_age[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/rfc3244.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m92 | [0m[35m		res.pw_history = int.from_bytes(data[8:12], byteorder='big', signed=False)[0m
[30;1m93 | [0m[35m		res.pw_max_age = int.from_bytes(data[16:24], byteorder='big', signed=False) // ticks[0m
[30;1m94 | [0m[35m		res.pw_min_age = int.from_bytes(data[24:32], byteorder='big', signed=False) // ticks[0m
[30;1m95 | [0m[35m		res.pw_flags = KRB5PasswordPolicyFlags(int.from_bytes(data[12:16], byteorder='big', signed=False))[0m
[30;1m96 | [0m[35m		return res[0m
[30;1m97 | [0m[35m	[0m
[30;1m98 | [0m[35m	def __str__(self):[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/rfc3244.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m50 | [0m[35m		ap_len = int.from_bytes(buff.read(2), byteorder='big', signed=False)[0m
[30;1m51 | [0m[35m		ap = buff.read(ap_len)[0m
[30;1m52 | [0m[35m		priv = buff.read(message_length - ap_len - 6)[0m
[30;1m53 | [0m[35m		return KRB5ChangePassword(ap, priv)[0m
[30;1m54 | [0m[35m	[0m
[30;1m55 | [0m[35m	def decrypt_priv(self, subkey_cipher, subkey):[0m
[30;1m56 | [0m[35m		privrep = KRB_PRIV.load(self.priv).native[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/rfc3244.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m41 | [0m[35m	[0m
[30;1m42 | [0m[35m	@staticmethod[0m
[30;1m43 | [0m[35m	def from_bytes(data):[0m
[30;1m44 | [0m[35m		return KRB5ChangePassword.from_buffer(io.BytesIO(data))[0m
[30;1m45 | [0m[35m	[0m
[30;1m46 | [0m[35m	@staticmethod[0m
[30;1m47 | [0m[35m	def from_buffer(buff:io.BytesIO):[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/rfc3244.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m24 | [0m[35m	0xffff : 'Unknown error'[0m
[30;1m25 | [0m[35m}[0m
[30;1m26 | [0m[35m	[0m
[30;1m27 | [0m[35mclass KRB5ChangePassword:[0m
[30;1m28 | [0m[35m	def __init__(self, ap:bytes, priv:bytes, err:bytes = None):[0m
[30;1m29 | [0m[35m		self.ap = ap[0m
[30;1m30 | [0m[35m		self.priv = priv[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/rfc3244.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m10 | [0m[35m	NoClearChange = 0x4[0m
[30;1m11 | [0m[35m	LockoutAdmins = 0x8[0m
[30;1m12 | [0m[35m	StoreCleartext = 0x10[0m
[30;1m13 | [0m[35m	RefusePasswordChange = 0x20[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mKRB5CHPWResultCode = {[0m
[30;1m16 | [0m[35m	0 : 'Ok',[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/rfc3244.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom minikerberos.protocol.asn1_structs import EncKrbPrivPart, KRB_PRIV[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mclass KRB5PasswordPolicyFlags(enum.IntFlag):[0m
[30;1m8 | [0m[35m	Complex = 0x1[0m
[30;1m9 | [0m[35m	NoAnonChange = 0x2[0m
[30;1m10 | [0m[35m	NoClearChange = 0x4[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1 | [0m[35mimport enum[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mclass KerberosSecretType(enum.Enum):[0m
[30;1m4 | [0m[35m	PASSWORD = 'PASSWORD'[0m
[30;1m5 | [0m[35m	PW = 'PW'[0m
[30;1m6 | [0m[35m	PWPROMPT = 'PWPROMPT'[0m
[30;1m7 | [0m[35m	PASS = 'PASS'[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/constants.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1 | [0m[35mimport enum[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mclass KerberosSecretType(enum.Enum):[0m
[30;1m4 | [0m[35m	PASSWORD = 'PASSWORD'[0m
[30;1m5 | [0m[35m	PW = 'PW'[0m
[30;1m6 | [0m[35m	PWPROMPT = 'PWPROMPT'[0m
[30;1m7 | [0m[35m	PASS = 'PASS'[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/asn1_structs.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m327 | [0m[35m		3 : 'ISSUE_USE_TGT', #3),	-- time of newest TGT used[0m
[30;1m328 | [0m[35m		4 : 'RENEWAL', #4),		-- time of last renewal[0m
[30;1m329 | [0m[35m		5 : 'REQUEST', #5),		-- time of last request ', #of any type)[0m
[30;1m330 | [0m[35m		6 : 'PW_EXPTIME', #6),	-- expiration time of password[0m
[30;1m331 | [0m[35m		7 : 'ACCT_EXPTIME', #7)	-- expiration time of account[0m
[30;1m332 | [0m[35m	}[0m
[30;1m333 | [0m[35m	[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/structures.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m76 | [0m[35m		token = self.oid.dump()[0m
[30;1m77 | [0m[35m		token += KRB5TokenTokID.KRB_AP_REQ.get_bytes()[0m
[30;1m78 | [0m[35m		token += self.inner_token[0m
[30;1m79 | [0m[35m		return str(base64.b64encode(GSSAPIToken(contents=token).dump()), encoding)[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/structures.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport io[0m
[30;1m2 | [0m[35mimport enum[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom minikerberos.protocol.asn1_structs import GSSAPIOID, GSSAPIToken[0m
[30;1m6 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/kirbi.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m108 | [0m[35m            t += 'RenewTill    : %s\r\n' % cred.get('renew-till')[0m
[30;1m109 | [0m[35m            t += 'Flags        : %s\r\n' % flags[0m
[30;1m110 | [0m[35m            t += 'Keytype      : %s\r\n' % cred['key']['keytype'][0m
[30;1m111 | [0m[35m            t += 'Key          : %s\r\n' % base64.b64encode(cred['key']['keyvalue']).decode()[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m        t += 'EncodedKirbi : \r\n\r\n'[0m
[30;1m114 | [0m[35m        t += self.format()[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/kirbi.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m79 | [0m[35m    [0m
[30;1m80 | [0m[35m    @staticmethod[0m
[30;1m81 | [0m[35m    def format_kirbi(data, n = 100):[0m
[30;1m82 | [0m[35m        kd = base64.b64encode(data).decode()[0m
[30;1m83 | [0m[35m        return '    ' + '\r\n    '.join([kd[i:i+n] for i in range(0, len(kd), n)])[0m
[30;1m84 | [0m[35m    [0m
[30;1m85 | [0m[35m    def format(self, n = 100):[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/kirbi.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m39 | [0m[35m        return Kirbi.from_bytes(base64.b64decode(b64))[0m
[30;1m40 | [0m[35m    [0m
[30;1m41 | [0m[35m    def to_b64(self):[0m
[30;1m42 | [0m[35m        return base64.b64encode(self.kirbiobj.dump()).decode()[0m
[30;1m43 | [0m[35m    [0m
[30;1m44 | [0m[35m    @staticmethod[0m
[30;1m45 | [0m[35m    def from_hex(hexdata):[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/kirbi.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m36 | [0m[35m    [0m
[30;1m37 | [0m[35m    @staticmethod[0m
[30;1m38 | [0m[35m    def from_b64(b64):[0m
[30;1m39 | [0m[35m        return Kirbi.from_bytes(base64.b64decode(b64))[0m
[30;1m40 | [0m[35m    [0m
[30;1m41 | [0m[35m    def to_b64(self):[0m
[30;1m42 | [0m[35m        return base64.b64encode(self.kirbiobj.dump()).decode()[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/kirbi.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mfrom minikerberos.protocol.asn1_structs import KRBCRED, EncKrbCredPart, KrbCredInfo, EncryptedData[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mclass Kirbi:[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/setup.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m68 | [0m[35m			'minikerberos-kerb23hashdecrypt = minikerberos.examples.kerb23hashdecrypt:main',[0m
[30;1m69 | [0m[35m			'minikerberos-kerberoast   = minikerberos.examples.spnroast:main',[0m
[30;1m70 | [0m[35m            'minikerberos-asreproast   = minikerberos.examples.asreproast:main',[0m
[30;1m71 | [0m[35m            'minikerberos-changepw   = minikerberos.examples.changepassword:main',[0m
[30;1m72 | [0m[35m		],[0m
[30;1m73 | [0m[35m	}[0m
[30;1m74 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/utils.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35m[0m
[30;1m2 | [0m[35mimport datetime[0m
[30;1m3 | [0m[35mfrom minikerberos.protocol.asn1_structs import KRB_CRED, KrbCredInfo, EncKrbCredPart, EncryptedData,[0m
[30;1m4 | [0m[35mimport base64[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mdef print_table(lines, separate_head=True):[0m
[30;1m7 | [0m[35m	"""Prints a formatted table given a 2 dimensional array"""[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m377 | [0m[35m			password = password.encode()[0m
[30;1m378 | [0m[35m		[0m
[30;1m379 | [0m[35m		if isinstance(data, str):[0m
[30;1m380 | [0m[35m			data = base64.b64decode(data.replace(' ', '').replace('\r','').replace('\n','').encode())[0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35m		# private_key is not actually the private key object but the privkey data because oscrypto privkey[0m
[30;1m383 | [0m[35m		# cant be serialized so we cant make copy of it.[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m327 | [0m[35m		if isinstance(certdata, str):[0m
[30;1m328 | [0m[35m			certdata = base64.b64decode(certdata.replace(' ','').replace('\r','').replace('\n','').replace('\[0m
[30;1m329 | [0m[35m		if isinstance(keydata, str):[0m
[30;1m330 | [0m[35m			keydata = base64.b64decode(keydata.replace(' ','').replace('\r','').replace('\n','').replace('\t'[0m
[30;1m331 | [0m[35m		k = KerberosCredential()[0m
[30;1m332 | [0m[35m		k.certificate = parse_certificate(certdata)[0m
[30;1m333 | [0m[35m		k.private_key = parse_private(keydata)[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m325 | [0m[35m		from oscrypto.keys import parse_certificate, parse_private[0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35m		if isinstance(certdata, str):[0m
[30;1m328 | [0m[35m			certdata = base64.b64decode(certdata.replace(' ','').replace('\r','').replace('\n','').replace('\[0m
[30;1m329 | [0m[35m		if isinstance(keydata, str):[0m
[30;1m330 | [0m[35m			keydata = base64.b64decode(keydata.replace(' ','').replace('\r','').replace('\n','').replace('\t'[0m
[30;1m331 | [0m[35m		k = KerberosCredential()[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m265 | [0m[35m		cred.domain = realm[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35m		if isinstance(keytabdata, str):[0m
[30;1m268 | [0m[35m			keytabdata = base64.b64decode(keytabdata.replace(' ','').replace('\r','').replace('\n','').replac[0m
[30;1m269 | [0m[35m		[0m
[30;1m270 | [0m[35m		keytab = Keytab.from_bytes(keytabdata)[0m
[30;1m271 | [0m[35m		if len(keytab.entries) == 0:[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m33 | [0m[35m	elif encoding == 'b64' or encoding == 'base64':[0m
[30;1m34 | [0m[35m		if isinstance(data, str):[0m
[30;1m35 | [0m[35m			data = data.encode()[0m
[30;1m36 | [0m[35m		return base64.b64decode(data)[0m
[30;1m37 | [0m[35m	elif encoding == 'raw':[0m
[30;1m38 | [0m[35m		if isinstance(data, str):[0m
[30;1m39 | [0m[35m			data = data.encode()[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m30 | [0m[35m			return kf.read()[0m
[30;1m31 | [0m[35m	elif encoding == 'hex':[0m
[30;1m32 | [0m[35m		return bytes.fromhex(data)[0m
[30;1m33 | [0m[35m	elif encoding == 'b64' or encoding == 'base64':[0m
[30;1m34 | [0m[35m		if isinstance(data, str):[0m
[30;1m35 | [0m[35m			data = data.encode()[0m
[30;1m36 | [0m[35m		return base64.b64decode(data)[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mfrom __future__ import annotations[0m
[30;1m2 | [0m[35mimport getpass[0m
[30;1m3 | [0m[35mimport collections[0m
[30;1m4 | [0m[35mimport base64[0m
[30;1m5 | [0m[35mimport platform[0m
[30;1m6 | [0m[35mimport copy[0m
[30;1m7 | [0m[35mfrom typing import List[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m479 | [0m[35m			if secret == '' or secret is None:[0m
[30;1m480 | [0m[35m				self.password = getpass.getpass('Enter Kerberos credential password:')[0m
[30;1m481 | [0m[35m			else:[0m
[30;1m482 | [0m[35m				self.password = secret[0m
[30;1m483 | [0m[35m		elif st == KerberosSecretType.NT or st == KerberosSecretType.RC4:[0m
[30;1m484 | [0m[35m			self.nt_hash = secret[0m
[30;1m485 | [0m[35m			self.kerberos_key_rc4 = secret[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m477 | [0m[35m	def add_secret(self, st: KerberosSecretType, secret: str):[0m
[30;1m478 | [0m[35m		if st == KerberosSecretType.PASSWORD or st == KerberosSecretType.PW or st == KerberosSecretType.PA[0m
[30;1m479 | [0m[35m			if secret == '' or secret is None:[0m
[30;1m480 | [0m[35m				self.password = getpass.getpass('Enter Kerberos credential password:')[0m
[30;1m481 | [0m[35m			else:[0m
[30;1m482 | [0m[35m				self.password = secret[0m
[30;1m483 | [0m[35m		elif st == KerberosSecretType.NT or st == KerberosSecretType.RC4:[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m477 | [0m[35m	def add_secret(self, st: KerberosSecretType, secret: str):[0m
[30;1m478 | [0m[35m		if st == KerberosSecretType.PASSWORD or st == KerberosSecretType.PW or st == KerberosSecretType.PA[0m
[30;1m479 | [0m[35m			if secret == '' or secret is None:[0m
[30;1m480 | [0m[35m				self.password = getpass.getpass('Enter Kerberos credential password:')[0m
[30;1m481 | [0m[35m			else:[0m
[30;1m482 | [0m[35m				self.password = secret[0m
[30;1m483 | [0m[35m		elif st == KerberosSecretType.NT or st == KerberosSecretType.RC4:[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m475 | [0m[35m		return cms.SignedData(sd).dump()[0m
[30;1m476 | [0m[35m[0m
[30;1m477 | [0m[35m	def add_secret(self, st: KerberosSecretType, secret: str):[0m
[30;1m478 | [0m[35m		if st == KerberosSecretType.PASSWORD or st == KerberosSecretType.PW or st == KerberosSecretType.PA[0m
[30;1m479 | [0m[35m			if secret == '' or secret is None:[0m
[30;1m480 | [0m[35m				self.password = getpass.getpass('Enter Kerberos credential password:')[0m
[30;1m481 | [0m[35m			else:[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m453 | [0m[35m			cms.CMSAttribute({'type': 'message_digest', 'values': [hashlib.sha1(data).digest()]}), ### hash o[0m
[30;1m454 | [0m[35m		][0m
[30;1m455 | [0m[35m		si['signature_algorithm'] = algos.SignedDigestAlgorithm({'algorithm' : '1.2.840.113549.1.1.1'})[0m
[30;1m456 | [0m[35m		si['signature'] = rsa_pkcs1v15_sign(load_private_key(self.private_key),  cms.CMSAttributes(si['sig[0m
[30;1m457 | [0m[35m[0m
[30;1m458 | [0m[35m		ec = {}[0m
[30;1m459 | [0m[35m		ec['content_type'] = '1.3.6.1.5.2.3.1'[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m453 | [0m[35m			cms.CMSAttribute({'type': 'message_digest', 'values': [hashlib.sha1(data).digest()]}), ### hash o[0m
[30;1m454 | [0m[35m		][0m
[30;1m455 | [0m[35m		si['signature_algorithm'] = algos.SignedDigestAlgorithm({'algorithm' : '1.2.840.113549.1.1.1'})[0m
[30;1m456 | [0m[35m		si['signature'] = rsa_pkcs1v15_sign(load_private_key(self.private_key),  cms.CMSAttributes(si['sig[0m
[30;1m457 | [0m[35m[0m
[30;1m458 | [0m[35m		ec = {}[0m
[30;1m459 | [0m[35m		ec['content_type'] = '1.3.6.1.5.2.3.1'[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m433 | [0m[35m		2. the certificate used to sign the data blob[0m
[30;1m434 | [0m[35m		3. the singed 'signed_attrs' structure (ASN1) which points to the "data" structure (in point 1)[0m
[30;1m435 | [0m[35m		"""[0m
[30;1m436 | [0m[35m		from oscrypto.asymmetric import rsa_pkcs1v15_sign, load_private_key[0m
[30;1m437 | [0m[35m[0m
[30;1m438 | [0m[35m		[0m
[30;1m439 | [0m[35m		da = {}[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m395 | [0m[35m		"""[0m
[30;1m396 | [0m[35m		with open(filepath, 'rb') as f:[0m
[30;1m397 | [0m[35m			data = f.read()[0m
[30;1m398 | [0m[35m		return KerberosCredential.from_pfx_string(data, password, dhparams = dhparams, username = username[0m
[30;1m399 | [0m[35m	[0m
[30;1m400 | [0m[35m	def set_dhparams(self, dhparams):[0m
[30;1m401 | [0m[35m		# windows default params, don't look at me...[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m389 | [0m[35m		return k[0m
[30;1m390 | [0m[35m[0m
[30;1m391 | [0m[35m	@staticmethod[0m
[30;1m392 | [0m[35m	def from_pfx_file(filepath:str, password:str, dhparams:DirtyDH = None, username:str = None, domain:[0m
[30;1m393 | [0m[35m		"""[0m
[30;1m394 | [0m[35m		Username and domain will override the values found in the certificate[0m
[30;1m395 | [0m[35m		"""[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m382 | [0m[35m		# private_key is not actually the private key object but the privkey data because oscrypto privkey[0m
[30;1m383 | [0m[35m		# cant be serialized so we cant make copy of it.[0m
[30;1m384 | [0m[35m		k.private_key, k.certificate, extra_certs = parse_pkcs12(data, password = password)[0m
[30;1m385 | [0m[35m		#k.private_key = load_private_key(privkeyinfo)[0m
[30;1m386 | [0m[35m		[0m
[30;1m387 | [0m[35m		k.set_user_and_domain_from_cert(username = username, domain = domain)[0m
[30;1m388 | [0m[35m		k.set_dhparams(dhparams)[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m382 | [0m[35m		# private_key is not actually the private key object but the privkey data because oscrypto privkey[0m
[30;1m383 | [0m[35m		# cant be serialized so we cant make copy of it.[0m
[30;1m384 | [0m[35m		k.private_key, k.certificate, extra_certs = parse_pkcs12(data, password = password)[0m
[30;1m385 | [0m[35m		#k.private_key = load_private_key(privkeyinfo)[0m
[30;1m386 | [0m[35m		[0m
[30;1m387 | [0m[35m		k.set_user_and_domain_from_cert(username = username, domain = domain)[0m
[30;1m388 | [0m[35m		k.set_dhparams(dhparams)[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35m		# private_key is not actually the private key object but the privkey data because oscrypto privkey[0m
[30;1m383 | [0m[35m		# cant be serialized so we cant make copy of it.[0m
[30;1m384 | [0m[35m		k.private_key, k.certificate, extra_certs = parse_pkcs12(data, password = password)[0m
[30;1m385 | [0m[35m		#k.private_key = load_private_key(privkeyinfo)[0m
[30;1m386 | [0m[35m		[0m
[30;1m387 | [0m[35m		k.set_user_and_domain_from_cert(username = username, domain = domain)[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35m		# private_key is not actually the private key object but the privkey data because oscrypto privkey[0m
[30;1m383 | [0m[35m		# cant be serialized so we cant make copy of it.[0m
[30;1m384 | [0m[35m		k.private_key, k.certificate, extra_certs = parse_pkcs12(data, password = password)[0m
[30;1m385 | [0m[35m		#k.private_key = load_private_key(privkeyinfo)[0m
[30;1m386 | [0m[35m		[0m
[30;1m387 | [0m[35m		k.set_user_and_domain_from_cert(username = username, domain = domain)[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35m		# private_key is not actually the private key object but the privkey data because oscrypto privkey[0m
[30;1m383 | [0m[35m		# cant be serialized so we cant make copy of it.[0m
[30;1m384 | [0m[35m		k.private_key, k.certificate, extra_certs = parse_pkcs12(data, password = password)[0m
[30;1m385 | [0m[35m		#k.private_key = load_private_key(privkeyinfo)[0m
[30;1m386 | [0m[35m		[0m
[30;1m387 | [0m[35m		k.set_user_and_domain_from_cert(username = username, domain = domain)[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m379 | [0m[35m		if isinstance(data, str):[0m
[30;1m380 | [0m[35m			data = base64.b64decode(data.replace(' ', '').replace('\r','').replace('\n','').encode())[0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35m		# private_key is not actually the private key object but the privkey data because oscrypto privkey[0m
[30;1m383 | [0m[35m		# cant be serialized so we cant make copy of it.[0m
[30;1m384 | [0m[35m		k.private_key, k.certificate, extra_certs = parse_pkcs12(data, password = password)[0m
[30;1m385 | [0m[35m		#k.private_key = load_private_key(privkeyinfo)[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m374 | [0m[35m		if password is None:[0m
[30;1m375 | [0m[35m			password = b''[0m
[30;1m376 | [0m[35m		if isinstance(password, str):[0m
[30;1m377 | [0m[35m			password = password.encode()[0m
[30;1m378 | [0m[35m		[0m
[30;1m379 | [0m[35m		if isinstance(data, str):[0m
[30;1m380 | [0m[35m			data = base64.b64decode(data.replace(' ', '').replace('\r','').replace('\n','').encode())[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m374 | [0m[35m		if password is None:[0m
[30;1m375 | [0m[35m			password = b''[0m
[30;1m376 | [0m[35m		if isinstance(password, str):[0m
[30;1m377 | [0m[35m			password = password.encode()[0m
[30;1m378 | [0m[35m		[0m
[30;1m379 | [0m[35m		if isinstance(data, str):[0m
[30;1m380 | [0m[35m			data = base64.b64decode(data.replace(' ', '').replace('\r','').replace('\n','').encode())[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m373 | [0m[35m		k = KerberosCredential()[0m
[30;1m374 | [0m[35m		if password is None:[0m
[30;1m375 | [0m[35m			password = b''[0m
[30;1m376 | [0m[35m		if isinstance(password, str):[0m
[30;1m377 | [0m[35m			password = password.encode()[0m
[30;1m378 | [0m[35m		[0m
[30;1m379 | [0m[35m		if isinstance(data, str):[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m		k = KerberosCredential()[0m
[30;1m374 | [0m[35m		if password is None:[0m
[30;1m375 | [0m[35m			password = b''[0m
[30;1m376 | [0m[35m		if isinstance(password, str):[0m
[30;1m377 | [0m[35m			password = password.encode()[0m
[30;1m378 | [0m[35m		[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m371 | [0m[35m		from oscrypto.keys import parse_pkcs12[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m		k = KerberosCredential()[0m
[30;1m374 | [0m[35m		if password is None:[0m
[30;1m375 | [0m[35m			password = b''[0m
[30;1m376 | [0m[35m		if isinstance(password, str):[0m
[30;1m377 | [0m[35m			password = password.encode()[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m366 | [0m[35m		return k[0m
[30;1m367 | [0m[35m[0m
[30;1m368 | [0m[35m	@staticmethod[0m
[30;1m369 | [0m[35m	def from_pfx_string(data: str or bytes, password:str, dhparams:DirtyDH = None, username:str = None,[0m
[30;1m370 | [0m[35m[0m
[30;1m371 | [0m[35m		from oscrypto.keys import parse_pkcs12[0m
[30;1m372 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m330 | [0m[35m			keydata = base64.b64decode(keydata.replace(' ','').replace('\r','').replace('\n','').replace('\t'[0m
[30;1m331 | [0m[35m		k = KerberosCredential()[0m
[30;1m332 | [0m[35m		k.certificate = parse_certificate(certdata)[0m
[30;1m333 | [0m[35m		k.private_key = parse_private(keydata)[0m
[30;1m334 | [0m[35m		k.set_user_and_domain_from_cert(username = username, domain = domain)[0m
[30;1m335 | [0m[35m		k.set_dhparams(dhparams)[0m
[30;1m336 | [0m[35m		return k[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m247 | [0m[35m		Username and domain will override the values found in the certificate[0m
[30;1m248 | [0m[35m		"""[0m
[30;1m249 | [0m[35m		data = get_encoded_data(data, encoding=encoding)[0m
[30;1m250 | [0m[35m		return KerberosCredential.from_pfx_string(data, password, dhparams = dhparams, username = username[0m
[30;1m251 | [0m[35m	[0m
[30;1m252 | [0m[35m	@staticmethod[0m
[30;1m253 | [0m[35m	def from_krbcred(keytab_file_path: str, principal: str = None, realm: str = None) -> KerberosCreden[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m241 | [0m[35m		return cred[0m
[30;1m242 | [0m[35m	[0m
[30;1m243 | [0m[35m	@staticmethod[0m
[30;1m244 | [0m[35m	def from_pfx(data:str, password:str, dhparams:DirtyDH = None, username:str = None, domain:str = Non[0m
[30;1m245 | [0m[35m		"""[0m
[30;1m246 | [0m[35m		Retruns a credential object from data found in the PFX file[0m
[30;1m247 | [0m[35m		Username and domain will override the values found in the certificate[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m184 | [0m[35m				supp_enctypes[EncryptionType.AES256_CTS_HMAC_SHA1_96] = 1[0m
[30;1m185 | [0m[35m				supp_enctypes[EncryptionType.AES128_CTS_HMAC_SHA1_96] = 1[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m			if self.password or self.nt_hash or self.kerberos_key_rc4:[0m
[30;1m188 | [0m[35m				supp_enctypes[EncryptionType.ARCFOUR_HMAC_MD5] = 1[0m
[30;1m189 | [0m[35m				supp_enctypes[EncryptionType.ARCFOUR_MD4] = 1[0m
[30;1m190 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m174 | [0m[35m			if self.kerberos_key_aes_128:[0m
[30;1m175 | [0m[35m				supp_enctypes[EncryptionType.AES128_CTS_HMAC_SHA1_96] = 1[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m			if self.password:[0m
[30;1m178 | [0m[35m				supp_enctypes[EncryptionType.DES_CBC_CRC] = 1[0m
[30;1m179 | [0m[35m				supp_enctypes[EncryptionType.DES_CBC_MD4] = 1[0m
[30;1m180 | [0m[35m				supp_enctypes[EncryptionType.DES_CBC_MD5] = 1[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m138 | [0m[35m			elif self.password:[0m
[30;1m139 | [0m[35m				pw = self.password[0m
[30;1m140 | [0m[35m				if isinstance(self.password, str):[0m
[30;1m141 | [0m[35m					pw = self.password.encode('utf-16-le')[0m
[30;1m142 | [0m[35m				self.nt_hash = hashlib.md4(pw).hexdigest().upper()[0m
[30;1m143 | [0m[35m				return bytes.fromhex(self.nt_hash)[:8][0m
[30;1m144 | [0m[35m			else:[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m137 | [0m[35m				return bytes.fromhex(self.nt_hash)[:8][0m
[30;1m138 | [0m[35m			elif self.password:[0m
[30;1m139 | [0m[35m				pw = self.password[0m
[30;1m140 | [0m[35m				if isinstance(self.password, str):[0m
[30;1m141 | [0m[35m					pw = self.password.encode('utf-16-le')[0m
[30;1m142 | [0m[35m				self.nt_hash = hashlib.md4(pw).hexdigest().upper()[0m
[30;1m143 | [0m[35m				return bytes.fromhex(self.nt_hash)[:8][0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m136 | [0m[35m			if self.nt_hash:[0m
[30;1m137 | [0m[35m				return bytes.fromhex(self.nt_hash)[:8][0m
[30;1m138 | [0m[35m			elif self.password:[0m
[30;1m139 | [0m[35m				pw = self.password[0m
[30;1m140 | [0m[35m				if isinstance(self.password, str):[0m
[30;1m141 | [0m[35m					pw = self.password.encode('utf-16-le')[0m
[30;1m142 | [0m[35m				self.nt_hash = hashlib.md4(pw).hexdigest().upper()[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m135 | [0m[35m				return bytes.fromhex(self.kerberos_key_rc4)[:8][0m
[30;1m136 | [0m[35m			if self.nt_hash:[0m
[30;1m137 | [0m[35m				return bytes.fromhex(self.nt_hash)[:8][0m
[30;1m138 | [0m[35m			elif self.password:[0m
[30;1m139 | [0m[35m				pw = self.password[0m
[30;1m140 | [0m[35m				if isinstance(self.password, str):[0m
[30;1m141 | [0m[35m					pw = self.password.encode('utf-16-le')[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m126 | [0m[35m			elif self.password:[0m
[30;1m127 | [0m[35m				if not salt:[0m
[30;1m128 | [0m[35m					salt = (self.domain.upper() + self.username).encode()[0m
[30;1m129 | [0m[35m				return string_to_key(Enctype.DES_MD5, self.password, salt).contents[0m
[30;1m130 | [0m[35m			else:[0m
[30;1m131 | [0m[35m				raise Exception('There is no key for DES encryption')[0m
[30;1m132 | [0m[35m		[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m123 | [0m[35m		elif etype == EncryptionType.DES_CBC_MD5: #etype == EncryptionType.DES_CBC_CRC or etype == Encrypt[0m
[30;1m124 | [0m[35m			if self.kerberos_key_des:[0m
[30;1m125 | [0m[35m				return bytes.fromhex(self.kerberos_key_des)[0m
[30;1m126 | [0m[35m			elif self.password:[0m
[30;1m127 | [0m[35m				if not salt:[0m
[30;1m128 | [0m[35m					salt = (self.domain.upper() + self.username).encode()[0m
[30;1m129 | [0m[35m				return string_to_key(Enctype.DES_MD5, self.password, salt).contents[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m116 | [0m[35m			elif self.password:[0m
[30;1m117 | [0m[35m				if not salt:[0m
[30;1m118 | [0m[35m					salt = (self.domain.upper() + self.username).encode()[0m
[30;1m119 | [0m[35m				return string_to_key(Enctype.DES3, self.password, salt).contents[0m
[30;1m120 | [0m[35m			else:[0m
[30;1m121 | [0m[35m				raise Exception('There is no key for DES3 encryption')[0m
[30;1m122 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m113 | [0m[35m		elif etype == EncryptionType.DES3_CBC_SHA1:[0m
[30;1m114 | [0m[35m			if self.kerberos_key_des3:[0m
[30;1m115 | [0m[35m				return bytes.fromhex(self.kerberos_key_des3)[0m
[30;1m116 | [0m[35m			elif self.password:[0m
[30;1m117 | [0m[35m				if not salt:[0m
[30;1m118 | [0m[35m					salt = (self.domain.upper() + self.username).encode()[0m
[30;1m119 | [0m[35m				return string_to_key(Enctype.DES3, self.password, salt).contents[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m105 | [0m[35m				return bytes.fromhex(self.nt_hash)[0m
[30;1m106 | [0m[35m			elif self.password:[0m
[30;1m107 | [0m[35m				if isinstance(self.password, str):[0m
[30;1m108 | [0m[35m					pw = self.password.encode('utf-16-le')[0m
[30;1m109 | [0m[35m				self.nt_hash = hashlib.md4(pw).hexdigest().upper()[0m
[30;1m110 | [0m[35m				return bytes.fromhex(self.nt_hash)[0m
[30;1m111 | [0m[35m			else:[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m104 | [0m[35m			if self.nt_hash:[0m
[30;1m105 | [0m[35m				return bytes.fromhex(self.nt_hash)[0m
[30;1m106 | [0m[35m			elif self.password:[0m
[30;1m107 | [0m[35m				if isinstance(self.password, str):[0m
[30;1m108 | [0m[35m					pw = self.password.encode('utf-16-le')[0m
[30;1m109 | [0m[35m				self.nt_hash = hashlib.md4(pw).hexdigest().upper()[0m
[30;1m110 | [0m[35m				return bytes.fromhex(self.nt_hash)[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m103 | [0m[35m				return bytes.fromhex(self.kerberos_key_rc4)[0m
[30;1m104 | [0m[35m			if self.nt_hash:[0m
[30;1m105 | [0m[35m				return bytes.fromhex(self.nt_hash)[0m
[30;1m106 | [0m[35m			elif self.password:[0m
[30;1m107 | [0m[35m				if isinstance(self.password, str):[0m
[30;1m108 | [0m[35m					pw = self.password.encode('utf-16-le')[0m
[30;1m109 | [0m[35m				self.nt_hash = hashlib.md4(pw).hexdigest().upper()[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m96 | [0m[35m			if self.password is not None:[0m
[30;1m97 | [0m[35m				if not salt:[0m
[30;1m98 | [0m[35m					salt = (self.domain.upper() + self.username).encode()[0m
[30;1m99 | [0m[35m				return string_to_key(Enctype.AES128, self.password, salt).contents[0m
[30;1m100 | [0m[35m			raise Exception('There is no key for AES128 encryption')[0m
[30;1m101 | [0m[35m		elif etype == EncryptionType.ARCFOUR_HMAC_MD5:[0m
[30;1m102 | [0m[35m			if self.kerberos_key_rc4:[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m93 | [0m[35m		elif etype == EncryptionType.AES128_CTS_HMAC_SHA1_96:[0m
[30;1m94 | [0m[35m			if self.kerberos_key_aes_128:[0m
[30;1m95 | [0m[35m				return bytes.fromhex(self.kerberos_key_aes_128)[0m
[30;1m96 | [0m[35m			if self.password is not None:[0m
[30;1m97 | [0m[35m				if not salt:[0m
[30;1m98 | [0m[35m					salt = (self.domain.upper() + self.username).encode()[0m
[30;1m99 | [0m[35m				return string_to_key(Enctype.AES128, self.password, salt).contents[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m88 | [0m[35m			if self.password is not None:[0m
[30;1m89 | [0m[35m				if not salt:[0m
[30;1m90 | [0m[35m					salt = (self.domain.upper() + self.username).encode()[0m
[30;1m91 | [0m[35m				return string_to_key(Enctype.AES256, self.password, salt).contents[0m
[30;1m92 | [0m[35m			raise Exception('There is no key for AES256 encryption')[0m
[30;1m93 | [0m[35m		elif etype == EncryptionType.AES128_CTS_HMAC_SHA1_96:[0m
[30;1m94 | [0m[35m			if self.kerberos_key_aes_128:[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m85 | [0m[35m		if etype == EncryptionType.AES256_CTS_HMAC_SHA1_96:[0m
[30;1m86 | [0m[35m			if self.kerberos_key_aes_256:[0m
[30;1m87 | [0m[35m				return bytes.fromhex(self.kerberos_key_aes_256)[0m
[30;1m88 | [0m[35m			if self.password is not None:[0m
[30;1m89 | [0m[35m				if not salt:[0m
[30;1m90 | [0m[35m					salt = (self.domain.upper() + self.username).encode()[0m
[30;1m91 | [0m[35m				return string_to_key(Enctype.AES256, self.password, salt).contents[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m53 | [0m[35m		self.kerberos_key_rc4:str = None[0m
[30;1m54 | [0m[35m		self.kerberos_key_des3:str = None[0m
[30;1m55 | [0m[35m		self.certificate = None[0m
[30;1m56 | [0m[35m		self.private_key = None[0m
[30;1m57 | [0m[35m		self.__hcert = None #handle on the windows certificate store[0m
[30;1m58 | [0m[35m		self.__use_windows_certstore:bool = False[0m
[30;1m59 | [0m[35m		self.commonname:str = None[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m44 | [0m[35m	def __init__(self):[0m
[30;1m45 | [0m[35m		self.username:str = None[0m
[30;1m46 | [0m[35m		self.domain:str = None[0m
[30;1m47 | [0m[35m		self.password:str = None[0m
[30;1m48 | [0m[35m		self.nt_hash:str = None[0m
[30;1m49 | [0m[35m		self.lm_hash:str = None[0m
[30;1m50 | [0m[35m		self.kerberos_key_aes_256:str = None[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m21 | [0m[35mfrom minikerberos.protocol.dirtydh import DirtyDH[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m# HIDDEN IMPORTS!!!! TODO: fix this[0m
[30;1m24 | [0m[35m#from oscrypto.asymmetric import rsa_pkcs1v15_sign, load_private_key[0m
[30;1m25 | [0m[35m#from oscrypto.keys import parse_pkcs12, parse_certificate, parse_private[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35mdef get_encoded_data(data:bytes or str, encoding = 'file') -> bytes:[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m214 | [0m[35m	def from_ccache(data, principal: str = None, realm: str = None, encoding = 'file') -> KerberosCrede[0m
[30;1m215 | [0m[35m		"""Returns a kerberos credential object with CCACHE database"""[0m
[30;1m216 | [0m[35m		if data is None:[0m
[30;1m217 | [0m[35m			ccache_path = os.environ.get('KRB5CCNAME')[0m
[30;1m218 | [0m[35m			if ccache_path is None:[0m
[30;1m219 | [0m[35m				raise Exception('No CCACHE data or path provided!')[0m
[30;1m220 | [0m[35m			data = ccache_path[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_conn.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m308 | [0m[35m	try:[0m
[30;1m309 | [0m[35m		from aiosmb.commons.connection.factory import SMBConnectionFactory[0m
[30;1m310 | [0m[35m		from aiosmb.commons.interfaces.machine import SMBMachine[0m
[30;1m311 | [0m[35m		url = 'smb2+kerberos-password://TEST\\Administrator:Passw0rd!1@win2019ad.test.corp/?dc=10.10.10.2'[0m
[30;1m312 | [0m[35m		factory = SMBConnectionFactory.from_url(url)[0m
[30;1m313 | [0m[35m		connection = factory.get_connection()[0m
[30;1m314 | [0m[35m		async with connection:[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_conn.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m296 | [0m[35m@pytest.mark.asyncio[0m
[30;1m297 | [0m[35masync def test_smb_kerberos_login():[0m
[30;1m298 | [0m[35m	from aiosmb.commons.connection.factory import SMBConnectionFactory[0m
[30;1m299 | [0m[35m	url = 'smb2+kerberos-password://TEST\\victim:Passw0rd!1@win2019ad.test.corp/?dc=10.10.10.2'[0m
[30;1m300 | [0m[35m	factory = SMBConnectionFactory.from_url(url)[0m
[30;1m301 | [0m[35m	connection = factory.get_connection()[0m
[30;1m302 | [0m[35m	async with connection:[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_conn.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m@pytest.mark.asyncio[0m
[30;1m41 | [0m[35masync def test_tgt_pw_incorrect_pw():[0m
[30;1m42 | [0m[35m	cu = KerberosClientFactory.from_url('kerberos+password://%s\\%s:blablaThisiswrong12@10.10.10.2' % ([0m
[30;1m43 | [0m[35m	client = cu.get_client()[0m
[30;1m44 | [0m[35m	with pytest.raises(Exception) as e_info:[0m
[30;1m45 | [0m[35m		await client.get_TGT()[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_conn.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m@pytest.mark.asyncio[0m
[30;1m33 | [0m[35masync def test_tgt_pw_incorrect_user():[0m
[30;1m34 | [0m[35m	cu = KerberosClientFactory.from_url('kerberos+password://%s\\NOTVALIDUSER:%s@10.10.10.2' % (KERBERO[0m
[30;1m35 | [0m[35m	client = cu.get_client()[0m
[30;1m36 | [0m[35m	with pytest.raises(Exception) as e_info:[0m
[30;1m37 | [0m[35m		await client.get_TGT()[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_conn.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m@pytest.mark.asyncio[0m
[30;1m33 | [0m[35masync def test_tgt_pw_incorrect_user():[0m
[30;1m34 | [0m[35m	cu = KerberosClientFactory.from_url('kerberos+password://%s\\NOTVALIDUSER:%s@10.10.10.2' % (KERBERO[0m
[30;1m35 | [0m[35m	client = cu.get_client()[0m
[30;1m36 | [0m[35m	with pytest.raises(Exception) as e_info:[0m
[30;1m37 | [0m[35m		await client.get_TGT()[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_conn.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m@pytest.mark.asyncio[0m
[30;1m26 | [0m[35masync def test_tgt_pw_incorrect_realm():[0m
[30;1m27 | [0m[35m	cu = KerberosClientFactory.from_url('kerberos+password://NONEXISTENT\\%s:%s@10.10.10.2' % (KERBEROS[0m
[30;1m28 | [0m[35m	client = cu.get_client()[0m
[30;1m29 | [0m[35m	with pytest.raises(Exception) as e_info:[0m
[30;1m30 | [0m[35m		await client.get_TGT()[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_conn.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m@pytest.mark.asyncio[0m
[30;1m26 | [0m[35masync def test_tgt_pw_incorrect_realm():[0m
[30;1m27 | [0m[35m	cu = KerberosClientFactory.from_url('kerberos+password://NONEXISTENT\\%s:%s@10.10.10.2' % (KERBEROS[0m
[30;1m28 | [0m[35m	client = cu.get_client()[0m
[30;1m29 | [0m[35m	with pytest.raises(Exception) as e_info:[0m
[30;1m30 | [0m[35m		await client.get_TGT()[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/errors.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m114 | [0m[35m	KDC_ERR_TGT_REVOKED =  'TGT has been revoked'[0m
[30;1m115 | [0m[35m	KDC_ERR_CLIENT_NOTYET =  'Client not yet valid—try again later'[0m
[30;1m116 | [0m[35m	KDC_ERR_SERVICE_NOTYET = 'Server not yet valid—try again later'[0m
[30;1m117 | [0m[35m	KDC_ERR_KEY_EXPIRED =  'Password has expired—change password to reset'[0m
[30;1m118 | [0m[35m	KDC_ERR_PREAUTH_FAILED = 'Pre-authentication information was invalid'[0m
[30;1m119 | [0m[35m	KDC_ERR_PREAUTH_REQUIRED =  'Additional preauthentication required'[0m
[30;1m120 | [0m[35m	KDC_ERR_SERVER_NOMATCH = 'KDC does not know about the requested server'[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/errors.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m114 | [0m[35m	KDC_ERR_TGT_REVOKED =  'TGT has been revoked'[0m
[30;1m115 | [0m[35m	KDC_ERR_CLIENT_NOTYET =  'Client not yet valid—try again later'[0m
[30;1m116 | [0m[35m	KDC_ERR_SERVICE_NOTYET = 'Server not yet valid—try again later'[0m
[30;1m117 | [0m[35m	KDC_ERR_KEY_EXPIRED =  'Password has expired—change password to reset'[0m
[30;1m118 | [0m[35m	KDC_ERR_PREAUTH_FAILED = 'Pre-authentication information was invalid'[0m
[30;1m119 | [0m[35m	KDC_ERR_PREAUTH_REQUIRED =  'Additional preauthentication required'[0m
[30;1m120 | [0m[35m	KDC_ERR_SERVER_NOMATCH = 'KDC does not know about the requested server'[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/errors.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m42 | [0m[35m	KDC_ERR_TGT_REVOKED = 0x14 #TGT has been revoked[0m
[30;1m43 | [0m[35m	KDC_ERR_CLIENT_NOTYET = 0x15 # Client not yet valid—try again later[0m
[30;1m44 | [0m[35m	KDC_ERR_SERVICE_NOTYET = 0x16 #Server not yet valid—try again later[0m
[30;1m45 | [0m[35m	KDC_ERR_KEY_EXPIRED = 0x17 # Password has expired—change password to reset[0m
[30;1m46 | [0m[35m	KDC_ERR_PREAUTH_FAILED = 0x18 #Pre-authentication information was invalid[0m
[30;1m47 | [0m[35m	KDC_ERR_PREAUTH_REQUIRED = 0x19 # Additional preauthentication required[0m
[30;1m48 | [0m[35m	KDC_ERR_SERVER_NOMATCH = 0x1A #KDC does not know about the requested server[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/errors.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m42 | [0m[35m	KDC_ERR_TGT_REVOKED = 0x14 #TGT has been revoked[0m
[30;1m43 | [0m[35m	KDC_ERR_CLIENT_NOTYET = 0x15 # Client not yet valid—try again later[0m
[30;1m44 | [0m[35m	KDC_ERR_SERVICE_NOTYET = 0x16 #Server not yet valid—try again later[0m
[30;1m45 | [0m[35m	KDC_ERR_KEY_EXPIRED = 0x17 # Password has expired—change password to reset[0m
[30;1m46 | [0m[35m	KDC_ERR_PREAUTH_FAILED = 0x18 #Pre-authentication information was invalid[0m
[30;1m47 | [0m[35m	KDC_ERR_PREAUTH_REQUIRED = 0x19 # Additional preauthentication required[0m
[30;1m48 | [0m[35m	KDC_ERR_SERVER_NOMATCH = 0x1A #KDC does not know about the requested server[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_url.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m26 | [0m[35m	cred = url.get_creds()[0m
[30;1m27 | [0m[35m	assert cred.domain == 'domain'[0m
[30;1m28 | [0m[35m	assert cred.username == 'user'[0m
[30;1m29 | [0m[35m	assert cred.password == 'pass@word34tnk;adfs'[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m	target = url.get_target()[0m
[30;1m32 | [0m[35m	assert target.ip == '127.0.0.1'[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_url.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mdef test_url_pw_1():[0m
[30;1m24 | [0m[35m	urlstr = 'kerberos+password://domain\\user:pass@word34tnk;adfs@127.0.0.1'[0m
[30;1m25 | [0m[35m	url = KerberosClientFactory.from_url(urlstr)[0m
[30;1m26 | [0m[35m	cred = url.get_creds()[0m
[30;1m27 | [0m[35m	assert cred.domain == 'domain'[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/encryption.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m178 | [0m[35m						b'\x01\x1F\x01\x1F\x01\x0E\x01\x0E',[0m
[30;1m179 | [0m[35m						b'\x1F\x01\x1F\x01\x0E\x01\x0E\x01',[0m
[30;1m180 | [0m[35m						b'\xE0\xFE\xE0\xFE\xF1\xFE\xF1\xFE',[0m
[30;1m181 | [0m[35m						b'\xFE\xE0\xFE\xE0\xFE\xF1\xFE\xF1')[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35mclass _EnctypeProfile(object):[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/encryption.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m177 | [0m[35m						b'\xFE\x1F\xFE\x1F\xFE\x0E\xFE\x0E',[0m
[30;1m178 | [0m[35m						b'\x01\x1F\x01\x1F\x01\x0E\x01\x0E',[0m
[30;1m179 | [0m[35m						b'\x1F\x01\x1F\x01\x0E\x01\x0E\x01',[0m
[30;1m180 | [0m[35m						b'\xE0\xFE\xE0\xFE\xF1\xFE\xF1\xFE',[0m
[30;1m181 | [0m[35m						b'\xFE\xE0\xFE\xE0\xFE\xF1\xFE\xF1')[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/encryption.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m176 | [0m[35m						b'\x1F\xFE\x1F\xFE\x0E\xFE\x0E\xFE',[0m
[30;1m177 | [0m[35m						b'\xFE\x1F\xFE\x1F\xFE\x0E\xFE\x0E',[0m
[30;1m178 | [0m[35m						b'\x01\x1F\x01\x1F\x01\x0E\x01\x0E',[0m
[30;1m179 | [0m[35m						b'\x1F\x01\x1F\x01\x0E\x01\x0E\x01',[0m
[30;1m180 | [0m[35m						b'\xE0\xFE\xE0\xFE\xF1\xFE\xF1\xFE',[0m
[30;1m181 | [0m[35m						b'\xFE\xE0\xFE\xE0\xFE\xF1\xFE\xF1')[0m
[30;1m182 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/encryption.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m175 | [0m[35m						b'\xE0\x01\xE0\x01\xF1\x01\xF1\x01',[0m
[30;1m176 | [0m[35m						b'\x1F\xFE\x1F\xFE\x0E\xFE\x0E\xFE',[0m
[30;1m177 | [0m[35m						b'\xFE\x1F\xFE\x1F\xFE\x0E\xFE\x0E',[0m
[30;1m178 | [0m[35m						b'\x01\x1F\x01\x1F\x01\x0E\x01\x0E',[0m
[30;1m179 | [0m[35m						b'\x1F\x01\x1F\x01\x0E\x01\x0E\x01',[0m
[30;1m180 | [0m[35m						b'\xE0\xFE\xE0\xFE\xF1\xFE\xF1\xFE',[0m
[30;1m181 | [0m[35m						b'\xFE\xE0\xFE\xE0\xFE\xF1\xFE\xF1')[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/encryption.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m174 | [0m[35m						b'\x01\xE0\x01\xE0\x01\xF1\x01\xF1',[0m
[30;1m175 | [0m[35m						b'\xE0\x01\xE0\x01\xF1\x01\xF1\x01',[0m
[30;1m176 | [0m[35m						b'\x1F\xFE\x1F\xFE\x0E\xFE\x0E\xFE',[0m
[30;1m177 | [0m[35m						b'\xFE\x1F\xFE\x1F\xFE\x0E\xFE\x0E',[0m
[30;1m178 | [0m[35m						b'\x01\x1F\x01\x1F\x01\x0E\x01\x0E',[0m
[30;1m179 | [0m[35m						b'\x1F\x01\x1F\x01\x0E\x01\x0E\x01',[0m
[30;1m180 | [0m[35m						b'\xE0\xFE\xE0\xFE\xF1\xFE\xF1\xFE',[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/encryption.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m173 | [0m[35m						b'\xE0\x1F\xE0\x1F\xF1\x0E\xF1\x0E',[0m
[30;1m174 | [0m[35m						b'\x01\xE0\x01\xE0\x01\xF1\x01\xF1',[0m
[30;1m175 | [0m[35m						b'\xE0\x01\xE0\x01\xF1\x01\xF1\x01',[0m
[30;1m176 | [0m[35m						b'\x1F\xFE\x1F\xFE\x0E\xFE\x0E\xFE',[0m
[30;1m177 | [0m[35m						b'\xFE\x1F\xFE\x1F\xFE\x0E\xFE\x0E',[0m
[30;1m178 | [0m[35m						b'\x01\x1F\x01\x1F\x01\x0E\x01\x0E',[0m
[30;1m179 | [0m[35m						b'\x1F\x01\x1F\x01\x0E\x01\x0E\x01',[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/encryption.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m172 | [0m[35m						b'\x1F\xE0\x1F\xE0\x0E\xF1\x0E\xF1',[0m
[30;1m173 | [0m[35m						b'\xE0\x1F\xE0\x1F\xF1\x0E\xF1\x0E',[0m
[30;1m174 | [0m[35m						b'\x01\xE0\x01\xE0\x01\xF1\x01\xF1',[0m
[30;1m175 | [0m[35m						b'\xE0\x01\xE0\x01\xF1\x01\xF1\x01',[0m
[30;1m176 | [0m[35m						b'\x1F\xFE\x1F\xFE\x0E\xFE\x0E\xFE',[0m
[30;1m177 | [0m[35m						b'\xFE\x1F\xFE\x1F\xFE\x0E\xFE\x0E',[0m
[30;1m178 | [0m[35m						b'\x01\x1F\x01\x1F\x01\x0E\x01\x0E',[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/encryption.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m171 | [0m[35m						b'\xFE\x01\xFE\x01\xFE\x01\xFE\x01',[0m
[30;1m172 | [0m[35m						b'\x1F\xE0\x1F\xE0\x0E\xF1\x0E\xF1',[0m
[30;1m173 | [0m[35m						b'\xE0\x1F\xE0\x1F\xF1\x0E\xF1\x0E',[0m
[30;1m174 | [0m[35m						b'\x01\xE0\x01\xE0\x01\xF1\x01\xF1',[0m
[30;1m175 | [0m[35m						b'\xE0\x01\xE0\x01\xF1\x01\xF1\x01',[0m
[30;1m176 | [0m[35m						b'\x1F\xFE\x1F\xFE\x0E\xFE\x0E\xFE',[0m
[30;1m177 | [0m[35m						b'\xFE\x1F\xFE\x1F\xFE\x0E\xFE\x0E',[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/encryption.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m170 | [0m[35m						b'\x01\xFE\x01\xFE\x01\xFE\x01\xFE',[0m
[30;1m171 | [0m[35m						b'\xFE\x01\xFE\x01\xFE\x01\xFE\x01',[0m
[30;1m172 | [0m[35m						b'\x1F\xE0\x1F\xE0\x0E\xF1\x0E\xF1',[0m
[30;1m173 | [0m[35m						b'\xE0\x1F\xE0\x1F\xF1\x0E\xF1\x0E',[0m
[30;1m174 | [0m[35m						b'\x01\xE0\x01\xE0\x01\xF1\x01\xF1',[0m
[30;1m175 | [0m[35m						b'\xE0\x01\xE0\x01\xF1\x01\xF1\x01',[0m
[30;1m176 | [0m[35m						b'\x1F\xFE\x1F\xFE\x0E\xFE\x0E\xFE',[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/encryption.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m169 | [0m[35m						b'\xE0\xE0\xE0\xE0\xF1\xF1\xF1\xF1',[0m
[30;1m170 | [0m[35m						b'\x01\xFE\x01\xFE\x01\xFE\x01\xFE',[0m
[30;1m171 | [0m[35m						b'\xFE\x01\xFE\x01\xFE\x01\xFE\x01',[0m
[30;1m172 | [0m[35m						b'\x1F\xE0\x1F\xE0\x0E\xF1\x0E\xF1',[0m
[30;1m173 | [0m[35m						b'\xE0\x1F\xE0\x1F\xF1\x0E\xF1\x0E',[0m
[30;1m174 | [0m[35m						b'\x01\xE0\x01\xE0\x01\xF1\x01\xF1',[0m
[30;1m175 | [0m[35m						b'\xE0\x01\xE0\x01\xF1\x01\xF1\x01',[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/encryption.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m168 | [0m[35m						b'\x1F\x1F\x1F\x1F\x0E\x0E\x0E\x0E',[0m
[30;1m169 | [0m[35m						b'\xE0\xE0\xE0\xE0\xF1\xF1\xF1\xF1',[0m
[30;1m170 | [0m[35m						b'\x01\xFE\x01\xFE\x01\xFE\x01\xFE',[0m
[30;1m171 | [0m[35m						b'\xFE\x01\xFE\x01\xFE\x01\xFE\x01',[0m
[30;1m172 | [0m[35m						b'\x1F\xE0\x1F\xE0\x0E\xF1\x0E\xF1',[0m
[30;1m173 | [0m[35m						b'\xE0\x1F\xE0\x1F\xF1\x0E\xF1\x0E',[0m
[30;1m174 | [0m[35m						b'\x01\xE0\x01\xE0\x01\xF1\x01\xF1',[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/encryption.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m167 | [0m[35m						b'\xFE\xFE\xFE\xFE\xFE\xFE\xFE\xFE',[0m
[30;1m168 | [0m[35m						b'\x1F\x1F\x1F\x1F\x0E\x0E\x0E\x0E',[0m
[30;1m169 | [0m[35m						b'\xE0\xE0\xE0\xE0\xF1\xF1\xF1\xF1',[0m
[30;1m170 | [0m[35m						b'\x01\xFE\x01\xFE\x01\xFE\x01\xFE',[0m
[30;1m171 | [0m[35m						b'\xFE\x01\xFE\x01\xFE\x01\xFE\x01',[0m
[30;1m172 | [0m[35m						b'\x1F\xE0\x1F\xE0\x0E\xF1\x0E\xF1',[0m
[30;1m173 | [0m[35m						b'\xE0\x1F\xE0\x1F\xF1\x0E\xF1\x0E',[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/encryption.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m166 | [0m[35m	return keybytes in (b'\x01\x01\x01\x01\x01\x01\x01\x01',[0m
[30;1m167 | [0m[35m						b'\xFE\xFE\xFE\xFE\xFE\xFE\xFE\xFE',[0m
[30;1m168 | [0m[35m						b'\x1F\x1F\x1F\x1F\x0E\x0E\x0E\x0E',[0m
[30;1m169 | [0m[35m						b'\xE0\xE0\xE0\xE0\xF1\xF1\xF1\xF1',[0m
[30;1m170 | [0m[35m						b'\x01\xFE\x01\xFE\x01\xFE\x01\xFE',[0m
[30;1m171 | [0m[35m						b'\xFE\x01\xFE\x01\xFE\x01\xFE\x01',[0m
[30;1m172 | [0m[35m						b'\x1F\xE0\x1F\xE0\x0E\xF1\x0E\xF1',[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/encryption.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m165 | [0m[35mdef _is_weak_des_key(keybytes):[0m
[30;1m166 | [0m[35m	return keybytes in (b'\x01\x01\x01\x01\x01\x01\x01\x01',[0m
[30;1m167 | [0m[35m						b'\xFE\xFE\xFE\xFE\xFE\xFE\xFE\xFE',[0m
[30;1m168 | [0m[35m						b'\x1F\x1F\x1F\x1F\x0E\x0E\x0E\x0E',[0m
[30;1m169 | [0m[35m						b'\xE0\xE0\xE0\xE0\xF1\xF1\xF1\xF1',[0m
[30;1m170 | [0m[35m						b'\x01\xFE\x01\xFE\x01\xFE\x01\xFE',[0m
[30;1m171 | [0m[35m						b'\xFE\x01\xFE\x01\xFE\x01\xFE\x01',[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/encryption.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35mdef _is_weak_des_key(keybytes):[0m
[30;1m166 | [0m[35m	return keybytes in (b'\x01\x01\x01\x01\x01\x01\x01\x01',[0m
[30;1m167 | [0m[35m						b'\xFE\xFE\xFE\xFE\xFE\xFE\xFE\xFE',[0m
[30;1m168 | [0m[35m						b'\x1F\x1F\x1F\x1F\x0E\x0E\x0E\x0E',[0m
[30;1m169 | [0m[35m						b'\xE0\xE0\xE0\xE0\xF1\xF1\xF1\xF1',[0m
[30;1m170 | [0m[35m						b'\x01\xFE\x01\xFE\x01\xFE\x01\xFE',[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/encryption.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35mdef _is_weak_des_key(keybytes):[0m
[30;1m166 | [0m[35m	return keybytes in (b'\x01\x01\x01\x01\x01\x01\x01\x01',[0m
[30;1m167 | [0m[35m						b'\xFE\xFE\xFE\xFE\xFE\xFE\xFE\xFE',[0m
[30;1m168 | [0m[35m						b'\x1F\x1F\x1F\x1F\x0E\x0E\x0E\x0E',[0m
[30;1m169 | [0m[35m						b'\xE0\xE0\xE0\xE0\xF1\xF1\xF1\xF1',[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_encryption.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35mdef test_des_string_to_key():[0m
[30;1m167 | [0m[35m	# DES string-to-key[0m
[30;1m168 | [0m[35m	string = 'password'.encode()[0m
[30;1m169 | [0m[35m	salt = 'ATHENA.MIT.EDUraeburn'.encode()[0m
[30;1m170 | [0m[35m	kb = h('cbc22fae235298e3')[0m
[30;1m171 | [0m[35m	k = string_to_key(Enctype.DES_MD5, string, salt)[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_encryption.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35mdef test_des3_string_to_key():[0m
[30;1m106 | [0m[35m	# DES3 string-to-key[0m
[30;1m107 | [0m[35m	string = 'password'.encode()[0m
[30;1m108 | [0m[35m	salt = 'ATHENA.MIT.EDUraeburn'.encode()[0m
[30;1m109 | [0m[35m	kb = h('850BB51358548CD05E86768C313E3BFEF7511937DCF72C3E')[0m
[30;1m110 | [0m[35m	k = string_to_key(Enctype.DES3, string, salt)[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_encryption.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35mdef test_aes128_string_to_key():[0m
[30;1m48 | [0m[35m	# AES128 string-to-key[0m
[30;1m49 | [0m[35m	string = 'password'.encode()[0m
[30;1m50 | [0m[35m	salt = 'ATHENA.MIT.EDUraeburn'.encode()[0m
[30;1m51 | [0m[35m	params = h('00000002')[0m
[30;1m52 | [0m[35m	kb = h('C651BF29E2300AC27FA469D693BDDA13')[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/factory.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m244 | [0m[35m		[0m
[30;1m245 | [0m[35m		if res.secret is None and res.secret_type != KerberosSecretType.NONE:[0m
[30;1m246 | [0m[35m			if res.secret_type not in [KerberosSecretType.PEM, KerberosSecretType.CERTSTORE]:[0m
[30;1m247 | [0m[35m				raise Exception('Missing secret/password!')[0m
[30;1m248 | [0m[35m		[0m
[30;1m249 | [0m[35m		return res[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/factory.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m234 | [0m[35m				raise Exception('Missing username!')[0m
[30;1m235 | [0m[35m		[0m
[30;1m236 | [0m[35m		if res.secret_type == KerberosSecretType.PWPROMPT:[0m
[30;1m237 | [0m[35m			res.secret_type = KerberosSecretType.PASSWORD[0m
[30;1m238 | [0m[35m			res.secret = getpass.getpass()[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m		if res.secret_type is None:[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/factory.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m204 | [0m[35m				raise Exception('Missing username!')[0m
[30;1m205 | [0m[35m		[0m
[30;1m206 | [0m[35m		if res.secret is None:[0m
[30;1m207 | [0m[35m			res.secret = url.password[0m
[30;1m208 | [0m[35m		if url.port is not None:[0m
[30;1m209 | [0m[35m			res.port = int(url.port)[0m
[30;1m210 | [0m[35m		[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/factory.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m119 | [0m[35m		res.domain = self.domain[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m		if self.secret_type in [KerberosSecretType.PASSWORD, KerberosSecretType.PW, KerberosSecretType.PAS[0m
[30;1m122 | [0m[35m			res.password = self.secret[0m
[30;1m123 | [0m[35m		elif self.secret_type in [KerberosSecretType.NT, KerberosSecretType.RC4]:[0m
[30;1m124 | [0m[35m			if len(self.secret) != 32:[0m
[30;1m125 | [0m[35m				raise Exception('Incorrect RC4/NT key! %s' % self.secret)[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/factory.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m118 | [0m[35m		res.username = self.username[0m
[30;1m119 | [0m[35m		res.domain = self.domain[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m		if self.secret_type in [KerberosSecretType.PASSWORD, KerberosSecretType.PW, KerberosSecretType.PAS[0m
[30;1m122 | [0m[35m			res.password = self.secret[0m
[30;1m123 | [0m[35m		elif self.secret_type in [KerberosSecretType.NT, KerberosSecretType.RC4]:[0m
[30;1m124 | [0m[35m			if len(self.secret) != 32:[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/factory.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m29 | [0m[35m   - Plaintext:[0m
[30;1m30 | [0m[35m      kerberos+password://domain\\user:SecretPassword@127.0.0.1[0m
[30;1m31 | [0m[35m      kerberos+pw://domain\\user:SecretPassword@127.0.0.1[0m
[30;1m32 | [0m[35m      kerberos+pass://domain\\user:SecretPassword@127.0.0.1[0m
[30;1m33 | [0m[35m   - NT hash:[0m
[30;1m34 | [0m[35m      kerberos+nt://domain\\user:921a7fece11f4d8c72432e41e40d0372@127.0.0.1[0m
[30;1m35 | [0m[35m   - SSPI:[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/factory.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m28 | [0m[35m      kerberos+password://domain\\user:SecretPassword@127.0.0.1/proxytype=socks5&proxyhost=127.0.0.1[0m
[30;1m29 | [0m[35m   - Plaintext:[0m
[30;1m30 | [0m[35m      kerberos+password://domain\\user:SecretPassword@127.0.0.1[0m
[30;1m31 | [0m[35m      kerberos+pw://domain\\user:SecretPassword@127.0.0.1[0m
[30;1m32 | [0m[35m      kerberos+pass://domain\\user:SecretPassword@127.0.0.1[0m
[30;1m33 | [0m[35m   - NT hash:[0m
[30;1m34 | [0m[35m      kerberos+nt://domain\\user:921a7fece11f4d8c72432e41e40d0372@127.0.0.1[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/factory.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m27 | [0m[35m   - Plaintext + SOCKS5 proxy:[0m
[30;1m28 | [0m[35m      kerberos+password://domain\\user:SecretPassword@127.0.0.1/proxytype=socks5&proxyhost=127.0.0.1[0m
[30;1m29 | [0m[35m   - Plaintext:[0m
[30;1m30 | [0m[35m      kerberos+password://domain\\user:SecretPassword@127.0.0.1[0m
[30;1m31 | [0m[35m      kerberos+pw://domain\\user:SecretPassword@127.0.0.1[0m
[30;1m32 | [0m[35m      kerberos+pass://domain\\user:SecretPassword@127.0.0.1[0m
[30;1m33 | [0m[35m   - NT hash:[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/factory.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m27 | [0m[35m   - Plaintext + SOCKS5 proxy:[0m
[30;1m28 | [0m[35m      kerberos+password://domain\\user:SecretPassword@127.0.0.1/proxytype=socks5&proxyhost=127.0.0.1[0m
[30;1m29 | [0m[35m   - Plaintext:[0m
[30;1m30 | [0m[35m      kerberos+password://domain\\user:SecretPassword@127.0.0.1[0m
[30;1m31 | [0m[35m      kerberos+pw://domain\\user:SecretPassword@127.0.0.1[0m
[30;1m32 | [0m[35m      kerberos+pass://domain\\user:SecretPassword@127.0.0.1[0m
[30;1m33 | [0m[35m   - NT hash:[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/factory.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m25 | [0m[35m   [0m
[30;1m26 | [0m[35m   Example:[0m
[30;1m27 | [0m[35m   - Plaintext + SOCKS5 proxy:[0m
[30;1m28 | [0m[35m      kerberos+password://domain\\user:SecretPassword@127.0.0.1/proxytype=socks5&proxyhost=127.0.0.1[0m
[30;1m29 | [0m[35m   - Plaintext:[0m
[30;1m30 | [0m[35m      kerberos+password://domain\\user:SecretPassword@127.0.0.1[0m
[30;1m31 | [0m[35m      kerberos+pw://domain\\user:SecretPassword@127.0.0.1[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/factory.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m25 | [0m[35m   [0m
[30;1m26 | [0m[35m   Example:[0m
[30;1m27 | [0m[35m   - Plaintext + SOCKS5 proxy:[0m
[30;1m28 | [0m[35m      kerberos+password://domain\\user:SecretPassword@127.0.0.1/proxytype=socks5&proxyhost=127.0.0.1[0m
[30;1m29 | [0m[35m   - Plaintext:[0m
[30;1m30 | [0m[35m      kerberos+password://domain\\user:SecretPassword@127.0.0.1[0m
[30;1m31 | [0m[35m      kerberos+pw://domain\\user:SecretPassword@127.0.0.1[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/factory.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mkerberos_url_help_epilog = """==== Extra Help ====[0m
[30;1m18 | [0m[35m   kerberos connection url secret types: [0m
[30;1m19 | [0m[35m   - Plaintext: "pw" or "pass" or "password"[0m
[30;1m20 | [0m[35m   - NT hash: "nt"[0m
[30;1m21 | [0m[35m   - RC4 key: "rc4"[0m
[30;1m22 | [0m[35m   - AES128/256 key: "aes"[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_conn_blocking.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35mdef test_tgt_pw_incorrect_pw():[0m
[30;1m44 | [0m[35m	cu = KerberosClientFactory.from_url('kerberos+password://%s\\%s:blablaThisiswrong12@10.10.10.2' % ([0m
[30;1m45 | [0m[35m	client = cu.get_client_blocking()[0m
[30;1m46 | [0m[35m	with pytest.raises(Exception) as e_info:[0m
[30;1m47 | [0m[35m		client.get_TGT()[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_conn_blocking.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mdef test_tgt_pw_incorrect_user():[0m
[30;1m36 | [0m[35m	cu = KerberosClientFactory.from_url('kerberos+password://%s\\NOTVALIDUSER:%s@10.10.10.2' % (KERBERO[0m
[30;1m37 | [0m[35m	client = cu.get_client_blocking()[0m
[30;1m38 | [0m[35m	with pytest.raises(Exception) as e_info:[0m
[30;1m39 | [0m[35m		client.get_TGT()[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_conn_blocking.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mdef test_tgt_pw_incorrect_user():[0m
[30;1m36 | [0m[35m	cu = KerberosClientFactory.from_url('kerberos+password://%s\\NOTVALIDUSER:%s@10.10.10.2' % (KERBERO[0m
[30;1m37 | [0m[35m	client = cu.get_client_blocking()[0m
[30;1m38 | [0m[35m	with pytest.raises(Exception) as e_info:[0m
[30;1m39 | [0m[35m		client.get_TGT()[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_conn_blocking.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mdef test_tgt_pw_incorrect_realm():[0m
[30;1m29 | [0m[35m	cu = KerberosClientFactory.from_url('kerberos+password://NONEXISTENT\\%s:%s@10.10.10.2' % (KERBEROS[0m
[30;1m30 | [0m[35m	client = cu.get_client_blocking()[0m
[30;1m31 | [0m[35m	with pytest.raises(Exception) as e_info:[0m
[30;1m32 | [0m[35m		client.get_TGT()[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_conn_blocking.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mdef test_tgt_pw_incorrect_realm():[0m
[30;1m29 | [0m[35m	cu = KerberosClientFactory.from_url('kerberos+password://NONEXISTENT\\%s:%s@10.10.10.2' % (KERBEROS[0m
[30;1m30 | [0m[35m	client = cu.get_client_blocking()[0m
[30;1m31 | [0m[35m	with pytest.raises(Exception) as e_info:[0m
[30;1m32 | [0m[35m		client.get_TGT()[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/aioclient.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m883 | [0m[35m		newt = self.target.get_newtarget(self.target.get_hostname_or_ip(), port=464)[0m
[30;1m884 | [0m[35m		ksocket = AIOKerberosPWChangeClientSocket(newt)[0m
[30;1m885 | [0m[35m		response = await ksocket.sendrecv(message)[0m
[30;1m886 | [0m[35m		reply = KRB5ChangePassword.from_bytes(response)[0m
[30;1m887 | [0m[35m		privresponse = reply.parse_reply(subkey_cipher, subkey)[0m
[30;1m888 | [0m[35m		return privresponse[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/aioclient.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m878 | [0m[35m		[0m
[30;1m879 | [0m[35m		[0m
[30;1m880 | [0m[35m		message = KRB5ChangePassword(ap_req_encoded, privdata).to_bytes()[0m
[30;1m881 | [0m[35m		logger.debug('[ChangePassword] Sending request to server')[0m
[30;1m882 | [0m[35m[0m
[30;1m883 | [0m[35m		newt = self.target.get_newtarget(self.target.get_hostname_or_ip(), port=464)[0m
[30;1m884 | [0m[35m		ksocket = AIOKerberosPWChangeClientSocket(newt)[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/aioclient.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m877 | [0m[35m		ap_req_encoded = AP_REQ(ap_req).dump()[0m
[30;1m878 | [0m[35m		[0m
[30;1m879 | [0m[35m		[0m
[30;1m880 | [0m[35m		message = KRB5ChangePassword(ap_req_encoded, privdata).to_bytes()[0m
[30;1m881 | [0m[35m		logger.debug('[ChangePassword] Sending request to server')[0m
[30;1m882 | [0m[35m[0m
[30;1m883 | [0m[35m		newt = self.target.get_newtarget(self.target.get_hostname_or_ip(), port=464)[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/aioclient.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m833 | [0m[35m		subkey_cipher = _enctype_table[subkey.enctype][0m
[30;1m834 | [0m[35m[0m
[30;1m835 | [0m[35m		changepwstruct = {}[0m
[30;1m836 | [0m[35m		changepwstruct['newpasswd'] = new_password.encode()[0m
[30;1m837 | [0m[35m[0m
[30;1m838 | [0m[35m		if targetuser is not None:[0m
[30;1m839 | [0m[35m			if targetuser.find('@') != -1:[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/aioclient.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m828 | [0m[35m		now = datetime.datetime.now(datetime.timezone.utc)[0m
[30;1m829 | [0m[35m[0m
[30;1m830 | [0m[35m		###### Encrypting the new password[0m
[30;1m831 | [0m[35m		#enc_data = self.kerberos_cipher.encrypt(subkey, 5, new_password.encode(), None)[0m
[30;1m832 | [0m[35m		subkey_struct = EncryptionKey({'keytype': subkey.enctype, 'keyvalue': subkeydata})[0m
[30;1m833 | [0m[35m		subkey_cipher = _enctype_table[subkey.enctype][0m
[30;1m834 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/aioclient.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m827 | [0m[35m[0m
[30;1m828 | [0m[35m		now = datetime.datetime.now(datetime.timezone.utc)[0m
[30;1m829 | [0m[35m[0m
[30;1m830 | [0m[35m		###### Encrypting the new password[0m
[30;1m831 | [0m[35m		#enc_data = self.kerberos_cipher.encrypt(subkey, 5, new_password.encode(), None)[0m
[30;1m832 | [0m[35m		subkey_struct = EncryptionKey({'keytype': subkey.enctype, 'keyvalue': subkeydata})[0m
[30;1m833 | [0m[35m		subkey_cipher = _enctype_table[subkey.enctype][0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/aioclient.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m818 | [0m[35m		Changes the password of the current user[0m
[30;1m819 | [0m[35m		"""[0m
[30;1m820 | [0m[35m		if not self.kerberos_TGT:[0m
[30;1m821 | [0m[35m			logger.debug('[ChangePassword] TGT is not available! Fetching TGT...')[0m
[30;1m822 | [0m[35m			await self.get_TGT()[0m
[30;1m823 | [0m[35m		[0m
[30;1m824 | [0m[35m		if subkey is None:[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/aioclient.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m815 | [0m[35m	[0m
[30;1m816 | [0m[35m	async def change_password(self, new_password:str, subkey = None, targetuser:str = None, targetrealm[0m
[30;1m817 | [0m[35m		"""[0m
[30;1m818 | [0m[35m		Changes the password of the current user[0m
[30;1m819 | [0m[35m		"""[0m
[30;1m820 | [0m[35m		if not self.kerberos_TGT:[0m
[30;1m821 | [0m[35m			logger.debug('[ChangePassword] TGT is not available! Fetching TGT...')[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/aioclient.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m813 | [0m[35m[0m
[30;1m814 | [0m[35m		return tgs, encpart, key, new_factory[0m
[30;1m815 | [0m[35m	[0m
[30;1m816 | [0m[35m	async def change_password(self, new_password:str, subkey = None, targetuser:str = None, targetrealm[0m
[30;1m817 | [0m[35m		"""[0m
[30;1m818 | [0m[35m		Changes the password of the current user[0m
[30;1m819 | [0m[35m		"""[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/aioclient.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m813 | [0m[35m[0m
[30;1m814 | [0m[35m		return tgs, encpart, key, new_factory[0m
[30;1m815 | [0m[35m	[0m
[30;1m816 | [0m[35m	async def change_password(self, new_password:str, subkey = None, targetuser:str = None, targetrealm[0m
[30;1m817 | [0m[35m		"""[0m
[30;1m818 | [0m[35m		Changes the password of the current user[0m
[30;1m819 | [0m[35m		"""[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/aioclient.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m18 | [0m[35m	ChangePasswdDataMS, EncryptionKey, EncKrbPrivPart, HostAddress, KRB_PRIV,\[0m
[30;1m19 | [0m[35m	AP_REP[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mfrom minikerberos.protocol.rfc3244 import KRB5ChangePassword, KRB5CHPWReply, KRB5CHPWResultCode[0m
[30;1m22 | [0m[35mfrom minikerberos.protocol.errors import KerberosErrorCode, KerberosError[0m
[30;1m23 | [0m[35mfrom minikerberos.protocol.encryption import Key, _enctype_table, _HMACMD5, Enctype, _checksum_table[0m
[30;1m24 | [0m[35mfrom minikerberos.protocol.constants import PaDataType, EncryptionType, NAME_TYPE, MESSAGE_TYPE[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/ccache.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m844 | [0m[35m[0m
[30;1m845 | [0m[35m	@staticmethod[0m
[30;1m846 | [0m[35m	def from_b64(b64data):[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/ccache.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m840 | [0m[35m		return self.to_bytes().hex()[0m
[30;1m841 | [0m[35m	[0m
[30;1m842 | [0m[35m	def to_b64(self):[0m
[30;1m843 | [0m[35m		return base64.b64encode(self.to_bytes()).decode('ascii')[0m
[30;1m844 | [0m[35m[0m
[30;1m845 | [0m[35m	@staticmethod[0m
[30;1m846 | [0m[35m	def from_b64(b64data):[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/ccache.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m780 | [0m[35m		try:[0m
[30;1m781 | [0m[35m			ccache = CCACHE.from_kirbi(kirbidata)[0m
[30;1m782 | [0m[35m		except:[0m
[30;1m783 | [0m[35m			#maybe the kirbi file is actually base64 encoded from rubeus?[0m
[30;1m784 | [0m[35m			kirbi = Kirbi.from_b64(kirbidata)[0m
[30;1m785 | [0m[35m			ccache = CCACHE.from_kirbi(kirbi)[0m
[30;1m786 | [0m[35m		[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/ccache.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m2 | [0m[35mimport io[0m
[30;1m3 | [0m[35mimport datetime[0m
[30;1m4 | [0m[35mimport glob[0m
[30;1m5 | [0m[35mimport base64[0m
[30;1m6 | [0m[35mfrom typing import List[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mfrom minikerberos.protocol.asn1_structs import Ticket, EncryptedData, \[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/ccache.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m543 | [0m[35m		header = Header()[0m
[30;1m544 | [0m[35m		header.tag = 1[0m
[30;1m545 | [0m[35m		header.taglen = 8[0m
[30;1m546 | [0m[35m		header.tagdata = b'\x00\x00\x00\x00\x00\x00\x00\x00'[0m
[30;1m547 | [0m[35m		self.headers.append(header)[0m
[30;1m548 | [0m[35m		[0m
[30;1m549 | [0m[35m		self.primary_principal = CCACHEPrincipal.empty()[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/windows/crypt32.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m377 | [0m[35m	[0m
[30;1m378 | [0m[35m[0m
[30;1m379 | [0m[35mdef pkcs7_sign(hcert, data):[0m
[30;1m380 | [0m[35m	hprov, keyspec, to_free = CryptAcquireCertificatePrivateKey(hcert)[0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35m	hashalgo = CRYPT_ALGORITHM_IDENTIFIER()[0m
[30;1m383 | [0m[35m	hashalgo.pszObjId = b"1.3.14.3.2.26" #szOID_OIWSEC_sha1[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/windows/crypt32.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m281 | [0m[35m	fCallerFreeProvOrNCryptKey = BOOL(0)[0m
[30;1m282 | [0m[35m	hprov = HANDLE(0)[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m	_CryptAcquireCertificatePrivateKey(handle, dwFlags, None, byref(hprov), byref(dwKeySpec),  byref(fC[0m
[30;1m285 | [0m[35m[0m
[30;1m286 | [0m[35m	return hprov, dwKeySpec, fCallerFreeProvOrNCryptKey[0m
[30;1m287 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/windows/crypt32.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m275 | [0m[35m	_CryptAcquireCertificatePrivateKey = windll.crypt32.CryptAcquireCertificatePrivateKey[0m
[30;1m276 | [0m[35m	_CryptAcquireCertificatePrivateKey.argtypes = [PCCERT_CONTEXT, DWORD, PVOID, PHCRYPTPROV_OR_NCRYPT_[0m
[30;1m277 | [0m[35m	_CryptAcquireCertificatePrivateKey.restype = BOOL[0m
[30;1m278 | [0m[35m	_CryptAcquireCertificatePrivateKey.errcheck = RaiseIfZero[0m
[30;1m279 | [0m[35m[0m
[30;1m280 | [0m[35m	dwKeySpec = DWORD(0)[0m
[30;1m281 | [0m[35m	fCallerFreeProvOrNCryptKey = BOOL(0)[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/windows/crypt32.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m274 | [0m[35mdef CryptAcquireCertificatePrivateKey(handle, dwFlags = CRYPT_ACQUIRE_ALLOW_NCRYPT_KEY_FLAG):[0m
[30;1m275 | [0m[35m	_CryptAcquireCertificatePrivateKey = windll.crypt32.CryptAcquireCertificatePrivateKey[0m
[30;1m276 | [0m[35m	_CryptAcquireCertificatePrivateKey.argtypes = [PCCERT_CONTEXT, DWORD, PVOID, PHCRYPTPROV_OR_NCRYPT_[0m
[30;1m277 | [0m[35m	_CryptAcquireCertificatePrivateKey.restype = BOOL[0m
[30;1m278 | [0m[35m	_CryptAcquireCertificatePrivateKey.errcheck = RaiseIfZero[0m
[30;1m279 | [0m[35m[0m
[30;1m280 | [0m[35m	dwKeySpec = DWORD(0)[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/windows/crypt32.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35mdef CryptAcquireCertificatePrivateKey(handle, dwFlags = CRYPT_ACQUIRE_ALLOW_NCRYPT_KEY_FLAG):[0m
[30;1m275 | [0m[35m	_CryptAcquireCertificatePrivateKey = windll.crypt32.CryptAcquireCertificatePrivateKey[0m
[30;1m276 | [0m[35m	_CryptAcquireCertificatePrivateKey.argtypes = [PCCERT_CONTEXT, DWORD, PVOID, PHCRYPTPROV_OR_NCRYPT_[0m
[30;1m277 | [0m[35m	_CryptAcquireCertificatePrivateKey.restype = BOOL[0m
[30;1m278 | [0m[35m	_CryptAcquireCertificatePrivateKey.errcheck = RaiseIfZero[0m
[30;1m279 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/windows/crypt32.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m272 | [0m[35m	return handle[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35mdef CryptAcquireCertificatePrivateKey(handle, dwFlags = CRYPT_ACQUIRE_ALLOW_NCRYPT_KEY_FLAG):[0m
[30;1m275 | [0m[35m	_CryptAcquireCertificatePrivateKey = windll.crypt32.CryptAcquireCertificatePrivateKey[0m
[30;1m276 | [0m[35m	_CryptAcquireCertificatePrivateKey.argtypes = [PCCERT_CONTEXT, DWORD, PVOID, PHCRYPTPROV_OR_NCRYPT_[0m
[30;1m277 | [0m[35m	_CryptAcquireCertificatePrivateKey.restype = BOOL[0m
[30;1m278 | [0m[35m	_CryptAcquireCertificatePrivateKey.errcheck = RaiseIfZero[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/windows/crypt32.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m272 | [0m[35m	return handle[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35mdef CryptAcquireCertificatePrivateKey(handle, dwFlags = CRYPT_ACQUIRE_ALLOW_NCRYPT_KEY_FLAG):[0m
[30;1m275 | [0m[35m	_CryptAcquireCertificatePrivateKey = windll.crypt32.CryptAcquireCertificatePrivateKey[0m
[30;1m276 | [0m[35m	_CryptAcquireCertificatePrivateKey.argtypes = [PCCERT_CONTEXT, DWORD, PVOID, PHCRYPTPROV_OR_NCRYPT_[0m
[30;1m277 | [0m[35m	_CryptAcquireCertificatePrivateKey.restype = BOOL[0m
[30;1m278 | [0m[35m	_CryptAcquireCertificatePrivateKey.errcheck = RaiseIfZero[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/windows/crypt32.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m	return handle[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35mdef CryptAcquireCertificatePrivateKey(handle, dwFlags = CRYPT_ACQUIRE_ALLOW_NCRYPT_KEY_FLAG):[0m
[30;1m275 | [0m[35m	_CryptAcquireCertificatePrivateKey = windll.crypt32.CryptAcquireCertificatePrivateKey[0m
[30;1m276 | [0m[35m	_CryptAcquireCertificatePrivateKey.argtypes = [PCCERT_CONTEXT, DWORD, PVOID, PHCRYPTPROV_OR_NCRYPT_[0m
[30;1m277 | [0m[35m	_CryptAcquireCertificatePrivateKey.restype = BOOL[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos.egg-info/SOURCES.txt[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m37 | [0m[35mminikerberos/examples/ccache2kirbi.py[0m
[30;1m38 | [0m[35mminikerberos/examples/ccache_editor.py[0m
[30;1m39 | [0m[35mminikerberos/examples/ccacheroast.py[0m
[30;1m40 | [0m[35mminikerberos/examples/changepassword.py[0m
[30;1m41 | [0m[35mminikerberos/examples/crosstest.py[0m
[30;1m42 | [0m[35mminikerberos/examples/getNT.py[0m
[30;1m43 | [0m[35mminikerberos/examples/getS4U2proxy.py[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/ticketutil.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m33 | [0m[35m					if credstruct['NtPassword'] != b'\x00'*16:[0m
[30;1m34 | [0m[35m						creds.append(('NT', credstruct['NtPassword'].hex()))[0m
[30;1m35 | [0m[35m					if credstruct['LmPassword'] != b'\x00'*16:[0m
[30;1m36 | [0m[35m						creds.append(('LM', credstruct['LmPassword'].hex()))[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m			buff = buff[len(infoBuffer):][0m
[30;1m39 | [0m[35m		[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/ticketutil.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m32 | [0m[35m					credstruct = NTLM_SUPPLEMENTAL_CREDENTIAL(b''.join(cred['Credentials']))[0m
[30;1m33 | [0m[35m					if credstruct['NtPassword'] != b'\x00'*16:[0m
[30;1m34 | [0m[35m						creds.append(('NT', credstruct['NtPassword'].hex()))[0m
[30;1m35 | [0m[35m					if credstruct['LmPassword'] != b'\x00'*16:[0m
[30;1m36 | [0m[35m						creds.append(('LM', credstruct['LmPassword'].hex()))[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m			buff = buff[len(infoBuffer):][0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/ticketutil.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m31 | [0m[35m				for cred in pcc['Credentials']:[0m
[30;1m32 | [0m[35m					credstruct = NTLM_SUPPLEMENTAL_CREDENTIAL(b''.join(cred['Credentials']))[0m
[30;1m33 | [0m[35m					if credstruct['NtPassword'] != b'\x00'*16:[0m
[30;1m34 | [0m[35m						creds.append(('NT', credstruct['NtPassword'].hex()))[0m
[30;1m35 | [0m[35m					if credstruct['LmPassword'] != b'\x00'*16:[0m
[30;1m36 | [0m[35m						creds.append(('LM', credstruct['LmPassword'].hex()))[0m
[30;1m37 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/ticketutil.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m30 | [0m[35m				pcc = PAC_CREDENTIAL_DATA(newdata)[0m
[30;1m31 | [0m[35m				for cred in pcc['Credentials']:[0m
[30;1m32 | [0m[35m					credstruct = NTLM_SUPPLEMENTAL_CREDENTIAL(b''.join(cred['Credentials']))[0m
[30;1m33 | [0m[35m					if credstruct['NtPassword'] != b'\x00'*16:[0m
[30;1m34 | [0m[35m						creds.append(('NT', credstruct['NtPassword'].hex()))[0m
[30;1m35 | [0m[35m					if credstruct['LmPassword'] != b'\x00'*16:[0m
[30;1m36 | [0m[35m						creds.append(('LM', credstruct['LmPassword'].hex()))[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/nrpc.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m62 | [0m[35m        return 8[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m# 2.2.1.4.9 USER_SESSION_KEY[0m
[30;1m65 | [0m[35mUSER_SESSION_KEY = LM_OWF_PASSWORD[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m# 2.2.1.4.10 GROUP_MEMBERSHIP[0m
[30;1m68 | [0m[35mclass GROUP_MEMBERSHIP(NDRSTRUCT):[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/nrpc.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m# 2.2.1.1.4 NT_OWF_PASSWORD[0m
[30;1m55 | [0m[35mNT_OWF_PASSWORD = LM_OWF_PASSWORD[0m
[30;1m56 | [0m[35mENCRYPTED_NT_OWF_PASSWORD = NT_OWF_PASSWORD[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m# 2.2.1.4.1 LM_CHALLENGE[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/nrpc.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m# 2.2.1.1.4 NT_OWF_PASSWORD[0m
[30;1m55 | [0m[35mNT_OWF_PASSWORD = LM_OWF_PASSWORD[0m
[30;1m56 | [0m[35mENCRYPTED_NT_OWF_PASSWORD = NT_OWF_PASSWORD[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m# 2.2.1.4.1 LM_CHALLENGE[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/nrpc.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m52 | [0m[35m    )[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m# 2.2.1.1.4 NT_OWF_PASSWORD[0m
[30;1m55 | [0m[35mNT_OWF_PASSWORD = LM_OWF_PASSWORD[0m
[30;1m56 | [0m[35mENCRYPTED_NT_OWF_PASSWORD = NT_OWF_PASSWORD[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/nrpc.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m52 | [0m[35m    )[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m# 2.2.1.1.4 NT_OWF_PASSWORD[0m
[30;1m55 | [0m[35mNT_OWF_PASSWORD = LM_OWF_PASSWORD[0m
[30;1m56 | [0m[35mENCRYPTED_NT_OWF_PASSWORD = NT_OWF_PASSWORD[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/nrpc.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m51 | [0m[35m        ('Data', CYPHER_BLOCK_ARRAY),[0m
[30;1m52 | [0m[35m    )[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m# 2.2.1.1.4 NT_OWF_PASSWORD[0m
[30;1m55 | [0m[35mNT_OWF_PASSWORD = LM_OWF_PASSWORD[0m
[30;1m56 | [0m[35mENCRYPTED_NT_OWF_PASSWORD = NT_OWF_PASSWORD[0m
[30;1m57 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/nrpc.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m46 | [0m[35m    def getDataLen(self, data, offset=0):[0m
[30;1m47 | [0m[35m        return len(CYPHER_BLOCK())*2[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35mclass LM_OWF_PASSWORD(NDRSTRUCT):[0m
[30;1m50 | [0m[35m    structure = ([0m
[30;1m51 | [0m[35m        ('Data', CYPHER_BLOCK_ARRAY),[0m
[30;1m52 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/nrpc.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m41 | [0m[35m        [0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m# 2.2.1.1.3 LM_OWF_PASSWORD[0m
[30;1m45 | [0m[35mclass CYPHER_BLOCK_ARRAY(NDRUniFixedArray):[0m
[30;1m46 | [0m[35m    def getDataLen(self, data, offset=0):[0m
[30;1m47 | [0m[35m        return len(CYPHER_BLOCK())*2[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m231 | [0m[35m	for keytabfile in get_testfiles_keytab():[0m
[30;1m232 | [0m[35m		keytab = Keytab.from_file(keytabfile)[0m
[30;1m233 | [0m[35m		kenctype = [keytabentry.enctype for keytabentry in keytab.entries][0][0m
[30;1m234 | [0m[35m		keytabdata = base64.b64encode(keytabfile.read_bytes()).decode()[0m
[30;1m235 | [0m[35m		cred = KerberosCredential.from_keytab_string(keytabdata, 'administrator', 'domain.local')[0m
[30;1m236 | [0m[35m		assert cred.username == 'administrator'[0m
[30;1m237 | [0m[35m		assert cred.domain == 'domain.local'[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m211 | [0m[35m		keytab = Keytab.from_file(keytabfile)[0m
[30;1m212 | [0m[35m		kenctype = [keytabentry.enctype for keytabentry in keytab.entries][0][0m
[30;1m213 | [0m[35m		keytabdata = base64.b64encode(keytabfile.read_bytes()).decode()[0m
[30;1m214 | [0m[35m		cred = KerberosCredential.from_keytab(keytabdata, 'administrator', 'domain.local', encoding = 'bas[0m
[30;1m215 | [0m[35m		assert cred.username == 'administrator'[0m
[30;1m216 | [0m[35m		assert cred.domain == 'domain.local'[0m
[30;1m217 | [0m[35m		if Enctype.AES256 == kenctype:[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m210 | [0m[35m	for keytabfile in get_testfiles_keytab():[0m
[30;1m211 | [0m[35m		keytab = Keytab.from_file(keytabfile)[0m
[30;1m212 | [0m[35m		kenctype = [keytabentry.enctype for keytabentry in keytab.entries][0][0m
[30;1m213 | [0m[35m		keytabdata = base64.b64encode(keytabfile.read_bytes()).decode()[0m
[30;1m214 | [0m[35m		cred = KerberosCredential.from_keytab(keytabdata, 'administrator', 'domain.local', encoding = 'bas[0m
[30;1m215 | [0m[35m		assert cred.username == 'administrator'[0m
[30;1m216 | [0m[35m		assert cred.domain == 'domain.local'[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35mdef test_load_ccache_base64():[0m
[30;1m148 | [0m[35m	ccachedata = base64.b64encode(CCACHE_DIR.joinpath('administrator.ccache').read_bytes()).decode()[0m
[30;1m149 | [0m[35m	cred = KerberosCredential.from_ccache(ccachedata, encoding = 'base64')[0m
[30;1m150 | [0m[35m	assert len(cred.ccache.get_all_tgt()) > 0[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35mdef test_load_ccache_file():[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m145 | [0m[35m	assert len(cred.ccache.get_all_tgt()) > 0[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35mdef test_load_ccache_base64():[0m
[30;1m148 | [0m[35m	ccachedata = base64.b64encode(CCACHE_DIR.joinpath('administrator.ccache').read_bytes()).decode()[0m
[30;1m149 | [0m[35m	cred = KerberosCredential.from_ccache(ccachedata, encoding = 'base64')[0m
[30;1m150 | [0m[35m	assert len(cred.ccache.get_all_tgt()) > 0[0m
[30;1m151 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35mimport pathlib[0m
[30;1m4 | [0m[35mimport pytest[0m
[30;1m5 | [0m[35mimport base64[0m
[30;1m6 | [0m[35mfrom minikerberos.common.factory import KerberosClientFactory[0m
[30;1m7 | [0m[35mfrom minikerberos.common.creds import KerberosCredential[0m
[30;1m8 | [0m[35mfrom minikerberos.common.constants import KerberosSecretType[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m129 | [0m[35m	cred = KerberosCredential()[0m
[30;1m130 | [0m[35m	cred.domain = 'domain'[0m
[30;1m131 | [0m[35m	cred.username = 'user'[0m
[30;1m132 | [0m[35m	cred.password = 'password'[0m
[30;1m133 | [0m[35m	ret = cred.get_key_for_enctype(EncryptionType.DES_CBC_MD5)[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35mdef test_addsecret_ccache():[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m129 | [0m[35m	cred = KerberosCredential()[0m
[30;1m130 | [0m[35m	cred.domain = 'domain'[0m
[30;1m131 | [0m[35m	cred.username = 'user'[0m
[30;1m132 | [0m[35m	cred.password = 'password'[0m
[30;1m133 | [0m[35m	ret = cred.get_key_for_enctype(EncryptionType.DES_CBC_MD5)[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35mdef test_addsecret_ccache():[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m122 | [0m[35m	cred = KerberosCredential()[0m
[30;1m123 | [0m[35m	cred.domain = 'domain'[0m
[30;1m124 | [0m[35m	cred.username = 'user'[0m
[30;1m125 | [0m[35m	cred.password = 'password'[0m
[30;1m126 | [0m[35m	ret = cred.get_key_for_enctype(EncryptionType.DES3_CBC_SHA1)[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35mdef test_stringtokey_des():[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m122 | [0m[35m	cred = KerberosCredential()[0m
[30;1m123 | [0m[35m	cred.domain = 'domain'[0m
[30;1m124 | [0m[35m	cred.username = 'user'[0m
[30;1m125 | [0m[35m	cred.password = 'password'[0m
[30;1m126 | [0m[35m	ret = cred.get_key_for_enctype(EncryptionType.DES3_CBC_SHA1)[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35mdef test_stringtokey_des():[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m30 | [0m[35m	cred.domain = 'domain'[0m
[30;1m31 | [0m[35m	cred.username = 'user'[0m
[30;1m32 | [0m[35m	cred.add_secret(KerberosSecretType.PASSWORD, 'password')[0m
[30;1m33 | [0m[35m	assert cred.password == 'password'[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mdef test_addsecret_rc4():[0m
[30;1m36 | [0m[35m	cred = KerberosCredential()[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m30 | [0m[35m	cred.domain = 'domain'[0m
[30;1m31 | [0m[35m	cred.username = 'user'[0m
[30;1m32 | [0m[35m	cred.add_secret(KerberosSecretType.PASSWORD, 'password')[0m
[30;1m33 | [0m[35m	assert cred.password == 'password'[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mdef test_addsecret_rc4():[0m
[30;1m36 | [0m[35m	cred = KerberosCredential()[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m29 | [0m[35m	cred = KerberosCredential()[0m
[30;1m30 | [0m[35m	cred.domain = 'domain'[0m
[30;1m31 | [0m[35m	cred.username = 'user'[0m
[30;1m32 | [0m[35m	cred.add_secret(KerberosSecretType.PASSWORD, 'password')[0m
[30;1m33 | [0m[35m	assert cred.password == 'password'[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mdef test_addsecret_rc4():[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m29 | [0m[35m	cred = KerberosCredential()[0m
[30;1m30 | [0m[35m	cred.domain = 'domain'[0m
[30;1m31 | [0m[35m	cred.username = 'user'[0m
[30;1m32 | [0m[35m	cred.add_secret(KerberosSecretType.PASSWORD, 'password')[0m
[30;1m33 | [0m[35m	assert cred.password == 'password'[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mdef test_addsecret_rc4():[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m25 | [0m[35m	assert target.ip == '127.0.0.1'[0m
[30;1m26 | [0m[35m	assert target.port == 88[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mdef test_addsecret_password():[0m
[30;1m29 | [0m[35m	cred = KerberosCredential()[0m
[30;1m30 | [0m[35m	cred.domain = 'domain'[0m
[30;1m31 | [0m[35m	cred.username = 'user'[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000805[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongBinaryStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/CVE_2022_33647.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){10,}[0m
[30;1m100 | [0m[35m		sl = b'\x81' + second_len.to_bytes(1, byteorder='big', signed=False)[0m
[30;1m101 | [0m[35m	else:[0m
[30;1m102 | [0m[35m		sl = b'\x82' + second_len.to_bytes(2, byteorder='big', signed=False)[0m
[30;1m103 | [0m[35m	return b'\x79' + fl + b'\x30'+ sl +b'\xA0\x1B\x30\x19\xA0\x03\x02\x01\x80\xA1\x12\x04\x10'[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35mdef get_padding_data():[0m
[30;1m106 | [0m[35m	# for the attack to work, we need a TGT with a larger-than-normal AS-REP enc-data[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/pkinit.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m269 | [0m[35m		tii = LSAP_TOKEN_INFO_INTEGRITY()[0m
[30;1m270 | [0m[35m		tii.Flags = 1[0m
[30;1m271 | [0m[35m		tii.TokenIL = 0x00002000 # Medium integrity[0m
[30;1m272 | [0m[35m		tii.MachineID = bytes.fromhex('7e303fffe6bff25146addca4fbddf1b94f1634178eb4528fb2731c669ca23cde')[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35m		restriction_data = {}[0m
[30;1m275 | [0m[35m		restriction_data['restriction-type'] = 0[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000805[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongBinaryStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/CVE_2022_33679.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){10,}[0m
[30;1m54 | [0m[35m	data_length = cipher_length - header_length[0m
[30;1m55 | [0m[35m	first_len = data_length - 4[0m
[30;1m56 | [0m[35m	second_len = first_len - 4[0m
[30;1m57 | [0m[35m	return b'\x00'*24 + b'\x79\x82' + first_len.to_bytes(2, byteorder='big', signed=False) + b'\x30\x82[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35mdef get_crafted_timestamp(n, now):[0m
[30;1m60 | [0m[35m	# manually crafting a timestamp field for this exploit to work is an [0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/gssapi/gssapi.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m396 | [0m[35m	data = bytes.fromhex('810e00001a204de2d64fd111a3da0000f875ae0d1c45000034000000340000000080400500000[0m
[30;1m397 | [0m[35m	sequenceNumber = 0[0m
[30;1m398 | [0m[35m	ret1 = bytes.fromhex('4ae025fa2a9c337c75c024d9d8f0186c75a4a9060e2a40a9ad024317bf5df6a86cb4a764a9ca3[0m
[30;1m399 | [0m[35m	ret2 = bytes.fromhex('050406ff000c001c000000000000000008cb9850e5701f2f9285dad6463ca8d0e365d4f1700f3[0m
[30;1m400 | [0m[35m	[0m
[30;1m401 | [0m[35m	gssapi = get_gssapi(session_key)[0m
[30;1m402 | [0m[35m	r1, r2 = gssapi.GSS_Wrap(data, sequenceNumber)[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/gssapi/gssapi.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m395 | [0m[35m	session_key = encryption.Key( encryption.Enctype.AES256 , bytes.fromhex('3e242e91996aadd513ecb1bc23[0m
[30;1m396 | [0m[35m	data = bytes.fromhex('810e00001a204de2d64fd111a3da0000f875ae0d1c45000034000000340000000080400500000[0m
[30;1m397 | [0m[35m	sequenceNumber = 0[0m
[30;1m398 | [0m[35m	ret1 = bytes.fromhex('4ae025fa2a9c337c75c024d9d8f0186c75a4a9060e2a40a9ad024317bf5df6a86cb4a764a9ca3[0m
[30;1m399 | [0m[35m	ret2 = bytes.fromhex('050406ff000c001c000000000000000008cb9850e5701f2f9285dad6463ca8d0e365d4f1700f3[0m
[30;1m400 | [0m[35m	[0m
[30;1m401 | [0m[35m	gssapi = get_gssapi(session_key)[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/gssapi/gssapi.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m393 | [0m[35m[0m
[30;1m394 | [0m[35m[0m
[30;1m395 | [0m[35m	session_key = encryption.Key( encryption.Enctype.AES256 , bytes.fromhex('3e242e91996aadd513ecb1bc23[0m
[30;1m396 | [0m[35m	data = bytes.fromhex('810e00001a204de2d64fd111a3da0000f875ae0d1c45000034000000340000000080400500000[0m
[30;1m397 | [0m[35m	sequenceNumber = 0[0m
[30;1m398 | [0m[35m	ret1 = bytes.fromhex('4ae025fa2a9c337c75c024d9d8f0186c75a4a9060e2a40a9ad024317bf5df6a86cb4a764a9ca3[0m
[30;1m399 | [0m[35m	ret2 = bytes.fromhex('050406ff000c001c000000000000000008cb9850e5701f2f9285dad6463ca8d0e365d4f1700f3[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/gssapi/gssapi.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m392 | [0m[35m[0m
[30;1m393 | [0m[35m[0m
[30;1m394 | [0m[35m[0m
[30;1m395 | [0m[35m	session_key = encryption.Key( encryption.Enctype.AES256 , bytes.fromhex('3e242e91996aadd513ecb1bc23[0m
[30;1m396 | [0m[35m	data = bytes.fromhex('810e00001a204de2d64fd111a3da0000f875ae0d1c45000034000000340000000080400500000[0m
[30;1m397 | [0m[35m	sequenceNumber = 0[0m
[30;1m398 | [0m[35m	ret1 = bytes.fromhex('4ae025fa2a9c337c75c024d9d8f0186c75a4a9060e2a40a9ad024317bf5df6a86cb4a764a9ca3[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/gssapi/gssapi.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m390 | [0m[35mdde3f3fb23eeea650bc4ae025fa2a9c337c75c024d9d8f0186c75a4a9060e2a40a9ad024317bf5df6a86cb4a764a9ca36843[0m
[30;1m391 | [0m[35m	cipherText_2 = bytes.fromhex('08cb9850e5701f2f9285dad6463ca8d0e365d4f1700f3d054e242ebcde2f3146ddd41[0m
[30;1m392 | [0m[35m[0m
[30;1m393 | [0m[35m[0m
[30;1m394 | [0m[35m[0m
[30;1m395 | [0m[35m	session_key = encryption.Key( encryption.Enctype.AES256 , bytes.fromhex('3e242e91996aadd513ecb1bc23[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/gssapi/gssapi.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m388 | [0m[35mbytes.fromhex('810e00001a204de2d64fd111a3da0000f875ae0d1c4500003400000034000000008040050000000000000[0m
[30;1m389 | [0m[35m	token_1= bytes.fromhex('050406ff000c00000000000000000000')[0m
[30;1m390 | [0m[35m	cipherText_1 = bytes.fromhex('0880ed78d6196dde3f3fb23eeea650bc4ae025fa2a9c337c75c024d9d8f0186c75a4a[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/gssapi/gssapi.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m380 | [0m[35mPI_AES(session_key, encryption._AES128CTS, encryption._SHA1AES128)[0m
[30;1m381 | [0m[35m	elif session_key.enctype in [encryption.Enctype.RC4, encryption.Enctype.RC4_MD4]:[0m
[30;1m382 | [0m[35m		return GSSAPI_RC4(session_key)[0m
[30;1m383 | [0m[35m	else:[0m
[30;1m384 | [0m[35m		raise Exception('Unsupported etype %s' % session_key.enctype)[0m
[30;1m385 | [0m[35m		[0m
[30;1m386 | [0m[35m		[0m
[30;1m387 | [0m[35mdef test():[0m
[30;1m388 | [0m[35m	data_padded= bytes.fromhex('810e00001a204de2d64fd111a3da0000f875ae0d1c45000034000000340000000080400[0m
[30;1m389 | [0m[35m	token_1= bytes.fromhex('050406ff000c00000000000000000000')[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000805[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongBinaryStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/gssapi/gssapi.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){10,}[0m
[30;1m155 | [0m[35m		[0m
[30;1m156 | [0m[35m	[0m
[30;1m157 | [0m[35m	def GSS_Wrap(self, data, seq_num, direction = 'init', encrypt=True, auth_data=None):[0m
[30;1m158 | [0m[35m		GSS_WRAP_HEADER = b'\x60\x2b\x06\x09\x2a\x86\x48\x86\xf7\x12\x01\x02\x02'[0m
[30;1m159 | [0m[35m		[0m
[30;1m160 | [0m[35m		pad = (8 - (len(data) % 8)) & 0x7[0m
[30;1m161 | [0m[35m		padStr = bytes([pad]) * pad[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000805[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongBinaryStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/gssapi/gssapi.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){10,}[0m
[30;1m117 | [0m[35m		self.session_key = session_key[0m
[30;1m118 | [0m[35m	[0m
[30;1m119 | [0m[35m	def GSS_GetMIC(self, data, sequenceNumber, direction = 'init'):[0m
[30;1m120 | [0m[35m		GSS_GETMIC_HEADER = b'\x60\x23\x06\x09\x2a\x86\x48\x86\xf7\x12\x01\x02\x02'[0m
[30;1m121 | [0m[35m		[0m
[30;1m122 | [0m[35m		# Let's pad the data[0m
[30;1m123 | [0m[35m		pad = (4 - (len(data) % 4)) & 0x3[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000805[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongBinaryStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/gssapi/gssapi.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){10,}[0m
[30;1m12 | [0m[35m# https://tools.ietf.org/html/rfc2478[0m
[30;1m13 | [0m[35m# https://tools.ietf.org/html/draft-ietf-krb-wg-gssapi-cfx-02[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mGSS_WRAP_HEADER = b'\x60\x2b\x06\x09\x2a\x86\x48\x86\xf7\x12\x01\x02\x02'[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mclass GSSAPIFlags(enum.IntFlag):[0m
[30;1m18 | [0m[35m	GSS_C_DCE_STYLE     = 0x1000[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m400 | [0m[35m	def set_dhparams(self, dhparams):[0m
[30;1m401 | [0m[35m		# windows default params, don't look at me...[0m
[30;1m402 | [0m[35m		self.dhparams = DirtyDH.from_dict({[0m
[30;1m403 | [0m[35m			'p':int('00ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08[0m
[30;1m404 | [0m[35m			'g':2[0m
[30;1m405 | [0m[35m		})[0m
[30;1m406 | [0m[35m		[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_url.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m52 | [0m[35m	assert cred.domain == 'domain'[0m
[30;1m53 | [0m[35m	assert cred.username == 'user'[0m
[30;1m54 | [0m[35m	assert cred.kerberos_key_aes_128 == None[0m
[30;1m55 | [0m[35m	assert cred.kerberos_key_aes_256 == 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA[0m
[30;1m56 | [0m[35m	[0m
[30;1m57 | [0m[35m	target = url.get_target()[0m
[30;1m58 | [0m[35m	assert target.hostname == 'dc_ip'[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_encryption.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m134 | [0m[35m	keyusage = 4[0m
[30;1m135 | [0m[35m	plain = b'30 bytes bytes bytes bytes byt'[0m
[30;1m136 | [0m[35m	ctxt = h('95F9047C3AD75891C2E9B04B16566DC8B6EB9CE4231AFB2542EF87A7B5A0F260'[0m
[30;1m137 | [0m[35m			 'A99F0460508DE0CECC632D07C354124E46C5D2234EB8')[0m
[30;1m138 | [0m[35m	k = Key(Enctype.RC4, kb)[0m
[30;1m139 | [0m[35m	assert(encrypt(k, keyusage, plain, conf) == ctxt)[0m
[30;1m140 | [0m[35m	assert(decrypt(k, keyusage, ctxt) == plain)[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_encryption.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m133 | [0m[35m	conf = h('37245E73A45FBF72')[0m
[30;1m134 | [0m[35m	keyusage = 4[0m
[30;1m135 | [0m[35m	plain = b'30 bytes bytes bytes bytes byt'[0m
[30;1m136 | [0m[35m	ctxt = h('95F9047C3AD75891C2E9B04B16566DC8B6EB9CE4231AFB2542EF87A7B5A0F260'[0m
[30;1m137 | [0m[35m			 'A99F0460508DE0CECC632D07C354124E46C5D2234EB8')[0m
[30;1m138 | [0m[35m	k = Key(Enctype.RC4, kb)[0m
[30;1m139 | [0m[35m	assert(encrypt(k, keyusage, plain, conf) == ctxt)[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_encryption.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35mdef test_des3_cf2():[0m
[30;1m123 | [0m[35m	# DES3 cf2[0m
[30;1m124 | [0m[35m	kb = h('E58F9EB643862C13AD38E529313462A7F73E62834FE54A01')[0m
[30;1m125 | [0m[35m	k1 = string_to_key(Enctype.DES3, 'key1'.encode(), 'key1'.encode())[0m
[30;1m126 | [0m[35m	k2 = string_to_key(Enctype.DES3, 'key2'.encode(), 'key2'.encode())[0m
[30;1m127 | [0m[35m	k = cf2(Enctype.DES3, k1, k2, b'a', b'b')[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_encryption.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m115 | [0m[35m	kb = h('7A25DF8992296DCEDA0E135BC4046E2375B3C14C98FBC162')[0m
[30;1m116 | [0m[35m	keyusage = 2[0m
[30;1m117 | [0m[35m	plain = 'six seven'.encode()[0m
[30;1m118 | [0m[35m	cksum = h('0EEFC9C3E049AABC1BA5C401677D9AB699082BB4')[0m
[30;1m119 | [0m[35m	k = Key(Enctype.DES3, kb)[0m
[30;1m120 | [0m[35m	verify_checksum(Cksumtype.SHA1_DES3, k, keyusage, plain, cksum)[0m
[30;1m121 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_encryption.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35mdef test_des3_checksum():[0m
[30;1m114 | [0m[35m	# DES3 checksum[0m
[30;1m115 | [0m[35m	kb = h('7A25DF8992296DCEDA0E135BC4046E2375B3C14C98FBC162')[0m
[30;1m116 | [0m[35m	keyusage = 2[0m
[30;1m117 | [0m[35m	plain = 'six seven'.encode()[0m
[30;1m118 | [0m[35m	cksum = h('0EEFC9C3E049AABC1BA5C401677D9AB699082BB4')[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_encryption.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m106 | [0m[35m	# DES3 string-to-key[0m
[30;1m107 | [0m[35m	string = 'password'.encode()[0m
[30;1m108 | [0m[35m	salt = 'ATHENA.MIT.EDUraeburn'.encode()[0m
[30;1m109 | [0m[35m	kb = h('850BB51358548CD05E86768C313E3BFEF7511937DCF72C3E')[0m
[30;1m110 | [0m[35m	k = string_to_key(Enctype.DES3, string, salt)[0m
[30;1m111 | [0m[35m	assert(k.contents == kb)[0m
[30;1m112 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_encryption.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m96 | [0m[35m	conf = h('94690A17B2DA3C9B')[0m
[30;1m97 | [0m[35m	keyusage = 3[0m
[30;1m98 | [0m[35m	plain = b'13 bytes byte'[0m
[30;1m99 | [0m[35m	ctxt = h('839A17081ECBAFBCDC91B88C6955DD3C4514023CF177B77BF0D0177A16F705E8'[0m
[30;1m100 | [0m[35m			 '49CB7781D76A316B193F8D30')[0m
[30;1m101 | [0m[35m	k = Key(Enctype.DES3, kb)[0m
[30;1m102 | [0m[35m	assert(encrypt(k, keyusage, plain, conf) == ctxt)[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_encryption.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35mdef test_des3_encrypt_decrypt():[0m
[30;1m94 | [0m[35m	# DES3 encrypt and decrypt[0m
[30;1m95 | [0m[35m	kb = h('0DD52094E0F41CECCB5BE510A764B35176E3981332F1E598')[0m
[30;1m96 | [0m[35m	conf = h('94690A17B2DA3C9B')[0m
[30;1m97 | [0m[35m	keyusage = 3[0m
[30;1m98 | [0m[35m	plain = b'13 bytes byte'[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_encryption.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35mdef test_aes256_cf2():[0m
[30;1m86 | [0m[35m	# AES256 cf2[0m
[30;1m87 | [0m[35m	kb = h('4D6CA4E629785C1F01BAF55E2E548566B9617AE3A96868C337CB93B5E72B1C7B')[0m
[30;1m88 | [0m[35m	k1 = string_to_key(Enctype.AES256, 'key1'.encode(), 'key1'.encode())[0m
[30;1m89 | [0m[35m	k2 = string_to_key(Enctype.AES256, 'key2'.encode(), 'key2'.encode())[0m
[30;1m90 | [0m[35m	k = cf2(Enctype.AES256, k1, k2, b'a', b'b')[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_encryption.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m58 | [0m[35m	string = b'X' * 64[0m
[30;1m59 | [0m[35m	salt = 'pass phrase equals block size'.encode()[0m
[30;1m60 | [0m[35m	params = h('000004B0')[0m
[30;1m61 | [0m[35m	kb = h('89ADEE3608DB8BC71F1BFBFE459486B05618B70CBAE22092534E56C553BA4B34')[0m
[30;1m62 | [0m[35m	k = string_to_key(Enctype.AES256, string, salt, params)[0m
[30;1m63 | [0m[35m	assert(k.contents == kb)[0m
[30;1m64 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_encryption.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35mdef test_aes256_checksum():[0m
[30;1m39 | [0m[35m	# AES256 checksum[0m
[30;1m40 | [0m[35m	kb = h('B1AE4CD8462AFF1677053CC9279AAC30B796FB81CE21474DD3DDBCFEA4EC76D7')[0m
[30;1m41 | [0m[35m	keyusage = 4[0m
[30;1m42 | [0m[35m	plain = 'fourteen'.encode()[0m
[30;1m43 | [0m[35m	cksum = h('E08739E3279E2903EC8E3836')[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_encryption.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m21 | [0m[35m	keyusage = 4[0m
[30;1m22 | [0m[35m	plain = '30 bytes bytes bytes bytes byt'.encode()[0m
[30;1m23 | [0m[35m	ctxt = h('D1137A4D634CFECE924DBC3BF6790648BD5CFF7DE0E7B99460211D0DAEF3D79A'[0m
[30;1m24 | [0m[35m			 '295C688858F3B34B9CBD6EEBAE81DAF6B734D4D498B6714F1C1D')[0m
[30;1m25 | [0m[35m	k = Key(Enctype.AES256, kb)[0m
[30;1m26 | [0m[35m	assert(encrypt(k, keyusage, plain, conf) == ctxt)[0m
[30;1m27 | [0m[35m	assert(decrypt(k, keyusage, ctxt) == plain)[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_encryption.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m20 | [0m[35m	conf = h('E45CA518B42E266AD98E165E706FFB60')[0m
[30;1m21 | [0m[35m	keyusage = 4[0m
[30;1m22 | [0m[35m	plain = '30 bytes bytes bytes bytes byt'.encode()[0m
[30;1m23 | [0m[35m	ctxt = h('D1137A4D634CFECE924DBC3BF6790648BD5CFF7DE0E7B99460211D0DAEF3D79A'[0m
[30;1m24 | [0m[35m			 '295C688858F3B34B9CBD6EEBAE81DAF6B734D4D498B6714F1C1D')[0m
[30;1m25 | [0m[35m	k = Key(Enctype.AES256, kb)[0m
[30;1m26 | [0m[35m	assert(encrypt(k, keyusage, plain, conf) == ctxt)[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_encryption.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mdef test_encdec_aes256():[0m
[30;1m18 | [0m[35m	# AES256 encrypt and decrypt[0m
[30;1m19 | [0m[35m	kb = h('F1C795E9248A09338D82C3F8D5B567040B0110736845041347235B1404231398')[0m
[30;1m20 | [0m[35m	conf = h('E45CA518B42E266AD98E165E706FFB60')[0m
[30;1m21 | [0m[35m	keyusage = 4[0m
[30;1m22 | [0m[35m	plain = '30 bytes bytes bytes bytes byt'.encode()[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_encryption.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m8 | [0m[35m	conf = h('94B491F481485B9A0678CD3C4EA386AD')[0m
[30;1m9 | [0m[35m	keyusage = 2[0m
[30;1m10 | [0m[35m	plain = '9 bytesss'.encode()[0m
[30;1m11 | [0m[35m	ctxt = h('68FB9679601F45C78857B2BF820FD6E53ECA8D42FD4B1D7024A09205ABB7CD2E'[0m
[30;1m12 | [0m[35m			 'C26C355D2F')[0m
[30;1m13 | [0m[35m	k = Key(Enctype.AES128, kb)[0m
[30;1m14 | [0m[35m	assert(encrypt(k, keyusage, plain, conf) == ctxt)[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m97 | [0m[35m	cred.domain = 'domain'[0m
[30;1m98 | [0m[35m	cred.username = 'user'	[0m
[30;1m99 | [0m[35m	with pytest.raises(Exception) as e_info:[0m
[30;1m100 | [0m[35m		cred.add_secret(KerberosSecretType.AES, '921a7fece11f4d8c732e41e40d0372921a7fece11f4d8c72432e41e40[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35mdef test_addsecret_des():[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m90 | [0m[35m	cred.domain = 'domain'[0m
[30;1m91 | [0m[35m	cred.username = 'user'[0m
[30;1m92 | [0m[35m	cred.add_secret(KerberosSecretType.AES, '921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e41e4[0m
[30;1m93 | [0m[35m	assert cred.kerberos_key_aes_256 == '921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e41e40d03[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35mdef test_addsecret_aes_wrong():[0m
[30;1m96 | [0m[35m	cred = KerberosCredential()[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m89 | [0m[35m	cred = KerberosCredential()[0m
[30;1m90 | [0m[35m	cred.domain = 'domain'[0m
[30;1m91 | [0m[35m	cred.username = 'user'[0m
[30;1m92 | [0m[35m	cred.add_secret(KerberosSecretType.AES, '921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e41e4[0m
[30;1m93 | [0m[35m	assert cred.kerberos_key_aes_256 == '921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e41e40d03[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35mdef test_addsecret_aes_wrong():[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m74 | [0m[35m	cred.add_secret(KerberosSecretType.AES256, '921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e4[0m
[30;1m75 | [0m[35m	assert cred.kerberos_key_aes_256 == '921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e41e40d03[0m
[30;1m76 | [0m[35m	ret = cred.get_key_for_enctype(EncryptionType.AES256_CTS_HMAC_SHA1_96)[0m
[30;1m77 | [0m[35m	assert ret == bytes.fromhex('921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e41e40d0372')[0m
[30;1m78 | [0m[35m	with pytest.raises(Exception):[0m
[30;1m79 | [0m[35m		ret = cred.get_key_for_enctype(EncryptionType.AES128_CTS_HMAC_SHA1_96)[0m
[30;1m80 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m72 | [0m[35m	cred.domain = 'domain'[0m
[30;1m73 | [0m[35m	cred.username = 'user'[0m
[30;1m74 | [0m[35m	cred.add_secret(KerberosSecretType.AES256, '921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e4[0m
[30;1m75 | [0m[35m	assert cred.kerberos_key_aes_256 == '921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e41e40d03[0m
[30;1m76 | [0m[35m	ret = cred.get_key_for_enctype(EncryptionType.AES256_CTS_HMAC_SHA1_96)[0m
[30;1m77 | [0m[35m	assert ret == bytes.fromhex('921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e41e40d0372')[0m
[30;1m78 | [0m[35m	with pytest.raises(Exception):[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m71 | [0m[35m	cred = KerberosCredential()[0m
[30;1m72 | [0m[35m	cred.domain = 'domain'[0m
[30;1m73 | [0m[35m	cred.username = 'user'[0m
[30;1m74 | [0m[35m	cred.add_secret(KerberosSecretType.AES256, '921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e4[0m
[30;1m75 | [0m[35m	assert cred.kerberos_key_aes_256 == '921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e41e40d03[0m
[30;1m76 | [0m[35m	ret = cred.get_key_for_enctype(EncryptionType.AES256_CTS_HMAC_SHA1_96)[0m
[30;1m77 | [0m[35m	assert ret == bytes.fromhex('921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e41e40d0372')[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m65 | [0m[35m	cred.add_secret(KerberosSecretType.AES256, '921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e4[0m
[30;1m66 | [0m[35m	assert cred.kerberos_key_aes_256 == '921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e41e40d03[0m
[30;1m67 | [0m[35m	ret = cred.get_key_for_enctype(EncryptionType.AES256_CTS_HMAC_SHA1_96)[0m
[30;1m68 | [0m[35m	assert ret == bytes.fromhex('921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e41e40d0372')[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35mdef test_addsecret_aes256_wrongtype():[0m
[30;1m71 | [0m[35m	cred = KerberosCredential()[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m63 | [0m[35m	cred.domain = 'domain'[0m
[30;1m64 | [0m[35m	cred.username = 'user'[0m
[30;1m65 | [0m[35m	cred.add_secret(KerberosSecretType.AES256, '921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e4[0m
[30;1m66 | [0m[35m	assert cred.kerberos_key_aes_256 == '921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e41e40d03[0m
[30;1m67 | [0m[35m	ret = cred.get_key_for_enctype(EncryptionType.AES256_CTS_HMAC_SHA1_96)[0m
[30;1m68 | [0m[35m	assert ret == bytes.fromhex('921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e41e40d0372')[0m
[30;1m69 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m62 | [0m[35m	cred = KerberosCredential()[0m
[30;1m63 | [0m[35m	cred.domain = 'domain'[0m
[30;1m64 | [0m[35m	cred.username = 'user'[0m
[30;1m65 | [0m[35m	cred.add_secret(KerberosSecretType.AES256, '921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e4[0m
[30;1m66 | [0m[35m	assert cred.kerberos_key_aes_256 == '921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e41e40d03[0m
[30;1m67 | [0m[35m	ret = cred.get_key_for_enctype(EncryptionType.AES256_CTS_HMAC_SHA1_96)[0m
[30;1m68 | [0m[35m	assert ret == bytes.fromhex('921a7fece11f4d8c72432e41e40d0372921a7fece11f4d8c72432e41e40d0372')[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/ndr.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1675 | [0m[35m[0m
[30;1m1676 | [0m[35m        return offset - offset0[0m
[30;1m1677 | [0m[35m[0m
[30;1m1678 | [0m[35m# Top Level Struct == NDRCALL[0m
[30;1m1679 | [0m[35mNDRTLSTRUCT = NDRCALL[0m
[30;1m1680 | [0m[35m[0m
[30;1m1681 | [0m[35mclass UNKNOWNDATA(NDR):[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/ndr.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1635 | [0m[35m                soFar = soFar0 + len(data)[0m
[30;1m1636 | [0m[35m                # Any referent information to pack?[0m
[30;1m1637 | [0m[35m                # I'm still not sure whether this should go after processing[0m
[30;1m1638 | [0m[35m                # all the fields at the call level.[0m
[30;1m1639 | [0m[35m                # Guess we'll figure it out testing.[0m
[30;1m1640 | [0m[35m                if isinstance(self.fields[fieldName], NDRCONSTRUCTEDTYPE):[0m
[30;1m1641 | [0m[35m                    data += self.fields[fieldName].getDataReferents(soFar)[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/ndr.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1067 | [0m[35m        # A structure can contain a conformant and varying array only as its last member.[0m
[30;1m1068 | [0m[35m        # In the NDR representation of a structure that contains a conformant and varying array, [0m
[30;1m1069 | [0m[35m        # the maximum counts for dimensions of the array are moved to the beginning of the structure[0m
[30;1m1070 | [0m[35m        # but the offsets and actual counts remain in place at the end of the structure, [0m
[30;1m1071 | [0m[35m        # immediately preceding the array elements[0m
[30;1m1072 | [0m[35m        lastItem = (self.commonHdr+self.structure)[-1][0][0m
[30;1m1073 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/ndr.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1061 | [0m[35m        # A structure can contain a conformant array only as its last member.[0m
[30;1m1062 | [0m[35m        # In the NDR representation of a structure that contains a conformant array, [0m
[30;1m1063 | [0m[35m        # the unsigned long integers that give maximum element counts for dimensions of the array [0m
[30;1m1064 | [0m[35m        # are moved to the beginning of the structure, and the array elements appear in place at [0m
[30;1m1065 | [0m[35m        # the end of the structure.[0m
[30;1m1066 | [0m[35m        # 14.3.7.2 Structures Containing a Conformant and Varying Array[0m
[30;1m1067 | [0m[35m        # A structure can contain a conformant and varying array only as its last member.[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/ndr.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m966 | [0m[35m varying array only as its last member.[0m
[30;1m967 | [0m[35m        # In the NDR representation of a structure that contains a conformant and varying array, [0m
[30;1m968 | [0m[35m        # the maximum counts for dimensions of the array are moved to the beginning of the structure[0m
[30;1m969 | [0m[35m        # but the offsets and actual counts remain in place at the end of the structure, [0m
[30;1m970 | [0m[35m        # immediately preceding the array elements[0m
[30;1m971 | [0m[35m        lastItem = (self.commonHdr+self.structure)[-1][0][0m
[30;1m972 | [0m[35m        if isinstance(self.fields[lastItem], NDRUniConformantArray) or isinstance(self.fields[lastIt[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/ndr.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m960 | [0m[35m        # A structure can contain a conformant array only as its last member.[0m
[30;1m961 | [0m[35m        # In the NDR representation of a structure that contains a conformant array, [0m
[30;1m962 | [0m[35m        # the unsigned long integers that give maximum element counts for dimensions of the array [0m
[30;1m963 | [0m[35m        # are moved to the beginning of the structure, and the array elements appear in place at [0m
[30;1m964 | [0m[35m        # the end of the structure.[0m
[30;1m965 | [0m[35m        # 14.3.7.2 Structures Containing a Conformant and Varying Array[0m
[30;1m966 | [0m[35m        # A structure can contain a conformant and varying array only as its last member.[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/ndr.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m560 | [0m[35m        offset += pad[0m
[30;1m561 | [0m[35m[0m
[30;1m562 | [0m[35m        if isinstance(self.fields[fieldName], NDRUniConformantArray):[0m
[30;1m563 | [0m[35m            # Array Size is at the very beginning[0m
[30;1m564 | [0m[35m            arraySize = unpack_from(arrayUnPackStr, data, offset)[0][0m
[30;1m565 | [0m[35m        elif isinstance(self.fields[fieldName], NDRUniConformantVaryingArray):[0m
[30;1m566 | [0m[35m            # NDRUniConformantVaryingArray Array[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/ndr.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m219 | [0m[35m                # Alignment of Primitive Types[0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m                # NDR enforces NDR alignment of primitive data; that is, any primitive of size n[0m
[30;1m222 | [0m[35m                # octets is aligned at a octet stream index that is a multiple of n.[0m
[30;1m223 | [0m[35m                # (In this version of NDR, n is one of {1, 2, 4, 8}.) An octet stream index indicate[0m
[30;1m224 | [0m[35m                # the number of an octet in an octet stream when octets are numbered, beginning with[0m
[30;1m225 | [0m[35m                # from the first octet in the stream. Where necessary, an alignment gap, consisting [0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/ndr.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m190 | [0m[35m                # Alignment of Primitive Types[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m                # NDR enforces NDR alignment of primitive data; that is, any primitive of size n[0m
[30;1m193 | [0m[35m                # octets is aligned at a octet stream index that is a multiple of n.[0m
[30;1m194 | [0m[35m                # (In this version of NDR, n is one of {1, 2, 4, 8}.) An octet stream index indicate[0m
[30;1m195 | [0m[35m                # the number of an octet in an octet stream when octets are numbered, beginning with[0m
[30;1m196 | [0m[35m                # from the first octet in the stream. Where necessary, an alignment gap, consisting [0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/CVE_2022_33647.py[0m
   Pattern: [32m.hostname[0m
[30;1m303 | [0m[35m	parser.add_argument('dcip', help='IP/hostname of the domain controller')[0m
[30;1m304 | [0m[35m	parser.add_argument('--dc-port', default=88, type=int, help='Port of the Kerberos service on the DC[0m
[30;1m305 | [0m[35m	parser.add_argument('--listen-ip', default='127.0.0.1', help='IP/hostname to listen for incoming ke[0m
[30;1m306 | [0m[35m	parser.add_argument('--listen-port', default=88, type=int, help='IP/hostname to listen for incoming[0m
[30;1m307 | [0m[35m	args = parser.parse_args()[0m
[30;1m308 | [0m[35m[0m
[30;1m309 | [0m[35m	kp = KerberosProxy(args.dcip, args.listen_ip, args.dc_port, args.listen_port)[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/CVE_2022_33647.py[0m
   Pattern: [32m.hostname[0m
[30;1m302 | [0m[35m	parser = argparse.ArgumentParser(description='Kerberos proxy to exploit CVE-2022-33647')[0m
[30;1m303 | [0m[35m	parser.add_argument('dcip', help='IP/hostname of the domain controller')[0m
[30;1m304 | [0m[35m	parser.add_argument('--dc-port', default=88, type=int, help='Port of the Kerberos service on the DC[0m
[30;1m305 | [0m[35m	parser.add_argument('--listen-ip', default='127.0.0.1', help='IP/hostname to listen for incoming ke[0m
[30;1m306 | [0m[35m	parser.add_argument('--listen-port', default=88, type=int, help='IP/hostname to listen for incoming[0m
[30;1m307 | [0m[35m	args = parser.parse_args()[0m
[30;1m308 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/CVE_2022_33647.py[0m
   Pattern: [32m.hostname[0m
[30;1m300 | [0m[35masync def amain():[0m
[30;1m301 | [0m[35m	import argparse[0m
[30;1m302 | [0m[35m	parser = argparse.ArgumentParser(description='Kerberos proxy to exploit CVE-2022-33647')[0m
[30;1m303 | [0m[35m	parser.add_argument('dcip', help='IP/hostname of the domain controller')[0m
[30;1m304 | [0m[35m	parser.add_argument('--dc-port', default=88, type=int, help='Port of the Kerberos service on the DC[0m
[30;1m305 | [0m[35m	parser.add_argument('--listen-ip', default='127.0.0.1', help='IP/hostname to listen for incoming ke[0m
[30;1m306 | [0m[35m	parser.add_argument('--listen-port', default=88, type=int, help='IP/hostname to listen for incoming[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/CVE_2022_33647.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m212 | [0m[35m					raise err[0m
[30;1m213 | [0m[35m				return[0m
[30;1m214 | [0m[35m			[0m
[30;1m215 | [0m[35m			print('[+] Connecting to DC at %s:%s' % (self.dc_ip, self.dc_port))[0m
[30;1m216 | [0m[35m			dcreader, dcwriter = await asyncio.open_connection(self.dc_ip, self.dc_port)[0m
[30;1m217 | [0m[35m			print('[+] Connected to DC!')[0m
[30;1m218 | [0m[35m			print('[+] Modifying original AS-REQ...')[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/CVE_2022_33647.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m66 | [0m[35m	ti = {}[0m
[30;1m67 | [0m[35m	ti['ticket-info'] = [KrbCredInfo(ci)][0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m	te = {}[0m
[30;1m70 | [0m[35m	te['etype']  = 0[0m
[30;1m71 | [0m[35m	te['cipher'] = EncKrbCredPart(ti).dump()[0m
[30;1m72 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/CVE_2022_33647.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m301 | [0m[35m	import argparse[0m
[30;1m302 | [0m[35m	parser = argparse.ArgumentParser(description='Kerberos proxy to exploit CVE-2022-33647')[0m
[30;1m303 | [0m[35m	parser.add_argument('dcip', help='IP/hostname of the domain controller')[0m
[30;1m304 | [0m[35m	parser.add_argument('--dc-port', default=88, type=int, help='Port of the Kerberos service on the DC[0m
[30;1m305 | [0m[35m	parser.add_argument('--listen-ip', default='127.0.0.1', help='IP/hostname to listen for incoming ke[0m
[30;1m306 | [0m[35m	parser.add_argument('--listen-port', default=88, type=int, help='IP/hostname to listen for incoming[0m
[30;1m307 | [0m[35m	args = parser.parse_args()[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/CVE_2022_33647.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m160 | [0m[35m			[0m
[30;1m161 | [0m[35m			for padata in ticketnative['padata']:[0m
[30;1m162 | [0m[35m				if padata['padata-type'] == 2: #and padata[]:[0m
[30;1m163 | [0m[35m					ed = EncryptedData.load(padata['padata-value']).native[0m
[30;1m164 | [0m[35m					if ed['etype'] == -128:[0m
[30;1m165 | [0m[35m						enc_timestamp = ed['cipher'][24:][0m
[30;1m166 | [0m[35m						break[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/CVE_2022_33647.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35mimport asyncio[0m
[30;1m19 | [0m[35mimport traceback[0m
[30;1m20 | [0m[35mimport datetime[0m
[30;1m21 | [0m[35mimport base64[0m
[30;1m22 | [0m[35mfrom minikerberos.protocol.asn1_structs import KerberosMessage, \[0m
[30;1m23 | [0m[35m	METHOD_DATA, ETYPE_INFO, ETYPE_INFO2, PA_DATA, KRB_ERROR,\[0m
[30;1m24 | [0m[35m	PrincipalName, EncryptedData, HostAddress, AS_REQ, EncryptionKey,\[0m
[30;1m25 | [0m[35m	TicketFlags, KrbCredInfo, EncKrbCredPart, KRB_CRED[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/pkinit.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m		dd = DirtyDH()[0m
[30;1m65 | [0m[35m		dd.p = dhp['p'][0m
[30;1m66 | [0m[35m		dd.g = dhp['g'][0m
[30;1m67 | [0m[35m		return dd[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m	@staticmethod[0m
[30;1m70 | [0m[35m	def from_asn1(asn1_bytes):[0m
[30;1m71 | [0m[35m		dhp = algos.DHParameters.load(asn1_bytes).native[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/pkinit.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m	@staticmethod[0m
[30;1m63 | [0m[35m	def from_dict(dhp):[0m
[30;1m64 | [0m[35m		dd = DirtyDH()[0m
[30;1m65 | [0m[35m		dd.p = dhp['p'][0m
[30;1m66 | [0m[35m		dd.g = dhp['g'][0m
[30;1m67 | [0m[35m		return dd[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/pkinit.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m		dd = DirtyDH()[0m
[30;1m58 | [0m[35m		dd.p = p[0m
[30;1m59 | [0m[35m		dd.g = g[0m
[30;1m60 | [0m[35m		return dd[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m	@staticmethod[0m
[30;1m63 | [0m[35m	def from_dict(dhp):[0m
[30;1m64 | [0m[35m		dd = DirtyDH()[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/pkinit.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m	@staticmethod[0m
[30;1m56 | [0m[35m	def from_params(p, g):[0m
[30;1m57 | [0m[35m		dd = DirtyDH()[0m
[30;1m58 | [0m[35m		dd.p = p[0m
[30;1m59 | [0m[35m		dd.g = g[0m
[30;1m60 | [0m[35m		return dd[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/dirtydh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m		dd = DirtyDH()[0m
[30;1m24 | [0m[35m		dd.p = dhp['p'][0m
[30;1m25 | [0m[35m		dd.g = dhp['g'][0m
[30;1m26 | [0m[35m		return dd[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m	@staticmethod[0m
[30;1m29 | [0m[35m	def from_asn1(asn1_bytes):[0m
[30;1m30 | [0m[35m		dhp = algos.DHParameters.load(asn1_bytes).native[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/dirtydh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m	@staticmethod[0m
[30;1m22 | [0m[35m	def from_dict(dhp):[0m
[30;1m23 | [0m[35m		dd = DirtyDH()[0m
[30;1m24 | [0m[35m		dd.p = dhp['p'][0m
[30;1m25 | [0m[35m		dd.g = dhp['g'][0m
[30;1m26 | [0m[35m		return dd[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/dirtydh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m		dd = DirtyDH()[0m
[30;1m17 | [0m[35m		dd.p = p[0m
[30;1m18 | [0m[35m		dd.g = g[0m
[30;1m19 | [0m[35m		return dd[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m	@staticmethod[0m
[30;1m22 | [0m[35m	def from_dict(dhp):[0m
[30;1m23 | [0m[35m		dd = DirtyDH()[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/dirtydh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m	@staticmethod[0m
[30;1m15 | [0m[35m	def from_params(p, g):[0m
[30;1m16 | [0m[35m		dd = DirtyDH()[0m
[30;1m17 | [0m[35m		dd.p = p[0m
[30;1m18 | [0m[35m		dd.g = g[0m
[30;1m19 | [0m[35m		return dd[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m	PRINCIPAL = 1     #(1),	-- Just the name of the principal as in[0m
[30;1m6 | [0m[35m	SRV_INST = 2     #(2),	-- Service and other unique instance (krbtgt)[0m
[30;1m7 | [0m[35m	SRV_HST = 3     #(3),	-- Service with host name as instance[0m
[30;1m8 | [0m[35m	SRV_XHST = 4     # (4),	-- Service with host as remaining components[0m
[30;1m9 | [0m[35m	UID = 5     # (5),		-- Unique ID[0m
[30;1m10 | [0m[35m	X500_PRINCIPAL = 6     #(6), -- PKINIT[0m
[30;1m11 | [0m[35m	SMTP_NAME = 7     #(7),	-- Name in form of SMTP email name[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m	UNKNOWN = 0     #(0),	-- Name type not known[0m
[30;1m5 | [0m[35m	PRINCIPAL = 1     #(1),	-- Just the name of the principal as in[0m
[30;1m6 | [0m[35m	SRV_INST = 2     #(2),	-- Service and other unique instance (krbtgt)[0m
[30;1m7 | [0m[35m	SRV_HST = 3     #(3),	-- Service with host name as instance[0m
[30;1m8 | [0m[35m	SRV_XHST = 4     # (4),	-- Service with host as remaining components[0m
[30;1m9 | [0m[35m	UID = 5     # (5),		-- Unique ID[0m
[30;1m10 | [0m[35m	X500_PRINCIPAL = 6     #(6), -- PKINIT[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mclass NAME_TYPE(enum.Enum):[0m
[30;1m4 | [0m[35m	UNKNOWN = 0     #(0),	-- Name type not known[0m
[30;1m5 | [0m[35m	PRINCIPAL = 1     #(1),	-- Just the name of the principal as in[0m
[30;1m6 | [0m[35m	SRV_INST = 2     #(2),	-- Service and other unique instance (krbtgt)[0m
[30;1m7 | [0m[35m	SRV_HST = 3     #(3),	-- Service with host name as instance[0m
[30;1m8 | [0m[35m	SRV_XHST = 4     # (4),	-- Service with host as remaining components[0m
[30;1m9 | [0m[35m	UID = 5     # (5),		-- Unique ID[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/spn.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mclass KerberosSPN:[0m
[30;1m4 | [0m[35m	def __init__(self):[0m
[30;1m5 | [0m[35m		self.username = None[0m
[30;1m6 | [0m[35m		self.service  = None #the service we are trying to get a ticket for (eg. cifs/mssql...)[0m
[30;1m7 | [0m[35m		self.domain   = None #the kerberos realm[0m
[30;1m8 | [0m[35m		[0m
[30;1m9 | [0m[35m	# https://docs.microsoft.com/en-us/windows/desktop/ad/name-formats-for-unique-spns[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/CVE_2022_33679.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m98 | [0m[35m	ti = {}[0m
[30;1m99 | [0m[35m	ti['ticket-info'] = [KrbCredInfo(ci)][0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m	te = {}[0m
[30;1m102 | [0m[35m	te['etype']  = 0[0m
[30;1m103 | [0m[35m	te['cipher'] = EncKrbCredPart(ti).dump()[0m
[30;1m104 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/CVE_2022_33679.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m132 | [0m[35m	keystream = byte_xor(cipher_data_header, plaintext_data)[0m
[30;1m133 | [0m[35m	print('[+] PARTIAL KEYSTREAM : %s' % keystream.hex())[0m
[30;1m134 | [0m[35m	[0m
[30;1m135 | [0m[35m	# verifying the guessed partial keystream by requesting a TGT but this time with pre-auth[0m
[30;1m136 | [0m[35m	# the pre-auth will need the encrypted timestamp which we can forge with the partial keystream [0m
[30;1m137 | [0m[35m	print('[+] VERIFYING KEYSTREAM...')[0m
[30;1m138 | [0m[35m	print('[i] TIMESTAMP    : %s' % timestamp.hex())[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/CVE_2022_33679.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35mimport datetime[0m
[30;1m19 | [0m[35mimport logging[0m
[30;1m20 | [0m[35mimport asyncio[0m
[30;1m21 | [0m[35mimport base64[0m
[30;1m22 | [0m[35mfrom minikerberos.common.factory import KerberosClientFactory, kerberos_url_help_epilog[0m
[30;1m23 | [0m[35mfrom minikerberos.aioclient import AIOKerberosClient[0m
[30;1m24 | [0m[35mfrom minikerberos.protocol.constants import EncryptionType[0m
[30;1m25 | [0m[35mfrom minikerberos.protocol.encryption import Key, _enctype_table[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/kerb23hashdecrypt.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m			ki = HMAC.new(pwhash, keyusage, MD5).digest()[0m
[30;1m71 | [0m[35m			ke = HMAC.new(ki, checksum, MD5).digest()[0m
[30;1m72 | [0m[35m			# at this point you can add some optimizations to make it faster,[0m
[30;1m73 | [0m[35m			# but honestly I don't think it's needed[0m
[30;1m74 | [0m[35m			basic_plaintext = ARC4(ke).decrypt(edata)[0m
[30;1m75 | [0m[35m			exp_cksum = HMAC.new(ki, basic_plaintext, MD5).digest()[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/kerb23hashdecrypt.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m			ki = HMAC.new(pwhash, keyusage, MD5).digest()[0m
[30;1m30 | [0m[35m			ke = HMAC.new(ki, checksum, MD5).digest()[0m
[30;1m31 | [0m[35m			# at this point you can add some optimizations to make it faster,[0m
[30;1m32 | [0m[35m			# but honestly I don't think it's needed, it's Python so it will be slow anyhow[0m
[30;1m33 | [0m[35m			basic_plaintext = ARC4(ke).decrypt(edata)[0m
[30;1m34 | [0m[35m			exp_cksum = HMAC.new(ki, basic_plaintext, MD5).digest()[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/keytab.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35m# https://web.mit.edu/kerberos/krb5-1.12/doc/formats/keytab_file_format.html[0m
[30;1m8 | [0m[35m#[0m
[30;1m9 | [0m[35m# Be careful using this parser/writer! The specifications in the MIT Kerberos's official page doesnt[0m
[30;1m10 | [0m[35m# Thus this script is to support Windows generated keytabs, not sure about MIT's[0m
[30;1m11 | [0m[35mfrom __future__ import annotations[0m
[30;1m12 | [0m[35mimport io[0m
[30;1m13 | [0m[35mfrom typing import List[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/asreproast.py[0m
   Pattern: [32m.hostname[0m
[30;1m73 | [0m[35m	import argparse[0m
[30;1m74 | [0m[35m	[0m
[30;1m75 | [0m[35m	parser = argparse.ArgumentParser(description='Asreproast', formatter_class=argparse.RawDescriptionH[0m
[30;1m76 | [0m[35m	parser.add_argument('kerberos_server', help='Kerberos server IP or hostname')[0m
[30;1m77 | [0m[35m	parser.add_argument('domain', help='Realm. Use this if you specify username in "spn" field')[0m
[30;1m78 | [0m[35m	parser.add_argument('users', nargs ='*', help='User/username to kerberoast. Can be a file with user[0m
[30;1m79 | [0m[35m	parser.add_argument('-e', '--etypes', default='23,17,18', help='Encryption types to use. Default: 2[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/asreproast.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m73 | [0m[35m	import argparse[0m
[30;1m74 | [0m[35m	[0m
[30;1m75 | [0m[35m	parser = argparse.ArgumentParser(description='Asreproast', formatter_class=argparse.RawDescriptionH[0m
[30;1m76 | [0m[35m	parser.add_argument('kerberos_server', help='Kerberos server IP or hostname')[0m
[30;1m77 | [0m[35m	parser.add_argument('domain', help='Realm. Use this if you specify username in "spn" field')[0m
[30;1m78 | [0m[35m	parser.add_argument('users', nargs ='*', help='User/username to kerberoast. Can be a file with user[0m
[30;1m79 | [0m[35m	parser.add_argument('-e', '--etypes', default='23,17,18', help='Encryption types to use. Default: 2[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/README.md[0m
   Pattern: [32m.hostname[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m## minikerberos-getTGS[0m
[30;1m42 | [0m[35mFetches an TGS ticket (TGSREP) for the given cerberos credential and SPN record.  [0m
[30;1m43 | [0m[35mSPN must be in `service/hostname@FQDN` format.[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m## minikerberos-kerberoast[0m
[30;1m46 | [0m[35mAlso known as SPNRoast, this tool performs a kerberoast attack against one or multiple users, using [0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m`minikerberos` comes with examples which can be used to perform the usual pentest activities out-of-[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m# Examples AKA the pentest tools[0m
[30;1m36 | [0m[35mInstalling `minikerberos` module via pip will automatically place all examples in the `Scripts` dire[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m## minikerberos-getTGT[0m
[30;1m39 | [0m[35mFetches a TGT for the given kerberos credential. The kredential must be in a standard `kerberos URL`[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35mor with `pip` from the Python Package Index (PyPI).[0m
[30;1m22 | [0m[35m  [0m
[30;1m23 | [0m[35m```bash[0m
[30;1m24 | [0m[35m$ pip install minikerberos --user[0m
[30;1m25 | [0m[35m```[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35mConsider to use a Python virtual environment.[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35mInstall it via either cloning it from GitHub and using  [0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m```bash[0m
[30;1m16 | [0m[35m$ git clone https://github.com/skelsec/minikerberos.git[0m
[30;1m17 | [0m[35m$ cd minikerberos[0m
[30;1m18 | [0m[35m$ python3 setup.py install[0m
[30;1m19 | [0m[35m```  [0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m# minikerberos[0m
[30;1m9 | [0m[35m`minikerberos` is a kerberos client library written in `Python>=3.6` it is the kerberos library used[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m## Installation[0m
[30;1m12 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_ccache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m156 | [0m[35m	assert dt.usec_offset == dt2.usec_offset[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35mdef test_times():[0m
[30;1m159 | [0m[35m	time = Times.dummy_time()[0m
[30;1m160 | [0m[35m	time2 = Times.from_bytes(time.to_bytes())[0m
[30;1m161 | [0m[35m	assert time.starttime == time2.starttime[0m
[30;1m162 | [0m[35m	assert time.endtime == time2.endtime[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_ccache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# tests for ccache file[0m
[30;1m2 | [0m[35mimport pathlib[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mimport tempfile[0m
[30;1m5 | [0m[35mfrom minikerberos.common.kirbi import Kirbi[0m
[30;1m6 | [0m[35mfrom minikerberos.common.ccache import CCACHE, Header, DateTime, Times,\[0m
[30;1m7 | [0m[35m	Address, CCACHEOctetString, Authdata, Credential[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/windows/defines.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m578 | [0m[35m# Error codes[0m
[30;1m579 | [0m[35m# TODO maybe add more error codes?[0m
[30;1m580 | [0m[35m# if they're too many they could be pickled instead,[0m
[30;1m581 | [0m[35m# or at the very least put in a new file[0m
[30;1m582 | [0m[35mERROR_SUCCESS                       = 0[0m
[30;1m583 | [0m[35mERROR_INVALID_FUNCTION              = 1[0m
[30;1m584 | [0m[35mERROR_FILE_NOT_FOUND                = 2[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/windows/defines.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m268 | [0m[35m            # Use the W version[0m
[30;1m269 | [0m[35m            fn = self.fn_unicode[0m
[30;1m270 | [0m[35m[0m
[30;1m271 | [0m[35m        # If at least one argument is an ANSI string,[0m
[30;1m272 | [0m[35m        # but there are no Unicode strings...[0m
[30;1m273 | [0m[35m        elif t_ansi in v_types:[0m
[30;1m274 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/windows/defines.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m251 | [0m[35m        else:[0m
[30;1m252 | [0m[35m            fn = self.fn_unicode[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m        # If at least one argument is a Unicode string...[0m
[30;1m255 | [0m[35m        if self.t_unicode in v_types:[0m
[30;1m256 | [0m[35m[0m
[30;1m257 | [0m[35m            # If al least one argument is an ANSI string,[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/rfc3244.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m	[0m
[30;1m98 | [0m[35m	def __str__(self):[0m
[30;1m99 | [0m[35m		t = '=== KRB5CHPWReply ===\r\n'[0m
[30;1m100 | [0m[35m		t += 'Result code: %s %s \r\n' % (self.result_code, KRB5CHPWResultCode.get(self.result_code, 'Unkn[0m
[30;1m101 | [0m[35m		t += 'Result message: %s\r\n' % self.result_message[0m
[30;1m102 | [0m[35m		t += 'Password minimum length: %s\r\n' % self.pw_min_length[0m
[30;1m103 | [0m[35m		t += 'Password history: %s\r\n' % self.pw_history[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/asn1_structs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m425 | [0m[35m	][0m
[30;1m426 | [0m[35m[0m
[30;1m427 | [0m[35m[0m
[30;1m428 | [0m[35mclass PA_DATA(core.Sequence): #!!!! IT STARTS AT ONE!!!![0m
[30;1m429 | [0m[35m	_fields = [[0m
[30;1m430 | [0m[35m		('padata-type', core.Integer, {'tag_type': TAG, 'tag': 1}),[0m
[30;1m431 | [0m[35m		('padata-value', core.OctetString, {'tag_type': TAG, 'tag': 2}),[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/asn1_structs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m613 | [0m[35m[0m
[30;1m614 | [0m[35mclass PA_ENC_TS_ENC(core.Sequence):[0m
[30;1m615 | [0m[35m	_fields = [[0m
[30;1m616 | [0m[35m		('patimestamp', KerberosTime, {'tag_type': TAG, 'tag': 0}), #-- client's time[0m
[30;1m617 | [0m[35m		('pausec', krb5int32, {'tag_type': TAG, 'tag': 1, 'optional':True}),[0m
[30;1m618 | [0m[35m	][0m
[30;1m619 | [0m[35m[0m
[30;1m620 | [0m[35m#-- draft-brezak-win2k-krb-authz-01[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/asn1_structs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m328 | [0m[35m		4 : 'RENEWAL', #4),		-- time of last renewal[0m
[30;1m329 | [0m[35m		5 : 'REQUEST', #5),		-- time of last request ', #of any type)[0m
[30;1m330 | [0m[35m		6 : 'PW_EXPTIME', #6),	-- expiration time of password[0m
[30;1m331 | [0m[35m		7 : 'ACCT_EXPTIME', #7)	-- expiration time of account[0m
[30;1m332 | [0m[35m	}[0m
[30;1m333 | [0m[35m	[0m
[30;1m334 | [0m[35mclass LastReqInner(core.Sequence):[0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/asn1_structs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m327 | [0m[35m		3 : 'ISSUE_USE_TGT', #3),	-- time of newest TGT used[0m
[30;1m328 | [0m[35m		4 : 'RENEWAL', #4),		-- time of last renewal[0m
[30;1m329 | [0m[35m		5 : 'REQUEST', #5),		-- time of last request ', #of any type)[0m
[30;1m330 | [0m[35m		6 : 'PW_EXPTIME', #6),	-- expiration time of password[0m
[30;1m331 | [0m[35m		7 : 'ACCT_EXPTIME', #7)	-- expiration time of account[0m
[30;1m332 | [0m[35m	}[0m
[30;1m333 | [0m[35m	[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/asn1_structs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m326 | [0m[35m		2 : 'INITIAL', #2),		-- last initial request[0m
[30;1m327 | [0m[35m		3 : 'ISSUE_USE_TGT', #3),	-- time of newest TGT used[0m
[30;1m328 | [0m[35m		4 : 'RENEWAL', #4),		-- time of last renewal[0m
[30;1m329 | [0m[35m		5 : 'REQUEST', #5),		-- time of last request ', #of any type)[0m
[30;1m330 | [0m[35m		6 : 'PW_EXPTIME', #6),	-- expiration time of password[0m
[30;1m331 | [0m[35m		7 : 'ACCT_EXPTIME', #7)	-- expiration time of account[0m
[30;1m332 | [0m[35m	}[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/asn1_structs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m325 | [0m[35m		1 : 'INITIAL_TGT', #1),	-- last initial TGT request[0m
[30;1m326 | [0m[35m		2 : 'INITIAL', #2),		-- last initial request[0m
[30;1m327 | [0m[35m		3 : 'ISSUE_USE_TGT', #3),	-- time of newest TGT used[0m
[30;1m328 | [0m[35m		4 : 'RENEWAL', #4),		-- time of last renewal[0m
[30;1m329 | [0m[35m		5 : 'REQUEST', #5),		-- time of last request ', #of any type)[0m
[30;1m330 | [0m[35m		6 : 'PW_EXPTIME', #6),	-- expiration time of password[0m
[30;1m331 | [0m[35m		7 : 'ACCT_EXPTIME', #7)	-- expiration time of account[0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/asn1_structs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m324 | [0m[35m		0 : 'NONE', #0),		-- no information[0m
[30;1m325 | [0m[35m		1 : 'INITIAL_TGT', #1),	-- last initial TGT request[0m
[30;1m326 | [0m[35m		2 : 'INITIAL', #2),		-- last initial request[0m
[30;1m327 | [0m[35m		3 : 'ISSUE_USE_TGT', #3),	-- time of newest TGT used[0m
[30;1m328 | [0m[35m		4 : 'RENEWAL', #4),		-- time of last renewal[0m
[30;1m329 | [0m[35m		5 : 'REQUEST', #5),		-- time of last request ', #of any type)[0m
[30;1m330 | [0m[35m		6 : 'PW_EXPTIME', #6),	-- expiration time of password[0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/structures.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport io[0m
[30;1m2 | [0m[35mimport enum[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom minikerberos.protocol.asn1_structs import GSSAPIOID, GSSAPIToken[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m#https://tools.ietf.org/html/rfc4121#section-4.1.1.1[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/kirbi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m        if self.kirbiobj.native['enc-part']['etype'] == 0:[0m
[30;1m119 | [0m[35m            cred = EncKrbCredPart.load(self.kirbiobj.native['enc-part']['cipher']).native[0m
[30;1m120 | [0m[35m            cred = cred['ticket-info'][0][0m
[30;1m121 | [0m[35m            username = cred.get('pname')[0m
[30;1m122 | [0m[35m            if username is not None:[0m
[30;1m123 | [0m[35m                return '/'.join(username['name-string'])[0m
[30;1m124 | [0m[35m        return None[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/kirbi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m            t += 'UserRealm    : %s\r\n' % cred.get('prealm')[0m
[30;1m106 | [0m[35m            t += 'StartTime    : %s\r\n' % cred.get('starttime')[0m
[30;1m107 | [0m[35m            t += 'EndTime      : %s\r\n' % cred.get('endtime')[0m
[30;1m108 | [0m[35m            t += 'RenewTill    : %s\r\n' % cred.get('renew-till')[0m
[30;1m109 | [0m[35m            t += 'Flags        : %s\r\n' % flags[0m
[30;1m110 | [0m[35m            t += 'Keytype      : %s\r\n' % cred['key']['keytype'][0m
[30;1m111 | [0m[35m            t += 'Key          : %s\r\n' % base64.b64encode(cred['key']['keyvalue']).decode()[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/kirbi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m            t += 'UserName     : %s\r\n' % username[0m
[30;1m105 | [0m[35m            t += 'UserRealm    : %s\r\n' % cred.get('prealm')[0m
[30;1m106 | [0m[35m            t += 'StartTime    : %s\r\n' % cred.get('starttime')[0m
[30;1m107 | [0m[35m            t += 'EndTime      : %s\r\n' % cred.get('endtime')[0m
[30;1m108 | [0m[35m            t += 'RenewTill    : %s\r\n' % cred.get('renew-till')[0m
[30;1m109 | [0m[35m            t += 'Flags        : %s\r\n' % flags[0m
[30;1m110 | [0m[35m            t += 'Keytype      : %s\r\n' % cred['key']['keytype'][0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/kirbi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m            t += 'UserName     : %s\r\n' % username[0m
[30;1m105 | [0m[35m            t += 'UserRealm    : %s\r\n' % cred.get('prealm')[0m
[30;1m106 | [0m[35m            t += 'StartTime    : %s\r\n' % cred.get('starttime')[0m
[30;1m107 | [0m[35m            t += 'EndTime      : %s\r\n' % cred.get('endtime')[0m
[30;1m108 | [0m[35m            t += 'RenewTill    : %s\r\n' % cred.get('renew-till')[0m
[30;1m109 | [0m[35m            t += 'Flags        : %s\r\n' % flags[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/kirbi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m                flags = ', '.join(flags)[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m            t += 'UserName     : %s\r\n' % username[0m
[30;1m105 | [0m[35m            t += 'UserRealm    : %s\r\n' % cred.get('prealm')[0m
[30;1m106 | [0m[35m            t += 'StartTime    : %s\r\n' % cred.get('starttime')[0m
[30;1m107 | [0m[35m            t += 'EndTime      : %s\r\n' % cred.get('endtime')[0m
[30;1m108 | [0m[35m            t += 'RenewTill    : %s\r\n' % cred.get('renew-till')[0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/kirbi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m            username = cred.get('pname')[0m
[30;1m98 | [0m[35m            if username is not None:[0m
[30;1m99 | [0m[35m                username = '/'.join(username['name-string'])[0m
[30;1m100 | [0m[35m            flags = cred.get('flags')[0m
[30;1m101 | [0m[35m            if flags is not None:[0m
[30;1m102 | [0m[35m                flags = ', '.join(flags)[0m
[30;1m103 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/kirbi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m        if self.kirbiobj.native['enc-part']['etype'] == 0:[0m
[30;1m95 | [0m[35m            cred = EncKrbCredPart.load(self.kirbiobj.native['enc-part']['cipher']).native[0m
[30;1m96 | [0m[35m            cred = cred['ticket-info'][0][0m
[30;1m97 | [0m[35m            username = cred.get('pname')[0m
[30;1m98 | [0m[35m            if username is not None:[0m
[30;1m99 | [0m[35m                username = '/'.join(username['name-string'])[0m
[30;1m100 | [0m[35m            flags = cred.get('flags')[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/kirbi.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mfrom minikerberos.protocol.asn1_structs import KRBCRED, EncKrbCredPart, KrbCredInfo, EncryptedData[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mclass Kirbi:[0m
[30;1m5 | [0m[35m    def __init__(self, kirbiobj:KRBCRED = None):[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/kirbi.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m65 | [0m[35m        ti = {}[0m
[30;1m66 | [0m[35m        ti['ticket-info'] = [KrbCredInfo(ci)][0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m        te = {}[0m
[30;1m69 | [0m[35m        te['etype']  = 0[0m
[30;1m70 | [0m[35m        te['cipher'] = EncKrbCredPart(ti).dump()[0m
[30;1m71 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/setup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mif mo:[0m
[30;1m9 | [0m[35m    verstr = mo.group(1)[0m
[30;1m10 | [0m[35melse:[0m
[30;1m11 | [0m[35m    raise RuntimeError("Unable to find version string in %s." % (VERSIONFILE,))[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35msetup([0m
[30;1m14 | [0m[35m	# Application name:[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/getS4U2proxy.py[0m
   Pattern: [32m.hostname[0m
[30;1m53 | [0m[35m	parser.add_argument('--ccache', help='ccache file to store the TGT ticket in')[0m
[30;1m54 | [0m[35m	parser.add_argument('-v', '--verbose', action='count', default=0)[0m
[30;1m55 | [0m[35m	parser.add_argument('kerberos_url', help='Machine account credentials in kerberos URL format.')[0m
[30;1m56 | [0m[35m	parser.add_argument('spn', help='the service principal in format <service>/<server-hostname>@<domai[0m
[30;1m57 | [0m[35m	parser.add_argument('targetuser', help='')[0m
[30;1m58 | [0m[35m	[0m
[30;1m59 | [0m[35m	args = parser.parse_args()[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/getS4U2proxy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m	parser.add_argument('--ccache', help='ccache file to store the TGT ticket in')[0m
[30;1m54 | [0m[35m	parser.add_argument('-v', '--verbose', action='count', default=0)[0m
[30;1m55 | [0m[35m	parser.add_argument('kerberos_url', help='Machine account credentials in kerberos URL format.')[0m
[30;1m56 | [0m[35m	parser.add_argument('spn', help='the service principal in format <service>/<server-hostname>@<domai[0m
[30;1m57 | [0m[35m	parser.add_argument('targetuser', help='')[0m
[30;1m58 | [0m[35m	[0m
[30;1m59 | [0m[35m	args = parser.parse_args()[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m[0m
[30;1m2 | [0m[35mimport datetime[0m
[30;1m3 | [0m[35mfrom minikerberos.protocol.asn1_structs import KRB_CRED, KrbCredInfo, EncKrbCredPart, EncryptedData,[0m
[30;1m4 | [0m[35mimport base64[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mdef print_table(lines, separate_head=True):[0m
[30;1m7 | [0m[35m	"""Prints a formatted table given a 2 dimensional array"""[0m
[30;1m8 | [0m[35m	#Count the column width[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/getTGT.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35mdef main():[0m
[30;1m24 | [0m[35m	import argparse[0m
[30;1m25 | [0m[35m	[0m
[30;1m26 | [0m[35m	parser = argparse.ArgumentParser(description='Polls the kerberos service for a TGT for the sepcifie[0m
[30;1m27 | [0m[35m	parser.add_argument('--nopac', action='store_false', help="Don't request a PAC in the TGT")[0m
[30;1m28 | [0m[35m	parser.add_argument('--ccache', help='CCACHE file to store the TGT ticket in, otherwise kirbi will [0m
[30;1m29 | [0m[35m	parser.add_argument('--kirbi', help='kirbi file to store the TGT ticket in, otherwise kirbi will be[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/network/aioclientsocket.py[0m
   Pattern: [32m.hostname[0m
[30;1m90 | [0m[35m		self.target = target[0m
[30;1m91 | [0m[35m	[0m
[30;1m92 | [0m[35m	def get_addr_str(self):[0m
[30;1m93 | [0m[35m		return '%s:%d' % (self.target.get_hostname_or_ip(), self.target.port)[0m
[30;1m94 | [0m[35m	[0m
[30;1m95 | [0m[35m	async def sendrecv(self, data, throw:bool = False):[0m
[30;1m96 | [0m[35m		client = None[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/network/aioclientsocket.py[0m
   Pattern: [32m.hostname[0m
[30;1m60 | [0m[35m		self.target = target[0m
[30;1m61 | [0m[35m	[0m
[30;1m62 | [0m[35m	def get_addr_str(self):[0m
[30;1m63 | [0m[35m		return '%s:%d' % (self.target.get_hostname_or_ip(), self.target.port)[0m
[30;1m64 | [0m[35m	[0m
[30;1m65 | [0m[35m	async def sendrecv(self, data, throw:bool = False):[0m
[30;1m66 | [0m[35m		client = None[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m350 | [0m[35m		Requests a TGS ticket for the specified user.[0m
[30;1m351 | [0m[35m		Retruns the TGS ticket, end the decrpyted encTGSRepPart.[0m
[30;1m352 | [0m[35m[0m
[30;1m353 | [0m[35m		spn_user: KerberosTarget: the service user you want to get TGS for.[0m
[30;1m354 | [0m[35m		override_etype: None or list of etype values (int) Used mostly for kerberoasting, will override th[0m
[30;1m355 | [0m[35m		"""[0m
[30;1m356 | [0m[35m		[0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m214 | [0m[35m	def from_ccache(data, principal: str = None, realm: str = None, encoding = 'file') -> KerberosCrede[0m
[30;1m215 | [0m[35m		"""Returns a kerberos credential object with CCACHE database"""[0m
[30;1m216 | [0m[35m		if data is None:[0m
[30;1m217 | [0m[35m			ccache_path = os.environ.get('KRB5CCNAME')[0m
[30;1m218 | [0m[35m			if ccache_path is None:[0m
[30;1m219 | [0m[35m				raise Exception('No CCACHE data or path provided!')[0m
[30;1m220 | [0m[35m			data = ccache_path[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m318 | [0m[35m			if dc is not None:[0m
[30;1m319 | [0m[35m				self.domain = '.'.join(dc[::-1])[0m
[30;1m320 | [0m[35m			else:[0m
[30;1m321 | [0m[35m				raise Exception('Could\'t find proper domain name in the certificate! Please set it manually!')[0m
[30;1m322 | [0m[35m[0m
[30;1m323 | [0m[35m	@staticmethod[0m
[30;1m324 | [0m[35m	def from_pem_data(certdata: str or bytes, keydata:str or bytes, dhparams:DirtyDH = None, username:s[0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom __future__ import annotations[0m
[30;1m2 | [0m[35mimport getpass[0m
[30;1m3 | [0m[35mimport collections[0m
[30;1m4 | [0m[35mimport base64[0m
[30;1m5 | [0m[35mimport platform[0m
[30;1m6 | [0m[35mimport copy[0m
[30;1m7 | [0m[35mfrom typing import List[0m
[30;1m8 | [0m[35mimport os[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/creds.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m398 | [0m[35m		return KerberosCredential.from_pfx_string(data, password, dhparams = dhparams, username = username[0m
[30;1m399 | [0m[35m	[0m
[30;1m400 | [0m[35m	def set_dhparams(self, dhparams):[0m
[30;1m401 | [0m[35m		# windows default params, don't look at me...[0m
[30;1m402 | [0m[35m		self.dhparams = DirtyDH.from_dict({[0m
[30;1m403 | [0m[35m			'p':int('00ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08[0m
[30;1m404 | [0m[35m			'g':2[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/network/clientsocket.py[0m
   Pattern: [32m.hostname[0m
[30;1m9 | [0m[35m	def __init__(self, target):[0m
[30;1m10 | [0m[35m		self.target = target[0m
[30;1m11 | [0m[35m		self.soc_type = target.protocol[0m
[30;1m12 | [0m[35m		self.dst_ip = target.get_hostname_or_ip()[0m
[30;1m13 | [0m[35m		self.dst_port = int(target.port)[0m
[30;1m14 | [0m[35m		self.soc = None[0m
[30;1m15 | [0m[35m		[0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/network/clientsocket.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m75 | [0m[35m					if addr[0] == self.dst_ip:[0m
[30;1m76 | [0m[35m						break[0m
[30;1m77 | [0m[35m					else:[0m
[30;1m78 | [0m[35m						# got a message from a different IP than the target, strange![0m
[30;1m79 | [0m[35m						# continuing, but this might result in an infinite loop[0m
[30;1m80 | [0m[35m						continue[0m
[30;1m81 | [0m[35m			if buff == b'':[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/getS4U2self.py[0m
   Pattern: [32m.hostname[0m
[30;1m55 | [0m[35m	parser.add_argument('--ccache', help='ccache file to store the TGT ticket in')[0m
[30;1m56 | [0m[35m	parser.add_argument('-v', '--verbose', action='count', default=0)[0m
[30;1m57 | [0m[35m	parser.add_argument('kerberos_url', help='Machine account credentials in kerberos URL format.')[0m
[30;1m58 | [0m[35m	parser.add_argument('spn', help='the service principal in format <service>/<server-hostname>@<domai[0m
[30;1m59 | [0m[35m	parser.add_argument('targetuser', help='')[0m
[30;1m60 | [0m[35m	[0m
[30;1m61 | [0m[35m	args = parser.parse_args()[0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/getS4U2self.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m	parser.add_argument('--ccache', help='ccache file to store the TGT ticket in')[0m
[30;1m56 | [0m[35m	parser.add_argument('-v', '--verbose', action='count', default=0)[0m
[30;1m57 | [0m[35m	parser.add_argument('kerberos_url', help='Machine account credentials in kerberos URL format.')[0m
[30;1m58 | [0m[35m	parser.add_argument('spn', help='the service principal in format <service>/<server-hostname>@<domai[0m
[30;1m59 | [0m[35m	parser.add_argument('targetuser', help='')[0m
[30;1m60 | [0m[35m	[0m
[30;1m61 | [0m[35m	args = parser.parse_args()[0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/target.py[0m
   Pattern: [32m.hostname[0m
[30;1m6 | [0m[35m	def __init__(self, ip:str = None, proxies = None, protocol = UniProto.CLIENT_TCP, timeout = 10, por[0m
[30;1m7 | [0m[35m		UniTarget.__init__(self, ip, port , protocol, timeout=timeout, proxies = proxies, dc_ip = ip)[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m	def get_newtarget(self, ip, port:int=88, hostname:str = None):[0m
[30;1m10 | [0m[35m		return KerberosTarget([0m
[30;1m11 | [0m[35m			ip, [0m
[30;1m12 | [0m[35m			port = port, [0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/target.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m			ip, [0m
[30;1m12 | [0m[35m			port = port, [0m
[30;1m13 | [0m[35m			protocol = self.protocol, [0m
[30;1m14 | [0m[35m			timeout = self.timeout, [0m
[30;1m15 | [0m[35m			proxies=copy.deepcopy(self.proxies)[0m
[30;1m16 | [0m[35m		)[0m
[30;1m17 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/target.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mimport copy[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mclass KerberosTarget(UniTarget):[0m
[30;1m6 | [0m[35m	def __init__(self, ip:str = None, proxies = None, protocol = UniProto.CLIENT_TCP, timeout = 10, por[0m
[30;1m7 | [0m[35m		UniTarget.__init__(self, ip, port , protocol, timeout=timeout, proxies = proxies, dc_ip = ip)[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m	def get_newtarget(self, ip, port:int=88, hostname:str = None):[0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/errors.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m149 | [0m[35m	KRB_AP_ERR_USER_TO_USER_REQUIRED ='User-to-user authorization is required'[0m
[30;1m150 | [0m[35m	KRB_AP_ERR_NO_TGT  ='No TGT was presented or available'[0m
[30;1m151 | [0m[35m	KDC_ERR_WRONG_REALM = 'Incorrect domain or principal'[0m
[30;1m152 | [0m[35m	KRB_AP_ERR_IAKERB_KDC_NOT_FOUND = 'The IAKERB proxy could not find a KDC'[0m
[30;1m153 | [0m[35m	KRB_AP_ERR_IAKERB_KDC_NO_RESPONSE = 'The KDC did not respond to the IAKERB proxy'[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/errors.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m103 | [0m[35m	KDC_ERR_NULL_KEY = 'The client or server has a null key (master key)'[0m
[30;1m104 | [0m[35m	KDC_ERR_CANNOT_POSTDATE =  'Ticket (TGT) not eligible for postdating'[0m
[30;1m105 | [0m[35m	KDC_ERR_NEVER_VALID = 'Requested start time is later than end time'[0m
[30;1m106 | [0m[35m	KDC_ERR_POLICY = 'Requested start time is later than end time'[0m
[30;1m107 | [0m[35m	KDC_ERR_BADOPTION = 'KDC cannot accommodate requested option'[0m
[30;1m108 | [0m[35m	KDC_ERR_ETYPE_NOTSUPP =  'KDC has no support for encryption type'[0m
[30;1m109 | [0m[35m	KDC_ERR_SUMTYPE_NOSUPP = 'KDC has no support for checksum type'[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/errors.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m102 | [0m[35m	KDC_ERR_PRINCIPAL_NOT_UNIQUE = 'Multiple principal entries in KDC database'[0m
[30;1m103 | [0m[35m	KDC_ERR_NULL_KEY = 'The client or server has a null key (master key)'[0m
[30;1m104 | [0m[35m	KDC_ERR_CANNOT_POSTDATE =  'Ticket (TGT) not eligible for postdating'[0m
[30;1m105 | [0m[35m	KDC_ERR_NEVER_VALID = 'Requested start time is later than end time'[0m
[30;1m106 | [0m[35m	KDC_ERR_POLICY = 'Requested start time is later than end time'[0m
[30;1m107 | [0m[35m	KDC_ERR_BADOPTION = 'KDC cannot accommodate requested option'[0m
[30;1m108 | [0m[35m	KDC_ERR_ETYPE_NOTSUPP =  'KDC has no support for encryption type'[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/errors.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m	KRB_AP_ERR_MODIFIED = 0x29 # Message stream modified and checksum didn't match[0m
[30;1m61 | [0m[35m	KRB_AP_ERR_BADORDER = 0x2A # Message out of order (possible tampering)[0m
[30;1m62 | [0m[35m	KRB_AP_ERR_BADKEYVER = 0x2C # Specified version of key is not available[0m
[30;1m63 | [0m[35m	KRB_AP_ERR_NOKEY = 0x2D # Service key not available[0m
[30;1m64 | [0m[35m	KRB_AP_ERR_MUT_FAIL = 0x2E # Mutual authentication failed[0m
[30;1m65 | [0m[35m	KRB_AP_ERR_BADDIRECTION = 0x2F # Incorrect message direction[0m
[30;1m66 | [0m[35m	KRB_AP_ERR_METHOD = 0x30 # Alternative authentication method required[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/errors.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m	KDC_ERR_NULL_KEY = 0x9 #The client or server has a null key (master key)[0m
[30;1m32 | [0m[35m	KDC_ERR_CANNOT_POSTDATE = 0xA # Ticket (TGT) not eligible for postdating[0m
[30;1m33 | [0m[35m	KDC_ERR_NEVER_VALID = 0xB # Requested start time is later than end time[0m
[30;1m34 | [0m[35m	KDC_ERR_POLICY = 0xC #Requested start time is later than end time[0m
[30;1m35 | [0m[35m	KDC_ERR_BADOPTION = 0xD #KDC cannot accommodate requested option[0m
[30;1m36 | [0m[35m	KDC_ERR_ETYPE_NOTSUPP = 0xE # KDC has no support for encryption type[0m
[30;1m37 | [0m[35m	KDC_ERR_SUMTYPE_NOSUPP = 0xF # KDC has no support for checksum type[0m
[30;1m38 | [0m[35m	KDC_ERR_PADATA_TYPE_NOSUPP = 0x10 #KDC has no support for PADATA type (pre-authentication data)[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/errors.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m	KDC_ERR_NULL_KEY = 0x9 #The client or server has a null key (master key)[0m
[30;1m32 | [0m[35m	KDC_ERR_CANNOT_POSTDATE = 0xA # Ticket (TGT) not eligible for postdating[0m
[30;1m33 | [0m[35m	KDC_ERR_NEVER_VALID = 0xB # Requested start time is later than end time[0m
[30;1m34 | [0m[35m	KDC_ERR_POLICY = 0xC #Requested start time is later than end time[0m
[30;1m35 | [0m[35m	KDC_ERR_BADOPTION = 0xD #KDC cannot accommodate requested option[0m
[30;1m36 | [0m[35m	KDC_ERR_ETYPE_NOTSUPP = 0xE # KDC has no support for encryption type[0m
[30;1m37 | [0m[35m	KDC_ERR_SUMTYPE_NOSUPP = 0xF # KDC has no support for checksum type[0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/errors.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m	KDC_ERR_PRINCIPAL_NOT_UNIQUE = 0x8 #Multiple principal entries in KDC database[0m
[30;1m31 | [0m[35m	KDC_ERR_NULL_KEY = 0x9 #The client or server has a null key (master key)[0m
[30;1m32 | [0m[35m	KDC_ERR_CANNOT_POSTDATE = 0xA # Ticket (TGT) not eligible for postdating[0m
[30;1m33 | [0m[35m	KDC_ERR_NEVER_VALID = 0xB # Requested start time is later than end time[0m
[30;1m34 | [0m[35m	KDC_ERR_POLICY = 0xC #Requested start time is later than end time[0m
[30;1m35 | [0m[35m	KDC_ERR_BADOPTION = 0xD #KDC cannot accommodate requested option[0m
[30;1m36 | [0m[35m	KDC_ERR_ETYPE_NOTSUPP = 0xE # KDC has no support for encryption type[0m
[30;1m37 | [0m[35m	KDC_ERR_SUMTYPE_NOSUPP = 0xF # KDC has no support for checksum type[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/errors.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m	KDC_ERR_PRINCIPAL_NOT_UNIQUE = 0x8 #Multiple principal entries in KDC database[0m
[30;1m31 | [0m[35m	KDC_ERR_NULL_KEY = 0x9 #The client or server has a null key (master key)[0m
[30;1m32 | [0m[35m	KDC_ERR_CANNOT_POSTDATE = 0xA # Ticket (TGT) not eligible for postdating[0m
[30;1m33 | [0m[35m	KDC_ERR_NEVER_VALID = 0xB # Requested start time is later than end time[0m
[30;1m34 | [0m[35m	KDC_ERR_POLICY = 0xC #Requested start time is later than end time[0m
[30;1m35 | [0m[35m	KDC_ERR_BADOPTION = 0xD #KDC cannot accommodate requested option[0m
[30;1m36 | [0m[35m	KDC_ERR_ETYPE_NOTSUPP = 0xE # KDC has no support for encryption type[0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_url.py[0m
   Pattern: [32m.userInfo[0m
[30;1m140 | [0m[35m	assert str(target1) == str(target2)[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m#def test_url_certstore():[0m
[30;1m143 | [0m[35m#	urlstr = 'kerberos+certstore://127.0.0.1/?cn=whoami@domain&certstore=MY'[0m
[30;1m144 | [0m[35m#	url = KerberosClientFactory.from_url(urlstr)[0m
[30;1m145 | [0m[35m#	cred1 = url.get_creds()[0m
[30;1m146 | [0m[35m#	target1 = url.get_target()[0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_url.py[0m
   Pattern: [32m.hostname[0m
[30;1m100 | [0m[35m			assert cred.username.upper().find('VICTIM') != -1[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m			target = url.get_target()[0m
[30;1m103 | [0m[35m			assert target.hostname == 'dc_ip'[0m
[30;1m104 | [0m[35m			assert target.port == 88[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m		finally:[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_url.py[0m
   Pattern: [32m.hostname[0m
[30;1m84 | [0m[35m		assert listcompare(targets, targets2)[0m
[30;1m85 | [0m[35m		[0m
[30;1m86 | [0m[35m		target = url.get_target()[0m
[30;1m87 | [0m[35m		assert target.hostname == 'dc_ip'[0m
[30;1m88 | [0m[35m		assert target.port == 88[0m
[30;1m89 | [0m[35m	finally:[0m
[30;1m90 | [0m[35m		os.remove('a.ccache')[0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_url.py[0m
   Pattern: [32m.hostname[0m
[30;1m67 | [0m[35m	assert cred.kerberos_key_rc4 == 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'[0m
[30;1m68 | [0m[35m	[0m
[30;1m69 | [0m[35m	target = url.get_target()[0m
[30;1m70 | [0m[35m	assert target.hostname == 'dc_ip'[0m
[30;1m71 | [0m[35m	assert target.port == 88[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35mdef test_url_ccachefile():[0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_url.py[0m
   Pattern: [32m.hostname[0m
[30;1m55 | [0m[35m	assert cred.kerberos_key_aes_256 == 'AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA[0m
[30;1m56 | [0m[35m	[0m
[30;1m57 | [0m[35m	target = url.get_target()[0m
[30;1m58 | [0m[35m	assert target.hostname == 'dc_ip'[0m
[30;1m59 | [0m[35m	assert target.port == 88[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35mdef test_url_rc4():[0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_url.py[0m
   Pattern: [32m.hostname[0m
[30;1m42 | [0m[35m	assert cred.kerberos_key_aes_256 == None[0m
[30;1m43 | [0m[35m	[0m
[30;1m44 | [0m[35m	target = url.get_target()[0m
[30;1m45 | [0m[35m	assert target.hostname == 'dc_ip'[0m
[30;1m46 | [0m[35m	assert target.port == 88[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35mdef test_url_aes_256():[0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/structure.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m61 | [0m[35mg, other structure, or anything responding to __str__()) (for unpacking, all what's left is returned[0m
[30;1m62 | [0m[35m            z       same as :, but adds a NUL byte at the end (asciiz) (for unpacking the first NUL [0m
[30;1m63 | [0m[35m            u       same as z, but adds two NUL bytes at the end (after padding to an even size with[0m
[30;1m64 | [0m[35m            w       DCE-RPC/NDR string (it's a macro for [  '<L=(len(field)+1)/2','"\\x00\\x00\\x00\[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/structure.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m58 | [0m[35m ...[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m          some additional format specifiers:[0m
[30;1m61 | [0m[35m            :       just copy the bytes from the field into the output string (input may be string, [0m
[30;1m62 | [0m[35m            z       same as :, but adds a NUL byte at the end (asciiz) (for unpacking the first NUL [0m
[30;1m63 | [0m[35m            u       same as z, but adds two NUL bytes at the end (after padding to an even size with[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/factory.py[0m
   Pattern: [32m.hostname[0m
[30;1m240 | [0m[35m		if res.secret_type is None:[0m
[30;1m241 | [0m[35m			raise Exception('Missing secret_type!')[0m
[30;1m242 | [0m[35m		if res.dc_ip is None:[0m
[30;1m243 | [0m[35m			raise Exception('Missing target hostname or IP!')[0m
[30;1m244 | [0m[35m		[0m
[30;1m245 | [0m[35m		if res.secret is None and res.secret_type != KerberosSecretType.NONE:[0m
[30;1m246 | [0m[35m			if res.secret_type not in [KerberosSecretType.PEM, KerberosSecretType.CERTSTORE]:[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/factory.py[0m
   Pattern: [32m.hostname[0m
[30;1m176 | [0m[35m		res = KerberosClientFactory()[0m
[30;1m177 | [0m[35m		url = urlparse(url_str)[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m		res.dc_ip = url.hostname[0m
[30;1m180 | [0m[35m		schemes = url.scheme.upper().split('+')[0m
[30;1m181 | [0m[35m		[0m
[30;1m182 | [0m[35m		if schemes[0] not in ['KERBEROS', 'KERBEROS-TCP, KERBEROS-UDP', 'KRB5', 'KRB5-UDP', 'KRB5-TCP']:[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/factory.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m			port=self.port, [0m
[30;1m92 | [0m[35m			protocol = UniProto.CLIENT_TCP, [0m
[30;1m93 | [0m[35m			proxies = self.proxies,[0m
[30;1m94 | [0m[35m			timeout = self.timeout[0m
[30;1m95 | [0m[35m		)[0m
[30;1m96 | [0m[35m		return res[0m
[30;1m97 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/aioclient.py[0m
   Pattern: [32m.hostname[0m
[30;1m880 | [0m[35m		message = KRB5ChangePassword(ap_req_encoded, privdata).to_bytes()[0m
[30;1m881 | [0m[35m		logger.debug('[ChangePassword] Sending request to server')[0m
[30;1m882 | [0m[35m[0m
[30;1m883 | [0m[35m		newt = self.target.get_newtarget(self.target.get_hostname_or_ip(), port=464)[0m
[30;1m884 | [0m[35m		ksocket = AIOKerberosPWChangeClientSocket(newt)[0m
[30;1m885 | [0m[35m		response = await ksocket.sendrecv(message)[0m
[30;1m886 | [0m[35m		reply = KRB5ChangePassword.from_bytes(response)[0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/aioclient.py[0m
   Pattern: [32m.hostname[0m
[30;1m847 | [0m[35m		privstruct = {}[0m
[30;1m848 | [0m[35m		privstruct['user-data'] = ChangePasswdDataMS(changepwstruct).dump()[0m
[30;1m849 | [0m[35m		privstruct['seq-number'] = 0[0m
[30;1m850 | [0m[35m		privstruct['s-address'] = HostAddress({'addr-type': 1, 'address': hostname.encode()})[0m
[30;1m851 | [0m[35m[0m
[30;1m852 | [0m[35m		privdata = KRB_PRIV({[0m
[30;1m853 | [0m[35m			'pvno': krb5_pvno,[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/aioclient.py[0m
   Pattern: [32m.hostname[0m
[30;1m813 | [0m[35m[0m
[30;1m814 | [0m[35m		return tgs, encpart, key, new_factory[0m
[30;1m815 | [0m[35m	[0m
[30;1m816 | [0m[35m	async def change_password(self, new_password:str, subkey = None, targetuser:str = None, targetrealm[0m
[30;1m817 | [0m[35m		"""[0m
[30;1m818 | [0m[35m		Changes the password of the current user[0m
[30;1m819 | [0m[35m		"""[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/aioclient.py[0m
   Pattern: [32m.hostname[0m
[30;1m787 | [0m[35m	[0m
[30;1m788 | [0m[35m	async def get_referral_ticket(self, target_domain, target_ip = None):[0m
[30;1m789 | [0m[35m		"""Cross domain TGT referral"""[0m
[30;1m790 | [0m[35m		"""If target_ip is not set, the target domain will be used as the hostname for the newly created c[0m
[30;1m791 | [0m[35m		from minikerberos.common.factory import KerberosClientFactory[0m
[30;1m792 | [0m[35m		from minikerberos.common.kirbi import Kirbi[0m
[30;1m793 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/aioclient.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m365 | [0m[35m		Requests a TGS ticket for the specified user.[0m
[30;1m366 | [0m[35m		Retruns the TGS ticket, end the decrpyted encTGSRepPart.[0m
[30;1m367 | [0m[35m[0m
[30;1m368 | [0m[35m		spn_user: KerberosTarget: the service user you want to get TGS for.[0m
[30;1m369 | [0m[35m		override_etype: None or list of etype values (int) Used mostly for kerberoasting, will override th[0m
[30;1m370 | [0m[35m		"""[0m
[30;1m371 | [0m[35m		[0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/ccache.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m678 | [0m[35m				logger.debug('Missing domain, user not found, returning first availabla TGT!')[0m
[30;1m679 | [0m[35m				return tgts[0][0], tgts[0][1], None[0m
[30;1m680 | [0m[35m[0m
[30;1m681 | [0m[35m			# at this point it seems that both username and domain is supplied[0m
[30;1m682 | [0m[35m			# proceeding as if strict check was true[0m
[30;1m683 | [0m[35m[0m
[30;1m684 | [0m[35m		for tgt, keystruct in tgts:[0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/ccache.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m650 | [0m[35m		if strict is True:[0m
[30;1m651 | [0m[35m			return None, None, Exception('No TGS found for SPN %s' % spn)[0m
[30;1m652 | [0m[35m		[0m
[30;1m653 | [0m[35m		# I hope you know what you are doing at this point...[0m
[30;1m654 | [0m[35m		# Couldn't find the correct TGS for the SPN, returning the first one[0m
[30;1m655 | [0m[35m		# the only valid reason this can happen is mismatching service tag in the SPN[0m
[30;1m656 | [0m[35m		# this is a hack...[0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/ccache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m780 | [0m[35m		try:[0m
[30;1m781 | [0m[35m			ccache = CCACHE.from_kirbi(kirbidata)[0m
[30;1m782 | [0m[35m		except:[0m
[30;1m783 | [0m[35m			#maybe the kirbi file is actually base64 encoded from rubeus?[0m
[30;1m784 | [0m[35m			kirbi = Kirbi.from_b64(kirbidata)[0m
[30;1m785 | [0m[35m			ccache = CCACHE.from_kirbi(kirbi)[0m
[30;1m786 | [0m[35m		[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/ccache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m667 | [0m[35m				logger.debug('Missing username, returning first availabla TGT!')[0m
[30;1m668 | [0m[35m				return tgts[0][0], tgts[0][1], None[0m
[30;1m669 | [0m[35m			if domain is None:[0m
[30;1m670 | [0m[35m				# no domain was supplied, trying to find a TGT for the user in any domain[0m
[30;1m671 | [0m[35m				for tgt, keystruct in tgts:[0m
[30;1m672 | [0m[35m					if tgt['cname']['name-string'].find(str(username)) != -1:[0m
[30;1m673 | [0m[35m						logger.debug('Found TGT for user %s' % username)[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/ccache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m652 | [0m[35m		[0m
[30;1m653 | [0m[35m		# I hope you know what you are doing at this point...[0m
[30;1m654 | [0m[35m		# Couldn't find the correct TGS for the SPN, returning the first one[0m
[30;1m655 | [0m[35m		# the only valid reason this can happen is mismatching service tag in the SPN[0m
[30;1m656 | [0m[35m		# this is a hack...[0m
[30;1m657 | [0m[35m		return tgss[0][0], tgss[0][1], None[0m
[30;1m658 | [0m[35m	[0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/ccache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m651 | [0m[35m			return None, None, Exception('No TGS found for SPN %s' % spn)[0m
[30;1m652 | [0m[35m		[0m
[30;1m653 | [0m[35m		# I hope you know what you are doing at this point...[0m
[30;1m654 | [0m[35m		# Couldn't find the correct TGS for the SPN, returning the first one[0m
[30;1m655 | [0m[35m		# the only valid reason this can happen is mismatching service tag in the SPN[0m
[30;1m656 | [0m[35m		# this is a hack...[0m
[30;1m657 | [0m[35m		return tgss[0][0], tgss[0][1], None[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/ccache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m630 | [0m[35m	def get_all_tgt(self):[0m
[30;1m631 | [0m[35m		"""[0m
[30;1m632 | [0m[35m		Returns a list of AS_REP tickets in native format (dict). [0m
[30;1m633 | [0m[35m		To determine which ticket are AP_REP we check for the server principal to be the kerberos service[0m
[30;1m634 | [0m[35m		"""[0m
[30;1m635 | [0m[35m		tgts = [][0m
[30;1m636 | [0m[35m		for cred in self.credentials:[0m
[30;1m637 | [0m[35m			if cred.server.to_string(separator = '/').lower().find('krbtgt') != -1:[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/ccache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m618 | [0m[35m	def get_all_tgt_kirbis(self):[0m
[30;1m619 | [0m[35m		"""[0m
[30;1m620 | [0m[35m		Returns a list of AS_REP tickets in kirbi format (Kirbi). [0m
[30;1m621 | [0m[35m		To determine which ticket are AP_REP we check for the server principal to be the kerberos service[0m
[30;1m622 | [0m[35m		"""[0m
[30;1m623 | [0m[35m		tgts = [][0m
[30;1m624 | [0m[35m		for cred in self.credentials:[0m
[30;1m625 | [0m[35m			if cred.server.to_string(separator = '/').lower().find('krbtgt') != -1:[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/ccache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m585 | [0m[35m	def add_tgs(self, tgs_rep, enc_tgs_rep_part, override_pp = False): #from AS_REP[0m
[30;1m586 | [0m[35m		"""[0m
[30;1m587 | [0m[35m		Creates credential object from the TGS and adds to the ccache file[0m
[30;1m588 | [0m[35m		The TGS is the native representation of the asn1 encoded TGS_REP data when the user requests a tgs[0m
[30;1m589 | [0m[35m		[0m
[30;1m590 | [0m[35m		This function doesn't do decryption of the encrypted part of the tgs_rep object, it is expected th[0m
[30;1m591 | [0m[35m		[0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/ccache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m154 | [0m[35m		krbcredinfo['prealm'] = self.client.realm.to_string()[0m
[30;1m155 | [0m[35m		krbcredinfo['pname'] = self.client.to_asn1()[0][0m
[30;1m156 | [0m[35m		krbcredinfo['flags'] = core.IntegerBitString(self.tktflags).cast(TicketFlags)[0m
[30;1m157 | [0m[35m		if self.time.authtime != 0: #this parameter is not mandatory, and most of the time not present[0m
[30;1m158 | [0m[35m			krbcredinfo['authtime'] = datetime.datetime.fromtimestamp(self.time.authtime, datetime.timezone.u[0m
[30;1m159 | [0m[35m		if self.time.starttime != 0:[0m
[30;1m160 | [0m[35m			krbcredinfo['starttime'] = datetime.datetime.fromtimestamp(self.time.starttime, datetime.timezone[0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/ccache.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mimport io[0m
[30;1m3 | [0m[35mimport datetime[0m
[30;1m4 | [0m[35mimport glob[0m
[30;1m5 | [0m[35mimport base64[0m
[30;1m6 | [0m[35mfrom typing import List[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mfrom minikerberos.protocol.asn1_structs import Ticket, EncryptedData, \[0m
[30;1m9 | [0m[35m	krb5_pvno, KrbCredInfo, EncryptionKey, KRBCRED, TicketFlags, EncKrbCredPart[0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/crosstest.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35mdef main():[0m
[30;1m32 | [0m[35m	import argparse[0m
[30;1m33 | [0m[35m	[0m
[30;1m34 | [0m[35m	parser = argparse.ArgumentParser(description='Polls the kerberos service for a TGS for the sepcifie[0m
[30;1m35 | [0m[35m	parser.add_argument('-v', '--verbose', action='count', default=0)[0m
[30;1m36 | [0m[35m	parser.add_argument('--kirbi', help='kirbi file to store the TGT ticket in, otherwise kirbi will be[0m
[30;1m37 | [0m[35m	parser.add_argument('kerberos_url', help='the kerberos target string. ')[0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/common/windows/crypt32.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m363 | [0m[35m	while True:[0m
[30;1m364 | [0m[35m		hcert = CertEnumCertificatesInStore(chandle, hcert)[0m
[30;1m365 | [0m[35m		if bool(hcert) is False:[0m
[30;1m366 | [0m[35m			raise Exception('Couldnt find certificate for %s in certstore %s' % (common_name, certstore_name)[0m
[30;1m367 | [0m[35m		certificate = get_cert(hcert)[0m
[30;1m368 | [0m[35m		subject = certificate.subject.native['common_name'][0m
[30;1m369 | [0m[35m		if isinstance(subject, list):[0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/enum.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m554 | [0m[35m            # now find the correct __new__, checking to see of one was defined[0m
[30;1m555 | [0m[35m            # by the user; also check earlier enum classes in case a __new__ was[0m
[30;1m556 | [0m[35m            # saved as __member_new__[0m
[30;1m557 | [0m[35m            __new__ = classdict.get('__new__', None)[0m
[30;1m558 | [0m[35m[0m
[30;1m559 | [0m[35m            # should __new__ be saved as __member_new__ later?[0m
[30;1m560 | [0m[35m            save_new = __new__ is not None[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/enum.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m496 | [0m[35m            # now find the correct __new__, checking to see of one was defined[0m
[30;1m497 | [0m[35m            # by the user; also check earlier enum classes in case a __new__ was[0m
[30;1m498 | [0m[35m            # saved as __member_new__[0m
[30;1m499 | [0m[35m            __new__ = classdict.get('__new__', None)[0m
[30;1m500 | [0m[35m            if __new__:[0m
[30;1m501 | [0m[35m                return None, True, True      # __new__, save_new, use_args[0m
[30;1m502 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/enum.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m379 | [0m[35m        resulting in an inconsistent Enumeration.[0m
[30;1m380 | [0m[35m[0m
[30;1m381 | [0m[35m        """[0m
[30;1m382 | [0m[35m        member_map = cls.__dict__.get('_member_map_', {})[0m
[30;1m383 | [0m[35m        if name in member_map:[0m
[30;1m384 | [0m[35m            raise AttributeError('Cannot reassign members.')[0m
[30;1m385 | [0m[35m        super(EnumMeta, cls).__setattr__(name, value)[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/enum.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m194 | [0m[35m        # check for a __getnewargs__, and if not present sabotage[0m
[30;1m195 | [0m[35m        # pickling, since it won't work anyway[0m
[30;1m196 | [0m[35m        if (member_type is not object and[0m
[30;1m197 | [0m[35m            member_type.__dict__.get('__getnewargs__') is None[0m
[30;1m198 | [0m[35m            ):[0m
[30;1m199 | [0m[35m            _make_class_unpicklable(enum_class)[0m
[30;1m200 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/enum.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m161 | [0m[35m            del classdict[name][0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m        # py2 support for definition order[0m
[30;1m164 | [0m[35m        __order__ = classdict.get('__order__')[0m
[30;1m165 | [0m[35m        if __order__ is None:[0m
[30;1m166 | [0m[35m            __order__ = classdict._member_names[0m
[30;1m167 | [0m[35m            if pyver < 3.0:[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/enum.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m450 | [0m[35m        [0m
[30;1m451 | [0m[35m[0m
[30;1m452 | [0m[35m        # double check that we are not subclassing a class with existing[0m
[30;1m453 | [0m[35m        # enumeration members; while we're at it, see if any other data[0m
[30;1m454 | [0m[35m        # type has been mixed in so we can use the correct __new__[0m
[30;1m455 | [0m[35m        member_type = first_enum = None[0m
[30;1m456 | [0m[35m        for base in bases:[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/enum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m551 | [0m[35m            first_enum: enumeration to check for an overriding __new__[0m
[30;1m552 | [0m[35m[0m
[30;1m553 | [0m[35m            """[0m
[30;1m554 | [0m[35m            # now find the correct __new__, checking to see of one was defined[0m
[30;1m555 | [0m[35m            # by the user; also check earlier enum classes in case a __new__ was[0m
[30;1m556 | [0m[35m            # saved as __member_new__[0m
[30;1m557 | [0m[35m            __new__ = classdict.get('__new__', None)[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/enum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m493 | [0m[35m            first_enum: enumeration to check for an overriding __new__[0m
[30;1m494 | [0m[35m[0m
[30;1m495 | [0m[35m            """[0m
[30;1m496 | [0m[35m            # now find the correct __new__, checking to see of one was defined[0m
[30;1m497 | [0m[35m            # by the user; also check earlier enum classes in case a __new__ was[0m
[30;1m498 | [0m[35m            # saved as __member_new__[0m
[30;1m499 | [0m[35m            __new__ = classdict.get('__new__', None)[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/enum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m262 | [0m[35m            if obj_method is not None and obj_method is class_method:[0m
[30;1m263 | [0m[35m                setattr(enum_class, name, enum_method)[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m        # method resolution and int's are not playing nice[0m
[30;1m266 | [0m[35m        # Python's less than 2.6 use __cmp__[0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m        if pyver < 2.6:[0m
[30;1m269 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/enum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m211 | [0m[35m            else:[0m
[30;1m212 | [0m[35m                args = value[0m
[30;1m213 | [0m[35m            if member_type is tuple:   # special case for tuple enums[0m
[30;1m214 | [0m[35m                args = (args, )     # wrap it one more time[0m
[30;1m215 | [0m[35m            if not use_args or not args:[0m
[30;1m216 | [0m[35m                enum_member = __new__(enum_class)[0m
[30;1m217 | [0m[35m                if not hasattr(enum_member, '_value_'):[0m
[30;1m218 | [0m[35m                    enum_member._value_ = value[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/protocol/external/enum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m# Dummy value for Enum as EnumMeta explicitly checks for it, but of course until[0m
[30;1m128 | [0m[35m# EnumMeta finishes running the first time the Enum class doesn't exist.  This[0m
[30;1m129 | [0m[35m# is also why there are checks in EnumMeta like `if Enum is not None`[0m
[30;1m130 | [0m[35mEnum = None[0m
[30;1m131 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/minikerberos/examples/getTGS.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35mdef main():[0m
[30;1m35 | [0m[35m	import argparse[0m
[30;1m36 | [0m[35m	[0m
[30;1m37 | [0m[35m	parser = argparse.ArgumentParser(description='Polls the kerberos service for a TGS for the sepcifie[0m
[30;1m38 | [0m[35m	parser.add_argument('-v', '--verbose', action='count', default=0)[0m
[30;1m39 | [0m[35m	parser.add_argument('--ccache', help='CCACHE file to store the TGT ticket in, otherwise kirbi will [0m
[30;1m40 | [0m[35m	parser.add_argument('--kirbi', help='kirbi file to store the TGT ticket in, otherwise kirbi will be[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m395[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/minikerberos-0.4.4/tests/test_credential.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35mimport pathlib[0m
[30;1m4 | [0m[35mimport pytest[0m
[30;1m5 | [0m[35mimport base64[0m
[30;1m6 | [0m[35mfrom minikerberos.common.factory import KerberosClientFactory[0m
[30;1m7 | [0m[35mfrom minikerberos.common.creds import KerberosCredential[0m
[30;1m8 | [0m[35mfrom minikerberos.common.constants import KerberosSecretType[0m
[30;1m9 | [0m[35mfrom minikerberos.common.ccache import CCACHE[0m

395 matches found.
