[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_runner.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m32 | [0m[35m        report_orchestration_scheduler[0m
[30;1m33 | [0m[35m        """[0m
[30;1m34 | [0m[35m        self.timer = environment.get("timer")[0m
[30;1m35 | [0m[35m        self.sampler = environment.get("sampler") or Sampler(environment=environment)[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m        self.scheduler = Scheduler([0m
[30;1m38 | [0m[35m            command=self._profiling_command,[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_runner.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m31 | [0m[35m        :param profiler_thread_name: (required inside environment) Thread name used for running the[0m
[30;1m32 | [0m[35m        report_orchestration_scheduler[0m
[30;1m33 | [0m[35m        """[0m
[30;1m34 | [0m[35m        self.timer = environment.get("timer")[0m
[30;1m35 | [0m[35m        self.sampler = environment.get("sampler") or Sampler(environment=environment)[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m        self.scheduler = Scheduler([0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_runner.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    def __init__(self, environment=dict()):[0m
[30;1m23 | [0m[35m        """[0m
[30;1m24 | [0m[35m        :param environment: dependency container dictionary for the current profiler[0m
[30;1m25 | [0m[35m        :param sampling_interval: (required inside environment) delay between profile reports in dat[0m
[30;1m26 | [0m[35m        :param killswitch_filepath: (required inside environment) filepath pointing to the killswitc[0m
[30;1m27 | [0m[35m            gets checked every time the profiler samples; the profiler is immediately stopped if thi[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/aws_lambda.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    @classmethod[0m
[30;1m54 | [0m[35m    def __look_execution_env(cls, env=os.environ):[0m
[30;1m55 | [0m[35m        return env.get(LAMBDA_EXECUTION_ENV)[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    @classmethod[0m
[30;1m58 | [0m[35m    def __look_function_arn(cls, context):[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/aws_lambda.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m46 | [0m[35m    @classmethod[0m
[30;1m47 | [0m[35m    def __look_up_memory_limit(cls, env=os.environ):[0m
[30;1m48 | [0m[35m        try:[0m
[30;1m49 | [0m[35m            return int(env.get(LAMBDA_MEMORY_SIZE_ENV))[0m
[30;1m50 | [0m[35m        except (TypeError, ValueError):[0m
[30;1m51 | [0m[35m            return None[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/aws_lambda.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mlogger = logging.getLogger(__name__)[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mLAMBDA_MEMORY_SIZE_ENV = "AWS_LAMBDA_FUNCTION_MEMORY_SIZE"[0m
[30;1m12 | [0m[35mLAMBDA_EXECUTION_ENV = "AWS_EXECUTION_ENV"[0m
[30;1m13 | [0m[35mHANDLER_ENV_NAME_FOR_CODEGURU_KEY = "HANDLER_ENV_NAME_FOR_CODEGURU"[0m
[30;1m14 | [0m[35mLAMBDA_TASK_ROOT = "LAMBDA_TASK_ROOT"[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sdk_reporter/profile_encoder.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m219 | [0m[35m    @staticmethod[0m
[30;1m220 | [0m[35m    def debug_pretty_encode(profile, environment=dict(), sort_keys=True):[0m
[30;1m221 | [0m[35m        stream = io.BytesIO()[0m
[30;1m222 | [0m[35m        ProfileEncoder(gzip=False, environment=environment).encode(profile, stream)[0m
[30;1m223 | [0m[35m        parsed_json = json.loads(stream.getvalue().decode("utf-8"))[0m
[30;1m224 | [0m[35m        return json.dumps(parsed_json, indent=2, sort_keys=sort_keys)[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sdk_reporter/profile_encoder.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m81 | [0m[35m    def __init__(self, environment=dict(), gzip=True):[0m
[30;1m82 | [0m[35m        self._gzip = gzip[0m
[30;1m83 | [0m[35m        self._agent_metadata = environment["agent_metadata"][0m
[30;1m84 | [0m[35m        self._module_path_extractor = self.ModulePathExtractor(environment.get("sys_path") or sys.pa[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    def encode(self, profile, output_stream):[0m
[30;1m87 | [0m[35m        if self._gzip:[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m278 | [0m[35m            raise Exception("CodeGuru Profiler was not correctly initialized; see previous error mes[0m
[30;1m279 | [0m[35m[0m
[30;1m280 | [0m[35m    def __str__(self):[0m
[30;1m281 | [0m[35m        return 'Profiler(environment=' + str({k: self.environment.get(k) for k in[0m
[30;1m282 | [0m[35m                                              ['max_threads', 'profiling_group_name', 'region_name',[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m    @staticmethod[0m
[30;1m178 | [0m[35m    def _select_collector(environment):[0m
[30;1m179 | [0m[35m        reporting_mode = environment.get('reporting_mode')[0m
[30;1m180 | [0m[35m        if reporting_mode == "codeguru_service":[0m
[30;1m181 | [0m[35m            environment["codeguru_profiler_builder"] = CodeGuruClientBuilder(environment)[0m
[30;1m182 | [0m[35m            return LocalAggregator([0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m171 | [0m[35m        environment['agent_metadata'] = environment.get('agent_metadata') or AgentMetadata()[0m
[30;1m172 | [0m[35m        environment['errors_metadata'] = environment.get('errors_metadata') or ErrorsMetadata()[0m
[30;1m173 | [0m[35m        environment['collector'] = environment.get('collector') or self._select_collector(environmen[0m
[30;1m174 | [0m[35m        environment["profiler_disabler"] = environment.get('profiler_disabler') or ProfilerDisabler([0m
[30;1m175 | [0m[35m        return UnmodifiableDict(environment)[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m170 | [0m[35m        # TODO delay metadata lookup until we need it[0m
[30;1m171 | [0m[35m        environment['agent_metadata'] = environment.get('agent_metadata') or AgentMetadata()[0m
[30;1m172 | [0m[35m        environment['errors_metadata'] = environment.get('errors_metadata') or ErrorsMetadata()[0m
[30;1m173 | [0m[35m        environment['collector'] = environment.get('collector') or self._select_collector(environmen[0m
[30;1m174 | [0m[35m        environment["profiler_disabler"] = environment.get('profiler_disabler') or ProfilerDisabler([0m
[30;1m175 | [0m[35m        return UnmodifiableDict(environment)[0m
[30;1m176 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m169 | [0m[35m            frozenset({environment['profiler_thread_name']}.union(environment['excluded_threads']))[0m
[30;1m170 | [0m[35m        # TODO delay metadata lookup until we need it[0m
[30;1m171 | [0m[35m        environment['agent_metadata'] = environment.get('agent_metadata') or AgentMetadata()[0m
[30;1m172 | [0m[35m        environment['errors_metadata'] = environment.get('errors_metadata') or ErrorsMetadata()[0m
[30;1m173 | [0m[35m        environment['collector'] = environment.get('collector') or self._select_collector(environmen[0m
[30;1m174 | [0m[35m        environment["profiler_disabler"] = environment.get('profiler_disabler') or ProfilerDisabler([0m
[30;1m175 | [0m[35m        return UnmodifiableDict(environment)[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m168 | [0m[35m        environment['excluded_threads'] = \[0m
[30;1m169 | [0m[35m            frozenset({environment['profiler_thread_name']}.union(environment['excluded_threads']))[0m
[30;1m170 | [0m[35m        # TODO delay metadata lookup until we need it[0m
[30;1m171 | [0m[35m        environment['agent_metadata'] = environment.get('agent_metadata') or AgentMetadata()[0m
[30;1m172 | [0m[35m        environment['errors_metadata'] = environment.get('errors_metadata') or ErrorsMetadata()[0m
[30;1m173 | [0m[35m        environment['collector'] = environment.get('collector') or self._select_collector(environmen[0m
[30;1m174 | [0m[35m        environment["profiler_disabler"] = environment.get('profiler_disabler') or ProfilerDisabler([0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m162 | [0m[35m        environment.update(environment_override)[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m        # set additional parameters if needed (costly default init or depend on other parameters)[0m
[30;1m165 | [0m[35m        if environment.get('initial_sampling_interval') is None:[0m
[30;1m166 | [0m[35m            environment['initial_sampling_interval'] = datetime.timedelta([0m
[30;1m167 | [0m[35m                seconds=SystemRandom().uniform(0, AgentConfiguration.get().sampling_interval.total_s[0m
[30;1m168 | [0m[35m        environment['excluded_threads'] = \[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m135 | [0m[35m            self._profiler_runner_instance = profiler_runner_factory(environment=self.environment)[0m
[30;1m136 | [0m[35m        except:[0m
[30;1m137 | [0m[35m            logger.info("Caught exception while creating the CodeGuru Profiler Agent instance", exc_[0m
[30;1m138 | [0m[35m            if environment_override.get("allow_top_level_exceptions") is True:[0m
[30;1m139 | [0m[35m                raise[0m
[30;1m140 | [0m[35m[0m
[30;1m141 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m131 | [0m[35m                del environment_override[key][0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m            self.environment = self._setup_final_environment(self.environment, environment_override)[0m
[30;1m134 | [0m[35m            profiler_runner_factory = self.environment.get("profiler_runner_factory") or ProfilerRun[0m
[30;1m135 | [0m[35m            self._profiler_runner_instance = profiler_runner_factory(environment=self.environment)[0m
[30;1m136 | [0m[35m        except:[0m
[30;1m137 | [0m[35m            logger.info("Caught exception while creating the CodeGuru Profiler Agent instance", exc_[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m119 | [0m[35m                reporting_interval=environment_override.get('reporting_interval'),[0m
[30;1m120 | [0m[35m                minimum_time_reporting=environment_override.get('minimum_time_reporting'),[0m
[30;1m121 | [0m[35m                max_stack_depth=environment_override.get('max_stack_depth'),[0m
[30;1m122 | [0m[35m                cpu_limit_percentage=environment_override.get('cpu_limit_percentage'))[0m
[30;1m123 | [0m[35m            agent_config_merger = AgentConfigurationMerger(default=default_config, user_overrides=us[0m
[30;1m124 | [0m[35m            self.environment["agent_config_merger"] = agent_config_merger[0m
[30;1m125 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m118 | [0m[35m                sampling_interval=environment_override.get('sampling_interval'),[0m
[30;1m119 | [0m[35m                reporting_interval=environment_override.get('reporting_interval'),[0m
[30;1m120 | [0m[35m                minimum_time_reporting=environment_override.get('minimum_time_reporting'),[0m
[30;1m121 | [0m[35m                max_stack_depth=environment_override.get('max_stack_depth'),[0m
[30;1m122 | [0m[35m                cpu_limit_percentage=environment_override.get('cpu_limit_percentage'))[0m
[30;1m123 | [0m[35m            agent_config_merger = AgentConfigurationMerger(default=default_config, user_overrides=us[0m
[30;1m124 | [0m[35m            self.environment["agent_config_merger"] = agent_config_merger[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m117 | [0m[35m                should_profile=environment_override.get('should_profile'),[0m
[30;1m118 | [0m[35m                sampling_interval=environment_override.get('sampling_interval'),[0m
[30;1m119 | [0m[35m                reporting_interval=environment_override.get('reporting_interval'),[0m
[30;1m120 | [0m[35m                minimum_time_reporting=environment_override.get('minimum_time_reporting'),[0m
[30;1m121 | [0m[35m                max_stack_depth=environment_override.get('max_stack_depth'),[0m
[30;1m122 | [0m[35m                cpu_limit_percentage=environment_override.get('cpu_limit_percentage'))[0m
[30;1m123 | [0m[35m            agent_config_merger = AgentConfigurationMerger(default=default_config, user_overrides=us[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m116 | [0m[35m            user_overrides = AgentConfiguration([0m
[30;1m117 | [0m[35m                should_profile=environment_override.get('should_profile'),[0m
[30;1m118 | [0m[35m                sampling_interval=environment_override.get('sampling_interval'),[0m
[30;1m119 | [0m[35m                reporting_interval=environment_override.get('reporting_interval'),[0m
[30;1m120 | [0m[35m                minimum_time_reporting=environment_override.get('minimum_time_reporting'),[0m
[30;1m121 | [0m[35m                max_stack_depth=environment_override.get('max_stack_depth'),[0m
[30;1m122 | [0m[35m                cpu_limit_percentage=environment_override.get('cpu_limit_percentage'))[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m115 | [0m[35m                cpu_limit_percentage=self.environment["cpu_limit_percentage"])[0m
[30;1m116 | [0m[35m            user_overrides = AgentConfiguration([0m
[30;1m117 | [0m[35m                should_profile=environment_override.get('should_profile'),[0m
[30;1m118 | [0m[35m                sampling_interval=environment_override.get('sampling_interval'),[0m
[30;1m119 | [0m[35m                reporting_interval=environment_override.get('reporting_interval'),[0m
[30;1m120 | [0m[35m                minimum_time_reporting=environment_override.get('minimum_time_reporting'),[0m
[30;1m121 | [0m[35m                max_stack_depth=environment_override.get('max_stack_depth'),[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m114 | [0m[35m                max_stack_depth=self.environment["max_stack_depth"],[0m
[30;1m115 | [0m[35m                cpu_limit_percentage=self.environment["cpu_limit_percentage"])[0m
[30;1m116 | [0m[35m            user_overrides = AgentConfiguration([0m
[30;1m117 | [0m[35m                should_profile=environment_override.get('should_profile'),[0m
[30;1m118 | [0m[35m                sampling_interval=environment_override.get('sampling_interval'),[0m
[30;1m119 | [0m[35m                reporting_interval=environment_override.get('reporting_interval'),[0m
[30;1m120 | [0m[35m                minimum_time_reporting=environment_override.get('minimum_time_reporting'),[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m71 | [0m[35m                Check https://boto3.amazonaws.com/v1/documentation/api/latest/guide/session.html for[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m        - Advanced Configuration Options - We recommend not to touch these[0m
[30;1m74 | [0m[35m            :param environment_override: custom dependency container dictionary. allows custom behav[0m
[30;1m75 | [0m[35m                but please note that we do not guarantee compatibility between any different profile[0m
[30;1m76 | [0m[35m                this api (default: dict()). Possible keys:[0m
[30;1m77 | [0m[35m                    - reporting_interval: delay between profile reports in datetime.timedelta (defau[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/aws_lambda/lambda_handler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mdef load_handler(handler_extractor, env=os.environ, original_handler_env_key=HANDLER_ENV_NAME_FOR_CO[0m
[30;1m13 | [0m[35m    try:[0m
[30;1m14 | [0m[35m        original_handler_name = env.get(original_handler_env_key)[0m
[30;1m15 | [0m[35m        if not original_handler_name:[0m
[30;1m16 | [0m[35m            raise ValueError("Could not find module and function name from " + HANDLER_ENV_NAME_FOR_[0m
[30;1m17 | [0m[35m                             + " environment variable")[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/codeguru_client_builder.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m25 | [0m[35m        self._provided_endpoint_url = environment.get("endpoint_url")[0m
[30;1m26 | [0m[35m        self._codeguru_client_instance = environment.get("codeguru_profiler_client")[0m
[30;1m27 | [0m[35m        self._aws_session = environment.get("aws_session")[0m
[30;1m28 | [0m[35m        self._region_name = environment.get("region_name")[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    @property[0m
[30;1m31 | [0m[35m    def codeguru_client(self):[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/codeguru_client_builder.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m24 | [0m[35m    def __init__(self, environment):[0m
[30;1m25 | [0m[35m        self._provided_endpoint_url = environment.get("endpoint_url")[0m
[30;1m26 | [0m[35m        self._codeguru_client_instance = environment.get("codeguru_profiler_client")[0m
[30;1m27 | [0m[35m        self._aws_session = environment.get("aws_session")[0m
[30;1m28 | [0m[35m        self._region_name = environment.get("region_name")[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/codeguru_client_builder.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m    def __init__(self, environment):[0m
[30;1m25 | [0m[35m        self._provided_endpoint_url = environment.get("endpoint_url")[0m
[30;1m26 | [0m[35m        self._codeguru_client_instance = environment.get("codeguru_profiler_client")[0m
[30;1m27 | [0m[35m        self._aws_session = environment.get("aws_session")[0m
[30;1m28 | [0m[35m        self._region_name = environment.get("region_name")[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/codeguru_client_builder.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m22 | [0m[35m    """[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m    def __init__(self, environment):[0m
[30;1m25 | [0m[35m        self._provided_endpoint_url = environment.get("endpoint_url")[0m
[30;1m26 | [0m[35m        self._codeguru_client_instance = environment.get("codeguru_profiler_client")[0m
[30;1m27 | [0m[35m        self._aws_session = environment.get("aws_session")[0m
[30;1m28 | [0m[35m        self._region_name = environment.get("region_name")[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m143 | [0m[35m        profiling_group_name = _get_profiling_group_name(pg_name, name_from_arn, env)[0m
[30;1m144 | [0m[35m        if not profiling_group_name:[0m
[30;1m145 | [0m[35m            if should_autocreate_profiling_group:[0m
[30;1m146 | [0m[35m                profiling_group_name = "aws-lambda-" + env.get(AWS_LAMBDA_FUNCTION_NAME_ENV_VAR_KEY)[0m
[30;1m147 | [0m[35m            else:[0m
[30;1m148 | [0m[35m                logger.info("Could not find a profiling group name to start the CodeGuru Profiler ag[0m
[30;1m149 | [0m[35m                            + "Add command line argument or environment variable. e.g. " + PG_ARN_EN[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m104 | [0m[35m    the credential file path gets set globally through setting the env variable AWS_SHARED_CREDENTIA[0m
[30;1m105 | [0m[35m    reconsider whether we should support this override or not.[0m
[30;1m106 | [0m[35m    """[0m
[30;1m107 | [0m[35m    if env.get(CREDENTIAL_PATH):[0m
[30;1m108 | [0m[35m        logger.info("Credential detected from environment variable " + CREDENTIAL_PATH + ". Unfortun[0m
[30;1m109 | [0m[35m                       "do not support setting credential file path through env variable yet for Pyt[0m
[30;1m110 | [0m[35m                       "Please follow the guide on https://boto3.amazonaws.com/v1/documentation/api/[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m91 | [0m[35m    """[0m
[30;1m92 | [0m[35m    By default profiler is enabled, any value in the environment variable other than "true" (case-in[0m
[30;1m93 | [0m[35m    """[0m
[30;1m94 | [0m[35m    enable_env_value = env.get(ENABLED_ENV, 'true').lower()[0m
[30;1m95 | [0m[35m    result = enable_env_value == 'true'[0m
[30;1m96 | [0m[35m    if not result:[0m
[30;1m97 | [0m[35m        logger.info(ENABLED_ENV + " is set to " + enable_env_value + ", CodeGuru Profiler is disable[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35mdef _get_region_from_env(region_from_arn=None, env=os.environ):[0m
[30;1m83 | [0m[35m    region_from_env = env.get(REGION_ENV)[0m
[30;1m84 | [0m[35m    if region_from_env and region_from_arn and region_from_env != region_from_arn:[0m
[30;1m85 | [0m[35m        logger.info("Different region found from " + REGION_ENV + " and " + PG_ARN_ENV +[0m
[30;1m86 | [0m[35m                    " will use value from " + PG_ARN_ENV + " : " + region_from_arn)[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35mdef _get_profiling_group_name_from_env(pg_name_from_arn=None, env=os.environ):[0m
[30;1m71 | [0m[35m    pg_name_from_env = env.get(PG_NAME_ENV)[0m
[30;1m72 | [0m[35m    if pg_name_from_env and pg_name_from_arn and pg_name_from_env != pg_name_from_arn:[0m
[30;1m73 | [0m[35m        logger.info("Different Profiling group name found from " + PG_NAME_ENV + " and " + PG_ARN_EN[0m
[30;1m74 | [0m[35m                    " will use value from " + PG_ARN_ENV + " : " + pg_name_from_arn)[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m49 | [0m[35m    :param env: typically os.environ[0m
[30;1m50 | [0m[35m    :return: (name, region, account id)[0m
[30;1m51 | [0m[35m    """[0m
[30;1m52 | [0m[35m    arn = env.get(PG_ARN_ENV)[0m
[30;1m53 | [0m[35m    if not arn:[0m
[30;1m54 | [0m[35m        return None, None, None[0m
[30;1m55 | [0m[35m    parts = arn.split(':')[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mdef _read_millis(override, env_name, override_key, env=os.environ):[0m
[30;1m29 | [0m[35m    value = env.get(env_name)[0m
[30;1m30 | [0m[35m    if value:[0m
[30;1m31 | [0m[35m        try:[0m
[30;1m32 | [0m[35m            override[override_key] = datetime.timedelta(milliseconds=int(value))[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m18 | [0m[35mENABLED_ENV = "AWS_CODEGURU_PROFILER_ENABLED"[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m# Environment variables provided by AWS Lambda[0m
[30;1m21 | [0m[35mAWS_LAMBDA_FUNCTION_NAME_ENV_VAR_KEY = "AWS_LAMBDA_FUNCTION_NAME"[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m# non documented parameters[0m
[30;1m24 | [0m[35mSAMPLING_INTERVAL = "AWS_CODEGURU_PROFILER_SAMPLING_INTERVAL_MS"[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m12 | [0m[35m# TODO: Should we move these logic to Profiler instead?[0m
[30;1m13 | [0m[35mPG_NAME_ENV = "AWS_CODEGURU_PROFILER_GROUP_NAME"[0m
[30;1m14 | [0m[35mPG_ARN_ENV = "AWS_CODEGURU_PROFILER_GROUP_ARN"[0m
[30;1m15 | [0m[35mREGION_ENV = "AWS_CODEGURU_PROFILER_TARGET_REGION"[0m
[30;1m16 | [0m[35m# Note: Please check function `check_credential_through_environment` before supporting the following[0m
[30;1m17 | [0m[35mCREDENTIAL_PATH = "AWS_CODEGURU_PROFILER_CREDENTIAL_PATH"[0m
[30;1m18 | [0m[35mENABLED_ENV = "AWS_CODEGURU_PROFILER_ENABLED"[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/local_aggregator.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m42 | [0m[35m        self.errors_metadata = environment["errors_metadata"][0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m        self.profile_factory = environment.get("profile_factory") or Profile[0m
[30;1m45 | [0m[35m        self.clock = environment.get("clock") or time.time[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m        self.profile = None[0m
[30;1m48 | [0m[35m        self.memory_limit_bytes = environment["memory_limit_bytes"][0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/local_aggregator.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m41 | [0m[35m        self.timer = environment["timer"][0m
[30;1m42 | [0m[35m        self.errors_metadata = environment["errors_metadata"][0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m        self.profile_factory = environment.get("profile_factory") or Profile[0m
[30;1m45 | [0m[35m        self.clock = environment.get("clock") or time.time[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m        self.profile = None[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/local_aggregator.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m25 | [0m[35m    def __init__(self, reporter, environment=dict()):[0m
[30;1m26 | [0m[35m        """[0m
[30;1m27 | [0m[35m        :param reporter: reporter object used for reporting profiles[0m
[30;1m28 | [0m[35m        :param environment: dependency container dictionary for the current profiler[0m
[30;1m29 | [0m[35m        :param profiling_group_name: (required inside environment) name of the profiling group[0m
[30;1m30 | [0m[35m        :param memory_limit_bytes: (required inside environment) memory limit (Bytes) for profiler[0m
[30;1m31 | [0m[35m        :param host_weight: (required inside environment) scale factor used to rescale the profile c[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sampler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m30 | [0m[35m        self._get_stacks = \[0m
[30;1m31 | [0m[35m            environment.get("get_stacks") or codeguru_profiler_agent.sampling_utils.get_stacks[0m
[30;1m32 | [0m[35m        self._thread_lister = environment.get("thread_lister") or sys[0m
[30;1m33 | [0m[35m        self.timer = environment.get("timer")[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m    @with_timer("dumpAllStackTraces")[0m
[30;1m36 | [0m[35m    def sample(self):[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sampler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m29 | [0m[35m        self._excluded_threads = environment.get("excluded_threads") or set()[0m
[30;1m30 | [0m[35m        self._get_stacks = \[0m
[30;1m31 | [0m[35m            environment.get("get_stacks") or codeguru_profiler_agent.sampling_utils.get_stacks[0m
[30;1m32 | [0m[35m        self._thread_lister = environment.get("thread_lister") or sys[0m
[30;1m33 | [0m[35m        self.timer = environment.get("timer")[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m    @with_timer("dumpAllStackTraces")[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sampler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m28 | [0m[35m        self._max_threads = environment.get("max_threads") or 100[0m
[30;1m29 | [0m[35m        self._excluded_threads = environment.get("excluded_threads") or set()[0m
[30;1m30 | [0m[35m        self._get_stacks = \[0m
[30;1m31 | [0m[35m            environment.get("get_stacks") or codeguru_profiler_agent.sampling_utils.get_stacks[0m
[30;1m32 | [0m[35m        self._thread_lister = environment.get("thread_lister") or sys[0m
[30;1m33 | [0m[35m        self.timer = environment.get("timer")[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sampler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m26 | [0m[35m        :param excluded_threads: (inside environment) set of thread names to be excluded from sampli[0m
[30;1m27 | [0m[35m        """[0m
[30;1m28 | [0m[35m        self._max_threads = environment.get("max_threads") or 100[0m
[30;1m29 | [0m[35m        self._excluded_threads = environment.get("excluded_threads") or set()[0m
[30;1m30 | [0m[35m        self._get_stacks = \[0m
[30;1m31 | [0m[35m            environment.get("get_stacks") or codeguru_profiler_agent.sampling_utils.get_stacks[0m
[30;1m32 | [0m[35m        self._thread_lister = environment.get("thread_lister") or sys[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sampler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m25 | [0m[35m        :param max_threads: (inside environment) the max number of threads getting sampled[0m
[30;1m26 | [0m[35m        :param excluded_threads: (inside environment) set of thread names to be excluded from sampli[0m
[30;1m27 | [0m[35m        """[0m
[30;1m28 | [0m[35m        self._max_threads = environment.get("max_threads") or 100[0m
[30;1m29 | [0m[35m        self._excluded_threads = environment.get("excluded_threads") or set()[0m
[30;1m30 | [0m[35m        self._get_stacks = \[0m
[30;1m31 | [0m[35m            environment.get("get_stacks") or codeguru_profiler_agent.sampling_utils.get_stacks[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sampler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m22 | [0m[35m    def __init__(self, environment=dict()):[0m
[30;1m23 | [0m[35m        """[0m
[30;1m24 | [0m[35m        :param environment: dependency container dictionary for the current profiler[0m
[30;1m25 | [0m[35m        :param max_threads: (inside environment) the max number of threads getting sampled[0m
[30;1m26 | [0m[35m        :param excluded_threads: (inside environment) set of thread names to be excluded from sampli[0m
[30;1m27 | [0m[35m        """[0m
[30;1m28 | [0m[35m        self._max_threads = environment.get("max_threads") or 100[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sampler.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    def __init__(self, environment=dict()):[0m
[30;1m23 | [0m[35m        """[0m
[30;1m24 | [0m[35m        :param environment: dependency container dictionary for the current profiler[0m
[30;1m25 | [0m[35m        :param max_threads: (inside environment) the max number of threads getting sampled[0m
[30;1m26 | [0m[35m        :param excluded_threads: (inside environment) set of thread names to be excluded from sampli[0m
[30;1m27 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/file_reporter/file_reporter.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m21 | [0m[35m        """[0m
[30;1m22 | [0m[35m        self._file_prefix = environment["file_prefix"][0m
[30;1m23 | [0m[35m        self._profile_encoder = \[0m
[30;1m24 | [0m[35m            environment.get("profile_encoder") or ProfileEncoder(gzip=False, environment=environment[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def setup(self):[0m
[30;1m27 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/file_reporter/file_reporter.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    def __init__(self, environment=dict()):[0m
[30;1m18 | [0m[35m        """[0m
[30;1m19 | [0m[35m        :param environment: dependency container dictionary for the current profiler[0m
[30;1m20 | [0m[35m        :param file_prefix: (required inside environment) path + file prefix to use for profile repo[0m
[30;1m21 | [0m[35m        """[0m
[30;1m22 | [0m[35m        self._file_prefix = environment["file_prefix"][0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/aws_lambda/profiler_decorator.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m31 | [0m[35m    :param region_name: AWS Region to report to, given profiling group name must exist in that regio[0m
[30;1m32 | [0m[35m        that this value overwrites what is used in aws_session. If not provided, boto3 will search[0m
[30;1m33 | [0m[35m        configuration for the region. (e.g. "us-west-2")[0m
[30;1m34 | [0m[35m    :param environment_override: custom dependency container dictionary. allows custom behavior to b[0m
[30;1m35 | [0m[35m        See Profiler class for details.[0m
[30;1m36 | [0m[35m    """[0m
[30;1m37 | [0m[35m    def function_decorator(function):[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sdk_reporter/sdk_reporter.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m173 | [0m[35m        Check if the compute platform is AWS Lambda.[0m
[30;1m174 | [0m[35m        """[0m
[30;1m175 | [0m[35m        does_lambda_task_root_exist = os.environ.get(LAMBDA_TASK_ROOT)[0m
[30;1m176 | [0m[35m        does_lambda_runtime_dir_exist = os.environ.get(LAMBDA_RUNTIME_DIR)[0m
[30;1m177 | [0m[35m        return bool(does_lambda_task_root_exist) and bool(does_lambda_runtime_dir_exist)[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sdk_reporter/sdk_reporter.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m172 | [0m[35m        """[0m
[30;1m173 | [0m[35m        Check if the compute platform is AWS Lambda.[0m
[30;1m174 | [0m[35m        """[0m
[30;1m175 | [0m[35m        does_lambda_task_root_exist = os.environ.get(LAMBDA_TASK_ROOT)[0m
[30;1m176 | [0m[35m        does_lambda_runtime_dir_exist = os.environ.get(LAMBDA_RUNTIME_DIR)[0m
[30;1m177 | [0m[35m        return bool(does_lambda_task_root_exist) and bool(does_lambda_runtime_dir_exist)[0m
[30;1m178 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sdk_reporter/sdk_reporter.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m34 | [0m[35m        # TODO decide if we need to compress with gzip or not.[0m
[30;1m35 | [0m[35m        self.profile_encoder = \[0m
[30;1m36 | [0m[35m            environment.get("profile_encoder") or ProfileEncoder(environment=environment, gzip=False[0m
[30;1m37 | [0m[35m        self.timer = environment.get("timer")[0m
[30;1m38 | [0m[35m        self.metadata = environment["agent_metadata"][0m
[30;1m39 | [0m[35m        self.agent_config_merger = environment["agent_config_merger"][0m
[30;1m40 | [0m[35m        self.errors_metadata = environment["errors_metadata"][0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sdk_reporter/sdk_reporter.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m33 | [0m[35m        self.codeguru_client_builder = environment["codeguru_profiler_builder"][0m
[30;1m34 | [0m[35m        # TODO decide if we need to compress with gzip or not.[0m
[30;1m35 | [0m[35m        self.profile_encoder = \[0m
[30;1m36 | [0m[35m            environment.get("profile_encoder") or ProfileEncoder(environment=environment, gzip=False[0m
[30;1m37 | [0m[35m        self.timer = environment.get("timer")[0m
[30;1m38 | [0m[35m        self.metadata = environment["agent_metadata"][0m
[30;1m39 | [0m[35m        self.agent_config_merger = environment["agent_config_merger"][0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sdk_reporter/sdk_reporter.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def __init__(self, environment):[0m
[30;1m27 | [0m[35m        """[0m
[30;1m28 | [0m[35m        :param environment: dependency container dictionary for the current profiler.[0m
[30;1m29 | [0m[35m        :param profiling_group_name: (required inside environment) name of the profiling group.[0m
[30;1m30 | [0m[35m        :param codeguru_profiler_client: (required inside environment) sdk client for CodeGuru Profi[0m
[30;1m31 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/aws_ec2_instance.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m13 | [0m[35m# https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instancedata-data-retrieval.html[0m
[30;1m14 | [0m[35m# Bandit marks the following line as risky because it contains the word "token",[0m
[30;1m15 | [0m[35m# thought it doesn't contain any secret; ignoring with # nosec[0m
[30;1m16 | [0m[35m# https://bandit.readthedocs.io/en/latest/plugins/b105_hardcoded_password_string.html[0m
[30;1m17 | [0m[35mEC2_API_TOKEN_URI = "http://169.254.169.254/latest/api/token"  # nosec[0m
[30;1m18 | [0m[35mEC2_METADATA_TOKEN_HEADER_KEY = 'X-aws-ec2-metadata-token'  # nosec[0m
[30;1m19 | [0m[35mEC2_METADATA_TOKEN_TTL_HEADER_KEY = 'X-aws-ec2-metadata-token-ttl-seconds'  # nosec[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/aws_lambda.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m24 | [0m[35mEXECUTION_ENVIRONMENT_KEY = "ExecutionEnvironment"[0m
[30;1m25 | [0m[35mLAMBDA_FUNCTION_ARN_KEY = "LambdaFunctionArn"[0m
[30;1m26 | [0m[35mLAMBDA_MEMORY_LIMIT_IN_MB_KEY = "LambdaMemoryLimitInMB"[0m
[30;1m27 | [0m[35mLAMBDA_PREVIOUS_EXECUTION_TIME_IN_MILLISECONDS_KEY = "LambdaPreviousExecutionTimeInMilliseconds"[0m
[30;1m28 | [0m[35mLAMBDA_REMAINING_TIME_IN_MILLISECONDS_KEY = "LambdaRemainingTimeInMilliseconds"[0m
[30;1m29 | [0m[35m# LambdaTimeGapBetweenInvokesInMilliseconds not sent at the moment[0m
[30;1m30 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/agent_debug_info.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m63 | [0m[35m            self.create_profiling_group_errors += 1[0m
[30;1m64 | [0m[35m        elif error_type == "postAgentProfileErrors":[0m
[30;1m65 | [0m[35m            self.post_agent_profile_errors += 1[0m
[30;1m66 | [0m[35m        elif error_type == "postAgentProfileRnfeAutoCreateEnabledErrors":[0m
[30;1m67 | [0m[35m            self.post_agent_profile_errors += 1[0m
[30;1m68 | [0m[35m            self.post_agent_profile_rnfe_auto_create_enabled_errors += 1[0m
[30;1m69 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/agent_debug_info.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m56 | [0m[35m        """[0m
[30;1m57 | [0m[35m        if error_type == "configureAgentErrors":[0m
[30;1m58 | [0m[35m            self.configure_agent_errors += 1[0m
[30;1m59 | [0m[35m        elif error_type == "configureAgentRnfeAutoCreateEnabledErrors":[0m
[30;1m60 | [0m[35m            self.configure_agent_errors += 1[0m
[30;1m61 | [0m[35m            self.configure_agent_rnfe_auto_create_enabled_errors += 1[0m
[30;1m62 | [0m[35m        elif error_type == "createProfilingGroupErrors":[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/agent_debug_info.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m36 | [0m[35m            "configureAgentRnfeAutoCreateEnabledErrors": self.configure_agent_rnfe_auto_create_enabl[0m
[30;1m37 | [0m[35m            "createProfilingGroupErrors": self.create_profiling_group_errors,[0m
[30;1m38 | [0m[35m            "postAgentProfileErrors": self.post_agent_profile_errors,[0m
[30;1m39 | [0m[35m            "postAgentProfileRnfeAutoCreateEnabledErrors": self.post_agent_profile_rnfe_auto_create_[0m
[30;1m40 | [0m[35m        }[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    @synchronized[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/agent_debug_info.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m33 | [0m[35m            "errorsCount": self.errors_count,[0m
[30;1m34 | [0m[35m            "sdkClientErrors": self.sdk_client_errors,[0m
[30;1m35 | [0m[35m            "configureAgentErrors": self.configure_agent_errors,[0m
[30;1m36 | [0m[35m            "configureAgentRnfeAutoCreateEnabledErrors": self.configure_agent_rnfe_auto_create_enabl[0m
[30;1m37 | [0m[35m            "createProfilingGroupErrors": self.create_profiling_group_errors,[0m
[30;1m38 | [0m[35m            "postAgentProfileErrors": self.post_agent_profile_errors,[0m
[30;1m39 | [0m[35m            "postAgentProfileRnfeAutoCreateEnabledErrors": self.post_agent_profile_rnfe_auto_create_[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sdk_reporter/sdk_reporter.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m125 | [0m[35m            if error.response['Error']['Code'] == 'ResourceNotFoundException':[0m
[30;1m126 | [0m[35m                if self.should_auto_create_profiling_group():[0m
[30;1m127 | [0m[35m                    self.__class__.is_create_pg_called_during_submit_profile = True[0m
[30;1m128 | [0m[35m                    self.errors_metadata.record_sdk_error("postAgentProfileRnfeAutoCreateEnabledErro[0m
[30;1m129 | [0m[35m                    logger.info([0m
[30;1m130 | [0m[35m                        "Profiling group not found. Will try to create a profiling group "[0m
[30;1m131 | [0m[35m                        "with name = {} and compute platform = {} and retry reporting during next in[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sdk_reporter/sdk_reporter.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m84 | [0m[35m                self._log_request_failed(operation="configure_agent", exception=error)[0m
[30;1m85 | [0m[35m            elif error.response['Error']['Code'] == 'ResourceNotFoundException':[0m
[30;1m86 | [0m[35m                if self.should_auto_create_profiling_group():[0m
[30;1m87 | [0m[35m                    self.errors_metadata.record_sdk_error("configureAgentRnfeAutoCreateEnabledErrors[0m
[30;1m88 | [0m[35m                    logger.info([0m
[30;1m89 | [0m[35m                        "Profiling group not found. Will try to create a profiling group "[0m
[30;1m90 | [0m[35m                        "with name = {} and compute platform = {} and retry calling configure agent [0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_disabler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m    @staticmethod[0m
[30;1m91 | [0m[35m    def _get_average_sampling_interval_seconds(profile):[0m
[30;1m92 | [0m[35m        if profile is None or profile.total_sample_count < MINIMUM_SAMPLES_IN_PROFILE:[0m
[30;1m93 | [0m[35m            return AgentConfiguration.get().sampling_interval.total_seconds()[0m
[30;1m94 | [0m[35m        return (profile.get_active_millis_since_start() / profile.total_sample_count) / 1000[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_disabler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m        sampling_interval_seconds = self._get_average_sampling_interval_seconds(profile)[0m
[30;1m76 | [0m[35m        used_time_percentage = 100 * sample_and_aggregate_metric.average() / sampling_interval_secon[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m        cpu_limit_percentage = AgentConfiguration.get().cpu_limit_percentage[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        if used_time_percentage >= cpu_limit_percentage:[0m
[30;1m81 | [0m[35m            logger.debug(self.timer.metrics)[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_disabler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m            return False[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    def is_sampling_cpu_usage_limit_reached(self, profile=None):[0m
[30;1m70 | [0m[35m        sample_and_aggregate_metric = self.timer.metrics.get("sampleAndAggregate")[0m
[30;1m71 | [0m[35m        if not sample_and_aggregate_metric or \[0m
[30;1m72 | [0m[35m                sample_and_aggregate_metric.counter < MINIMUM_MEASURES_IN_DURATION_METRICS:[0m
[30;1m73 | [0m[35m            return False[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_disabler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m        used_time_percentage = 100 * profiler_metric.total/(profile.get_active_millis_since_start()/[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m        cpu_limit_percentage = AgentConfiguration.get().cpu_limit_percentage[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m        if used_time_percentage >= cpu_limit_percentage:[0m
[30;1m60 | [0m[35m            logger.debug(self.timer.metrics)[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_disabler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m        sampling cycle: refresh config -> (sample -> aggregate) * n -> profile submission. We expect[0m
[30;1m49 | [0m[35m        be called after profile submission.[0m
[30;1m50 | [0m[35m        """[0m
[30;1m51 | [0m[35m        profiler_metric = self.timer.metrics.get("runProfiler")[0m
[30;1m52 | [0m[35m        if not profile or not profiler_metric or profiler_metric.counter < MINIMUM_MEASURES_IN_DURAT[0m
[30;1m53 | [0m[35m            return False[0m
[30;1m54 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_disabler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m114 | [0m[35m            self.last_check_for_file_time = now[0m
[30;1m115 | [0m[35m            if self.last_check_for_file_result:[0m
[30;1m116 | [0m[35m                logger.info([0m
[30;1m117 | [0m[35m                    "Found kill-switch file at {}, will stop CodeGuru Profiler.".format(self.killswi[0m
[30;1m118 | [0m[35m        return self.last_check_for_file_result[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_disabler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m    def is_overall_cpu_usage_limit_reached(self, profile=None):[0m
[30;1m46 | [0m[35m        """[0m
[30;1m47 | [0m[35m        This function carries out an overall cpu limit check that covers the cpu overhead caused for[0m
[30;1m48 | [0m[35m        sampling cycle: refresh config -> (sample -> aggregate) * n -> profile submission. We expect[0m
[30;1m49 | [0m[35m        be called after profile submission.[0m
[30;1m50 | [0m[35m        """[0m
[30;1m51 | [0m[35m        profiler_metric = self.timer.metrics.get("runProfiler")[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_disabler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport os[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mimport logging[0m
[30;1m4 | [0m[35mfrom codeguru_profiler_agent.reporter.agent_configuration import AgentConfiguration[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mlogger = logging.getLogger(__name__)[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/utils/execution_state.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m            return None[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m    def _wait_for_resume(self):[0m
[30;1m100 | [0m[35m        return self._state_changes.get(block=True)[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m    def _apply_new_state(self, new_state):[0m
[30;1m103 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/utils/execution_state.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m            return None[0m
[30;1m93 | [0m[35m        try:[0m
[30;1m94 | [0m[35m            wait_time = max(0.0, next_delay_seconds - self._already_waited_seconds)[0m
[30;1m95 | [0m[35m            return self._state_changes.get(block=True, timeout=wait_time)[0m
[30;1m96 | [0m[35m        except Empty:[0m
[30;1m97 | [0m[35m            return None[0m
[30;1m98 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/utils/execution_state.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m131 | [0m[35m                new_state = self._wait_for_resume()[0m
[30;1m132 | [0m[35m            else:[0m
[30;1m133 | [0m[35m                new_state = self._wait_for_execution_time()[0m
[30;1m134 | [0m[35m            # update state, if there is no change in the state after waiting then it is time to exec[0m
[30;1m135 | [0m[35m            is_time_to_execute = not self._apply_new_state(new_state)[0m
[30;1m136 | [0m[35m            if new_state:[0m
[30;1m137 | [0m[35m                self._state_changes.task_done()[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/utils/execution_state.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m122 | [0m[35m        If initial_delay was set to 0 this will return True even if we[0m
[30;1m123 | [0m[35m        have immediately paused or stopped.[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m        :return: True if the status is RUNNING at the end. False otherwise.[0m
[30;1m126 | [0m[35m        """[0m
[30;1m127 | [0m[35m        is_time_to_execute = False[0m
[30;1m128 | [0m[35m        while self._current_state is not ExecutionState.STOPPED and not is_time_to_execute:[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/utils/execution_state.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m118 | [0m[35m    def wait_for_next_tick_or_stop(self):[0m
[30;1m119 | [0m[35m        """[0m
[30;1m120 | [0m[35m        Wait until it is time to execute or the process is stopped.[0m
[30;1m121 | [0m[35m        Status should either be RUNNING or STOPPED at the end.[0m
[30;1m122 | [0m[35m        If initial_delay was set to 0 this will return True even if we[0m
[30;1m123 | [0m[35m        have immediately paused or stopped.[0m
[30;1m124 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/utils/execution_state.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m    def _apply_new_state(self, new_state):[0m
[30;1m103 | [0m[35m        """[0m
[30;1m104 | [0m[35m        Update the current state variable and save the waited time if we paused.[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m        :return True if there was a change in the state, False otherwise.[0m
[30;1m107 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/utils/execution_state.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m136 | [0m[35m            if new_state:[0m
[30;1m137 | [0m[35m                self._state_changes.task_done()[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m        # if we exit the while loop that means either we are stopped or it is time to execute[0m
[30;1m140 | [0m[35m        # remove the initial_delay as we do not need it anymore, also reset _already_waited_seconds[0m
[30;1m141 | [0m[35m        self.initial_delay = None[0m
[30;1m142 | [0m[35m        self._already_waited_seconds = 0.0[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/utils/execution_state.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m131 | [0m[35m                new_state = self._wait_for_resume()[0m
[30;1m132 | [0m[35m            else:[0m
[30;1m133 | [0m[35m                new_state = self._wait_for_execution_time()[0m
[30;1m134 | [0m[35m            # update state, if there is no change in the state after waiting then it is time to exec[0m
[30;1m135 | [0m[35m            is_time_to_execute = not self._apply_new_state(new_state)[0m
[30;1m136 | [0m[35m            if new_state:[0m
[30;1m137 | [0m[35m                self._state_changes.task_done()[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/utils/execution_state.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m    def wait_for_next_tick_or_stop(self):[0m
[30;1m119 | [0m[35m        """[0m
[30;1m120 | [0m[35m        Wait until it is time to execute or the process is stopped.[0m
[30;1m121 | [0m[35m        Status should either be RUNNING or STOPPED at the end.[0m
[30;1m122 | [0m[35m        If initial_delay was set to 0 this will return True even if we[0m
[30;1m123 | [0m[35m        have immediately paused or stopped.[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/utils/execution_state.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m110 | [0m[35m        self._current_state = new_state["state"][0m
[30;1m111 | [0m[35m        if self._current_state is ExecutionState.PAUSED:[0m
[30;1m112 | [0m[35m            # if we paused, we save how much time we have already waited so we know how much longer [0m
[30;1m113 | [0m[35m            # use the time provided by signal_* call as reference in case we were late to catch up w[0m
[30;1m114 | [0m[35m            now = new_state["current_time"][0m
[30;1m115 | [0m[35m            self._already_waited_seconds += max(0, now - self._time_when_waiting_started)[0m
[30;1m116 | [0m[35m        return True[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/utils/execution_state.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m109 | [0m[35m            return False[0m
[30;1m110 | [0m[35m        self._current_state = new_state["state"][0m
[30;1m111 | [0m[35m        if self._current_state is ExecutionState.PAUSED:[0m
[30;1m112 | [0m[35m            # if we paused, we save how much time we have already waited so we know how much longer [0m
[30;1m113 | [0m[35m            # use the time provided by signal_* call as reference in case we were late to catch up w[0m
[30;1m114 | [0m[35m            now = new_state["current_time"][0m
[30;1m115 | [0m[35m            self._already_waited_seconds += max(0, now - self._time_when_waiting_started)[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/utils/execution_state.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m    def _apply_new_state(self, new_state):[0m
[30;1m103 | [0m[35m        """[0m
[30;1m104 | [0m[35m        Update the current state variable and save the waited time if we paused.[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m        :return True if there was a change in the state, False otherwise.[0m
[30;1m107 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/utils/execution_state.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m85 | [0m[35m        The first time this is called, if initial_delay is an empty timedelta[0m
[30;1m86 | [0m[35m        we return immediately without even checking the queue to avoid the small delay.[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m        :return: The new status change or None if it is time to execute.[0m
[30;1m89 | [0m[35m        """[0m
[30;1m90 | [0m[35m        next_delay_seconds = self.next_delay_seconds()[0m
[30;1m91 | [0m[35m        if next_delay_seconds == 0:[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/utils/execution_state.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m82 | [0m[35m    def _wait_for_execution_time(self):[0m
[30;1m83 | [0m[35m        """[0m
[30;1m84 | [0m[35m        wait for next execution time or for any change of status.[0m
[30;1m85 | [0m[35m        The first time this is called, if initial_delay is an empty timedelta[0m
[30;1m86 | [0m[35m        we return immediately without even checking the queue to avoid the small delay.[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m        :return: The new status change or None if it is time to execute.[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/utils/execution_state.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    def _wait_for_execution_time(self):[0m
[30;1m83 | [0m[35m        """[0m
[30;1m84 | [0m[35m        wait for next execution time or for any change of status.[0m
[30;1m85 | [0m[35m        The first time this is called, if initial_delay is an empty timedelta[0m
[30;1m86 | [0m[35m        we return immediately without even checking the queue to avoid the small delay.[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/utils/execution_state.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35mr sampling thread should only read the state and call wait_for_next_tick_or_stop() which[0m
[30;1m24 | [0m[35m        waits for the appropriate delay and handles pause and resume signals.[0m
[30;1m25 | [0m[35m        :param delay_provider: function that provides the delay as timedelta, default returns always[0m
[30;1m26 | [0m[35m        :param initial_delay: time we have to wait before the first execution, default is empty time[0m
[30;1m27 | [0m[35m        :param state_changes_queue: the queue in which signals for changes are going. used only for [0m
[30;1m28 | [0m[35m        :param clock: a function to return current time, used only for unit tests. default is time.t[0m
[30;1m29 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/utils/execution_state.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom __future__ import absolute_import[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mimport datetime[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom queue import Queue, Empty[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/agent_metadata.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m48 | [0m[35mclass AgentMetadata:[0m
[30;1m49 | [0m[35m    """[0m
[30;1m50 | [0m[35m    This is once instantianted in the profiler.py file, marked as environment variable and reused in[0m
[30;1m51 | [0m[35m    When needed to override for testing other components, update those components to allow a default[0m
[30;1m52 | [0m[35m    agent_metadata, or use the environment["agent_metadata"].[0m
[30;1m53 | [0m[35m    """[0m
[30;1m54 | [0m[35m    def __init__(self,[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/agent_metadata.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m69 | [0m[35m    def serialize_to_json(self, sample_weight, duration_ms, cpu_time_seconds,[0m
[30;1m70 | [0m[35m                          average_num_threads, overhead_ms, memory_usage_mb, total_sample_count):[0m
[30;1m71 | [0m[35m        """[0m
[30;1m72 | [0m[35m        This needs to be compliant with the AgentMetadata schema that is used on the service side.[0m
[30;1m73 | [0m[35m        """[0m
[30;1m74 | [0m[35m        if self.json_rep is None:[0m
[30;1m75 | [0m[35m            self.json_rep = {[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/profile.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m    def add(self, sample):[0m
[30;1m97 | [0m[35m        """[0m
[30;1m98 | [0m[35m        Merge Sample into the call graph and update profile end time pointing to the last sample tim[0m
[30;1m99 | [0m[35m        """[0m
[30;1m100 | [0m[35m        self.total_attempted_sample_threads_count += \[0m
[30;1m101 | [0m[35m            sample.attempted_sample_threads_count[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/profile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m123 | [0m[35m        for frame in stack:[0m
[30;1m124 | [0m[35m            current_node = current_node.update_current_node_and_get_child(frame)[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m        # only increment the end of the stack as we use self time in the graph[0m
[30;1m127 | [0m[35m        current_node.increase_runnable_count(runnable_count_increase)[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m    def get_memory_usage_bytes(self):[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/profile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    def set_overhead_ms(self, duration_timedelta):[0m
[30;1m112 | [0m[35m        """[0m
[30;1m113 | [0m[35m        The overhead is the total cpu time spent profiling since start. It is measured by a Timer ob[0m
[30;1m114 | [0m[35m        to the profile object before we report it so it is only added here because it is more conven[0m
[30;1m115 | [0m[35m        data with the rest of the profile data.[0m
[30;1m116 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/profile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m    def add(self, sample):[0m
[30;1m97 | [0m[35m        """[0m
[30;1m98 | [0m[35m        Merge Sample into the call graph and update profile end time pointing to the last sample tim[0m
[30;1m99 | [0m[35m        """[0m
[30;1m100 | [0m[35m        self.total_attempted_sample_threads_count += \[0m
[30;1m101 | [0m[35m            sample.attempted_sample_threads_count[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/profile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m        end = self.last_pause if self.last_pause is not None else current_milli_time(clock=self._clo[0m
[30;1m88 | [0m[35m        active_time_millis_since_start = end - self.start - self._paused_ms[0m
[30;1m89 | [0m[35m        logger.debug([0m
[30;1m90 | [0m[35m            "Active time since start is {activeTime} which is calculated using start: {start}, end: [0m
[30;1m91 | [0m[35m            .format(activeTime = active_time_millis_since_start, start = self.start, end = self._end[0m
[30;1m92 | [0m[35m        )[0m
[30;1m93 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/profile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m82 | [0m[35m        Ideally we would want to set profile_end to be last sample time and subtract pause times onl[0m
[30;1m83 | [0m[35m        additional work in maintaining pause time which isn't worth as it makes the logic complex wi[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m        So we are setting it to current time and in some corner cases to last_pause time.[0m
[30;1m86 | [0m[35m        """[0m
[30;1m87 | [0m[35m        end = self.last_pause if self.last_pause is not None else current_milli_time(clock=self._clo[0m
[30;1m88 | [0m[35m        active_time_millis_since_start = end - self.start - self._paused_ms[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/profile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m80 | [0m[35m        so that leads to incorrect calculation of active time.[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m        Ideally we would want to set profile_end to be last sample time and subtract pause times onl[0m
[30;1m83 | [0m[35m        additional work in maintaining pause time which isn't worth as it makes the logic complex wi[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m        So we are setting it to current time and in some corner cases to last_pause time.[0m
[30;1m86 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/profile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m        If we consider self.end which is e1 in above case then active time would be e1-s1-(p1+p2+p3)[0m
[30;1m80 | [0m[35m        so that leads to incorrect calculation of active time.[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m        Ideally we would want to set profile_end to be last sample time and subtract pause times onl[0m
[30;1m83 | [0m[35m        additional work in maintaining pause time which isn't worth as it makes the logic complex wi[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m        So we are setting it to current time and in some corner cases to last_pause time.[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/profile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m76 | [0m[35m        SE - self.end (last sample)[0m
[30;1m77 | [0m[35m        REPORT - Calculating active time.[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m        If we consider self.end which is e1 in above case then active time would be e1-s1-(p1+p2+p3)[0m
[30;1m80 | [0m[35m        so that leads to incorrect calculation of active time.[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m        Ideally we would want to set profile_end to be last sample time and subtract pause times onl[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/profile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m        clock time since start.[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        Previously self.end was used to calculate active_millis_since_start but self.end is updated [0m
[30;1m63 | [0m[35m        so in rare cases where a sample is collected before the last pause time then we might add ad[0m
[30;1m64 | [0m[35m        which can lead to incorrect calculation of active time. In worst cases, it can even lead to [0m
[30;1m65 | [0m[35m        on the pause time.[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m        Below is an example indicating the potential error of considering self.end in the calculatio[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/profile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m        clock time since start.[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        Previously self.end was used to calculate active_millis_since_start but self.end is updated [0m
[30;1m63 | [0m[35m        so in rare cases where a sample is collected before the last pause time then we might add ad[0m
[30;1m64 | [0m[35m        which can lead to incorrect calculation of active time. In worst cases, it can even lead to [0m
[30;1m65 | [0m[35m        on the pause time.[0m
[30;1m66 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/profile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m        """[0m
[30;1m58 | [0m[35m        This returns the total "active" wall clock time since start. In AWS lambda the process can b[0m
[30;1m59 | [0m[35m        time while we are frozen should not be counted in here. In an EC2 or other type of host it i[0m
[30;1m60 | [0m[35m        clock time since start.[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        Previously self.end was used to calculate active_millis_since_start but self.end is updated [0m
[30;1m63 | [0m[35m        so in rare cases where a sample is collected before the last pause time then we might add ad[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/profile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m56 | [0m[35m    def get_active_millis_since_start(self):[0m
[30;1m57 | [0m[35m        """[0m
[30;1m58 | [0m[35m        This returns the total "active" wall clock time since start. In AWS lambda the process can b[0m
[30;1m59 | [0m[35m        time while we are frozen should not be counted in here. In an EC2 or other type of host it i[0m
[30;1m60 | [0m[35m        clock time since start.[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        Previously self.end was used to calculate active_millis_since_start but self.end is updated [0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/profile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    def get_active_millis_since_start(self):[0m
[30;1m57 | [0m[35m        """[0m
[30;1m58 | [0m[35m        This returns the total "active" wall clock time since start. In AWS lambda the process can b[0m
[30;1m59 | [0m[35m        time while we are frozen should not be counted in here. In an EC2 or other type of host it i[0m
[30;1m60 | [0m[35m        clock time since start.[0m
[30;1m61 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/profile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m            raise ValueError([0m
[30;1m51 | [0m[35m                "Profile end value must be greater than {}, got {}".format(self.start, value))[0m
[30;1m52 | [0m[35m        self._end = value[0m
[30;1m53 | [0m[35m        # this is the total cpu time spent in this application since start, not just the overhead[0m
[30;1m54 | [0m[35m        self.cpu_time_seconds = time.process_time() - self._start_process_time[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    def get_active_millis_since_start(self):[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/profile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m        self.total_sample_count = 0[0m
[30;1m36 | [0m[35m        self.sampling_interval_ms = int(sampling_interval_seconds * 1000)[0m
[30;1m37 | [0m[35m        self.host_weight = int(host_weight)[0m
[30;1m38 | [0m[35m        self._start_process_time = time.process_time()  # provides process time in fractional second[0m
[30;1m39 | [0m[35m        self.overhead_ms = 0[0m
[30;1m40 | [0m[35m        self.agent_debug_info = agent_debug_info[0m
[30;1m41 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/profile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35mclass Profile:[0m
[30;1m16 | [0m[35m    def __init__(self, profiling_group_name, sampling_interval_seconds, host_weight, start, agent_de[0m
[30;1m17 | [0m[35m        """[0m
[30;1m18 | [0m[35m        A profile holds the root node of the call graph and the metadata related to the profile[0m
[30;1m19 | [0m[35m        """[0m
[30;1m20 | [0m[35m        self.memory_counter = MemoryCounter()[0m
[30;1m21 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/profile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mimport logging[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mfrom random import SystemRandom[0m
[30;1m5 | [0m[35mfrom codeguru_profiler_agent.model.call_graph_node import CallGraphNode[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_runner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m            self.scheduler.update_delay_provider(lambda: AgentConfiguration.get().sampling_interval)[0m
[30;1m65 | [0m[35m        else:[0m
[30;1m66 | [0m[35m            # if we should not profile we can simply wait for the reporting interval and call again [0m
[30;1m67 | [0m[35m            self.scheduler.update_delay_provider(lambda: AgentConfiguration.get().reporting_interval[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    def _profiling_command(self):[0m
[30;1m70 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_runner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m        self.collector.refresh_configuration()[0m
[30;1m62 | [0m[35m        self.is_profiling_in_progress = AgentConfiguration.get().should_profile[0m
[30;1m63 | [0m[35m        if self.is_profiling_in_progress:[0m
[30;1m64 | [0m[35m            self.scheduler.update_delay_provider(lambda: AgentConfiguration.get().sampling_interval)[0m
[30;1m65 | [0m[35m        else:[0m
[30;1m66 | [0m[35m            # if we should not profile we can simply wait for the reporting interval and call again [0m
[30;1m67 | [0m[35m            self.scheduler.update_delay_provider(lambda: AgentConfiguration.get().reporting_interval[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_runner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    def _refresh_configuration(self):[0m
[30;1m61 | [0m[35m        self.collector.refresh_configuration()[0m
[30;1m62 | [0m[35m        self.is_profiling_in_progress = AgentConfiguration.get().should_profile[0m
[30;1m63 | [0m[35m        if self.is_profiling_in_progress:[0m
[30;1m64 | [0m[35m            self.scheduler.update_delay_provider(lambda: AgentConfiguration.get().sampling_interval)[0m
[30;1m65 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_runner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m        self.scheduler = Scheduler([0m
[30;1m38 | [0m[35m            command=self._profiling_command,[0m
[30;1m39 | [0m[35m            delay_provider=lambda: AgentConfiguration.get().sampling_interval,[0m
[30;1m40 | [0m[35m            initial_delay=environment["initial_sampling_interval"],[0m
[30;1m41 | [0m[35m            thread_name=environment["profiler_thread_name"])[0m
[30;1m42 | [0m[35m        self.collector = environment["collector"][0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_runner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m        report_orchestration_scheduler[0m
[30;1m33 | [0m[35m        """[0m
[30;1m34 | [0m[35m        self.timer = environment.get("timer")[0m
[30;1m35 | [0m[35m        self.sampler = environment.get("sampler") or Sampler(environment=environment)[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m        self.scheduler = Scheduler([0m
[30;1m38 | [0m[35m            command=self._profiling_command,[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_runner.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m        :param profiler_thread_name: (required inside environment) Thread name used for running the[0m
[30;1m32 | [0m[35m        report_orchestration_scheduler[0m
[30;1m33 | [0m[35m        """[0m
[30;1m34 | [0m[35m        self.timer = environment.get("timer")[0m
[30;1m35 | [0m[35m        self.sampler = environment.get("sampler") or Sampler(environment=environment)[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m        self.scheduler = Scheduler([0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_runner.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m63 | [0m[35m        if self.is_profiling_in_progress:[0m
[30;1m64 | [0m[35m            self.scheduler.update_delay_provider(lambda: AgentConfiguration.get().sampling_interval)[0m
[30;1m65 | [0m[35m        else:[0m
[30;1m66 | [0m[35m            # if we should not profile we can simply wait for the reporting interval and call again [0m
[30;1m67 | [0m[35m            self.scheduler.update_delay_provider(lambda: AgentConfiguration.get().reporting_interval[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    def _profiling_command(self):[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_runner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35mdictionary for the current profiler[0m
[30;1m25 | [0m[35m        :param sampling_interval: (required inside environment) delay between profile reports in dat[0m
[30;1m26 | [0m[35m        :param killswitch_filepath: (required inside environment) filepath pointing to the killswitc[0m
[30;1m27 | [0m[35m            gets checked every time the profiler samples; the profiler is immediately stopped if thi[0m
[30;1m28 | [0m[35m        :param collector: (required inside environment) collector object to handle sample processing[0m
[30;1m29 | [0m[35m        :param initial_sampling_interval: (required inside environment) Initial delay signal sampler[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_runner.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35mclass ProfilerRunner:[0m
[30;1m12 | [0m[35m    """[0m
[30;1m13 | [0m[35m    ProfilerRunner instantiates and orchestrates all components required for running the profiler.[0m
[30;1m14 | [0m[35m    It implements and checks the kill switch and cpu limit every time before it samples.[0m
[30;1m15 | [0m[35m    This class should only be accessed by Profiler for controlling and monitoring the profiler.[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    NOTE: If CPU usage exceed CPU limit, profiler will be terminated immediately without any attempt[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/aws_fargate_task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m            return cls([0m
[30;1m44 | [0m[35m                task_arn=metadata["TaskARN"],[0m
[30;1m45 | [0m[35m                cpu_limit=metadata.get("Limits", {}).get("CPU"),[0m
[30;1m46 | [0m[35m                memory_limit_in_mb=metadata.get("Limits", {}).get("Memory")[0m
[30;1m47 | [0m[35m            )[0m
[30;1m48 | [0m[35m        except Exception:[0m
[30;1m49 | [0m[35m            # if we are not in a fargate environment we expect to have url being None so we expect t[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/aws_fargate_task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m            return cls([0m
[30;1m44 | [0m[35m                task_arn=metadata["TaskARN"],[0m
[30;1m45 | [0m[35m                cpu_limit=metadata.get("Limits", {}).get("CPU"),[0m
[30;1m46 | [0m[35m                memory_limit_in_mb=metadata.get("Limits", {}).get("Memory")[0m
[30;1m47 | [0m[35m            )[0m
[30;1m48 | [0m[35m        except Exception:[0m
[30;1m49 | [0m[35m            # if we are not in a fargate environment we expect to have url being None so we expect t[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/aws_fargate_task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m            return cls([0m
[30;1m44 | [0m[35m                task_arn=metadata["TaskARN"],[0m
[30;1m45 | [0m[35m                cpu_limit=metadata.get("Limits", {}).get("CPU"),[0m
[30;1m46 | [0m[35m                memory_limit_in_mb=metadata.get("Limits", {}).get("Memory")[0m
[30;1m47 | [0m[35m            )[0m
[30;1m48 | [0m[35m        except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/aws_fargate_task.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m            return cls([0m
[30;1m44 | [0m[35m                task_arn=metadata["TaskARN"],[0m
[30;1m45 | [0m[35m                cpu_limit=metadata.get("Limits", {}).get("CPU"),[0m
[30;1m46 | [0m[35m                memory_limit_in_mb=metadata.get("Limits", {}).get("Memory")[0m
[30;1m47 | [0m[35m            )[0m
[30;1m48 | [0m[35m        except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/aws_fargate_task.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m                memory_limit_in_mb=metadata.get("Limits", {}).get("Memory")[0m
[30;1m47 | [0m[35m            )[0m
[30;1m48 | [0m[35m        except Exception:[0m
[30;1m49 | [0m[35m            # if we are not in a fargate environment we expect to have url being None so we expect t[0m
[30;1m50 | [0m[35m            # catching an exception here should be rare so we do print the stack trace.[0m
[30;1m51 | [0m[35m            logger.info("Unable to get Fargate instance metadata, this is normal when running in a d[0m
[30;1m52 | [0m[35m                        "environment (e.g. local dev machine), profiler will still work: ", exc_info[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/aws_fargate_task.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m                memory_limit_in_mb=metadata.get("Limits", {}).get("Memory")[0m
[30;1m47 | [0m[35m            )[0m
[30;1m48 | [0m[35m        except Exception:[0m
[30;1m49 | [0m[35m            # if we are not in a fargate environment we expect to have url being None so we expect t[0m
[30;1m50 | [0m[35m            # catching an exception here should be rare so we do print the stack trace.[0m
[30;1m51 | [0m[35m            logger.info("Unable to get Fargate instance metadata, this is normal when running in a d[0m
[30;1m52 | [0m[35m                        "environment (e.g. local dev machine), profiler will still work: ", exc_info[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/__main__.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m        # Issue: [B102:exec_used] Use of exec detected.[0m
[30;1m88 | [0m[35m        # https://bandit.readthedocs.io/en/latest/plugins/b102_exec_used.html[0m
[30;1m89 | [0m[35m        # We need exec(..) here to run the code from the customer.[0m
[30;1m90 | [0m[35m        # Only the code from the customer's script is executed and only inside the customer's enviro[0m
[30;1m91 | [0m[35m        # so the customer's code cannot be altered before it is executed.[0m
[30;1m92 | [0m[35m        exec(code, globs, None)  # nosec[0m
[30;1m93 | [0m[35m    finally:[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/aws_lambda.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m        """[0m
[30;1m94 | [0m[35m        # get the singleton lambda context. The decorator should set it.[0m
[30;1m95 | [0m[35m        if lambda_context is None:[0m
[30;1m96 | [0m[35m            lambda_context = LambdaContext.get()[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m        as_map = {[0m
[30;1m99 | [0m[35m            COMPUTE_PLAFORM_KEY: COMPUTE_PLAFORM_VALUE,[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/aws_lambda.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    @classmethod[0m
[30;1m54 | [0m[35m    def __look_execution_env(cls, env=os.environ):[0m
[30;1m55 | [0m[35m        return env.get(LAMBDA_EXECUTION_ENV)[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    @classmethod[0m
[30;1m58 | [0m[35m    def __look_function_arn(cls, context):[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/aws_lambda.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m    @classmethod[0m
[30;1m47 | [0m[35m    def __look_up_memory_limit(cls, env=os.environ):[0m
[30;1m48 | [0m[35m        try:[0m
[30;1m49 | [0m[35m            return int(env.get(LAMBDA_MEMORY_SIZE_ENV))[0m
[30;1m50 | [0m[35m        except (TypeError, ValueError):[0m
[30;1m51 | [0m[35m            return None[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/aws_lambda.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m26 | [0m[35mLAMBDA_MEMORY_LIMIT_IN_MB_KEY = "LambdaMemoryLimitInMB"[0m
[30;1m27 | [0m[35mLAMBDA_PREVIOUS_EXECUTION_TIME_IN_MILLISECONDS_KEY = "LambdaPreviousExecutionTimeInMilliseconds"[0m
[30;1m28 | [0m[35mLAMBDA_REMAINING_TIME_IN_MILLISECONDS_KEY = "LambdaRemainingTimeInMilliseconds"[0m
[30;1m29 | [0m[35m# LambdaTimeGapBetweenInvokesInMilliseconds not sent at the moment[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35mclass AWSLambda(FleetInfo):[0m
[30;1m32 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/aws_lambda.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35mclass AWSLambda(FleetInfo):[0m
[30;1m32 | [0m[35m    """[0m
[30;1m33 | [0m[35m    This class will get and parse the lambda metadata from the environment. For details about availa[0m
[30;1m34 | [0m[35m    See https://docs.aws.amazon.com/lambda/latest/dg/configuration-envvars.html[0m
[30;1m35 | [0m[35m    """[0m
[30;1m36 | [0m[35m    def __init__(self, function_arn, memory_limit_mb, execution_env, agent_id=None):[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/reporter/agent_configuration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m            logger.debug("The response '{}' does not contain key '{}'.".format(response, key))[0m
[30;1m112 | [0m[35m            return default_value[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m        value = response.get(key)[0m
[30;1m115 | [0m[35m        try:[0m
[30;1m116 | [0m[35m            return int(value)[0m
[30;1m117 | [0m[35m        except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/reporter/agent_configuration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m        current = AgentConfiguration.get()[0m
[30;1m68 | [0m[35m        return AgentConfiguration([0m
[30;1m69 | [0m[35m            should_profile=configure_agent_response.get(SHOULD_PROFILE_KEY, current.should_profile),[0m
[30;1m70 | [0m[35m            reporting_interval=cls._get_interval_from_seconds(key=PERIOD_IN_SECONDS_KEY,[0m
[30;1m71 | [0m[35m                                                              response=configure_agent_response,[0m
[30;1m72 | [0m[35m                                                              default_value=current.reporting_interv[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/reporter/agent_configuration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m    def _get_new_config(cls, configure_agent_response=dict()):[0m
[30;1m65 | [0m[35m        agent_parameters_response = configure_agent_response.get("agentParameters", {})[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m        current = AgentConfiguration.get()[0m
[30;1m68 | [0m[35m        return AgentConfiguration([0m
[30;1m69 | [0m[35m            should_profile=configure_agent_response.get(SHOULD_PROFILE_KEY, current.should_profile),[0m
[30;1m70 | [0m[35m            reporting_interval=cls._get_interval_from_seconds(key=PERIOD_IN_SECONDS_KEY,[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/reporter/agent_configuration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    @classmethod[0m
[30;1m64 | [0m[35m    def _get_new_config(cls, configure_agent_response=dict()):[0m
[30;1m65 | [0m[35m        agent_parameters_response = configure_agent_response.get("agentParameters", {})[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m        current = AgentConfiguration.get()[0m
[30;1m68 | [0m[35m        return AgentConfiguration([0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sdk_reporter/profile_encoder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m    def __init__(self, environment=dict(), gzip=True):[0m
[30;1m82 | [0m[35m        self._gzip = gzip[0m
[30;1m83 | [0m[35m        self._agent_metadata = environment["agent_metadata"][0m
[30;1m84 | [0m[35m        self._module_path_extractor = self.ModulePathExtractor(environment.get("sys_path") or sys.pa[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    def encode(self, profile, output_stream):[0m
[30;1m87 | [0m[35m        if self._gzip:[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m278 | [0m[35m            raise Exception("CodeGuru Profiler was not correctly initialized; see previous error mes[0m
[30;1m279 | [0m[35m[0m
[30;1m280 | [0m[35m    def __str__(self):[0m
[30;1m281 | [0m[35m        return 'Profiler(environment=' + str({k: self.environment.get(k) for k in[0m
[30;1m282 | [0m[35m                                              ['max_threads', 'profiling_group_name', 'region_name',[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m    @staticmethod[0m
[30;1m178 | [0m[35m    def _select_collector(environment):[0m
[30;1m179 | [0m[35m        reporting_mode = environment.get('reporting_mode')[0m
[30;1m180 | [0m[35m        if reporting_mode == "codeguru_service":[0m
[30;1m181 | [0m[35m            environment["codeguru_profiler_builder"] = CodeGuruClientBuilder(environment)[0m
[30;1m182 | [0m[35m            return LocalAggregator([0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m171 | [0m[35m        environment['agent_metadata'] = environment.get('agent_metadata') or AgentMetadata()[0m
[30;1m172 | [0m[35m        environment['errors_metadata'] = environment.get('errors_metadata') or ErrorsMetadata()[0m
[30;1m173 | [0m[35m        environment['collector'] = environment.get('collector') or self._select_collector(environmen[0m
[30;1m174 | [0m[35m        environment["profiler_disabler"] = environment.get('profiler_disabler') or ProfilerDisabler([0m
[30;1m175 | [0m[35m        return UnmodifiableDict(environment)[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m170 | [0m[35m        # TODO delay metadata lookup until we need it[0m
[30;1m171 | [0m[35m        environment['agent_metadata'] = environment.get('agent_metadata') or AgentMetadata()[0m
[30;1m172 | [0m[35m        environment['errors_metadata'] = environment.get('errors_metadata') or ErrorsMetadata()[0m
[30;1m173 | [0m[35m        environment['collector'] = environment.get('collector') or self._select_collector(environmen[0m
[30;1m174 | [0m[35m        environment["profiler_disabler"] = environment.get('profiler_disabler') or ProfilerDisabler([0m
[30;1m175 | [0m[35m        return UnmodifiableDict(environment)[0m
[30;1m176 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m            frozenset({environment['profiler_thread_name']}.union(environment['excluded_threads']))[0m
[30;1m170 | [0m[35m        # TODO delay metadata lookup until we need it[0m
[30;1m171 | [0m[35m        environment['agent_metadata'] = environment.get('agent_metadata') or AgentMetadata()[0m
[30;1m172 | [0m[35m        environment['errors_metadata'] = environment.get('errors_metadata') or ErrorsMetadata()[0m
[30;1m173 | [0m[35m        environment['collector'] = environment.get('collector') or self._select_collector(environmen[0m
[30;1m174 | [0m[35m        environment["profiler_disabler"] = environment.get('profiler_disabler') or ProfilerDisabler([0m
[30;1m175 | [0m[35m        return UnmodifiableDict(environment)[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m168 | [0m[35m        environment['excluded_threads'] = \[0m
[30;1m169 | [0m[35m            frozenset({environment['profiler_thread_name']}.union(environment['excluded_threads']))[0m
[30;1m170 | [0m[35m        # TODO delay metadata lookup until we need it[0m
[30;1m171 | [0m[35m        environment['agent_metadata'] = environment.get('agent_metadata') or AgentMetadata()[0m
[30;1m172 | [0m[35m        environment['errors_metadata'] = environment.get('errors_metadata') or ErrorsMetadata()[0m
[30;1m173 | [0m[35m        environment['collector'] = environment.get('collector') or self._select_collector(environmen[0m
[30;1m174 | [0m[35m        environment["profiler_disabler"] = environment.get('profiler_disabler') or ProfilerDisabler([0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m        # set additional parameters if needed (costly default init or depend on other parameters)[0m
[30;1m165 | [0m[35m        if environment.get('initial_sampling_interval') is None:[0m
[30;1m166 | [0m[35m            environment['initial_sampling_interval'] = datetime.timedelta([0m
[30;1m167 | [0m[35m                seconds=SystemRandom().uniform(0, AgentConfiguration.get().sampling_interval.total_s[0m
[30;1m168 | [0m[35m        environment['excluded_threads'] = \[0m
[30;1m169 | [0m[35m            frozenset({environment['profiler_thread_name']}.union(environment['excluded_threads']))[0m
[30;1m170 | [0m[35m        # TODO delay metadata lookup until we need it[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m        environment.update(environment_override)[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m        # set additional parameters if needed (costly default init or depend on other parameters)[0m
[30;1m165 | [0m[35m        if environment.get('initial_sampling_interval') is None:[0m
[30;1m166 | [0m[35m            environment['initial_sampling_interval'] = datetime.timedelta([0m
[30;1m167 | [0m[35m                seconds=SystemRandom().uniform(0, AgentConfiguration.get().sampling_interval.total_s[0m
[30;1m168 | [0m[35m        environment['excluded_threads'] = \[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m            self._profiler_runner_instance = profiler_runner_factory(environment=self.environment)[0m
[30;1m136 | [0m[35m        except:[0m
[30;1m137 | [0m[35m            logger.info("Caught exception while creating the CodeGuru Profiler Agent instance", exc_[0m
[30;1m138 | [0m[35m            if environment_override.get("allow_top_level_exceptions") is True:[0m
[30;1m139 | [0m[35m                raise[0m
[30;1m140 | [0m[35m[0m
[30;1m141 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m131 | [0m[35m                del environment_override[key][0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m            self.environment = self._setup_final_environment(self.environment, environment_override)[0m
[30;1m134 | [0m[35m            profiler_runner_factory = self.environment.get("profiler_runner_factory") or ProfilerRun[0m
[30;1m135 | [0m[35m            self._profiler_runner_instance = profiler_runner_factory(environment=self.environment)[0m
[30;1m136 | [0m[35m        except:[0m
[30;1m137 | [0m[35m            logger.info("Caught exception while creating the CodeGuru Profiler Agent instance", exc_[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m119 | [0m[35m                reporting_interval=environment_override.get('reporting_interval'),[0m
[30;1m120 | [0m[35m                minimum_time_reporting=environment_override.get('minimum_time_reporting'),[0m
[30;1m121 | [0m[35m                max_stack_depth=environment_override.get('max_stack_depth'),[0m
[30;1m122 | [0m[35m                cpu_limit_percentage=environment_override.get('cpu_limit_percentage'))[0m
[30;1m123 | [0m[35m            agent_config_merger = AgentConfigurationMerger(default=default_config, user_overrides=us[0m
[30;1m124 | [0m[35m            self.environment["agent_config_merger"] = agent_config_merger[0m
[30;1m125 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m         sampling_interval=environment_override.get('sampling_interval'),[0m
[30;1m119 | [0m[35m                reporting_interval=environment_override.get('reporting_interval'),[0m
[30;1m120 | [0m[35m                minimum_time_reporting=environment_override.get('minimum_time_reporting'),[0m
[30;1m121 | [0m[35m                max_stack_depth=environment_override.get('max_stack_depth'),[0m
[30;1m122 | [0m[35m                cpu_limit_percentage=environment_override.get('cpu_limit_percentage'))[0m
[30;1m123 | [0m[35m            agent_config_merger = AgentConfigurationMerger(default=default_config, user_overrides=us[0m
[30;1m124 | [0m[35m            self.environment["agent_config_merger"] = agent_config_merger[0m
[30;1m125 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m([0m
[30;1m117 | [0m[35m                should_profile=environment_override.get('should_profile'),[0m
[30;1m118 | [0m[35m                sampling_interval=environment_override.get('sampling_interval'),[0m
[30;1m119 | [0m[35m                reporting_interval=environment_override.get('reporting_interval'),[0m
[30;1m120 | [0m[35m                minimum_time_reporting=environment_override.get('minimum_time_reporting'),[0m
[30;1m121 | [0m[35m                max_stack_depth=environment_override.get('max_stack_depth'),[0m
[30;1m122 | [0m[35m                cpu_limit_percentage=environment_override.get('cpu_limit_percentage'))[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m            user_overrides = AgentConfiguration([0m
[30;1m117 | [0m[35m                should_profile=environment_override.get('should_profile'),[0m
[30;1m118 | [0m[35m                sampling_interval=environment_override.get('sampling_interval'),[0m
[30;1m119 | [0m[35m                reporting_interval=environment_override.get('reporting_interval'),[0m
[30;1m120 | [0m[35m                minimum_time_reporting=environment_override.get('minimum_time_reporting'),[0m
[30;1m121 | [0m[35m                max_stack_depth=environment_override.get('max_stack_depth'),[0m
[30;1m122 | [0m[35m                cpu_limit_percentage=environment_override.get('cpu_limit_percentage'))[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m                cpu_limit_percentage=self.environment["cpu_limit_percentage"])[0m
[30;1m116 | [0m[35m            user_overrides = AgentConfiguration([0m
[30;1m117 | [0m[35m                should_profile=environment_override.get('should_profile'),[0m
[30;1m118 | [0m[35m                sampling_interval=environment_override.get('sampling_interval'),[0m
[30;1m119 | [0m[35m                reporting_interval=environment_override.get('reporting_interval'),[0m
[30;1m120 | [0m[35m                minimum_time_reporting=environment_override.get('minimum_time_reporting'),[0m
[30;1m121 | [0m[35m                max_stack_depth=environment_override.get('max_stack_depth'),[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m114 | [0m[35m                max_stack_depth=self.environment["max_stack_depth"],[0m
[30;1m115 | [0m[35m                cpu_limit_percentage=self.environment["cpu_limit_percentage"])[0m
[30;1m116 | [0m[35m            user_overrides = AgentConfiguration([0m
[30;1m117 | [0m[35m                should_profile=environment_override.get('should_profile'),[0m
[30;1m118 | [0m[35m                sampling_interval=environment_override.get('sampling_interval'),[0m
[30;1m119 | [0m[35m                reporting_interval=environment_override.get('reporting_interval'),[0m
[30;1m120 | [0m[35m                minimum_time_reporting=environment_override.get('minimum_time_reporting'),[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m78 | [0m[35m               - sampling_interval: delay between each sample in datetime.timedelta (default: 1 seco[0m
[30;1m79 | [0m[35m                    - reporting_mode: Reporting mode to be used, two modes are supported: "codeguru_[0m
[30;1m80 | [0m[35m                                      "file" mode is only used for testing at the moment. (default: [0m
[30;1m81 | [0m[35m                    - file_prefix: path + file prefix to use for profile reports when in "file" repo[0m
[30;1m82 | [0m[35m                                   (default: './profile-{profiling_group_name}' only used when repor[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m49 | [0m[35m    You MUST provide a profiling_group_name.[0m
[30;1m50 | [0m[35m    """[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m    # this singleton instance is used to make sure only one profiler instance is started at a time.[0m
[30;1m53 | [0m[35m    _active_profiler = None[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    def __init__(self,[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35mclass Profiler:[0m
[30;1m46 | [0m[35m    """[0m
[30;1m47 | [0m[35m    The Profiler Python agent provides a lightweight way of monitoring your service performance. It [0m
[30;1m48 | [0m[35m    collected samples to provide information about what's on the stack of each thread in the python [0m
[30;1m49 | [0m[35m    You MUST provide a profiling_group_name.[0m
[30;1m50 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sampling_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m103 | [0m[35m    line = linecache.getline(frame.f_code.co_filename, line_no).strip()[0m
[30;1m104 | [0m[35m    if "sleep(" in line:[0m
[30;1m105 | [0m[35m        result.append(TIME_SLEEP_FRAME)[0m
[30;1m106 | [0m[35m    elif ".get(block=True" in line:[0m
[30;1m107 | [0m[35m        result.append(QUEUE_BLOCKING_GET_FRAME)[0m
[30;1m108 | [0m[35m    elif "etree.XMLSchema(" in line:[0m
[30;1m109 | [0m[35m        result.append(LXML_SCHEMA_FRAME)[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sampling_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m            and raw_frame.f_locals and 'py_operation_name' in raw_frame.f_locals.keys()[0m
[30;1m94 | [0m[35m            and raw_frame.f_locals.get('py_operation_name')):[0m
[30;1m95 | [0m[35m        result.append([0m
[30;1m96 | [0m[35m            Frame(name=raw_frame.f_locals.get('py_operation_name'),[0m
[30;1m97 | [0m[35m                  class_name=_extract_class(raw_frame.f_locals),[0m
[30;1m98 | [0m[35m                  file_path=raw_frame.f_code.co_filename)[0m
[30;1m99 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sampling_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m    if (raw_frame.f_code.co_name == '_api_call'[0m
[30;1m92 | [0m[35m            and BOTO_CLIENT_PATH.search(raw_frame.f_code.co_filename) is not None[0m
[30;1m93 | [0m[35m            and raw_frame.f_locals and 'py_operation_name' in raw_frame.f_locals.keys()[0m
[30;1m94 | [0m[35m            and raw_frame.f_locals.get('py_operation_name')):[0m
[30;1m95 | [0m[35m        result.append([0m
[30;1m96 | [0m[35m            Frame(name=raw_frame.f_locals.get('py_operation_name'),[0m
[30;1m97 | [0m[35m                  class_name=_extract_class(raw_frame.f_locals),[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sampling_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35mdef _is_excluded(thread_id, excluded_threads):[0m
[30;1m44 | [0m[35m    thread = threading._active.get(thread_id)[0m
[30;1m45 | [0m[35m    return _is_zombie(thread) or thread.name in excluded_threads[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/agent_debug_info.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35m        """[0m
[30;1m16 | [0m[35m        We want to differentiate API call errors more granularly. We want to gather ResourceNotFound[0m
[30;1m17 | [0m[35m        because we are going to get this exception with auto-create  feature and want to monitor how[0m
[30;1m18 | [0m[35m        the agent is not able to create the PG and resulting in subsequent ResourceNotFoundException[0m
[30;1m19 | [0m[35m        """[0m
[30;1m20 | [0m[35m        self.errors_count = 0[0m
[30;1m21 | [0m[35m        self.sdk_client_errors = 0[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/utils/time.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom __future__ import absolute_import[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mfrom datetime import datetime[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mdef to_iso(epoch_milli):[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/metrics/with_timer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom __future__ import absolute_import[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom time import perf_counter[0m
[30;1m4 | [0m[35mfrom time import process_time[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mdef with_timer(metric_name, measurement="cpu-time"):[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/metrics/with_timer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom __future__ import absolute_import[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom time import perf_counter[0m
[30;1m4 | [0m[35mfrom time import process_time[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/aws_lambda/lambda_handler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mdef load_handler(handler_extractor, env=os.environ, original_handler_env_key=HANDLER_ENV_NAME_FOR_CO[0m
[30;1m13 | [0m[35m    try:[0m
[30;1m14 | [0m[35m        original_handler_name = env.get(original_handler_env_key)[0m
[30;1m15 | [0m[35m        if not original_handler_name:[0m
[30;1m16 | [0m[35m            raise ValueError("Could not find module and function name from " + HANDLER_ENV_NAME_FOR_[0m
[30;1m17 | [0m[35m                             + " environment variable")[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/aws_lambda/lambda_handler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m78 | [0m[35m# We need to load the customer's handler function since the lambda framework loaded our function ins[0m
[30;1m79 | [0m[35m# We want to delegate this work to the lambda framework so we need to find the appropriate method th[0m
[30;1m80 | [0m[35m# (depends on python versions) so we can call it.[0m
[30;1m81 | [0m[35m# This should be done at import time which means it is done when lambda frameworks loads our module[0m
[30;1m82 | [0m[35mhandler_extractor = get_lambda_handler_extractor()[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m# Now load the actual customer's handler function.[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/aws_lambda/lambda_handler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m22 | [0m[35m        restore_handler_env(original_handler_name, env)[0m
[30;1m23 | [0m[35m        return customer_handler_function[0m
[30;1m24 | [0m[35m    except:[0m
[30;1m25 | [0m[35m        # Using print here as logger would probably not be properly initiated at this point.[0m
[30;1m26 | [0m[35m        print("Could not load the handler function to decorate it with CodeGuru Profiler."[0m
[30;1m27 | [0m[35m              + " If the exception error does not help you, please try removing the CodeGuru Profile[0m
[30;1m28 | [0m[35m              + " from your lambda function and contact AWS support.")[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/aws_lambda/lambda_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m85 | [0m[35mhandler_function = load_handler(handler_extractor)[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m# WARNING: Do not rename this file, this function or HANDLER_ENV_NAME_FOR_CODEGURU without changing [0m
[30;1m89 | [0m[35m@with_lambda_profiler()[0m
[30;1m90 | [0m[35mdef call_handler(event, context):[0m
[30;1m91 | [0m[35m    return handler_function(event, context)[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/aws_lambda/lambda_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m78 | [0m[35m# We need to load the customer's handler function since the lambda framework loaded our function ins[0m
[30;1m79 | [0m[35m# We want to delegate this work to the lambda framework so we need to find the appropriate method th[0m
[30;1m80 | [0m[35m# (depends on python versions) so we can call it.[0m
[30;1m81 | [0m[35m# This should be done at import time which means it is done when lambda frameworks loads our module[0m
[30;1m82 | [0m[35mhandler_extractor = get_lambda_handler_extractor()[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m# Now load the actual customer's handler function.[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/aws_lambda/lambda_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m# We need to load the customer's handler function since the lambda framework loaded our function ins[0m
[30;1m79 | [0m[35m# We want to delegate this work to the lambda framework so we need to find the appropriate method th[0m
[30;1m80 | [0m[35m# (depends on python versions) so we can call it.[0m
[30;1m81 | [0m[35m# This should be done at import time which means it is done when lambda frameworks loads our module[0m
[30;1m82 | [0m[35mhandler_extractor = get_lambda_handler_extractor()[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/aws_lambda/lambda_handler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m    try:[0m
[30;1m14 | [0m[35m        original_handler_name = env.get(original_handler_env_key)[0m
[30;1m15 | [0m[35m        if not original_handler_name:[0m
[30;1m16 | [0m[35m            raise ValueError("Could not find module and function name from " + HANDLER_ENV_NAME_FOR_[0m
[30;1m17 | [0m[35m                             + " environment variable")[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m        # Delegate to the lambda code to load the customer's module and function.[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m## How to contribute[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mCheck the GitHub repository at [aws/amazon-codeguru-profiler-python-agent](https://github.com/aws/am[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35mSee [CONTRIBUTING](CONTRIBUTING.md) for details.[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/codeguru_client_builder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m        self._provided_endpoint_url = environment.get("endpoint_url")[0m
[30;1m26 | [0m[35m        self._codeguru_client_instance = environment.get("codeguru_profiler_client")[0m
[30;1m27 | [0m[35m        self._aws_session = environment.get("aws_session")[0m
[30;1m28 | [0m[35m        self._region_name = environment.get("region_name")[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    @property[0m
[30;1m31 | [0m[35m    def codeguru_client(self):[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/codeguru_client_builder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m    def __init__(self, environment):[0m
[30;1m25 | [0m[35m        self._provided_endpoint_url = environment.get("endpoint_url")[0m
[30;1m26 | [0m[35m        self._codeguru_client_instance = environment.get("codeguru_profiler_client")[0m
[30;1m27 | [0m[35m        self._aws_session = environment.get("aws_session")[0m
[30;1m28 | [0m[35m        self._region_name = environment.get("region_name")[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/codeguru_client_builder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m    def __init__(self, environment):[0m
[30;1m25 | [0m[35m        self._provided_endpoint_url = environment.get("endpoint_url")[0m
[30;1m26 | [0m[35m        self._codeguru_client_instance = environment.get("codeguru_profiler_client")[0m
[30;1m27 | [0m[35m        self._aws_session = environment.get("aws_session")[0m
[30;1m28 | [0m[35m        self._region_name = environment.get("region_name")[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/codeguru_client_builder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m    """[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m    def __init__(self, environment):[0m
[30;1m25 | [0m[35m        self._provided_endpoint_url = environment.get("endpoint_url")[0m
[30;1m26 | [0m[35m        self._codeguru_client_instance = environment.get("codeguru_profiler_client")[0m
[30;1m27 | [0m[35m        self._aws_session = environment.get("aws_session")[0m
[30;1m28 | [0m[35m        self._region_name = environment.get("region_name")[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/codeguru_client_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m    @property[0m
[30;1m31 | [0m[35m    def codeguru_client(self):[0m
[30;1m32 | [0m[35m        """[0m
[30;1m33 | [0m[35m        Creates an client instance the first time it is called.[0m
[30;1m34 | [0m[35m        :return: a codeguru client object from the AWS SDK[0m
[30;1m35 | [0m[35m        """[0m
[30;1m36 | [0m[35m        if self._codeguru_client_instance is None:[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/memory_counter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m        self.memory_usage_bytes += getsizeof(file_path)[0m
[30;1m30 | [0m[35m        self.memory_usage_bytes += getsizeof(class_name)[0m
[30;1m31 | [0m[35m        # For simplicity, we assume all nodes contain line_no and we only expect root node and[0m
[30;1m32 | [0m[35m        # duration metric node not to have line_no.[0m
[30;1m33 | [0m[35m        self.memory_usage_bytes += MemoryCounter.line_no_size[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m    def count_first_child(self):[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/memory_counter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m        self.memory_usage_bytes += getsizeof(frame)[0m
[30;1m29 | [0m[35m        self.memory_usage_bytes += getsizeof(file_path)[0m
[30;1m30 | [0m[35m        self.memory_usage_bytes += getsizeof(class_name)[0m
[30;1m31 | [0m[35m        # For simplicity, we assume all nodes contain line_no and we only expect root node and[0m
[30;1m32 | [0m[35m        # duration metric node not to have line_no.[0m
[30;1m33 | [0m[35m        self.memory_usage_bytes += MemoryCounter.line_no_size[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/memory_counter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m        self.memory_usage_bytes += getsizeof(frame)[0m
[30;1m29 | [0m[35m        self.memory_usage_bytes += getsizeof(file_path)[0m
[30;1m30 | [0m[35m        self.memory_usage_bytes += getsizeof(class_name)[0m
[30;1m31 | [0m[35m        # For simplicity, we assume all nodes contain line_no and we only expect root node and[0m
[30;1m32 | [0m[35m        # duration metric node not to have line_no.[0m
[30;1m33 | [0m[35m        self.memory_usage_bytes += MemoryCounter.line_no_size[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/setup.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m    version_match = re.search(r"^__agent_version__ = ['\"]([^'\"]*)['\"]", version_file, re.M)[0m
[30;1m19 | [0m[35m    if version_match:[0m
[30;1m20 | [0m[35m        return version_match.group(1)[0m
[30;1m21 | [0m[35m    raise RuntimeError("Unable to find version string.")[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m# https://packaging.python.org/tutorials/packaging-projects/#creating-the-package-files[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m        profiling_group_name = _get_profiling_group_name(pg_name, name_from_arn, env)[0m
[30;1m144 | [0m[35m        if not profiling_group_name:[0m
[30;1m145 | [0m[35m            if should_autocreate_profiling_group:[0m
[30;1m146 | [0m[35m                profiling_group_name = "aws-lambda-" + env.get(AWS_LAMBDA_FUNCTION_NAME_ENV_VAR_KEY)[0m
[30;1m147 | [0m[35m            else:[0m
[30;1m148 | [0m[35m                logger.info("Could not find a profiling group name to start the CodeGuru Profiler ag[0m
[30;1m149 | [0m[35m                            + "Add command line argument or environment variable. e.g. " + PG_ARN_EN[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m103 | [0m[35mttps://boto3.amazonaws.com/v1/documentation/api/latest/guide/credentials.html#shared-credentials-fil[0m
[30;1m104 | [0m[35m    the credential file path gets set globally through setting the env variable AWS_SHARED_CREDENTIA[0m
[30;1m105 | [0m[35m    reconsider whether we should support this override or not.[0m
[30;1m106 | [0m[35m    """[0m
[30;1m107 | [0m[35m    if env.get(CREDENTIAL_PATH):[0m
[30;1m108 | [0m[35m        logger.info("Credential detected from environment variable " + CREDENTIAL_PATH + ". Unfortun[0m
[30;1m109 | [0m[35m                       "do not support setting credential file path through env variable yet for Pyt[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m    """[0m
[30;1m92 | [0m[35m    By default profiler is enabled, any value in the environment variable other than "true" (case-in[0m
[30;1m93 | [0m[35m    """[0m
[30;1m94 | [0m[35m    enable_env_value = env.get(ENABLED_ENV, 'true').lower()[0m
[30;1m95 | [0m[35m    result = enable_env_value == 'true'[0m
[30;1m96 | [0m[35m    if not result:[0m
[30;1m97 | [0m[35m        logger.info(ENABLED_ENV + " is set to " + enable_env_value + ", CodeGuru Profiler is disable[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35mdef _get_region_from_env(region_from_arn=None, env=os.environ):[0m
[30;1m83 | [0m[35m    region_from_env = env.get(REGION_ENV)[0m
[30;1m84 | [0m[35m    if region_from_env and region_from_arn and region_from_env != region_from_arn:[0m
[30;1m85 | [0m[35m        logger.info("Different region found from " + REGION_ENV + " and " + PG_ARN_ENV +[0m
[30;1m86 | [0m[35m                    " will use value from " + PG_ARN_ENV + " : " + region_from_arn)[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35mdef _get_profiling_group_name_from_env(pg_name_from_arn=None, env=os.environ):[0m
[30;1m71 | [0m[35m    pg_name_from_env = env.get(PG_NAME_ENV)[0m
[30;1m72 | [0m[35m    if pg_name_from_env and pg_name_from_arn and pg_name_from_env != pg_name_from_arn:[0m
[30;1m73 | [0m[35m        logger.info("Different Profiling group name found from " + PG_NAME_ENV + " and " + PG_ARN_EN[0m
[30;1m74 | [0m[35m                    " will use value from " + PG_ARN_ENV + " : " + pg_name_from_arn)[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m    :param env: typically os.environ[0m
[30;1m50 | [0m[35m    :return: (name, region, account id)[0m
[30;1m51 | [0m[35m    """[0m
[30;1m52 | [0m[35m    arn = env.get(PG_ARN_ENV)[0m
[30;1m53 | [0m[35m    if not arn:[0m
[30;1m54 | [0m[35m        return None, None, None[0m
[30;1m55 | [0m[35m    parts = arn.split(':')[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mdef _read_millis(override, env_name, override_key, env=os.environ):[0m
[30;1m29 | [0m[35m    value = env.get(env_name)[0m
[30;1m30 | [0m[35m    if value:[0m
[30;1m31 | [0m[35m        try:[0m
[30;1m32 | [0m[35m            override[override_key] = datetime.timedelta(milliseconds=int(value))[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m145 | [0m[35m            if should_autocreate_profiling_group:[0m
[30;1m146 | [0m[35m                profiling_group_name = "aws-lambda-" + env.get(AWS_LAMBDA_FUNCTION_NAME_ENV_VAR_KEY)[0m
[30;1m147 | [0m[35m            else:[0m
[30;1m148 | [0m[35m                logger.info("Could not find a profiling group name to start the CodeGuru Profiler ag[0m
[30;1m149 | [0m[35m                            + "Add command line argument or environment variable. e.g. " + PG_ARN_EN[0m
[30;1m150 | [0m[35m                return None[0m
[30;1m151 | [0m[35m        region = _get_region(region_name, region_from_arn, env)[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m134 | [0m[35m    try:[0m
[30;1m135 | [0m[35m        if not _is_enabled(env):[0m
[30;1m136 | [0m[35m            logger.info("CodeGuru Profiler is not started as it has been explicitly disabled. Set en[0m
[30;1m137 | [0m[35m                        "variable " + ENABLED_ENV + " to true if you wish to enable profiler.")[0m
[30;1m138 | [0m[35m            return None[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m        _check_credential_through_environment(env)[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m128 | [0m[35m    :return: a Profiler object or None, this function does not throw exceptions[0m
[30;1m129 | [0m[35m    """[0m
[30;1m130 | [0m[35m    if profiler_factory is None:[0m
[30;1m131 | [0m[35m        # We importing Profiler here rather than at the head is to avoid having import loop[0m
[30;1m132 | [0m[35m        from codeguru_profiler_agent.profiler import Profiler[0m
[30;1m133 | [0m[35m        profiler_factory = Profiler[0m
[30;1m134 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m108 | [0m[35m        logger.info("Credential detected from environment variable " + CREDENTIAL_PATH + ". Unfortun[0m
[30;1m109 | [0m[35m                       "do not support setting credential file path through env variable yet for Pyt[0m
[30;1m110 | [0m[35m                       "Please follow the guide on https://boto3.amazonaws.com/v1/documentation/api/[0m
[30;1m111 | [0m[35m                       "and set the credential file path globally through env variable AWS_SHARED_CR[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m    return[0m
[30;1m114 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m106 | [0m[35m    """[0m
[30;1m107 | [0m[35m    if env.get(CREDENTIAL_PATH):[0m
[30;1m108 | [0m[35m        logger.info("Credential detected from environment variable " + CREDENTIAL_PATH + ". Unfortun[0m
[30;1m109 | [0m[35m                       "do not support setting credential file path through env variable yet for Pyt[0m
[30;1m110 | [0m[35m                       "Please follow the guide on https://boto3.amazonaws.com/v1/documentation/api/[0m
[30;1m111 | [0m[35m                       "and set the credential file path globally through env variable AWS_SHARED_CR[0m
[30;1m112 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35mdef _check_credential_through_environment(env=os.environ):[0m
[30;1m102 | [0m[35m    """[0m
[30;1m103 | [0m[35m    According to https://boto3.amazonaws.com/v1/documentation/api/latest/guide/credentials.html#shar[0m
[30;1m104 | [0m[35m    the credential file path gets set globally through setting the env variable AWS_SHARED_CREDENTIA[0m
[30;1m105 | [0m[35m    reconsider whether we should support this override or not.[0m
[30;1m106 | [0m[35m    """[0m
[30;1m107 | [0m[35m    if env.get(CREDENTIAL_PATH):[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m        try:[0m
[30;1m32 | [0m[35m            override[override_key] = datetime.timedelta(milliseconds=int(value))[0m
[30;1m33 | [0m[35m        except Exception:[0m
[30;1m34 | [0m[35m            logger.info("Unable to convert value to a time range for environment variable " + env_na[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35mdef _read_override(env=os.environ):[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35mPG_NAME_ENV = "AWS_CODEGURU_PROFILER_GROUP_NAME"[0m
[30;1m14 | [0m[35mPG_ARN_ENV = "AWS_CODEGURU_PROFILER_GROUP_ARN"[0m
[30;1m15 | [0m[35mREGION_ENV = "AWS_CODEGURU_PROFILER_TARGET_REGION"[0m
[30;1m16 | [0m[35m# Note: Please check function `check_credential_through_environment` before supporting the following[0m
[30;1m17 | [0m[35mCREDENTIAL_PATH = "AWS_CODEGURU_PROFILER_CREDENTIAL_PATH"[0m
[30;1m18 | [0m[35mENABLED_ENV = "AWS_CODEGURU_PROFILER_ENABLED"[0m
[30;1m19 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/profiler_builder.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m128 | [0m[35m    :return: a Profiler object or None, this function does not throw exceptions[0m
[30;1m129 | [0m[35m    """[0m
[30;1m130 | [0m[35m    if profiler_factory is None:[0m
[30;1m131 | [0m[35m        # We importing Profiler here rather than at the head is to avoid having import loop[0m
[30;1m132 | [0m[35m        from codeguru_profiler_agent.profiler import Profiler[0m
[30;1m133 | [0m[35m        profiler_factory = Profiler[0m
[30;1m134 | [0m[35m    try:[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/local_aggregator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m        return AgentConfiguration.get().is_under_min_reporting_time(now - self.last_report_attempted[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m    def _is_over_reporting_interval(self, now):[0m
[30;1m133 | [0m[35m        return AgentConfiguration.get().is_over_reporting_interval(now - self.last_report_attempted)[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m    def _add_overhead_metric_to_profile(self):[0m
[30;1m136 | [0m[35m        run_profiler_metric = self.timer and self.timer.get_metric("runProfiler")[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/local_aggregator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m        return is_reporting_successful[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m    def _is_under_min_reporting_time(self, now):[0m
[30;1m130 | [0m[35m        return AgentConfiguration.get().is_under_min_reporting_time(now - self.last_report_attempted[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m    def _is_over_reporting_interval(self, now):[0m
[30;1m133 | [0m[35m        return AgentConfiguration.get().is_over_reporting_interval(now - self.last_report_attempted)[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/local_aggregator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m        self.timer.reset()[0m
[30;1m80 | [0m[35m        self.profile = self.profile_factory([0m
[30;1m81 | [0m[35m            profiling_group_name=self.profiling_group_name,[0m
[30;1m82 | [0m[35m            sampling_interval_seconds=AgentConfiguration.get().sampling_interval.total_seconds(),[0m
[30;1m83 | [0m[35m            host_weight=self.host_weight,[0m
[30;1m84 | [0m[35m            start=current_milli_time(clock=self.clock),[0m
[30;1m85 | [0m[35m            agent_debug_info=AgentDebugInfo(self.errors_metadata, self.agent_start_time, self.timer)[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/local_aggregator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m        self.errors_metadata = environment["errors_metadata"][0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m        self.profile_factory = environment.get("profile_factory") or Profile[0m
[30;1m45 | [0m[35m        self.clock = environment.get("clock") or time.time[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m        self.profile = None[0m
[30;1m48 | [0m[35m        self.memory_limit_bytes = environment["memory_limit_bytes"][0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/local_aggregator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m        self.timer = environment["timer"][0m
[30;1m42 | [0m[35m        self.errors_metadata = environment["errors_metadata"][0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m        self.profile_factory = environment.get("profile_factory") or Profile[0m
[30;1m45 | [0m[35m        self.clock = environment.get("clock") or time.time[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m        self.profile = None[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/local_aggregator.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m116 | [0m[35m            return False[0m
[30;1m117 | [0m[35m        is_reporting_successful = self.reporter.report(self.profile)[0m
[30;1m118 | [0m[35m        '''[0m
[30;1m119 | [0m[35m        If we attempt to create a Profiling Group in the report() call, we do not want to update the[0m
[30;1m120 | [0m[35m        since we did not actually report a profile.[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m        This will occur only in the case of profiling using CodeGuru Profiler Python agent Lambda la[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/local_aggregator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35m    whether the reporting interval is reached or not) and the profile will be reported through the c[0m
[30;1m20 | [0m[35m    Each time we sample, the aggregator will check if the memory usage of the profile exceeds the me[0m
[30;1m21 | [0m[35m    If memory limit is violated, a force_flush will be executed first; if the last flush action happ[0m
[30;1m22 | [0m[35m    the minimum time for reporting, OverMemoryLimitException will be raised.[0m
[30;1m23 | [0m[35m    """[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    def __init__(self, reporter, environment=dict()):[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/local_aggregator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35m reported by the sampler and aggregates them into one profile.[0m
[30;1m18 | [0m[35m    When flush is called, the aggregator will first check whether the profile should be flushed or n[0m
[30;1m19 | [0m[35m    whether the reporting interval is reached or not) and the profile will be reported through the c[0m
[30;1m20 | [0m[35m    Each time we sample, the aggregator will check if the memory usage of the profile exceeds the me[0m
[30;1m21 | [0m[35m    If memory limit is violated, a force_flush will be executed first; if the last flush action happ[0m
[30;1m22 | [0m[35m    the minimum time for reporting, OverMemoryLimitException will be raised.[0m
[30;1m23 | [0m[35m    """[0m
[30;1m24 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/local_aggregator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mimport datetime[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom codeguru_profiler_agent.agent_metadata.agent_debug_info import AgentDebugInfo[0m
[30;1m6 | [0m[35mfrom codeguru_profiler_agent.reporter.agent_configuration import AgentConfiguration[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/call_graph_node.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m96 | [0m[35m        >>> sys.getsizeof([1, 2])[0m
[30;1m97 | [0m[35m        88[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m        :param new_child: graph node that holds the new child frame[0m
[30;1m100 | [0m[35m        :return:[0m
[30;1m101 | [0m[35m        """[0m
[30;1m102 | [0m[35m        if self.memory_counter:[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/call_graph_node.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m                CallGraphNode(frame_name=frame.name, class_name=frame.class_name, file_path=frame.fi[0m
[30;1m51 | [0m[35m                              line_no=frame.line_no))[0m
[30;1m52 | [0m[35m        node._maybe_update_line_no(frame.line_no)[0m
[30;1m53 | [0m[35m        return node[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    def increase_runnable_count(self, value_to_add=1):[0m
[30;1m56 | [0m[35m        if value_to_add < 0:[0m
[30;1m57 | [0m[35m            raise ValueError([0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/call_graph_node.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m        to have same module:function existing in two different files. Therefore, we only compare nod[0m
[30;1m46 | [0m[35m        its frame_name but not by its file_path.[0m
[30;1m47 | [0m[35m        """[0m
[30;1m48 | [0m[35m        node = self._get_child(frame=frame) or \[0m
[30;1m49 | [0m[35m            self._insert_new_child([0m
[30;1m50 | [0m[35m                CallGraphNode(frame_name=frame.name, class_name=frame.class_name, file_path=frame.fi[0m
[30;1m51 | [0m[35m                              line_no=frame.line_no))[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/call_graph_node.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m        self.file_path = file_path[0m
[30;1m32 | [0m[35m        self.runnable_count = 0[0m
[30;1m33 | [0m[35m        # the start and end of the range of line number where we observed this node[0m
[30;1m34 | [0m[35m        # None is expected for root node and agent duration metric node[0m
[30;1m35 | [0m[35m        self.start_line = line_no[0m
[30;1m36 | [0m[35m        self.end_line = line_no[0m
[30;1m37 | [0m[35m        self.children = ()[0m
[30;1m38 | [0m[35m        self.memory_counter = memory_counter[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/call_graph_node.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m        self.file_path = file_path[0m
[30;1m32 | [0m[35m        self.runnable_count = 0[0m
[30;1m33 | [0m[35m        # the start and end of the range of line number where we observed this node[0m
[30;1m34 | [0m[35m        # None is expected for root node and agent duration metric node[0m
[30;1m35 | [0m[35m        self.start_line = line_no[0m
[30;1m36 | [0m[35m        self.end_line = line_no[0m
[30;1m37 | [0m[35m        self.children = ()[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/call_graph_node.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m        # common, for now we just assume this is the case and don't check for it[0m
[30;1m31 | [0m[35m        self.file_path = file_path[0m
[30;1m32 | [0m[35m        self.runnable_count = 0[0m
[30;1m33 | [0m[35m        # the start and end of the range of line number where we observed this node[0m
[30;1m34 | [0m[35m        # None is expected for root node and agent duration metric node[0m
[30;1m35 | [0m[35m        self.start_line = line_no[0m
[30;1m36 | [0m[35m        self.end_line = line_no[0m
[30;1m37 | [0m[35m        self.children = ()[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/call_graph_node.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35m    def __init__(self, frame_name, class_name, file_path, line_no, memory_counter=None):[0m
[30;1m11 | [0m[35m        """[0m
[30;1m12 | [0m[35m        A node represents a given stack frame at a given position in the stack:[0m
[30;1m13 | [0m[35m        * it can have children -- frames that were observed to be on top of this frame in some sampl[0m
[30;1m14 | [0m[35m        * it will probably have a parent (except for the root node), but does not keep a reference t[0m
[30;1m15 | [0m[35m        It also keeps track of how many times (per thread state) this frame was observed in thread s[0m
[30;1m16 | [0m[35m        one or more samples.[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/call_graph_node.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m    def __init__(self, frame_name, class_name, file_path, line_no, memory_counter=None):[0m
[30;1m11 | [0m[35m        """[0m
[30;1m12 | [0m[35m        A node represents a given stack frame at a given position in the stack:[0m
[30;1m13 | [0m[35m        * it can have children -- frames that were observed to be on top of this frame in some sampl[0m
[30;1m14 | [0m[35m        * it will probably have a parent (except for the root node), but does not keep a reference t[0m
[30;1m15 | [0m[35m        It also keeps track of how many times (per thread state) this frame was observed in thread s[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/call_graph_node.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m    def __init__(self, frame_name, class_name, file_path, line_no, memory_counter=None):[0m
[30;1m11 | [0m[35m        """[0m
[30;1m12 | [0m[35m        A node represents a given stack frame at a given position in the stack:[0m
[30;1m13 | [0m[35m        * it can have children -- frames that were observed to be on top of this frame in some sampl[0m
[30;1m14 | [0m[35m        * it will probably have a parent (except for the root node), but does not keep a reference t[0m
[30;1m15 | [0m[35m        It also keeps track of how many times (per thread state) this frame was observed in thread s[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sampler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m        stacks = self._get_stacks([0m
[30;1m47 | [0m[35m            threads_to_sample=threads_to_sample,[0m
[30;1m48 | [0m[35m            excluded_threads=self._excluded_threads,[0m
[30;1m49 | [0m[35m            max_depth=AgentConfiguration.get().max_stack_depth)[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m        # Memory usage optimization[0m
[30;1m52 | [0m[35m        del all_threads[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sampler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m        self._get_stacks = \[0m
[30;1m31 | [0m[35m            environment.get("get_stacks") or codeguru_profiler_agent.sampling_utils.get_stacks[0m
[30;1m32 | [0m[35m        self._thread_lister = environment.get("thread_lister") or sys[0m
[30;1m33 | [0m[35m        self.timer = environment.get("timer")[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m    @with_timer("dumpAllStackTraces")[0m
[30;1m36 | [0m[35m    def sample(self):[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sampler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m        self._excluded_threads = environment.get("excluded_threads") or set()[0m
[30;1m30 | [0m[35m        self._get_stacks = \[0m
[30;1m31 | [0m[35m            environment.get("get_stacks") or codeguru_profiler_agent.sampling_utils.get_stacks[0m
[30;1m32 | [0m[35m        self._thread_lister = environment.get("thread_lister") or sys[0m
[30;1m33 | [0m[35m        self.timer = environment.get("timer")[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m    @with_timer("dumpAllStackTraces")[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sampler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m        self._max_threads = environment.get("max_threads") or 100[0m
[30;1m29 | [0m[35m        self._excluded_threads = environment.get("excluded_threads") or set()[0m
[30;1m30 | [0m[35m        self._get_stacks = \[0m
[30;1m31 | [0m[35m            environment.get("get_stacks") or codeguru_profiler_agent.sampling_utils.get_stacks[0m
[30;1m32 | [0m[35m        self._thread_lister = environment.get("thread_lister") or sys[0m
[30;1m33 | [0m[35m        self.timer = environment.get("timer")[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sampler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m        :param excluded_threads: (inside environment) set of thread names to be excluded from sampli[0m
[30;1m27 | [0m[35m        """[0m
[30;1m28 | [0m[35m        self._max_threads = environment.get("max_threads") or 100[0m
[30;1m29 | [0m[35m        self._excluded_threads = environment.get("excluded_threads") or set()[0m
[30;1m30 | [0m[35m        self._get_stacks = \[0m
[30;1m31 | [0m[35m            environment.get("get_stacks") or codeguru_profiler_agent.sampling_utils.get_stacks[0m
[30;1m32 | [0m[35m        self._thread_lister = environment.get("thread_lister") or sys[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sampler.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m        :param max_threads: (inside environment) the max number of threads getting sampled[0m
[30;1m26 | [0m[35m        :param excluded_threads: (inside environment) set of thread names to be excluded from sampli[0m
[30;1m27 | [0m[35m        """[0m
[30;1m28 | [0m[35m        self._max_threads = environment.get("max_threads") or 100[0m
[30;1m29 | [0m[35m        self._excluded_threads = environment.get("excluded_threads") or set()[0m
[30;1m30 | [0m[35m        self._get_stacks = \[0m
[30;1m31 | [0m[35m            environment.get("get_stacks") or codeguru_profiler_agent.sampling_utils.get_stacks[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/fleet_info.py[0m
   Pattern: [32m.hostname[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    """[0m
[30;1m34 | [0m[35m    Returns the id of the fleet element, that is used to tell if multiple agents come from the same [0m
[30;1m35 | [0m[35m    This id can be the hostname for an EC2 or the task ARN for Fargate.[0m
[30;1m36 | [0m[35m    @return the id in string.[0m
[30;1m37 | [0m[35m    """[0m
[30;1m38 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m## How to contribute[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mCheck the GitHub repository at [aws/amazon-codeguru-profiler-python-agent](https://github.com/aws/am[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35mSee [CONTRIBUTING](CONTRIBUTING.md) for details.[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/sample.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mt=0):[0m
[30;1m5 | [0m[35m        """[0m
[30;1m6 | [0m[35m        :param stacks: list of lists; each list is a list of Frame object representing a thread stac[0m
[30;1m7 | [0m[35m        :param start_time: current time (in ms) just before we started taking the sample[0m
[30;1m8 | [0m[35m        :param end_time: current time (in ms) just after we started taking the sample[0m
[30;1m9 | [0m[35m        :param attempted_sample_threads_count: how many threads we tried to sample (can be > than le[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/sample.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mt"][0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35m    def __init__(self, stacks, attempted_sample_threads_count=0, seen_threads_count=0):[0m
[30;1m5 | [0m[35m        """[0m
[30;1m6 | [0m[35m        :param stacks: list of lists; each list is a list of Frame object representing a thread stac[0m
[30;1m7 | [0m[35m        :param start_time: current time (in ms) just before we started taking the sample[0m
[30;1m8 | [0m[35m        :param end_time: current time (in ms) just after we started taking the sample[0m
[30;1m9 | [0m[35m        :param attempted_sample_threads_count: how many threads we tried to sample (can be > than le[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/model/sample.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35m    def __init__(self, stacks, attempted_sample_threads_count=0, seen_threads_count=0):[0m
[30;1m5 | [0m[35m        """[0m
[30;1m6 | [0m[35m        :param stacks: list of lists; each list is a list of Frame object representing a thread stac[0m
[30;1m7 | [0m[35m        :param start_time: current time (in ms) just before we started taking the sample[0m
[30;1m8 | [0m[35m        :param end_time: current time (in ms) just after we started taking the sample[0m
[30;1m9 | [0m[35m        :param attempted_sample_threads_count: how many threads we tried to sample (can be > than le[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/file_reporter/file_reporter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m        """[0m
[30;1m22 | [0m[35m        self._file_prefix = environment["file_prefix"][0m
[30;1m23 | [0m[35m        self._profile_encoder = \[0m
[30;1m24 | [0m[35m            environment.get("profile_encoder") or ProfileEncoder(gzip=False, environment=environment[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def setup(self):[0m
[30;1m27 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/aws_lambda/profiler_decorator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m            try:[0m
[30;1m52 | [0m[35m                return function(event, context)[0m
[30;1m53 | [0m[35m            finally:[0m
[30;1m54 | [0m[35m                LambdaContext.get().last_execution_duration = datetime.now() - start_time[0m
[30;1m55 | [0m[35m                _profiler.pause()[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m        return profiler_decorate[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/aws_lambda/profiler_decorator.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m                                             region_name=region_name,[0m
[30;1m44 | [0m[35m                                             environment_override=environment_override,[0m
[30;1m45 | [0m[35m                                             context=context, env=env)[0m
[30;1m46 | [0m[35m            LambdaContext.get().context = context[0m
[30;1m47 | [0m[35m            if not _profiler.start():[0m
[30;1m48 | [0m[35m                # if start() failed, there is high chance it will fail again[0m
[30;1m49 | [0m[35m                # so we disable the profiler to prevent further attempts.[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sdk_reporter/sdk_reporter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m173 | [0m[35m        Check if the compute platform is AWS Lambda.[0m
[30;1m174 | [0m[35m        """[0m
[30;1m175 | [0m[35m        does_lambda_task_root_exist = os.environ.get(LAMBDA_TASK_ROOT)[0m
[30;1m176 | [0m[35m        does_lambda_runtime_dir_exist = os.environ.get(LAMBDA_RUNTIME_DIR)[0m
[30;1m177 | [0m[35m        return bool(does_lambda_task_root_exist) and bool(does_lambda_runtime_dir_exist)[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sdk_reporter/sdk_reporter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m172 | [0m[35m        """[0m
[30;1m173 | [0m[35m        Check if the compute platform is AWS Lambda.[0m
[30;1m174 | [0m[35m        """[0m
[30;1m175 | [0m[35m        does_lambda_task_root_exist = os.environ.get(LAMBDA_TASK_ROOT)[0m
[30;1m176 | [0m[35m        does_lambda_runtime_dir_exist = os.environ.get(LAMBDA_RUNTIME_DIR)[0m
[30;1m177 | [0m[35m        return bool(does_lambda_task_root_exist) and bool(does_lambda_runtime_dir_exist)[0m
[30;1m178 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sdk_reporter/sdk_reporter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m                fleetInstanceId=fleet_instance_id,[0m
[30;1m71 | [0m[35m                metadata=metadata if metadata is not None else {},[0m
[30;1m72 | [0m[35m                profilingGroupName=self.profiling_group_name[0m
[30;1m73 | [0m[35m            ).get('configuration')[0m
[30;1m74 | [0m[35m            logger.debug("Got response from backend for configure_agent operation: " + str(configura[0m
[30;1m75 | [0m[35m            self.agent_config_merger.merge_with(configure_agent_response=configuration)[0m
[30;1m76 | [0m[35m        except ClientError as error:[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sdk_reporter/sdk_reporter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m        # TODO decide if we need to compress with gzip or not.[0m
[30;1m35 | [0m[35m        self.profile_encoder = \[0m
[30;1m36 | [0m[35m            environment.get("profile_encoder") or ProfileEncoder(environment=environment, gzip=False[0m
[30;1m37 | [0m[35m        self.timer = environment.get("timer")[0m
[30;1m38 | [0m[35m        self.metadata = environment["agent_metadata"][0m
[30;1m39 | [0m[35m        self.agent_config_merger = environment["agent_config_merger"][0m
[30;1m40 | [0m[35m        self.errors_metadata = environment["errors_metadata"][0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sdk_reporter/sdk_reporter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m        self.codeguru_client_builder = environment["codeguru_profiler_builder"][0m
[30;1m34 | [0m[35m        # TODO decide if we need to compress with gzip or not.[0m
[30;1m35 | [0m[35m        self.profile_encoder = \[0m
[30;1m36 | [0m[35m            environment.get("profile_encoder") or ProfileEncoder(environment=environment, gzip=False[0m
[30;1m37 | [0m[35m        self.timer = environment.get("timer")[0m
[30;1m38 | [0m[35m        self.metadata = environment["agent_metadata"][0m
[30;1m39 | [0m[35m        self.agent_config_merger = environment["agent_config_merger"][0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sdk_reporter/sdk_reporter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m    @staticmethod[0m
[30;1m180 | [0m[35m    def _log_request_failed(operation, exception):[0m
[30;1m181 | [0m[35m        log_exception(logger, "Failed to call the CodeGuru Profiler service for the {} operation: {}[0m
[30;1m182 | [0m[35m                      .format(operation, str(exception)))[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m    @classmethod[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sdk_reporter/sdk_reporter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m76 | [0m[35m        except ClientError as error:[0m
[30;1m77 | [0m[35m            # If we get a validation error or the profiling group does not exists, do not profile. W[0m
[30;1m78 | [0m[35m            # whole process because the customer may fix this on their side by creating/changing the[0m
[30;1m79 | [0m[35m            # We handle service exceptions like this in boto3[0m
[30;1m80 | [0m[35m            # see https://boto3.amazonaws.com/v1/documentation/api/latest/guide/error-handling.html[0m
[30;1m81 | [0m[35m            if error.response['Error']['Code'] == 'ValidationException':[0m
[30;1m82 | [0m[35m                self.errors_metadata.record_sdk_error("configureAgentErrors")[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/sdk_reporter/sdk_reporter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mclass SdkReporter(Reporter):[0m
[30;1m20 | [0m[35m    """[0m
[30;1m21 | [0m[35m    Handles communication with the CodeGuru Profiler Service backend.[0m
[30;1m22 | [0m[35m    Encodes profiles using the ProfilerEncoder and reports them using the CodeGuru profiler SDK.[0m
[30;1m23 | [0m[35m    """[0m
[30;1m24 | [0m[35m    is_create_pg_called_during_submit_profile = False[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m## How to contribute[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mCheck the GitHub repository at [aws/amazon-codeguru-profiler-python-agent](https://github.com/aws/am[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mSee [CONTRIBUTING](CONTRIBUTING.md) for details.[0m
[30;1m16 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/agent_metadata/aws_ec2_instance.py[0m
   Pattern: [32m.hostname[0m
[30;1m6 | [0m[35m# get the metadata through URI.[0m
[30;1m7 | [0m[35m# See https://github.com/boto/boto3/issues/313 for tracking the work for supporting such function in[0m
[30;1m8 | [0m[35mDEFAULT_EC2_METADATA_URI = "http://169.254.169.254/latest/meta-data/"[0m
[30;1m9 | [0m[35mEC2_HOST_NAME_URI = DEFAULT_EC2_METADATA_URI + "local-hostname"[0m
[30;1m10 | [0m[35mEC2_HOST_INSTANCE_TYPE_URI = DEFAULT_EC2_METADATA_URI + "instance-type"[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m# Used for IMDSv2 to retrieve API token that will be used to call the EC2 METADATA service.[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/metrics/timer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m        self.metrics = {}[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    def get_metric(self, name):[0m
[30;1m23 | [0m[35m        return self.metrics.get(name)[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/metrics/timer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m11 | [0m[35m        self.metrics = {}[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m    def record(self, name, value):[0m
[30;1m14 | [0m[35m        metric = self.metrics.get(name)[0m
[30;1m15 | [0m[35m        if metric is None:[0m
[30;1m16 | [0m[35m            metric = self.metrics[name] = Metric()[0m
[30;1m17 | [0m[35m        metric.add(value)[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m240[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/codeguru_profiler_agent-1.2.5/codeguru_profiler_agent/metrics/timer.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m4 | [0m[35mclass Timer:[0m
[30;1m5 | [0m[35m    """[0m
[30;1m6 | [0m[35m    Keeps all metrics collected during Profiler execution.[0m
[30;1m7 | [0m[35m    At the moment these metrics are collected but not reported to the backend.[0m
[30;1m8 | [0m[35m    """[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35m    def __init__(self):[0m

240 matches found.
