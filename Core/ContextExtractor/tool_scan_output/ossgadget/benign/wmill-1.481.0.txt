[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1179 | [0m[35m                if _client is None:[0m
[30;1m1180 | [0m[35m                    _client = Windmill()[0m
[30;1m1181 | [0m[35m                w_id = os.environ.get("WM_WORKSPACE")[0m
[30;1m1182 | [0m[35m                job_id = os.environ.get("WM_JOB_ID")[0m
[30;1m1183 | [0m[35m                f_name = func.__name__[0m
[30;1m1184 | [0m[35m                json = kwargs[0m
[30;1m1185 | [0m[35m                params = list(signature(func).parameters)[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1178 | [0m[35m                global _client[0m
[30;1m1179 | [0m[35m                if _client is None:[0m
[30;1m1180 | [0m[35m                    _client = Windmill()[0m
[30;1m1181 | [0m[35m                w_id = os.environ.get("WM_WORKSPACE")[0m
[30;1m1182 | [0m[35m                job_id = os.environ.get("WM_JOB_ID")[0m
[30;1m1183 | [0m[35m                f_name = func.__name__[0m
[30;1m1184 | [0m[35m                json = kwargs[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1166 | [0m[35m    from inspect import signature[0m
[30;1m1167 | [0m[35m[0m
[30;1m1168 | [0m[35m    def f(func, tag: str | None = None):[0m
[30;1m1169 | [0m[35m        if os.environ.get("WM_JOB_ID") is None or os.environ.get("MAIN_OVERRIDE") == func.__name__:[0m
[30;1m1170 | [0m[35m[0m
[30;1m1171 | [0m[35m            def inner(*args, **kwargs):[0m
[30;1m1172 | [0m[35m                return func(*args, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m742 | [0m[35m            params["dynamic_enums_json"] = json.dumps(dynamic_enums_json)[0m
[30;1m743 | [0m[35m[0m
[30;1m744 | [0m[35m        self.get([0m
[30;1m745 | [0m[35m            f"/w/{workspace}/jobs/slack_approval/{os.environ.get('WM_JOB_ID', 'NO_JOB_ID')}",[0m
[30;1m746 | [0m[35m            params=params,[0m
[30;1m747 | [0m[35m        )[0m
[30;1m748 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m735 | [0m[35m        if channel_id:[0m
[30;1m736 | [0m[35m            params["channel_id"] = channel_id[0m
[30;1m737 | [0m[35m        if os.environ.get("WM_FLOW_STEP_ID"):[0m
[30;1m738 | [0m[35m            params["flow_step_id"] = os.environ.get("WM_FLOW_STEP_ID")[0m
[30;1m739 | [0m[35m        if default_args_json:[0m
[30;1m740 | [0m[35m            params["default_args_json"] = json.dumps(default_args_json)[0m
[30;1m741 | [0m[35m        if dynamic_enums_json:[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m734 | [0m[35m            params["slack_resource_path"] = slack_resource_path[0m
[30;1m735 | [0m[35m        if channel_id:[0m
[30;1m736 | [0m[35m            params["channel_id"] = channel_id[0m
[30;1m737 | [0m[35m        if os.environ.get("WM_FLOW_STEP_ID"):[0m
[30;1m738 | [0m[35m            params["flow_step_id"] = os.environ.get("WM_FLOW_STEP_ID")[0m
[30;1m739 | [0m[35m        if default_args_json:[0m
[30;1m740 | [0m[35m            params["default_args_json"] = json.dumps(default_args_json)[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m717 | [0m[35m        - The function checks for required environment variables (`WM_FLOW_JOB_ID`, `WM_FLOW_STEP_ID[0m
[30;1m718 | [0m[35m        """[0m
[30;1m719 | [0m[35m        workspace = self.workspace[0m
[30;1m720 | [0m[35m        flow_job_id = os.environ.get("WM_FLOW_JOB_ID")[0m
[30;1m721 | [0m[35m[0m
[30;1m722 | [0m[35m        if not flow_job_id:[0m
[30;1m723 | [0m[35m            raise Exception([0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m663 | [0m[35m[0m
[30;1m664 | [0m[35m    def get_resume_urls(self, approver: str = None) -> dict:[0m
[30;1m665 | [0m[35m        nonce = random.randint(0, 1000000000)[0m
[30;1m666 | [0m[35m        job_id = os.environ.get("WM_JOB_ID") or "NO_ID"[0m
[30;1m667 | [0m[35m        return self.get([0m
[30;1m668 | [0m[35m            f"/w/{self.workspace}/jobs/resume_urls/{job_id}/{nonce}",[0m
[30;1m669 | [0m[35m            params={"approver": approver},[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m608 | [0m[35m[0m
[30;1m609 | [0m[35m    @property[0m
[30;1m610 | [0m[35m    def state_path(self) -> str:[0m
[30;1m611 | [0m[35m        state_path = os.environ.get("WM_STATE_PATH_NEW", os.environ.get("WM_STATE_PATH"))[0m
[30;1m612 | [0m[35m        if state_path is None:[0m
[30;1m613 | [0m[35m            raise Exception("State path not found")[0m
[30;1m614 | [0m[35m        return state_path[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m408 | [0m[35m[0m
[30;1m409 | [0m[35m    def get_progress(self, job_id: Optional[str] = None) -> Any:[0m
[30;1m410 | [0m[35m        workspace = get_workspace()[0m
[30;1m411 | [0m[35m        job_id = job_id or os.environ.get("WM_JOB_ID")[0m
[30;1m412 | [0m[35m[0m
[30;1m413 | [0m[35m        r = self.get([0m
[30;1m414 | [0m[35m            f"/w/{workspace}/job_metrics/get_progress/{job_id}",[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m392 | [0m[35m    def set_progress(self, value: int, job_id: Optional[str] = None):[0m
[30;1m393 | [0m[35m        workspace = get_workspace()[0m
[30;1m394 | [0m[35m        flow_id = os.environ.get("WM_FLOW_JOB_ID")[0m
[30;1m395 | [0m[35m        job_id = job_id or os.environ.get("WM_JOB_ID")[0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m        if job_id != None:[0m
[30;1m398 | [0m[35m            job = self.get_job(job_id)[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m391 | [0m[35m[0m
[30;1m392 | [0m[35m    def set_progress(self, value: int, job_id: Optional[str] = None):[0m
[30;1m393 | [0m[35m        workspace = get_workspace()[0m
[30;1m394 | [0m[35m        flow_id = os.environ.get("WM_FLOW_JOB_ID")[0m
[30;1m395 | [0m[35m        job_id = job_id or os.environ.get("WM_JOB_ID")[0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m        if job_id != None:[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m263 | [0m[35m        return self.get(f"/w/{self.workspace}/jobs_u/get/{job_id}").json()[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m    def get_root_job_id(self, job_id: str | None = None) -> dict:[0m
[30;1m266 | [0m[35m        job_id = job_id or os.environ.get("WM_JOB_ID")[0m
[30;1m267 | [0m[35m        return self.get(f"/w/{self.workspace}/jobs_u/get_root_job_id/{job_id}").json()[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m    def get_id_token(self, audience: str) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m238 | [0m[35m            },[0m
[30;1m239 | [0m[35m        ).json()[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m        current_job_id = os.environ.get("WM_JOB_ID")[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m        logger.debug(f"{current_job_id = }")[0m
[30;1m244 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m138 | [0m[35m            if os.environ.get("WM_JOB_ID"):[0m
[30;1m139 | [0m[35m                params["parent_job"] = os.environ.get("WM_JOB_ID")[0m
[30;1m140 | [0m[35m            if os.environ.get("WM_ROOT_FLOW_JOB_ID"):[0m
[30;1m141 | [0m[35m                params["root_job"] = os.environ.get("WM_ROOT_FLOW_JOB_ID")[0m
[30;1m142 | [0m[35m        if path:[0m
[30;1m143 | [0m[35m            endpoint = f"/w/{self.workspace}/jobs/run/f/{path}"[0m
[30;1m144 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m137 | [0m[35m        if not do_not_track_in_parent:[0m
[30;1m138 | [0m[35m            if os.environ.get("WM_JOB_ID"):[0m
[30;1m139 | [0m[35m                params["parent_job"] = os.environ.get("WM_JOB_ID")[0m
[30;1m140 | [0m[35m            if os.environ.get("WM_ROOT_FLOW_JOB_ID"):[0m
[30;1m141 | [0m[35m                params["root_job"] = os.environ.get("WM_ROOT_FLOW_JOB_ID")[0m
[30;1m142 | [0m[35m        if path:[0m
[30;1m143 | [0m[35m            endpoint = f"/w/{self.workspace}/jobs/run/f/{path}"[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m136 | [0m[35m        params = {"scheduled_in_secs": scheduled_in_secs} if scheduled_in_secs else {}[0m
[30;1m137 | [0m[35m        if not do_not_track_in_parent:[0m
[30;1m138 | [0m[35m            if os.environ.get("WM_JOB_ID"):[0m
[30;1m139 | [0m[35m                params["parent_job"] = os.environ.get("WM_JOB_ID")[0m
[30;1m140 | [0m[35m            if os.environ.get("WM_ROOT_FLOW_JOB_ID"):[0m
[30;1m141 | [0m[35m                params["root_job"] = os.environ.get("WM_ROOT_FLOW_JOB_ID")[0m
[30;1m142 | [0m[35m        if path:[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m135 | [0m[35m        args = args or {}[0m
[30;1m136 | [0m[35m        params = {"scheduled_in_secs": scheduled_in_secs} if scheduled_in_secs else {}[0m
[30;1m137 | [0m[35m        if not do_not_track_in_parent:[0m
[30;1m138 | [0m[35m            if os.environ.get("WM_JOB_ID"):[0m
[30;1m139 | [0m[35m                params["parent_job"] = os.environ.get("WM_JOB_ID")[0m
[30;1m140 | [0m[35m            if os.environ.get("WM_ROOT_FLOW_JOB_ID"):[0m
[30;1m141 | [0m[35m                params["root_job"] = os.environ.get("WM_ROOT_FLOW_JOB_ID")[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m112 | [0m[35m        if os.environ.get("WM_JOB_ID"):[0m
[30;1m113 | [0m[35m            params["parent_job"] = os.environ.get("WM_JOB_ID")[0m
[30;1m114 | [0m[35m        if os.environ.get("WM_ROOT_FLOW_JOB_ID"):[0m
[30;1m115 | [0m[35m            params["root_job"] = os.environ.get("WM_ROOT_FLOW_JOB_ID")[0m
[30;1m116 | [0m[35m        if path:[0m
[30;1m117 | [0m[35m            endpoint = f"/w/{self.workspace}/jobs/run/p/{path}"[0m
[30;1m118 | [0m[35m        elif hash_:[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m111 | [0m[35m        params = {"scheduled_in_secs": scheduled_in_secs} if scheduled_in_secs else {}[0m
[30;1m112 | [0m[35m        if os.environ.get("WM_JOB_ID"):[0m
[30;1m113 | [0m[35m            params["parent_job"] = os.environ.get("WM_JOB_ID")[0m
[30;1m114 | [0m[35m        if os.environ.get("WM_ROOT_FLOW_JOB_ID"):[0m
[30;1m115 | [0m[35m            params["root_job"] = os.environ.get("WM_ROOT_FLOW_JOB_ID")[0m
[30;1m116 | [0m[35m        if path:[0m
[30;1m117 | [0m[35m            endpoint = f"/w/{self.workspace}/jobs/run/p/{path}"[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m110 | [0m[35m        args = args or {}[0m
[30;1m111 | [0m[35m        params = {"scheduled_in_secs": scheduled_in_secs} if scheduled_in_secs else {}[0m
[30;1m112 | [0m[35m        if os.environ.get("WM_JOB_ID"):[0m
[30;1m113 | [0m[35m            params["parent_job"] = os.environ.get("WM_JOB_ID")[0m
[30;1m114 | [0m[35m        if os.environ.get("WM_ROOT_FLOW_JOB_ID"):[0m
[30;1m115 | [0m[35m            params["root_job"] = os.environ.get("WM_ROOT_FLOW_JOB_ID")[0m
[30;1m116 | [0m[35m        if path:[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m109 | [0m[35m        assert not (path and hash_), "path and hash_ are mutually exclusive"[0m
[30;1m110 | [0m[35m        args = args or {}[0m
[30;1m111 | [0m[35m        params = {"scheduled_in_secs": scheduled_in_secs} if scheduled_in_secs else {}[0m
[30;1m112 | [0m[35m        if os.environ.get("WM_JOB_ID"):[0m
[30;1m113 | [0m[35m            params["parent_job"] = os.environ.get("WM_JOB_ID")[0m
[30;1m114 | [0m[35m        if os.environ.get("WM_ROOT_FLOW_JOB_ID"):[0m
[30;1m115 | [0m[35m            params["root_job"] = os.environ.get("WM_ROOT_FLOW_JOB_ID")[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m45 | [0m[35m        assert self.workspace, f"workspace required as an argument or as WM_WORKSPACE environment va[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    def get_mocked_api(self) -> Optional[dict]:[0m
[30;1m48 | [0m[35m        mocked_path = os.environ.get("WM_MOCKED_API_FILE")[0m
[30;1m49 | [0m[35m        if not mocked_path:[0m
[30;1m50 | [0m[35m            return None[0m
[30;1m51 | [0m[35m        logger.info("Using mocked API from %s", mocked_path)[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m38 | [0m[35m        self.verify = verify[0m
[30;1m39 | [0m[35m        self.client = self.get_client()[0m
[30;1m40 | [0m[35m        self.workspace = workspace or os.environ.get("WM_WORKSPACE")[0m
[30;1m41 | [0m[35m        self.path = os.environ.get("WM_JOB_PATH")[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m        self.mocked_api = self.get_mocked_api()[0m
[30;1m44 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m37 | [0m[35m        }[0m
[30;1m38 | [0m[35m        self.verify = verify[0m
[30;1m39 | [0m[35m        self.client = self.get_client()[0m
[30;1m40 | [0m[35m        self.workspace = workspace or os.environ.get("WM_WORKSPACE")[0m
[30;1m41 | [0m[35m        self.path = os.environ.get("WM_JOB_PATH")[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m        self.mocked_api = self.get_mocked_api()[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m30 | [0m[35m        base = base_url or os.environ.get("BASE_INTERNAL_URL") or os.environ.get("WM_BASE_URL")[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m        self.base_url = f"{base}/api"[0m
[30;1m33 | [0m[35m        self.token = token or os.environ.get("WM_TOKEN")[0m
[30;1m34 | [0m[35m        self.headers = {[0m
[30;1m35 | [0m[35m            "Content-Type": "application/json",[0m
[30;1m36 | [0m[35m            "Authorization": f"Bearer {self.token}",[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mclass Windmill:[0m
[30;1m29 | [0m[35m    def __init__(self, base_url=None, token=None, workspace=None, verify=True):[0m
[30;1m30 | [0m[35m        base = base_url or os.environ.get("BASE_INTERNAL_URL") or os.environ.get("WM_BASE_URL")[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m        self.base_url = f"{base}/api"[0m
[30;1m33 | [0m[35m        self.token = token or os.environ.get("WM_TOKEN")[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m594 | [0m[35m                "region_name": s3_resource["region"],[0m
[30;1m595 | [0m[35m                "use_ssl": s3_resource["useSSL"],[0m
[30;1m596 | [0m[35m                "aws_access_key_id": s3_resource["accessKey"],[0m
[30;1m597 | [0m[35m                "aws_secret_access_key": s3_resource["secretKey"],[0m
[30;1m598 | [0m[35m                # no need for path_style here as boto3 is clever enough to determine which one to us[0m
[30;1m599 | [0m[35m            }[0m
[30;1m600 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/README.md[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m    # list worker groups[0m
[30;1m60 | [0m[35m    client.get("/configs/list_worker_groups")[0m
[30;1m61 | [0m[35m    # create a group[0m
[30;1m62 | [0m[35m    client.post([0m
[30;1m63 | [0m[35m        f"/w/{client.workspace}/groups/create",[0m
[30;1m64 | [0m[35m        json={[0m
[30;1m65 | [0m[35m            "name": "my-group",[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/README.md[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m    # Convenience get and post methods exist for https://app.windmill.dev/openapi.html#/[0m
[30;1m58 | [0m[35m    # these are thin wrappers around the httpx library's get and post methods[0m
[30;1m59 | [0m[35m    # list worker groups[0m
[30;1m60 | [0m[35m    client.get("/configs/list_worker_groups")[0m
[30;1m61 | [0m[35m    # create a group[0m
[30;1m62 | [0m[35m    client.post([0m
[30;1m63 | [0m[35m        f"/w/{client.workspace}/groups/create",[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m        }[0m
[30;1m68 | [0m[35m    )[0m
[30;1m69 | [0m[35m    [0m
[30;1m70 | [0m[35m    # Get and set the state of the script[0m
[30;1m71 | [0m[35m    now = time.time()[0m
[30;1m72 | [0m[35m    client.state = {"ts": now}[0m
[30;1m73 | [0m[35m    assert client.state == {"ts": now}[0m
[30;1m74 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35mdef main():[0m
[30;1m47 | [0m[35m    client = Windmill([0m
[30;1m48 | [0m[35m        # token=...  <- this is optional. otherwise the client will look for the WM_TOKEN env var[0m
[30;1m49 | [0m[35m    )[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    # Get the current version of the client[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35mThe `wmill` package also exposes the `Windmill` class, which is the core client for the Windmill pla[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m```python[0m
[30;1m42 | [0m[35mimport time[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35mfrom wmill import Windmill[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35mdef main():[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m    # Get the value of a variable[0m
[30;1m22 | [0m[35m    wmill.get_variable("u/user/variable_path")[0m
[30;1m23 | [0m[35m    [0m
[30;1m24 | [0m[35m    # Run a script synchronously and get the result[0m
[30;1m25 | [0m[35m    wmill.run_script("f/pathto/script", args={"arg1": "value1"})[0m
[30;1m26 | [0m[35m    [0m
[30;1m27 | [0m[35m    # Get the value of a resource[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35mThe following are some common examples:[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m```python[0m
[30;1m15 | [0m[35mimport time[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35mimport wmill[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m### Basic Usage[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mThe `wmill` package has several methods at the top-level for the most frequent operations you will n[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mThe following are some common examples:[0m
[30;1m13 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m.userInfo[0m
[30;1m975 | [0m[35m[0m
[30;1m976 | [0m[35m[0m
[30;1m977 | [0m[35m@init_global_client[0m
[30;1m978 | [0m[35mdef whoami() -> dict:[0m
[30;1m979 | [0m[35m    """[0m
[30;1m980 | [0m[35m    Returns the current user[0m
[30;1m981 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m.userInfo[0m
[30;1m604 | [0m[35m[0m
[30;1m605 | [0m[35m    @property[0m
[30;1m606 | [0m[35m    def user(self) -> dict:[0m
[30;1m607 | [0m[35m        return self.whoami()[0m
[30;1m608 | [0m[35m[0m
[30;1m609 | [0m[35m    @property[0m
[30;1m610 | [0m[35m    def state_path(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m.userInfo[0m
[30;1m600 | [0m[35m        )[0m
[30;1m601 | [0m[35m[0m
[30;1m602 | [0m[35m    def whoami(self) -> dict:[0m
[30;1m603 | [0m[35m        return self.get("/users/whoami").json()[0m
[30;1m604 | [0m[35m[0m
[30;1m605 | [0m[35m    @property[0m
[30;1m606 | [0m[35m    def user(self) -> dict:[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000703[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Username[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m.userInfo[0m
[30;1m599 | [0m[35m            }[0m
[30;1m600 | [0m[35m        )[0m
[30;1m601 | [0m[35m[0m
[30;1m602 | [0m[35m    def whoami(self) -> dict:[0m
[30;1m603 | [0m[35m        return self.get("/users/whoami").json()[0m
[30;1m604 | [0m[35m[0m
[30;1m605 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1209 | [0m[35m    if len(args) == 1 and len(kwargs) == 0 and callable(args[0]):[0m
[30;1m1210 | [0m[35m        return f(args[0], None)[0m
[30;1m1211 | [0m[35m    else:[0m
[30;1m1212 | [0m[35m        return lambda x: f(x, kwargs.get("tag"))[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1193 | [0m[35m                params = {}[0m
[30;1m1194 | [0m[35m                if tag is not None:[0m
[30;1m1195 | [0m[35m                    params["tag"] = tag[0m
[30;1m1196 | [0m[35m                r = _client.post([0m
[30;1m1197 | [0m[35m                    f"/w/{w_id}/jobs/run/workflow_as_code/{job_id}/{f_name}",[0m
[30;1m1198 | [0m[35m                    json={"args": json},[0m
[30;1m1199 | [0m[35m                    params=params,[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1179 | [0m[35m                if _client is None:[0m
[30;1m1180 | [0m[35m                    _client = Windmill()[0m
[30;1m1181 | [0m[35m                w_id = os.environ.get("WM_WORKSPACE")[0m
[30;1m1182 | [0m[35m                job_id = os.environ.get("WM_JOB_ID")[0m
[30;1m1183 | [0m[35m                f_name = func.__name__[0m
[30;1m1184 | [0m[35m                json = kwargs[0m
[30;1m1185 | [0m[35m                params = list(signature(func).parameters)[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1178 | [0m[35m                global _client[0m
[30;1m1179 | [0m[35m                if _client is None:[0m
[30;1m1180 | [0m[35m                    _client = Windmill()[0m
[30;1m1181 | [0m[35m                w_id = os.environ.get("WM_WORKSPACE")[0m
[30;1m1182 | [0m[35m                job_id = os.environ.get("WM_JOB_ID")[0m
[30;1m1183 | [0m[35m                f_name = func.__name__[0m
[30;1m1184 | [0m[35m                json = kwargs[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1166 | [0m[35m    from inspect import signature[0m
[30;1m1167 | [0m[35m[0m
[30;1m1168 | [0m[35m    def f(func, tag: str | None = None):[0m
[30;1m1169 | [0m[35m        if os.environ.get("WM_JOB_ID") is None or os.environ.get("MAIN_OVERRIDE") == func.__name__:[0m
[30;1m1170 | [0m[35m[0m
[30;1m1171 | [0m[35m            def inner(*args, **kwargs):[0m
[30;1m1172 | [0m[35m                return func(*args, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1166 | [0m[35m    from inspect import signature[0m
[30;1m1167 | [0m[35m[0m
[30;1m1168 | [0m[35m    def f(func, tag: str | None = None):[0m
[30;1m1169 | [0m[35m        if os.environ.get("WM_JOB_ID") is None or os.environ.get("MAIN_OVERRIDE") == func.__name__:[0m
[30;1m1170 | [0m[35m[0m
[30;1m1171 | [0m[35m            def inner(*args, **kwargs):[0m
[30;1m1172 | [0m[35m                return func(*args, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m759 | [0m[35m        """[0m
[30;1m760 | [0m[35m        Send a message to a Microsoft Teams conversation with conversation_id, where success is used[0m
[30;1m761 | [0m[35m        """[0m
[30;1m762 | [0m[35m        return self.post(f"/teams/activities", json={"conversation_id": conversation_id, "text": tex[0m
[30;1m763 | [0m[35m[0m
[30;1m764 | [0m[35m[0m
[30;1m765 | [0m[35mdef init_global_client(f):[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m752 | [0m[35m        This method is particularly useful for apps that require the email address of the viewer.[0m
[30;1m753 | [0m[35m        Indeed, in the viewer context WM_USERNAME is set to the username of the viewer but WM_EMAIL [0m
[30;1m754 | [0m[35m        """[0m
[30;1m755 | [0m[35m        return self.get(f"/w/{self.workspace}/users/username_to_email/{username}").text[0m
[30;1m756 | [0m[35m    [0m
[30;1m757 | [0m[35m[0m
[30;1m758 | [0m[35m    def send_teams_message(self, conversation_id: str, text: str, success: bool = True, card_block: [0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m742 | [0m[35m            params["dynamic_enums_json"] = json.dumps(dynamic_enums_json)[0m
[30;1m743 | [0m[35m[0m
[30;1m744 | [0m[35m        self.get([0m
[30;1m745 | [0m[35m            f"/w/{workspace}/jobs/slack_approval/{os.environ.get('WM_JOB_ID', 'NO_JOB_ID')}",[0m
[30;1m746 | [0m[35m            params=params,[0m
[30;1m747 | [0m[35m        )[0m
[30;1m748 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m741 | [0m[35m        if dynamic_enums_json:[0m
[30;1m742 | [0m[35m            params["dynamic_enums_json"] = json.dumps(dynamic_enums_json)[0m
[30;1m743 | [0m[35m[0m
[30;1m744 | [0m[35m        self.get([0m
[30;1m745 | [0m[35m            f"/w/{workspace}/jobs/slack_approval/{os.environ.get('WM_JOB_ID', 'NO_JOB_ID')}",[0m
[30;1m746 | [0m[35m            params=params,[0m
[30;1m747 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m735 | [0m[35m        if channel_id:[0m
[30;1m736 | [0m[35m            params["channel_id"] = channel_id[0m
[30;1m737 | [0m[35m        if os.environ.get("WM_FLOW_STEP_ID"):[0m
[30;1m738 | [0m[35m            params["flow_step_id"] = os.environ.get("WM_FLOW_STEP_ID")[0m
[30;1m739 | [0m[35m        if default_args_json:[0m
[30;1m740 | [0m[35m            params["default_args_json"] = json.dumps(default_args_json)[0m
[30;1m741 | [0m[35m        if dynamic_enums_json:[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m734 | [0m[35m            params["slack_resource_path"] = slack_resource_path[0m
[30;1m735 | [0m[35m        if channel_id:[0m
[30;1m736 | [0m[35m            params["channel_id"] = channel_id[0m
[30;1m737 | [0m[35m        if os.environ.get("WM_FLOW_STEP_ID"):[0m
[30;1m738 | [0m[35m            params["flow_step_id"] = os.environ.get("WM_FLOW_STEP_ID")[0m
[30;1m739 | [0m[35m        if default_args_json:[0m
[30;1m740 | [0m[35m            params["default_args_json"] = json.dumps(default_args_json)[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m717 | [0m[35m        - The function checks for required environment variables (`WM_FLOW_JOB_ID`, `WM_FLOW_STEP_ID[0m
[30;1m718 | [0m[35m        """[0m
[30;1m719 | [0m[35m        workspace = self.workspace[0m
[30;1m720 | [0m[35m        flow_job_id = os.environ.get("WM_FLOW_JOB_ID")[0m
[30;1m721 | [0m[35m[0m
[30;1m722 | [0m[35m        if not flow_job_id:[0m
[30;1m723 | [0m[35m            raise Exception([0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m664 | [0m[35m    def get_resume_urls(self, approver: str = None) -> dict:[0m
[30;1m665 | [0m[35m        nonce = random.randint(0, 1000000000)[0m
[30;1m666 | [0m[35m        job_id = os.environ.get("WM_JOB_ID") or "NO_ID"[0m
[30;1m667 | [0m[35m        return self.get([0m
[30;1m668 | [0m[35m            f"/w/{self.workspace}/jobs/resume_urls/{job_id}/{nonce}",[0m
[30;1m669 | [0m[35m            params={"approver": approver},[0m
[30;1m670 | [0m[35m        ).json()[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m663 | [0m[35m[0m
[30;1m664 | [0m[35m    def get_resume_urls(self, approver: str = None) -> dict:[0m
[30;1m665 | [0m[35m        nonce = random.randint(0, 1000000000)[0m
[30;1m666 | [0m[35m        job_id = os.environ.get("WM_JOB_ID") or "NO_ID"[0m
[30;1m667 | [0m[35m        return self.get([0m
[30;1m668 | [0m[35m            f"/w/{self.workspace}/jobs/resume_urls/{job_id}/{nonce}",[0m
[30;1m669 | [0m[35m            params={"approver": approver},[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m608 | [0m[35m[0m
[30;1m609 | [0m[35m    @property[0m
[30;1m610 | [0m[35m    def state_path(self) -> str:[0m
[30;1m611 | [0m[35m        state_path = os.environ.get("WM_STATE_PATH_NEW", os.environ.get("WM_STATE_PATH"))[0m
[30;1m612 | [0m[35m        if state_path is None:[0m
[30;1m613 | [0m[35m            raise Exception("State path not found")[0m
[30;1m614 | [0m[35m        return state_path[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m608 | [0m[35m[0m
[30;1m609 | [0m[35m    @property[0m
[30;1m610 | [0m[35m    def state_path(self) -> str:[0m
[30;1m611 | [0m[35m        state_path = os.environ.get("WM_STATE_PATH_NEW", os.environ.get("WM_STATE_PATH"))[0m
[30;1m612 | [0m[35m        if state_path is None:[0m
[30;1m613 | [0m[35m            raise Exception("State path not found")[0m
[30;1m614 | [0m[35m        return state_path[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m600 | [0m[35m        )[0m
[30;1m601 | [0m[35m[0m
[30;1m602 | [0m[35m    def whoami(self) -> dict:[0m
[30;1m603 | [0m[35m        return self.get("/users/whoami").json()[0m
[30;1m604 | [0m[35m[0m
[30;1m605 | [0m[35m    @property[0m
[30;1m606 | [0m[35m    def user(self) -> dict:[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m574 | [0m[35m[0m
[30;1m575 | [0m[35m        try:[0m
[30;1m576 | [0m[35m            # need a vanilla client b/c content-type is not application/json here[0m
[30;1m577 | [0m[35m            response = httpx.post([0m
[30;1m578 | [0m[35m                f"{self.base_url}/w/{self.workspace}/job_helpers/upload_s3_file",[0m
[30;1m579 | [0m[35m                headers={"Authorization": f"Bearer {self.token}", "Content-Type": "application/octet[0m
[30;1m580 | [0m[35m                params=query_params,[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m483 | [0m[35m        initiate an S3 connection using boto3[0m
[30;1m484 | [0m[35m        """[0m
[30;1m485 | [0m[35m        try:[0m
[30;1m486 | [0m[35m            s3_resource = self.post([0m
[30;1m487 | [0m[35m                f"/w/{self.workspace}/job_helpers/v2/s3_resource_info",[0m
[30;1m488 | [0m[35m                json={} if s3_resource_path == "" else {"s3_resource_path": s3_resource_path},[0m
[30;1m489 | [0m[35m            ).json()[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m466 | [0m[35m        initiate an S3 connection from Polars[0m
[30;1m467 | [0m[35m        """[0m
[30;1m468 | [0m[35m        try:[0m
[30;1m469 | [0m[35m            raw_obj = self.post([0m
[30;1m470 | [0m[35m                f"/w/{self.workspace}/job_helpers/v2/polars_connection_settings",[0m
[30;1m471 | [0m[35m                json={} if s3_resource_path == "" else {"s3_resource_path": s3_resource_path},[0m
[30;1m472 | [0m[35m            ).json()[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m449 | [0m[35m        initiate an S3 connection from DuckDB[0m
[30;1m450 | [0m[35m        """[0m
[30;1m451 | [0m[35m        try:[0m
[30;1m452 | [0m[35m            raw_obj = self.post([0m
[30;1m453 | [0m[35m                f"/w/{self.workspace}/job_helpers/v2/duckdb_connection_settings",[0m
[30;1m454 | [0m[35m                json={} if s3_resource_path == "" else {"s3_resource_path": s3_resource_path},[0m
[30;1m455 | [0m[35m            ).json()[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m438 | [0m[35m[0m
[30;1m439 | [0m[35m    @property[0m
[30;1m440 | [0m[35m    def version(self):[0m
[30;1m441 | [0m[35m        return self.get("version").text[0m
[30;1m442 | [0m[35m[0m
[30;1m443 | [0m[35m    def get_duckdb_connection_settings([0m
[30;1m444 | [0m[35m        self,[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m429 | [0m[35m    def get_flow_user_state(self, key: str) -> Any:[0m
[30;1m430 | [0m[35m        """Get the user state of a flow at a given key"""[0m
[30;1m431 | [0m[35m        flow_id = self.get_root_job_id()[0m
[30;1m432 | [0m[35m        r = self.get(f"/w/{self.workspace}/jobs/flow/user_states/{flow_id}/{key}", raise_for_status=[0m
[30;1m433 | [0m[35m        if r.status_code == 404:[0m
[30;1m434 | [0m[35m            print(f"Job {flow_id} does not exist or is not a flow")[0m
[30;1m435 | [0m[35m            return None[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m422 | [0m[35m    def set_flow_user_state(self, key: str, value: Any) -> None:[0m
[30;1m423 | [0m[35m        """Set the user state of a flow at a given key"""[0m
[30;1m424 | [0m[35m        flow_id = self.get_root_job_id()[0m
[30;1m425 | [0m[35m        r = self.post(f"/w/{self.workspace}/jobs/flow/user_states/{flow_id}/{key}", json=value, rais[0m
[30;1m426 | [0m[35m        if r.status_code == 404:[0m
[30;1m427 | [0m[35m            print(f"Job {flow_id} does not exist or is not a flow")[0m
[30;1m428 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m410 | [0m[35m        workspace = get_workspace()[0m
[30;1m411 | [0m[35m        job_id = job_id or os.environ.get("WM_JOB_ID")[0m
[30;1m412 | [0m[35m[0m
[30;1m413 | [0m[35m        r = self.get([0m
[30;1m414 | [0m[35m            f"/w/{workspace}/job_metrics/get_progress/{job_id}",[0m
[30;1m415 | [0m[35m        )[0m
[30;1m416 | [0m[35m        if r.status_code == 404:[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m408 | [0m[35m[0m
[30;1m409 | [0m[35m    def get_progress(self, job_id: Optional[str] = None) -> Any:[0m
[30;1m410 | [0m[35m        workspace = get_workspace()[0m
[30;1m411 | [0m[35m        job_id = job_id or os.environ.get("WM_JOB_ID")[0m
[30;1m412 | [0m[35m[0m
[30;1m413 | [0m[35m        r = self.get([0m
[30;1m414 | [0m[35m            f"/w/{workspace}/job_metrics/get_progress/{job_id}",[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m398 | [0m[35m            job = self.get_job(job_id)[0m
[30;1m399 | [0m[35m            flow_id = job.get("parent_job")[0m
[30;1m400 | [0m[35m[0m
[30;1m401 | [0m[35m        self.post([0m
[30;1m402 | [0m[35m            f"/w/{workspace}/job_metrics/set_progress/{job_id}",[0m
[30;1m403 | [0m[35m            json={[0m
[30;1m404 | [0m[35m                "percent": value,[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m        if job_id != None:[0m
[30;1m398 | [0m[35m            job = self.get_job(job_id)[0m
[30;1m399 | [0m[35m            flow_id = job.get("parent_job")[0m
[30;1m400 | [0m[35m[0m
[30;1m401 | [0m[35m        self.post([0m
[30;1m402 | [0m[35m            f"/w/{workspace}/job_metrics/set_progress/{job_id}",[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m392 | [0m[35m    def set_progress(self, value: int, job_id: Optional[str] = None):[0m
[30;1m393 | [0m[35m        workspace = get_workspace()[0m
[30;1m394 | [0m[35m        flow_id = os.environ.get("WM_FLOW_JOB_ID")[0m
[30;1m395 | [0m[35m        job_id = job_id or os.environ.get("WM_JOB_ID")[0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m        if job_id != None:[0m
[30;1m398 | [0m[35m            job = self.get_job(job_id)[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m391 | [0m[35m[0m
[30;1m392 | [0m[35m    def set_progress(self, value: int, job_id: Optional[str] = None):[0m
[30;1m393 | [0m[35m        workspace = get_workspace()[0m
[30;1m394 | [0m[35m        flow_id = os.environ.get("WM_FLOW_JOB_ID")[0m
[30;1m395 | [0m[35m        job_id = job_id or os.environ.get("WM_JOB_ID")[0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m        if job_id != None:[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m381 | [0m[35m            )[0m
[30;1m382 | [0m[35m        else:[0m
[30;1m383 | [0m[35m            # update resource[0m
[30;1m384 | [0m[35m            self.post([0m
[30;1m385 | [0m[35m                f"/w/{self.workspace}/resources/update_value/{path}",[0m
[30;1m386 | [0m[35m                json={"value": value},[0m
[30;1m387 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m371 | [0m[35m        r = self.get(f"/w/{self.workspace}/resources/get/{path}", raise_for_status=False)[0m
[30;1m372 | [0m[35m        if r.status_code == 404:[0m
[30;1m373 | [0m[35m            # create resource[0m
[30;1m374 | [0m[35m            self.post([0m
[30;1m375 | [0m[35m                f"/w/{self.workspace}/resources/create",[0m
[30;1m376 | [0m[35m                json={[0m
[30;1m377 | [0m[35m                    "path": path,[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m368 | [0m[35m            return[0m
[30;1m369 | [0m[35m[0m
[30;1m370 | [0m[35m        # check if resource exists[0m
[30;1m371 | [0m[35m        r = self.get(f"/w/{self.workspace}/resources/get/{path}", raise_for_status=False)[0m
[30;1m372 | [0m[35m        if r.status_code == 404:[0m
[30;1m373 | [0m[35m            # create resource[0m
[30;1m374 | [0m[35m            self.post([0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m350 | [0m[35m[0m
[30;1m351 | [0m[35m        """Get resource from Windmill"""[0m
[30;1m352 | [0m[35m        try:[0m
[30;1m353 | [0m[35m            return self.get(f"/w/{self.workspace}/resources/get_value_interpolated/{path}").json()[0m
[30;1m354 | [0m[35m        except Exception as e:[0m
[30;1m355 | [0m[35m            if none_if_undefined:[0m
[30;1m356 | [0m[35m                return None[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m326 | [0m[35m            )[0m
[30;1m327 | [0m[35m        else:[0m
[30;1m328 | [0m[35m            # update variable[0m
[30;1m329 | [0m[35m            self.post([0m
[30;1m330 | [0m[35m                f"/w/{self.workspace}/variables/update/{path}",[0m
[30;1m331 | [0m[35m                json={"value": value},[0m
[30;1m332 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m315 | [0m[35m        r = self.get(f"/w/{self.workspace}/variables/get/{path}", raise_for_status=False)[0m
[30;1m316 | [0m[35m        if r.status_code == 404:[0m
[30;1m317 | [0m[35m            # create variable[0m
[30;1m318 | [0m[35m            self.post([0m
[30;1m319 | [0m[35m                f"/w/{self.workspace}/variables/create",[0m
[30;1m320 | [0m[35m                json={[0m
[30;1m321 | [0m[35m                    "path": path,[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m312 | [0m[35m[0m
[30;1m313 | [0m[35m        """Set variable from Windmill"""[0m
[30;1m314 | [0m[35m        # check if variable exists[0m
[30;1m315 | [0m[35m        r = self.get(f"/w/{self.workspace}/variables/get/{path}", raise_for_status=False)[0m
[30;1m316 | [0m[35m        if r.status_code == 404:[0m
[30;1m317 | [0m[35m            # create variable[0m
[30;1m318 | [0m[35m            self.post([0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m303 | [0m[35m                logger.info(f"MockedAPI present, but variable not found at {path}, falling back to r[0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m        """Get variable from Windmill"""[0m
[30;1m306 | [0m[35m        return self.get(f"/w/{self.workspace}/variables/get_value/{path}").json()[0m
[30;1m307 | [0m[35m[0m
[30;1m308 | [0m[35m    def set_variable(self, path: str, value: str, is_secret: bool = False) -> None:[0m
[30;1m309 | [0m[35m        if self.mocked_api is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m284 | [0m[35m        job_id: str,[0m
[30;1m285 | [0m[35m        assert_result_is_not_none: bool = True,[0m
[30;1m286 | [0m[35m    ) -> Any:[0m
[30;1m287 | [0m[35m        result = self.get(f"/w/{self.workspace}/jobs_u/completed/get_result/{job_id}")[0m
[30;1m288 | [0m[35m        result_text = result.text[0m
[30;1m289 | [0m[35m        if assert_result_is_not_none and result_text is None:[0m
[30;1m290 | [0m[35m            raise Exception(f"result is None for {job_id = }")[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m275 | [0m[35m        assert job_type, f"{job} is not a valid job"[0m
[30;1m276 | [0m[35m        if job_type.lower() == "completedjob":[0m
[30;1m277 | [0m[35m            return "COMPLETED"[0m
[30;1m278 | [0m[35m        if job.get("running"):[0m
[30;1m279 | [0m[35m            return "RUNNING"[0m
[30;1m280 | [0m[35m        return "WAITING"[0m
[30;1m281 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m    def get_job_status(self, job_id: str) -> JobStatus:[0m
[30;1m273 | [0m[35m        job = self.get_job(job_id)[0m
[30;1m274 | [0m[35m        job_type = job.get("type", "")[0m
[30;1m275 | [0m[35m        assert job_type, f"{job} is not a valid job"[0m
[30;1m276 | [0m[35m        if job_type.lower() == "completedjob":[0m
[30;1m277 | [0m[35m            return "COMPLETED"[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m267 | [0m[35m        return self.get(f"/w/{self.workspace}/jobs_u/get_root_job_id/{job_id}").json()[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m    def get_id_token(self, audience: str) -> str:[0m
[30;1m270 | [0m[35m        return self.post(f"/w/{self.workspace}/oidc/token/{audience}").text[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m    def get_job_status(self, job_id: str) -> JobStatus:[0m
[30;1m273 | [0m[35m        job = self.get_job(job_id)[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m    def get_root_job_id(self, job_id: str | None = None) -> dict:[0m
[30;1m266 | [0m[35m        job_id = job_id or os.environ.get("WM_JOB_ID")[0m
[30;1m267 | [0m[35m        return self.get(f"/w/{self.workspace}/jobs_u/get_root_job_id/{job_id}").json()[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m    def get_id_token(self, audience: str) -> str:[0m
[30;1m270 | [0m[35m        return self.post(f"/w/{self.workspace}/oidc/token/{audience}").text[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m263 | [0m[35m        return self.get(f"/w/{self.workspace}/jobs_u/get/{job_id}").json()[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m    def get_root_job_id(self, job_id: str | None = None) -> dict:[0m
[30;1m266 | [0m[35m        job_id = job_id or os.environ.get("WM_JOB_ID")[0m
[30;1m267 | [0m[35m        return self.get(f"/w/{self.workspace}/jobs_u/get_root_job_id/{job_id}").json()[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m    def get_id_token(self, audience: str) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m        return result[0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35m    def get_job(self, job_id: str) -> dict:[0m
[30;1m263 | [0m[35m        return self.get(f"/w/{self.workspace}/jobs_u/get/{job_id}").json()[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m    def get_root_job_id(self, job_id: str | None = None) -> dict:[0m
[30;1m266 | [0m[35m        job_id = job_id or os.environ.get("WM_JOB_ID")[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m252 | [0m[35m        result = {}[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m        for id_ in job_ids:[0m
[30;1m255 | [0m[35m            result[id_] = self.post([0m
[30;1m256 | [0m[35m                f"/w/{self.workspace}/jobs_u/queue/cancel/{id_}",[0m
[30;1m257 | [0m[35m                json={"reason": "killed by `cancel_running` method"},[0m
[30;1m258 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m238 | [0m[35m            },[0m
[30;1m239 | [0m[35m        ).json()[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m        current_job_id = os.environ.get("WM_JOB_ID")[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m        logger.debug(f"{current_job_id = }")[0m
[30;1m244 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m230 | [0m[35m        """Cancel currently running executions of the same script."""[0m
[30;1m231 | [0m[35m        logger.info("canceling running executions of this script")[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m        jobs = self.get([0m
[30;1m234 | [0m[35m            f"/w/{self.workspace}/jobs/list",[0m
[30;1m235 | [0m[35m            params={[0m
[30;1m236 | [0m[35m                "running": "true",[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m216 | [0m[35m            if timeout and ((time.time() - start_time) > timeout):[0m
[30;1m217 | [0m[35m                msg = "reached timeout"[0m
[30;1m218 | [0m[35m                logger.warning(msg)[0m
[30;1m219 | [0m[35m                self.post([0m
[30;1m220 | [0m[35m                    f"/w/{self.workspace}/jobs_u/queue/cancel/{job_id}",[0m
[30;1m221 | [0m[35m                    json={"reason": msg},[0m
[30;1m222 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m191 | [0m[35m            timeout = timeout.total_seconds()[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m        while True:[0m
[30;1m194 | [0m[35m            result_res = self.get(f"/w/{self.workspace}/jobs_u/completed/get_result_maybe/{job_id}",[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m            started = result_res["started"][0m
[30;1m197 | [0m[35m            completed = result_res["completed"][0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m177 | [0m[35m    ):[0m
[30;1m178 | [0m[35m        def cancel_job():[0m
[30;1m179 | [0m[35m            logger.warning(f"cancelling job: {job_id}")[0m
[30;1m180 | [0m[35m            self.post([0m
[30;1m181 | [0m[35m                f"/w/{self.workspace}/jobs_u/queue/cancel/{job_id}",[0m
[30;1m182 | [0m[35m                json={"reason": "parent script cancelled"},[0m
[30;1m183 | [0m[35m            ).raise_for_status()[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m            endpoint = f"/w/{self.workspace}/jobs/run/f/{path}"[0m
[30;1m144 | [0m[35m        else:[0m
[30;1m145 | [0m[35m            raise Exception("path must be provided")[0m
[30;1m146 | [0m[35m        return self.post(endpoint, json=args, params=params).text[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m    def run_script([0m
[30;1m149 | [0m[35m        self,[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m138 | [0m[35m            if os.environ.get("WM_JOB_ID"):[0m
[30;1m139 | [0m[35m                params["parent_job"] = os.environ.get("WM_JOB_ID")[0m
[30;1m140 | [0m[35m            if os.environ.get("WM_ROOT_FLOW_JOB_ID"):[0m
[30;1m141 | [0m[35m                params["root_job"] = os.environ.get("WM_ROOT_FLOW_JOB_ID")[0m
[30;1m142 | [0m[35m        if path:[0m
[30;1m143 | [0m[35m            endpoint = f"/w/{self.workspace}/jobs/run/f/{path}"[0m
[30;1m144 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m137 | [0m[35m        if not do_not_track_in_parent:[0m
[30;1m138 | [0m[35m            if os.environ.get("WM_JOB_ID"):[0m
[30;1m139 | [0m[35m                params["parent_job"] = os.environ.get("WM_JOB_ID")[0m
[30;1m140 | [0m[35m            if os.environ.get("WM_ROOT_FLOW_JOB_ID"):[0m
[30;1m141 | [0m[35m                params["root_job"] = os.environ.get("WM_ROOT_FLOW_JOB_ID")[0m
[30;1m142 | [0m[35m        if path:[0m
[30;1m143 | [0m[35m            endpoint = f"/w/{self.workspace}/jobs/run/f/{path}"[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m        params = {"scheduled_in_secs": scheduled_in_secs} if scheduled_in_secs else {}[0m
[30;1m137 | [0m[35m        if not do_not_track_in_parent:[0m
[30;1m138 | [0m[35m            if os.environ.get("WM_JOB_ID"):[0m
[30;1m139 | [0m[35m                params["parent_job"] = os.environ.get("WM_JOB_ID")[0m
[30;1m140 | [0m[35m            if os.environ.get("WM_ROOT_FLOW_JOB_ID"):[0m
[30;1m141 | [0m[35m                params["root_job"] = os.environ.get("WM_ROOT_FLOW_JOB_ID")[0m
[30;1m142 | [0m[35m        if path:[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m        args = args or {}[0m
[30;1m136 | [0m[35m        params = {"scheduled_in_secs": scheduled_in_secs} if scheduled_in_secs else {}[0m
[30;1m137 | [0m[35m        if not do_not_track_in_parent:[0m
[30;1m138 | [0m[35m            if os.environ.get("WM_JOB_ID"):[0m
[30;1m139 | [0m[35m                params["parent_job"] = os.environ.get("WM_JOB_ID")[0m
[30;1m140 | [0m[35m            if os.environ.get("WM_ROOT_FLOW_JOB_ID"):[0m
[30;1m141 | [0m[35m                params["root_job"] = os.environ.get("WM_ROOT_FLOW_JOB_ID")[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m119 | [0m[35m            endpoint = f"/w/{self.workspace}/jobs/run/h/{hash_}"[0m
[30;1m120 | [0m[35m        else:[0m
[30;1m121 | [0m[35m            raise Exception("path or hash_ must be provided")[0m
[30;1m122 | [0m[35m        return self.post(endpoint, json=args, params=params).text[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    def run_flow_async([0m
[30;1m125 | [0m[35m        self,[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m        if os.environ.get("WM_JOB_ID"):[0m
[30;1m113 | [0m[35m            params["parent_job"] = os.environ.get("WM_JOB_ID")[0m
[30;1m114 | [0m[35m        if os.environ.get("WM_ROOT_FLOW_JOB_ID"):[0m
[30;1m115 | [0m[35m            params["root_job"] = os.environ.get("WM_ROOT_FLOW_JOB_ID")[0m
[30;1m116 | [0m[35m        if path:[0m
[30;1m117 | [0m[35m            endpoint = f"/w/{self.workspace}/jobs/run/p/{path}"[0m
[30;1m118 | [0m[35m        elif hash_:[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m111 | [0m[35m        params = {"scheduled_in_secs": scheduled_in_secs} if scheduled_in_secs else {}[0m
[30;1m112 | [0m[35m        if os.environ.get("WM_JOB_ID"):[0m
[30;1m113 | [0m[35m            params["parent_job"] = os.environ.get("WM_JOB_ID")[0m
[30;1m114 | [0m[35m        if os.environ.get("WM_ROOT_FLOW_JOB_ID"):[0m
[30;1m115 | [0m[35m            params["root_job"] = os.environ.get("WM_ROOT_FLOW_JOB_ID")[0m
[30;1m116 | [0m[35m        if path:[0m
[30;1m117 | [0m[35m            endpoint = f"/w/{self.workspace}/jobs/run/p/{path}"[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m        args = args or {}[0m
[30;1m111 | [0m[35m        params = {"scheduled_in_secs": scheduled_in_secs} if scheduled_in_secs else {}[0m
[30;1m112 | [0m[35m        if os.environ.get("WM_JOB_ID"):[0m
[30;1m113 | [0m[35m            params["parent_job"] = os.environ.get("WM_JOB_ID")[0m
[30;1m114 | [0m[35m        if os.environ.get("WM_ROOT_FLOW_JOB_ID"):[0m
[30;1m115 | [0m[35m            params["root_job"] = os.environ.get("WM_ROOT_FLOW_JOB_ID")[0m
[30;1m116 | [0m[35m        if path:[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m        assert not (path and hash_), "path and hash_ are mutually exclusive"[0m
[30;1m110 | [0m[35m        args = args or {}[0m
[30;1m111 | [0m[35m        params = {"scheduled_in_secs": scheduled_in_secs} if scheduled_in_secs else {}[0m
[30;1m112 | [0m[35m        if os.environ.get("WM_JOB_ID"):[0m
[30;1m113 | [0m[35m            params["parent_job"] = os.environ.get("WM_JOB_ID")[0m
[30;1m114 | [0m[35m        if os.environ.get("WM_ROOT_FLOW_JOB_ID"):[0m
[30;1m115 | [0m[35m            params["root_job"] = os.environ.get("WM_ROOT_FLOW_JOB_ID")[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m            "label": f"refresh {time.time()}",[0m
[30;1m97 | [0m[35m            "expiration": (dt.datetime.now() + duration).strftime("%Y-%m-%dT%H:%M:%SZ"),[0m
[30;1m98 | [0m[35m        }[0m
[30;1m99 | [0m[35m        return self.post(endpoint, json=payload).text[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m    def run_script_async([0m
[30;1m102 | [0m[35m        self,[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m    def post(self, endpoint, raise_for_status=True, **kwargs) -> httpx.Response:[0m
[30;1m82 | [0m[35m        endpoint = endpoint.lstrip("/")[0m
[30;1m83 | [0m[35m        resp = self.client.post(f"/{endpoint}", **kwargs)[0m
[30;1m84 | [0m[35m        if raise_for_status:[0m
[30;1m85 | [0m[35m            try:[0m
[30;1m86 | [0m[35m                resp.raise_for_status()[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    def get(self, endpoint, raise_for_status=True, **kwargs) -> httpx.Response:[0m
[30;1m70 | [0m[35m        endpoint = endpoint.lstrip("/")[0m
[30;1m71 | [0m[35m        resp = self.client.get(f"/{endpoint}", **kwargs)[0m
[30;1m72 | [0m[35m        if raise_for_status:[0m
[30;1m73 | [0m[35m            try:[0m
[30;1m74 | [0m[35m                resp.raise_for_status()[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m        assert self.workspace, f"workspace required as an argument or as WM_WORKSPACE environment va[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    def get_mocked_api(self) -> Optional[dict]:[0m
[30;1m48 | [0m[35m        mocked_path = os.environ.get("WM_MOCKED_API_FILE")[0m
[30;1m49 | [0m[35m        if not mocked_path:[0m
[30;1m50 | [0m[35m            return None[0m
[30;1m51 | [0m[35m        logger.info("Using mocked API from %s", mocked_path)[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m        self.verify = verify[0m
[30;1m39 | [0m[35m        self.client = self.get_client()[0m
[30;1m40 | [0m[35m        self.workspace = workspace or os.environ.get("WM_WORKSPACE")[0m
[30;1m41 | [0m[35m        self.path = os.environ.get("WM_JOB_PATH")[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m        self.mocked_api = self.get_mocked_api()[0m
[30;1m44 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m        }[0m
[30;1m38 | [0m[35m        self.verify = verify[0m
[30;1m39 | [0m[35m        self.client = self.get_client()[0m
[30;1m40 | [0m[35m        self.workspace = workspace or os.environ.get("WM_WORKSPACE")[0m
[30;1m41 | [0m[35m        self.path = os.environ.get("WM_JOB_PATH")[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m        self.mocked_api = self.get_mocked_api()[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m        base = base_url or os.environ.get("BASE_INTERNAL_URL") or os.environ.get("WM_BASE_URL")[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m        self.base_url = f"{base}/api"[0m
[30;1m33 | [0m[35m        self.token = token or os.environ.get("WM_TOKEN")[0m
[30;1m34 | [0m[35m        self.headers = {[0m
[30;1m35 | [0m[35m            "Content-Type": "application/json",[0m
[30;1m36 | [0m[35m            "Authorization": f"Bearer {self.token}",[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mclass Windmill:[0m
[30;1m29 | [0m[35m    def __init__(self, base_url=None, token=None, workspace=None, verify=True):[0m
[30;1m30 | [0m[35m        base = base_url or os.environ.get("BASE_INTERNAL_URL") or os.environ.get("WM_BASE_URL")[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m        self.base_url = f"{base}/api"[0m
[30;1m33 | [0m[35m        self.token = token or os.environ.get("WM_TOKEN")[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mclass Windmill:[0m
[30;1m29 | [0m[35m    def __init__(self, base_url=None, token=None, workspace=None, verify=True):[0m
[30;1m30 | [0m[35m        base = base_url or os.environ.get("BASE_INTERNAL_URL") or os.environ.get("WM_BASE_URL")[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m        self.base_url = f"{base}/api"[0m
[30;1m33 | [0m[35m        self.token = token or os.environ.get("WM_TOKEN")[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1088 | [0m[35m@init_global_client[0m
[30;1m1089 | [0m[35mdef set_flow_user_state(key: str, value: Any) -> None:[0m
[30;1m1090 | [0m[35m    """[0m
[30;1m1091 | [0m[35m    Set the user state of a flow at a given key[0m
[30;1m1092 | [0m[35m    """[0m
[30;1m1093 | [0m[35m    return _client.set_flow_user_state(key, value)[0m
[30;1m1094 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1080 | [0m[35m@init_global_client[0m
[30;1m1081 | [0m[35mdef get_flow_user_state(key: str) -> Any:[0m
[30;1m1082 | [0m[35m    """[0m
[30;1m1083 | [0m[35m    Get the user state of a flow at a given key[0m
[30;1m1084 | [0m[35m    """[0m
[30;1m1085 | [0m[35m    return _client.get_flow_user_state(key)[0m
[30;1m1086 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1072 | [0m[35m@init_global_client[0m
[30;1m1073 | [0m[35mdef set_variable(path: str, value: str, is_secret: bool = False) -> None:[0m
[30;1m1074 | [0m[35m    """[0m
[30;1m1075 | [0m[35m    Set the variable at a given path as a string, creating it if it does not exist[0m
[30;1m1076 | [0m[35m    """[0m
[30;1m1077 | [0m[35m    return _client.set_variable(path, value, is_secret)[0m
[30;1m1078 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1064 | [0m[35m@init_global_client[0m
[30;1m1065 | [0m[35mdef get_variable(path: str) -> str:[0m
[30;1m1066 | [0m[35m    """[0m
[30;1m1067 | [0m[35m    Returns the variable at a given path as a string[0m
[30;1m1068 | [0m[35m    """[0m
[30;1m1069 | [0m[35m    return _client.get_variable(path)[0m
[30;1m1070 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1003 | [0m[35m@init_global_client[0m
[30;1m1004 | [0m[35mdef set_resource(path: str, value: Any, resource_type: str = "any") -> None:[0m
[30;1m1005 | [0m[35m    """[0m
[30;1m1006 | [0m[35m    Set the resource at a given path as a string, creating it if it does not exist[0m
[30;1m1007 | [0m[35m    """[0m
[30;1m1008 | [0m[35m    return _client.set_resource(value=value, path=path, resource_type=resource_type)[0m
[30;1m1009 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m427 | [0m[35m            print(f"Job {flow_id} does not exist or is not a flow")[0m
[30;1m428 | [0m[35m[0m
[30;1m429 | [0m[35m    def get_flow_user_state(self, key: str) -> Any:[0m
[30;1m430 | [0m[35m        """Get the user state of a flow at a given key"""[0m
[30;1m431 | [0m[35m        flow_id = self.get_root_job_id()[0m
[30;1m432 | [0m[35m        r = self.get(f"/w/{self.workspace}/jobs/flow/user_states/{flow_id}/{key}", raise_for_status=[0m
[30;1m433 | [0m[35m        if r.status_code == 404:[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m420 | [0m[35m            return r.json()[0m
[30;1m421 | [0m[35m[0m
[30;1m422 | [0m[35m    def set_flow_user_state(self, key: str, value: Any) -> None:[0m
[30;1m423 | [0m[35m        """Set the user state of a flow at a given key"""[0m
[30;1m424 | [0m[35m        flow_id = self.get_root_job_id()[0m
[30;1m425 | [0m[35m        r = self.post(f"/w/{self.workspace}/jobs/flow/user_states/{flow_id}/{key}", json=value, rais[0m
[30;1m426 | [0m[35m        if r.status_code == 404:[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m380 | [0m[35m                },[0m
[30;1m381 | [0m[35m            )[0m
[30;1m382 | [0m[35m        else:[0m
[30;1m383 | [0m[35m            # update resource[0m
[30;1m384 | [0m[35m            self.post([0m
[30;1m385 | [0m[35m                f"/w/{self.workspace}/resources/update_value/{path}",[0m
[30;1m386 | [0m[35m                json={"value": value},[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m346 | [0m[35m                if none_if_undefined:[0m
[30;1m347 | [0m[35m                    logger.info(f"resource not found at ${path}, but none_if_undefined is True, so r[0m
[30;1m348 | [0m[35m                    return None[0m
[30;1m349 | [0m[35m                logger.info(f"MockedAPI present, but resource not found at ${path}, falling back to [0m
[30;1m350 | [0m[35m[0m
[30;1m351 | [0m[35m        """Get resource from Windmill"""[0m
[30;1m352 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m344 | [0m[35m            except KeyError:[0m
[30;1m345 | [0m[35m                # NOTE: should mocked_api respect `none_if_undefined`?[0m
[30;1m346 | [0m[35m                if none_if_undefined:[0m
[30;1m347 | [0m[35m                    logger.info(f"resource not found at ${path}, but none_if_undefined is True, so r[0m
[30;1m348 | [0m[35m                    return None[0m
[30;1m349 | [0m[35m                logger.info(f"MockedAPI present, but resource not found at ${path}, falling back to [0m
[30;1m350 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m325 | [0m[35m                },[0m
[30;1m326 | [0m[35m            )[0m
[30;1m327 | [0m[35m        else:[0m
[30;1m328 | [0m[35m            # update variable[0m
[30;1m329 | [0m[35m            self.post([0m
[30;1m330 | [0m[35m                f"/w/{self.workspace}/variables/update/{path}",[0m
[30;1m331 | [0m[35m                json={"value": value},[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m300 | [0m[35m                result = variables[path][0m
[30;1m301 | [0m[35m                return result[0m
[30;1m302 | [0m[35m            except KeyError:[0m
[30;1m303 | [0m[35m                logger.info(f"MockedAPI present, but variable not found at {path}, falling back to r[0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m        """Get variable from Windmill"""[0m
[30;1m306 | [0m[35m        return self.get(f"/w/{self.workspace}/variables/get_value/{path}").json()[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m55 | [0m[35m                incoming_mocked_api = json.load(f)[0m
[30;1m56 | [0m[35m            mocked_api = {**mocked_api, **incoming_mocked_api}[0m
[30;1m57 | [0m[35m        except Exception as e:[0m
[30;1m58 | [0m[35m            logger.warning("Error parsing mocked API file at path %s Using empty mocked API.", mocke[0m
[30;1m59 | [0m[35m            logger.debug(e)[0m
[30;1m60 | [0m[35m        return mocked_api[0m
[30;1m61 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1140 | [0m[35m    cleanup: bool = True,[0m
[30;1m1141 | [0m[35m    assert_result_is_not_none: bool = True,[0m
[30;1m1142 | [0m[35m) -> Any:[0m
[30;1m1143 | [0m[35m    """Run script synchronously and return its result."""[0m
[30;1m1144 | [0m[35m    return _client.run_script([0m
[30;1m1145 | [0m[35m        path=path,[0m
[30;1m1146 | [0m[35m        hash_=hash_,[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m721 | [0m[35m[0m
[30;1m722 | [0m[35m        if not flow_job_id:[0m
[30;1m723 | [0m[35m            raise Exception([0m
[30;1m724 | [0m[35m                "You can't use 'request_interactive_slack_approval' function in a standalone script [0m
[30;1m725 | [0m[35m            )[0m
[30;1m726 | [0m[35m[0m
[30;1m727 | [0m[35m        # Only include non-empty parameters[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m213 | [0m[35m                    error = result["error"][0m
[30;1m214 | [0m[35m                    raise Exception(f"Job {job_id} was not successful: {str(error)}")[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m            if timeout and ((time.time() - start_time) > timeout):[0m
[30;1m217 | [0m[35m                msg = "reached timeout"[0m
[30;1m218 | [0m[35m                logger.warning(msg)[0m
[30;1m219 | [0m[35m                self.post([0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m188 | [0m[35m        start_time = time.time()[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m        if isinstance(timeout, dt.timedelta):[0m
[30;1m191 | [0m[35m            timeout = timeout.total_seconds()[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m        while True:[0m
[30;1m194 | [0m[35m            result_res = self.get(f"/w/{self.workspace}/jobs_u/completed/get_result_maybe/{job_id}",[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m179 | [0m[35m            logger.warning(f"cancelling job: {job_id}")[0m
[30;1m180 | [0m[35m            self.post([0m
[30;1m181 | [0m[35m                f"/w/{self.workspace}/jobs_u/queue/cancel/{job_id}",[0m
[30;1m182 | [0m[35m                json={"reason": "parent script cancelled"},[0m
[30;1m183 | [0m[35m            ).raise_for_status()[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m        if cleanup:[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m162 | [0m[35m            logger.info(f"running `{path}` synchronously with {args = }")[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m        if isinstance(timeout, dt.timedelta):[0m
[30;1m165 | [0m[35m            timeout = timeout.total_seconds()[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m        job_id = self.run_script_async(path=path, hash_=hash_, args=args)[0m
[30;1m168 | [0m[35m        return self.wait_job(job_id, timeout, verbose, cleanup, assert_result_is_not_none)[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m155 | [0m[35m        cleanup: bool = True,[0m
[30;1m156 | [0m[35m        assert_result_is_not_none: bool = False,[0m
[30;1m157 | [0m[35m    ) -> Any:[0m
[30;1m158 | [0m[35m        """Run script synchronously and return its result."""[0m
[30;1m159 | [0m[35m        args = args or {}[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m        if verbose:[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m105 | [0m[35m        args: dict = None,[0m
[30;1m106 | [0m[35m        scheduled_in_secs: int = None,[0m
[30;1m107 | [0m[35m    ) -> str:[0m
[30;1m108 | [0m[35m        """Create a script job and return its job id."""[0m
[30;1m109 | [0m[35m        assert not (path and hash_), "path and hash_ are mutually exclusive"[0m
[30;1m110 | [0m[35m        args = args or {}[0m
[30;1m111 | [0m[35m        params = {"scheduled_in_secs": scheduled_in_secs} if scheduled_in_secs else {}[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/wmill/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mimport logging[0m
[30;1m8 | [0m[35mimport os[0m
[30;1m9 | [0m[35mimport random[0m
[30;1m10 | [0m[35mimport time[0m
[30;1m11 | [0m[35mimport warnings[0m
[30;1m12 | [0m[35mimport json[0m
[30;1m13 | [0m[35mfrom json import JSONDecodeError[0m
[30;1m14 | [0m[35mfrom typing import Dict, Any, Union, Literal[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/PKG-INFO[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m    # list worker groups[0m
[30;1m80 | [0m[35m    client.get("/configs/list_worker_groups")[0m
[30;1m81 | [0m[35m    # create a group[0m
[30;1m82 | [0m[35m    client.post([0m
[30;1m83 | [0m[35m        f"/w/{client.workspace}/groups/create",[0m
[30;1m84 | [0m[35m        json={[0m
[30;1m85 | [0m[35m            "name": "my-group",[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/PKG-INFO[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m    # Convenience get and post methods exist for https://app.windmill.dev/openapi.html#/[0m
[30;1m78 | [0m[35m    # these are thin wrappers around the httpx library's get and post methods[0m
[30;1m79 | [0m[35m    # list worker groups[0m
[30;1m80 | [0m[35m    client.get("/configs/list_worker_groups")[0m
[30;1m81 | [0m[35m    # create a group[0m
[30;1m82 | [0m[35m    client.post([0m
[30;1m83 | [0m[35m        f"/w/{client.workspace}/groups/create",[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m### Basic Usage[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mThe `wmill` package has several methods at the top-level for the most frequent operations you will n[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35mThe following are some common examples:[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m        }[0m
[30;1m88 | [0m[35m    )[0m
[30;1m89 | [0m[35m    [0m
[30;1m90 | [0m[35m    # Get and set the state of the script[0m
[30;1m91 | [0m[35m    now = time.time()[0m
[30;1m92 | [0m[35m    client.state = {"ts": now}[0m
[30;1m93 | [0m[35m    assert client.state == {"ts": now}[0m
[30;1m94 | [0m[35m    [0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35mdef main():[0m
[30;1m67 | [0m[35m    client = Windmill([0m
[30;1m68 | [0m[35m        # token=...  <- this is optional. otherwise the client will look for the WM_TOKEN env var[0m
[30;1m69 | [0m[35m    )[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    # Get the current version of the client[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35mThe `wmill` package also exposes the `Windmill` class, which is the core client for the Windmill pla[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m```python[0m
[30;1m62 | [0m[35mimport time[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35mfrom wmill import Windmill[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35mdef main():[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m    # Get the value of a variable[0m
[30;1m42 | [0m[35m    wmill.get_variable("u/user/variable_path")[0m
[30;1m43 | [0m[35m    [0m
[30;1m44 | [0m[35m    # Run a script synchronously and get the result[0m
[30;1m45 | [0m[35m    wmill.run_script("f/pathto/script", args={"arg1": "value1"})[0m
[30;1m46 | [0m[35m    [0m
[30;1m47 | [0m[35m    # Get the value of a resource[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m141[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/wmill-1.481.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35mThe following are some common examples:[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m```python[0m
[30;1m35 | [0m[35mimport time[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35mimport wmill[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m[0m

141 matches found.
