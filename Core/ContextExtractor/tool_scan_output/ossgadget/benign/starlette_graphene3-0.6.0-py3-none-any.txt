[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m14[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/starlette_graphene3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m439 | [0m[35m[0m
[30;1m440 | [0m[35m    files = {k: v for (k, v) in request_body.items() if isinstance(v, UploadFile)}[0m
[30;1m441 | [0m[35m    for (name, paths) in name_path_map.items():[0m
[30;1m442 | [0m[35m        file = files.get(name)[0m
[30;1m443 | [0m[35m        if not file:[0m
[30;1m444 | [0m[35m            raise ValueError([0m
[30;1m445 | [0m[35m                f"File fields don't contain a valid UploadFile type for '{name}' mapping"[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m14[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/starlette_graphene3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m431 | [0m[35m        raise ValueError("'operations' field must be an Object or an Array")[0m
[30;1m432 | [0m[35m[0m
[30;1m433 | [0m[35m    try:[0m
[30;1m434 | [0m[35m        name_path_map = json.loads(request_body.get("map"))[0m
[30;1m435 | [0m[35m    except (TypeError, ValueError):[0m
[30;1m436 | [0m[35m        raise ValueError("'map' field must be a valid JSON")[0m
[30;1m437 | [0m[35m    if not isinstance(name_path_map, dict):[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m14[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/starlette_graphene3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m424 | [0m[35m        raise ValueError("Request body is not a valid multipart/form-data")[0m
[30;1m425 | [0m[35m[0m
[30;1m426 | [0m[35m    try:[0m
[30;1m427 | [0m[35m        operations = json.loads(request_body.get("operations"))[0m
[30;1m428 | [0m[35m    except (TypeError, ValueError):[0m
[30;1m429 | [0m[35m        raise ValueError("'operations' must be a valid JSON")[0m
[30;1m430 | [0m[35m    if not isinstance(operations, (dict, list)):[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m14[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/starlette_graphene3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m403 | [0m[35masync def _get_operation_from_request([0m
[30;1m404 | [0m[35m    request: Request,[0m
[30;1m405 | [0m[35m) -> Union[Dict[str, Any], List[Any]]:[0m
[30;1m406 | [0m[35m    content_type = request.headers.get("Content-Type", "").split(";")[0][0m
[30;1m407 | [0m[35m    if content_type == "application/json":[0m
[30;1m408 | [0m[35m        try:[0m
[30;1m409 | [0m[35m            return cast(Union[Dict[str, Any], List[Any]], await request.json())[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m14[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/starlette_graphene3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m252 | [0m[35m    ) -> None:[0m
[30;1m253 | [0m[35m        query = data["query"][0m
[30;1m254 | [0m[35m        variable_values = data.get("variables")[0m
[30;1m255 | [0m[35m        operation_name = data.get("operationName")[0m
[30;1m256 | [0m[35m        context_value = await self._get_context_value(websocket)[0m
[30;1m257 | [0m[35m        errors: List[GraphQLError] = [][0m
[30;1m258 | [0m[35m        operation: Optional[OperationDefinitionNode] = None[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m14[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/starlette_graphene3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m251 | [0m[35m        subscriptions: Dict[str, AsyncGenerator[Any, None]],[0m
[30;1m252 | [0m[35m    ) -> None:[0m
[30;1m253 | [0m[35m        query = data["query"][0m
[30;1m254 | [0m[35m        variable_values = data.get("variables")[0m
[30;1m255 | [0m[35m        operation_name = data.get("operationName")[0m
[30;1m256 | [0m[35m        context_value = await self._get_context_value(websocket)[0m
[30;1m257 | [0m[35m        errors: List[GraphQLError] = [][0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m14[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/starlette_graphene3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m236 | [0m[35m            await websocket.close()[0m
[30;1m237 | [0m[35m        elif message_type == GQL_START:[0m
[30;1m238 | [0m[35m            await self._ws_on_start([0m
[30;1m239 | [0m[35m                message.get("payload"), operation_id, websocket, subscriptions[0m
[30;1m240 | [0m[35m            )[0m
[30;1m241 | [0m[35m        elif message_type == GQL_STOP:[0m
[30;1m242 | [0m[35m            if operation_id in subscriptions:[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m14[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/starlette_graphene3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m230 | [0m[35m        message_type = cast(str, message.get("type"))[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m        if message_type == GQL_CONNECTION_INIT:[0m
[30;1m233 | [0m[35m            websocket.scope["connection_params"] = message.get("payload")[0m
[30;1m234 | [0m[35m            await websocket.send_json({"type": GQL_CONNECTION_ACK})[0m
[30;1m235 | [0m[35m        elif message_type == GQL_CONNECTION_TERMINATE:[0m
[30;1m236 | [0m[35m            await websocket.close()[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m14[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/starlette_graphene3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m227 | [0m[35m        subscriptions: Dict[str, AsyncGenerator[Any, None]],[0m
[30;1m228 | [0m[35m    ) -> None:[0m
[30;1m229 | [0m[35m        operation_id = cast(str, message.get("id"))[0m
[30;1m230 | [0m[35m        message_type = cast(str, message.get("type"))[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m        if message_type == GQL_CONNECTION_INIT:[0m
[30;1m233 | [0m[35m            websocket.scope["connection_params"] = message.get("payload")[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m14[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/starlette_graphene3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m226 | [0m[35m        websocket: WebSocket,[0m
[30;1m227 | [0m[35m        subscriptions: Dict[str, AsyncGenerator[Any, None]],[0m
[30;1m228 | [0m[35m    ) -> None:[0m
[30;1m229 | [0m[35m        operation_id = cast(str, message.get("id"))[0m
[30;1m230 | [0m[35m        message_type = cast(str, message.get("type"))[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m        if message_type == GQL_CONNECTION_INIT:[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m14[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/starlette_graphene3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m196 | [0m[35m        return JSONResponse([0m
[30;1m197 | [0m[35m            response,[0m
[30;1m198 | [0m[35m            status_code=200,[0m
[30;1m199 | [0m[35m            background=context_value.get("background"),[0m
[30;1m200 | [0m[35m        )[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35m    async def _run_websocket_server(self, websocket: WebSocket) -> None:[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m14[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/starlette_graphene3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m        query = operation["query"][0m
[30;1m169 | [0m[35m        variable_values = operation.get("variables")[0m
[30;1m170 | [0m[35m        operation_name = operation.get("operationName")[0m
[30;1m171 | [0m[35m        context_value = await self._get_context_value(request)[0m
[30;1m172 | [0m[35m[0m
[30;1m173 | [0m[35m        result = await graphql([0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m14[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/starlette_graphene3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m166 | [0m[35m            operation = operations[0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m        query = operation["query"][0m
[30;1m169 | [0m[35m        variable_values = operation.get("variables")[0m
[30;1m170 | [0m[35m        operation_name = operation.get("operationName")[0m
[30;1m171 | [0m[35m        context_value = await self._get_context_value(request)[0m
[30;1m172 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m14[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/starlette_graphene3.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m614 | [0m[35m      }[0m
[30;1m615 | [0m[35m    }[0m
[30;1m616 | [0m[35m[0m
[30;1m617 | [0m[35m    // When the query and variables string is edited, update the URL bar so[0m
[30;1m618 | [0m[35m    // that it can be easily shared[0m
[30;1m619 | [0m[35m    function onEditQuery(newQuery) {[0m
[30;1m620 | [0m[35m      parameters.query = newQuery;[0m

14 matches found.
