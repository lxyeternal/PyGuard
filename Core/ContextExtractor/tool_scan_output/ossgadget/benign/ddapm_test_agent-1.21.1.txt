[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m480 | [0m[35m][0m
[30;1m481 | [0m[35m```[0m
[30;1m482 | [0m[35m[0m
[30;1m483 | [0m[35m`flare_file` is the base64 encoded content of the tracer-flare payload.[0m
[30;1m484 | [0m[35m[0m
[30;1m485 | [0m[35mIf there was an error parsing the tracer-flare form, that will be recorded under `error`.[0m
[30;1m486 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m334 | [0m[35m][0m
[30;1m335 | [0m[35m```[0m
[30;1m336 | [0m[35m[0m
[30;1m337 | [0m[35m`body` is a base64 encoded body of the request.[0m
[30;1m338 | [0m[35m[0m
[30;1m339 | [0m[35m### /test/session/traces[0m
[30;1m340 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35mSample rates to be returned by the agent in response to trace v0.4 and v0.5 requests.[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35mExample: `"{'service:test,env:staging': 0.5, 'service:test2,env:prod': 0.2}"` (note the JSON has to [0m
[30;1m256 | [0m[35m[0m
[30;1m257 | [0m[35m#### [optional] `?test_session_token=`[0m
[30;1m258 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m123 | [0m[35m    assert len(requests) == 4[0m
[30;1m124 | [0m[35m    assert "X-Datadog-Trace-Count" in requests[0]["headers"][0m
[30;1m125 | [0m[35m    body = requests[0]["body"][0m
[30;1m126 | [0m[35m    traces = msgpack.unpackb(base64.b64decode(body))[0m
[30;1m127 | [0m[35m    assert len(traces) == 1[0m
[30;1m128 | [0m[35m    assert traces[0][0]["name"] == "http.request"[0m
[30;1m129 | [0m[35m    assert requests[0]["method"] == "PUT"[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mfrom typing import cast[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport msgpack[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/.github/workflows/publish_pypi.yml[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m74 | [0m[35m      - uses: pypa/gh-action-pypi-publish@release/v1[0m
[30;1m75 | [0m[35m        with:[0m
[30;1m76 | [0m[35m          user: __token__[0m
[30;1m77 | [0m[35m          password: ${{ secrets.PYPI_TOKEN }}[0m
[30;1m78 | [0m[35m          # To test: repository_url: https://test.pypi.org/legacy/[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m917 | [0m[35m            resp.append([0m
[30;1m918 | [0m[35m                {[0m
[30;1m919 | [0m[35m                    "headers": dict(req.headers),[0m
[30;1m920 | [0m[35m                    "body": base64.b64encode(await req.read()).decode(),[0m
[30;1m921 | [0m[35m                    "url": str(req.url),[0m
[30;1m922 | [0m[35m                    "method": req.method,[0m
[30;1m923 | [0m[35m                }[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport argparse[0m
[30;1m2 | [0m[35mimport atexit[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mfrom collections import OrderedDict[0m
[30;1m5 | [0m[35mfrom collections import defaultdict[0m
[30;1m6 | [0m[35mfrom dataclasses import dataclass[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1297 | [0m[35m    parser.add_argument([0m
[30;1m1298 | [0m[35m        "--disable-error-responses",[0m
[30;1m1299 | [0m[35m        type=bool,[0m
[30;1m1300 | [0m[35m        default=os.environ.get("DD_DISABLE_ERROR_RESPONSES", False),[0m
[30;1m1301 | [0m[35m        help=("Will change the test agent to send [200: Ok] responses instead of error responses bac[0m
[30;1m1302 | [0m[35m    )[0m
[30;1m1303 | [0m[35m    parsed_args = parser.parse_args(args=args)[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1291 | [0m[35m    parser.add_argument([0m
[30;1m1292 | [0m[35m        "--pool-trace-check-failures",[0m
[30;1m1293 | [0m[35m        type=bool,[0m
[30;1m1294 | [0m[35m        default=os.environ.get("DD_POOL_TRACE_CHECK_FAILURES", False),[0m
[30;1m1295 | [0m[35m        help=("Will change the test agent to pool Trace Check failures in memory that can later be a[0m
[30;1m1296 | [0m[35m    )[0m
[30;1m1297 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1283 | [0m[35m    parser.add_argument([0m
[30;1m1284 | [0m[35m        "--suppress-trace-parse-errors",[0m
[30;1m1285 | [0m[35m        type=bool,[0m
[30;1m1286 | [0m[35m        default=os.environ.get("DD_SUPPRESS_TRACE_PARSE_ERRORS", False),[0m
[30;1m1287 | [0m[35m        help=([0m
[30;1m1288 | [0m[35m            "Will change the test agent trace decoder to use a more resilient parser to prevent deco[0m
[30;1m1289 | [0m[35m        ),[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1277 | [0m[35m    parser.add_argument([0m
[30;1m1278 | [0m[35m        "--trace-request-delay",[0m
[30;1m1279 | [0m[35m        type=float,[0m
[30;1m1280 | [0m[35m        default=os.environ.get("DD_TEST_STALL_REQUEST_SECONDS", 0.0),[0m
[30;1m1281 | [0m[35m        help=("Will stall trace and telemetry requests for specified amount of time"),[0m
[30;1m1282 | [0m[35m    )[0m
[30;1m1283 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1271 | [0m[35m    parser.add_argument([0m
[30;1m1272 | [0m[35m        "--trace-uds-socket",[0m
[30;1m1273 | [0m[35m        type=str,[0m
[30;1m1274 | [0m[35m        default=os.environ.get("DD_APM_RECEIVER_SOCKET", None),[0m
[30;1m1275 | [0m[35m        help=("Will listen for traces on the specified socket path"),[0m
[30;1m1276 | [0m[35m    )[0m
[30;1m1277 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1265 | [0m[35m    parser.add_argument([0m
[30;1m1266 | [0m[35m        "--agent-url",[0m
[30;1m1267 | [0m[35m        type=str,[0m
[30;1m1268 | [0m[35m        default=os.environ.get("DD_TRACE_AGENT_URL", os.environ.get("DD_AGENT_URL", "")),[0m
[30;1m1269 | [0m[35m        help=("Datadog agent URL. If provided, any received data will be forwarded " "to the agent."[0m
[30;1m1270 | [0m[35m    )[0m
[30;1m1271 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1259 | [0m[35m    parser.add_argument([0m
[30;1m1260 | [0m[35m        "--log-span-fmt",[0m
[30;1m1261 | [0m[35m        type=str,[0m
[30;1m1262 | [0m[35m        default=os.environ.get("LOG_SPAN_FMT", "[{name}]"),[0m
[30;1m1263 | [0m[35m        help=("Format to use when logging spans. Default is '[{name}]'. " "All span attributes are a[0m
[30;1m1264 | [0m[35m    )[0m
[30;1m1265 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1253 | [0m[35m    parser.add_argument([0m
[30;1m1254 | [0m[35m        "--log-level",[0m
[30;1m1255 | [0m[35m        type=str,[0m
[30;1m1256 | [0m[35m        default=os.environ.get("LOG_LEVEL", "INFO"),[0m
[30;1m1257 | [0m[35m        help="Set the log level. DEBUG, INFO, WARNING, ERROR, CRITICAL.",[0m
[30;1m1258 | [0m[35m    )[0m
[30;1m1259 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1243 | [0m[35m    parser.add_argument([0m
[30;1m1244 | [0m[35m        "--enabled-checks",[0m
[30;1m1245 | [0m[35m        type=List[str],[0m
[30;1m1246 | [0m[35m        default=_parse_csv(os.environ.get("ENABLED_CHECKS", "")),[0m
[30;1m1247 | [0m[35m        help=([0m
[30;1m1248 | [0m[35m            "Comma-separated values of checks to enable. None are enabled "[0m
[30;1m1249 | [0m[35m            " by default. For the list of values see "[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1233 | [0m[35m    parser.add_argument([0m
[30;1m1234 | [0m[35m        "--snapshot-removed-attrs",[0m
[30;1m1235 | [0m[35m        type=Set[str],[0m
[30;1m1236 | [0m[35m        default=set(_parse_csv(os.environ.get("SNAPSHOT_REMOVED_ATTRS", ""))),[0m
[30;1m1237 | [0m[35m        help=([0m
[30;1m1238 | [0m[35m            "Comma-separated values of span attributes to remove. "[0m
[30;1m1239 | [0m[35m            "meta/metrics attributes can be removed by prefixing the key "[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1223 | [0m[35m    parser.add_argument([0m
[30;1m1224 | [0m[35m        "--snapshot-ignored-attrs",[0m
[30;1m1225 | [0m[35m        type=Set[str],[0m
[30;1m1226 | [0m[35m        default=set(_parse_csv(os.environ.get("SNAPSHOT_IGNORED_ATTRS", trace_snapshot.DEFAULT_SNAPS[0m
[30;1m1227 | [0m[35m        help=([0m
[30;1m1228 | [0m[35m            "Comma-separated values of span attributes to ignore. "[0m
[30;1m1229 | [0m[35m            "meta/metrics attributes can be ignored by prefixing the key "[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1217 | [0m[35m    parser.add_argument([0m
[30;1m1218 | [0m[35m        "--snapshot-ci-mode",[0m
[30;1m1219 | [0m[35m        type=int,[0m
[30;1m1220 | [0m[35m        default=int(os.environ.get("SNAPSHOT_CI", 0)),[0m
[30;1m1221 | [0m[35m        help="Enable CI mode for snapshotting. Enforces that snapshot files exist.",[0m
[30;1m1222 | [0m[35m    )[0m
[30;1m1223 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1211 | [0m[35m    parser.add_argument([0m
[30;1m1212 | [0m[35m        "--snapshot-dir",[0m
[30;1m1213 | [0m[35m        type=str,[0m
[30;1m1214 | [0m[35m        default=os.environ.get("SNAPSHOT_DIR", "snapshots"),[0m
[30;1m1215 | [0m[35m        help="Directory to store snapshots.",[0m
[30;1m1216 | [0m[35m    )[0m
[30;1m1217 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1207 | [0m[35m        dest="version",[0m
[30;1m1208 | [0m[35m        help="Print version info and exit.",[0m
[30;1m1209 | [0m[35m    )[0m
[30;1m1210 | [0m[35m    parser.add_argument("-p", "--port", type=int, default=int(os.environ.get("PORT", 8126)))[0m
[30;1m1211 | [0m[35m    parser.add_argument([0m
[30;1m1212 | [0m[35m        "--snapshot-dir",[0m
[30;1m1213 | [0m[35m        type=str,[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m747 | [0m[35m                        )[0m
[30;1m748 | [0m[35m[0m
[30;1m749 | [0m[35m                    await checks.check([0m
[30;1m750 | [0m[35m                        "trace_dd_service", trace=trace, dd_config_env=request.get("_dd_trace_env_va[0m
[30;1m751 | [0m[35m                    )[0m
[30;1m752 | [0m[35m                log.info("end of payload %s", "-" * 40)[0m
[30;1m753 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m743 | [0m[35m                    # perform peer service check on span[0m
[30;1m744 | [0m[35m                    for span in trace:[0m
[30;1m745 | [0m[35m                        await checks.check([0m
[30;1m746 | [0m[35m                            "trace_peer_service", span=span, dd_config_env=request.get("_dd_trace_en[0m
[30;1m747 | [0m[35m                        )[0m
[30;1m748 | [0m[35m[0m
[30;1m749 | [0m[35m                    await checks.check([0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m500 | [0m[35m                    req["integration"] = Integration([0m
[30;1m501 | [0m[35m                        integration_name=integration_name,[0m
[30;1m502 | [0m[35m                        integration_version=integration_version,[0m
[30;1m503 | [0m[35m                        dependency_name=req["_dd_trace_env_variables"].get("DD_DEPENDENCY_NAME", int[0m
[30;1m504 | [0m[35m                    )[0m
[30;1m505 | [0m[35m[0m
[30;1m506 | [0m[35m                    if req.headers.get("dd-client-library-version", None):[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/tracerflare.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m21 | [0m[35m        async for part in MultipartReader(request.headers, stream):[0m
[30;1m22 | [0m[35m            if isinstance(part, BodyPartReader) and part.name:[0m
[30;1m23 | [0m[35m                if part.name == "flare_file":[0m
[30;1m24 | [0m[35m                    tracer_flare[part.name] = base64.b64encode(await part.read()).decode("ascii")[0m
[30;1m25 | [0m[35m                else:[0m
[30;1m26 | [0m[35m                    tracer_flare[part.name] = await part.text()[0m
[30;1m27 | [0m[35m    except Exception as err:[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/tracerflare.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mfrom typing import Dict[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mfrom aiohttp import BodyPartReader[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/cmd.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m23 | [0m[35m        type=str,[0m
[30;1m24 | [0m[35m        default=os.environ.get([0m
[30;1m25 | [0m[35m            "DD_TRACE_AGENT_URL",[0m
[30;1m26 | [0m[35m            os.environ.get("DD_AGENT_URL", "http://localhost:8126"),[0m
[30;1m27 | [0m[35m        ),[0m
[30;1m28 | [0m[35m        help=("Test agent URL. Default is http://localhost:8126"),[0m
[30;1m29 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/cmd.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m21 | [0m[35m    parser.add_argument([0m
[30;1m22 | [0m[35m        "--agent-url",[0m
[30;1m23 | [0m[35m        type=str,[0m
[30;1m24 | [0m[35m        default=os.environ.get([0m
[30;1m25 | [0m[35m            "DD_TRACE_AGENT_URL",[0m
[30;1m26 | [0m[35m            os.environ.get("DD_AGENT_URL", "http://localhost:8126"),[0m
[30;1m27 | [0m[35m        ),[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/cmd.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m11 | [0m[35m    parser.add_argument([0m
[30;1m12 | [0m[35m        "--test-session-token",[0m
[30;1m13 | [0m[35m        type=str,[0m
[30;1m14 | [0m[35m        default=os.environ.get("TEST_SESSION_TOKEN"),[0m
[30;1m15 | [0m[35m        help="Test session token to query with.",[0m
[30;1m16 | [0m[35m    )[0m
[30;1m17 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/tracestats.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    return v06StatsPayload([0m
[30;1m71 | [0m[35m        Hostname=payload.get("Hostname"),[0m
[30;1m72 | [0m[35m        Env=payload.get("Env"),[0m
[30;1m73 | [0m[35m        Version=payload.get("Version"),[0m
[30;1m74 | [0m[35m        Stats=stats_buckets,[0m
[30;1m75 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m480 | [0m[35m][0m
[30;1m481 | [0m[35m```[0m
[30;1m482 | [0m[35m[0m
[30;1m483 | [0m[35m`flare_file` is the base64 encoded content of the tracer-flare payload.[0m
[30;1m484 | [0m[35m[0m
[30;1m485 | [0m[35mIf there was an error parsing the tracer-flare form, that will be recorded under `error`.[0m
[30;1m486 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m334 | [0m[35m][0m
[30;1m335 | [0m[35m```[0m
[30;1m336 | [0m[35m[0m
[30;1m337 | [0m[35m`body` is a base64 encoded body of the request.[0m
[30;1m338 | [0m[35m[0m
[30;1m339 | [0m[35m### /test/session/traces[0m
[30;1m340 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35mSample rates to be returned by the agent in response to trace v0.4 and v0.5 requests.[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35mExample: `"{'service:test,env:staging': 0.5, 'service:test2,env:prod': 0.2}"` (note the JSON has to [0m
[30;1m256 | [0m[35m[0m
[30;1m257 | [0m[35m#### [optional] `?test_session_token=`[0m
[30;1m258 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/fmt.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m54 | [0m[35m    parser.add_argument([0m
[30;1m55 | [0m[35m        "--log-level",[0m
[30;1m56 | [0m[35m        type=str,[0m
[30;1m57 | [0m[35m        default=os.environ.get("LOG_LEVEL", "INFO"),[0m
[30;1m58 | [0m[35m        help="Set the log level. DEBUG, INFO, WARNING, ERROR, CRITICAL.",[0m
[30;1m59 | [0m[35m    )[0m
[30;1m60 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m170 | [0m[35m    assert resp.status == 200, content[0m
[30;1m171 | [0m[35m    assert len(content) == 1[0m
[30;1m172 | [0m[35m    assert content[0]["method"] == "POST"[0m
[30;1m173 | [0m[35m    assert base64.b64decode(content[0]["body"]) == b""[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport json[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport pytest[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/remoteconfig.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m77 | [0m[35m            "target_files": [[0m
[30;1m78 | [0m[35m                {[0m
[30;1m79 | [0m[35m                    "path": path,[0m
[30;1m80 | [0m[35m                    "raw": str(base64.b64encode(msg_enc), encoding="utf-8"),[0m
[30;1m81 | [0m[35m                }[0m
[30;1m82 | [0m[35m            ],[0m
[30;1m83 | [0m[35m            "client_configs": [path],[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/remoteconfig.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m73 | [0m[35m                    encoding="utf-8",[0m
[30;1m74 | [0m[35m                )[0m
[30;1m75 | [0m[35m            ],[0m
[30;1m76 | [0m[35m            "targets": str(base64.b64encode(bytes(json.dumps(data), encoding="utf-8")), encoding="ut[0m
[30;1m77 | [0m[35m            "target_files": [[0m
[30;1m78 | [0m[35m                {[0m
[30;1m79 | [0m[35m                    "path": path,[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/remoteconfig.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m51 | [0m[35m        remote_config_payload = {[0m
[30;1m52 | [0m[35m            "roots": [[0m
[30;1m53 | [0m[35m                str([0m
[30;1m54 | [0m[35m                    base64.b64encode([0m
[30;1m55 | [0m[35m                        bytes([0m
[30;1m56 | [0m[35m                            json.dumps([0m
[30;1m57 | [0m[35m                                {[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/remoteconfig.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport datetime[0m
[30;1m3 | [0m[35mimport hashlib[0m
[30;1m4 | [0m[35mimport json[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m184 | [0m[35m                dd_service = dd_config_env.get(f"DD_{component.upper()}_SERVICE", None)[0m
[30;1m185 | [0m[35m                if not dd_service:[0m
[30;1m186 | [0m[35m                    log.debug("DD_SERVICE not set for component: %s. Args %s", component, dd_config_[0m
[30;1m187 | [0m[35m                dd_service = dd_service or dd_config_env.get("DD_SERVICE", None)[0m
[30;1m188 | [0m[35m                if dd_service is None:[0m
[30;1m189 | [0m[35m                    self.fail([0m
[30;1m190 | [0m[35m                        json.dumps(dd_config_env, indent=4)[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m            component = meta.get("component", "")[0m
[30;1m183 | [0m[35m            if component != "":[0m
[30;1m184 | [0m[35m                dd_service = dd_config_env.get(f"DD_{component.upper()}_SERVICE", None)[0m
[30;1m185 | [0m[35m                if not dd_service:[0m
[30;1m186 | [0m[35m                    log.debug("DD_SERVICE not set for component: %s. Args %s", component, dd_config_[0m
[30;1m187 | [0m[35m                dd_service = dd_service or dd_config_env.get("DD_SERVICE", None)[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m155 | [0m[35m            self.skip("Skipping Span Check `trace_dd_service` for Span Attribute Schema v0")[0m
[30;1m156 | [0m[35m            return[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m        if dd_config_env.get("DD_TRACE_HTTP_CLIENT_SPLIT_BY_DOMAIN", False) or dd_config_env.get([0m
[30;1m159 | [0m[35m            "DD_TRACE_DB_CLIENT_SPLIT_BY_INSTANCE", False[0m
[30;1m160 | [0m[35m        ):[0m
[30;1m161 | [0m[35m            log.debug([0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m155 | [0m[35m            self.skip("Skipping Span Check `trace_dd_service` for Span Attribute Schema v0")[0m
[30;1m156 | [0m[35m            return[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m        if dd_config_env.get("DD_TRACE_HTTP_CLIENT_SPLIT_BY_DOMAIN", False) or dd_config_env.get([0m
[30;1m159 | [0m[35m            "DD_TRACE_DB_CLIENT_SPLIT_BY_INSTANCE", False[0m
[30;1m160 | [0m[35m        ):[0m
[30;1m161 | [0m[35m            log.debug([0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m        whitelisted_components = ["rabbitmq", "jms", "kafka", "java-web-servlet-response"][0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m        if dd_config_env.get("DD_TRACE_SPAN_ATTRIBUTE_SCHEMA", "v0") != "v1":[0m
[30;1m154 | [0m[35m            log.debug("Skipping Span Check `trace_dd_service` for Span Attribute Schema v0")[0m
[30;1m155 | [0m[35m            self.skip("Skipping Span Check `trace_dd_service` for Span Attribute Schema v0")[0m
[30;1m156 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m        whitelisted_components = ["couchbase"][0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m        if dd_config_env.get("DD_TRACE_SPAN_ATTRIBUTE_SCHEMA", "v0") != "v0":[0m
[30;1m101 | [0m[35m            if "peer.service" in meta.keys():[0m
[30;1m102 | [0m[35m                for component in whitelisted_components:[0m
[30;1m103 | [0m[35m                    if component in meta.get("component", ""):[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m440 | [0m[35m][0m
[30;1m441 | [0m[35m```[0m
[30;1m442 | [0m[35m[0m
[30;1m443 | [0m[35m`flare_file` is the base64 encoded content of the tracer-flare payload.[0m
[30;1m444 | [0m[35m[0m
[30;1m445 | [0m[35mIf there was an error parsing the tracer-flare form, that will be recorded under `error`.[0m
[30;1m446 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m294 | [0m[35m][0m
[30;1m295 | [0m[35m```[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m`body` is a base64 encoded body of the request.[0m
[30;1m298 | [0m[35m[0m
[30;1m299 | [0m[35m### /test/session/traces[0m
[30;1m300 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35mSample rates to be returned by the agent in response to trace v0.4 and v0.5 requests.[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35mExample: `"{'service:test,env:staging': 0.5, 'service:test2,env:prod': 0.2}"` (note the JSON has to [0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35m#### [optional] `?test_session_token=`[0m
[30;1m218 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m701 | [0m[35m                "peer_tags": ["db.name", "mongodb.db", "messaging.system"],[0m
[30;1m702 | [0m[35m                "span_events": True,  # Advertise support for the top-level Span field for Span Even[0m
[30;1m703 | [0m[35m            },[0m
[30;1m704 | [0m[35m            headers={"Datadog-Agent-State": "03e868b3ecdd62a91423cc4c3917d0d151fb9fa486736911ab7f5a0[0m
[30;1m705 | [0m[35m        )[0m
[30;1m706 | [0m[35m[0m
[30;1m707 | [0m[35m    async def _handle_traces(self, request: Request, version: Literal["v0.4", "v0.5", "v0.7"]) -> we[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/conftest.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m473 | [0m[35m                "path": "employee/ASM_DD/16.recommended.json/config",[0m
[30;1m474 | [0m[35m                "length": 203383,[0m
[30;1m475 | [0m[35m                "hashes": [[0m
[30;1m476 | [0m[35m                    {"algorithm": "sha256", "hash": "ad984f3d9020ee932783ee6448cc4efc8a58aa2c8d3f4fd[0m
[30;1m477 | [0m[35m                ],[0m
[30;1m478 | [0m[35m            },[0m
[30;1m479 | [0m[35m        ],[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/conftest.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m466 | [0m[35m                "path": "datadog/2/ASM_DATA/blocked_users/config",[0m
[30;1m467 | [0m[35m                "length": 760,[0m
[30;1m468 | [0m[35m                "hashes": [[0m
[30;1m469 | [0m[35m                    {"algorithm": "sha256", "hash": "53e2dd0da7a7d6ca57f10c0e1d17fdfc7e44a987bb12826[0m
[30;1m470 | [0m[35m                ],[0m
[30;1m471 | [0m[35m            },[0m
[30;1m472 | [0m[35m            {[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/conftest.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m459 | [0m[35m                "path": "datadog/2/ASM_DATA/blocked_ips/config",[0m
[30;1m460 | [0m[35m                "length": 1290,[0m
[30;1m461 | [0m[35m                "hashes": [[0m
[30;1m462 | [0m[35m                    {"algorithm": "sha256", "hash": "a5e3b56034a6ad61d9853cd1b80061d04068ada2d5e3b1b[0m
[30;1m463 | [0m[35m                ],[0m
[30;1m464 | [0m[35m            },[0m
[30;1m465 | [0m[35m            {[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/conftest.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m452 | [0m[35m                "path": "datadog/2/ASM/exclusion_filters/config",[0m
[30;1m453 | [0m[35m                "length": 21,[0m
[30;1m454 | [0m[35m                "hashes": [[0m
[30;1m455 | [0m[35m                    {"algorithm": "sha256", "hash": "d75be3984bbd00451d1d56eff464d63a05727f192f0fa36[0m
[30;1m456 | [0m[35m                ],[0m
[30;1m457 | [0m[35m            },[0m
[30;1m458 | [0m[35m            {[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/conftest.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m445 | [0m[35m                "path": "datadog/2/ASM/disabled_rules/config",[0m
[30;1m446 | [0m[35m                "length": 57,[0m
[30;1m447 | [0m[35m                "hashes": [[0m
[30;1m448 | [0m[35m                    {"algorithm": "sha256", "hash": "ab06f434cf8b9bc50bf75c27abada0781dfb2590aea9c19[0m
[30;1m449 | [0m[35m                ],[0m
[30;1m450 | [0m[35m            },[0m
[30;1m451 | [0m[35m            {[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/conftest.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m438 | [0m[35m                "path": "datadog/2/ASM/custom_rules/config",[0m
[30;1m439 | [0m[35m                "length": 425,[0m
[30;1m440 | [0m[35m                "hashes": [[0m
[30;1m441 | [0m[35m                    {"algorithm": "sha256", "hash": "5c49e86c48d88e3e836e2cb85469ebf05c02a5d1bc76863[0m
[30;1m442 | [0m[35m                ],[0m
[30;1m443 | [0m[35m            },[0m
[30;1m444 | [0m[35m            {[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/conftest.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m431 | [0m[35m                "path": "datadog/2/ASM/blocking/config",[0m
[30;1m432 | [0m[35m                "length": 21,[0m
[30;1m433 | [0m[35m                "hashes": [[0m
[30;1m434 | [0m[35m                    {"algorithm": "sha256", "hash": "d75be3984bbd00451d1d56eff464d63a05727f192f0fa36[0m
[30;1m435 | [0m[35m                ],[0m
[30;1m436 | [0m[35m            },[0m
[30;1m437 | [0m[35m            {[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/ddapm_test_agent-1.21.1/flake.lock[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m102 | [0m[35m        "narHash": "sha256-8T3K5amndEavxnludPyfj3Z1IkcFdRpR23q+T0BVeZE=",[0m
[30;1m103 | [0m[35m        "owner": "numtide",[0m
[30;1m104 | [0m[35m        "repo": "treefmt-nix",[0m
[30;1m105 | [0m[35m        "rev": "9e09d30a644c57257715902efbb3adc56c79cf28",[0m
[30;1m106 | [0m[35m        "type": "github"[0m
[30;1m107 | [0m[35m      },[0m
[30;1m108 | [0m[35m      "original": {[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/ddapm_test_agent-1.21.1/flake.lock[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m84 | [0m[35m        "narHash": "sha256-Vy1rq5AaRuLzOxct8nz4T6wlgyUR7zLU309k9mBC768=",[0m
[30;1m85 | [0m[35m        "owner": "nix-systems",[0m
[30;1m86 | [0m[35m        "repo": "default",[0m
[30;1m87 | [0m[35m        "rev": "da67096a3b9bf56a91d16901293e51ba5b49a27e",[0m
[30;1m88 | [0m[35m        "type": "github"[0m
[30;1m89 | [0m[35m      },[0m
[30;1m90 | [0m[35m      "original": {[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/ddapm_test_agent-1.21.1/flake.lock[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m60 | [0m[35m        "narHash": "sha256-9hbb1rqGelllb4kVUCZ307G2k3/UhmA8PPGBoyuWaSw=",[0m
[30;1m61 | [0m[35m        "owner": "nixos",[0m
[30;1m62 | [0m[35m        "repo": "nixpkgs",[0m
[30;1m63 | [0m[35m        "rev": "2c15aa59df0017ca140d9ba302412298ab4bf22a",[0m
[30;1m64 | [0m[35m        "type": "github"[0m
[30;1m65 | [0m[35m      },[0m
[30;1m66 | [0m[35m      "original": {[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/ddapm_test_agent-1.21.1/flake.lock[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m44 | [0m[35m        "narHash": "sha256-vboIEwIQojofItm2xGCdZCzW96U85l9nDW3ifMuAIdM=",[0m
[30;1m45 | [0m[35m        "owner": "NixOS",[0m
[30;1m46 | [0m[35m        "repo": "nixpkgs",[0m
[30;1m47 | [0m[35m        "rev": "63dacb46bf939521bdc93981b4cbb7ecb58427a0",[0m
[30;1m48 | [0m[35m        "type": "github"[0m
[30;1m49 | [0m[35m      },[0m
[30;1m50 | [0m[35m      "original": {[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/ddapm_test_agent-1.21.1/flake.lock[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m29 | [0m[35m        "narHash": "sha256-p4gB3Rhw8R6Ak4eMl8pqjCPOLCZRqaehZxdZ/mbFClM=",[0m
[30;1m30 | [0m[35m        "owner": "nix-community",[0m
[30;1m31 | [0m[35m        "repo": "nix-github-actions",[0m
[30;1m32 | [0m[35m        "rev": "7b5f051df789b6b20d259924d349a9ba3319b226",[0m
[30;1m33 | [0m[35m        "type": "github"[0m
[30;1m34 | [0m[35m      },[0m
[30;1m35 | [0m[35m      "original": {[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/ddapm_test_agent-1.21.1/flake.lock[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m9 | [0m[35m        "narHash": "sha256-l0KFg5HjrsfsO/JpG+r7fRrqm12kzFHyUHqHCVpMMbI=",[0m
[30;1m10 | [0m[35m        "owner": "numtide",[0m
[30;1m11 | [0m[35m        "repo": "flake-utils",[0m
[30;1m12 | [0m[35m        "rev": "11707dc2f618dd54ca8739b309ec4fc024de578b",[0m
[30;1m13 | [0m[35m        "type": "github"[0m
[30;1m14 | [0m[35m      },[0m
[30;1m15 | [0m[35m      "original": {[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/LICENSE.apache2[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m189 | [0m[35m   Copyright 2016 Datadog, Inc.[0m
[30;1m190 | [0m[35m   Licensed under the Apache License, Version 2.0 (the "License");[0m
[30;1m191 | [0m[35m   you may not use this file except in compliance with the License.[0m
[30;1m192 | [0m[35m   You may obtain a copy of the License at[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m       http://www.apache.org/licenses/LICENSE-2.0[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m   Unless required by applicable law or agreed to in writing, software[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/LICENSE.apache2[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m107 | [0m[35m          distribution, then any Derivative Works that You distribute must[0m
[30;1m108 | [0m[35m          include a readable copy of the attribution notices contained[0m
[30;1m109 | [0m[35m          within such NOTICE file, excluding those notices that do not[0m
[30;1m110 | [0m[35m          pertain to any part of the Derivative Works, in at least one[0m
[30;1m111 | [0m[35m          of the following places: within a NOTICE text file distributed[0m
[30;1m112 | [0m[35m          as part of the Derivative Works; within the Source form or[0m
[30;1m113 | [0m[35m          documentation, if provided along with the Derivative Works; or,[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/LICENSE.apache2[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m53 | [0m[35m      the copyright owner. For the purposes of this definition, "submitted"[0m
[30;1m54 | [0m[35m      means any form of electronic, verbal, or written communication sent[0m
[30;1m55 | [0m[35m      to the Licensor or its representatives, including but not limited to[0m
[30;1m56 | [0m[35m      communication on electronic mailing lists, source code control systems,[0m
[30;1m57 | [0m[35m      and issue tracking systems that are managed by, or on behalf of, the[0m
[30;1m58 | [0m[35m      Licensor for the purpose of discussing and improving the Work, but[0m
[30;1m59 | [0m[35m      excluding communication that is conspicuously marked or otherwise[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/LICENSE.apache2[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m      "Legal Entity" shall mean the union of the acting entity and all[0m
[30;1m16 | [0m[35m      other entities that control, are controlled by, or are under common[0m
[30;1m17 | [0m[35m      control with that entity. For the purposes of this definition,[0m
[30;1m18 | [0m[35m      "control" means (i) the power, direct or indirect, to cause the[0m
[30;1m19 | [0m[35m      direction or management of such entity, whether by contract or[0m
[30;1m20 | [0m[35m      otherwise, or (ii) ownership of fifty percent (50%) or more of the[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/LICENSE.apache2[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m136 | [0m[35m      with Licensor regarding such Contributions.[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m   6. Trademarks. This License does not grant permission to use the trade[0m
[30;1m139 | [0m[35m      names, trademarks, service marks, or product names of the Licensor,[0m
[30;1m140 | [0m[35m      except as required for reasonable and customary use in describing the[0m
[30;1m141 | [0m[35m      origin of the Work and reproducing the content of the NOTICE file.[0m
[30;1m142 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m373 | [0m[35m                        attribute_diffs,[0m
[30;1m374 | [0m[35m                        f"{i} attributes",[0m
[30;1m375 | [0m[35m                        s_exp["span_events"][i].get("attributes") or {},[0m
[30;1m376 | [0m[35m                        s_rec["span_events"][i].get("attributes") or {},[0m
[30;1m377 | [0m[35m                    ),[0m
[30;1m378 | [0m[35m                ]:[0m
[30;1m379 | [0m[35m                    for diff_key in diffs:[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m372 | [0m[35m                    ([0m
[30;1m373 | [0m[35m                        attribute_diffs,[0m
[30;1m374 | [0m[35m                        f"{i} attributes",[0m
[30;1m375 | [0m[35m                        s_exp["span_events"][i].get("attributes") or {},[0m
[30;1m376 | [0m[35m                        s_rec["span_events"][i].get("attributes") or {},[0m
[30;1m377 | [0m[35m                    ),[0m
[30;1m378 | [0m[35m                ]:[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m349 | [0m[35m                        attribute_diffs,[0m
[30;1m350 | [0m[35m                        f"{i} attributes",[0m
[30;1m351 | [0m[35m                        s_exp["span_links"][i].get("attributes") or {},[0m
[30;1m352 | [0m[35m                        s_rec["span_links"][i].get("attributes") or {},[0m
[30;1m353 | [0m[35m                    ),[0m
[30;1m354 | [0m[35m                ]:[0m
[30;1m355 | [0m[35m                    for diff_key in diffs:[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m348 | [0m[35m                    ([0m
[30;1m349 | [0m[35m                        attribute_diffs,[0m
[30;1m350 | [0m[35m                        f"{i} attributes",[0m
[30;1m351 | [0m[35m                        s_exp["span_links"][i].get("attributes") or {},[0m
[30;1m352 | [0m[35m                        s_rec["span_links"][i].get("attributes") or {},[0m
[30;1m353 | [0m[35m                    ),[0m
[30;1m354 | [0m[35m                ]:[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m272 | [0m[35m                (l1_no_tags, l2_no_tags, set(i[12:] for i in ignored if i.startswith("span_events.")[0m
[30;1m273 | [0m[35m                ([0m
[30;1m274 | [0m[35m                    e1.get("attributes") or {},[0m
[30;1m275 | [0m[35m                    e2.get("attributes") or {},[0m
[30;1m276 | [0m[35m                    set(i[23:] for i in ignored if i.startswith("span_events.attributes.")),[0m
[30;1m277 | [0m[35m                ),[0m
[30;1m278 | [0m[35m            ]:[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m271 | [0m[35m            for d1, d2, ign in [[0m
[30;1m272 | [0m[35m                (l1_no_tags, l2_no_tags, set(i[12:] for i in ignored if i.startswith("span_events.")[0m
[30;1m273 | [0m[35m                ([0m
[30;1m274 | [0m[35m                    e1.get("attributes") or {},[0m
[30;1m275 | [0m[35m                    e2.get("attributes") or {},[0m
[30;1m276 | [0m[35m                    set(i[23:] for i in ignored if i.startswith("span_events.attributes.")),[0m
[30;1m277 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m258 | [0m[35m    if len(s1.get("span_events") or []) != len(s2.get("span_events") or []):[0m
[30;1m259 | [0m[35m        results[0].append("span_events")[0m
[30;1m260 | [0m[35m    else:[0m
[30;1m261 | [0m[35m        for e1, e2 in zip(s1.get("span_events") or [], s2.get("span_events") or []):[0m
[30;1m262 | [0m[35m            l1_no_tags = cast([0m
[30;1m263 | [0m[35m                Dict[str, TopLevelSpanValue],[0m
[30;1m264 | [0m[35m                {k: v for k, v in e1.items() if k != "attributes"},[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m258 | [0m[35m    if len(s1.get("span_events") or []) != len(s2.get("span_events") or []):[0m
[30;1m259 | [0m[35m        results[0].append("span_events")[0m
[30;1m260 | [0m[35m    else:[0m
[30;1m261 | [0m[35m        for e1, e2 in zip(s1.get("span_events") or [], s2.get("span_events") or []):[0m
[30;1m262 | [0m[35m            l1_no_tags = cast([0m
[30;1m263 | [0m[35m                Dict[str, TopLevelSpanValue],[0m
[30;1m264 | [0m[35m                {k: v for k, v in e1.items() if k != "attributes"},[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m255 | [0m[35m    results.append(link_diffs)  # type: ignore[0m
[30;1m256 | [0m[35m[0m
[30;1m257 | [0m[35m    event_diffs = [][0m
[30;1m258 | [0m[35m    if len(s1.get("span_events") or []) != len(s2.get("span_events") or []):[0m
[30;1m259 | [0m[35m        results[0].append("span_events")[0m
[30;1m260 | [0m[35m    else:[0m
[30;1m261 | [0m[35m        for e1, e2 in zip(s1.get("span_events") or [], s2.get("span_events") or []):[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m255 | [0m[35m    results.append(link_diffs)  # type: ignore[0m
[30;1m256 | [0m[35m[0m
[30;1m257 | [0m[35m    event_diffs = [][0m
[30;1m258 | [0m[35m    if len(s1.get("span_events") or []) != len(s2.get("span_events") or []):[0m
[30;1m259 | [0m[35m        results[0].append("span_events")[0m
[30;1m260 | [0m[35m    else:[0m
[30;1m261 | [0m[35m        for e1, e2 in zip(s1.get("span_events") or [], s2.get("span_events") or []):[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m239 | [0m[35m                (l1_no_tags, l2_no_tags, set(i[11:] for i in ignored if i.startswith("span_links."))[0m
[30;1m240 | [0m[35m                ([0m
[30;1m241 | [0m[35m                    l1.get("attributes") or {},[0m
[30;1m242 | [0m[35m                    l2.get("attributes") or {},[0m
[30;1m243 | [0m[35m                    set(i[22:] for i in ignored if i.startswith("span_links.attributes.")),[0m
[30;1m244 | [0m[35m                ),[0m
[30;1m245 | [0m[35m            ]:[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m238 | [0m[35m            for d1, d2, ign in [[0m
[30;1m239 | [0m[35m                (l1_no_tags, l2_no_tags, set(i[11:] for i in ignored if i.startswith("span_links."))[0m
[30;1m240 | [0m[35m                ([0m
[30;1m241 | [0m[35m                    l1.get("attributes") or {},[0m
[30;1m242 | [0m[35m                    l2.get("attributes") or {},[0m
[30;1m243 | [0m[35m                    set(i[22:] for i in ignored if i.startswith("span_links.attributes.")),[0m
[30;1m244 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m225 | [0m[35m    if len(s1.get("span_links") or []) != len(s2.get("span_links") or []):[0m
[30;1m226 | [0m[35m        results[0].append("span_links")[0m
[30;1m227 | [0m[35m    else:[0m
[30;1m228 | [0m[35m        for l1, l2 in zip(s1.get("span_links") or [], s2.get("span_links") or []):[0m
[30;1m229 | [0m[35m            l1_no_tags = cast([0m
[30;1m230 | [0m[35m                Dict[str, TopLevelSpanValue],[0m
[30;1m231 | [0m[35m                {k: v for k, v in l1.items() if k != "attributes"},[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m225 | [0m[35m    if len(s1.get("span_links") or []) != len(s2.get("span_links") or []):[0m
[30;1m226 | [0m[35m        results[0].append("span_links")[0m
[30;1m227 | [0m[35m    else:[0m
[30;1m228 | [0m[35m        for l1, l2 in zip(s1.get("span_links") or [], s2.get("span_links") or []):[0m
[30;1m229 | [0m[35m            l1_no_tags = cast([0m
[30;1m230 | [0m[35m                Dict[str, TopLevelSpanValue],[0m
[30;1m231 | [0m[35m                {k: v for k, v in l1.items() if k != "attributes"},[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m222 | [0m[35m        results.append(diffs)[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m    link_diffs = [][0m
[30;1m225 | [0m[35m    if len(s1.get("span_links") or []) != len(s2.get("span_links") or []):[0m
[30;1m226 | [0m[35m        results[0].append("span_links")[0m
[30;1m227 | [0m[35m    else:[0m
[30;1m228 | [0m[35m        for l1, l2 in zip(s1.get("span_links") or [], s2.get("span_links") or []):[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m222 | [0m[35m        results.append(diffs)[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m    link_diffs = [][0m
[30;1m225 | [0m[35m    if len(s1.get("span_links") or []) != len(s2.get("span_links") or []):[0m
[30;1m226 | [0m[35m        results[0].append("span_links")[0m
[30;1m227 | [0m[35m    else:[0m
[30;1m228 | [0m[35m        for l1, l2 in zip(s1.get("span_links") or [], s2.get("span_links") or []):[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m103 | [0m[35m            if parent_id:[0m
[30;1m104 | [0m[35m                # If parent_id is not in the map, assume this is a trace chunk with[0m
[30;1m105 | [0m[35m                # a parent not in the trace chunk. Eg: distributed traces.[0m
[30;1m106 | [0m[35m                span["parent_id"] = span_id_map.get(parent_id, parent_id)[0m
[30;1m107 | [0m[35m            else:[0m
[30;1m108 | [0m[35m                # Normalize the parent of root spans to be 0.[0m
[30;1m109 | [0m[35m                span["parent_id"] = 0[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m            span["trace_id"] = trace_id[0m
[30;1m100 | [0m[35m            span_id_map[span["span_id"]] = span_id[0m
[30;1m101 | [0m[35m            span["span_id"] = span_id[0m
[30;1m102 | [0m[35m            parent_id = span.get("parent_id")[0m
[30;1m103 | [0m[35m            if parent_id:[0m
[30;1m104 | [0m[35m                # If parent_id is not in the map, assume this is a trace chunk with[0m
[30;1m105 | [0m[35m                # a parent not in the trace chunk. Eg: distributed traces.[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m            score -= 1[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    s1_metrics = s1.get("metrics", {})[0m
[30;1m71 | [0m[35m    s2_metrics = s2.get("metrics", {})[0m
[30;1m72 | [0m[35m    for key in set(s1_metrics.keys()) | set(s2_metrics.keys()):[0m
[30;1m73 | [0m[35m        if not _key_match(s1_metrics, s2_metrics, key):[0m
[30;1m74 | [0m[35m            score -= 1[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m        if not _key_match(s1_meta, s2_meta, key):[0m
[30;1m68 | [0m[35m            score -= 1[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    s1_metrics = s1.get("metrics", {})[0m
[30;1m71 | [0m[35m    s2_metrics = s2.get("metrics", {})[0m
[30;1m72 | [0m[35m    for key in set(s1_metrics.keys()) | set(s2_metrics.keys()):[0m
[30;1m73 | [0m[35m        if not _key_match(s1_metrics, s2_metrics, key):[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m            score -= 1[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    s1_meta = s1.get("meta", {})[0m
[30;1m65 | [0m[35m    s2_meta = s2.get("meta", {})[0m
[30;1m66 | [0m[35m    for key in set(s1_meta.keys()) | set(s2_meta.keys()):[0m
[30;1m67 | [0m[35m        if not _key_match(s1_meta, s2_meta, key):[0m
[30;1m68 | [0m[35m            score -= 1[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m        if not _key_match(s1, s2, key):  # type: ignore[0m
[30;1m62 | [0m[35m            score -= 1[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    s1_meta = s1.get("meta", {})[0m
[30;1m65 | [0m[35m    s2_meta = s2.get("meta", {})[0m
[30;1m66 | [0m[35m    for key in set(s1_meta.keys()) | set(s2_meta.keys()):[0m
[30;1m67 | [0m[35m        if not _key_match(s1_meta, s2_meta, key):[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m311 | [0m[35m[0m
[30;1m312 | [0m[35m    for s_exp, s_rec in zip(expected, received):[0m
[30;1m313 | [0m[35m        with CheckTrace.add_frame([0m
[30;1m314 | [0m[35m            f"snapshot compare of span '{s_exp['name']}' at position {s_exp['span_id']} in trace"[0m
[30;1m315 | [0m[35m        ) as frame:[0m
[30;1m316 | [0m[35m            frame.add_item(f"Expected span:\n{pprint.pformat(s_exp)}")[0m
[30;1m317 | [0m[35m            frame.add_item(f"Received span:\n{pprint.pformat(s_rec)}")[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m    for trace_id, trace in enumerate(traces):[0m
[30;1m91 | [0m[35m        normed_trace = copy_trace(list(bfs_order(trace)))[0m
[30;1m92 | [0m[35m        # Have to start at 1 since 0 is reserved for indicating no parent (i.e. root span)[0m
[30;1m93 | [0m[35m        span_id = 1[0m
[30;1m94 | [0m[35m        old_trace_id = 0[0m
[30;1m95 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m434 | [0m[35m    for k in order:[0m
[30;1m435 | [0m[35m        if k in s:[0m
[30;1m436 | [0m[35m            if k in ["meta", "metrics"]:[0m
[30;1m437 | [0m[35m                # Sort the meta and metrics dictionaries alphanumerically[0m
[30;1m438 | [0m[35m                d[k] = OrderedDict(sorted(s[k].items(), key=operator.itemgetter(0)))  # type: ignore[0m
[30;1m439 | [0m[35m            else:[0m
[30;1m440 | [0m[35m                d[k] = s[k]  # type: ignore[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_snapshot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m144 | [0m[35m        for t2_trace_id, t2 in t2_map.items():[0m
[30;1m145 | [0m[35m            similarities.append((t1_trace_id, t2_trace_id, _trace_similarity(t1, t2)))[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m    # Sort the similarities by score[0m
[30;1m148 | [0m[35m    similarities = sorted(similarities, key=lambda x: x[2], reverse=True)[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m    # Go over the scores and match the traces[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m474 | [0m[35m    "source": "...",[0m
[30;1m475 | [0m[35m    "case_id": "...",[0m
[30;1m476 | [0m[35m    "email": "...",[0m
[30;1m477 | [0m[35m    "hostname": "...",[0m
[30;1m478 | [0m[35m    "flare_file": "...",[0m
[30;1m479 | [0m[35m  }[0m
[30;1m480 | [0m[35m][0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m427 | [0m[35mcurl -X GET 'http://0.0.0.0:8126/test/trace_check/summary'[0m
[30;1m428 | [0m[35m```[0m
[30;1m429 | [0m[35m[0m
[30;1m430 | [0m[35m### /test/session/integrations (PUT)[0m
[30;1m431 | [0m[35mUpdate information about the current tested integration.[0m
[30;1m432 | [0m[35m[0m
[30;1m433 | [0m[35m#### [optional] `?test_session_token=`[0m
[30;1m434 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m214 | [0m[35mtem.process_id,meta.runtime-id"`]: The[0m
[30;1m215 | [0m[35m  attributes to ignore when comparing spans in snapshots.[0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35m- `DD_AGENT_URL` [`""`]: URL to a Datadog agent. When provided requests will be proxied to the agent[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m- `DD_APM_RECEIVER_SOCKET` [`""`]: When provided, the test agent will listen for traces on a socket [0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m- `DD_SUPPRESS_TRACE_PARSE_ERRORS` [`false`]: Set to `"true"` to disable span parse errors when deco[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m`ddapm-test-agent-fmt` is a command line tool to format or lint snapshot json files.[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m``` bash[0m
[30;1m187 | [0m[35m# Format all snapshot json files[0m
[30;1m188 | [0m[35mddapm-test-agent-fmt path/to/snapshots[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m# Lint snapshot json files[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m132 | [0m[35mThis is enabled by passing the agent url to the test agent either via the `--agent-url` command-line[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35mWhen proxying is enabled, the response from the Datadog agent will be returned instead of one from t[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35mAt the trace-level, proxying can also be disabled by including the `X-Datadog-Agent-Proxy-Disabled` [0m
[30;1m137 | [0m[35mis handled, regardless of whether an agent URL is set.[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m564 | [0m[35m[0m
[30;1m565 | [0m[35m1. Checkout the `master` branch and make sure it's up to date.[0m
[30;1m566 | [0m[35m```bash[0m
[30;1m567 | [0m[35m    git checkout master && git pull[0m
[30;1m568 | [0m[35m```[0m
[30;1m569 | [0m[35m2. Generate the release notes and use [`pandoc`](https://pandoc.org/) to format[0m
[30;1m570 | [0m[35mthem for Github:[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m564 | [0m[35m[0m
[30;1m565 | [0m[35m1. Checkout the `master` branch and make sure it's up to date.[0m
[30;1m566 | [0m[35m```bash[0m
[30;1m567 | [0m[35m    git checkout master && git pull[0m
[30;1m568 | [0m[35m```[0m
[30;1m569 | [0m[35m2. Generate the release notes and use [`pandoc`](https://pandoc.org/) to format[0m
[30;1m570 | [0m[35mthem for Github:[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m541 | [0m[35m[0m
[30;1m542 | [0m[35mRun the tagged image:[0m
[30;1m543 | [0m[35m[0m
[30;1m544 | [0m[35m```bash[0m
[30;1m545 | [0m[35mdocker run --rm -v ${PWD}/snaps:/snapshots --publish 8126:8126 agent[0m
[30;1m546 | [0m[35m```[0m
[30;1m547 | [0m[35m[0m
[30;1m548 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m535 | [0m[35m[0m
[30;1m536 | [0m[35mTo build (and tag) the dockerfile:[0m
[30;1m537 | [0m[35m[0m
[30;1m538 | [0m[35m```bash[0m
[30;1m539 | [0m[35mdocker build --tag testagent .[0m
[30;1m540 | [0m[35m```[0m
[30;1m541 | [0m[35m[0m
[30;1m542 | [0m[35mRun the tagged image:[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m531 | [0m[35m    riot run -s fmt[0m
[30;1m532 | [0m[35m    riot run -s mypy[0m
[30;1m533 | [0m[35m[0m
[30;1m534 | [0m[35m### Docker[0m
[30;1m535 | [0m[35m[0m
[30;1m536 | [0m[35mTo build (and tag) the dockerfile:[0m
[30;1m537 | [0m[35m[0m
[30;1m538 | [0m[35m```bash[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m528 | [0m[35mTo lint, format and type-check the code:[0m
[30;1m529 | [0m[35m[0m
[30;1m530 | [0m[35m    riot run -s flake8[0m
[30;1m531 | [0m[35m    riot run -s fmt[0m
[30;1m532 | [0m[35m    riot run -s mypy[0m
[30;1m533 | [0m[35m[0m
[30;1m534 | [0m[35m### Docker[0m
[30;1m535 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m509 | [0m[35m[0m
[30;1m510 | [0m[35m    python3.12 -m venv .venv[0m
[30;1m511 | [0m[35m    source .venv/bin/activate[0m
[30;1m512 | [0m[35m    pip install -e '.[testing]'[0m
[30;1m513 | [0m[35m[0m
[30;1m514 | [0m[35m[0m
[30;1m515 | [0m[35m### Running the tests[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m496 | [0m[35mSupported keys:[0m
[30;1m497 | [0m[35m - `trace_request_delay`: sets a delay to apply to trace and telemetry requests[0m
[30;1m498 | [0m[35m[0m
[30;1m499 | [0m[35m ```[0m
[30;1m500 | [0m[35mcurl -X POST 'http://0.0.0.0:8126/test/settings' -d '{ "trace_request_delay": 5 }'[0m
[30;1m501 | [0m[35m```[0m
[30;1m502 | [0m[35m[0m
[30;1m503 | [0m[35m## Development[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m480 | [0m[35m][0m
[30;1m481 | [0m[35m```[0m
[30;1m482 | [0m[35m[0m
[30;1m483 | [0m[35m`flare_file` is the base64 encoded content of the tracer-flare payload.[0m
[30;1m484 | [0m[35m[0m
[30;1m485 | [0m[35mIf there was an error parsing the tracer-flare form, that will be recorded under `error`.[0m
[30;1m486 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m445 | [0m[35m#### [optional] `?test_session_token=`[0m
[30;1m446 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m
[30;1m447 | [0m[35m[0m
[30;1m448 | [0m[35m```[0m
[30;1m449 | [0m[35mcurl -X GET 'http://0.0.0.0:8126/test/integrations/tested_versions'[0m
[30;1m450 | [0m[35m```[0m
[30;1m451 | [0m[35m[0m
[30;1m452 | [0m[35m### /v0.1/pipeline_stats[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m433 | [0m[35m#### [optional] `?test_session_token=`[0m
[30;1m434 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m
[30;1m435 | [0m[35m[0m
[30;1m436 | [0m[35m```[0m
[30;1m437 | [0m[35mcurl -X PUT 'http://0.0.0.0:8126/test/session/integrations' -d '{"integration_name": [INTEGRATION_NA[0m
[30;1m438 | [0m[35m"dependency_name": [DEPENDENCY_NAME], "tracer_language": [TRACER_LANGUAGE], "tracer_version": [TRACE[0m
[30;1m439 | [0m[35m```[0m
[30;1m440 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m423 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m
[30;1m424 | [0m[35m#### [optional] `?return_all=`[0m
[30;1m425 | [0m[35m[0m
[30;1m426 | [0m[35m```[0m
[30;1m427 | [0m[35mcurl -X GET 'http://0.0.0.0:8126/test/trace_check/summary'[0m
[30;1m428 | [0m[35m```[0m
[30;1m429 | [0m[35m[0m
[30;1m430 | [0m[35m### /test/session/integrations (PUT)[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m403 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m
[30;1m404 | [0m[35m#### [optional] `?clear_all=`[0m
[30;1m405 | [0m[35m[0m
[30;1m406 | [0m[35m```[0m
[30;1m407 | [0m[35mcurl -X GET 'http://0.0.0.0:8126/test/trace_check/clear'[0m
[30;1m408 | [0m[35m```[0m
[30;1m409 | [0m[35m[0m
[30;1m410 | [0m[35m### /test/trace_check/summary (GET)[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m392 | [0m[35m#### [optional] `?use_json=`[0m
[30;1m393 | [0m[35m#### [optional] `?return_all=`[0m
[30;1m394 | [0m[35m[0m
[30;1m395 | [0m[35m```[0m
[30;1m396 | [0m[35mcurl -X GET 'http://0.0.0.0:8126/test/trace_check/failures'[0m
[30;1m397 | [0m[35m```[0m
[30;1m398 | [0m[35m[0m
[30;1m399 | [0m[35m### /test/trace_check/clear (GET)[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m372 | [0m[35m#### [optional] `?test_session_token=`[0m
[30;1m373 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m
[30;1m374 | [0m[35m[0m
[30;1m375 | [0m[35m```[0m
[30;1m376 | [0m[35mcurl -X POST 'http://0.0.0.0:8126/test/session/responses/config/path' -d '{"path": "datadog/2/ASM_DA[0m
[30;1m377 | [0m[35m```[0m
[30;1m378 | [0m[35m[0m
[30;1m379 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m359 | [0m[35m#### [optional] `?test_session_token=`[0m
[30;1m360 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m
[30;1m361 | [0m[35m[0m
[30;1m362 | [0m[35m```[0m
[30;1m363 | [0m[35mcurl -X POST 'http://0.0.0.0:8126/test/session/responses/config/path' -d '{"roots": ["eyJ....fX0="],[0m
[30;1m364 | [0m[35m```[0m
[30;1m365 | [0m[35m[0m
[30;1m366 | [0m[35m### /test/session/responses/config/path (POST)[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m334 | [0m[35m][0m
[30;1m335 | [0m[35m```[0m
[30;1m336 | [0m[35m[0m
[30;1m337 | [0m[35m`body` is a base64 encoded body of the request.[0m
[30;1m338 | [0m[35m[0m
[30;1m339 | [0m[35m### /test/session/traces[0m
[30;1m340 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m- `DD_POOL_TRACE_CHECK_FAILURES` [`false`]: Set to `"true"` to pool Trace Check failures that occure[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m- `DD_DISABLE_ERROR_RESPONSES` [`false`]: Set to `"true"` to disable Test-Agent `<Response 400>` whe[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m## HTTP API[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m`ddapm-test-agent-fmt` is a command line tool to format or lint snapshot json files.[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m``` bash[0m
[30;1m187 | [0m[35m# Format all snapshot json files[0m
[30;1m188 | [0m[35mddapm-test-agent-fmt path/to/snapshots[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m# Lint snapshot json files[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35mor a specific branch:[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    pip install git+https://github.com/Datadog/dd-apm-test-agent@{branch}[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m## Features[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35mor from source:[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    pip install git+https://github.com/Datadog/dd-apm-test-agent[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35mor a specific branch:[0m
[30;1m85 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35mor from Docker:[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    # Run the test agent and mount the snapshot directory[0m
[30;1m74 | [0m[35m    docker run --rm\[0m
[30;1m75 | [0m[35m            -p 8126:8126\[0m
[30;1m76 | [0m[35m            -e SNAPSHOT_CI=0\[0m
[30;1m77 | [0m[35m            -v $PWD/tests/snapshots:/snapshots\[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35mor from Docker:[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    # Run the test agent and mount the snapshot directory[0m
[30;1m74 | [0m[35m    docker run --rm\[0m
[30;1m75 | [0m[35m            -p 8126:8126\[0m
[30;1m76 | [0m[35m            -e SNAPSHOT_CI=0\[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35mThe test agent can be installed from PyPI:[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m    pip install ddapm-test-agent[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    ddapm-test-agent --port=8126[0m
[30;1m70 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/trace_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m124 | [0m[35m    # TODO:[0m
[30;1m125 | [0m[35m    #   represent arbitrary random services (subtrees in spans)[0m
[30;1m126 | [0m[35m    #   resource names (should only be on service entry)[0m
[30;1m127 | [0m[35m    #   smarter type (should only be on service entry)[0m
[30;1m128 | [0m[35m    #   sampling decisions[0m
[30;1m129 | [0m[35m    #   dd_origin?[0m
[30;1m130 | [0m[35m    assert nspans > 0[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/trace_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m123 | [0m[35m) -> Trace:[0m
[30;1m124 | [0m[35m    # TODO:[0m
[30;1m125 | [0m[35m    #   represent arbitrary random services (subtrees in spans)[0m
[30;1m126 | [0m[35m    #   resource names (should only be on service entry)[0m
[30;1m127 | [0m[35m    #   smarter type (should only be on service entry)[0m
[30;1m128 | [0m[35m    #   sampling decisions[0m
[30;1m129 | [0m[35m    #   dd_origin?[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m200 | [0m[35m):[0m
[30;1m201 | [0m[35m    """Requests sent without a session token are associated with the session that proceeds it"""[0m
[30;1m202 | [0m[35m    await do_reference_v04_http_trace(token="nosessionstart")[0m
[30;1m203 | [0m[35m    resp = await agent.get("/test/session/traces", params={"test_session_token": "nosessionstart"})[0m
[30;1m204 | [0m[35m    assert resp.status == 200[0m
[30;1m205 | [0m[35m    assert await resp.json() == v04_reference_http_trace_payload_data_raw[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35m    v04_reference_http_trace_payload_data_raw[0][0]["trace_id"] = 2[0m
[30;1m187 | [0m[35m    v04_modified_payload_bytes = cast(bytes, msgpack.packb(v04_reference_http_trace_payload_data_raw[0m
[30;1m188 | [0m[35m    await do_reference_v04_http_trace(payload_override=v04_modified_payload_bytes)[0m
[30;1m189 | [0m[35m    second_resp_a = await agent.get("/test/session/traces", params={"test_session_token": "sessiona"[0m
[30;1m190 | [0m[35m    assert second_resp_a.status == 200[0m
[30;1m191 | [0m[35m    new_a_results = await second_resp_a.json()[0m
[30;1m192 | [0m[35m    assert len(new_a_results) == 1[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m    assert len(resp_b_results) == 1[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m    # Recreate session A, generate a "new" trace, and show that the trace for A is new[0m
[30;1m184 | [0m[35m    resp = await agent.get("/test/session/start", params={"test_session_token": "sessiona"})[0m
[30;1m185 | [0m[35m    assert resp.status == 200[0m
[30;1m186 | [0m[35m    v04_reference_http_trace_payload_data_raw[0][0]["trace_id"] = 2[0m
[30;1m187 | [0m[35m    v04_modified_payload_bytes = cast(bytes, msgpack.packb(v04_reference_http_trace_payload_data_raw[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m174 | [0m[35m    resp_a = await agent.get("/test/session/traces", params={"test_session_token": "sessiona"})[0m
[30;1m175 | [0m[35m    resp_a_results = await resp_a.json()[0m
[30;1m176 | [0m[35m    assert resp_a.status == 200[0m
[30;1m177 | [0m[35m    resp_b = await agent.get("/test/session/traces", params={"test_session_token": "sessionb"})[0m
[30;1m178 | [0m[35m    resp_b_results = await resp_b.json()[0m
[30;1m179 | [0m[35m    assert resp_b.status == 200[0m
[30;1m180 | [0m[35m    assert len(resp_a_results) == 1[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m    #  Create a new trace (no token) and assert that sessions A and B now have a trace[0m
[30;1m173 | [0m[35m    await do_reference_v04_http_trace()[0m
[30;1m174 | [0m[35m    resp_a = await agent.get("/test/session/traces", params={"test_session_token": "sessiona"})[0m
[30;1m175 | [0m[35m    resp_a_results = await resp_a.json()[0m
[30;1m176 | [0m[35m    assert resp_a.status == 200[0m
[30;1m177 | [0m[35m    resp_b = await agent.get("/test/session/traces", params={"test_session_token": "sessionb"})[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m    assert resp_a.status == 200[0m
[30;1m164 | [0m[35m    a_results = await resp_a.json()[0m
[30;1m165 | [0m[35m    first_a_trace_id = a_results[0][0]["trace_id"][0m
[30;1m166 | [0m[35m    resp_b = await agent.get("/test/session/traces", params={"test_session_token": "sessionb"})[0m
[30;1m167 | [0m[35m    assert resp_b.status == 200[0m
[30;1m168 | [0m[35m    b_results = await resp_b.json()[0m
[30;1m169 | [0m[35m    assert len(a_results) == 1[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m159 | [0m[35m    await do_reference_v04_http_trace()[0m
[30;1m160 | [0m[35m    resp = await agent.get("/test/session/start", params={"test_session_token": "sessionb"})[0m
[30;1m161 | [0m[35m    assert resp.status == 200[0m
[30;1m162 | [0m[35m    resp_a = await agent.get("/test/session/traces", params={"test_session_token": "sessiona"})[0m
[30;1m163 | [0m[35m    assert resp_a.status == 200[0m
[30;1m164 | [0m[35m    a_results = await resp_a.json()[0m
[30;1m165 | [0m[35m    first_a_trace_id = a_results[0][0]["trace_id"][0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m157 | [0m[35m    resp = await agent.get("/test/session/start", params={"test_session_token": "sessiona"})[0m
[30;1m158 | [0m[35m    assert resp.status == 200[0m
[30;1m159 | [0m[35m    await do_reference_v04_http_trace()[0m
[30;1m160 | [0m[35m    resp = await agent.get("/test/session/start", params={"test_session_token": "sessionb"})[0m
[30;1m161 | [0m[35m    assert resp.status == 200[0m
[30;1m162 | [0m[35m    resp_a = await agent.get("/test/session/traces", params={"test_session_token": "sessiona"})[0m
[30;1m163 | [0m[35m    assert resp_a.status == 200[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m):[0m
[30;1m155 | [0m[35m    """Requests sent without a session token are associated with the session that proceeds it"""[0m
[30;1m156 | [0m[35m    # Create session A, trace (no token), then create session B => assert the trace belong to A and [0m
[30;1m157 | [0m[35m    resp = await agent.get("/test/session/start", params={"test_session_token": "sessiona"})[0m
[30;1m158 | [0m[35m    assert resp.status == 200[0m
[30;1m159 | [0m[35m    await do_reference_v04_http_trace()[0m
[30;1m160 | [0m[35m    resp = await agent.get("/test/session/start", params={"test_session_token": "sessionb"})[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m    """When a session exists but has no traces, we should get an OK with an empty list returned"""[0m
[30;1m145 | [0m[35m    resp = await agent.get("/test/session/start", params={"test_session_token": "emptysession"})[0m
[30;1m146 | [0m[35m    assert resp.status == 200[0m
[30;1m147 | [0m[35m    resp = await agent.get("/test/session/traces", params={"test_session_token": "emptysession"})[0m
[30;1m148 | [0m[35m    assert resp.status == 200[0m
[30;1m149 | [0m[35m    assert await resp.json() == [][0m
[30;1m150 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35masync def test_empty_session_ok(agent):[0m
[30;1m144 | [0m[35m    """When a session exists but has no traces, we should get an OK with an empty list returned"""[0m
[30;1m145 | [0m[35m    resp = await agent.get("/test/session/start", params={"test_session_token": "emptysession"})[0m
[30;1m146 | [0m[35m    assert resp.status == 200[0m
[30;1m147 | [0m[35m    resp = await agent.get("/test/session/traces", params={"test_session_token": "emptysession"})[0m
[30;1m148 | [0m[35m    assert resp.status == 200[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35masync def test_404_when_session_doesnt_exist(agent):[0m
[30;1m138 | [0m[35m    """When a session that doesn't exist is requested, we should get an error."""[0m
[30;1m139 | [0m[35m    resp = await agent.get("/test/session/traces", params={"test_session_token": "nonexistent"})[0m
[30;1m140 | [0m[35m    assert resp.status == 404[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m    resp = await do_reference_v2_http_apmtelemetry(token="test_case")[0m
[30;1m118 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    resp = await agent.get("/test/session/requests", params={"test_session_token": "test_case"})[0m
[30;1m121 | [0m[35m    requests = await resp.json()[0m
[30;1m122 | [0m[35m    assert resp.status == 200[0m
[30;1m123 | [0m[35m    assert len(requests) == 4[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m    do_reference_v06_http_stats,[0m
[30;1m107 | [0m[35m    do_reference_v2_http_apmtelemetry,[0m
[30;1m108 | [0m[35m):[0m
[30;1m109 | [0m[35m    resp = await agent.get("/test/session/start", params={"test_session_token": "test_case"})[0m
[30;1m110 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m111 | [0m[35m    resp = await do_reference_v04_http_trace(token="test_case")[0m
[30;1m112 | [0m[35m    assert resp.status == 200, await resp.text()[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m95 | [0m[35m    resp = await do_reference_v04_http_trace(token="test_case")[0m
[30;1m96 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    resp = await agent.get("/test/session/traces", params={"test_session_token": "test_case"})[0m
[30;1m99 | [0m[35m    assert resp.status == 200[0m
[30;1m100 | [0m[35m    assert await resp.json() == v04_reference_http_trace_payload_data_raw[0m
[30;1m101 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35m    resp = await do_reference_v04_http_trace(token="test_case")[0m
[30;1m90 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    resp = await agent.get("/test/session/start", params={"test_session_token": "test_case"})[0m
[30;1m93 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m    resp = await do_reference_v04_http_trace(token="test_case")[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m    When sessions are run again[0m
[30;1m84 | [0m[35m        Only the traces for the latest session should be returned.[0m
[30;1m85 | [0m[35m    """[0m
[30;1m86 | [0m[35m    resp = await agent.get("/test/session/start", params={"test_session_token": "test_case"})[0m
[30;1m87 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m    resp = await do_reference_v04_http_trace(token="test_case")[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m    resp = await agent.get("/test/session/clear")[0m
[30;1m71 | [0m[35m    assert resp.status == 200[0m
[30;1m72 | [0m[35m    for token in ["test_case", "test_case2"]:[0m
[30;1m73 | [0m[35m        resp = await agent.get("/test/session/traces", params={"test_session_token": token})[0m
[30;1m74 | [0m[35m        assert resp.status == 404[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m    assert resp.status == 200[0m
[30;1m68 | [0m[35m    assert await resp.json() == [][0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    resp = await agent.get("/test/session/clear")[0m
[30;1m71 | [0m[35m    assert resp.status == 200[0m
[30;1m72 | [0m[35m    for token in ["test_case", "test_case2"]:[0m
[30;1m73 | [0m[35m        resp = await agent.get("/test/session/traces", params={"test_session_token": token})[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m        result = await resp.json()[0m
[30;1m64 | [0m[35m        assert result == v04_reference_http_trace_payload_data_raw, result[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    resp = await agent.get("/test/session/traces")[0m
[30;1m67 | [0m[35m    assert resp.status == 200[0m
[30;1m68 | [0m[35m    assert await resp.json() == [][0m
[30;1m69 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    for token in ["test_case", "test_case2"]:[0m
[30;1m61 | [0m[35m        resp = await agent.get("/test/session/traces", params={"test_session_token": token})[0m
[30;1m62 | [0m[35m        assert resp.status == 200[0m
[30;1m63 | [0m[35m        result = await resp.json()[0m
[30;1m64 | [0m[35m        assert result == v04_reference_http_trace_payload_data_raw, result[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m):[0m
[30;1m49 | [0m[35m    resp = await agent.get("/test/session/start", params={"test_session_token": "test_case"})[0m
[30;1m50 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m51 | [0m[35m    resp = await agent.get("/test/session/start", params={"test_session_token": "test_case2"})[0m
[30;1m52 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m    resp = await do_reference_v04_http_trace(token="test_case")[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m    v04_reference_http_trace_payload_data_raw,[0m
[30;1m47 | [0m[35m    do_reference_v04_http_trace,[0m
[30;1m48 | [0m[35m):[0m
[30;1m49 | [0m[35m    resp = await agent.get("/test/session/start", params={"test_session_token": "test_case"})[0m
[30;1m50 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m51 | [0m[35m    resp = await agent.get("/test/session/start", params={"test_session_token": "test_case2"})[0m
[30;1m52 | [0m[35m    assert resp.status == 200, await resp.text()[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m    # Clear the traces and make sure there aren't any still stored[0m
[30;1m37 | [0m[35m    resp = await agent.get("/test/session/clear", params=params, headers=headers)[0m
[30;1m38 | [0m[35m    assert resp.status == 200[0m
[30;1m39 | [0m[35m    resp = await agent.get("/test/session/traces", params=params, headers=headers)[0m
[30;1m40 | [0m[35m    assert resp.status == 200[0m
[30;1m41 | [0m[35m    assert await resp.json() == [][0m
[30;1m42 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m    assert await resp.json() == v04_reference_http_trace_payload_data_raw[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    # Clear the traces and make sure there aren't any still stored[0m
[30;1m37 | [0m[35m    resp = await agent.get("/test/session/clear", params=params, headers=headers)[0m
[30;1m38 | [0m[35m    assert resp.status == 200[0m
[30;1m39 | [0m[35m    resp = await agent.get("/test/session/traces", params=params, headers=headers)[0m
[30;1m40 | [0m[35m    assert resp.status == 200[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m    resp = await do_reference_v04_http_trace(token=trace_token)[0m
[30;1m30 | [0m[35m    assert resp.status == 200[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    resp = await agent.get("/test/session/traces", params=params, headers=headers)[0m
[30;1m33 | [0m[35m    assert resp.status == 200[0m
[30;1m34 | [0m[35m    assert await resp.json() == v04_reference_http_trace_payload_data_raw[0m
[30;1m35 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m    v04_reference_http_trace_payload_data_raw,[0m
[30;1m24 | [0m[35m    do_reference_v04_http_trace,[0m
[30;1m25 | [0m[35m):[0m
[30;1m26 | [0m[35m    resp = await agent.get("/test/session/start", params=params, headers=headers)[0m
[30;1m27 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    resp = await do_reference_v04_http_trace(token=trace_token)[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_session.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mfrom typing import cast[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport msgpack[0m
[30;1m5 | [0m[35mimport pytest[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/Dockerfile[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m19 | [0m[35m# Cleanup[0m
[30;1m20 | [0m[35mRUN apt remove -y git[0m
[30;1m21 | [0m[35mRUN rm -rf /var/lib/apt/lists/* /root/.cache/pip /tmp/* /var/tmp/* /src[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mCMD ["ddapm-test-agent"][0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/Dockerfile[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m6 | [0m[35mENV LOG_LEVEL=INFO[0m
[30;1m7 | [0m[35mENV SNAPSHOT_DIR=/snapshots[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mRUN apt update && apt install -y git curl[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mRUN mkdir -p /src[0m
[30;1m12 | [0m[35mWORKDIR /src[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35mRUN pip install /src[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m# Cleanup[0m
[30;1m20 | [0m[35mRUN apt remove -y git[0m
[30;1m21 | [0m[35mRUN rm -rf /var/lib/apt/lists/* /root/.cache/pip /tmp/* /var/tmp/* /src[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mCMD ["ddapm-test-agent"][0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35mRUN pip install /src[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m# Cleanup[0m
[30;1m20 | [0m[35mRUN apt remove -y git[0m
[30;1m21 | [0m[35mRUN rm -rf /var/lib/apt/lists/* /root/.cache/pip /tmp/* /var/tmp/* /src[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mCMD ["ddapm-test-agent"][0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35mADD README.md setup.py test_deps.txt ./[0m
[30;1m15 | [0m[35mADD ddapm_test_agent ./ddapm_test_agent[0m
[30;1m16 | [0m[35mADD .git ./.git[0m
[30;1m17 | [0m[35mRUN pip install /src[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m# Cleanup[0m
[30;1m20 | [0m[35mRUN apt remove -y git[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mENV LOG_LEVEL=INFO[0m
[30;1m7 | [0m[35mENV SNAPSHOT_DIR=/snapshots[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mRUN apt update && apt install -y git curl[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mRUN mkdir -p /src[0m
[30;1m12 | [0m[35mWORKDIR /src[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mENV LOG_LEVEL=INFO[0m
[30;1m7 | [0m[35mENV SNAPSHOT_DIR=/snapshots[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mRUN apt update && apt install -y git curl[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mRUN mkdir -p /src[0m
[30;1m12 | [0m[35mWORKDIR /src[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mENV LOG_LEVEL=INFO[0m
[30;1m7 | [0m[35mENV SNAPSHOT_DIR=/snapshots[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mRUN apt update && apt install -y git curl[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mRUN mkdir -p /src[0m
[30;1m12 | [0m[35mWORKDIR /src[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mEXPOSE 8126[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mENV SNAPSHOT_CI=1[0m
[30;1m6 | [0m[35mENV LOG_LEVEL=INFO[0m
[30;1m7 | [0m[35mENV SNAPSHOT_DIR=/snapshots[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mRUN apt update && apt install -y git curl[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mEXPOSE 8126[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mENV SNAPSHOT_CI=1[0m
[30;1m6 | [0m[35mENV LOG_LEVEL=INFO[0m
[30;1m7 | [0m[35mENV SNAPSHOT_DIR=/snapshots[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mRUN apt update && apt install -y git curl[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mFROM python:3.12-slim[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mEXPOSE 8126[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mENV SNAPSHOT_CI=1[0m
[30;1m8 | [0m[35mENV LOG_LEVEL=INFO[0m
[30;1m9 | [0m[35mENV SNAPSHOT_DIR=/snapshots[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/.github/workflows/releasenote.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m          python-version: '3.12'[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m      - name: Install Dependencies[0m
[30;1m34 | [0m[35m        run: pip install reno docutils[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m      - name: Lint release notes[0m
[30;1m37 | [0m[35m        run: reno lint[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/releasenotes/notes/docker-arm64-images-a4b6b2cc527327d6.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m---[0m
[30;1m2 | [0m[35mfeatures:[0m
[30;1m3 | [0m[35m  - |[0m
[30;1m4 | [0m[35m    Build an ARM64 version of the Docker image as a multi-arch image.[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/.github/workflows/publish_pypi.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m      - name: Build sdist[0m
[30;1m50 | [0m[35m        run: |[0m
[30;1m51 | [0m[35m          python -m pip install --upgrade setuptools[0m
[30;1m52 | [0m[35m          python setup.py sdist[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m      - uses: actions/upload-artifact@v4[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/.github/workflows/publish_pypi.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m      - name: Build wheels[0m
[30;1m26 | [0m[35m        run: |[0m
[30;1m27 | [0m[35m          pip install wheel[0m
[30;1m28 | [0m[35m          pip wheel --no-deps -w dist .[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m      - uses: actions/upload-artifact@v4[0m
[30;1m31 | [0m[35m        with:[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/.github/workflows/publish_pypi.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m      - name: Build wheels[0m
[30;1m26 | [0m[35m        run: |[0m
[30;1m27 | [0m[35m          pip install wheel[0m
[30;1m28 | [0m[35m          pip wheel --no-deps -w dist .[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m      - uses: actions/upload-artifact@v4[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1297 | [0m[35m    parser.add_argument([0m
[30;1m1298 | [0m[35m        "--disable-error-responses",[0m
[30;1m1299 | [0m[35m        type=bool,[0m
[30;1m1300 | [0m[35m        default=os.environ.get("DD_DISABLE_ERROR_RESPONSES", False),[0m
[30;1m1301 | [0m[35m        help=("Will change the test agent to send [200: Ok] responses instead of error responses bac[0m
[30;1m1302 | [0m[35m    )[0m
[30;1m1303 | [0m[35m    parsed_args = parser.parse_args(args=args)[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1291 | [0m[35m    parser.add_argument([0m
[30;1m1292 | [0m[35m        "--pool-trace-check-failures",[0m
[30;1m1293 | [0m[35m        type=bool,[0m
[30;1m1294 | [0m[35m        default=os.environ.get("DD_POOL_TRACE_CHECK_FAILURES", False),[0m
[30;1m1295 | [0m[35m        help=("Will change the test agent to pool Trace Check failures in memory that can later be a[0m
[30;1m1296 | [0m[35m    )[0m
[30;1m1297 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1283 | [0m[35m    parser.add_argument([0m
[30;1m1284 | [0m[35m        "--suppress-trace-parse-errors",[0m
[30;1m1285 | [0m[35m        type=bool,[0m
[30;1m1286 | [0m[35m        default=os.environ.get("DD_SUPPRESS_TRACE_PARSE_ERRORS", False),[0m
[30;1m1287 | [0m[35m        help=([0m
[30;1m1288 | [0m[35m            "Will change the test agent trace decoder to use a more resilient parser to prevent deco[0m
[30;1m1289 | [0m[35m        ),[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1277 | [0m[35m    parser.add_argument([0m
[30;1m1278 | [0m[35m        "--trace-request-delay",[0m
[30;1m1279 | [0m[35m        type=float,[0m
[30;1m1280 | [0m[35m        default=os.environ.get("DD_TEST_STALL_REQUEST_SECONDS", 0.0),[0m
[30;1m1281 | [0m[35m        help=("Will stall trace and telemetry requests for specified amount of time"),[0m
[30;1m1282 | [0m[35m    )[0m
[30;1m1283 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1271 | [0m[35m    parser.add_argument([0m
[30;1m1272 | [0m[35m        "--trace-uds-socket",[0m
[30;1m1273 | [0m[35m        type=str,[0m
[30;1m1274 | [0m[35m        default=os.environ.get("DD_APM_RECEIVER_SOCKET", None),[0m
[30;1m1275 | [0m[35m        help=("Will listen for traces on the specified socket path"),[0m
[30;1m1276 | [0m[35m    )[0m
[30;1m1277 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1265 | [0m[35m    parser.add_argument([0m
[30;1m1266 | [0m[35m        "--agent-url",[0m
[30;1m1267 | [0m[35m        type=str,[0m
[30;1m1268 | [0m[35m        default=os.environ.get("DD_TRACE_AGENT_URL", os.environ.get("DD_AGENT_URL", "")),[0m
[30;1m1269 | [0m[35m        help=("Datadog agent URL. If provided, any received data will be forwarded " "to the agent."[0m
[30;1m1270 | [0m[35m    )[0m
[30;1m1271 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1265 | [0m[35m    parser.add_argument([0m
[30;1m1266 | [0m[35m        "--agent-url",[0m
[30;1m1267 | [0m[35m        type=str,[0m
[30;1m1268 | [0m[35m        default=os.environ.get("DD_TRACE_AGENT_URL", os.environ.get("DD_AGENT_URL", "")),[0m
[30;1m1269 | [0m[35m        help=("Datadog agent URL. If provided, any received data will be forwarded " "to the agent."[0m
[30;1m1270 | [0m[35m    )[0m
[30;1m1271 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1259 | [0m[35m    parser.add_argument([0m
[30;1m1260 | [0m[35m        "--log-span-fmt",[0m
[30;1m1261 | [0m[35m        type=str,[0m
[30;1m1262 | [0m[35m        default=os.environ.get("LOG_SPAN_FMT", "[{name}]"),[0m
[30;1m1263 | [0m[35m        help=("Format to use when logging spans. Default is '[{name}]'. " "All span attributes are a[0m
[30;1m1264 | [0m[35m    )[0m
[30;1m1265 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1253 | [0m[35m    parser.add_argument([0m
[30;1m1254 | [0m[35m        "--log-level",[0m
[30;1m1255 | [0m[35m        type=str,[0m
[30;1m1256 | [0m[35m        default=os.environ.get("LOG_LEVEL", "INFO"),[0m
[30;1m1257 | [0m[35m        help="Set the log level. DEBUG, INFO, WARNING, ERROR, CRITICAL.",[0m
[30;1m1258 | [0m[35m    )[0m
[30;1m1259 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1243 | [0m[35m    parser.add_argument([0m
[30;1m1244 | [0m[35m        "--enabled-checks",[0m
[30;1m1245 | [0m[35m        type=List[str],[0m
[30;1m1246 | [0m[35m        default=_parse_csv(os.environ.get("ENABLED_CHECKS", "")),[0m
[30;1m1247 | [0m[35m        help=([0m
[30;1m1248 | [0m[35m            "Comma-separated values of checks to enable. None are enabled "[0m
[30;1m1249 | [0m[35m            " by default. For the list of values see "[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1233 | [0m[35m    parser.add_argument([0m
[30;1m1234 | [0m[35m        "--snapshot-removed-attrs",[0m
[30;1m1235 | [0m[35m        type=Set[str],[0m
[30;1m1236 | [0m[35m        default=set(_parse_csv(os.environ.get("SNAPSHOT_REMOVED_ATTRS", ""))),[0m
[30;1m1237 | [0m[35m        help=([0m
[30;1m1238 | [0m[35m            "Comma-separated values of span attributes to remove. "[0m
[30;1m1239 | [0m[35m            "meta/metrics attributes can be removed by prefixing the key "[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1223 | [0m[35m    parser.add_argument([0m
[30;1m1224 | [0m[35m        "--snapshot-ignored-attrs",[0m
[30;1m1225 | [0m[35m        type=Set[str],[0m
[30;1m1226 | [0m[35m        default=set(_parse_csv(os.environ.get("SNAPSHOT_IGNORED_ATTRS", trace_snapshot.DEFAULT_SNAPS[0m
[30;1m1227 | [0m[35m        help=([0m
[30;1m1228 | [0m[35m            "Comma-separated values of span attributes to ignore. "[0m
[30;1m1229 | [0m[35m            "meta/metrics attributes can be ignored by prefixing the key "[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1217 | [0m[35m    parser.add_argument([0m
[30;1m1218 | [0m[35m        "--snapshot-ci-mode",[0m
[30;1m1219 | [0m[35m        type=int,[0m
[30;1m1220 | [0m[35m        default=int(os.environ.get("SNAPSHOT_CI", 0)),[0m
[30;1m1221 | [0m[35m        help="Enable CI mode for snapshotting. Enforces that snapshot files exist.",[0m
[30;1m1222 | [0m[35m    )[0m
[30;1m1223 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1211 | [0m[35m    parser.add_argument([0m
[30;1m1212 | [0m[35m        "--snapshot-dir",[0m
[30;1m1213 | [0m[35m        type=str,[0m
[30;1m1214 | [0m[35m        default=os.environ.get("SNAPSHOT_DIR", "snapshots"),[0m
[30;1m1215 | [0m[35m        help="Directory to store snapshots.",[0m
[30;1m1216 | [0m[35m    )[0m
[30;1m1217 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1207 | [0m[35m        dest="version",[0m
[30;1m1208 | [0m[35m        help="Print version info and exit.",[0m
[30;1m1209 | [0m[35m    )[0m
[30;1m1210 | [0m[35m    parser.add_argument("-p", "--port", type=int, default=int(os.environ.get("PORT", 8126)))[0m
[30;1m1211 | [0m[35m    parser.add_argument([0m
[30;1m1212 | [0m[35m        "--snapshot-dir",[0m
[30;1m1213 | [0m[35m        type=str,[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1165 | [0m[35m            web.get("/test/trace_check/clear", agent.clear_trace_check_failures),[0m
[30;1m1166 | [0m[35m            web.get("/test/trace_check/summary", agent.get_trace_check_summary),[0m
[30;1m1167 | [0m[35m            web.get("/test/integrations/tested_versions", agent.handle_get_tested_integrations),[0m
[30;1m1168 | [0m[35m            web.post("/test/settings", agent.handle_settings),[0m
[30;1m1169 | [0m[35m        ][0m
[30;1m1170 | [0m[35m    )[0m
[30;1m1171 | [0m[35m    checks = Checks([0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1164 | [0m[35m            web.get("/test/trace_check/failures", agent.get_trace_check_failures),[0m
[30;1m1165 | [0m[35m            web.get("/test/trace_check/clear", agent.clear_trace_check_failures),[0m
[30;1m1166 | [0m[35m            web.get("/test/trace_check/summary", agent.get_trace_check_summary),[0m
[30;1m1167 | [0m[35m            web.get("/test/integrations/tested_versions", agent.handle_get_tested_integrations),[0m
[30;1m1168 | [0m[35m            web.post("/test/settings", agent.handle_settings),[0m
[30;1m1169 | [0m[35m        ][0m
[30;1m1170 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1163 | [0m[35m            web.get("/test/trace/analyze", agent.handle_trace_analyze),[0m
[30;1m1164 | [0m[35m            web.get("/test/trace_check/failures", agent.get_trace_check_failures),[0m
[30;1m1165 | [0m[35m            web.get("/test/trace_check/clear", agent.clear_trace_check_failures),[0m
[30;1m1166 | [0m[35m            web.get("/test/trace_check/summary", agent.get_trace_check_summary),[0m
[30;1m1167 | [0m[35m            web.get("/test/integrations/tested_versions", agent.handle_get_tested_integrations),[0m
[30;1m1168 | [0m[35m            web.post("/test/settings", agent.handle_settings),[0m
[30;1m1169 | [0m[35m        ][0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1162 | [0m[35m            # web.get("/test/benchmark", agent.handle_test_traces),[0m
[30;1m1163 | [0m[35m            web.get("/test/trace/analyze", agent.handle_trace_analyze),[0m
[30;1m1164 | [0m[35m            web.get("/test/trace_check/failures", agent.get_trace_check_failures),[0m
[30;1m1165 | [0m[35m            web.get("/test/trace_check/clear", agent.clear_trace_check_failures),[0m
[30;1m1166 | [0m[35m            web.get("/test/trace_check/summary", agent.get_trace_check_summary),[0m
[30;1m1167 | [0m[35m            web.get("/test/integrations/tested_versions", agent.handle_get_tested_integrations),[0m
[30;1m1168 | [0m[35m            web.post("/test/settings", agent.handle_settings),[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1161 | [0m[35m            web.get("/test/apmtelemetry", agent.handle_test_apmtelemetry),[0m
[30;1m1162 | [0m[35m            # web.get("/test/benchmark", agent.handle_test_traces),[0m
[30;1m1163 | [0m[35m            web.get("/test/trace/analyze", agent.handle_trace_analyze),[0m
[30;1m1164 | [0m[35m            web.get("/test/trace_check/failures", agent.get_trace_check_failures),[0m
[30;1m1165 | [0m[35m            web.get("/test/trace_check/clear", agent.clear_trace_check_failures),[0m
[30;1m1166 | [0m[35m            web.get("/test/trace_check/summary", agent.get_trace_check_summary),[0m
[30;1m1167 | [0m[35m            web.get("/test/integrations/tested_versions", agent.handle_get_tested_integrations),[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1160 | [0m[35m            web.get("/test/traces", agent.handle_test_traces),[0m
[30;1m1161 | [0m[35m            web.get("/test/apmtelemetry", agent.handle_test_apmtelemetry),[0m
[30;1m1162 | [0m[35m            # web.get("/test/benchmark", agent.handle_test_traces),[0m
[30;1m1163 | [0m[35m            web.get("/test/trace/analyze", agent.handle_trace_analyze),[0m
[30;1m1164 | [0m[35m            web.get("/test/trace_check/failures", agent.get_trace_check_failures),[0m
[30;1m1165 | [0m[35m            web.get("/test/trace_check/clear", agent.clear_trace_check_failures),[0m
[30;1m1166 | [0m[35m            web.get("/test/trace_check/summary", agent.get_trace_check_summary),[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1159 | [0m[35m            web.put("/test/session/integrations", agent.handle_put_tested_integrations),[0m
[30;1m1160 | [0m[35m            web.get("/test/traces", agent.handle_test_traces),[0m
[30;1m1161 | [0m[35m            web.get("/test/apmtelemetry", agent.handle_test_apmtelemetry),[0m
[30;1m1162 | [0m[35m            # web.get("/test/benchmark", agent.handle_test_traces),[0m
[30;1m1163 | [0m[35m            web.get("/test/trace/analyze", agent.handle_trace_analyze),[0m
[30;1m1164 | [0m[35m            web.get("/test/trace_check/failures", agent.get_trace_check_failures),[0m
[30;1m1165 | [0m[35m            web.get("/test/trace_check/clear", agent.clear_trace_check_failures),[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1158 | [0m[35m            web.put("/test/session/responses/config", agent.handle_v07_remoteconfig_put),[0m
[30;1m1159 | [0m[35m            web.put("/test/session/integrations", agent.handle_put_tested_integrations),[0m
[30;1m1160 | [0m[35m            web.get("/test/traces", agent.handle_test_traces),[0m
[30;1m1161 | [0m[35m            web.get("/test/apmtelemetry", agent.handle_test_apmtelemetry),[0m
[30;1m1162 | [0m[35m            # web.get("/test/benchmark", agent.handle_test_traces),[0m
[30;1m1163 | [0m[35m            web.get("/test/trace/analyze", agent.handle_trace_analyze),[0m
[30;1m1164 | [0m[35m            web.get("/test/trace_check/failures", agent.get_trace_check_failures),[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1157 | [0m[35m            web.post("/test/session/responses/config/path", agent.handle_v07_remoteconfig_path_creat[0m
[30;1m1158 | [0m[35m            web.put("/test/session/responses/config", agent.handle_v07_remoteconfig_put),[0m
[30;1m1159 | [0m[35m            web.put("/test/session/integrations", agent.handle_put_tested_integrations),[0m
[30;1m1160 | [0m[35m            web.get("/test/traces", agent.handle_test_traces),[0m
[30;1m1161 | [0m[35m            web.get("/test/apmtelemetry", agent.handle_test_apmtelemetry),[0m
[30;1m1162 | [0m[35m            # web.get("/test/benchmark", agent.handle_test_traces),[0m
[30;1m1163 | [0m[35m            web.get("/test/trace/analyze", agent.handle_trace_analyze),[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1154 | [0m[35m            web.get("/test/session/stats", agent.handle_session_tracestats),[0m
[30;1m1155 | [0m[35m            web.get("/test/session/requests", agent.handle_session_requests),[0m
[30;1m1156 | [0m[35m            web.post("/test/session/responses/config", agent.handle_v07_remoteconfig_create),[0m
[30;1m1157 | [0m[35m            web.post("/test/session/responses/config/path", agent.handle_v07_remoteconfig_path_creat[0m
[30;1m1158 | [0m[35m            web.put("/test/session/responses/config", agent.handle_v07_remoteconfig_put),[0m
[30;1m1159 | [0m[35m            web.put("/test/session/integrations", agent.handle_put_tested_integrations),[0m
[30;1m1160 | [0m[35m            web.get("/test/traces", agent.handle_test_traces),[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1152 | [0m[35mmetry", agent.handle_session_apmtelemetry),[0m
[30;1m1153 | [0m[35m            web.get("/test/session/tracerflares", agent.handle_session_tracerflares),[0m
[30;1m1154 | [0m[35m            web.get("/test/session/stats", agent.handle_session_tracestats),[0m
[30;1m1155 | [0m[35m            web.get("/test/session/requests", agent.handle_session_requests),[0m
[30;1m1156 | [0m[35m            web.post("/test/session/responses/config", agent.handle_v07_remoteconfig_create),[0m
[30;1m1157 | [0m[35m            web.post("/test/session/responses/config/path", agent.handle_v07_remoteconfig_path_creat[0m
[30;1m1158 | [0m[35m            web.put("/test/session/responses/config", agent.handle_v07_remoteconfig_put),[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1151 | [0m[35mces", agent.handle_session_traces),[0m
[30;1m1152 | [0m[35m            web.get("/test/session/apmtelemetry", agent.handle_session_apmtelemetry),[0m
[30;1m1153 | [0m[35m            web.get("/test/session/tracerflares", agent.handle_session_tracerflares),[0m
[30;1m1154 | [0m[35m            web.get("/test/session/stats", agent.handle_session_tracestats),[0m
[30;1m1155 | [0m[35m            web.get("/test/session/requests", agent.handle_session_requests),[0m
[30;1m1156 | [0m[35m            web.post("/test/session/responses/config", agent.handle_v07_remoteconfig_create),[0m
[30;1m1157 | [0m[35m            web.post("/test/session/responses/config/path", agent.handle_v07_remoteconfig_path_creat[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1151 | [0m[35m            web.get("/test/session/traces", agent.handle_session_traces),[0m
[30;1m1152 | [0m[35m            web.get("/test/session/apmtelemetry", agent.handle_session_apmtelemetry),[0m
[30;1m1153 | [0m[35m            web.get("/test/session/tracerflares", agent.handle_session_tracerflares),[0m
[30;1m1154 | [0m[35m            web.get("/test/session/stats", agent.handle_session_tracestats),[0m
[30;1m1155 | [0m[35m            web.get("/test/session/requests", agent.handle_session_requests),[0m
[30;1m1156 | [0m[35m            web.post("/test/session/responses/config", agent.handle_v07_remoteconfig_create),[0m
[30;1m1157 | [0m[35m            web.post("/test/session/responses/config/path", agent.handle_v07_remoteconfig_path_creat[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1150 | [0m[35m            web.get("/test/session/snapshot", agent.handle_snapshot),[0m
[30;1m1151 | [0m[35m            web.get("/test/session/traces", agent.handle_session_traces),[0m
[30;1m1152 | [0m[35m            web.get("/test/session/apmtelemetry", agent.handle_session_apmtelemetry),[0m
[30;1m1153 | [0m[35m            web.get("/test/session/tracerflares", agent.handle_session_tracerflares),[0m
[30;1m1154 | [0m[35m            web.get("/test/session/stats", agent.handle_session_tracestats),[0m
[30;1m1155 | [0m[35m            web.get("/test/session/requests", agent.handle_session_requests),[0m
[30;1m1156 | [0m[35m            web.post("/test/session/responses/config", agent.handle_v07_remoteconfig_create),[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1149 | [0m[35m            web.get("/test/session/clear", agent.handle_session_clear),[0m
[30;1m1150 | [0m[35m            web.get("/test/session/snapshot", agent.handle_snapshot),[0m
[30;1m1151 | [0m[35m            web.get("/test/session/traces", agent.handle_session_traces),[0m
[30;1m1152 | [0m[35m            web.get("/test/session/apmtelemetry", agent.handle_session_apmtelemetry),[0m
[30;1m1153 | [0m[35m            web.get("/test/session/tracerflares", agent.handle_session_tracerflares),[0m
[30;1m1154 | [0m[35m            web.get("/test/session/stats", agent.handle_session_tracestats),[0m
[30;1m1155 | [0m[35m            web.get("/test/session/requests", agent.handle_session_requests),[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1148 | [0m[35m            web.get("/test/session/start", agent.handle_session_start),[0m
[30;1m1149 | [0m[35m            web.get("/test/session/clear", agent.handle_session_clear),[0m
[30;1m1150 | [0m[35m            web.get("/test/session/snapshot", agent.handle_snapshot),[0m
[30;1m1151 | [0m[35m            web.get("/test/session/traces", agent.handle_session_traces),[0m
[30;1m1152 | [0m[35m            web.get("/test/session/apmtelemetry", agent.handle_session_apmtelemetry),[0m
[30;1m1153 | [0m[35m            web.get("/test/session/tracerflares", agent.handle_session_tracerflares),[0m
[30;1m1154 | [0m[35m            web.get("/test/session/stats", agent.handle_session_tracestats),[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1147 | [0m[35m            web.get("/info", agent.handle_info),[0m
[30;1m1148 | [0m[35m            web.get("/test/session/start", agent.handle_session_start),[0m
[30;1m1149 | [0m[35m            web.get("/test/session/clear", agent.handle_session_clear),[0m
[30;1m1150 | [0m[35m            web.get("/test/session/snapshot", agent.handle_snapshot),[0m
[30;1m1151 | [0m[35m            web.get("/test/session/traces", agent.handle_session_traces),[0m
[30;1m1152 | [0m[35m            web.get("/test/session/apmtelemetry", agent.handle_session_apmtelemetry),[0m
[30;1m1153 | [0m[35m            web.get("/test/session/tracerflares", agent.handle_session_tracerflares),[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1146 | [0m[35m            web.post("/evp_proxy/v2/api/v2/llmobs", agent.handle_evp_proxy_v2_api_v2_llmobs),[0m
[30;1m1147 | [0m[35m            web.get("/info", agent.handle_info),[0m
[30;1m1148 | [0m[35m            web.get("/test/session/start", agent.handle_session_start),[0m
[30;1m1149 | [0m[35m            web.get("/test/session/clear", agent.handle_session_clear),[0m
[30;1m1150 | [0m[35m            web.get("/test/session/snapshot", agent.handle_snapshot),[0m
[30;1m1151 | [0m[35m            web.get("/test/session/traces", agent.handle_session_traces),[0m
[30;1m1152 | [0m[35m            web.get("/test/session/apmtelemetry", agent.handle_session_apmtelemetry),[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1145 | [0m[35m            web.post("/tracer_flare/v1", agent.handle_v1_tracer_flare),[0m
[30;1m1146 | [0m[35m            web.post("/evp_proxy/v2/api/v2/llmobs", agent.handle_evp_proxy_v2_api_v2_llmobs),[0m
[30;1m1147 | [0m[35m            web.get("/info", agent.handle_info),[0m
[30;1m1148 | [0m[35m            web.get("/test/session/start", agent.handle_session_start),[0m
[30;1m1149 | [0m[35m            web.get("/test/session/clear", agent.handle_session_clear),[0m
[30;1m1150 | [0m[35m            web.get("/test/session/snapshot", agent.handle_snapshot),[0m
[30;1m1151 | [0m[35m            web.get("/test/session/traces", agent.handle_session_traces),[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1144 | [0m[35m            web.post("/profiling/v1/input", agent.handle_v1_profiling),[0m
[30;1m1145 | [0m[35m            web.post("/tracer_flare/v1", agent.handle_v1_tracer_flare),[0m
[30;1m1146 | [0m[35m            web.post("/evp_proxy/v2/api/v2/llmobs", agent.handle_evp_proxy_v2_api_v2_llmobs),[0m
[30;1m1147 | [0m[35m            web.get("/info", agent.handle_info),[0m
[30;1m1148 | [0m[35m            web.get("/test/session/start", agent.handle_session_start),[0m
[30;1m1149 | [0m[35m            web.get("/test/session/clear", agent.handle_session_clear),[0m
[30;1m1150 | [0m[35m            web.get("/test/session/snapshot", agent.handle_snapshot),[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1143 | [0m[35m            web.post("/telemetry/proxy/api/v2/apmtelemetry", agent.handle_v2_apmtelemetry),[0m
[30;1m1144 | [0m[35m            web.post("/profiling/v1/input", agent.handle_v1_profiling),[0m
[30;1m1145 | [0m[35m            web.post("/tracer_flare/v1", agent.handle_v1_tracer_flare),[0m
[30;1m1146 | [0m[35m            web.post("/evp_proxy/v2/api/v2/llmobs", agent.handle_evp_proxy_v2_api_v2_llmobs),[0m
[30;1m1147 | [0m[35m            web.get("/info", agent.handle_info),[0m
[30;1m1148 | [0m[35m            web.get("/test/session/start", agent.handle_session_start),[0m
[30;1m1149 | [0m[35m            web.get("/test/session/clear", agent.handle_session_clear),[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1142 | [0m[35m            web.post("/v0.7/config", agent.handle_v07_remoteconfig),[0m
[30;1m1143 | [0m[35m            web.post("/telemetry/proxy/api/v2/apmtelemetry", agent.handle_v2_apmtelemetry),[0m
[30;1m1144 | [0m[35m            web.post("/profiling/v1/input", agent.handle_v1_profiling),[0m
[30;1m1145 | [0m[35m            web.post("/tracer_flare/v1", agent.handle_v1_tracer_flare),[0m
[30;1m1146 | [0m[35m            web.post("/evp_proxy/v2/api/v2/llmobs", agent.handle_evp_proxy_v2_api_v2_llmobs),[0m
[30;1m1147 | [0m[35m            web.get("/info", agent.handle_info),[0m
[30;1m1148 | [0m[35m            web.get("/test/session/start", agent.handle_session_start),[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1141 | [0m[35m            web.get("/v0.7/config", agent.handle_v07_remoteconfig),[0m
[30;1m1142 | [0m[35m            web.post("/v0.7/config", agent.handle_v07_remoteconfig),[0m
[30;1m1143 | [0m[35m            web.post("/telemetry/proxy/api/v2/apmtelemetry", agent.handle_v2_apmtelemetry),[0m
[30;1m1144 | [0m[35m            web.post("/profiling/v1/input", agent.handle_v1_profiling),[0m
[30;1m1145 | [0m[35m            web.post("/tracer_flare/v1", agent.handle_v1_tracer_flare),[0m
[30;1m1146 | [0m[35m            web.post("/evp_proxy/v2/api/v2/llmobs", agent.handle_evp_proxy_v2_api_v2_llmobs),[0m
[30;1m1147 | [0m[35m            web.get("/info", agent.handle_info),[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1140 | [0m[35m            web.put("/v0.6/stats", agent.handle_v06_tracestats),[0m
[30;1m1141 | [0m[35m            web.get("/v0.7/config", agent.handle_v07_remoteconfig),[0m
[30;1m1142 | [0m[35m            web.post("/v0.7/config", agent.handle_v07_remoteconfig),[0m
[30;1m1143 | [0m[35m            web.post("/telemetry/proxy/api/v2/apmtelemetry", agent.handle_v2_apmtelemetry),[0m
[30;1m1144 | [0m[35m            web.post("/profiling/v1/input", agent.handle_v1_profiling),[0m
[30;1m1145 | [0m[35m            web.post("/tracer_flare/v1", agent.handle_v1_tracer_flare),[0m
[30;1m1146 | [0m[35m            web.post("/evp_proxy/v2/api/v2/llmobs", agent.handle_evp_proxy_v2_api_v2_llmobs),[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1139 | [0m[35m            web.post("/v0.1/pipeline_stats", agent.handle_v01_pipelinestats),[0m
[30;1m1140 | [0m[35m            web.put("/v0.6/stats", agent.handle_v06_tracestats),[0m
[30;1m1141 | [0m[35m            web.get("/v0.7/config", agent.handle_v07_remoteconfig),[0m
[30;1m1142 | [0m[35m            web.post("/v0.7/config", agent.handle_v07_remoteconfig),[0m
[30;1m1143 | [0m[35m            web.post("/telemetry/proxy/api/v2/apmtelemetry", agent.handle_v2_apmtelemetry),[0m
[30;1m1144 | [0m[35m            web.post("/profiling/v1/input", agent.handle_v1_profiling),[0m
[30;1m1145 | [0m[35m            web.post("/tracer_flare/v1", agent.handle_v1_tracer_flare),[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1138 | [0m[35m            web.post("/v0.6/stats", agent.handle_v06_tracestats),[0m
[30;1m1139 | [0m[35m            web.post("/v0.1/pipeline_stats", agent.handle_v01_pipelinestats),[0m
[30;1m1140 | [0m[35m            web.put("/v0.6/stats", agent.handle_v06_tracestats),[0m
[30;1m1141 | [0m[35m            web.get("/v0.7/config", agent.handle_v07_remoteconfig),[0m
[30;1m1142 | [0m[35m            web.post("/v0.7/config", agent.handle_v07_remoteconfig),[0m
[30;1m1143 | [0m[35m            web.post("/telemetry/proxy/api/v2/apmtelemetry", agent.handle_v2_apmtelemetry),[0m
[30;1m1144 | [0m[35m            web.post("/profiling/v1/input", agent.handle_v1_profiling),[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1136 | [0m[35m            web.post("/v0.7/traces", agent.handle_v07_traces),[0m
[30;1m1137 | [0m[35m            web.put("/v0.7/traces", agent.handle_v07_traces),[0m
[30;1m1138 | [0m[35m            web.post("/v0.6/stats", agent.handle_v06_tracestats),[0m
[30;1m1139 | [0m[35m            web.post("/v0.1/pipeline_stats", agent.handle_v01_pipelinestats),[0m
[30;1m1140 | [0m[35m            web.put("/v0.6/stats", agent.handle_v06_tracestats),[0m
[30;1m1141 | [0m[35m            web.get("/v0.7/config", agent.handle_v07_remoteconfig),[0m
[30;1m1142 | [0m[35m            web.post("/v0.7/config", agent.handle_v07_remoteconfig),[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1135 | [0m[35m            web.put("/v0.5/traces", agent.handle_v05_traces),[0m
[30;1m1136 | [0m[35m            web.post("/v0.7/traces", agent.handle_v07_traces),[0m
[30;1m1137 | [0m[35m            web.put("/v0.7/traces", agent.handle_v07_traces),[0m
[30;1m1138 | [0m[35m            web.post("/v0.6/stats", agent.handle_v06_tracestats),[0m
[30;1m1139 | [0m[35m            web.post("/v0.1/pipeline_stats", agent.handle_v01_pipelinestats),[0m
[30;1m1140 | [0m[35m            web.put("/v0.6/stats", agent.handle_v06_tracestats),[0m
[30;1m1141 | [0m[35m            web.get("/v0.7/config", agent.handle_v07_remoteconfig),[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1133 | [0m[35m            web.put("/v0.4/traces", agent.handle_v04_traces),[0m
[30;1m1134 | [0m[35m            web.post("/v0.5/traces", agent.handle_v05_traces),[0m
[30;1m1135 | [0m[35m            web.put("/v0.5/traces", agent.handle_v05_traces),[0m
[30;1m1136 | [0m[35m            web.post("/v0.7/traces", agent.handle_v07_traces),[0m
[30;1m1137 | [0m[35m            web.put("/v0.7/traces", agent.handle_v07_traces),[0m
[30;1m1138 | [0m[35m            web.post("/v0.6/stats", agent.handle_v06_tracestats),[0m
[30;1m1139 | [0m[35m            web.post("/v0.1/pipeline_stats", agent.handle_v01_pipelinestats),[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1131 | [0m[35m        [[0m
[30;1m1132 | [0m[35m            web.post("/v0.4/traces", agent.handle_v04_traces),[0m
[30;1m1133 | [0m[35m            web.put("/v0.4/traces", agent.handle_v04_traces),[0m
[30;1m1134 | [0m[35m            web.post("/v0.5/traces", agent.handle_v05_traces),[0m
[30;1m1135 | [0m[35m            web.put("/v0.5/traces", agent.handle_v05_traces),[0m
[30;1m1136 | [0m[35m            web.post("/v0.7/traces", agent.handle_v07_traces),[0m
[30;1m1137 | [0m[35m            web.put("/v0.7/traces", agent.handle_v07_traces),[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1129 | [0m[35m    )[0m
[30;1m1130 | [0m[35m    app.add_routes([0m
[30;1m1131 | [0m[35m        [[0m
[30;1m1132 | [0m[35m            web.post("/v0.4/traces", agent.handle_v04_traces),[0m
[30;1m1133 | [0m[35m            web.put("/v0.4/traces", agent.handle_v04_traces),[0m
[30;1m1134 | [0m[35m            web.post("/v0.5/traces", agent.handle_v05_traces),[0m
[30;1m1135 | [0m[35m            web.put("/v0.5/traces", agent.handle_v05_traces),[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1044 | [0m[35m        data = self._request_data(request)[0m
[30;1m1045 | [0m[35m        headers = request["_headers"][0m
[30;1m1046 | [0m[35m        agent_url = request.app["agent_url"][0m
[30;1m1047 | [0m[35m        proxy_to_agent = request.get("_proxy_to_agent", True)[0m
[30;1m1048 | [0m[35m[0m
[30;1m1049 | [0m[35m        log.debug(f"New request: {request} with headers: {headers}")[0m
[30;1m1050 | [0m[35m        log.debug(f"Request Data: {data!r}")[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m996 | [0m[35m    async def handle_trace_analyze(self, request: Request) -> web.Response:[0m
[30;1m997 | [0m[35m        # client.get("/span/start")[0m
[30;1m998 | [0m[35m        # client.get("/span/tag")[0m
[30;1m999 | [0m[35m        # client.get("/span/finish")[0m
[30;1m1000 | [0m[35m        # wait 1s, gather traces and assert tags[0m
[30;1m1001 | [0m[35m        raise NotImplementedError[0m
[30;1m1002 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m995 | [0m[35m[0m
[30;1m996 | [0m[35m    async def handle_trace_analyze(self, request: Request) -> web.Response:[0m
[30;1m997 | [0m[35m        # client.get("/span/start")[0m
[30;1m998 | [0m[35m        # client.get("/span/tag")[0m
[30;1m999 | [0m[35m        # client.get("/span/finish")[0m
[30;1m1000 | [0m[35m        # wait 1s, gather traces and assert tags[0m
[30;1m1001 | [0m[35m        raise NotImplementedError[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m994 | [0m[35m        return web.HTTPOk()[0m
[30;1m995 | [0m[35m[0m
[30;1m996 | [0m[35m    async def handle_trace_analyze(self, request: Request) -> web.Response:[0m
[30;1m997 | [0m[35m        # client.get("/span/start")[0m
[30;1m998 | [0m[35m        # client.get("/span/tag")[0m
[30;1m999 | [0m[35m        # client.get("/span/finish")[0m
[30;1m1000 | [0m[35m        # wait 1s, gather traces and assert tags[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m949 | [0m[35m        Telemetry events can be requested by providing a header X-Datadog-Runtime-Ids or[0m
[30;1m950 | [0m[35m        a query param runtime_ids.[0m
[30;1m951 | [0m[35m        """[0m
[30;1m952 | [0m[35m        raw_runtime_ids = request.url.query.get("runtime_ids", request.headers.get("X-Datadog-Runtim[0m
[30;1m953 | [0m[35m        if raw_runtime_ids:[0m
[30;1m954 | [0m[35m            runtime_ids = raw_runtime_ids.split(",")[0m
[30;1m955 | [0m[35m            events: List[TelemetryEvent] = [][0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m949 | [0m[35m        Telemetry events can be requested by providing a header X-Datadog-Runtime-Ids or[0m
[30;1m950 | [0m[35m        a query param runtime_ids.[0m
[30;1m951 | [0m[35m        """[0m
[30;1m952 | [0m[35m        raw_runtime_ids = request.url.query.get("runtime_ids", request.headers.get("X-Datadog-Runtim[0m
[30;1m953 | [0m[35m        if raw_runtime_ids:[0m
[30;1m954 | [0m[35m            runtime_ids = raw_runtime_ids.split(",")[0m
[30;1m955 | [0m[35m            events: List[TelemetryEvent] = [][0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m930 | [0m[35m        Traces can be requested by providing a header X-Datadog-Trace-Ids or[0m
[30;1m931 | [0m[35m        a query param trace_ids.[0m
[30;1m932 | [0m[35m        """[0m
[30;1m933 | [0m[35m        raw_trace_ids = request.url.query.get("trace_ids", request.headers.get("X-Datadog-Trace-Ids"[0m
[30;1m934 | [0m[35m        if raw_trace_ids:[0m
[30;1m935 | [0m[35m            trace_ids = map(int, raw_trace_ids.split(","))[0m
[30;1m936 | [0m[35m            traces = [][0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m930 | [0m[35m        Traces can be requested by providing a header X-Datadog-Trace-Ids or[0m
[30;1m931 | [0m[35m        a query param trace_ids.[0m
[30;1m932 | [0m[35m        """[0m
[30;1m933 | [0m[35m        raw_trace_ids = request.url.query.get("trace_ids", request.headers.get("X-Datadog-Trace-Ids"[0m
[30;1m934 | [0m[35m        if raw_trace_ids:[0m
[30;1m935 | [0m[35m            trace_ids = map(int, raw_trace_ids.split(","))[0m
[30;1m936 | [0m[35m            traces = [][0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m790 | [0m[35m[0m
[30;1m791 | [0m[35m        # Get the span attributes that are to be removed for this snapshot.[0m
[30;1m792 | [0m[35m        default_span_removes: Set[str] = request.app["snapshot_removed_attrs"][0m
[30;1m793 | [0m[35m        overrides = set(_parse_csv(request.url.query.get("removes", "")))[0m
[30;1m794 | [0m[35m        span_removes = list(default_span_removes | overrides)[0m
[30;1m795 | [0m[35m        log.info("using removes %r", span_removes)[0m
[30;1m796 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m784 | [0m[35m[0m
[30;1m785 | [0m[35m        # Get the span attributes that are to be ignored for this snapshot.[0m
[30;1m786 | [0m[35m        default_span_ignores: Set[str] = request.app["snapshot_ignored_attrs"][0m
[30;1m787 | [0m[35m        overrides = set(_parse_csv(request.url.query.get("ignores", "")))[0m
[30;1m788 | [0m[35m        span_ignores = list(default_span_ignores | overrides)[0m
[30;1m789 | [0m[35m        log.info("using ignores %r", span_ignores)[0m
[30;1m790 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m773 | [0m[35m    async def handle_snapshot(self, request: Request) -> web.Response:[0m
[30;1m774 | [0m[35m        """Generate a snapshot or perform a snapshot test."""[0m
[30;1m775 | [0m[35m        token = request["session_token"][0m
[30;1m776 | [0m[35m        snap_dir = request.url.query.get("dir", request.app["snapshot_dir"])[0m
[30;1m777 | [0m[35m        snap_ci_mode = request.app["snapshot_ci_mode"][0m
[30;1m778 | [0m[35m        log.info([0m
[30;1m779 | [0m[35m            "performing snapshot with token=%r, ci_mode=%r and snapshot directory=%r",[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m763 | [0m[35m        return web.json_response(data={"rate_by_service": self._sessions[token].sample_rate_by_servi[0m
[30;1m764 | [0m[35m[0m
[30;1m765 | [0m[35m    async def handle_session_start(self, request: Request) -> web.Response:[0m
[30;1m766 | [0m[35m        rates = json.loads(request.url.query.get("agent_sample_rate_by_service", "{}"))[0m
[30;1m767 | [0m[35m        self._requests.append(request)[0m
[30;1m768 | [0m[35m        session = self._sessions[_session_token(request)][0m
[30;1m769 | [0m[35m        session.sample_rate_by_service_env = rates[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m747 | [0m[35m                        )[0m
[30;1m748 | [0m[35m[0m
[30;1m749 | [0m[35m                    await checks.check([0m
[30;1m750 | [0m[35m                        "trace_dd_service", trace=trace, dd_config_env=request.get("_dd_trace_env_va[0m
[30;1m751 | [0m[35m                    )[0m
[30;1m752 | [0m[35m                log.info("end of payload %s", "-" * 40)[0m
[30;1m753 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m743 | [0m[35m                    # perform peer service check on span[0m
[30;1m744 | [0m[35m                    for span in trace:[0m
[30;1m745 | [0m[35m                        await checks.check([0m
[30;1m746 | [0m[35m                            "trace_peer_service", span=span, dd_config_env=request.get("_dd_trace_en[0m
[30;1m747 | [0m[35m                        )[0m
[30;1m748 | [0m[35m[0m
[30;1m749 | [0m[35m                    await checks.check([0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m511 | [0m[35m                    if req.headers.get("dd-client-library-language", None):[0m
[30;1m512 | [0m[35m                        req["tracer_language"] = req.headers.get("dd-client-library-language")[0m
[30;1m513 | [0m[35m                    elif req.headers.get("datadog-meta-lang", None):[0m
[30;1m514 | [0m[35m                        req["tracer_language"] = req.headers.get("datadog-meta-lang")[0m
[30;1m515 | [0m[35m                    integration_requests.append(req)[0m
[30;1m516 | [0m[35m                elif include_sent_integrations:[0m
[30;1m517 | [0m[35m                    integration_requests.append(req)[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m510 | [0m[35m[0m
[30;1m511 | [0m[35m                    if req.headers.get("dd-client-library-language", None):[0m
[30;1m512 | [0m[35m                        req["tracer_language"] = req.headers.get("dd-client-library-language")[0m
[30;1m513 | [0m[35m                    elif req.headers.get("datadog-meta-lang", None):[0m
[30;1m514 | [0m[35m                        req["tracer_language"] = req.headers.get("datadog-meta-lang")[0m
[30;1m515 | [0m[35m                    integration_requests.append(req)[0m
[30;1m516 | [0m[35m                elif include_sent_integrations:[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m509 | [0m[35m                        req["tracer_version"] = req.headers.get("datadog-meta-tracer-version")[0m
[30;1m510 | [0m[35m[0m
[30;1m511 | [0m[35m                    if req.headers.get("dd-client-library-language", None):[0m
[30;1m512 | [0m[35m                        req["tracer_language"] = req.headers.get("dd-client-library-language")[0m
[30;1m513 | [0m[35m                    elif req.headers.get("datadog-meta-lang", None):[0m
[30;1m514 | [0m[35m                        req["tracer_language"] = req.headers.get("datadog-meta-lang")[0m
[30;1m515 | [0m[35m                    integration_requests.append(req)[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m508 | [0m[35m                    elif req.headers.get("datadog-meta-tracer-version", None):[0m
[30;1m509 | [0m[35m                        req["tracer_version"] = req.headers.get("datadog-meta-tracer-version")[0m
[30;1m510 | [0m[35m[0m
[30;1m511 | [0m[35m                    if req.headers.get("dd-client-library-language", None):[0m
[30;1m512 | [0m[35m                        req["tracer_language"] = req.headers.get("dd-client-library-language")[0m
[30;1m513 | [0m[35m                    elif req.headers.get("datadog-meta-lang", None):[0m
[30;1m514 | [0m[35m                        req["tracer_language"] = req.headers.get("datadog-meta-lang")[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m506 | [0m[35m                    if req.headers.get("dd-client-library-version", None):[0m
[30;1m507 | [0m[35m                        req["tracer_version"] = req.headers.get("dd-client-library-version")[0m
[30;1m508 | [0m[35m                    elif req.headers.get("datadog-meta-tracer-version", None):[0m
[30;1m509 | [0m[35m                        req["tracer_version"] = req.headers.get("datadog-meta-tracer-version")[0m
[30;1m510 | [0m[35m[0m
[30;1m511 | [0m[35m                    if req.headers.get("dd-client-library-language", None):[0m
[30;1m512 | [0m[35m                        req["tracer_language"] = req.headers.get("dd-client-library-language")[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m505 | [0m[35m[0m
[30;1m506 | [0m[35m                    if req.headers.get("dd-client-library-version", None):[0m
[30;1m507 | [0m[35m                        req["tracer_version"] = req.headers.get("dd-client-library-version")[0m
[30;1m508 | [0m[35m                    elif req.headers.get("datadog-meta-tracer-version", None):[0m
[30;1m509 | [0m[35m                        req["tracer_version"] = req.headers.get("datadog-meta-tracer-version")[0m
[30;1m510 | [0m[35m[0m
[30;1m511 | [0m[35m                    if req.headers.get("dd-client-library-language", None):[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m504 | [0m[35m                    )[0m
[30;1m505 | [0m[35m[0m
[30;1m506 | [0m[35m                    if req.headers.get("dd-client-library-version", None):[0m
[30;1m507 | [0m[35m                        req["tracer_version"] = req.headers.get("dd-client-library-version")[0m
[30;1m508 | [0m[35m                    elif req.headers.get("datadog-meta-tracer-version", None):[0m
[30;1m509 | [0m[35m                        req["tracer_version"] = req.headers.get("datadog-meta-tracer-version")[0m
[30;1m510 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m503 | [0m[35m                        dependency_name=req["_dd_trace_env_variables"].get("DD_DEPENDENCY_NAME", int[0m
[30;1m504 | [0m[35m                    )[0m
[30;1m505 | [0m[35m[0m
[30;1m506 | [0m[35m                    if req.headers.get("dd-client-library-version", None):[0m
[30;1m507 | [0m[35m                        req["tracer_version"] = req.headers.get("dd-client-library-version")[0m
[30;1m508 | [0m[35m                    elif req.headers.get("datadog-meta-tracer-version", None):[0m
[30;1m509 | [0m[35m                        req["tracer_version"] = req.headers.get("datadog-meta-tracer-version")[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m500 | [0m[35m                    req["integration"] = Integration([0m
[30;1m501 | [0m[35m                        integration_name=integration_name,[0m
[30;1m502 | [0m[35m                        integration_version=integration_version,[0m
[30;1m503 | [0m[35m                        dependency_name=req["_dd_trace_env_variables"].get("DD_DEPENDENCY_NAME", int[0m
[30;1m504 | [0m[35m                    )[0m
[30;1m505 | [0m[35m[0m
[30;1m506 | [0m[35m                    if req.headers.get("dd-client-library-version", None):[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m483 | [0m[35m                        dependency_name=data.get("dependency_name", integration_name),[0m
[30;1m484 | [0m[35m                    )[0m
[30;1m485 | [0m[35m                    req["tracer_version"] = data.get("tracer_version", None)[0m
[30;1m486 | [0m[35m                    req["tracer_language"] = data.get("tracer_language", None)[0m
[30;1m487 | [0m[35m                    integration_requests.append(req)[0m
[30;1m488 | [0m[35m                elif include_sent_integrations:[0m
[30;1m489 | [0m[35m                    integration_requests.append(req)[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m482 | [0m[35m                        integration_version=integration_version,[0m
[30;1m483 | [0m[35m                        dependency_name=data.get("dependency_name", integration_name),[0m
[30;1m484 | [0m[35m                    )[0m
[30;1m485 | [0m[35m                    req["tracer_version"] = data.get("tracer_version", None)[0m
[30;1m486 | [0m[35m                    req["tracer_language"] = data.get("tracer_language", None)[0m
[30;1m487 | [0m[35m                    integration_requests.append(req)[0m
[30;1m488 | [0m[35m                elif include_sent_integrations:[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m480 | [0m[35m                    req["integration"] = Integration([0m
[30;1m481 | [0m[35m                        integration_name=integration_name,[0m
[30;1m482 | [0m[35m                        integration_version=integration_version,[0m
[30;1m483 | [0m[35m                        dependency_name=data.get("dependency_name", integration_name),[0m
[30;1m484 | [0m[35m                    )[0m
[30;1m485 | [0m[35m                    req["tracer_version"] = data.get("tracer_version", None)[0m
[30;1m486 | [0m[35m                    req["tracer_language"] = data.get("tracer_language", None)[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m476 | [0m[35m                if "integration" not in req:[0m
[30;1m477 | [0m[35m                    data = json.loads(await req.read())[0m
[30;1m478 | [0m[35m                    integration_name = data.get("integration_name", None)[0m
[30;1m479 | [0m[35m                    integration_version = data.get("integration_version", None)[0m
[30;1m480 | [0m[35m                    req["integration"] = Integration([0m
[30;1m481 | [0m[35m                        integration_name=integration_name,[0m
[30;1m482 | [0m[35m                        integration_version=integration_version,[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m475 | [0m[35m            if req.match_info.handler == self.handle_put_tested_integrations:[0m
[30;1m476 | [0m[35m                if "integration" not in req:[0m
[30;1m477 | [0m[35m                    data = json.loads(await req.read())[0m
[30;1m478 | [0m[35m                    integration_name = data.get("integration_name", None)[0m
[30;1m479 | [0m[35m                    integration_version = data.get("integration_version", None)[0m
[30;1m480 | [0m[35m                    req["integration"] = Integration([0m
[30;1m481 | [0m[35m                        integration_name=integration_name,[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m324 | [0m[35m                    summary[check_name]["Failed_Checks"] += check_results["Failed_Checks"][0m
[30;1m325 | [0m[35m                    summary[check_name]["Skipped_Checks"] += check_results["Skipped_Checks"][0m
[30;1m326 | [0m[35m        else:[0m
[30;1m327 | [0m[35m            summary = self._trace_check_results_by_check.get(token, {})[0m
[30;1m328 | [0m[35m        json_summary = json.dumps(summary)[0m
[30;1m329 | [0m[35m        return web.HTTPOk(body=json_summary, content_type="application/json")[0m
[30;1m330 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m292 | [0m[35m            log.info(f"{n_failures} Trace Failures Occurred in Total")[0m
[30;1m293 | [0m[35m        else:[0m
[30;1m294 | [0m[35m            # or return results by token[0m
[30;1m295 | [0m[35m            trace_check_failures = self._trace_failures.get(token, [])[0m
[30;1m296 | [0m[35m            n_failures = len(trace_check_failures)[0m
[30;1m297 | [0m[35m            log.info(f"{n_failures} Trace Failures Occurred for Token {token}")[0m
[30;1m298 | [0m[35m        if n_failures > 0:[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35masync def _prepare_and_send_request(data: bytes, request: Request, headers: Mapping[str, str]) -> we[0m
[30;1m161 | [0m[35m    headers = {[0m
[30;1m162 | [0m[35m        "Content-Type": headers.get("Content-Type", "application/msgpack"),[0m
[30;1m163 | [0m[35m        **{k: v for k, v in headers.items() if k.lower() not in ["content-type", "host", "transfer-e[0m
[30;1m164 | [0m[35m    }[0m
[30;1m165 | [0m[35m    agent_url = request.app["agent_url"][0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35m    request_data: bytes, headers: Mapping[str, str], full_agent_url: str[0m
[30;1m130 | [0m[35m) -> tuple[ClientResponse, str]:[0m
[30;1m131 | [0m[35m    async with ClientSession() as session:[0m
[30;1m132 | [0m[35m        async with session.post([0m
[30;1m133 | [0m[35m            full_agent_url,[0m
[30;1m134 | [0m[35m            headers=headers,[0m
[30;1m135 | [0m[35m            data=request_data,[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m    if "X-Datadog-Test-Session-Token" in request.headers:[0m
[30;1m97 | [0m[35m        token = request.headers["X-Datadog-Test-Session-Token"][0m
[30;1m98 | [0m[35m    elif "test_session_token" in request.url.query:[0m
[30;1m99 | [0m[35m        token = request.url.query.get("test_session_token")[0m
[30;1m100 | [0m[35m    else:[0m
[30;1m101 | [0m[35m        token = None[0m
[30;1m102 | [0m[35m    return token[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m.hostname[0m
[30;1m844 | [0m[35m                    f.write(trace_snapshot.generate_snapshot(received_traces=received_traces, remove[0m
[30;1m845 | [0m[35m                log.info("wrote new trace snapshot to %r", os.path.abspath(trace_snap_file))[0m
[30;1m846 | [0m[35m[0m
[30;1m847 | [0m[35m            # Get all stats buckets from the payloads since we don't care about the other fields (ho[0m
[30;1m848 | [0m[35m            # in the payload.[0m
[30;1m849 | [0m[35m            received_stats = [bucket for p in (await self._tracestats_by_session(token)) for bucket [0m
[30;1m850 | [0m[35m            tracestats_snap_path_exists = os.path.exists(tracestats_snap_file)[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m.hostname[0m
[30;1m604 | [0m[35m            log.error(msg)[0m
[30;1m605 | [0m[35m            raise web.HTTPBadRequest(text=msg)[0m
[30;1m606 | [0m[35m[0m
[30;1m607 | [0m[35m        expectedFields = ["source", "case_id", "email", "hostname", "flare_file"][0m
[30;1m608 | [0m[35m        missingFields = [k for k in expectedFields if k not in tracer_flare][0m
[30;1m609 | [0m[35m[0m
[30;1m610 | [0m[35m        if len(missingFields) == 0:[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1083 | [0m[35m            raise web.HTTPBadRequest(body=msg)[0m
[30;1m1084 | [0m[35m        else:[0m
[30;1m1085 | [0m[35m            token = request["session_token"][0m
[30;1m1086 | [0m[35m            # update trace_check results[0m
[30;1m1087 | [0m[35m            trace.update_results(self._trace_check_results_by_check[token])[0m
[30;1m1088 | [0m[35m            if trace.has_fails():[0m
[30;1m1089 | [0m[35m                # only save trace failures to memory if necessary[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1070 | [0m[35m        except AssertionError as e:[0m
[30;1m1071 | [0m[35m            token = request["session_token"][0m
[30;1m1072 | [0m[35m[0m
[30;1m1073 | [0m[35m            # update trace_check results[0m
[30;1m1074 | [0m[35m            trace.update_results(self._trace_check_results_by_check[token])[0m
[30;1m1075 | [0m[35m[0m
[30;1m1076 | [0m[35m            # only save trace failures to memory if necessary[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m656 | [0m[35m                    )[0m
[30;1m657 | [0m[35m                    + "\n"[0m
[30;1m658 | [0m[35m                )[0m
[30;1m659 | [0m[35m                # update seen integrations to skip this specific integration and version next loop f[0m
[30;1m660 | [0m[35m                seen_integrations.add(f"{integration.integration_name}@{integration.integration_vers[0m
[30;1m661 | [0m[35m                # given that we will mainly see one integration per call, set a header for the calli[0m
[30;1m662 | [0m[35m                # integration name[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m471 | [0m[35m        integration_requests: List[Request] = [][0m
[30;1m472 | [0m[35m        requests = self._requests if token is None else self._requests_by_session(token)[0m
[30;1m473 | [0m[35m        for req in requests:[0m
[30;1m474 | [0m[35m            # see if the request was to update with a newly tested integration[0m
[30;1m475 | [0m[35m            if req.match_info.handler == self.handle_put_tested_integrations:[0m
[30;1m476 | [0m[35m                if "integration" not in req:[0m
[30;1m477 | [0m[35m                    data = json.loads(await req.read())[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m235 | [0m[35m            "/evp_proxy/v2/api/v2/llmobs",[0m
[30;1m236 | [0m[35m        ][0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m        # Note that sessions are not cleared at any point since we don't know[0m
[30;1m239 | [0m[35m        # definitively when a session is over.[0m
[30;1m240 | [0m[35m        self._sessions: DefaultDict[Optional[str], _AgentSession] = defaultdict([0m
[30;1m241 | [0m[35m            lambda: _AgentSession(sample_rate_by_service_env={})[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m164 | [0m[35m    }[0m
[30;1m165 | [0m[35m    agent_url = request.app["agent_url"][0m
[30;1m166 | [0m[35m    full_agent_url = agent_url + request.path[0m
[30;1m167 | [0m[35m    log.info("Forwarding request to agent at %r", full_agent_url)[0m
[30;1m168 | [0m[35m    log.debug(f"Using headers: {headers}")[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m    (client_response, body) = await _forward_request(data, headers, full_agent_url)[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1018 | [0m[35m            env_vars = {[0m
[30;1m1019 | [0m[35m                key.strip(): value.strip() for key, value in (pair.split("=") for pair in var_string[0m
[30;1m1020 | [0m[35m            }[0m
[30;1m1021 | [0m[35m            log.debug("Found the following Datadog Trace Env Variables: " + str(env_vars))[0m
[30;1m1022 | [0m[35m            request["_dd_trace_env_variables"] = env_vars[0m
[30;1m1023 | [0m[35m[0m
[30;1m1024 | [0m[35m        if "X-Datadog-Agent-Proxy-Disabled" in headers:[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m740 | [0m[35m                    except ValueError:[0m
[30;1m741 | [0m[35m                        log.info("Chunk %d could not be displayed (might be incomplete).", i)[0m
[30;1m742 | [0m[35m[0m
[30;1m743 | [0m[35m                    # perform peer service check on span[0m
[30;1m744 | [0m[35m                    for span in trace:[0m
[30;1m745 | [0m[35m                        await checks.check([0m
[30;1m746 | [0m[35m                            "trace_peer_service", span=span, dd_config_env=request.get("_dd_trace_en[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m618 | [0m[35m        return web.HTTPOk()[0m
[30;1m619 | [0m[35m[0m
[30;1m620 | [0m[35m    async def handle_put_tested_integrations(self, request: Request) -> web.Response:[0m
[30;1m621 | [0m[35m        # we need to store the request manually since this is not a real DD agent endpoint[0m
[30;1m622 | [0m[35m        await self._store_request(request)[0m
[30;1m623 | [0m[35m        return web.HTTPOk()[0m
[30;1m624 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m438 | [0m[35m            if req.match_info.handler == self.handle_v2_apmtelemetry:[0m
[30;1m439 | [0m[35m                events.append(await v2_apmtelemetry_decode_request(req, await req.read()))[0m
[30;1m440 | [0m[35m[0m
[30;1m441 | [0m[35m        # TODO: Sort the events?[0m
[30;1m442 | [0m[35m        return events[0m
[30;1m443 | [0m[35m[0m
[30;1m444 | [0m[35m    async def _tracerflares_by_session(self, token: Optional[str]) -> List[TracerFlareEvent]:[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/agent.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport argparse[0m
[30;1m2 | [0m[35mimport atexit[0m
[30;1m3 | [0m[35mimport base64[0m
[30;1m4 | [0m[35mfrom collections import OrderedDict[0m
[30;1m5 | [0m[35mfrom collections import defaultdict[0m
[30;1m6 | [0m[35mfrom dataclasses import dataclass[0m
[30;1m7 | [0m[35mfrom dataclasses import field[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/tracerflare.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mfrom typing import Dict[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mfrom aiohttp import BodyPartReader[0m
[30;1m5 | [0m[35mfrom aiohttp import MultipartReader[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/tracestats_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m                b["Resource"],[0m
[30;1m28 | [0m[35m                b["Type"],[0m
[30;1m29 | [0m[35m                b.get("Synthetics"),[0m
[30;1m30 | [0m[35m                b.get("HTTPStatusCode"),[0m
[30;1m31 | [0m[35m                b["Hits"],[0m
[30;1m32 | [0m[35m            ),[0m
[30;1m33 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/tracestats_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m                b["Name"],[0m
[30;1m27 | [0m[35m                b["Resource"],[0m
[30;1m28 | [0m[35m                b["Type"],[0m
[30;1m29 | [0m[35m                b.get("Synthetics"),[0m
[30;1m30 | [0m[35m                b.get("HTTPStatusCode"),[0m
[30;1m31 | [0m[35m                b["Hits"],[0m
[30;1m32 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/tracestats_snapshot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35mdef snapshot(expected_stats: List[StatsBucket], received_stats: List[StatsBucket]) -> None:[0m
[30;1m43 | [0m[35m    # Normalize the stats buckets by making them independent of time. Only ordering matters.[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m    # Sort the buckets by start time.[0m
[30;1m46 | [0m[35m    normed_expected = _normalize_statsbuckets(expected_stats)[0m
[30;1m47 | [0m[35m    normed_received = _normalize_statsbuckets(received_stats)[0m
[30;1m48 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/tracestats_snapshot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    # Sort aggr for a bucket alphanumerically[0m
[30;1m21 | [0m[35m    for bucket in normed_buckets:[0m
[30;1m22 | [0m[35m        # Sort aggrs to get a consistent list of buckets, since order does not matter.[0m
[30;1m23 | [0m[35m        bucket["Stats"] = sorted([0m
[30;1m24 | [0m[35m            bucket["Stats"],[0m
[30;1m25 | [0m[35m            key=lambda b: ([0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/tracestats_snapshot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35m    # Order the buckets by time[0m
[30;1m18 | [0m[35m    normed_buckets = sorted(normed_buckets, key=lambda b: b["Start"])[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    # Sort aggr for a bucket alphanumerically[0m
[30;1m21 | [0m[35m    for bucket in normed_buckets:[0m
[30;1m22 | [0m[35m        # Sort aggrs to get a consistent list of buckets, since order does not matter.[0m
[30;1m23 | [0m[35m        bucket["Stats"] = sorted([0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/tracestats_snapshot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35m        bcopy["Stats"] = [aggr.copy() for aggr in bucket["Stats"]]  # Copy the aggregations[0m
[30;1m15 | [0m[35m        normed_buckets.append(bcopy)[0m
[30;1m16 | [0m[35m[0m
[30;1m17 | [0m[35m    # Order the buckets by time[0m
[30;1m18 | [0m[35m    normed_buckets = sorted(normed_buckets, key=lambda b: b["Start"])[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    # Sort aggr for a bucket alphanumerically[0m
[30;1m21 | [0m[35m    for bucket in normed_buckets:[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/tracestats_snapshot.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mdef _normalize_statsbuckets(buckets: List[StatsBucket]) -> List[StatsBucket]:[0m
[30;1m9 | [0m[35m    """Normalize the stats bucket by normalizing the time buckets."""[0m
[30;1m10 | [0m[35m    # Make a copy of the buckets, note that the sketches are not copied.[0m
[30;1m11 | [0m[35m    normed_buckets = [][0m
[30;1m12 | [0m[35m    for bucket in buckets:[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m311 | [0m[35m                data=v04_reference_http_trace_payload_data,[0m
[30;1m312 | [0m[35m            )[0m
[30;1m313 | [0m[35m        )[0m
[30;1m314 | [0m[35m        reqs.append(testagent.get(testagent_url + "/test/session/traces"))[0m
[30;1m315 | [0m[35m[0m
[30;1m316 | [0m[35m    resps = await asyncio.gather(*reqs)[0m
[30;1m317 | [0m[35m    for r in resps:[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m284 | [0m[35m    p = Profiler(url=testagent_url)[0m
[30;1m285 | [0m[35m    p.start()[0m
[30;1m286 | [0m[35m    p.stop(flush=True)[0m
[30;1m287 | [0m[35m    resp = await testagent.get(f"{testagent_url}/test/session/requests")[0m
[30;1m288 | [0m[35m    assert resp.status == 200[0m
[30;1m289 | [0m[35m    data = await resp.json()[0m
[30;1m290 | [0m[35m    assert len(data) >= 1[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m242 | [0m[35m    await testagent.get(f"{testagent_url}/test/session/start?test_session_token=test_trace_stats")[0m
[30;1m243 | [0m[35m    do_traces(stats_tracer)[0m
[30;1m244 | [0m[35m    stats_tracer.shutdown()  # force out the stats[0m
[30;1m245 | [0m[35m    resp = await testagent.get(f"{testagent_url}/test/session/snapshot?test_session_token=test_trace[0m
[30;1m246 | [0m[35m    if fail:[0m
[30;1m247 | [0m[35m        assert resp.status == 400[0m
[30;1m248 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m239 | [0m[35m    do_traces: Callable[[Tracer], None],[0m
[30;1m240 | [0m[35m    fail: bool,[0m
[30;1m241 | [0m[35m) -> None:[0m
[30;1m242 | [0m[35m    await testagent.get(f"{testagent_url}/test/session/start?test_session_token=test_trace_stats")[0m
[30;1m243 | [0m[35m    do_traces(stats_tracer)[0m
[30;1m244 | [0m[35m    stats_tracer.shutdown()  # force out the stats[0m
[30;1m245 | [0m[35m    resp = await testagent.get(f"{testagent_url}/test/session/snapshot?test_session_token=test_trace[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m    # Do another snapshot without sending any traces.[0m
[30;1m188 | [0m[35m    resp = await testagent.get(f"{testagent_url}/test/session/start?test_session_token=test_trace_mi[0m
[30;1m189 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m190 | [0m[35m    resp = await testagent.get(f"{testagent_url}/test/session/snapshot?test_session_token=test_trace[0m
[30;1m191 | [0m[35m    assert resp.status == 400[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m185 | [0m[35m    assert resp.status == 200[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m    # Do another snapshot without sending any traces.[0m
[30;1m188 | [0m[35m    resp = await testagent.get(f"{testagent_url}/test/session/start?test_session_token=test_trace_mi[0m
[30;1m189 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m190 | [0m[35m    resp = await testagent.get(f"{testagent_url}/test/session/snapshot?test_session_token=test_trace[0m
[30;1m191 | [0m[35m    assert resp.status == 400[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m        with tracer.trace("child0"):[0m
[30;1m182 | [0m[35m            pass[0m
[30;1m183 | [0m[35m    tracer.flush()[0m
[30;1m184 | [0m[35m    resp = await testagent.get(f"{testagent_url}/test/session/snapshot?test_session_token=test_trace[0m
[30;1m185 | [0m[35m    assert resp.status == 200[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m    # Do another snapshot without sending any traces.[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35masync def test_trace_missing_received(testagent_url, testagent, tracer):[0m
[30;1m177 | [0m[35m    resp = await testagent.get(f"{testagent_url}/test/session/start?test_session_token=test_trace_mi[0m
[30;1m178 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m    with tracer.trace("root0"):[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m166 | [0m[35m        with tracer.trace("child"):[0m
[30;1m167 | [0m[35m            pass[0m
[30;1m168 | [0m[35m    tracer.flush()[0m
[30;1m169 | [0m[35m    resp = await testagent.get([0m
[30;1m170 | [0m[35m        f"{testagent_url}/test/session/snapshot?test_session_token=test_trace_distributed_propagated[0m
[30;1m171 | [0m[35m    )[0m
[30;1m172 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35masync def test_trace_distributed_propagated(testagent_url, testagent, tracer):[0m
[30;1m157 | [0m[35m    await testagent.get(f"{testagent_url}/test/session/start?test_session_token=test_trace_distribut[0m
[30;1m158 | [0m[35m    headers = {[0m
[30;1m159 | [0m[35m        "x-datadog-trace-id": "1234",[0m
[30;1m160 | [0m[35m        "x-datadog-parent-id": "5678",[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m        with tracer.trace("child1"):[0m
[30;1m148 | [0m[35m            pass[0m
[30;1m149 | [0m[35m    tracer.flush()[0m
[30;1m150 | [0m[35m    resp = await testagent.get([0m
[30;1m151 | [0m[35m        f"{testagent_url}/test/session/snapshot?test_session_token=test_trace_distributed_same_paylo[0m
[30;1m152 | [0m[35m    )[0m
[30;1m153 | [0m[35m    assert resp.status == 200[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35masync def test_trace_distributed_same_payload(testagent_url, testagent, tracer):[0m
[30;1m140 | [0m[35m    await testagent.get(f"{testagent_url}/test/session/start?test_session_token=test_trace_distribut[0m
[30;1m141 | [0m[35m    with tracer.trace("root0"):[0m
[30;1m142 | [0m[35m        with tracer.trace("child0") as span:[0m
[30;1m143 | [0m[35m            ctx = span.context[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m131 | [0m[35m        with tracer.trace("child0"):[0m
[30;1m132 | [0m[35m            pass[0m
[30;1m133 | [0m[35m    tracer.flush()[0m
[30;1m134 | [0m[35m    resp = await testagent.get(f"{testagent_url}/test/session/snapshot?test_session_token=test_multi[0m
[30;1m135 | [0m[35m    assert resp.status == 400[0m
[30;1m136 | [0m[35m    tracer.shutdown()[0m
[30;1m137 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m126 | [0m[35m    assert resp.status == 200[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    # Simulate a failed snapshot with a missing trace.[0m
[30;1m129 | [0m[35m    await testagent.get(f"{testagent_url}/test/session/start?test_session_token=test_multi_trace")[0m
[30;1m130 | [0m[35m    with tracer.trace("root0"):[0m
[30;1m131 | [0m[35m        with tracer.trace("child0"):[0m
[30;1m132 | [0m[35m            pass[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m122 | [0m[35m        with tracer.trace("child1"):[0m
[30;1m123 | [0m[35m            pass[0m
[30;1m124 | [0m[35m    tracer.flush()[0m
[30;1m125 | [0m[35m    resp = await testagent.get(f"{testagent_url}/test/session/snapshot?test_session_token=test_multi[0m
[30;1m126 | [0m[35m    assert resp.status == 200[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    # Simulate a failed snapshot with a missing trace.[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m114 | [0m[35m    assert resp.status == 200[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m    # Run the snapshot test again.[0m
[30;1m117 | [0m[35m    await testagent.get(f"{testagent_url}/test/session/start?test_session_token=test_multi_trace")[0m
[30;1m118 | [0m[35m    with tracer.trace("root0"):[0m
[30;1m119 | [0m[35m        with tracer.trace("child0"):[0m
[30;1m120 | [0m[35m            pass[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m        with tracer.trace("child1"):[0m
[30;1m111 | [0m[35m            pass[0m
[30;1m112 | [0m[35m    tracer.flush()[0m
[30;1m113 | [0m[35m    resp = await testagent.get(f"{testagent_url}/test/session/snapshot?test_session_token=test_multi[0m
[30;1m114 | [0m[35m    assert resp.status == 200[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m    # Run the snapshot test again.[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35masync def test_multi_trace(testagent_url, testagent, tracer):[0m
[30;1m105 | [0m[35m    await testagent.get(f"{testagent_url}/test/session/start?test_session_token=test_multi_trace")[0m
[30;1m106 | [0m[35m    with tracer.trace("root0"):[0m
[30;1m107 | [0m[35m        with tracer.trace("child0"):[0m
[30;1m108 | [0m[35m            pass[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m        for k, v in metrics.items():[0m
[30;1m97 | [0m[35m            span.set_metric(k, v)[0m
[30;1m98 | [0m[35m    tracer.shutdown()[0m
[30;1m99 | [0m[35m    resp = await testagent.get(f"{testagent_url}/test/session/snapshot?test_session_token=test_singl[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m    assert resp.status == response_code[0m
[30;1m102 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m    metrics,[0m
[30;1m87 | [0m[35m    response_code,[0m
[30;1m88 | [0m[35m):[0m
[30;1m89 | [0m[35m    await testagent.get(f"{testagent_url}/test/session/start?test_session_token=test_single_trace")[0m
[30;1m90 | [0m[35m    tracer = Tracer(url=testagent_url)[0m
[30;1m91 | [0m[35m    with tracer.trace(operation_name, service=service, resource=resource, span_type=span_type) as sp[0m
[30;1m92 | [0m[35m        if error is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot_integration.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m254 | [0m[35m[0m
[30;1m255 | [0m[35m    Note that this test reuses the trace/snapshot from test_single_trace above.[0m
[30;1m256 | [0m[35m    """[0m
[30;1m257 | [0m[35m    env = os.environ.copy()[0m
[30;1m258 | [0m[35m    env["DD_TRACE_AGENT_URL"] = testagent_url[0m
[30;1m259 | [0m[35m    p = subprocess.run([0m
[30;1m260 | [0m[35m        ["ddapm-test-agent-session-start", "--test-session-token=test_single_trace"],[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/releasenotes/notes/Checks-changed-to-opt-in-8716cac4ecdbb1c2.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m6 | [0m[35mupgrade:[0m
[30;1m7 | [0m[35m  - |[0m
[30;1m8 | [0m[35m    Checks have been changed to opt-in. In order to maintain current[0m
[30;1m9 | [0m[35m    functionality users should update either their command or their [0m
[30;1m10 | [0m[35m    environment. [0m
[30;1m11 | [0m[35m    `ENABLED_CHECKS=trace_count_header,meta_tracer_version_header,trace_content_length`[0m
[30;1m12 | [0m[35m    or[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/releasenotes/notes/tracestats-service-2a0a178cbd21b07d.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m---[0m
[30;1m2 | [0m[35mfixes:[0m
[30;1m3 | [0m[35m  - |[0m
[30;1m4 | [0m[35m    Decode service field in trace stats requests, it was previously omitted.[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/cmd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m        )[0m
[30;1m67 | [0m[35m        sys.exit(1)[0m
[30;1m68 | [0m[35m    url = yarl.URL(parsed_args.agent_url).with_path("/test/session/snapshot")[0m
[30;1m69 | [0m[35m    resp = requests.get(str(url), params={"test_session_token": parsed_args.test_session_token})[0m
[30;1m70 | [0m[35m    if resp.status_code != 200:[0m
[30;1m71 | [0m[35m        print(resp.text)[0m
[30;1m72 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/cmd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m    _add_token_arg(parser)[0m
[30;1m43 | [0m[35m    parsed_args = parser.parse_args(sys.argv[1:])[0m
[30;1m44 | [0m[35m    url = yarl.URL(parsed_args.agent_url).with_path("/test/session/start")[0m
[30;1m45 | [0m[35m    resp = requests.get(str(url), params={"test_session_token": parsed_args.test_session_token})[0m
[30;1m46 | [0m[35m    if resp.status_code != 200:[0m
[30;1m47 | [0m[35m        print(resp.text)[0m
[30;1m48 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/cmd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m        type=str,[0m
[30;1m24 | [0m[35m        default=os.environ.get([0m
[30;1m25 | [0m[35m            "DD_TRACE_AGENT_URL",[0m
[30;1m26 | [0m[35m            os.environ.get("DD_AGENT_URL", "http://localhost:8126"),[0m
[30;1m27 | [0m[35m        ),[0m
[30;1m28 | [0m[35m        help=("Test agent URL. Default is http://localhost:8126"),[0m
[30;1m29 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/cmd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m    parser.add_argument([0m
[30;1m22 | [0m[35m        "--agent-url",[0m
[30;1m23 | [0m[35m        type=str,[0m
[30;1m24 | [0m[35m        default=os.environ.get([0m
[30;1m25 | [0m[35m            "DD_TRACE_AGENT_URL",[0m
[30;1m26 | [0m[35m            os.environ.get("DD_AGENT_URL", "http://localhost:8126"),[0m
[30;1m27 | [0m[35m        ),[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/cmd.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m11 | [0m[35m    parser.add_argument([0m
[30;1m12 | [0m[35m        "--test-session-token",[0m
[30;1m13 | [0m[35m        type=str,[0m
[30;1m14 | [0m[35m        default=os.environ.get("TEST_SESSION_TOKEN"),[0m
[30;1m15 | [0m[35m        help="Test session token to query with.",[0m
[30;1m16 | [0m[35m    )[0m
[30;1m17 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m445 | [0m[35m    resp = await agent.post("/evp_proxy/v2/api/v2/llmobs", data='{"key": "value"}')[0m
[30;1m446 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m447 | [0m[35m[0m
[30;1m448 | [0m[35m    resp = await agent.get("/test/session/requests")[0m
[30;1m449 | [0m[35m    assert resp.status == 200[0m
[30;1m450 | [0m[35m    reqs = await resp.json()[0m
[30;1m451 | [0m[35m    assert len(reqs) == 1[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m442 | [0m[35m[0m
[30;1m443 | [0m[35m[0m
[30;1m444 | [0m[35masync def test_evp_proxy_v2_api_v2_llmobs(agent):[0m
[30;1m445 | [0m[35m    resp = await agent.post("/evp_proxy/v2/api/v2/llmobs", data='{"key": "value"}')[0m
[30;1m446 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m447 | [0m[35m[0m
[30;1m448 | [0m[35m    resp = await agent.get("/test/session/requests")[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m430 | [0m[35masync def test_post_unknown_settings([0m
[30;1m431 | [0m[35m    agent,[0m
[30;1m432 | [0m[35m):[0m
[30;1m433 | [0m[35m    resp = await agent.post([0m
[30;1m434 | [0m[35m        "/test/settings",[0m
[30;1m435 | [0m[35m        data='{ "dummy_setting": 5 }',[0m
[30;1m436 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m418 | [0m[35m    assert resp.status == 202, await resp.text()[0m
[30;1m419 | [0m[35m    assert agent.app["trace_request_delay"] == 5[0m
[30;1m420 | [0m[35m[0m
[30;1m421 | [0m[35m    resp = await agent.post([0m
[30;1m422 | [0m[35m        "/test/settings",[0m
[30;1m423 | [0m[35m        data='{ "trace_request_delay": 0 }',[0m
[30;1m424 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m410 | [0m[35m[0m
[30;1m411 | [0m[35m[0m
[30;1m412 | [0m[35masync def test_post_known_settings(agent):[0m
[30;1m413 | [0m[35m    resp = await agent.post([0m
[30;1m414 | [0m[35m        "/test/settings",[0m
[30;1m415 | [0m[35m        data='{ "trace_request_delay": 5 }',[0m
[30;1m416 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m368 | [0m[35m    )[0m
[30;1m369 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m370 | [0m[35m[0m
[30;1m371 | [0m[35m    resp = await agent.get("/test/integrations/tested_versions")[0m
[30;1m372 | [0m[35m    assert resp.status == 200[0m
[30;1m373 | [0m[35m[0m
[30;1m374 | [0m[35m    text = await resp.text()[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m340 | [0m[35m    )[0m
[30;1m341 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m342 | [0m[35m[0m
[30;1m343 | [0m[35m    resp = await agent.get("/test/integrations/tested_versions")[0m
[30;1m344 | [0m[35m    assert resp.status == 200[0m
[30;1m345 | [0m[35m[0m
[30;1m346 | [0m[35m    text = await resp.text()[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m325 | [0m[35m    response = await agent.get("/test/trace_check/clear?clear_all=true")[0m
[30;1m326 | [0m[35m    assert response.status == 200[0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m    response = await agent.get("/test/trace_check/summary?return_all=true&use_json=true")[0m
[30;1m329 | [0m[35m    assert response.status == 200[0m
[30;1m330 | [0m[35m    assert await response.json() == {}[0m
[30;1m331 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m322 | [0m[35m    assert resp.keys() == results.keys()[0m
[30;1m323 | [0m[35m    assert len(resp["trace_count_header"]) == 2[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m    response = await agent.get("/test/trace_check/clear?clear_all=true")[0m
[30;1m326 | [0m[35m    assert response.status == 200[0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m    response = await agent.get("/test/trace_check/summary?return_all=true&use_json=true")[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m316 | [0m[35m    response = await agent.get("/test/trace_check/clear?test_session_token=other")[0m
[30;1m317 | [0m[35m    assert response.status == 200[0m
[30;1m318 | [0m[35m[0m
[30;1m319 | [0m[35m    response = await agent.get("/test/trace_check/failures?return_all=true&use_json=true")[0m
[30;1m320 | [0m[35m    assert response.status == 400[0m
[30;1m321 | [0m[35m    resp = await response.json()[0m
[30;1m322 | [0m[35m    assert resp.keys() == results.keys()[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m313 | [0m[35m    assert resp.keys() == results.keys()[0m
[30;1m314 | [0m[35m    assert len(resp["trace_count_header"]) == 4[0m
[30;1m315 | [0m[35m[0m
[30;1m316 | [0m[35m    response = await agent.get("/test/trace_check/clear?test_session_token=other")[0m
[30;1m317 | [0m[35m    assert response.status == 200[0m
[30;1m318 | [0m[35m[0m
[30;1m319 | [0m[35m    response = await agent.get("/test/trace_check/failures?return_all=true&use_json=true")[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m307 | [0m[35m        data=v04_reference_http_trace_payload_data,[0m
[30;1m308 | [0m[35m    )[0m
[30;1m309 | [0m[35m[0m
[30;1m310 | [0m[35m    response = await agent.get("/test/trace_check/failures?return_all=true&use_json=true")[0m
[30;1m311 | [0m[35m    assert response.status == 400[0m
[30;1m312 | [0m[35m    resp = await response.json()[0m
[30;1m313 | [0m[35m    assert resp.keys() == results.keys()[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m261 | [0m[35m    response = await agent.get("/test/trace_check/clear?clear_all=true")[0m
[30;1m262 | [0m[35m    assert response.status == 200[0m
[30;1m263 | [0m[35m[0m
[30;1m264 | [0m[35m    response = await agent.get("/test/trace_check/summary?return_all=true")[0m
[30;1m265 | [0m[35m    assert response.status == 200[0m
[30;1m266 | [0m[35m    response_json = await response.json()[0m
[30;1m267 | [0m[35m    assert response_json == {}[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m258 | [0m[35m    response_json = await response.json()[0m
[30;1m259 | [0m[35m    assert response_json["trace_count_header"]["Failed_Checks"] == 2[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m    response = await agent.get("/test/trace_check/clear?clear_all=true")[0m
[30;1m262 | [0m[35m    assert response.status == 200[0m
[30;1m263 | [0m[35m[0m
[30;1m264 | [0m[35m    response = await agent.get("/test/trace_check/summary?return_all=true")[0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m253 | [0m[35m    response = await agent.get("/test/trace_check/clear?test_session_token=other")[0m
[30;1m254 | [0m[35m    assert response.status == 200[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m    response = await agent.get("/test/trace_check/summary?return_all=true")[0m
[30;1m257 | [0m[35m    assert response.status == 200[0m
[30;1m258 | [0m[35m    response_json = await response.json()[0m
[30;1m259 | [0m[35m    assert response_json["trace_count_header"]["Failed_Checks"] == 2[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m250 | [0m[35m    assert response.status == 200[0m
[30;1m251 | [0m[35m    assert await response.json() == expected_output[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m    response = await agent.get("/test/trace_check/clear?test_session_token=other")[0m
[30;1m254 | [0m[35m    assert response.status == 200[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m    response = await agent.get("/test/trace_check/summary?return_all=true")[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m246 | [0m[35m    assert response.status == 200[0m
[30;1m247 | [0m[35m    assert await response.json() == expected_output[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m    response = await agent.get("/test/trace_check/summary?return_all=true")[0m
[30;1m250 | [0m[35m    assert response.status == 200[0m
[30;1m251 | [0m[35m    assert await response.json() == expected_output[0m
[30;1m252 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m242 | [0m[35m        data=v04_reference_http_trace_payload_data,[0m
[30;1m243 | [0m[35m    )[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m    response = await agent.get("/test/trace_check/summary?return_all=true")[0m
[30;1m246 | [0m[35m    assert response.status == 200[0m
[30;1m247 | [0m[35m    assert await response.json() == expected_output[0m
[30;1m248 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m        headers=v04_reference_http_trace_payload_headers,[0m
[30;1m203 | [0m[35m        data=v04_reference_http_trace_payload_data,[0m
[30;1m204 | [0m[35m    )[0m
[30;1m205 | [0m[35m    response = await agent.get([0m
[30;1m206 | [0m[35m        "/test/trace_check/summary?return_all=false", headers={"X-Datadog-Test-Session-Token": "toke[0m
[30;1m207 | [0m[35m    )[0m
[30;1m208 | [0m[35m    assert response.status == 200[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m188 | [0m[35m        headers=v04_reference_http_trace_payload_headers,[0m
[30;1m189 | [0m[35m        data=v04_reference_http_trace_payload_data,[0m
[30;1m190 | [0m[35m    )[0m
[30;1m191 | [0m[35m    response = await agent.get("/test/trace_check/summary", headers={"X-Datadog-Test-Session-Token":[0m
[30;1m192 | [0m[35m    assert response.status == 200[0m
[30;1m193 | [0m[35m    assert await response.json() == expected_output[0m
[30;1m194 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m        data=v04_reference_http_trace_payload_data,[0m
[30;1m164 | [0m[35m    )[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m    response = await agent.get("/test/trace_check/summary?return_all=true")[0m
[30;1m167 | [0m[35m    assert response.status == 200[0m
[30;1m168 | [0m[35m    assert await response.json() == expected_output[0m
[30;1m169 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35m    resp = await agent.get("/test/session/clear")[0m
[30;1m130 | [0m[35m    assert resp.status == 200[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m    resp = await agent.get([0m
[30;1m133 | [0m[35m        "/test/apmtelemetry",[0m
[30;1m134 | [0m[35m        params={"runtime_ids": "e81ece6d-7813-47f2-8337-d342f69626bb"},[0m
[30;1m135 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m126 | [0m[35m    assert resp.status == 200[0m
[30;1m127 | [0m[35m    assert json.loads(await resp.text()) == [v2_reference_http_apmtelemetry_payload_data_raw][0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m    resp = await agent.get("/test/session/clear")[0m
[30;1m130 | [0m[35m    assert resp.status == 200[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m    resp = await agent.get([0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m122 | [0m[35m    assert resp.status == 200[0m
[30;1m123 | [0m[35m    assert json.loads(await resp.text()) == [v2_reference_http_apmtelemetry_payload_data_raw][0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    resp = await agent.get("/test/apmtelemetry")[0m
[30;1m126 | [0m[35m    assert resp.status == 200[0m
[30;1m127 | [0m[35m    assert json.loads(await resp.text()) == [v2_reference_http_apmtelemetry_payload_data_raw][0m
[30;1m128 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m    rid = v2_reference_http_apmtelemetry_payload_data_raw["runtime_id"][0m
[30;1m121 | [0m[35m    resp = await agent.get("/test/apmtelemetry", params={"runtime_ids": rid})[0m
[30;1m122 | [0m[35m    assert resp.status == 200[0m
[30;1m123 | [0m[35m    assert json.loads(await resp.text()) == [v2_reference_http_apmtelemetry_payload_data_raw][0m
[30;1m124 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m    v2_reference_http_apmtelemetry_payload_data_raw,[0m
[30;1m111 | [0m[35m    v2_reference_http_apmtelemetry_payload_data,[0m
[30;1m112 | [0m[35m):[0m
[30;1m113 | [0m[35m    resp = await agent.post([0m
[30;1m114 | [0m[35m        "/telemetry/proxy/api/v2/apmtelemetry",[0m
[30;1m115 | [0m[35m        headers=v2_reference_http_apmtelemetry_payload_headers,[0m
[30;1m116 | [0m[35m        data=v2_reference_http_apmtelemetry_payload_data,[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35masync def test_info(agent):[0m
[30;1m82 | [0m[35m    resp = await agent.get("/info")[0m
[30;1m83 | [0m[35m    assert resp.status == 200[0m
[30;1m84 | [0m[35m    assert await resp.json() == {[0m
[30;1m85 | [0m[35m        "version": "test",[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m    v04_reference_http_trace_payload_data,[0m
[30;1m64 | [0m[35m):[0m
[30;1m65 | [0m[35m    agent_rates = {"service:test,env:staging": 0.5}[0m
[30;1m66 | [0m[35m    resp = await agent.get([0m
[30;1m67 | [0m[35m        "/test/session/start",[0m
[30;1m68 | [0m[35m        params={"test_session_token": "1", "agent_sample_rate_by_service": json.dumps(agent_rates)},[0m
[30;1m69 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m    resp = await agent.get("/test/session/clear", params={"test_session_token": "1"})[0m
[30;1m53 | [0m[35m    assert resp.status == 200[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    resp = await agent.get("/test/traces", params={"trace_ids": "123456"})[0m
[30;1m56 | [0m[35m    assert resp.status == 200[0m
[30;1m57 | [0m[35m    assert await resp.text() == "[[]]"[0m
[30;1m58 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m    )[0m
[30;1m50 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m    resp = await agent.get("/test/session/clear", params={"test_session_token": "1"})[0m
[30;1m53 | [0m[35m    assert resp.status == 200[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    resp = await agent.get("/test/traces", params={"trace_ids": "123456"})[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m    resp = await agent.get("/test/session/clear")[0m
[30;1m32 | [0m[35m    assert resp.status == 200[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    resp = await agent.get("/test/traces", params={"trace_ids": "123456"})[0m
[30;1m35 | [0m[35m    assert resp.status == 200[0m
[30;1m36 | [0m[35m    assert await resp.text() == "[[]]"[0m
[30;1m37 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m    assert resp.status == 200[0m
[30;1m29 | [0m[35m    assert json.loads(await resp.text()) == v04_reference_http_trace_payload_data_raw[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m    resp = await agent.get("/test/session/clear")[0m
[30;1m32 | [0m[35m    assert resp.status == 200[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    resp = await agent.get("/test/traces", params={"trace_ids": "123456"})[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m24 | [0m[35m    resp = await agent.get("/test/traces", params={"trace_ids": str(tid)})[0m
[30;1m25 | [0m[35m    assert resp.status == 200[0m
[30;1m26 | [0m[35m    assert json.loads(await resp.text()) == v04_reference_http_trace_payload_data_raw[0m
[30;1m27 | [0m[35m    resp = await agent.get("/test/traces")[0m
[30;1m28 | [0m[35m    assert resp.status == 200[0m
[30;1m29 | [0m[35m    assert json.loads(await resp.text()) == v04_reference_http_trace_payload_data_raw[0m
[30;1m30 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35m    tid = trace_id(v04_reference_http_trace_payload_data_raw[0])[0m
[30;1m24 | [0m[35m    resp = await agent.get("/test/traces", params={"trace_ids": str(tid)})[0m
[30;1m25 | [0m[35m    assert resp.status == 200[0m
[30;1m26 | [0m[35m    assert json.loads(await resp.text()) == v04_reference_http_trace_payload_data_raw[0m
[30;1m27 | [0m[35m    resp = await agent.get("/test/traces")[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m  | [0m[35m, deflate',\n     'Content-Length': '371',\n     'Content-Type': 'application/msgpack',\n     'Datad[0m
[30;1m  | [0m[35m        ][0m
[30;1m  | [0m[35m    }[0m
[30;1m  | [0m[35m    await agent.put([0m
[30;1m  | [0m[35m        "/v0.4/traces",[0m
[30;1m  | [0m[35m        headers=v04_reference_http_trace_payload_headers,[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m  | [0m[35mttp/3.8.4',\n     'X-Datadog-Test-Session-Token': 'other',\n     'X-Datadog-Trace-Count': '2'}\n    [0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m  | [0m[35mp, deflate',\n     'Content-Length': '371',\n     'Content-Type': 'application/msgpack',\n     'Data[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m  | [0m[35mttp/3.8.4',\n     'X-Datadog-Test-Session-Token': 'other',\n     'X-Datadog-Trace-Count': '2'}\n    [0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m  | [0m[35mp, deflate',\n     'Content-Length': '371',\n     'Content-Type': 'application/msgpack',\n     'Data[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m  | [0m[35m.0.1:.*',\n     'User-Agent': 'Python/3.11 aiohttp/3.8.4',\n     'X-Datadog-Trace-Count': '2'}\n    [0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m  | [0m[35m{'Accept': '*/*',\n     'Accept-Encoding': 'gzip, deflate',\n     'Content-Length': '371',\n     'Co[0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m  | [0m[35mit response.json()[0m
[30;1m  | [0m[35m    assert response_json == {}[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35m[0m
[30;1m  | [0m[35masync def test_get_trace_failures_and_clear_json([0m
[30;1m  | [0m[35m    agent, v04_reference_http_trace_payload_data, v04_reference_http_trace_payload_headers[0m
[30;1m  | [0m[35m):[0m
[30;1m  | [0m[35m    results = {[0m
[30;1m  | [0m[35m        "trace_count_header": [[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m380 | [0m[35m[0m
[30;1m381 | [0m[35m[0m
[30;1m382 | [0m[35mdef test_uds(tmp_path, available_port):[0m
[30;1m383 | [0m[35m    env = os.environ.copy()[0m
[30;1m384 | [0m[35m    env["DD_APM_RECEIVER_SOCKET"] = str(tmp_path / "apm.socket")[0m
[30;1m385 | [0m[35m    env["PORT"] = str(available_port)[0m
[30;1m386 | [0m[35m    p = subprocess.Popen(["ddapm-test-agent"], env=env)[0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_agent.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35mimport signal[0m
[30;1m4 | [0m[35mimport subprocess[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mfrom ddapm_test_agent.trace import trace_id[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m348 | [0m[35m        cmap[parent_id] = [][0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m    for s in trace:[0m
[30;1m351 | [0m[35m        parent_id = s.get("parent_id") or 0[0m
[30;1m352 | [0m[35m        cmap[parent_id].append(s)[0m
[30;1m353 | [0m[35m[0m
[30;1m354 | [0m[35m    # Sort the children ascending by their start time, else by their span_id[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m344 | [0m[35m    # Initialize the map with all possible ids[0m
[30;1m345 | [0m[35m    for s in trace:[0m
[30;1m346 | [0m[35m        cmap[s["span_id"]] = [][0m
[30;1m347 | [0m[35m        parent_id = s.get("parent_id") or 0[0m
[30;1m348 | [0m[35m        cmap[parent_id] = [][0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m    for s in trace:[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace.py[0m
   Pattern: [32m.hostname[0m
[30;1m685 | [0m[35m        chunks: List[TraceChunkV07][0m
[30;1m686 | [0m[35m        tags: NotRequired[Dict[str, str]][0m
[30;1m687 | [0m[35m        env: NotRequired[str][0m
[30;1m688 | [0m[35m        hostname: NotRequired[str][0m
[30;1m689 | [0m[35m        app_version: NotRequired[str][0m
[30;1m690 | [0m[35m[0m
[30;1m691 | [0m[35m    class TraceChunkV07(TypedDict):[0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m351 | [0m[35m        parent_id = s.get("parent_id") or 0[0m
[30;1m352 | [0m[35m        cmap[parent_id].append(s)[0m
[30;1m353 | [0m[35m[0m
[30;1m354 | [0m[35m    # Sort the children ascending by their start time, else by their span_id[0m
[30;1m355 | [0m[35m    for span_id in cmap:[0m
[30;1m356 | [0m[35m        cmap[span_id] = sorted(cmap[span_id], key=lambda _: (_["start"] if "start" in _ else _["span[0m
[30;1m357 | [0m[35m    return cmap[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/build-on-darwin.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35mRUN mkdir -p /output; mkdir -p /img[0m
[30;1m21 | [0m[35m# very simplistic way to unpack image - relies only on there being a single layer[0m
[30;1m22 | [0m[35mRUN tar -xf result --strip-components=1 -C /img [0m
[30;1m23 | [0m[35mRUN tar -xf /img/layer.tar -C /output[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mFROM scratch AS final[0m
[30;1m26 | [0m[35mCOPY --from=builder /output/ /[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/build-on-darwin.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35mRUN nix build .#image[0m
[30;1m20 | [0m[35mRUN mkdir -p /output; mkdir -p /img[0m
[30;1m21 | [0m[35m# very simplistic way to unpack image - relies only on there being a single layer[0m
[30;1m22 | [0m[35mRUN tar -xf result --strip-components=1 -C /img [0m
[30;1m23 | [0m[35mRUN tar -xf /img/layer.tar -C /output[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mFROM scratch AS final[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/build-on-darwin.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# simple hack to build the same image on OSX. otherwise the Nix docker build will by default not cro[0m
[30;1m2 | [0m[35m# in CI or on linux systems - use `nix build .#image | docker load -i result` instead[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mFROM nixos/nix AS builder[0m
[30;1m5 | [0m[35mRUN   set -xe; \[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/build-on-darwin.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# simple hack to build the same image on OSX. otherwise the Nix docker build will by default not cro[0m
[30;1m2 | [0m[35m# in CI or on linux systems - use `nix build .#image | docker load -i result` instead[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mFROM nixos/nix AS builder[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/releasenotes/notes/add-service-naming-checks-2b68ff51d1b5496d.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mfeatures:[0m
[30;1m3 | [0m[35m  - |[0m
[30;1m4 | [0m[35m    Adds two new Trace Checks for service naming and peer service. `trace_dd_service` check ensures [0m
[30;1m5 | [0m[35m    have a correctly configured service name according to the trace's Span Attribute Schema Version.[0m
[30;1m6 | [0m[35m    ensures the that the correct `peer.service` value is set for spans according to the supplied spa[0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/releasenotes/notes/add-service-naming-checks-2b68ff51d1b5496d.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m---[0m
[30;1m2 | [0m[35mfeatures:[0m
[30;1m3 | [0m[35m  - |[0m
[30;1m4 | [0m[35m    Adds two new Trace Checks for service naming and peer service. `trace_dd_service` check ensures [0m
[30;1m5 | [0m[35m    have a correctly configured service name according to the trace's Span Attribute Schema Version.[0m
[30;1m6 | [0m[35m    ensures the that the correct `peer.service` value is set for spans according to the supplied spa[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_checks.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m@pytest.mark.parametrize("agent_enabled_checks", ["trace_content_length"])[0m
[30;1m96 | [0m[35masync def test_trace_content_length(agent, agent_enabled_checks):[0m
[30;1m97 | [0m[35m    # Assume a trace will be at least 100 bytes each[0m
[30;1m98 | [0m[35m    s = span()[0m
[30;1m99 | [0m[35m    trace = [s for _ in range(int(5e7 / 100))][0m
[30;1m100 | [0m[35m    resp = await v04_trace(agent, [trace], "msgpack")[0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_checks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport pytest[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom .conftest import v04_trace[0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/releasenotes/notes/add-distributed-trace-c35a314698a3b966.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m---[0m
[30;1m2 | [0m[35mfeatures:[0m
[30;1m3 | [0m[35m  - |[0m
[30;1m4 | [0m[35m    Add support for distributed traces where an instrumented service sends a trace chunk where the r[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/releasenotes/check-releasenotes[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m#!/usr/bin/env bash[0m
[30;1m2 | [0m[35mset -e[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35m# If we are running outside a GitHub action, default to `master`[0m
[30;1m5 | [0m[35mBASE_REF="${GITHUB_BASE_REF:-master}"[0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/releasenotes/check-releasenotes[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35mfi[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m# Check if they added a new file to releasenotes/notes[0m
[30;1m21 | [0m[35mif git diff --name-only --diff-filter=A "origin/${BASE_REF}" | grep releasenotes/notes;[0m
[30;1m22 | [0m[35mthen[0m
[30;1m23 | [0m[35m    echo "New release note found, success"[0m
[30;1m24 | [0m[35m    exit 0[0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/releasenotes/check-releasenotes[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35mfi[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m# Check if they added a new file to releasenotes/notes[0m
[30;1m21 | [0m[35mif git diff --name-only --diff-filter=A "origin/${BASE_REF}" | grep releasenotes/notes;[0m
[30;1m22 | [0m[35mthen[0m
[30;1m23 | [0m[35m    echo "New release note found, success"[0m
[30;1m24 | [0m[35m    exit 0[0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/releasenotes/check-releasenotes[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m#!/usr/bin/env bash[0m
[30;1m2 | [0m[35mset -e[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35m# If we are running outside a GitHub action, default to `master`[0m
[30;1m5 | [0m[35mBASE_REF="${GITHUB_BASE_REF:-master}"[0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/releasenotes/notes/span-ordering-1a7b383aa015bddc.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mfeatures:[0m
[30;1m3 | [0m[35m  - |[0m
[30;1m4 | [0m[35m    Spans output in snapshots are now ordered to be more human readable with[0m
[30;1m5 | [0m[35m    the important attributes (name, service, resource) moved to the top of the[0m
[30;1m6 | [0m[35m    JSON object. This affects the output JSON but does not break existing[0m
[30;1m7 | [0m[35m    snapshots.[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/tracestats.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m    return v06StatsPayload([0m
[30;1m71 | [0m[35m        Hostname=payload.get("Hostname"),[0m
[30;1m72 | [0m[35m        Env=payload.get("Env"),[0m
[30;1m73 | [0m[35m        Version=payload.get("Version"),[0m
[30;1m74 | [0m[35m        Stats=stats_buckets,[0m
[30;1m75 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/tracestats.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    return v06StatsPayload([0m
[30;1m71 | [0m[35m        Hostname=payload.get("Hostname"),[0m
[30;1m72 | [0m[35m        Env=payload.get("Env"),[0m
[30;1m73 | [0m[35m        Version=payload.get("Version"),[0m
[30;1m74 | [0m[35m        Stats=stats_buckets,[0m
[30;1m75 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/tracestats.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m        stats_buckets.append(bucket)[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    return v06StatsPayload([0m
[30;1m71 | [0m[35m        Hostname=payload.get("Hostname"),[0m
[30;1m72 | [0m[35m        Env=payload.get("Env"),[0m
[30;1m73 | [0m[35m        Version=payload.get("Version"),[0m
[30;1m74 | [0m[35m        Stats=stats_buckets,[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/tracestats.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m                Resource=raw_stats["Resource"],[0m
[30;1m50 | [0m[35m                Service=raw_stats.get("Service"),[0m
[30;1m51 | [0m[35m                Type=raw_stats.get("Type"),[0m
[30;1m52 | [0m[35m                HTTPStatusCode=raw_stats.get("HTTPStatusCode"),[0m
[30;1m53 | [0m[35m                Synthetics=raw_stats["Synthetics"],[0m
[30;1m54 | [0m[35m                Hits=raw_stats["Hits"],[0m
[30;1m55 | [0m[35m                TopLevelHits=raw_stats["TopLevelHits"],[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/tracestats.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m                Name=raw_stats["Name"],[0m
[30;1m49 | [0m[35m                Resource=raw_stats["Resource"],[0m
[30;1m50 | [0m[35m                Service=raw_stats.get("Service"),[0m
[30;1m51 | [0m[35m                Type=raw_stats.get("Type"),[0m
[30;1m52 | [0m[35m                HTTPStatusCode=raw_stats.get("HTTPStatusCode"),[0m
[30;1m53 | [0m[35m                Synthetics=raw_stats["Synthetics"],[0m
[30;1m54 | [0m[35m                Hits=raw_stats["Hits"],[0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/tracestats.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m            stat = StatsAggr([0m
[30;1m48 | [0m[35m                Name=raw_stats["Name"],[0m
[30;1m49 | [0m[35m                Resource=raw_stats["Resource"],[0m
[30;1m50 | [0m[35m                Service=raw_stats.get("Service"),[0m
[30;1m51 | [0m[35m                Type=raw_stats.get("Type"),[0m
[30;1m52 | [0m[35m                HTTPStatusCode=raw_stats.get("HTTPStatusCode"),[0m
[30;1m53 | [0m[35m                Synthetics=raw_stats["Synthetics"],[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m474 | [0m[35m    "source": "...",[0m
[30;1m475 | [0m[35m    "case_id": "...",[0m
[30;1m476 | [0m[35m    "email": "...",[0m
[30;1m477 | [0m[35m    "hostname": "...",[0m
[30;1m478 | [0m[35m    "flare_file": "...",[0m
[30;1m479 | [0m[35m  }[0m
[30;1m480 | [0m[35m][0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m427 | [0m[35mcurl -X GET 'http://0.0.0.0:8126/test/trace_check/summary'[0m
[30;1m428 | [0m[35m```[0m
[30;1m429 | [0m[35m[0m
[30;1m430 | [0m[35m### /test/session/integrations (PUT)[0m
[30;1m431 | [0m[35mUpdate information about the current tested integration.[0m
[30;1m432 | [0m[35m[0m
[30;1m433 | [0m[35m#### [optional] `?test_session_token=`[0m
[30;1m434 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m214 | [0m[35mtem.process_id,meta.runtime-id"`]: The[0m
[30;1m215 | [0m[35m  attributes to ignore when comparing spans in snapshots.[0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35m- `DD_AGENT_URL` [`""`]: URL to a Datadog agent. When provided requests will be proxied to the agent[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m- `DD_APM_RECEIVER_SOCKET` [`""`]: When provided, the test agent will listen for traces on a socket [0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m- `DD_SUPPRESS_TRACE_PARSE_ERRORS` [`false`]: Set to `"true"` to disable span parse errors when deco[0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m`ddapm-test-agent-fmt` is a command line tool to format or lint snapshot json files.[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m``` bash[0m
[30;1m187 | [0m[35m# Format all snapshot json files[0m
[30;1m188 | [0m[35mddapm-test-agent-fmt path/to/snapshots[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m# Lint snapshot json files[0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m132 | [0m[35mThis is enabled by passing the agent url to the test agent either via the `--agent-url` command-line[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35mWhen proxying is enabled, the response from the Datadog agent will be returned instead of one from t[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35mAt the trace-level, proxying can also be disabled by including the `X-Datadog-Agent-Proxy-Disabled` [0m
[30;1m137 | [0m[35mis handled, regardless of whether an agent URL is set.[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m564 | [0m[35m[0m
[30;1m565 | [0m[35m1. Checkout the `master` branch and make sure it's up to date.[0m
[30;1m566 | [0m[35m```bash[0m
[30;1m567 | [0m[35m    git checkout master && git pull[0m
[30;1m568 | [0m[35m```[0m
[30;1m569 | [0m[35m2. Generate the release notes and use [`pandoc`](https://pandoc.org/) to format[0m
[30;1m570 | [0m[35mthem for Github:[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m564 | [0m[35m[0m
[30;1m565 | [0m[35m1. Checkout the `master` branch and make sure it's up to date.[0m
[30;1m566 | [0m[35m```bash[0m
[30;1m567 | [0m[35m    git checkout master && git pull[0m
[30;1m568 | [0m[35m```[0m
[30;1m569 | [0m[35m2. Generate the release notes and use [`pandoc`](https://pandoc.org/) to format[0m
[30;1m570 | [0m[35mthem for Github:[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m541 | [0m[35m[0m
[30;1m542 | [0m[35mRun the tagged image:[0m
[30;1m543 | [0m[35m[0m
[30;1m544 | [0m[35m```bash[0m
[30;1m545 | [0m[35mdocker run --rm -v ${PWD}/snaps:/snapshots --publish 8126:8126 agent[0m
[30;1m546 | [0m[35m```[0m
[30;1m547 | [0m[35m[0m
[30;1m548 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m535 | [0m[35m[0m
[30;1m536 | [0m[35mTo build (and tag) the dockerfile:[0m
[30;1m537 | [0m[35m[0m
[30;1m538 | [0m[35m```bash[0m
[30;1m539 | [0m[35mdocker build --tag testagent .[0m
[30;1m540 | [0m[35m```[0m
[30;1m541 | [0m[35m[0m
[30;1m542 | [0m[35mRun the tagged image:[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m531 | [0m[35m    riot run -s fmt[0m
[30;1m532 | [0m[35m    riot run -s mypy[0m
[30;1m533 | [0m[35m[0m
[30;1m534 | [0m[35m### Docker[0m
[30;1m535 | [0m[35m[0m
[30;1m536 | [0m[35mTo build (and tag) the dockerfile:[0m
[30;1m537 | [0m[35m[0m
[30;1m538 | [0m[35m```bash[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m528 | [0m[35mTo lint, format and type-check the code:[0m
[30;1m529 | [0m[35m[0m
[30;1m530 | [0m[35m    riot run -s flake8[0m
[30;1m531 | [0m[35m    riot run -s fmt[0m
[30;1m532 | [0m[35m    riot run -s mypy[0m
[30;1m533 | [0m[35m[0m
[30;1m534 | [0m[35m### Docker[0m
[30;1m535 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m509 | [0m[35m[0m
[30;1m510 | [0m[35m    python3.12 -m venv .venv[0m
[30;1m511 | [0m[35m    source .venv/bin/activate[0m
[30;1m512 | [0m[35m    pip install -e '.[testing]'[0m
[30;1m513 | [0m[35m[0m
[30;1m514 | [0m[35m[0m
[30;1m515 | [0m[35m### Running the tests[0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m496 | [0m[35mSupported keys:[0m
[30;1m497 | [0m[35m - `trace_request_delay`: sets a delay to apply to trace and telemetry requests[0m
[30;1m498 | [0m[35m[0m
[30;1m499 | [0m[35m ```[0m
[30;1m500 | [0m[35mcurl -X POST 'http://0.0.0.0:8126/test/settings' -d '{ "trace_request_delay": 5 }'[0m
[30;1m501 | [0m[35m```[0m
[30;1m502 | [0m[35m[0m
[30;1m503 | [0m[35m## Development[0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m480 | [0m[35m][0m
[30;1m481 | [0m[35m```[0m
[30;1m482 | [0m[35m[0m
[30;1m483 | [0m[35m`flare_file` is the base64 encoded content of the tracer-flare payload.[0m
[30;1m484 | [0m[35m[0m
[30;1m485 | [0m[35mIf there was an error parsing the tracer-flare form, that will be recorded under `error`.[0m
[30;1m486 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m445 | [0m[35m#### [optional] `?test_session_token=`[0m
[30;1m446 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m
[30;1m447 | [0m[35m[0m
[30;1m448 | [0m[35m```[0m
[30;1m449 | [0m[35mcurl -X GET 'http://0.0.0.0:8126/test/integrations/tested_versions'[0m
[30;1m450 | [0m[35m```[0m
[30;1m451 | [0m[35m[0m
[30;1m452 | [0m[35m### /v0.1/pipeline_stats[0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m433 | [0m[35m#### [optional] `?test_session_token=`[0m
[30;1m434 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m
[30;1m435 | [0m[35m[0m
[30;1m436 | [0m[35m```[0m
[30;1m437 | [0m[35mcurl -X PUT 'http://0.0.0.0:8126/test/session/integrations' -d '{"integration_name": [INTEGRATION_NA[0m
[30;1m438 | [0m[35m"dependency_name": [DEPENDENCY_NAME], "tracer_language": [TRACER_LANGUAGE], "tracer_version": [TRACE[0m
[30;1m439 | [0m[35m```[0m
[30;1m440 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m423 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m
[30;1m424 | [0m[35m#### [optional] `?return_all=`[0m
[30;1m425 | [0m[35m[0m
[30;1m426 | [0m[35m```[0m
[30;1m427 | [0m[35mcurl -X GET 'http://0.0.0.0:8126/test/trace_check/summary'[0m
[30;1m428 | [0m[35m```[0m
[30;1m429 | [0m[35m[0m
[30;1m430 | [0m[35m### /test/session/integrations (PUT)[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m403 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m
[30;1m404 | [0m[35m#### [optional] `?clear_all=`[0m
[30;1m405 | [0m[35m[0m
[30;1m406 | [0m[35m```[0m
[30;1m407 | [0m[35mcurl -X GET 'http://0.0.0.0:8126/test/trace_check/clear'[0m
[30;1m408 | [0m[35m```[0m
[30;1m409 | [0m[35m[0m
[30;1m410 | [0m[35m### /test/trace_check/summary (GET)[0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m392 | [0m[35m#### [optional] `?use_json=`[0m
[30;1m393 | [0m[35m#### [optional] `?return_all=`[0m
[30;1m394 | [0m[35m[0m
[30;1m395 | [0m[35m```[0m
[30;1m396 | [0m[35mcurl -X GET 'http://0.0.0.0:8126/test/trace_check/failures'[0m
[30;1m397 | [0m[35m```[0m
[30;1m398 | [0m[35m[0m
[30;1m399 | [0m[35m### /test/trace_check/clear (GET)[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m372 | [0m[35m#### [optional] `?test_session_token=`[0m
[30;1m373 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m
[30;1m374 | [0m[35m[0m
[30;1m375 | [0m[35m```[0m
[30;1m376 | [0m[35mcurl -X POST 'http://0.0.0.0:8126/test/session/responses/config/path' -d '{"path": "datadog/2/ASM_DA[0m
[30;1m377 | [0m[35m```[0m
[30;1m378 | [0m[35m[0m
[30;1m379 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m359 | [0m[35m#### [optional] `?test_session_token=`[0m
[30;1m360 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m
[30;1m361 | [0m[35m[0m
[30;1m362 | [0m[35m```[0m
[30;1m363 | [0m[35mcurl -X POST 'http://0.0.0.0:8126/test/session/responses/config/path' -d '{"roots": ["eyJ....fX0="],[0m
[30;1m364 | [0m[35m```[0m
[30;1m365 | [0m[35m[0m
[30;1m366 | [0m[35m### /test/session/responses/config/path (POST)[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m334 | [0m[35m][0m
[30;1m335 | [0m[35m```[0m
[30;1m336 | [0m[35m[0m
[30;1m337 | [0m[35m`body` is a base64 encoded body of the request.[0m
[30;1m338 | [0m[35m[0m
[30;1m339 | [0m[35m### /test/session/traces[0m
[30;1m340 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m- `DD_POOL_TRACE_CHECK_FAILURES` [`false`]: Set to `"true"` to pool Trace Check failures that occure[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m- `DD_DISABLE_ERROR_RESPONSES` [`false`]: Set to `"true"` to disable Test-Agent `<Response 400>` whe[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m## HTTP API[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m`ddapm-test-agent-fmt` is a command line tool to format or lint snapshot json files.[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m``` bash[0m
[30;1m187 | [0m[35m# Format all snapshot json files[0m
[30;1m188 | [0m[35mddapm-test-agent-fmt path/to/snapshots[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m# Lint snapshot json files[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35mor a specific branch:[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    pip install git+https://github.com/Datadog/dd-apm-test-agent@{branch}[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m## Features[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35mor from source:[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    pip install git+https://github.com/Datadog/dd-apm-test-agent[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35mor a specific branch:[0m
[30;1m85 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35mor from Docker:[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    # Run the test agent and mount the snapshot directory[0m
[30;1m74 | [0m[35m    docker run --rm\[0m
[30;1m75 | [0m[35m            -p 8126:8126\[0m
[30;1m76 | [0m[35m            -e SNAPSHOT_CI=0\[0m
[30;1m77 | [0m[35m            -v $PWD/tests/snapshots:/snapshots\[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35mor from Docker:[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    # Run the test agent and mount the snapshot directory[0m
[30;1m74 | [0m[35m    docker run --rm\[0m
[30;1m75 | [0m[35m            -p 8126:8126\[0m
[30;1m76 | [0m[35m            -e SNAPSHOT_CI=0\[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35mThe test agent can be installed from PyPI:[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m    pip install ddapm-test-agent[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    ddapm-test-agent --port=8126[0m
[30;1m70 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_trace.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m    root = root_span(t)[0m
[30;1m29 | [0m[35m    assert root[0m
[30;1m30 | [0m[35m    assert root.get("trace_id") == trace_id[0m
[30;1m31 | [0m[35m    assert root.get("parent_id") == parent_id[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m@pytest.mark.parametrize([0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_trace.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m    t = random_trace(10, trace_id=trace_id, parent_id=parent_id)[0m
[30;1m28 | [0m[35m    root = root_span(t)[0m
[30;1m29 | [0m[35m    assert root[0m
[30;1m30 | [0m[35m    assert root.get("trace_id") == trace_id[0m
[30;1m31 | [0m[35m    assert root.get("parent_id") == parent_id[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/fmt.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m    parser.add_argument([0m
[30;1m55 | [0m[35m        "--log-level",[0m
[30;1m56 | [0m[35m        type=str,[0m
[30;1m57 | [0m[35m        default=os.environ.get("LOG_LEVEL", "INFO"),[0m
[30;1m58 | [0m[35m        help="Set the log level. DEBUG, INFO, WARNING, ERROR, CRITICAL.",[0m
[30;1m59 | [0m[35m    )[0m
[30;1m60 | [0m[35m    parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/fmt.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m72 | [0m[35m        print(_get_version())[0m
[30;1m73 | [0m[35m        sys.exit(0)[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    # Find all json files[0m
[30;1m76 | [0m[35m    resolved_files = _resolve_files(parsed_args.files)[0m
[30;1m77 | [0m[35m    log.info("Found %d snapshot files to process", len(resolved_files))[0m
[30;1m78 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m165 | [0m[35m    resp = await rc_agent.post("/v0.7/config")[0m
[30;1m166 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m    resp = await rc_agent.get("/test/session/requests")[0m
[30;1m169 | [0m[35m    content = await resp.json()[0m
[30;1m170 | [0m[35m    assert resp.status == 200, content[0m
[30;1m171 | [0m[35m    assert len(content) == 1[0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35masync def test_remoteconfig_requests(rc_agent):[0m
[30;1m165 | [0m[35m    resp = await rc_agent.post("/v0.7/config")[0m
[30;1m166 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m    resp = await rc_agent.get("/test/session/requests")[0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35masync def test_remoteconfig_session([0m
[30;1m150 | [0m[35m    rc_agent,[0m
[30;1m151 | [0m[35m):[0m
[30;1m152 | [0m[35m    resp = await rc_agent.post("/v0.7/config")[0m
[30;1m153 | [0m[35m    content = await resp.text()[0m
[30;1m154 | [0m[35m    assert resp.status == 200[0m
[30;1m155 | [0m[35m    assert content == "{}"[0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m140 | [0m[35m    )[0m
[30;1m141 | [0m[35m    assert resp.status == 202, await resp.text()[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m    resp = await rc_agent.post("/v0.7/config")[0m
[30;1m144 | [0m[35m    content = await resp.text()[0m
[30;1m145 | [0m[35m    assert resp.status == 200[0m
[30;1m146 | [0m[35m    assert json.loads(content) == RemoteConfigServer._build_config_path_response(data["path"], data[[0m

[31m--[ [0m[34mMatch #[0m[33m404[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35m    assert resp.status == 200[0m
[30;1m135 | [0m[35m    assert content == "{}"[0m
[30;1m136 | [0m[35m    data = {"path": "2/ASM_DATA/1234", "msg": '{"exclusions": {"a":"b"}}'}[0m
[30;1m137 | [0m[35m    resp = await rc_agent.post([0m
[30;1m138 | [0m[35m        "/test/session/responses/config/path",[0m
[30;1m139 | [0m[35m        data=json.dumps(data),[0m
[30;1m140 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m405[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35masync def test_remoteconfig_create_path_payload([0m
[30;1m130 | [0m[35m    rc_agent,[0m
[30;1m131 | [0m[35m):[0m
[30;1m132 | [0m[35m    resp = await rc_agent.post("/v0.7/config")[0m
[30;1m133 | [0m[35m    content = await resp.text()[0m
[30;1m134 | [0m[35m    assert resp.status == 200[0m
[30;1m135 | [0m[35m    assert content == "{}"[0m

[31m--[ [0m[34mMatch #[0m[33m406[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m    )[0m
[30;1m121 | [0m[35m    assert resp.status == 202, await resp.text()[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    resp = await rc_agent.post("/v0.7/config")[0m
[30;1m124 | [0m[35m    content = await resp.text()[0m
[30;1m125 | [0m[35m    assert resp.status == 200[0m
[30;1m126 | [0m[35m    assert json.loads(content) == {"a": "b", "c": "d"}[0m

[31m--[ [0m[34mMatch #[0m[33m407[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m    )[0m
[30;1m110 | [0m[35m    assert resp.status == 202, await resp.text()[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m    resp = await rc_agent.post("/v0.7/config")[0m
[30;1m113 | [0m[35m    content = await resp.text()[0m
[30;1m114 | [0m[35m    assert resp.status == 200[0m
[30;1m115 | [0m[35m    assert json.loads(content) == {"a": "b"}[0m

[31m--[ [0m[34mMatch #[0m[33m408[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m98 | [0m[35masync def test_remoteconfig_put_payload([0m
[30;1m99 | [0m[35m    rc_agent,[0m
[30;1m100 | [0m[35m):[0m
[30;1m101 | [0m[35m    resp = await rc_agent.post("/v0.7/config")[0m
[30;1m102 | [0m[35m    content = await resp.text()[0m
[30;1m103 | [0m[35m    assert resp.status == 200[0m
[30;1m104 | [0m[35m    assert content == "{}"[0m

[31m--[ [0m[34mMatch #[0m[33m409[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35m    )[0m
[30;1m90 | [0m[35m    assert resp.status == 202, await resp.text()[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    resp = await rc_agent.post("/v0.7/config")[0m
[30;1m93 | [0m[35m    content = await resp.text()[0m
[30;1m94 | [0m[35m    assert resp.status == 200[0m
[30;1m95 | [0m[35m    assert content == "{}"[0m

[31m--[ [0m[34mMatch #[0m[33m410[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m    assert resp.status == 200[0m
[30;1m84 | [0m[35m    assert json.loads(content) == v07_reference_http_remoteconfig_payload_data_raw[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    resp = await rc_agent.post([0m
[30;1m87 | [0m[35m        "/test/session/responses/config",[0m
[30;1m88 | [0m[35m        data="{}",[0m
[30;1m89 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m411[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m    )[0m
[30;1m79 | [0m[35m    assert resp.status == 202, await resp.text()[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m    resp = await rc_agent.post("/v0.7/config")[0m
[30;1m82 | [0m[35m    content = await resp.text()[0m
[30;1m83 | [0m[35m    assert resp.status == 200[0m
[30;1m84 | [0m[35m    assert json.loads(content) == v07_reference_http_remoteconfig_payload_data_raw[0m

[31m--[ [0m[34mMatch #[0m[33m412[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m    assert resp.status == 200[0m
[30;1m73 | [0m[35m    assert content == "{}"[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    resp = await rc_agent.post([0m
[30;1m76 | [0m[35m        "/test/session/responses/config",[0m
[30;1m77 | [0m[35m        data=v07_reference_http_remoteconfig_payload_data,[0m
[30;1m78 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m413[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m    v07_reference_http_remoteconfig_payload_data,[0m
[30;1m68 | [0m[35m    v07_reference_http_remoteconfig_payload_data_raw,[0m
[30;1m69 | [0m[35m):[0m
[30;1m70 | [0m[35m    resp = await rc_agent.post("/v0.7/config")[0m
[30;1m71 | [0m[35m    content = await resp.text()[0m
[30;1m72 | [0m[35m    assert resp.status == 200[0m
[30;1m73 | [0m[35m    assert content == "{}"[0m

[31m--[ [0m[34mMatch #[0m[33m414[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m    )[0m
[30;1m57 | [0m[35m    assert resp.status == 202, await resp.text()[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m    resp = await rc_agent.post("/v0.7/config")[0m
[30;1m60 | [0m[35m    content = await resp.text()[0m
[30;1m61 | [0m[35m    assert resp.status == 200[0m
[30;1m62 | [0m[35m    assert json.loads(content) == v07_reference_http_remoteconfig_payload_data_raw[0m

[31m--[ [0m[34mMatch #[0m[33m415[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m    assert resp.status == 200[0m
[30;1m51 | [0m[35m    assert content == "{}"[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    resp = await rc_agent.post([0m
[30;1m54 | [0m[35m        "/test/session/responses/config",[0m
[30;1m55 | [0m[35m        data=v07_reference_http_remoteconfig_payload_data,[0m
[30;1m56 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m416[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m    v07_reference_http_remoteconfig_payload_data,[0m
[30;1m46 | [0m[35m    v07_reference_http_remoteconfig_payload_data_raw,[0m
[30;1m47 | [0m[35m):[0m
[30;1m48 | [0m[35m    resp = await rc_agent.post("/v0.7/config")[0m
[30;1m49 | [0m[35m    content = await resp.text()[0m
[30;1m50 | [0m[35m    assert resp.status == 200[0m
[30;1m51 | [0m[35m    assert content == "{}"[0m

[31m--[ [0m[34mMatch #[0m[33m417[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m    assert resp.status == 200[0m
[30;1m35 | [0m[35m    assert content == "{}"[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    resp = await rc_agent.get("/v0.7/config")[0m
[30;1m38 | [0m[35m    content = await resp.text()[0m
[30;1m39 | [0m[35m    assert resp.status == 200[0m
[30;1m40 | [0m[35m    assert content == "{}"[0m

[31m--[ [0m[34mMatch #[0m[33m418[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35masync def test_remoteconfig(rc_agent):[0m
[30;1m32 | [0m[35m    resp = await rc_agent.post("/v0.7/config")[0m
[30;1m33 | [0m[35m    content = await resp.text()[0m
[30;1m34 | [0m[35m    assert resp.status == 200[0m
[30;1m35 | [0m[35m    assert content == "{}"[0m

[31m--[ [0m[34mMatch #[0m[33m419[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m    )[0m
[30;1m23 | [0m[35m    assert resp.status == 202, await resp.text()[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    resp = await rc_agent.post("/v0.7/config", headers={"X-Datadog-Test-Session-Token": token})[0m
[30;1m26 | [0m[35m    content = await resp.text()[0m
[30;1m27 | [0m[35m    assert resp.status == 200[0m
[30;1m28 | [0m[35m    assert json.loads(content) == expected[0m

[31m--[ [0m[34mMatch #[0m[33m420[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m9 | [0m[35m@pytest.fixture[0m
[30;1m10 | [0m[35masync def rc_agent(agent):[0m
[30;1m11 | [0m[35m    yield agent[0m
[30;1m12 | [0m[35m    resp = await agent.post([0m
[30;1m13 | [0m[35m        "/test/session/responses/config",[0m
[30;1m14 | [0m[35m        data="{}",[0m
[30;1m15 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m421[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_remoteconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport json[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport pytest[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m422[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/.gitignore[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m.coverage.*[0m
[30;1m39 | [0m[35m.cache[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m# Automated dev env setup - see .envrc.example[0m
[30;1m42 | [0m[35m/.envrc[0m
[30;1m43 | [0m[35m/.direnv/[0m
[30;1m44 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m423[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/conftest.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m584 | [0m[35m        async with aiohttp.ClientSession() as session:[0m
[30;1m585 | [0m[35m            for _ in range(100):[0m
[30;1m586 | [0m[35m                try:[0m
[30;1m587 | [0m[35m                    r = await session.get(f"http://localhost:{testagent_port}")[0m
[30;1m588 | [0m[35m                except (ClientConnectorError, ClientOSError):[0m
[30;1m589 | [0m[35m                    pass[0m
[30;1m590 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m424[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/conftest.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m528 | [0m[35m):[0m
[30;1m529 | [0m[35m    def fn(token: Optional[str] = None) -> Awaitable[Response]:[0m
[30;1m530 | [0m[35m        params = {"test_session_token": token} if token is not None else {}[0m
[30;1m531 | [0m[35m        return agent.post(  # type: ignore[0m
[30;1m532 | [0m[35m            "/telemetry/proxy/api/v2/apmtelemetry",[0m
[30;1m533 | [0m[35m            params=params,[0m
[30;1m534 | [0m[35m            headers=v2_reference_http_apmtelemetry_payload_headers,[0m

[31m--[ [0m[34mMatch #[0m[33m425[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/conftest.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m512 | [0m[35m        "DD-Telemetry-API-Version": "v1",[0m
[30;1m513 | [0m[35m    }[0m
[30;1m514 | [0m[35m[0m
[30;1m515 | [0m[35m    return agent.post([0m
[30;1m516 | [0m[35m        "/telemetry/proxy/api/v2/apmtelemetry",[0m
[30;1m517 | [0m[35m        params=params,[0m
[30;1m518 | [0m[35m        headers=headers,[0m

[31m--[ [0m[34mMatch #[0m[33m426[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/conftest.py[0m
   Pattern: [32m.hostname[0m
[30;1m341 | [0m[35m        },[0m
[30;1m342 | [0m[35m        "host": {[0m
[30;1m343 | [0m[35m            "os": "macOS-12.4",[0m
[30;1m344 | [0m[35m            "hostname": "HELLO-COMPUTER",[0m
[30;1m345 | [0m[35m            "os_version": "12.4",[0m
[30;1m346 | [0m[35m            "kernel_name": "Darwin",[0m
[30;1m347 | [0m[35m            "kernel_release": "21.5.0",[0m

[31m--[ [0m[34mMatch #[0m[33m427[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/conftest.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m569 | [0m[35masync def testagent([0m
[30;1m570 | [0m[35m    loop: asyncio.BaseEventLoop, testagent_port: str, testagent_snapshot_ci_mode: bool[0m
[30;1m571 | [0m[35m) -> AsyncGenerator[aiohttp.ClientSession, None]:[0m
[30;1m572 | [0m[35m    env = os.environ.copy()[0m
[30;1m573 | [0m[35m    env.update([0m
[30;1m574 | [0m[35m        {[0m
[30;1m575 | [0m[35m            "PORT": testagent_port,[0m

[31m--[ [0m[34mMatch #[0m[33m428[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/conftest.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m560 | [0m[35m@pytest.fixture(scope="module")[0m
[30;1m561 | [0m[35mdef testagent_snapshot_ci_mode() -> bool:[0m
[30;1m562 | [0m[35m    # Default all tests in this module to be run in CI mode[0m
[30;1m563 | [0m[35m    # unless a special env var is passed to make generating[0m
[30;1m564 | [0m[35m    # the snapshots easier.[0m
[30;1m565 | [0m[35m    return os.getenv("GENERATE_SNAPSHOTS") != "1"[0m
[30;1m566 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m429[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m        self._responses[token] = data[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    async def _get_response(self, token: Optional[str]) -> Any:[0m
[30;1m23 | [0m[35m        return self._responses.get(token, {})[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    def update_config_response(self, token: Optional[str], data: Dict[str, Any]) -> None:[0m
[30;1m26 | [0m[35m        self._update_response(token, data)[0m

[31m--[ [0m[34mMatch #[0m[33m430[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/remoteconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m11 | [0m[35m    _responses: Dict[Optional[str], Any] = {}[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m    def _update_response(self, token: Optional[str], data: Dict[str, Any]) -> None:[0m
[30;1m14 | [0m[35m        if self._responses.get(token):[0m
[30;1m15 | [0m[35m            self._responses[token].update(data)[0m
[30;1m16 | [0m[35m        else:[0m
[30;1m17 | [0m[35m            self._create_response(token, data)[0m

[31m--[ [0m[34mMatch #[0m[33m431[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/remoteconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport datetime[0m
[30;1m3 | [0m[35mimport hashlib[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35mfrom typing import Any[0m

[31m--[ [0m[34mMatch #[0m[33m432[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/.github/workflows/main.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m        with:[0m
[30;1m31 | [0m[35m          python-version: ${{ matrix.python-version }}[0m
[30;1m32 | [0m[35m      - name: install deps[0m
[30;1m33 | [0m[35m        run: pip install .[testing][0m
[30;1m34 | [0m[35m      - run: |[0m
[30;1m35 | [0m[35m          riot run -p --pass-env ${{ matrix.python-version}} test[0m

[31m--[ [0m[34mMatch #[0m[33m433[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/.github/workflows/main.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35m      - uses: actions/checkout@v4[0m
[30;1m15 | [0m[35m        with:[0m
[30;1m16 | [0m[35m          fetch-depth: 0[0m
[30;1m17 | [0m[35m      - run: pip install .[testing][0m
[30;1m18 | [0m[35m      - run: riot -v run -s check_fmt[0m
[30;1m19 | [0m[35m      - run: riot -v run -s flake8[0m
[30;1m20 | [0m[35m      - run: riot -v run mypy[0m

[31m--[ [0m[34mMatch #[0m[33m434[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/.envrc.example[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# use https://github.com/nix-community/nix-direnv  to load all tools needed to develop in the reposi[0m
[30;1m2 | [0m[35m# $ cp .envrc.example .envrc[0m
[30;1m3 | [0m[35m# $ direnv allow .[0m
[30;1m4 | [0m[35muse flake --impure . [0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m435[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m        self._session.get(self._url("/test/session/clear"), **kwargs)[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    def info(self, **kwargs):[0m
[30;1m54 | [0m[35m        resp = self._session.get(self._url("/info"), **kwargs)[0m
[30;1m55 | [0m[35m        json = resp.json()[0m
[30;1m56 | [0m[35m        return json[0m
[30;1m57 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m436[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m        return cast(List[Any], resp.json())[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m    def clear(self, **kwargs: Any) -> None:[0m
[30;1m51 | [0m[35m        self._session.get(self._url("/test/session/clear"), **kwargs)[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    def info(self, **kwargs):[0m
[30;1m54 | [0m[35m        resp = self._session.get(self._url("/info"), **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m437[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m        return reqs[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    def telemetry(self, clear: bool = False, **kwargs: Any) -> List[Any]:[0m
[30;1m45 | [0m[35m        resp = self._session.get(self._url("/test/session/apmtelemetry"), **kwargs)[0m
[30;1m46 | [0m[35m        if clear:[0m
[30;1m47 | [0m[35m            self.clear()[0m
[30;1m48 | [0m[35m        return cast(List[Any], resp.json())[0m

[31m--[ [0m[34mMatch #[0m[33m438[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m        return cast(List[Trace], json)[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    def requests(self, **kwargs: Any) -> List[Any]:[0m
[30;1m30 | [0m[35m        resp = self._session.get(self._url("/test/session/requests"), **kwargs)[0m
[30;1m31 | [0m[35m        json = resp.json()[0m
[30;1m32 | [0m[35m        return cast(List[Any], json)[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m439[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m        return urllib.parse.urljoin(self._base_url, path)[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m    def traces(self, clear: bool = False, **kwargs: Any) -> List[Trace]:[0m
[30;1m23 | [0m[35m        resp = self._session.get(self._url("/test/session/traces"), **kwargs)[0m
[30;1m24 | [0m[35m        if clear:[0m
[30;1m25 | [0m[35m            self.clear()[0m
[30;1m26 | [0m[35m        json = resp.json()[0m

[31m--[ [0m[34mMatch #[0m[33m440[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m136 | [0m[35m                time.sleep(delay)[0m
[30;1m137 | [0m[35m            else:[0m
[30;1m138 | [0m[35m                return[0m
[30;1m139 | [0m[35m        raise AssertionError(f"Test agent did not start in time ({num_tries * delay} seconds). Got {[0m

[31m--[ [0m[34mMatch #[0m[33m441[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m        Returns after the number of spans has been received or raises otherwise after 2 seconds of p[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m        Returned traces are sorted by the first span start time to simplify assertions for more than[0m
[30;1m89 | [0m[35m        """[0m
[30;1m90 | [0m[35m        num_received = None[0m
[30;1m91 | [0m[35m        for i in range(wait_loops):[0m

[31m--[ [0m[34mMatch #[0m[33m442[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m        Returns after the number of traces has been received or raises otherwise after 2 seconds of [0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        Returned traces are sorted by the first span start time to simplify assertions for more than[0m
[30;1m64 | [0m[35m        """[0m
[30;1m65 | [0m[35m        num_received = 0[0m
[30;1m66 | [0m[35m        traces = [][0m

[31m--[ [0m[34mMatch #[0m[33m443[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mfrom typing import Any[0m
[30;1m3 | [0m[35mfrom typing import List[0m
[30;1m4 | [0m[35mfrom typing import cast[0m
[30;1m5 | [0m[35mimport urllib.parse[0m

[31m--[ [0m[34mMatch #[0m[33m444[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m772 | [0m[35m    resp = await do_reference_v04_http_trace(token="test_case")[0m
[30;1m773 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m774 | [0m[35m[0m
[30;1m775 | [0m[35m    resp = await agent.get("/test/session/snapshot", params={"test_session_token": "test_case"})[0m
[30;1m776 | [0m[35m    assert resp.status == 400[0m
[30;1m777 | [0m[35m    assert "Cannot remove 'span_id' from spans" in await resp.text()[0m

[31m--[ [0m[34mMatch #[0m[33m445[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m758 | [0m[35m[0m
[30;1m759 | [0m[35m    resp = await v04_trace(agent, actual_traces, token="test")[0m
[30;1m760 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m761 | [0m[35m    resp = await agent.get("/test/session/snapshot", params={"test_session_token": "test"})[0m
[30;1m762 | [0m[35m    resp_text = await resp.text()[0m
[30;1m763 | [0m[35m    if error:[0m
[30;1m764 | [0m[35m        assert resp.status == 400, resp_text[0m

[31m--[ [0m[34mMatch #[0m[33m446[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m753 | [0m[35m[0m
[30;1m754 | [0m[35m    resp = await agent.get("/test/session/snapshot", params={"test_session_token": "test"})[0m
[30;1m755 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m756 | [0m[35m    resp = await agent.get("/test/session/clear", params={"test_session_token": "test"})[0m
[30;1m757 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m758 | [0m[35m[0m
[30;1m759 | [0m[35m    resp = await v04_trace(agent, actual_traces, token="test")[0m

[31m--[ [0m[34mMatch #[0m[33m447[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m751 | [0m[35m    resp = await v04_trace(agent, expected_traces, token="test")[0m
[30;1m752 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m753 | [0m[35m[0m
[30;1m754 | [0m[35m    resp = await agent.get("/test/session/snapshot", params={"test_session_token": "test"})[0m
[30;1m755 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m756 | [0m[35m    resp = await agent.get("/test/session/clear", params={"test_session_token": "test"})[0m
[30;1m757 | [0m[35m    assert resp.status == 200, await resp.text()[0m

[31m--[ [0m[34mMatch #[0m[33m448[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m464 | [0m[35m    custom_file_name = custom_dir / "custom_snapshot"[0m
[30;1m465 | [0m[35m    custom_file = custom_dir / "custom_snapshot.json"[0m
[30;1m466 | [0m[35m[0m
[30;1m467 | [0m[35m    resp = await agent.get([0m
[30;1m468 | [0m[35m        "/test/session/snapshot", params={"test_session_token": "test_case", "file": str(custom_file[0m
[30;1m469 | [0m[35m    )[0m
[30;1m470 | [0m[35m    assert resp.status == 200, await resp.text()[0m

[31m--[ [0m[34mMatch #[0m[33m449[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m440 | [0m[35m    custom_file_name = custom_dir / "custom_snapshot"[0m
[30;1m441 | [0m[35m    custom_file = custom_dir / "custom_snapshot.json"[0m
[30;1m442 | [0m[35m[0m
[30;1m443 | [0m[35m    resp = await agent.get([0m
[30;1m444 | [0m[35m        "/test/session/snapshot", params={"test_session_token": "test_case", "file": str(custom_file[0m
[30;1m445 | [0m[35m    )[0m
[30;1m446 | [0m[35m    assert resp.status == 200, await resp.text()[0m

[31m--[ [0m[34mMatch #[0m[33m450[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m426 | [0m[35m        resp = await do_reference_v06_http_stats(token="test_case")[0m
[30;1m427 | [0m[35m        assert resp.status == 200, await resp.text()[0m
[30;1m428 | [0m[35m[0m
[30;1m429 | [0m[35m        resp = await agent.get("/test/session/snapshot", params={"test_session_token": "test_case"})[0m
[30;1m430 | [0m[35m        assert resp.status == 200, await resp.text()[0m
[30;1m431 | [0m[35m[0m
[30;1m432 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m451[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m408 | [0m[35m[0m
[30;1m409 | [0m[35m    snap_path = snapshot_dir / "test_case_tracestats.json"[0m
[30;1m410 | [0m[35m    resp = await agent.get("/test/session/snapshot", params={"test_session_token": "test_case"})[0m
[30;1m411 | [0m[35m    resp_clear = await agent.get("/test/session/clear", params={"test_session_token": "test_case"})[0m
[30;1m412 | [0m[35m    assert resp_clear.status == 200, await resp_clear.text()[0m
[30;1m413 | [0m[35m[0m
[30;1m414 | [0m[35m    if snapshot_ci_mode:[0m

[31m--[ [0m[34mMatch #[0m[33m452[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m407 | [0m[35m    assert resp.status == 200[0m
[30;1m408 | [0m[35m[0m
[30;1m409 | [0m[35m    snap_path = snapshot_dir / "test_case_tracestats.json"[0m
[30;1m410 | [0m[35m    resp = await agent.get("/test/session/snapshot", params={"test_session_token": "test_case"})[0m
[30;1m411 | [0m[35m    resp_clear = await agent.get("/test/session/clear", params={"test_session_token": "test_case"})[0m
[30;1m412 | [0m[35m    assert resp_clear.status == 200, await resp_clear.text()[0m
[30;1m413 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m453[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m391 | [0m[35m    custom_file_name = custom_dir / "custom_snapshot"[0m
[30;1m392 | [0m[35m    custom_file = custom_dir / "custom_snapshot.json"[0m
[30;1m393 | [0m[35m[0m
[30;1m394 | [0m[35m    resp = await agent.get([0m
[30;1m395 | [0m[35m        "/test/session/snapshot",[0m
[30;1m396 | [0m[35m        params={"test_session_token": "test_case", "file": str(custom_file_name)},[0m
[30;1m397 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m454[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m371 | [0m[35m    custom_dir = tmp_path / "custom"[0m
[30;1m372 | [0m[35m    custom_dir.mkdir()[0m
[30;1m373 | [0m[35m[0m
[30;1m374 | [0m[35m    resp = await agent.get([0m
[30;1m375 | [0m[35m        "/test/session/snapshot",[0m
[30;1m376 | [0m[35m        params={"test_session_token": "test_case", "dir": str(custom_dir)},[0m
[30;1m377 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m455[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m    resp = await v04_trace(agent, actual_traces, token="test")[0m
[30;1m190 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m191 | [0m[35m    resp = await agent.get("/test/session/snapshot", params={"test_session_token": "test"})[0m
[30;1m192 | [0m[35m    resp_text = await resp.text()[0m
[30;1m193 | [0m[35m    if error:[0m
[30;1m194 | [0m[35m        assert resp.status == 400, resp_text[0m

[31m--[ [0m[34mMatch #[0m[33m456[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m    resp = await agent.get("/test/session/snapshot", params={"test_session_token": "test"})[0m
[30;1m185 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m186 | [0m[35m    resp = await agent.get("/test/session/clear", params={"test_session_token": "test"})[0m
[30;1m187 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m    resp = await v04_trace(agent, actual_traces, token="test")[0m

[31m--[ [0m[34mMatch #[0m[33m457[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m    resp = await v04_trace(agent, expected_traces, token="test")[0m
[30;1m182 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m    resp = await agent.get("/test/session/snapshot", params={"test_session_token": "test"})[0m
[30;1m185 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m186 | [0m[35m    resp = await agent.get("/test/session/clear", params={"test_session_token": "test"})[0m
[30;1m187 | [0m[35m    assert resp.status == 200, await resp.text()[0m

[31m--[ [0m[34mMatch #[0m[33m458[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m        resp = await do_reference_v04_http_trace(token="test_case")[0m
[30;1m57 | [0m[35m        assert resp.status == 200, await resp.text()[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m        resp = await agent.get("/test/session/snapshot", params={"test_session_token": "test_case"})[0m
[30;1m60 | [0m[35m        assert resp.status == 200, await resp.text()[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m459[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_snapshot.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35m    assert resp.status == 200[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    # Do the snapshot[0m
[30;1m42 | [0m[35m    resp = await agent.get("/test/session/snapshot", params={"test_session_token": "test_case"})[0m
[30;1m43 | [0m[35m    snap_path = snapshot_dir / "test_case.json"[0m
[30;1m44 | [0m[35m    if snapshot_ci_mode:[0m
[30;1m45 | [0m[35m        # No previous snapshot file exists so this should fail[0m

[31m--[ [0m[34mMatch #[0m[33m460[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/releasenotes/notes/add-optional-json-parser-10aac54bd1cbe322.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m    trace, even if the trace is partially misconformed, such as one having port numbers within[0m
[30;1m6 | [0m[35m    the meta field, which would previously throw an error. Additionally, the change also adds [0m
[30;1m7 | [0m[35m    a default parser of json.loads, which was originally used. The new parser can be used by[0m

[31m--[ [0m[34mMatch #[0m[33m461[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m205 | [0m[35m                                json.dumps(span, indent=4)[0m
[30;1m206 | [0m[35m                                + f"\nSpan: {span['name']} expected to have ``service`` name equal t[0m
[30;1m207 | [0m[35m                            )[0m
[30;1m208 | [0m[35m                        elif span.get("type") in ["web", "http"]:[0m
[30;1m209 | [0m[35m                            log.debug([0m
[30;1m210 | [0m[35m                                f"Skipped ``DD_SERVICE`` Span Check for Span: {span['name']} of type[0m
[30;1m211 | [0m[35m                            )[0m

[31m--[ [0m[34mMatch #[0m[33m462[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m198 | [0m[35m                        trace_context = ([0m
[30;1m199 | [0m[35m                            trace_context[0m
[30;1m200 | [0m[35m                            if trace_context is not None[0m
[30;1m201 | [0m[35m                            else meta.get("servlet.context", "").replace("/", "")[0m
[30;1m202 | [0m[35m                        )[0m
[30;1m203 | [0m[35m                        if service != trace_context:[0m
[30;1m204 | [0m[35m                            self.fail([0m

[31m--[ [0m[34mMatch #[0m[33m463[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m191 | [0m[35m                        + f"\n``DD_SERVICE`` env not set for Span: {span['name']} with service: {spa[0m
[30;1m192 | [0m[35m                    )[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m                service = span.get("service")[0m
[30;1m195 | [0m[35m                if service != dd_service:[0m
[30;1m196 | [0m[35m                    # check for special case where span is of type web and has context as service[0m
[30;1m197 | [0m[35m                    if "servlet.context" in meta.keys() or trace_context:[0m

[31m--[ [0m[34mMatch #[0m[33m464[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m                dd_service = dd_config_env.get(f"DD_{component.upper()}_SERVICE", None)[0m
[30;1m185 | [0m[35m                if not dd_service:[0m
[30;1m186 | [0m[35m                    log.debug("DD_SERVICE not set for component: %s. Args %s", component, dd_config_[0m
[30;1m187 | [0m[35m                dd_service = dd_service or dd_config_env.get("DD_SERVICE", None)[0m
[30;1m188 | [0m[35m                if dd_service is None:[0m
[30;1m189 | [0m[35m                    self.fail([0m
[30;1m190 | [0m[35m                        json.dumps(dd_config_env, indent=4)[0m

[31m--[ [0m[34mMatch #[0m[33m465[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m            component = meta.get("component", "")[0m
[30;1m183 | [0m[35m            if component != "":[0m
[30;1m184 | [0m[35m                dd_service = dd_config_env.get(f"DD_{component.upper()}_SERVICE", None)[0m
[30;1m185 | [0m[35m                if not dd_service:[0m
[30;1m186 | [0m[35m                    log.debug("DD_SERVICE not set for component: %s. Args %s", component, dd_config_[0m
[30;1m187 | [0m[35m                dd_service = dd_service or dd_config_env.get("DD_SERVICE", None)[0m

[31m--[ [0m[34mMatch #[0m[33m466[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m179 | [0m[35m                    )[0m
[30;1m180 | [0m[35m                    return[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m            component = meta.get("component", "")[0m
[30;1m183 | [0m[35m            if component != "":[0m
[30;1m184 | [0m[35m                dd_service = dd_config_env.get(f"DD_{component.upper()}_SERVICE", None)[0m
[30;1m185 | [0m[35m                if not dd_service:[0m

[31m--[ [0m[34mMatch #[0m[33m467[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m170 | [0m[35m            meta = span.get("meta", {})[0m
[30;1m171 | [0m[35m            for component in whitelisted_components:[0m
[30;1m172 | [0m[35m                if component in meta.get("component", ""):[0m
[30;1m173 | [0m[35m                    skipped_component = meta.get("component", "")[0m
[30;1m174 | [0m[35m                    log.debug([0m
[30;1m175 | [0m[35m                        f"Skipped ``DD_SERVICE`` Span Check for Span: {span['name']} with component [0m
[30;1m176 | [0m[35m                    )[0m

[31m--[ [0m[34mMatch #[0m[33m468[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m        for span in trace:[0m
[30;1m170 | [0m[35m            meta = span.get("meta", {})[0m
[30;1m171 | [0m[35m            for component in whitelisted_components:[0m
[30;1m172 | [0m[35m                if component in meta.get("component", ""):[0m
[30;1m173 | [0m[35m                    skipped_component = meta.get("component", "")[0m
[30;1m174 | [0m[35m                    log.debug([0m
[30;1m175 | [0m[35m                        f"Skipped ``DD_SERVICE`` Span Check for Span: {span['name']} with component [0m

[31m--[ [0m[34mMatch #[0m[33m469[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m167 | [0m[35m            return[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m        for span in trace:[0m
[30;1m170 | [0m[35m            meta = span.get("meta", {})[0m
[30;1m171 | [0m[35m            for component in whitelisted_components:[0m
[30;1m172 | [0m[35m                if component in meta.get("component", ""):[0m
[30;1m173 | [0m[35m                    skipped_component = meta.get("component", "")[0m

[31m--[ [0m[34mMatch #[0m[33m470[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m            self.skip("Skipping Span Check `trace_dd_service` for Span Attribute Schema v0")[0m
[30;1m156 | [0m[35m            return[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m        if dd_config_env.get("DD_TRACE_HTTP_CLIENT_SPLIT_BY_DOMAIN", False) or dd_config_env.get([0m
[30;1m159 | [0m[35m            "DD_TRACE_DB_CLIENT_SPLIT_BY_INSTANCE", False[0m
[30;1m160 | [0m[35m        ):[0m
[30;1m161 | [0m[35m            log.debug([0m

[31m--[ [0m[34mMatch #[0m[33m471[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m            self.skip("Skipping Span Check `trace_dd_service` for Span Attribute Schema v0")[0m
[30;1m156 | [0m[35m            return[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m        if dd_config_env.get("DD_TRACE_HTTP_CLIENT_SPLIT_BY_DOMAIN", False) or dd_config_env.get([0m
[30;1m159 | [0m[35m            "DD_TRACE_DB_CLIENT_SPLIT_BY_INSTANCE", False[0m
[30;1m160 | [0m[35m        ):[0m
[30;1m161 | [0m[35m            log.debug([0m

[31m--[ [0m[34mMatch #[0m[33m472[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m        whitelisted_components = ["rabbitmq", "jms", "kafka", "java-web-servlet-response"][0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m        if dd_config_env.get("DD_TRACE_SPAN_ATTRIBUTE_SCHEMA", "v0") != "v1":[0m
[30;1m154 | [0m[35m            log.debug("Skipping Span Check `trace_dd_service` for Span Attribute Schema v0")[0m
[30;1m155 | [0m[35m            self.skip("Skipping Span Check `trace_dd_service` for Span Attribute Schema v0")[0m
[30;1m156 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m473[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m                peer_service = meta.get("peer.service")[0m
[30;1m117 | [0m[35m                peer_service_source_key = meta.get("_dd.peer.service.source", "")[0m
[30;1m118 | [0m[35m                peer_service_source_val = meta.get(peer_service_source_key, "")[0m
[30;1m119 | [0m[35m                if peer_service != peer_service_source_val:[0m
[30;1m120 | [0m[35m                    self.fail([0m
[30;1m121 | [0m[35m                        json.dumps(span, indent=4)[0m

[31m--[ [0m[34mMatch #[0m[33m474[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m114 | [0m[35m                # self.fail(json.dumps(span, indent=4) + f"\nSpan: {span['name']} of kind: {meta['sp[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m                peer_service = meta.get("peer.service")[0m
[30;1m117 | [0m[35m                peer_service_source_key = meta.get("_dd.peer.service.source", "")[0m
[30;1m118 | [0m[35m                peer_service_source_val = meta.get(peer_service_source_key, "")[0m
[30;1m119 | [0m[35m                if peer_service != peer_service_source_val:[0m
[30;1m120 | [0m[35m                    self.fail([0m

[31m--[ [0m[34mMatch #[0m[33m475[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m113 | [0m[35m                # if meta.get("peer.service", None) is None:[0m
[30;1m114 | [0m[35m                # self.fail(json.dumps(span, indent=4) + f"\nSpan: {span['name']} of kind: {meta['sp[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m                peer_service = meta.get("peer.service")[0m
[30;1m117 | [0m[35m                peer_service_source_key = meta.get("_dd.peer.service.source", "")[0m
[30;1m118 | [0m[35m                peer_service_source_val = meta.get(peer_service_source_key, "")[0m
[30;1m119 | [0m[35m                if peer_service != peer_service_source_val:[0m

[31m--[ [0m[34mMatch #[0m[33m476[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m                        )[0m
[30;1m111 | [0m[35m                        return[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m                # if meta.get("peer.service", None) is None:[0m
[30;1m114 | [0m[35m                # self.fail(json.dumps(span, indent=4) + f"\nSpan: {span['name']} of kind: {meta['sp[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m                peer_service = meta.get("peer.service")[0m

[31m--[ [0m[34mMatch #[0m[33m477[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m            if "peer.service" in meta.keys():[0m
[30;1m102 | [0m[35m                for component in whitelisted_components:[0m
[30;1m103 | [0m[35m                    if component in meta.get("component", ""):[0m
[30;1m104 | [0m[35m                        skipped_component = meta.get("component", "")[0m
[30;1m105 | [0m[35m                        log.debug([0m
[30;1m106 | [0m[35m                            f"Skipped ``peer.service`` Span Check for Span: {span['name']} with comp[0m
[30;1m107 | [0m[35m                        )[0m

[31m--[ [0m[34mMatch #[0m[33m478[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m        if dd_config_env.get("DD_TRACE_SPAN_ATTRIBUTE_SCHEMA", "v0") != "v0":[0m
[30;1m101 | [0m[35m            if "peer.service" in meta.keys():[0m
[30;1m102 | [0m[35m                for component in whitelisted_components:[0m
[30;1m103 | [0m[35m                    if component in meta.get("component", ""):[0m
[30;1m104 | [0m[35m                        skipped_component = meta.get("component", "")[0m
[30;1m105 | [0m[35m                        log.debug([0m
[30;1m106 | [0m[35m                            f"Skipped ``peer.service`` Span Check for Span: {span['name']} with comp[0m

[31m--[ [0m[34mMatch #[0m[33m479[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m        whitelisted_components = ["couchbase"][0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m        if dd_config_env.get("DD_TRACE_SPAN_ATTRIBUTE_SCHEMA", "v0") != "v0":[0m
[30;1m101 | [0m[35m            if "peer.service" in meta.keys():[0m
[30;1m102 | [0m[35m                for component in whitelisted_components:[0m
[30;1m103 | [0m[35m                    if component in meta.get("component", ""):[0m

[31m--[ [0m[34mMatch #[0m[33m480[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m    def check(self, span: Span, dd_config_env: Dict[str, str]) -> None:[0m
[30;1m95 | [0m[35m        log.info("Performing ``peer.service`` Span Check")[0m
[30;1m96 | [0m[35m        meta = span.get("meta", {})[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m        whitelisted_components = ["couchbase"][0m
[30;1m99 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m481[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m200 | [0m[35m                            if trace_context is not None[0m
[30;1m201 | [0m[35m                            else meta.get("servlet.context", "").replace("/", "")[0m
[30;1m202 | [0m[35m                        )[0m
[30;1m203 | [0m[35m                        if service != trace_context:[0m
[30;1m204 | [0m[35m                            self.fail([0m
[30;1m205 | [0m[35m                                json.dumps(span, indent=4)[0m
[30;1m206 | [0m[35m                                + f"\nSpan: {span['name']} expected to have ``service`` name equal t[0m

[31m--[ [0m[34mMatch #[0m[33m482[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m                service = span.get("service")[0m
[30;1m195 | [0m[35m                if service != dd_service:[0m
[30;1m196 | [0m[35m                    # check for special case where span is of type web and has context as service[0m
[30;1m197 | [0m[35m                    if "servlet.context" in meta.keys() or trace_context:[0m
[30;1m198 | [0m[35m                        trace_context = ([0m
[30;1m199 | [0m[35m                            trace_context[0m
[30;1m200 | [0m[35m                            if trace_context is not None[0m

[31m--[ [0m[34mMatch #[0m[33m483[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m192 | [0m[35m                    )[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m                service = span.get("service")[0m
[30;1m195 | [0m[35m                if service != dd_service:[0m
[30;1m196 | [0m[35m                    # check for special case where span is of type web and has context as service[0m
[30;1m197 | [0m[35m                    if "servlet.context" in meta.keys() or trace_context:[0m
[30;1m198 | [0m[35m                        trace_context = ([0m

[31m--[ [0m[34mMatch #[0m[33m484[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m191 | [0m[35m                        + f"\n``DD_SERVICE`` env not set for Span: {span['name']} with service: {spa[0m
[30;1m192 | [0m[35m                    )[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m                service = span.get("service")[0m
[30;1m195 | [0m[35m                if service != dd_service:[0m
[30;1m196 | [0m[35m                    # check for special case where span is of type web and has context as service[0m
[30;1m197 | [0m[35m                    if "servlet.context" in meta.keys() or trace_context:[0m

[31m--[ [0m[34mMatch #[0m[33m485[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m188 | [0m[35m                if dd_service is None:[0m
[30;1m189 | [0m[35m                    self.fail([0m
[30;1m190 | [0m[35m                        json.dumps(dd_config_env, indent=4)[0m
[30;1m191 | [0m[35m                        + f"\n``DD_SERVICE`` env not set for Span: {span['name']} with service: {spa[0m
[30;1m192 | [0m[35m                    )[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m                service = span.get("service")[0m

[31m--[ [0m[34mMatch #[0m[33m486[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/trace_checks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m145 | [0m[35m    def check(self, trace: List[Span], dd_config_env: Dict[str, str]) -> None:[0m
[30;1m146 | [0m[35m        log.info("Performing ``DD_SERVICE`` Trace Check")[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m        # trace context can be set to service for each span[0m
[30;1m149 | [0m[35m        trace_context = None[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m        whitelisted_components = ["rabbitmq", "jms", "kafka", "java-web-servlet-response"][0m

[31m--[ [0m[34mMatch #[0m[33m487[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_tracestats.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m19 | [0m[35m    v06_reference_http_stats_payload_headers,[0m
[30;1m20 | [0m[35m    v06_reference_http_stats_payload_data,[0m
[30;1m21 | [0m[35m):[0m
[30;1m22 | [0m[35m    resp = await agent.post([0m
[30;1m23 | [0m[35m        "/v0.6/stats",[0m
[30;1m24 | [0m[35m        headers=v06_reference_http_stats_payload_headers,[0m
[30;1m25 | [0m[35m        data=v06_reference_http_stats_payload_data,[0m

[31m--[ [0m[34mMatch #[0m[33m488[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_tracestats.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2 | [0m[35m    resp = await do_reference_v06_http_stats(token="test_stats_decode")[0m
[30;1m3 | [0m[35m    assert resp.status == 200, await resp.text()[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35m    resp = await agent.get([0m
[30;1m6 | [0m[35m        "/test/session/stats",[0m
[30;1m7 | [0m[35m        headers={"X-Datadog-Test-Session-Token": "test_stats_decode"},[0m
[30;1m8 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m489[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/releasenotes/notes/disable-error-responses-and-collect-trace-failures-in-memory-4a199bc7be416709.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m  - |[0m
[30;1m4 | [0m[35m    Adds a feature to disable Test-Agent Failure <Response 400> using the ``DISABLE_ERROR_RESPONSES`[0m
[30;1m5 | [0m[35m    ``--disable-error-responses`` command line option. Adds a feature to pool Test-Agent Trace Check[0m
[30;1m6 | [0m[35m    ``DD_POOL_TRACE_CHECK_FAILURES`` env variable or ``--pool-trace-check-failures`` option. These f[0m
[30;1m7 | [0m[35m    ``/test/trace_check/failures`` GET endpoint, which returns a <Response 200> if no failures occur[0m

[31m--[ [0m[34mMatch #[0m[33m490[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/releasenotes/notes/disable-error-responses-and-collect-trace-failures-in-memory-4a199bc7be416709.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m---[0m
[30;1m2 | [0m[35mfeatures:[0m
[30;1m3 | [0m[35m  - |[0m
[30;1m4 | [0m[35m    Adds a feature to disable Test-Agent Failure <Response 400> using the ``DISABLE_ERROR_RESPONSES`[0m
[30;1m5 | [0m[35m    ``--disable-error-responses`` command line option. Adds a feature to pool Test-Agent Trace Check[0m
[30;1m6 | [0m[35m    ``DD_POOL_TRACE_CHECK_FAILURES`` env variable or ``--pool-trace-check-failures`` option. These f[0m
[30;1m7 | [0m[35m    ``/test/trace_check/failures`` GET endpoint, which returns a <Response 200> if no failures occur[0m

[31m--[ [0m[34mMatch #[0m[33m491[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m    @classmethod[0m
[30;1m81 | [0m[35m    def add_check(cls, check: "Check") -> None:[0m
[30;1m82 | [0m[35m        """Add the given check to the current frame."""[0m
[30;1m83 | [0m[35m        ctx = CHECK_TRACE.get()[0m
[30;1m84 | [0m[35m        ctx._active.add_check(check)[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    def frames(self) -> Generator[CheckTraceFrame, None, None]:[0m

[31m--[ [0m[34mMatch #[0m[33m492[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/ddapm_test_agent/checks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m    @contextlib.contextmanager[0m
[30;1m70 | [0m[35m    def add_frame(cls, title: str) -> Generator["CheckTraceFrame", None, None]:[0m
[30;1m71 | [0m[35m        """Add a frame to the trace."""[0m
[30;1m72 | [0m[35m        ctx = CHECK_TRACE.get()[0m
[30;1m73 | [0m[35m        frame = CheckTraceFrame(title)[0m
[30;1m74 | [0m[35m        ctx._active.add_frame(frame)[0m
[30;1m75 | [0m[35m        prev_active = ctx._active[0m

[31m--[ [0m[34mMatch #[0m[33m493[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/releasenotes/notes/image-optimization-d614eccb59441217.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m---[0m
[30;1m2 | [0m[35mother:[0m
[30;1m3 | [0m[35m  - |[0m
[30;1m4 | [0m[35m    The image size has been cut roughly in half.[0m

[31m--[ [0m[34mMatch #[0m[33m494[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/releasenotes/notes/support-tracking-of-tested-integrations-ac19ccd1f8333c00.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2 | [0m[35mfeatures:[0m
[30;1m3 | [0m[35m  - |[0m
[30;1m4 | [0m[35m    Add support for tracking the integrations being tested. Tracked integrations can be recorded by [0m
[30;1m5 | [0m[35m    at `/test/session/integrations`. To get data about which integrations the Test Agent encountered[0m
[30;1m6 | [0m[35m    Tested integrations include information such as the integration name, the tested integration ver[0m
[30;1m7 | [0m[35m    dependency name of the integration.[0m

[31m--[ [0m[34mMatch #[0m[33m495[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_container.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m56 | [0m[35m    _cmd += [image][0m
[30;1m57 | [0m[35m    _cmd.extend(cmd)[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m    # Run the docker container[0m
[30;1m60 | [0m[35m    p = subprocess.run(_cmd, capture_output=True)[0m
[30;1m61 | [0m[35m    assert p.returncode == 0, p.stderr[0m
[30;1m62 | [0m[35m    cid = p.stdout.decode().strip()[0m

[31m--[ [0m[34mMatch #[0m[33m496[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_container.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mdef is_docker_available():[0m
[30;1m16 | [0m[35m    """Check if the Docker binary is available on the system."""[0m
[30;1m17 | [0m[35m    return shutil.which("docker") is not None[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m497[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_container.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mimport platform[0m
[30;1m4 | [0m[35mimport shutil[0m
[30;1m5 | [0m[35mimport subprocess[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mfrom typing import Dict[0m
[30;1m8 | [0m[35mfrom typing import Generator[0m
[30;1m9 | [0m[35mfrom typing import List[0m
[30;1m10 | [0m[35mfrom typing import Tuple[0m

[31m--[ [0m[34mMatch #[0m[33m498[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/releasenotes/notes/python310-docker-image-d4e329cfecf6510e.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m---[0m
[30;1m2 | [0m[35mfeatures:[0m
[30;1m3 | [0m[35m  - |[0m
[30;1m4 | [0m[35m    Use Python 3.11 in the Docker image.[0m

[31m--[ [0m[34mMatch #[0m[33m499[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/releasenotes/notes/python-3.12-952e06c6158af67d.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m---[0m
[30;1m2 | [0m[35mfeatures:[0m
[30;1m3 | [0m[35m  - |[0m
[30;1m4 | [0m[35m    Add support for Python 3.12. The interpreter used in the Docker image is[0m
[30;1m5 | [0m[35m    now also Python 3.12. This should lead to some better error messages and[0m
[30;1m6 | [0m[35m    some performance improvement.[0m

[31m--[ [0m[34mMatch #[0m[33m500[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m.hostname[0m
[30;1m434 | [0m[35m    "source": "...",[0m
[30;1m435 | [0m[35m    "case_id": "...",[0m
[30;1m436 | [0m[35m    "email": "...",[0m
[30;1m437 | [0m[35m    "hostname": "...",[0m
[30;1m438 | [0m[35m    "flare_file": "...",[0m
[30;1m439 | [0m[35m  }[0m
[30;1m440 | [0m[35m][0m

[31m--[ [0m[34mMatch #[0m[33m501[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m387 | [0m[35mcurl -X GET 'http://0.0.0.0:8126/test/trace_check/summary'[0m
[30;1m388 | [0m[35m```[0m
[30;1m389 | [0m[35m[0m
[30;1m390 | [0m[35m### /test/session/integrations (PUT)[0m
[30;1m391 | [0m[35mUpdate information about the current tested integration.[0m
[30;1m392 | [0m[35m[0m
[30;1m393 | [0m[35m#### [optional] `?test_session_token=`[0m
[30;1m394 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m

[31m--[ [0m[34mMatch #[0m[33m502[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m174 | [0m[35mtem.process_id,meta.runtime-id"`]: The[0m
[30;1m175 | [0m[35m  attributes to ignore when comparing spans in snapshots.[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m- `DD_AGENT_URL` [`""`]: URL to a Datadog agent. When provided requests will be proxied to the agent[0m
[30;1m178 | [0m[35m[0m
[30;1m179 | [0m[35m- `DD_APM_RECEIVER_SOCKET` [`""`]: When provided, the test agent will listen for traces on a socket [0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m- `DD_SUPPRESS_TRACE_PARSE_ERRORS` [`false`]: Set to `"true"` to disable span parse errors when deco[0m

[31m--[ [0m[34mMatch #[0m[33m503[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m`ddapm-test-agent-fmt` is a command line tool to format or lint snapshot json files.[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m``` bash[0m
[30;1m147 | [0m[35m# Format all snapshot json files[0m
[30;1m148 | [0m[35mddapm-test-agent-fmt path/to/snapshots[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m# Lint snapshot json files[0m

[31m--[ [0m[34mMatch #[0m[33m504[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m92 | [0m[35mThis is enabled by passing the agent url to the test agent either via the `--agent-url` command-line[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35mWhen proxying is enabled, the response from the Datadog agent will be returned instead of one from t[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35mAt the trace-level, proxying can also be disabled by including the `X-Datadog-Agent-Proxy-Disabled` [0m
[30;1m97 | [0m[35mis handled, regardless of whether an agent URL is set.[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m505[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m524 | [0m[35m[0m
[30;1m525 | [0m[35m1. Checkout the `master` branch and make sure it's up to date.[0m
[30;1m526 | [0m[35m```bash[0m
[30;1m527 | [0m[35m    git checkout master && git pull[0m
[30;1m528 | [0m[35m```[0m
[30;1m529 | [0m[35m2. Generate the release notes and use [`pandoc`](https://pandoc.org/) to format[0m
[30;1m530 | [0m[35mthem for Github:[0m

[31m--[ [0m[34mMatch #[0m[33m506[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m524 | [0m[35m[0m
[30;1m525 | [0m[35m1. Checkout the `master` branch and make sure it's up to date.[0m
[30;1m526 | [0m[35m```bash[0m
[30;1m527 | [0m[35m    git checkout master && git pull[0m
[30;1m528 | [0m[35m```[0m
[30;1m529 | [0m[35m2. Generate the release notes and use [`pandoc`](https://pandoc.org/) to format[0m
[30;1m530 | [0m[35mthem for Github:[0m

[31m--[ [0m[34mMatch #[0m[33m507[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m501 | [0m[35m[0m
[30;1m502 | [0m[35mRun the tagged image:[0m
[30;1m503 | [0m[35m[0m
[30;1m504 | [0m[35m```bash[0m
[30;1m505 | [0m[35mdocker run --rm -v ${PWD}/snaps:/snapshots --publish 8126:8126 agent[0m
[30;1m506 | [0m[35m```[0m
[30;1m507 | [0m[35m[0m
[30;1m508 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m508[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m495 | [0m[35m[0m
[30;1m496 | [0m[35mTo build (and tag) the dockerfile:[0m
[30;1m497 | [0m[35m[0m
[30;1m498 | [0m[35m```bash[0m
[30;1m499 | [0m[35mdocker build --tag testagent .[0m
[30;1m500 | [0m[35m```[0m
[30;1m501 | [0m[35m[0m
[30;1m502 | [0m[35mRun the tagged image:[0m

[31m--[ [0m[34mMatch #[0m[33m509[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m491 | [0m[35m    riot run -s fmt[0m
[30;1m492 | [0m[35m    riot run -s mypy[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35m### Docker[0m
[30;1m495 | [0m[35m[0m
[30;1m496 | [0m[35mTo build (and tag) the dockerfile:[0m
[30;1m497 | [0m[35m[0m
[30;1m498 | [0m[35m```bash[0m

[31m--[ [0m[34mMatch #[0m[33m510[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m488 | [0m[35mTo lint, format and type-check the code:[0m
[30;1m489 | [0m[35m[0m
[30;1m490 | [0m[35m    riot run -s flake8[0m
[30;1m491 | [0m[35m    riot run -s fmt[0m
[30;1m492 | [0m[35m    riot run -s mypy[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35m### Docker[0m
[30;1m495 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m511[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m469 | [0m[35m[0m
[30;1m470 | [0m[35m    python3.12 -m venv .venv[0m
[30;1m471 | [0m[35m    source .venv/bin/activate[0m
[30;1m472 | [0m[35m    pip install -e '.[testing]'[0m
[30;1m473 | [0m[35m[0m
[30;1m474 | [0m[35m[0m
[30;1m475 | [0m[35m### Running the tests[0m

[31m--[ [0m[34mMatch #[0m[33m512[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m456 | [0m[35mSupported keys:[0m
[30;1m457 | [0m[35m - `trace_request_delay`: sets a delay to apply to trace and telemetry requests[0m
[30;1m458 | [0m[35m[0m
[30;1m459 | [0m[35m ```[0m
[30;1m460 | [0m[35mcurl -X POST 'http://0.0.0.0:8126/test/settings' -d '{ "trace_request_delay": 5 }'[0m
[30;1m461 | [0m[35m```[0m
[30;1m462 | [0m[35m[0m
[30;1m463 | [0m[35m## Development[0m

[31m--[ [0m[34mMatch #[0m[33m513[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m440 | [0m[35m][0m
[30;1m441 | [0m[35m```[0m
[30;1m442 | [0m[35m[0m
[30;1m443 | [0m[35m`flare_file` is the base64 encoded content of the tracer-flare payload.[0m
[30;1m444 | [0m[35m[0m
[30;1m445 | [0m[35mIf there was an error parsing the tracer-flare form, that will be recorded under `error`.[0m
[30;1m446 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m514[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m405 | [0m[35m#### [optional] `?test_session_token=`[0m
[30;1m406 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m
[30;1m407 | [0m[35m[0m
[30;1m408 | [0m[35m```[0m
[30;1m409 | [0m[35mcurl -X GET 'http://0.0.0.0:8126/test/integrations/tested_versions'[0m
[30;1m410 | [0m[35m```[0m
[30;1m411 | [0m[35m[0m
[30;1m412 | [0m[35m### /v0.1/pipeline_stats[0m

[31m--[ [0m[34mMatch #[0m[33m515[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m393 | [0m[35m#### [optional] `?test_session_token=`[0m
[30;1m394 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m
[30;1m395 | [0m[35m[0m
[30;1m396 | [0m[35m```[0m
[30;1m397 | [0m[35mcurl -X PUT 'http://0.0.0.0:8126/test/session/integrations' -d '{"integration_name": [INTEGRATION_NA[0m
[30;1m398 | [0m[35m"dependency_name": [DEPENDENCY_NAME], "tracer_language": [TRACER_LANGUAGE], "tracer_version": [TRACE[0m
[30;1m399 | [0m[35m```[0m
[30;1m400 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m516[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m383 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m
[30;1m384 | [0m[35m#### [optional] `?return_all=`[0m
[30;1m385 | [0m[35m[0m
[30;1m386 | [0m[35m```[0m
[30;1m387 | [0m[35mcurl -X GET 'http://0.0.0.0:8126/test/trace_check/summary'[0m
[30;1m388 | [0m[35m```[0m
[30;1m389 | [0m[35m[0m
[30;1m390 | [0m[35m### /test/session/integrations (PUT)[0m

[31m--[ [0m[34mMatch #[0m[33m517[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m363 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m
[30;1m364 | [0m[35m#### [optional] `?clear_all=`[0m
[30;1m365 | [0m[35m[0m
[30;1m366 | [0m[35m```[0m
[30;1m367 | [0m[35mcurl -X GET 'http://0.0.0.0:8126/test/trace_check/clear'[0m
[30;1m368 | [0m[35m```[0m
[30;1m369 | [0m[35m[0m
[30;1m370 | [0m[35m### /test/trace_check/summary (GET)[0m

[31m--[ [0m[34mMatch #[0m[33m518[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m352 | [0m[35m#### [optional] `?use_json=`[0m
[30;1m353 | [0m[35m#### [optional] `?return_all=`[0m
[30;1m354 | [0m[35m[0m
[30;1m355 | [0m[35m```[0m
[30;1m356 | [0m[35mcurl -X GET 'http://0.0.0.0:8126/test/trace_check/failures'[0m
[30;1m357 | [0m[35m```[0m
[30;1m358 | [0m[35m[0m
[30;1m359 | [0m[35m### /test/trace_check/clear (GET)[0m

[31m--[ [0m[34mMatch #[0m[33m519[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m332 | [0m[35m#### [optional] `?test_session_token=`[0m
[30;1m333 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m
[30;1m334 | [0m[35m[0m
[30;1m335 | [0m[35m```[0m
[30;1m336 | [0m[35mcurl -X POST 'http://0.0.0.0:8126/test/session/responses/config/path' -d '{"path": "datadog/2/ASM_DA[0m
[30;1m337 | [0m[35m```[0m
[30;1m338 | [0m[35m[0m
[30;1m339 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m520[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m319 | [0m[35m#### [optional] `?test_session_token=`[0m
[30;1m320 | [0m[35m#### [optional] `X-Datadog-Test-Session-Token`[0m
[30;1m321 | [0m[35m[0m
[30;1m322 | [0m[35m```[0m
[30;1m323 | [0m[35mcurl -X POST 'http://0.0.0.0:8126/test/session/responses/config/path' -d '{"roots": ["eyJ....fX0="],[0m
[30;1m324 | [0m[35m```[0m
[30;1m325 | [0m[35m[0m
[30;1m326 | [0m[35m### /test/session/responses/config/path (POST)[0m

[31m--[ [0m[34mMatch #[0m[33m521[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m294 | [0m[35m][0m
[30;1m295 | [0m[35m```[0m
[30;1m296 | [0m[35m[0m
[30;1m297 | [0m[35m`body` is a base64 encoded body of the request.[0m
[30;1m298 | [0m[35m[0m
[30;1m299 | [0m[35m### /test/session/traces[0m
[30;1m300 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m522[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m- `DD_POOL_TRACE_CHECK_FAILURES` [`false`]: Set to `"true"` to pool Trace Check failures that occure[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m- `DD_DISABLE_ERROR_RESPONSES` [`false`]: Set to `"true"` to disable Test-Agent `<Response 400>` whe[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m## HTTP API[0m

[31m--[ [0m[34mMatch #[0m[33m523[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m`ddapm-test-agent-fmt` is a command line tool to format or lint snapshot json files.[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m``` bash[0m
[30;1m147 | [0m[35m# Format all snapshot json files[0m
[30;1m148 | [0m[35mddapm-test-agent-fmt path/to/snapshots[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m# Lint snapshot json files[0m

[31m--[ [0m[34mMatch #[0m[33m524[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35mor a specific branch:[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    pip install git+https://github.com/Datadog/dd-apm-test-agent@{branch}[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m## Features[0m

[31m--[ [0m[34mMatch #[0m[33m525[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35mor from source:[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    pip install git+https://github.com/Datadog/dd-apm-test-agent[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35mor a specific branch:[0m
[30;1m45 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m526[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35mor from Docker:[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    # Run the test agent and mount the snapshot directory[0m
[30;1m34 | [0m[35m    docker run --rm\[0m
[30;1m35 | [0m[35m            -p 8126:8126\[0m
[30;1m36 | [0m[35m            -e SNAPSHOT_CI=0\[0m
[30;1m37 | [0m[35m            -v $PWD/tests/snapshots:/snapshots\[0m

[31m--[ [0m[34mMatch #[0m[33m527[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35mor from Docker:[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    # Run the test agent and mount the snapshot directory[0m
[30;1m34 | [0m[35m    docker run --rm\[0m
[30;1m35 | [0m[35m            -p 8126:8126\[0m
[30;1m36 | [0m[35m            -e SNAPSHOT_CI=0\[0m

[31m--[ [0m[34mMatch #[0m[33m528[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mThe test agent can be installed from PyPI:[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    pip install ddapm-test-agent[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    ddapm-test-agent --port=8126[0m
[30;1m30 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m529[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/use-example.Dockerfile[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35mFROM bash [0m
[30;1m2 | [0m[35mCOPY --from=ghcr.io/pawelchcki/ddapm-test-agent / /[0m
[30;1m3 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m530[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/use-example.Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mFROM bash [0m
[30;1m2 | [0m[35mCOPY --from=ghcr.io/pawelchcki/ddapm-test-agent / /[0m
[30;1m3 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m531[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/.github/workflows/docker.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m    - name: Login to Docker[0m
[30;1m41 | [0m[35m      run: docker login -u publisher -p ${{ secrets.GITHUB_TOKEN }} ghcr.io[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    - name: Docker Build[0m
[30;1m44 | [0m[35m      uses: docker/build-push-action@v3[0m
[30;1m45 | [0m[35m      with:[0m
[30;1m46 | [0m[35m        push: true[0m

[31m--[ [0m[34mMatch #[0m[33m532[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/.github/workflows/docker.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m        echo "::set-output name=image_name::$DOCKER_IMAGE_NAME_WITH_TAG"[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    - name: Login to Docker[0m
[30;1m41 | [0m[35m      run: docker login -u publisher -p ${{ secrets.GITHUB_TOKEN }} ghcr.io[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    - name: Docker Build[0m
[30;1m44 | [0m[35m      uses: docker/build-push-action@v3[0m

[31m--[ [0m[34mMatch #[0m[33m533[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/.github/workflows/docker.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m        echo "Using image name '$DOCKER_IMAGE_NAME_WITH_TAG'"[0m
[30;1m38 | [0m[35m        echo "::set-output name=image_name::$DOCKER_IMAGE_NAME_WITH_TAG"[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    - name: Login to Docker[0m
[30;1m41 | [0m[35m      run: docker login -u publisher -p ${{ secrets.GITHUB_TOKEN }} ghcr.io[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    - name: Docker Build[0m
[30;1m44 | [0m[35m      uses: docker/build-push-action@v3[0m

[31m--[ [0m[34mMatch #[0m[33m534[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/.github/workflows/docker.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m      id: set_names[0m
[30;1m28 | [0m[35m      run: |[0m
[30;1m29 | [0m[35m        if [ "${{ startsWith(github.ref, 'refs/tags/') }}" == "true" ]; then[0m
[30;1m30 | [0m[35m          DOCKER_IMAGE_TAG=$(echo ${GITHUB_REF} | sed -e "s/refs\/tags\///g")[0m
[30;1m31 | [0m[35m        else[0m
[30;1m32 | [0m[35m          DOCKER_IMAGE_TAG="latest"[0m
[30;1m33 | [0m[35m        fi[0m

[31m--[ [0m[34mMatch #[0m[33m535[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/.github/workflows/docker.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m    - name: Available platforms[0m
[30;1m24 | [0m[35m      run: echo ${{ steps.buildx.outputs.platforms }}[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    - name: Set Docker Image Tag[0m
[30;1m27 | [0m[35m      id: set_names[0m
[30;1m28 | [0m[35m      run: |[0m
[30;1m29 | [0m[35m        if [ "${{ startsWith(github.ref, 'refs/tags/') }}" == "true" ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m536[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/.github/workflows/docker.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35m    - name: Set up QEMU[0m
[30;1m17 | [0m[35m      uses: docker/setup-qemu-action@v2[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    - name: Set up Docker Buildx[0m
[30;1m20 | [0m[35m      id: buildx[0m
[30;1m21 | [0m[35m      uses: docker/setup-buildx-action@v2[0m
[30;1m22 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m537[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/.github/workflows/docker.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mname: Publish latest Docker images[0m
[30;1m2 | [0m[35mon:[0m
[30;1m3 | [0m[35m  push:[0m
[30;1m4 | [0m[35m  release:[0m

[31m--[ [0m[34mMatch #[0m[33m538[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/treefmt.nix[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m# treefmt.nix[0m
[30;1m2 | [0m[35m{ pkgs, ... }:[0m
[30;1m3 | [0m[35m{[0m
[30;1m4 | [0m[35m  # Used to find the project root[0m
[30;1m5 | [0m[35m  projectRootFile = "flake.nix";[0m
[30;1m6 | [0m[35m  # Enable the Nix formatter [0m
[30;1m7 | [0m[35m  programs.nixfmt.enable = true;[0m

[31m--[ [0m[34mMatch #[0m[33m539[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_tracerflare.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m    }[0m
[30;1m62 | [0m[35m    resp = await agent.post("/tracer_flare/v1", data=form)[0m
[30;1m63 | [0m[35m    assert resp.status == 400[0m
[30;1m64 | [0m[35m    flares = await agent.get("/test/session/tracerflares")[0m
[30;1m65 | [0m[35m    assert await flares.json() == [expected_output][0m

[31m--[ [0m[34mMatch #[0m[33m540[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_tracerflare.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m        "email": "its.me@datadoghq.com",[0m
[30;1m60 | [0m[35m        "hostname": "my.hostname",[0m
[30;1m61 | [0m[35m    }[0m
[30;1m62 | [0m[35m    resp = await agent.post("/tracer_flare/v1", data=form)[0m
[30;1m63 | [0m[35m    assert resp.status == 400[0m
[30;1m64 | [0m[35m    flares = await agent.get("/test/session/tracerflares")[0m
[30;1m65 | [0m[35m    assert await flares.json() == [expected_output][0m

[31m--[ [0m[34mMatch #[0m[33m541[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_tracerflare.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m    )[0m
[30;1m46 | [0m[35m    resp = await agent.post("/tracer_flare/v1", data=form)[0m
[30;1m47 | [0m[35m    assert resp.status == 400[0m
[30;1m48 | [0m[35m    flares = await agent.get("/test/session/tracerflares")[0m
[30;1m49 | [0m[35m    assert await flares.json() == [expected_output][0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m542[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_tracerflare.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m        filename="test-flare.zip",[0m
[30;1m44 | [0m[35m        content_type="application/octet-stream",[0m
[30;1m45 | [0m[35m    )[0m
[30;1m46 | [0m[35m    resp = await agent.post("/tracer_flare/v1", data=form)[0m
[30;1m47 | [0m[35m    assert resp.status == 400[0m
[30;1m48 | [0m[35m    flares = await agent.get("/test/session/tracerflares")[0m
[30;1m49 | [0m[35m    assert await flares.json() == [expected_output][0m

[31m--[ [0m[34mMatch #[0m[33m543[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_tracerflare.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m    )[0m
[30;1m23 | [0m[35m    resp = await agent.post("/tracer_flare/v1", data=form)[0m
[30;1m24 | [0m[35m    assert resp.status == 200[0m
[30;1m25 | [0m[35m    flares = await agent.get("/test/session/tracerflares")[0m
[30;1m26 | [0m[35m    assert await flares.json() == [expected_output][0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m544[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_tracerflare.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m        filename="test-flare.zip",[0m
[30;1m21 | [0m[35m        content_type="application/octet-stream",[0m
[30;1m22 | [0m[35m    )[0m
[30;1m23 | [0m[35m    resp = await agent.post("/tracer_flare/v1", data=form)[0m
[30;1m24 | [0m[35m    assert resp.status == 200[0m
[30;1m25 | [0m[35m    flares = await agent.get("/test/session/tracerflares")[0m
[30;1m26 | [0m[35m    assert await flares.json() == [expected_output][0m

[31m--[ [0m[34mMatch #[0m[33m545[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_tracerflare.py[0m
   Pattern: [32m.hostname[0m
[30;1m57 | [0m[35m        "source": "tracer_test",[0m
[30;1m58 | [0m[35m        "case_id": "12345",[0m
[30;1m59 | [0m[35m        "email": "its.me@datadoghq.com",[0m
[30;1m60 | [0m[35m        "hostname": "my.hostname",[0m
[30;1m61 | [0m[35m    }[0m
[30;1m62 | [0m[35m    resp = await agent.post("/tracer_flare/v1", data=form)[0m
[30;1m63 | [0m[35m    assert resp.status == 400[0m

[31m--[ [0m[34mMatch #[0m[33m546[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_tracerflare.py[0m
   Pattern: [32m.hostname[0m
[30;1m57 | [0m[35m        "source": "tracer_test",[0m
[30;1m58 | [0m[35m        "case_id": "12345",[0m
[30;1m59 | [0m[35m        "email": "its.me@datadoghq.com",[0m
[30;1m60 | [0m[35m        "hostname": "my.hostname",[0m
[30;1m61 | [0m[35m    }[0m
[30;1m62 | [0m[35m    resp = await agent.post("/tracer_flare/v1", data=form)[0m
[30;1m63 | [0m[35m    assert resp.status == 400[0m

[31m--[ [0m[34mMatch #[0m[33m547[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_tracerflare.py[0m
   Pattern: [32m.hostname[0m
[30;1m36 | [0m[35m    form = FormData()[0m
[30;1m37 | [0m[35m    form.add_field("source", "tracer_test")[0m
[30;1m38 | [0m[35m    form.add_field("email", "its.me@datadoghq.com")[0m
[30;1m39 | [0m[35m    form.add_field("hostname", "my.hostname")[0m
[30;1m40 | [0m[35m    form.add_field([0m
[30;1m41 | [0m[35m        "flare_file",[0m
[30;1m42 | [0m[35m        b"PK\x05\x06\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0",[0m

[31m--[ [0m[34mMatch #[0m[33m548[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_tracerflare.py[0m
   Pattern: [32m.hostname[0m
[30;1m36 | [0m[35m    form = FormData()[0m
[30;1m37 | [0m[35m    form.add_field("source", "tracer_test")[0m
[30;1m38 | [0m[35m    form.add_field("email", "its.me@datadoghq.com")[0m
[30;1m39 | [0m[35m    form.add_field("hostname", "my.hostname")[0m
[30;1m40 | [0m[35m    form.add_field([0m
[30;1m41 | [0m[35m        "flare_file",[0m
[30;1m42 | [0m[35m        b"PK\x05\x06\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0",[0m

[31m--[ [0m[34mMatch #[0m[33m549[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_tracerflare.py[0m
   Pattern: [32m.hostname[0m
[30;1m30 | [0m[35m    expected_output = {[0m
[30;1m31 | [0m[35m        "source": "tracer_test",[0m
[30;1m32 | [0m[35m        "email": "its.me@datadoghq.com",[0m
[30;1m33 | [0m[35m        "hostname": "my.hostname",[0m
[30;1m34 | [0m[35m        "flare_file": "UEsFBgAAAAAAAAAAAAAAAAAAAAAAAA==",[0m
[30;1m35 | [0m[35m    }[0m
[30;1m36 | [0m[35m    form = FormData()[0m

[31m--[ [0m[34mMatch #[0m[33m550[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_tracerflare.py[0m
   Pattern: [32m.hostname[0m
[30;1m30 | [0m[35m    expected_output = {[0m
[30;1m31 | [0m[35m        "source": "tracer_test",[0m
[30;1m32 | [0m[35m        "email": "its.me@datadoghq.com",[0m
[30;1m33 | [0m[35m        "hostname": "my.hostname",[0m
[30;1m34 | [0m[35m        "flare_file": "UEsFBgAAAAAAAAAAAAAAAAAAAAAAAA==",[0m
[30;1m35 | [0m[35m    }[0m
[30;1m36 | [0m[35m    form = FormData()[0m

[31m--[ [0m[34mMatch #[0m[33m551[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_tracerflare.py[0m
   Pattern: [32m.hostname[0m
[30;1m13 | [0m[35m    form.add_field("source", "tracer_test")[0m
[30;1m14 | [0m[35m    form.add_field("case_id", "12345")[0m
[30;1m15 | [0m[35m    form.add_field("email", "its.me@datadoghq.com")[0m
[30;1m16 | [0m[35m    form.add_field("hostname", "my.hostname")[0m
[30;1m17 | [0m[35m    form.add_field([0m
[30;1m18 | [0m[35m        "flare_file",[0m
[30;1m19 | [0m[35m        b"PK\x05\x06\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0",[0m

[31m--[ [0m[34mMatch #[0m[33m552[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_tracerflare.py[0m
   Pattern: [32m.hostname[0m
[30;1m13 | [0m[35m    form.add_field("source", "tracer_test")[0m
[30;1m14 | [0m[35m    form.add_field("case_id", "12345")[0m
[30;1m15 | [0m[35m    form.add_field("email", "its.me@datadoghq.com")[0m
[30;1m16 | [0m[35m    form.add_field("hostname", "my.hostname")[0m
[30;1m17 | [0m[35m    form.add_field([0m
[30;1m18 | [0m[35m        "flare_file",[0m
[30;1m19 | [0m[35m        b"PK\x05\x06\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0",[0m

[31m--[ [0m[34mMatch #[0m[33m553[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_tracerflare.py[0m
   Pattern: [32m.hostname[0m
[30;1m6 | [0m[35m        "source": "tracer_test",[0m
[30;1m7 | [0m[35m        "case_id": "12345",[0m
[30;1m8 | [0m[35m        "email": "its.me@datadoghq.com",[0m
[30;1m9 | [0m[35m        "hostname": "my.hostname",[0m
[30;1m10 | [0m[35m        "flare_file": "UEsFBgAAAAAAAAAAAAAAAAAAAAAAAA==",[0m
[30;1m11 | [0m[35m    }[0m
[30;1m12 | [0m[35m    form = FormData()[0m

[31m--[ [0m[34mMatch #[0m[33m554[0m[34m of [0m[33m554[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/ddapm_test_agent-1.21.1/tests/test_tracerflare.py[0m
   Pattern: [32m.hostname[0m
[30;1m6 | [0m[35m        "source": "tracer_test",[0m
[30;1m7 | [0m[35m        "case_id": "12345",[0m
[30;1m8 | [0m[35m        "email": "its.me@datadoghq.com",[0m
[30;1m9 | [0m[35m        "hostname": "my.hostname",[0m
[30;1m10 | [0m[35m        "flare_file": "UEsFBgAAAAAAAAAAAAAAAAAAAAAAAA==",[0m
[30;1m11 | [0m[35m    }[0m
[30;1m12 | [0m[35m    form = FormData()[0m

554 matches found.
