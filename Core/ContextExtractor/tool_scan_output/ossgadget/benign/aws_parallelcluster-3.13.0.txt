[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/common.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m40 | [0m[35mdef _set_region(region):[0m
[30;1m41 | [0m[35m    if not region:[0m
[30;1m42 | [0m[35m        raise BadRequestException("region needs to be set")[0m
[30;1m43 | [0m[35m    region_backup = os.environ.get("AWS_DEFAULT_REGION")[0m
[30;1m44 | [0m[35m    LOGGER.info("Setting AWS Region to %s", region)[0m
[30;1m45 | [0m[35m    os.environ["AWS_DEFAULT_REGION"] = region[0m
[30;1m46 | [0m[35m    if region not in retrieve_supported_regions():[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/batch.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m    def _call_create_compute_environment_with_bad_instance_type(self):[0m
[30;1m85 | [0m[35m        """[0m
[30;1m86 | [0m[35m        Call CreateComputeEnvironment with a nonexistent instance type.[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m        For more information on why this would be done, see the docstring for[0m
[30;1m89 | [0m[35m        _get_supported_instance_types_create_compute_environment_error_message.[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/batch.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m81 | [0m[35m                "in an error as expected."[0m
[30;1m82 | [0m[35m            )[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m    def _call_create_compute_environment_with_bad_instance_type(self):[0m
[30;1m85 | [0m[35m        """[0m
[30;1m86 | [0m[35m        Call CreateComputeEnvironment with a nonexistent instance type.[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/batch.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m77 | [0m[35m        else:[0m
[30;1m78 | [0m[35m            # TODO: need to delete the compute environment?[0m
[30;1m79 | [0m[35m            raise BatchErrorMessageParsingException([0m
[30;1m80 | [0m[35m                "Attempting to create a Batch ComputeEnvironment using a nonexistent instance type d[0m
[30;1m81 | [0m[35m                "in an error as expected."[0m
[30;1m82 | [0m[35m            )[0m
[30;1m83 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/batch.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m66 | [0m[35m        The returned error message is expected to have a list of supported instance types.[0m
[30;1m67 | [0m[35m        """[0m
[30;1m68 | [0m[35m        try:[0m
[30;1m69 | [0m[35m            self._call_create_compute_environment_with_bad_instance_type()[0m
[30;1m70 | [0m[35m        except ClientError as e:[0m
[30;1m71 | [0m[35m            # This is the expected behavior[0m
[30;1m72 | [0m[35m            return e.response.get("Error").get("Message")[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/batch.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    def _get_cce_emsg_containing_supported_instance_types(self):[0m
[30;1m63 | [0m[35m        """[0m
[30;1m64 | [0m[35m        Call CreateComputeEnvironment with nonexistent instance type and return error message.[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m        The returned error message is expected to have a list of supported instance types.[0m
[30;1m67 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/entrypoint.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m25 | [0m[35m# Initialize as a global to re-use across Lambda invocations[0m
[30;1m26 | [0m[35mpcluster_api = None  # pylint: disable=invalid-name[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mprofile = environ.get("PROFILE", "prod")[0m
[30;1m29 | [0m[35mis_dev_profile = profile == "dev"[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35mif is_dev_profile:[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/send_build_notification.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m18 | [0m[35m    """Handle CodeBuild build status changes and send notifications to CFN WaitCondition."""[0m
[30;1m19 | [0m[35m    print("CodeBuild event: %s" % json.dumps(event))[0m
[30;1m20 | [0m[35m    environment_variables = event["detail"]["additional-information"]["environment"]["environment-va[0m
[30;1m21 | [0m[35m    notification_url = next(var.get("value") for var in environment_variables if var.get("name") == [0m
[30;1m22 | [0m[35m    succeeded = event["detail"]["build-status"] == "SUCCEEDED"[0m
[30;1m23 | [0m[35m    data = json.dumps([0m
[30;1m24 | [0m[35m        {[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m321 | [0m[35m[0m
[30;1m322 | [0m[35mdef get_cli_log_file():[0m
[30;1m323 | [0m[35m    default_log_file = os.path.expanduser(os.path.join("~", ".parallelcluster", "pcluster-cli.log"))[0m
[30;1m324 | [0m[35m    return os.environ.get("PCLUSTER_LOG_FILE", default=default_log_file)[0m
[30;1m325 | [0m[35m[0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35mdef ellipsize(text, max_length):[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/logger.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m54 | [0m[35m            "pcluster": {"handlers": ["default"], "level": "INFO", "propagate": False},[0m
[30;1m55 | [0m[35m        },[0m
[30;1m56 | [0m[35m    }[0m
[30;1m57 | [0m[35m    if os.environ.get("PCLUSTER_LOG_TO_STDOUT"):[0m
[30;1m58 | [0m[35m        for logger in logging_config["loggers"].values():[0m
[30;1m59 | [0m[35m            logger["handlers"] = ["console"][0m
[30;1m60 | [0m[35m    os.makedirs(os.path.dirname(logfile), exist_ok=True)[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/secret_validators.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m74 | [0m[35m                    )[0m
[30;1m75 | [0m[35m            except binascii.Error:[0m
[30;1m76 | [0m[35m                self._add_failure([0m
[30;1m77 | [0m[35m                    f"The content of the secret {munge_key_secret_arn} is not a valid Base64 encoded[0m
[30;1m78 | [0m[35m                    f"Please refer to the ParallelCluster official documentation for more informatio[0m
[30;1m79 | [0m[35m                    FailureLevel.ERROR,[0m
[30;1m80 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/secret_validators.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m            try:[0m
[30;1m65 | [0m[35m                # Try decoding key value from Base64[0m
[30;1m66 | [0m[35m                decoded_secret = base64.b64decode(secret_value, validate=True)[0m
[30;1m67 | [0m[35m                # Check if the size of the decoding key is within the accepted range[0m
[30;1m68 | [0m[35m                decoded_secret_size_in_bits = len(decoded_secret) * 8[0m
[30;1m69 | [0m[35m                if decoded_secret_size_in_bits < 256 or decoded_secret_size_in_bits > 8192:[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/secret_validators.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m62 | [0m[35m                return[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m            try:[0m
[30;1m65 | [0m[35m                # Try decoding key value from Base64[0m
[30;1m66 | [0m[35m                decoded_secret = base64.b64decode(secret_value, validate=True)[0m
[30;1m67 | [0m[35m                # Check if the size of the decoding key is within the accepted range[0m
[30;1m68 | [0m[35m                decoded_secret_size_in_bits = len(decoded_secret) * 8[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/secret_validators.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    def _validate(self, munge_key_secret_arn: str):[0m
[30;1m52 | [0m[35m        try:[0m
[30;1m53 | [0m[35m            # Get the actual key value to check if it is a valid Base64[0m
[30;1m54 | [0m[35m            secret_response = AWSApi.instance().secretsmanager.get_secret_value(munge_key_secret_arn[0m
[30;1m55 | [0m[35m            secret_value = secret_response.get("SecretString")[0m
[30;1m56 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/secret_validators.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m41 | [0m[35m      numbers, '+', '/', and possibly trailing '=' padding chars.[0m
[30;1m42 | [0m[35m    - The '=' padding is used if the number of bytes being encoded is not divisible by 3.[0m
[30;1m43 | [0m[35m    Given these rules:[0m
[30;1m44 | [0m[35m    - "validBase64" is valid because its length is a multiple of 4 and uses valid Base64 characters.[0m
[30;1m45 | [0m[35m    - "invalidBase64" is invalid because its length is not a multiple of 4.[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    Also:[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/secret_validators.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m37 | [0m[35m    In Base64 encoding:[0m
[30;1m38 | [0m[35m    - Every 3 bytes of input are represented as 4 characters in the encoded string.[0m
[30;1m39 | [0m[35m    - The length of the encoded string must be a multiple of 4.[0m
[30;1m40 | [0m[35m    - Valid Base64 characters include upper/lowercase letters,[0m
[30;1m41 | [0m[35m      numbers, '+', '/', and possibly trailing '=' padding chars.[0m
[30;1m42 | [0m[35m    - The '=' padding is used if the number of bytes being encoded is not divisible by 3.[0m
[30;1m43 | [0m[35m    Given these rules:[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/secret_validators.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m34 | [0m[35mclass MungeKeySecretSizeAndBase64Validator(Validator):[0m
[30;1m35 | [0m[35m    """Validate that MungeKeySecretArn exists.[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    In Base64 encoding:[0m
[30;1m38 | [0m[35m    - Every 3 bytes of input are represented as 4 characters in the encoded string.[0m
[30;1m39 | [0m[35m    - The length of the encoded string must be a multiple of 4.[0m
[30;1m40 | [0m[35m    - Valid Base64 characters include upper/lowercase letters,[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/secret_validators.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m9 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m10 | [0m[35m# limitations under the License.[0m
[30;1m11 | [0m[35mimport base64[0m
[30;1m12 | [0m[35mimport binascii[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mfrom pcluster.aws.aws_api import AWSApi[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m835 | [0m[35m                    sid="AllowGettingSlurmDbSecretValue",[0m
[30;1m836 | [0m[35m                    actions=["secretsmanager:GetSecretValue"],[0m
[30;1m837 | [0m[35m                    effect=iam.Effect.ALLOW,[0m
[30;1m838 | [0m[35m                    resources=[self._config.scheduling.settings.database.password_secret_arn],[0m
[30;1m839 | [0m[35m                )[0m
[30;1m840 | [0m[35m            )[0m
[30;1m841 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m825 | [0m[35m                        )[0m
[30;1m826 | [0m[35m                    ],[0m
[30;1m827 | [0m[35m                    effect=iam.Effect.ALLOW,[0m
[30;1m828 | [0m[35m                    resources=[self._config.directory_service.password_secret_arn],[0m
[30;1m829 | [0m[35m                )[0m
[30;1m830 | [0m[35m            )[0m
[30;1m831 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m821 | [0m[35m                        ([0m
[30;1m822 | [0m[35m                            "secretsmanager:GetSecretValue"[0m
[30;1m823 | [0m[35m                            if password_secret_arn.service == "secretsmanager"[0m
[30;1m824 | [0m[35m                            else "ssm:GetParameter" if password_secret_arn.service == "ssm" else Non[0m
[30;1m825 | [0m[35m                        )[0m
[30;1m826 | [0m[35m                    ],[0m
[30;1m827 | [0m[35m                    effect=iam.Effect.ALLOW,[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m820 | [0m[35m                    actions=[[0m
[30;1m821 | [0m[35m                        ([0m
[30;1m822 | [0m[35m                            "secretsmanager:GetSecretValue"[0m
[30;1m823 | [0m[35m                            if password_secret_arn.service == "secretsmanager"[0m
[30;1m824 | [0m[35m                            else "ssm:GetParameter" if password_secret_arn.service == "ssm" else Non[0m
[30;1m825 | [0m[35m                        )[0m
[30;1m826 | [0m[35m                    ],[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m812 | [0m[35m[0m
[30;1m813 | [0m[35m        if self._config.directory_service:[0m
[30;1m814 | [0m[35m            password_secret_arn = Arn.split([0m
[30;1m815 | [0m[35m                self._config.directory_service.password_secret_arn, ArnFormat.COLON_RESOURCE_NAME[0m
[30;1m816 | [0m[35m            )[0m
[30;1m817 | [0m[35m            policy.append([0m
[30;1m818 | [0m[35m                iam.PolicyStatement([0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m811 | [0m[35m                )[0m
[30;1m812 | [0m[35m[0m
[30;1m813 | [0m[35m        if self._config.directory_service:[0m
[30;1m814 | [0m[35m            password_secret_arn = Arn.split([0m
[30;1m815 | [0m[35m                self._config.directory_service.password_secret_arn, ArnFormat.COLON_RESOURCE_NAME[0m
[30;1m816 | [0m[35m            )[0m
[30;1m817 | [0m[35m            policy.append([0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m743 | [0m[35msource="network-interface/*"),[0m
[30;1m744 | [0m[35m                            self._format_arn(service="ec2", resource="instance/*"),[0m
[30;1m745 | [0m[35m                            self._format_arn(service="ec2", resource="volume/*"),[0m
[30;1m746 | [0m[35m                            self._format_arn(service="ec2", resource=f"key-pair/{self._config.head_n[0m
[30;1m747 | [0m[35m                            self._format_arn(service="ec2", resource="security-group/*"),[0m
[30;1m748 | [0m[35m                            self._format_arn(service="ec2", resource="launch-template/*"),[0m
[30;1m749 | [0m[35m                            self._format_arn(service="ec2", resource="placement-group/*"),[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m117 | [0m[35m                "enabled": "true",[0m
[30;1m118 | [0m[35m                "domain_name": directory_service.domain_name,[0m
[30;1m119 | [0m[35m                "domain_addr": directory_service.domain_addr,[0m
[30;1m120 | [0m[35m                "password_secret_arn": directory_service.password_secret_arn,[0m
[30;1m121 | [0m[35m                "domain_read_only_user": directory_service.domain_read_only_user,[0m
[30;1m122 | [0m[35m                "ldap_tls_ca_cert": directory_service.ldap_tls_ca_cert or "NONE",[0m
[30;1m123 | [0m[35m                "ldap_tls_req_cert": directory_service.ldap_tls_req_cert or "NONE",[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m117 | [0m[35m                "enabled": "true",[0m
[30;1m118 | [0m[35m                "domain_name": directory_service.domain_name,[0m
[30;1m119 | [0m[35m                "domain_addr": directory_service.domain_addr,[0m
[30;1m120 | [0m[35m                "password_secret_arn": directory_service.password_secret_arn,[0m
[30;1m121 | [0m[35m                "domain_read_only_user": directory_service.domain_read_only_user,[0m
[30;1m122 | [0m[35m                "ldap_tls_ca_cert": directory_service.ldap_tls_ca_cert or "NONE",[0m
[30;1m123 | [0m[35m                "ldap_tls_req_cert": directory_service.ldap_tls_req_cert or "NONE",[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/common.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m175 | [0m[35m    @staticmethod[0m
[30;1m176 | [0m[35m    def is_enabled():[0m
[30;1m177 | [0m[35m        """Tell if the cache is enabled."""[0m
[30;1m178 | [0m[35m        return not os.environ.get("PCLUSTER_CACHE_DISABLED")[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m    @staticmethod[0m
[30;1m181 | [0m[35m    def clear_all():[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2913 | [0m[35m                # If the login node pool allowed IPs is not specified, forces the source allowed IP [0m
[30;1m2914 | [0m[35m                # SSH connection to the one defined in the HeadNode[0m
[30;1m2915 | [0m[35m                if not pool.ssh.allowed_ips:[0m
[30;1m2916 | [0m[35m                    pool.ssh.allowed_ips = self.head_node.ssh.allowed_ips[0m
[30;1m2917 | [0m[35m[0m
[30;1m2918 | [0m[35m        self.__image_dict = None[0m
[30;1m2919 | [0m[35m        # Cache capacity reservations information together to reduce number of boto3 calls.[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2913 | [0m[35m                # If the login node pool allowed IPs is not specified, forces the source allowed IP [0m
[30;1m2914 | [0m[35m                # SSH connection to the one defined in the HeadNode[0m
[30;1m2915 | [0m[35m                if not pool.ssh.allowed_ips:[0m
[30;1m2916 | [0m[35m                    pool.ssh.allowed_ips = self.head_node.ssh.allowed_ips[0m
[30;1m2917 | [0m[35m[0m
[30;1m2918 | [0m[35m        self.__image_dict = None[0m
[30;1m2919 | [0m[35m        # Cache capacity reservations information together to reduce number of boto3 calls.[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2912 | [0m[35m                    pool.ssh = LoginNodesSsh(key_name=self.head_node.ssh.key_name)[0m
[30;1m2913 | [0m[35m                # If the login node pool allowed IPs is not specified, forces the source allowed IP [0m
[30;1m2914 | [0m[35m                # SSH connection to the one defined in the HeadNode[0m
[30;1m2915 | [0m[35m                if not pool.ssh.allowed_ips:[0m
[30;1m2916 | [0m[35m                    pool.ssh.allowed_ips = self.head_node.ssh.allowed_ips[0m
[30;1m2917 | [0m[35m[0m
[30;1m2918 | [0m[35m        self.__image_dict = None[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2909 | [0m[35m                if pool.ssh and not pool.ssh.key_name:[0m
[30;1m2910 | [0m[35m                    pool.ssh.key_name = self.head_node.ssh.key_name[0m
[30;1m2911 | [0m[35m                elif not pool.ssh:[0m
[30;1m2912 | [0m[35m                    pool.ssh = LoginNodesSsh(key_name=self.head_node.ssh.key_name)[0m
[30;1m2913 | [0m[35m                # If the login node pool allowed IPs is not specified, forces the source allowed IP [0m
[30;1m2914 | [0m[35m                # SSH connection to the one defined in the HeadNode[0m
[30;1m2915 | [0m[35m                if not pool.ssh.allowed_ips:[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2909 | [0m[35m                if pool.ssh and not pool.ssh.key_name:[0m
[30;1m2910 | [0m[35m                    pool.ssh.key_name = self.head_node.ssh.key_name[0m
[30;1m2911 | [0m[35m                elif not pool.ssh:[0m
[30;1m2912 | [0m[35m                    pool.ssh = LoginNodesSsh(key_name=self.head_node.ssh.key_name)[0m
[30;1m2913 | [0m[35m                # If the login node pool allowed IPs is not specified, forces the source allowed IP [0m
[30;1m2914 | [0m[35m                # SSH connection to the one defined in the HeadNode[0m
[30;1m2915 | [0m[35m                if not pool.ssh.allowed_ips:[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2908 | [0m[35m                # If there's no customer ssh key for LoginNodes pool, set a default value as HeadNod[0m
[30;1m2909 | [0m[35m                if pool.ssh and not pool.ssh.key_name:[0m
[30;1m2910 | [0m[35m                    pool.ssh.key_name = self.head_node.ssh.key_name[0m
[30;1m2911 | [0m[35m                elif not pool.ssh:[0m
[30;1m2912 | [0m[35m                    pool.ssh = LoginNodesSsh(key_name=self.head_node.ssh.key_name)[0m
[30;1m2913 | [0m[35m                # If the login node pool allowed IPs is not specified, forces the source allowed IP [0m
[30;1m2914 | [0m[35m                # SSH connection to the one defined in the HeadNode[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2907 | [0m[35m                pool.local_storage = LocalStorage(implied=True)[0m
[30;1m2908 | [0m[35m                # If there's no customer ssh key for LoginNodes pool, set a default value as HeadNod[0m
[30;1m2909 | [0m[35m                if pool.ssh and not pool.ssh.key_name:[0m
[30;1m2910 | [0m[35m                    pool.ssh.key_name = self.head_node.ssh.key_name[0m
[30;1m2911 | [0m[35m                elif not pool.ssh:[0m
[30;1m2912 | [0m[35m                    pool.ssh = LoginNodesSsh(key_name=self.head_node.ssh.key_name)[0m
[30;1m2913 | [0m[35m                # If the login node pool allowed IPs is not specified, forces the source allowed IP [0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2907 | [0m[35m                pool.local_storage = LocalStorage(implied=True)[0m
[30;1m2908 | [0m[35m                # If there's no customer ssh key for LoginNodes pool, set a default value as HeadNod[0m
[30;1m2909 | [0m[35m                if pool.ssh and not pool.ssh.key_name:[0m
[30;1m2910 | [0m[35m                    pool.ssh.key_name = self.head_node.ssh.key_name[0m
[30;1m2911 | [0m[35m                elif not pool.ssh:[0m
[30;1m2912 | [0m[35m                    pool.ssh = LoginNodesSsh(key_name=self.head_node.ssh.key_name)[0m
[30;1m2913 | [0m[35m                # If the login node pool allowed IPs is not specified, forces the source allowed IP [0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2906 | [0m[35m            for pool in self.login_nodes.pools:[0m
[30;1m2907 | [0m[35m                pool.local_storage = LocalStorage(implied=True)[0m
[30;1m2908 | [0m[35m                # If there's no customer ssh key for LoginNodes pool, set a default value as HeadNod[0m
[30;1m2909 | [0m[35m                if pool.ssh and not pool.ssh.key_name:[0m
[30;1m2910 | [0m[35m                    pool.ssh.key_name = self.head_node.ssh.key_name[0m
[30;1m2911 | [0m[35m                elif not pool.ssh:[0m
[30;1m2912 | [0m[35m                    pool.ssh = LoginNodesSsh(key_name=self.head_node.ssh.key_name)[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2906 | [0m[35m            for pool in self.login_nodes.pools:[0m
[30;1m2907 | [0m[35m                pool.local_storage = LocalStorage(implied=True)[0m
[30;1m2908 | [0m[35m                # If there's no customer ssh key for LoginNodes pool, set a default value as HeadNod[0m
[30;1m2909 | [0m[35m                if pool.ssh and not pool.ssh.key_name:[0m
[30;1m2910 | [0m[35m                    pool.ssh.key_name = self.head_node.ssh.key_name[0m
[30;1m2911 | [0m[35m                elif not pool.ssh:[0m
[30;1m2912 | [0m[35m                    pool.ssh = LoginNodesSsh(key_name=self.head_node.ssh.key_name)[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2737 | [0m[35m        if self.password_secret_arn:[0m
[30;1m2738 | [0m[35m            self._register_validator([0m
[30;1m2739 | [0m[35m                PasswordSecretArnValidator,[0m
[30;1m2740 | [0m[35m                password_secret_arn=self.password_secret_arn,[0m
[30;1m2741 | [0m[35m                region=region,[0m
[30;1m2742 | [0m[35m            )[0m
[30;1m2743 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2737 | [0m[35m        if self.password_secret_arn:[0m
[30;1m2738 | [0m[35m            self._register_validator([0m
[30;1m2739 | [0m[35m                PasswordSecretArnValidator,[0m
[30;1m2740 | [0m[35m                password_secret_arn=self.password_secret_arn,[0m
[30;1m2741 | [0m[35m                region=region,[0m
[30;1m2742 | [0m[35m            )[0m
[30;1m2743 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2736 | [0m[35m            self._register_validator(DatabaseUriValidator, uri=self.uri)[0m
[30;1m2737 | [0m[35m        if self.password_secret_arn:[0m
[30;1m2738 | [0m[35m            self._register_validator([0m
[30;1m2739 | [0m[35m                PasswordSecretArnValidator,[0m
[30;1m2740 | [0m[35m                password_secret_arn=self.password_secret_arn,[0m
[30;1m2741 | [0m[35m                region=region,[0m
[30;1m2742 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2734 | [0m[35m        self._register_validator(FeatureRegionValidator, feature=Feature.SLURM_DATABASE, region=regi[0m
[30;1m2735 | [0m[35m        if self.uri:[0m
[30;1m2736 | [0m[35m            self._register_validator(DatabaseUriValidator, uri=self.uri)[0m
[30;1m2737 | [0m[35m        if self.password_secret_arn:[0m
[30;1m2738 | [0m[35m            self._register_validator([0m
[30;1m2739 | [0m[35m                PasswordSecretArnValidator,[0m
[30;1m2740 | [0m[35m                password_secret_arn=self.password_secret_arn,[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2726 | [0m[35m        super().__init__(**kwargs)[0m
[30;1m2727 | [0m[35m        self.uri = Resource.init_param(uri)[0m
[30;1m2728 | [0m[35m        self.user_name = Resource.init_param(user_name)[0m
[30;1m2729 | [0m[35m        self.password_secret_arn = Resource.init_param(password_secret_arn)[0m
[30;1m2730 | [0m[35m        self.database_name = Resource.init_param(database_name)[0m
[30;1m2731 | [0m[35m[0m
[30;1m2732 | [0m[35m    def _register_validators(self, context: ValidatorContext = None):  # noqa: D102 #pylint: disable[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2726 | [0m[35m        super().__init__(**kwargs)[0m
[30;1m2727 | [0m[35m        self.uri = Resource.init_param(uri)[0m
[30;1m2728 | [0m[35m        self.user_name = Resource.init_param(user_name)[0m
[30;1m2729 | [0m[35m        self.password_secret_arn = Resource.init_param(password_secret_arn)[0m
[30;1m2730 | [0m[35m        self.database_name = Resource.init_param(database_name)[0m
[30;1m2731 | [0m[35m[0m
[30;1m2732 | [0m[35m    def _register_validators(self, context: ValidatorContext = None):  # noqa: D102 #pylint: disable[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m2719 | [0m[35m        self,[0m
[30;1m2720 | [0m[35m        uri: str = None,[0m
[30;1m2721 | [0m[35m        user_name: str = None,[0m
[30;1m2722 | [0m[35m        password_secret_arn: str = None,[0m
[30;1m2723 | [0m[35m        database_name: str = None,[0m
[30;1m2724 | [0m[35m        **kwargs,[0m
[30;1m2725 | [0m[35m    ):[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1677 | [0m[35m            volume_size=root_volume_size,[0m
[30;1m1678 | [0m[35m            volume_iops=root_volume.iops,[0m
[30;1m1679 | [0m[35m        )[0m
[30;1m1680 | [0m[35m        self._register_validator(KeyPairValidator, key_name=self.head_node.ssh.key_name, os=self.ima[0m
[30;1m1681 | [0m[35m        if self.deployment_settings and self.deployment_settings.disable_sudo_access_default_user:[0m
[30;1m1682 | [0m[35m            self._register_validator([0m
[30;1m1683 | [0m[35m                SchedulerDisableSudoAccessForDefaultUserValidator, scheduler=self.scheduling.schedul[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1447 | [0m[35m            disable_simultaneous_multithreading, default=False[0m
[30;1m1448 | [0m[35m        )[0m
[30;1m1449 | [0m[35m        self.networking = networking[0m
[30;1m1450 | [0m[35m        self.ssh = ssh or HeadNodeSsh(implied=True)[0m
[30;1m1451 | [0m[35m        self.local_storage = local_storage or LocalStorage(implied=True)[0m
[30;1m1452 | [0m[35m        self.shared_storage_type = Resource.init_param([0m
[30;1m1453 | [0m[35m            shared_storage_type,[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1368 | [0m[35m        self.image = image[0m
[30;1m1369 | [0m[35m        self.networking = networking[0m
[30;1m1370 | [0m[35m        self.count = Resource.init_param(count, default=1)[0m
[30;1m1371 | [0m[35m        self.ssh = ssh[0m
[30;1m1372 | [0m[35m        self.dcv = dcv[0m
[30;1m1373 | [0m[35m        self.custom_actions = custom_actions[0m
[30;1m1374 | [0m[35m        self.iam = iam or LoginNodesIam(implied=True)[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1132 | [0m[35m        if self.password_secret_arn:[0m
[30;1m1133 | [0m[35m            self._register_validator([0m
[30;1m1134 | [0m[35m                PasswordSecretArnValidator,[0m
[30;1m1135 | [0m[35m                password_secret_arn=self.password_secret_arn,[0m
[30;1m1136 | [0m[35m                region=get_region(),[0m
[30;1m1137 | [0m[35m            )[0m
[30;1m1138 | [0m[35m        if self.ldap_tls_req_cert:[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1132 | [0m[35m        if self.password_secret_arn:[0m
[30;1m1133 | [0m[35m            self._register_validator([0m
[30;1m1134 | [0m[35m                PasswordSecretArnValidator,[0m
[30;1m1135 | [0m[35m                password_secret_arn=self.password_secret_arn,[0m
[30;1m1136 | [0m[35m                region=get_region(),[0m
[30;1m1137 | [0m[35m            )[0m
[30;1m1138 | [0m[35m        if self.ldap_tls_req_cert:[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1131 | [0m[35m            )[0m
[30;1m1132 | [0m[35m        if self.password_secret_arn:[0m
[30;1m1133 | [0m[35m            self._register_validator([0m
[30;1m1134 | [0m[35m                PasswordSecretArnValidator,[0m
[30;1m1135 | [0m[35m                password_secret_arn=self.password_secret_arn,[0m
[30;1m1136 | [0m[35m                region=get_region(),[0m
[30;1m1137 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1129 | [0m[35m            self._register_validator([0m
[30;1m1130 | [0m[35m                DomainAddrValidator, domain_addr=self.domain_addr, additional_sssd_configs=self.addi[0m
[30;1m1131 | [0m[35m            )[0m
[30;1m1132 | [0m[35m        if self.password_secret_arn:[0m
[30;1m1133 | [0m[35m            self._register_validator([0m
[30;1m1134 | [0m[35m                PasswordSecretArnValidator,[0m
[30;1m1135 | [0m[35m                password_secret_arn=self.password_secret_arn,[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1114 | [0m[35m        super().__init__(**kwargs)[0m
[30;1m1115 | [0m[35m        self.domain_name = Resource.init_param(domain_name)[0m
[30;1m1116 | [0m[35m        self.domain_addr = Resource.init_param(domain_addr)[0m
[30;1m1117 | [0m[35m        self.password_secret_arn = Resource.init_param(password_secret_arn)[0m
[30;1m1118 | [0m[35m        self.domain_read_only_user = Resource.init_param(domain_read_only_user)[0m
[30;1m1119 | [0m[35m        self.ldap_tls_ca_cert = Resource.init_param(ldap_tls_ca_cert)[0m
[30;1m1120 | [0m[35m        self.ldap_tls_req_cert = Resource.init_param(ldap_tls_req_cert, default="hard")[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1114 | [0m[35m        super().__init__(**kwargs)[0m
[30;1m1115 | [0m[35m        self.domain_name = Resource.init_param(domain_name)[0m
[30;1m1116 | [0m[35m        self.domain_addr = Resource.init_param(domain_addr)[0m
[30;1m1117 | [0m[35m        self.password_secret_arn = Resource.init_param(password_secret_arn)[0m
[30;1m1118 | [0m[35m        self.domain_read_only_user = Resource.init_param(domain_read_only_user)[0m
[30;1m1119 | [0m[35m        self.ldap_tls_ca_cert = Resource.init_param(ldap_tls_ca_cert)[0m
[30;1m1120 | [0m[35m        self.ldap_tls_req_cert = Resource.init_param(ldap_tls_req_cert, default="hard")[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1102 | [0m[35m        self,[0m
[30;1m1103 | [0m[35m        domain_name: str = None,[0m
[30;1m1104 | [0m[35m        domain_addr: str = None,[0m
[30;1m1105 | [0m[35m        password_secret_arn: str = None,[0m
[30;1m1106 | [0m[35m        domain_read_only_user: str = None,[0m
[30;1m1107 | [0m[35m        ldap_tls_ca_cert: str = None,[0m
[30;1m1108 | [0m[35m        ldap_tls_req_cert: str = None,[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m126 | [0m[35m    DomainAddrValidator,[0m
[30;1m127 | [0m[35m    DomainNameValidator,[0m
[30;1m128 | [0m[35m    LdapTlsReqCertValidator,[0m
[30;1m129 | [0m[35m    PasswordSecretArnValidator,[0m
[30;1m130 | [0m[35m)[0m
[30;1m131 | [0m[35mfrom pcluster.validators.ebs_validators import ([0m
[30;1m132 | [0m[35m    EbsVolumeIopsValidator,[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/entrypoint.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m26 | [0m[35m# Suppress JSII warnings for Node version[0m
[30;1m27 | [0m[35mos.environ["JSII_SILENCE_WARNING_KNOWN_BROKEN_NODE_VERSION"] = "1"[0m
[30;1m28 | [0m[35mos.environ["JSII_SILENCE_WARNING_UNTESTED_NODE_VERSION"] = "1"[0m
[30;1m29 | [0m[35mos.environ["JSII_SILENCE_WARNING_DEPRECATED_NODE_VERSION"] = "1"[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m# Controllers[0m
[30;1m32 | [0m[35mimport pcluster.api.controllers.cluster_compute_fleet_controller  # noqa: E402[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/entrypoint.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m# Suppress JSII warnings for Node version[0m
[30;1m27 | [0m[35mos.environ["JSII_SILENCE_WARNING_KNOWN_BROKEN_NODE_VERSION"] = "1"[0m
[30;1m28 | [0m[35mos.environ["JSII_SILENCE_WARNING_UNTESTED_NODE_VERSION"] = "1"[0m
[30;1m29 | [0m[35mos.environ["JSII_SILENCE_WARNING_DEPRECATED_NODE_VERSION"] = "1"[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m# Controllers[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/entrypoint.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m24 | [0m[35mfrom botocore.exceptions import NoCredentialsError  # TODO: remove[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m# Suppress JSII warnings for Node version[0m
[30;1m27 | [0m[35mos.environ["JSII_SILENCE_WARNING_KNOWN_BROKEN_NODE_VERSION"] = "1"[0m
[30;1m28 | [0m[35mos.environ["JSII_SILENCE_WARNING_UNTESTED_NODE_VERSION"] = "1"[0m
[30;1m29 | [0m[35mos.environ["JSII_SILENCE_WARNING_DEPRECATED_NODE_VERSION"] = "1"[0m
[30;1m30 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/imagebuilder_stack.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m793 | [0m[35m            execution_role = lambda_cleanup_execution_role.attr_arn[0m
[30;1m794 | [0m[35m[0m
[30;1m795 | [0m[35m        # LambdaCleanupEnv[0m
[30;1m796 | [0m[35m        lambda_env = awslambda.CfnFunction.EnvironmentProperty(variables={"IMAGE_STACK_ARN": self.st[0m
[30;1m797 | [0m[35m[0m
[30;1m798 | [0m[35m        # LambdaCWLogGroup[0m
[30;1m799 | [0m[35m        lambda_log = logs.CfnLogGroup([0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1903 | [0m[35m[0m
[30;1m1904 | [0m[35m    domain_name = fields.Str(required=True, metadata={"update_policy": UpdatePolicy.COMPUTE_AND_LOGI[0m
[30;1m1905 | [0m[35m    domain_addr = fields.Str(required=True, metadata={"update_policy": UpdatePolicy.COMPUTE_AND_LOGI[0m
[30;1m1906 | [0m[35m    password_secret_arn = fields.Str([0m
[30;1m1907 | [0m[35m        required=True,[0m
[30;1m1908 | [0m[35m        validate=validate.Regexp(r"^arn:.*:(secretsmanager:.*:.*:secret:|ssm:.*:.*:parameter\/).*$")[0m
[30;1m1909 | [0m[35m        metadata={"update_policy": UpdatePolicy.COMPUTE_AND_LOGIN_NODES_STOP},[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1740 | [0m[35m[0m
[30;1m1741 | [0m[35m    uri = fields.Str(required=True, metadata={"update_policy": UpdatePolicy.COMPUTE_FLEET_STOP})[0m
[30;1m1742 | [0m[35m    user_name = fields.Str(required=True, metadata={"update_policy": UpdatePolicy.COMPUTE_FLEET_STOP[0m
[30;1m1743 | [0m[35m    password_secret_arn = fields.Str([0m
[30;1m1744 | [0m[35m        required=True,[0m
[30;1m1745 | [0m[35m        validate=validate.Regexp(r"^arn:.*:secret"),[0m
[30;1m1746 | [0m[35m        metadata={"update_policy": UpdatePolicy.COMPUTE_FLEET_STOP},[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1229 | [0m[35m                metadata_options=ec2.CfnLaunchTemplate.MetadataOptionsProperty([0m
[30;1m1230 | [0m[35m                    http_tokens=get_http_tokens_setting(self.config.imds.imds_support)[0m
[30;1m1231 | [0m[35m                ),[0m
[30;1m1232 | [0m[35m                user_data=Fn.base64([0m
[30;1m1233 | [0m[35m                    Fn.sub([0m
[30;1m1234 | [0m[35m                        get_user_data_content("../resources/head_node/user_data.sh"),[0m
[30;1m1235 | [0m[35m                        {[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1219 | [0m[35m                    head_node.local_storage.root_volume,[0m
[30;1m1220 | [0m[35m                    AWSApi.instance().ec2.describe_image(self.config.head_node_ami).device_name,[0m
[30;1m1221 | [0m[35m                ),[0m
[30;1m1222 | [0m[35m                key_name=head_node.ssh.key_name,[0m
[30;1m1223 | [0m[35m                network_interfaces=head_lt_nw_interfaces,[0m
[30;1m1224 | [0m[35m                image_id=self.config.head_node_ami,[0m
[30;1m1225 | [0m[35m                ebs_optimized=head_node.is_ebs_optimized,[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m902 | [0m[35m    def _add_head_security_group(self):[0m
[30;1m903 | [0m[35m        head_security_group_ingress = [[0m
[30;1m904 | [0m[35m            # SSH access[0m
[30;1m905 | [0m[35m            get_source_ingress_rule(self.config.head_node.ssh.allowed_ips)[0m
[30;1m906 | [0m[35m        ][0m
[30;1m907 | [0m[35m[0m
[30;1m908 | [0m[35m        if self.config.is_dcv_enabled:[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m877 | [0m[35m            if not pool.networking.security_groups:[0m
[30;1m878 | [0m[35m                security_group_ingress_rules = [[0m
[30;1m879 | [0m[35m                    # Add rule for SSH access[0m
[30;1m880 | [0m[35m                    get_source_ingress_rule(pool.ssh.allowed_ips)[0m
[30;1m881 | [0m[35m                ][0m
[30;1m882 | [0m[35m                # Add rule for DCV access if enabled[0m
[30;1m883 | [0m[35m                if pool.has_dcv_enabled:[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/queues_stack.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m318 | [0m[35m                metadata_options=ec2.CfnLaunchTemplate.MetadataOptionsProperty([0m
[30;1m319 | [0m[35m                    http_tokens=get_http_tokens_setting(self._config.imds.imds_support)[0m
[30;1m320 | [0m[35m                ),[0m
[30;1m321 | [0m[35m                user_data=Fn.base64([0m
[30;1m322 | [0m[35m                    Fn.sub([0m
[30;1m323 | [0m[35m                        get_user_data_content("../resources/compute_node/user_data.sh"),[0m
[30;1m324 | [0m[35m                        {[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_operations_controller.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m394 | [0m[35m        image_id=image.pcluster_image_id,[0m
[30;1m395 | [0m[35m        image_build_status=ImageBuildStatus.BUILD_COMPLETE,[0m
[30;1m396 | [0m[35m        ec2_ami_info=Ec2AmiInfoSummary(ami_id=image.id),[0m
[30;1m397 | [0m[35m        region=os_lib.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m398 | [0m[35m        version=image.version,[0m
[30;1m399 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_operations_controller.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m384 | [0m[35m        image_build_status=cloud_formation_status_to_image_status(stack.status),[0m
[30;1m385 | [0m[35m        cloudformation_stack_status=stack.status,[0m
[30;1m386 | [0m[35m        cloudformation_stack_arn=stack.id,[0m
[30;1m387 | [0m[35m        region=os_lib.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m388 | [0m[35m        version=stack.version,[0m
[30;1m389 | [0m[35m    )[0m
[30;1m390 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_operations_controller.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m263 | [0m[35m        cloudformation_stack_arn=imagebuilder.stack.id,[0m
[30;1m264 | [0m[35m        cloudformation_stack_creation_time=to_utc_datetime(imagebuilder.stack.creation_time),[0m
[30;1m265 | [0m[35m        cloudformation_stack_tags=[Tag(key=tag["Key"], value=tag["Value"]) for tag in imagebuilder.s[0m
[30;1m266 | [0m[35m        region=os_lib.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m267 | [0m[35m        version=imagebuilder.stack.version,[0m
[30;1m268 | [0m[35m    )[0m
[30;1m269 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_operations_controller.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m244 | [0m[35m            architecture=imagebuilder.image.architecture,[0m
[30;1m245 | [0m[35m            description=imagebuilder.image.description,[0m
[30;1m246 | [0m[35m        ),[0m
[30;1m247 | [0m[35m        region=os_lib.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m248 | [0m[35m        version=imagebuilder.image.version,[0m
[30;1m249 | [0m[35m    )[0m
[30;1m250 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_operations_controller.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m173 | [0m[35m            image_build_status=ImageBuildStatus.DELETE_IN_PROGRESS,[0m
[30;1m174 | [0m[35m            cloudformation_stack_status=CloudFormationStackStatus.DELETE_IN_PROGRESS if stack else N[0m
[30;1m175 | [0m[35m            cloudformation_stack_arn=stack.id if stack else None,[0m
[30;1m176 | [0m[35m            region=os_lib.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m177 | [0m[35m            version=stack.version if stack else image.version,[0m
[30;1m178 | [0m[35m        )[0m
[30;1m179 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/login_nodes_stack.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m160 | [0m[35m                    http_tokens=get_http_tokens_setting(self._config.imds.imds_support)[0m
[30;1m161 | [0m[35m                ),[0m
[30;1m162 | [0m[35m                iam_instance_profile=ec2.CfnLaunchTemplate.IamInstanceProfileProperty(name=self._ins[0m
[30;1m163 | [0m[35m                user_data=Fn.base64([0m
[30;1m164 | [0m[35m                    Fn.sub([0m
[30;1m165 | [0m[35m                        get_user_data_content("../resources/login_node/user_data.sh"),[0m
[30;1m166 | [0m[35m                        {[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/login_nodes_stack.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m452 | [0m[35m[0m
[30;1m453 | [0m[35m    def _add_managed_load_balancer_security_group(self):[0m
[30;1m454 | [0m[35m        # The load balancer shares the same SSH restrictions as the login nodes[0m
[30;1m455 | [0m[35m        load_balancer_security_group_ingress = [get_source_ingress_rule(self._pool.ssh.allowed_ips)][0m
[30;1m456 | [0m[35m[0m
[30;1m457 | [0m[35m        load_balancer_managed_security_group = ec2.CfnSecurityGroup([0m
[30;1m458 | [0m[35m            Stack.of(self),[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/login_nodes_stack.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m155 | [0m[35m                ),[0m
[30;1m156 | [0m[35m                image_id=self._config.login_nodes_ami[self._pool.name],[0m
[30;1m157 | [0m[35m                instance_type=self._pool.instance_type,[0m
[30;1m158 | [0m[35m                key_name=self._pool.ssh.key_name,[0m
[30;1m159 | [0m[35m                metadata_options=ec2.CfnLaunchTemplate.MetadataOptionsProperty([0m
[30;1m160 | [0m[35m                    http_tokens=get_http_tokens_setting(self._config.imds.imds_support)[0m
[30;1m161 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m158 | [0m[35m            returndict["body"] = response.get_data(as_text=True)[0m
[30;1m159 | [0m[35m            returndict["isBase64Encoded"] = False[0m
[30;1m160 | [0m[35m        else:[0m
[30;1m161 | [0m[35m            returndict["body"] = base64.b64encode(response.data).decode("utf-8")[0m
[30;1m162 | [0m[35m            returndict["isBase64Encoded"] = True[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m    return returndict[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35mdef get_body_bytes(event, body):[0m
[30;1m119 | [0m[35m    if event.get("isBase64Encoded", False):[0m
[30;1m120 | [0m[35m        body = base64.b64decode(body)[0m
[30;1m121 | [0m[35m    if isinstance(body, str):[0m
[30;1m122 | [0m[35m        body = body.encode("utf-8")[0m
[30;1m123 | [0m[35m    return body[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m23 | [0m[35mfrom werkzeug.urls import url_encode, url_unquote, url_unquote_plus[0m
[30;1m24 | [0m[35mfrom werkzeug.wrappers import Response[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m# List of MIME types that should not be base64 encoded. MIME types within `text/*`[0m
[30;1m27 | [0m[35m# are included by default.[0m
[30;1m28 | [0m[35mTEXT_MIME_TYPES = [[0m
[30;1m29 | [0m[35m    "application/json",[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m12 | [0m[35m#[0m
[30;1m13 | [0m[35m# The above copyright notice and this permission notice shall be included in all[0m
[30;1m14 | [0m[35m# copies or substantial portions of the Software.[0m
[30;1m15 | [0m[35mimport base64[0m
[30;1m16 | [0m[35mimport io[0m
[30;1m17 | [0m[35mimport json[0m
[30;1m18 | [0m[35mimport os[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m190 | [0m[35m    # path in their URL. This allows us to strip it out via an optional[0m
[30;1m191 | [0m[35m    # environment variable.[0m
[30;1m192 | [0m[35m    path_info = event["path"][0m
[30;1m193 | [0m[35m    base_path = os.environ.get("API_GATEWAY_BASE_PATH")[0m
[30;1m194 | [0m[35m    if base_path:[0m
[30;1m195 | [0m[35m        script_name = "/" + base_path[0m
[30;1m196 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m126 | [0m[35mdef setup_environ_items(environ, headers):[0m
[30;1m127 | [0m[35m    for key, value in environ.items():[0m
[30;1m128 | [0m[35m        if isinstance(value, str):[0m
[30;1m129 | [0m[35m            environ[key] = value.encode("utf-8").decode("latin1", "replace")[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m    for key, value in headers.items():[0m
[30;1m132 | [0m[35m        key = "HTTP_" + key.upper().replace("-", "_")[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35mdef get_script_name(headers, request_context):[0m
[30;1m103 | [0m[35m    strip_stage_path = os.environ.get("STRIP_STAGE_PATH", "").lower().strip() in [[0m
[30;1m104 | [0m[35m        "yes",[0m
[30;1m105 | [0m[35m        "y",[0m
[30;1m106 | [0m[35m        "true",[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_api.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m193 | [0m[35m    @staticmethod[0m
[30;1m194 | [0m[35m    def instance():[0m
[30;1m195 | [0m[35m        """Return the singleton AWSApi instance."""[0m
[30;1m196 | [0m[35m        if not AWSApi._instance or AWSApi._instance.aws_region != os.environ.get("AWS_DEFAULT_REGION[0m
[30;1m197 | [0m[35m            AWSApi._instance = AWSApi()[0m
[30;1m198 | [0m[35m        return AWSApi._instance[0m
[30;1m199 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_api.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m42 | [0m[35m    _instance = None[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    def __init__(self):[0m
[30;1m45 | [0m[35m        self.aws_region = os.environ.get("AWS_DEFAULT_REGION")[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m        self._batch = None[0m
[30;1m48 | [0m[35m        self._cfn = None[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/directory_service_validators.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m104 | [0m[35m                    f"The secret {password_secret_arn} is not supported in region {region}.", Failur[0m
[30;1m105 | [0m[35m                )[0m
[30;1m106 | [0m[35m        except AWSClientError as e:[0m
[30;1m107 | [0m[35m            handle_arn_aws_client_error(e, password_secret_arn, self)[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35mclass LdapTlsReqCertValidator(Validator):[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/directory_service_validators.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m101 | [0m[35m                AWSApi.instance().ssm.get_parameter(parameter_name)[0m
[30;1m102 | [0m[35m            else:[0m
[30;1m103 | [0m[35m                self._add_failure([0m
[30;1m104 | [0m[35m                    f"The secret {password_secret_arn} is not supported in region {region}.", Failur[0m
[30;1m105 | [0m[35m                )[0m
[30;1m106 | [0m[35m        except AWSClientError as e:[0m
[30;1m107 | [0m[35m            handle_arn_aws_client_error(e, password_secret_arn, self)[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/directory_service_validators.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m91 | [0m[35m            if service == "ssm":[0m
[30;1m92 | [0m[35m                resource_type = resource.split("/")[0][0m
[30;1m93 | [0m[35m            if service == "secretsmanager" and resource == "secret":[0m
[30;1m94 | [0m[35m                AWSApi.instance().secretsmanager.describe_secret(password_secret_arn)[0m
[30;1m95 | [0m[35m            elif ([0m
[30;1m96 | [0m[35m                service == "ssm"[0m
[30;1m97 | [0m[35m                and resource_type == "parameter"  # pylint: disable=E0606[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/directory_service_validators.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m87 | [0m[35m            for retro-compatibility.[0m
[30;1m88 | [0m[35m        """[0m
[30;1m89 | [0m[35m        try:[0m
[30;1m90 | [0m[35m            service, resource = get_arn_service_and_resource(password_secret_arn)[0m
[30;1m91 | [0m[35m            if service == "ssm":[0m
[30;1m92 | [0m[35m                resource_type = resource.split("/")[0][0m
[30;1m93 | [0m[35m            if service == "secretsmanager" and resource == "secret":[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/directory_service_validators.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m79 | [0m[35m    """PasswordSecretArn validator."""[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m    def _validate(self, password_secret_arn: str, region: str):[0m
[30;1m82 | [0m[35m        """Validate that PasswordSecretArn contains a valid ARN for the given region.[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m        In particular, the ARN should be one of the following resources:[0m
[30;1m85 | [0m[35m         1. a readable secret in AWS Secrets Manager, which is supported in all regions.[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/directory_service_validators.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m78 | [0m[35mclass PasswordSecretArnValidator(Validator):[0m
[30;1m79 | [0m[35m    """PasswordSecretArn validator."""[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m    def _validate(self, password_secret_arn: str, region: str):[0m
[30;1m82 | [0m[35m        """Validate that PasswordSecretArn contains a valid ARN for the given region.[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m        In particular, the ARN should be one of the following resources:[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/directory_service_validators.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35mclass PasswordSecretArnValidator(Validator):[0m
[30;1m79 | [0m[35m    """PasswordSecretArn validator."""[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m    def _validate(self, password_secret_arn: str, region: str):[0m
[30;1m82 | [0m[35m        """Validate that PasswordSecretArn contains a valid ARN for the given region.[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/directory_service_validators.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m75 | [0m[35m            )[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35mclass PasswordSecretArnValidator(Validator):[0m
[30;1m79 | [0m[35m    """PasswordSecretArn validator."""[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m    def _validate(self, password_secret_arn: str, region: str):[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m401 | [0m[35m                cluster_name=cluster_name,[0m
[30;1m402 | [0m[35m                cloudformation_stack_status=CloudFormationStackStatus.UPDATE_IN_PROGRESS,[0m
[30;1m403 | [0m[35m                cloudformation_stack_arn=cluster.stack.id,[0m
[30;1m404 | [0m[35m                region=os.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m405 | [0m[35m                version=cluster.stack.version,[0m
[30;1m406 | [0m[35m                cluster_status=cloud_formation_status_to_cluster_status(CloudFormationStackStatus.UP[0m
[30;1m407 | [0m[35m                scheduler=Scheduler(type=cluster.stack.scheduler),[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m312 | [0m[35m                cluster_name=stack.cluster_name,[0m
[30;1m313 | [0m[35m                cloudformation_stack_status=stack.status,[0m
[30;1m314 | [0m[35m                cloudformation_stack_arn=stack.id,[0m
[30;1m315 | [0m[35m                region=os.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m316 | [0m[35m                version=stack.version,[0m
[30;1m317 | [0m[35m                cluster_status=current_cluster_status,[0m
[30;1m318 | [0m[35m                scheduler=Scheduler(type=stack.scheduler),[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m236 | [0m[35m        compute_fleet_status=fleet_status.value,[0m
[30;1m237 | [0m[35m        cloudformation_stack_arn=cfn_stack.id,[0m
[30;1m238 | [0m[35m        last_updated_time=to_utc_datetime(cfn_stack.last_updated_time),[0m
[30;1m239 | [0m[35m        region=os.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m240 | [0m[35m        cluster_status=cluster_status,[0m
[30;1m241 | [0m[35m        scheduler=Scheduler(type=cluster.stack.scheduler),[0m
[30;1m242 | [0m[35m        failures=_get_creation_failures(cluster_status, cfn_stack),[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m185 | [0m[35m                cluster_name=cluster_name,[0m
[30;1m186 | [0m[35m                cloudformation_stack_status=CloudFormationStackStatus.DELETE_IN_PROGRESS,[0m
[30;1m187 | [0m[35m                cloudformation_stack_arn=cluster.stack.id,[0m
[30;1m188 | [0m[35m                region=os.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m189 | [0m[35m                version=cluster.stack.version,[0m
[30;1m190 | [0m[35m                cluster_status=cloud_formation_status_to_cluster_status(CloudFormationStackStatus.DE[0m
[30;1m191 | [0m[35m                scheduler=Scheduler(type=cluster.stack.scheduler),[0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m139 | [0m[35m                cluster_name=create_cluster_request_content.cluster_name,[0m
[30;1m140 | [0m[35m                cloudformation_stack_status=CloudFormationStackStatus.CREATE_IN_PROGRESS,[0m
[30;1m141 | [0m[35m                cloudformation_stack_arn=stack_id,[0m
[30;1m142 | [0m[35m                region=os.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m143 | [0m[35m                version=get_installed_version(),[0m
[30;1m144 | [0m[35m                cluster_status=cloud_formation_status_to_cluster_status(CloudFormationStackStatus.CR[0m
[30;1m145 | [0m[35m                scheduler=Scheduler(type=cluster.config.scheduling.scheduler),[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1275 | [0m[35m                NetworkInterfaces=head_node_network_interfaces,[0m
[30;1m1276 | [0m[35m                DryRun=True,[0m
[30;1m1277 | [0m[35m                TagSpecifications=self._generate_tag_specifications(tags),[0m
[30;1m1278 | [0m[35m                KeyName=head_node.ssh.key_name,[0m
[30;1m1279 | [0m[35m                BlockDeviceMappings=([0m
[30;1m1280 | [0m[35m                    self._launch_template_builder.get_block_device_mappings([0m
[30;1m1281 | [0m[35m                        head_node.local_storage.root_volume, root_volume_device_name[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/awsbatch_builder.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m159 | [0m[35m                metadata_options=ec2.CfnLaunchTemplate.MetadataOptionsProperty(http_tokens=http_toke[0m
[30;1m160 | [0m[35m            ),[0m
[30;1m161 | [0m[35m        )[0m
[30;1m162 | [0m[35m        return batch.CfnComputeEnvironment.LaunchTemplateSpecificationProperty([0m
[30;1m163 | [0m[35m            launch_template_id=launch_template.ref,[0m
[30;1m164 | [0m[35m            version=launch_template.attr_latest_version_number,[0m
[30;1m165 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/awsbatch_builder.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m154 | [0m[35m    def _launch_template(self, http_tokens):[0m
[30;1m155 | [0m[35m        launch_template = ec2.CfnLaunchTemplate([0m
[30;1m156 | [0m[35m            self.stack_scope,[0m
[30;1m157 | [0m[35m            "PclusterComputeEnvironmentLaunchTemplate",[0m
[30;1m158 | [0m[35m            launch_template_data=ec2.CfnLaunchTemplate.LaunchTemplateDataProperty([0m
[30;1m159 | [0m[35m                metadata_options=ec2.CfnLaunchTemplate.MetadataOptionsProperty(http_tokens=http_toke[0m
[30;1m160 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/delete_image_stack.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m        # retrieve environment[0m
[30;1m60 | [0m[35m        stack_arn = os.environ.get("IMAGE_STACK_ARN")[0m
[30;1m61 | [0m[35m        aws_region = os.environ.get("AWS_REGION")[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        # convert the event message to json[0m
[30;1m64 | [0m[35m        message_json = json.loads(event_message)[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/delete_image_stack.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m57 | [0m[35m        logger.info("Printing event message: %s", json.dumps(event_message))[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m        # retrieve environment[0m
[30;1m60 | [0m[35m        stack_arn = os.environ.get("IMAGE_STACK_ARN")[0m
[30;1m61 | [0m[35m        aws_region = os.environ.get("AWS_REGION")[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        # convert the event message to json[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/commands.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m17 | [0m[35mfrom pcluster.cli.commands.configure.command import ConfigureCommand[0m
[30;1m18 | [0m[35mfrom pcluster.cli.commands.dcv_connect import DcvConnectCommand[0m
[30;1m19 | [0m[35mfrom pcluster.cli.commands.image_logs import ExportImageLogsCommand[0m
[30;1m20 | [0m[35mfrom pcluster.cli.commands.ssh import SshCommand[0m
[30;1m21 | [0m[35mfrom pcluster.cli.commands.version import VersionCommand[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m299 | [0m[35m        scheduler_prefix = scheduler.capitalize()[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35m    result = {[0m
[30;1m302 | [0m[35m        "Region": os.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m303 | [0m[35m        "Image": {"Os": base_os},[0m
[30;1m304 | [0m[35m        "HeadNode": head_node_config,[0m
[30;1m305 | [0m[35m        "Scheduling": {"Scheduler": scheduler, f"{scheduler_prefix}Queues": queues},[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/entrypoint.sh[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m7 | [0m[35m# Starting ssh agents[0m
[30;1m8 | [0m[35mecho "Starting ssh agents..."[0m
[30;1m9 | [0m[35meval "$(ssh-agent -s)" && ssh-add ${SSHDIR}/id_rsa[0m
[30;1m10 | [0m[35m/usr/sbin/sshd -f /root/.ssh/sshd_config -h /root/.ssh/ssh_host_rsa_key[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m# mount nfs[0m
[30;1m13 | [0m[35mecho "Mounting /home..."[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/entrypoint.sh[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m7 | [0m[35m# Starting ssh agents[0m
[30;1m8 | [0m[35mecho "Starting ssh agents..."[0m
[30;1m9 | [0m[35meval "$(ssh-agent -s)" && ssh-add ${SSHDIR}/id_rsa[0m
[30;1m10 | [0m[35m/usr/sbin/sshd -f /root/.ssh/sshd_config -h /root/.ssh/ssh_host_rsa_key[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m# mount nfs[0m
[30;1m13 | [0m[35mecho "Mounting /home..."[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/ssh.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35mReturns an ssh command with the cluster username and IP address pre-populated:[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m  ssh ec2-user@1.1.1.1 -i ~/.ssh/id_rsa"""[0m
[30;1m89 | [0m[35m    )[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    def __init__(self, subparsers):[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/ssh.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m81 | [0m[35m    epilog = textwrap.dedent([0m
[30;1m82 | [0m[35m        """Example:[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m  pcluster ssh --cluster-name mycluster -i ~/.ssh/id_rsa[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35mReturns an ssh command with the cluster username and IP address pre-populated:[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m44 | [0m[35m    && mkdir -p ${SSHDIR} \[0m
[30;1m45 | [0m[35m    && touch ${SSHDIR}/sshd_config \[0m
[30;1m46 | [0m[35m    && ssh-keygen -t rsa -f ${SSHDIR}/ssh_host_rsa_key -N '' \[0m
[30;1m47 | [0m[35m    && cp ${SSHDIR}/ssh_host_rsa_key.pub ${SSHDIR}/authorized_keys \[0m
[30;1m48 | [0m[35m    && cp ${SSHDIR}/ssh_host_rsa_key ${SSHDIR}/id_rsa \[0m
[30;1m49 | [0m[35m    && echo "    IdentityFile ${SSHDIR}/id_rsa" >> /etc/ssh/ssh_config \[0m
[30;1m50 | [0m[35m    && echo "Host *" >> /etc/ssh/ssh_config && echo "    StrictHostKeyChecking no" >> /etc/ssh/ssh_c[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m39 | [0m[35m    && echo "export VISIBLE=now" >> /etc/profile[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m# create ssh keys[0m
[30;1m42 | [0m[35mENV SSHDIR /root/.ssh[0m
[30;1m43 | [0m[35mRUN echo "${USER} ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers \[0m
[30;1m44 | [0m[35m    && mkdir -p ${SSHDIR} \[0m
[30;1m45 | [0m[35m    && touch ${SSHDIR}/sshd_config \[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m# Setup passwordless ssh[0m
[30;1m36 | [0m[35mENV NOTVISIBLE "in users profile"[0m
[30;1m37 | [0m[35mRUN sed -i 's/PermitRootLogin without-password/PermitRootLogin yes/' /etc/ssh/sshd_config \[0m
[30;1m38 | [0m[35m    && sed 's@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d[0m
[30;1m39 | [0m[35m    && echo "export VISIBLE=now" >> /etc/profile[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m32 | [0m[35m    && mkdir -p /parallelcluster/bin \[0m
[30;1m33 | [0m[35m    && export DEBIAN_FRONTEND=noninteractive[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m# Setup passwordless ssh[0m
[30;1m36 | [0m[35mENV NOTVISIBLE "in users profile"[0m
[30;1m37 | [0m[35mRUN sed -i 's/PermitRootLogin without-password/PermitRootLogin yes/' /etc/ssh/sshd_config \[0m
[30;1m38 | [0m[35m    && sed 's@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m44 | [0m[35m    && mkdir -p ${SSHDIR} \[0m
[30;1m45 | [0m[35m    && touch ${SSHDIR}/sshd_config \[0m
[30;1m46 | [0m[35m    && ssh-keygen -t rsa -f ${SSHDIR}/ssh_host_rsa_key -N '' \[0m
[30;1m47 | [0m[35m    && cp ${SSHDIR}/ssh_host_rsa_key.pub ${SSHDIR}/authorized_keys \[0m
[30;1m48 | [0m[35m    && cp ${SSHDIR}/ssh_host_rsa_key ${SSHDIR}/id_rsa \[0m
[30;1m49 | [0m[35m    && echo "    IdentityFile ${SSHDIR}/id_rsa" >> /etc/ssh/ssh_config \[0m
[30;1m50 | [0m[35m    && echo "Host *" >> /etc/ssh/ssh_config && echo "    StrictHostKeyChecking no" >> /etc/ssh/ssh_c[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m39 | [0m[35m    && echo "export VISIBLE=now" >> /etc/profile[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m# create ssh keys[0m
[30;1m42 | [0m[35mENV SSHDIR /root/.ssh[0m
[30;1m43 | [0m[35mRUN echo "${USER} ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers \[0m
[30;1m44 | [0m[35m    && mkdir -p ${SSHDIR} \[0m
[30;1m45 | [0m[35m    && touch ${SSHDIR}/sshd_config \[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m# Setup passwordless ssh[0m
[30;1m36 | [0m[35mENV NOTVISIBLE "in users profile"[0m
[30;1m37 | [0m[35mRUN sed -i 's/PermitRootLogin without-password/PermitRootLogin yes/' /etc/ssh/sshd_config \[0m
[30;1m38 | [0m[35m    && sed 's@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d[0m
[30;1m39 | [0m[35m    && echo "export VISIBLE=now" >> /etc/profile[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m32 | [0m[35m    && mkdir -p /parallelcluster/bin \[0m
[30;1m33 | [0m[35m    && export DEBIAN_FRONTEND=noninteractive[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m# Setup passwordless ssh[0m
[30;1m36 | [0m[35mENV NOTVISIBLE "in users profile"[0m
[30;1m37 | [0m[35mRUN sed -i 's/PermitRootLogin without-password/PermitRootLogin yes/' /etc/ssh/sshd_config \[0m
[30;1m38 | [0m[35m    && sed 's@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m144 | [0m[35m        else:[0m
[30;1m145 | [0m[35m            raise DCVConnectionError(e.output)[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m    return "https://{IP}:{PORT}?authToken={TOKEN}#{SESSION_ID}".format([0m
[30;1m148 | [0m[35m        IP=node_ip,[0m
[30;1m149 | [0m[35m        PORT=dcv_server_port,  # pylint: disable=E0606[0m
[30;1m150 | [0m[35m        TOKEN=dcv_session_token,  # pylint: disable=E0606[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/awsbatch_builder.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m659 | [0m[35m[0m
[30;1m660 | [0m[35m        awslambda.CfnPermission([0m
[30;1m661 | [0m[35m            self.stack_scope,[0m
[30;1m662 | [0m[35m            "BuildNotificationFunctionInvokePermission",[0m
[30;1m663 | [0m[35m            action="lambda:InvokeFunction",[0m
[30;1m664 | [0m[35m            function_name=self._code_build_notification_lambda.attr_arn,[0m
[30;1m665 | [0m[35m            principal="events.amazonaws.com",[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/awsbatch_builder.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m154 | [0m[35m    def _launch_template(self, http_tokens):[0m
[30;1m155 | [0m[35m        launch_template = ec2.CfnLaunchTemplate([0m
[30;1m156 | [0m[35m            self.stack_scope,[0m
[30;1m157 | [0m[35m            "PclusterComputeEnvironmentLaunchTemplate",[0m
[30;1m158 | [0m[35m            launch_template_data=ec2.CfnLaunchTemplate.LaunchTemplateDataProperty([0m
[30;1m159 | [0m[35m                metadata_options=ec2.CfnLaunchTemplate.MetadataOptionsProperty(http_tokens=http_toke[0m
[30;1m160 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000104[0m
       Tag: [34mSecurity.Backdoor.CurlBashing[0m
  Severity: [36mImportant[0m, Confidence: [36mMedium[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m(curl|wget).{1,50}\|\s*(sh|bash)[0m
[30;1m241 | [0m[35m                apt-get -y --only-upgrade install ca-certificates[0m
[30;1m242 | [0m[35m              fi[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m              curl --retry 3 -L {{ build.CincUrl.outputs.stdout }} | bash -s -- -v {{ ChefVersion }}[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m              if [[ -e ${!CA_CERTS_FILE} ]]; then[0m
[30;1m247 | [0m[35m                mkdir -p /opt/cinc/embedded/ssl/certs[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/build_image_bad_request_exception_response_content.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m39 | [0m[35m        self._message = message[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    @classmethod[0m
[30;1m42 | [0m[35m    def from_dict(cls, dikt) -> "BuildImageBadRequestExceptionResponseContent":[0m
[30;1m43 | [0m[35m        """Returns the dict as a model[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m        :param dikt: A dict.[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/create_cluster_bad_request_exception_response_content.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m39 | [0m[35m        self._message = message[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    @classmethod[0m
[30;1m42 | [0m[35m    def from_dict(cls, dikt) -> "CreateClusterBadRequestExceptionResponseContent":[0m
[30;1m43 | [0m[35m        """Returns the dict as a model[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m        :param dikt: A dict.[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/update_cluster_bad_request_exception_response_content.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m60 | [0m[35m        self._change_set = change_set[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    @classmethod[0m
[30;1m63 | [0m[35m    def from_dict(cls, dikt) -> "UpdateClusterBadRequestExceptionResponseContent":[0m
[30;1m64 | [0m[35m        """Returns the dict as a model[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m        :param dikt: A dict.[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35mdef assert_supported_operation(operation: Operation, region: str):[0m
[30;1m187 | [0m[35m    """Raise a BadRequestException if the operation is not supported in the region."""[0m
[30;1m188 | [0m[35m    _region = get_region() if region is None else region[0m
[30;1m189 | [0m[35m    prefixes_of_unsupported_regions = UNSUPPORTED_OPERATIONS_MAP.get(operation, [])[0m
[30;1m190 | [0m[35m    if any(_region.startswith(region_prefix) for region_prefix in prefixes_of_unsupported_regions):[0m
[30;1m191 | [0m[35m        message = f"The operation '{operation.value}' is not supported in region '{region}'."[0m
[30;1m192 | [0m[35m        LOGGER.critical(message)[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m    def _decorator_validate_region(func):[0m
[30;1m78 | [0m[35m        @functools.wraps(func)[0m
[30;1m79 | [0m[35m        def _wrapper_validate_region(*args, **kwargs):[0m
[30;1m80 | [0m[35m            _set_region(kwargs.get("region") or boto3.Session().region_name)[0m
[30;1m81 | [0m[35m            return func(*args, **kwargs)[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m        return _wrapper_validate_region[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m    # Allow parsing errors to pass through as they will be caught by later functions[0m
[30;1m57 | [0m[35m    # which can provide more specific error text based on the operation.[0m
[30;1m58 | [0m[35m    try:[0m
[30;1m59 | [0m[35m        config_region = parse_config(config_str).get("Region")[0m
[30;1m60 | [0m[35m    except Exception:[0m
[30;1m61 | [0m[35m        config_region = None[0m
[30;1m62 | [0m[35m    if region and config_region and region != config_region:[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35mdef _set_region(region):[0m
[30;1m41 | [0m[35m    if not region:[0m
[30;1m42 | [0m[35m        raise BadRequestException("region needs to be set")[0m
[30;1m43 | [0m[35m    region_backup = os.environ.get("AWS_DEFAULT_REGION")[0m
[30;1m44 | [0m[35m    LOGGER.info("Setting AWS Region to %s", region)[0m
[30;1m45 | [0m[35m    os.environ["AWS_DEFAULT_REGION"] = region[0m
[30;1m46 | [0m[35m    if region not in retrieve_supported_regions():[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/common.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m7 | [0m[35m#  limitations under the License.[0m
[30;1m8 | [0m[35m#[0m
[30;1m9 | [0m[35m#  Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except [0m
[30;1m10 | [0m[35m#  with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m11 | [0m[35m#  or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS[0m
[30;1m12 | [0m[35m#  OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governin[0m
[30;1m13 | [0m[35m#  limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/common.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m#  Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m#  Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except [0m
[30;1m4 | [0m[35m#  with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m#  or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS[0m
[30;1m6 | [0m[35m#  OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governin[0m
[30;1m7 | [0m[35m#  limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m119 | [0m[35m                    task_id=task_id, tasks=json.dumps(tasks, indent=2)[0m
[30;1m120 | [0m[35m                ),[0m
[30;1m121 | [0m[35m            )[0m
[30;1m122 | [0m[35m        return tasks[0].get("status").get("code")[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m125 | [0m[35m    def describe_log_streams(self, log_group_name, log_stream_name_prefix=None, next_token=None):[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m119 | [0m[35m                    task_id=task_id, tasks=json.dumps(tasks, indent=2)[0m
[30;1m120 | [0m[35m                ),[0m
[30;1m121 | [0m[35m            )[0m
[30;1m122 | [0m[35m        return tasks[0].get("status").get("code")[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m125 | [0m[35m    def describe_log_streams(self, log_group_name, log_stream_name_prefix=None, next_token=None):[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m110 | [0m[35m    def get_export_task_status(self, task_id):[0m
[30;1m111 | [0m[35m        """Get the status for the CloudWatch export task with the given task_id."""[0m
[30;1m112 | [0m[35m        tasks = self._client.describe_export_tasks(taskId=task_id).get("exportTasks", None)[0m
[30;1m113 | [0m[35m        if not tasks:[0m
[30;1m114 | [0m[35m            raise AWSClientError(function_name="describe_export_tasks", message=f"Log export task {t[0m
[30;1m115 | [0m[35m        if len(tasks) > 2:[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m        }[0m
[30;1m105 | [0m[35m        if log_stream_name_prefix:[0m
[30;1m106 | [0m[35m            kwargs["logStreamNamePrefix"] = log_stream_name_prefix[0m
[30;1m107 | [0m[35m        return self._client.create_export_task(**kwargs).get("taskId")[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m110 | [0m[35m    def get_export_task_status(self, task_id):[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m            kwargs["endTime"] = end_time[0m
[30;1m58 | [0m[35m        if log_stream_name_prefix:[0m
[30;1m59 | [0m[35m            kwargs["logStreamNamePrefix"] = log_stream_name_prefix[0m
[30;1m60 | [0m[35m        return self._client.filter_log_events(**kwargs).get("events")[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m63 | [0m[35m    def get_log_events([0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/logs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m    def describe_log_group(self, log_group_name):[0m
[30;1m44 | [0m[35m        """Return log group identified by the given log group name."""[0m
[30;1m45 | [0m[35m        for group in self.describe_log_groups(log_group_name_prefix=log_group_name):[0m
[30;1m46 | [0m[35m            if group.get("logGroupName") == log_group_name:[0m
[30;1m47 | [0m[35m                return group[0m
[30;1m48 | [0m[35m        raise AWSClientError(function_name="describe_log_groups", message=f"Log Group {log_group_nam[0m
[30;1m49 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/logs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m        start_from_head=None,[0m
[30;1m71 | [0m[35m        next_token=None,[0m
[30;1m72 | [0m[35m    ):[0m
[30;1m73 | [0m[35m        """Return the list of events included in a specific time window for a given log stream."""[0m
[30;1m74 | [0m[35m        kwargs = {"logGroupName": log_group_name, "logStreamName": log_stream_name}[0m
[30;1m75 | [0m[35m        if start_time:[0m
[30;1m76 | [0m[35m            kwargs["startTime"] = start_time[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m51 | [0m[35m    def filter_log_events(self, log_group_name, start_time=None, end_time=None, log_stream_name_pref[0m
[30;1m52 | [0m[35m        """Return the list of events included in a specific time window for a given group name."""[0m
[30;1m53 | [0m[35m        kwargs = {"logGroupName": log_group_name, "limit": 1}[0m
[30;1m54 | [0m[35m        if start_time:[0m
[30;1m55 | [0m[35m            kwargs["startTime"] = start_time[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m572 | [0m[35m                raise Exception("No route tables found. The subnet or VPC configuration may be incor[0m
[30;1m573 | [0m[35m[0m
[30;1m574 | [0m[35m        # Check if any route contains an internet gateway (igw)[0m
[30;1m575 | [0m[35m        for route in route_tables[0].get("Routes", []):[0m
[30;1m576 | [0m[35m            if "GatewayId" in route and route["GatewayId"].startswith("igw-"):[0m
[30;1m577 | [0m[35m                return True[0m
[30;1m578 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m565 | [0m[35m            subnets = self.describe_subnets([subnet_id])[0m
[30;1m566 | [0m[35m            if not subnets:[0m
[30;1m567 | [0m[35m                raise Exception(f"No subnet found with ID {subnet_id}")[0m
[30;1m568 | [0m[35m            vpc_id = subnets[0].get("VpcId")[0m
[30;1m569 | [0m[35m[0m
[30;1m570 | [0m[35m            route_tables = self.describe_route_tables(filters=[{"Name": "vpc-id", "Values": [vpc_id][0m
[30;1m571 | [0m[35m            if not route_tables:[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m497 | [0m[35m        try:[0m
[30;1m498 | [0m[35m            self._client.run_instances(**kwargs)[0m
[30;1m499 | [0m[35m        except ClientError as e:[0m
[30;1m500 | [0m[35m            if e.response.get("Error").get("Code") != "DryRunOperation":[0m
[30;1m501 | [0m[35m                raise[0m
[30;1m502 | [0m[35m[0m
[30;1m503 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m497 | [0m[35m        try:[0m
[30;1m498 | [0m[35m            self._client.run_instances(**kwargs)[0m
[30;1m499 | [0m[35m        except ClientError as e:[0m
[30;1m500 | [0m[35m            if e.response.get("Error").get("Code") != "DryRunOperation":[0m
[30;1m501 | [0m[35m                raise[0m
[30;1m502 | [0m[35m[0m
[30;1m503 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m489 | [0m[35m    @Cache.cached[0m
[30;1m490 | [0m[35m    def describe_volume(self, volume_id):[0m
[30;1m491 | [0m[35m        """Describe a volume."""[0m
[30;1m492 | [0m[35m        return self._client.describe_volumes(VolumeIds=[volume_id]).get("Volumes")[0][0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m495 | [0m[35m    def run_instances(self, **kwargs):[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m474 | [0m[35m                self._paginate_results(self._client.describe_security_groups, GroupIds=missed_securi[0m
[30;1m475 | [0m[35m            )[0m
[30;1m476 | [0m[35m            for security_group in response:[0m
[30;1m477 | [0m[35m                self.security_groups_cache[security_group.get("GroupId")] = security_group[0m
[30;1m478 | [0m[35m                result.append(security_group)[0m
[30;1m479 | [0m[35m        return result[0m
[30;1m480 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m464 | [0m[35m        result = [][0m
[30;1m465 | [0m[35m        missed_security_group_ids = [][0m
[30;1m466 | [0m[35m        for security_group_id in security_group_ids:[0m
[30;1m467 | [0m[35m            cached_data = self.security_groups_cache.get(security_group_id)[0m
[30;1m468 | [0m[35m            if cached_data:[0m
[30;1m469 | [0m[35m                result.append(cached_data)[0m
[30;1m470 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m451 | [0m[35m            "SnapshotId": "snap-1234567890abcdef0",[0m
[30;1m452 | [0m[35m        }[0m
[30;1m453 | [0m[35m        """[0m
[30;1m454 | [0m[35m        return self._client.describe_snapshots(SnapshotIds=[ebs_snapshot_id]).get("Snapshots")[0][0m
[30;1m455 | [0m[35m[0m
[30;1m456 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m457 | [0m[35m    def describe_security_group(self, security_group_id):[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m379 | [0m[35m        instances = [][0m
[30;1m380 | [0m[35m        for reservation in response["Reservations"]:[0m
[30;1m381 | [0m[35m            instances.extend(reservation["Instances"])[0m
[30;1m382 | [0m[35m        return instances, response.get("NextToken")[0m
[30;1m383 | [0m[35m[0m
[30;1m384 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m385 | [0m[35m    @Cache.cached[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m366 | [0m[35m        return [[0m
[30;1m367 | [0m[35m            instance.get("InstanceId")[0m
[30;1m368 | [0m[35m            for result in self._paginate_results(self._client.describe_instances, Filters=filters)[0m
[30;1m369 | [0m[35m            for instance in result.get("Instances")[0m
[30;1m370 | [0m[35m        ][0m
[30;1m371 | [0m[35m[0m
[30;1m372 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m364 | [0m[35m    def list_instance_ids(self, filters):[0m
[30;1m365 | [0m[35m        """Retrieve a filtered list of instance ids."""[0m
[30;1m366 | [0m[35m        return [[0m
[30;1m367 | [0m[35m            instance.get("InstanceId")[0m
[30;1m368 | [0m[35m            for result in self._paginate_results(self._client.describe_instances, Filters=filters)[0m
[30;1m369 | [0m[35m            for instance in result.get("Instances")[0m
[30;1m370 | [0m[35m        ][0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m351 | [0m[35m    def _get_official_image_name_prefix(os=None, architecture=None):[0m
[30;1m352 | [0m[35m        """Return the prefix of the current official image, for the provided os-architecture combina[0m
[30;1m353 | [0m[35m        version = utils.get_installed_version()[0m
[30;1m354 | [0m[35m        os = "*" if os is None else OS_TO_IMAGE_NAME_PART_MAP.get(os, "")[0m
[30;1m355 | [0m[35m        architecture = architecture or "*"[0m
[30;1m356 | [0m[35m        return f"aws-parallelcluster-{version}-{os}-{architecture}"[0m
[30;1m357 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m345 | [0m[35m        name_pattern = "aws-parallelcluster-[^-]+-(?P<OsPart>.+-hvm)-.*"[0m
[30;1m346 | [0m[35m        matches = re.match(name_pattern, name)[0m
[30;1m347 | [0m[35m        os_part = matches.groupdict().get("OsPart") if matches else None[0m
[30;1m348 | [0m[35m        return IMAGE_NAME_PART_TO_OS_MAP.get(os_part, "linux")[0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m    @staticmethod[0m
[30;1m351 | [0m[35m    def _get_official_image_name_prefix(os=None, architecture=None):[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m344 | [0m[35m        """Return the os from the os part in an official image name."""[0m
[30;1m345 | [0m[35m        name_pattern = "aws-parallelcluster-[^-]+-(?P<OsPart>.+-hvm)-.*"[0m
[30;1m346 | [0m[35m        matches = re.match(name_pattern, name)[0m
[30;1m347 | [0m[35m        os_part = matches.groupdict().get("OsPart") if matches else None[0m
[30;1m348 | [0m[35m        return IMAGE_NAME_PART_TO_OS_MAP.get(os_part, "linux")[0m
[30;1m349 | [0m[35m[0m
[30;1m350 | [0m[35m    @staticmethod[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m315 | [0m[35m        images = self._describe_images_with_pagination(Owners=[owner], Filters=filters, IncludeDepre[0m
[30;1m316 | [0m[35m        if not images:[0m
[30;1m317 | [0m[35m            raise AWSClientError(function_name="describe_images", message="Cannot find official Para[0m
[30;1m318 | [0m[35m        return self._find_valid_official_image(images).get("ImageId")[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m321 | [0m[35m    @Cache.cached[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m286 | [0m[35m        """Return the results of calling EC2's DescribeInstanceTypes API for the given instance type[0m
[30;1m287 | [0m[35m        return InstanceTypeInfo([0m
[30;1m288 | [0m[35m            self.additional_instance_types_data.get(instance_type)[0m
[30;1m289 | [0m[35m            or self._client.describe_instance_types(InstanceTypes=[instance_type]).get("InstanceType[0m
[30;1m290 | [0m[35m        )[0m
[30;1m291 | [0m[35m[0m
[30;1m292 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m285 | [0m[35m    def get_instance_type_info(self, instance_type):[0m
[30;1m286 | [0m[35m        """Return the results of calling EC2's DescribeInstanceTypes API for the given instance type[0m
[30;1m287 | [0m[35m        return InstanceTypeInfo([0m
[30;1m288 | [0m[35m            self.additional_instance_types_data.get(instance_type)[0m
[30;1m289 | [0m[35m            or self._client.describe_instance_types(InstanceTypes=[instance_type]).get("InstanceType[0m
[30;1m290 | [0m[35m        )[0m
[30;1m291 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m277 | [0m[35m        return ([0m
[30;1m278 | [0m[35m            self.describe_vpc_attribute(vpc_id=vpc_id, attribute="enableDnsHostnames")[0m
[30;1m279 | [0m[35m            .get("EnableDnsHostnames")[0m
[30;1m280 | [0m[35m            .get("Value")[0m
[30;1m281 | [0m[35m        )[0m
[30;1m282 | [0m[35m[0m
[30;1m283 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m276 | [0m[35m        """Return the value of EnableDnsHostnames of the VPC."""[0m
[30;1m277 | [0m[35m        return ([0m
[30;1m278 | [0m[35m            self.describe_vpc_attribute(vpc_id=vpc_id, attribute="enableDnsHostnames")[0m
[30;1m279 | [0m[35m            .get("EnableDnsHostnames")[0m
[30;1m280 | [0m[35m            .get("Value")[0m
[30;1m281 | [0m[35m        )[0m
[30;1m282 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m269 | [0m[35m        return ([0m
[30;1m270 | [0m[35m            self.describe_vpc_attribute(vpc_id=vpc_id, attribute="enableDnsSupport")[0m
[30;1m271 | [0m[35m            .get("EnableDnsSupport")[0m
[30;1m272 | [0m[35m            .get("Value")[0m
[30;1m273 | [0m[35m        )[0m
[30;1m274 | [0m[35m[0m
[30;1m275 | [0m[35m    def is_enable_dns_hostnames(self, vpc_id):[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m268 | [0m[35m        """Return the value of EnableDnsSupport of the VPC."""[0m
[30;1m269 | [0m[35m        return ([0m
[30;1m270 | [0m[35m            self.describe_vpc_attribute(vpc_id=vpc_id, attribute="enableDnsSupport")[0m
[30;1m271 | [0m[35m            .get("EnableDnsSupport")[0m
[30;1m272 | [0m[35m            .get("Value")[0m
[30;1m273 | [0m[35m        )[0m
[30;1m274 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m232 | [0m[35m        """Get account ids that image is shared with."""[0m
[30;1m233 | [0m[35m        return [[0m
[30;1m234 | [0m[35m            permission.get("UserId") or permission.get("Group")[0m
[30;1m235 | [0m[35m            for permission in self._client.describe_image_attribute(Attribute="launchPermission", Im[0m
[30;1m236 | [0m[35m                "LaunchPermissions"[0m
[30;1m237 | [0m[35m            )[0m
[30;1m238 | [0m[35m        ][0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m231 | [0m[35m    def get_image_shared_account_ids(self, image_id):[0m
[30;1m232 | [0m[35m        """Get account ids that image is shared with."""[0m
[30;1m233 | [0m[35m        return [[0m
[30;1m234 | [0m[35m            permission.get("UserId") or permission.get("Group")[0m
[30;1m235 | [0m[35m            for permission in self._client.describe_image_attribute(Attribute="launchPermission", Im[0m
[30;1m236 | [0m[35m                "LaunchPermissions"[0m
[30;1m237 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m231 | [0m[35m    def get_image_shared_account_ids(self, image_id):[0m
[30;1m232 | [0m[35m        """Get account ids that image is shared with."""[0m
[30;1m233 | [0m[35m        return [[0m
[30;1m234 | [0m[35m            permission.get("UserId") or permission.get("Group")[0m
[30;1m235 | [0m[35m            for permission in self._client.describe_image_attribute(Attribute="launchPermission", Im[0m
[30;1m236 | [0m[35m                "LaunchPermissions"[0m
[30;1m237 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m224 | [0m[35m                    {"Name": "instance-state-name", "Values": list(instance_state)},[0m
[30;1m225 | [0m[35m                ],[0m
[30;1m226 | [0m[35m            )[0m
[30;1m227 | [0m[35m            for instance in result.get("Instances")[0m
[30;1m228 | [0m[35m        ][0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m216 | [0m[35m        """Get instance ids by ami id, when status is not terminated nor shutting-down."""[0m
[30;1m217 | [0m[35m        instance_state = ("pending", "running", "stopping", "stopped")[0m
[30;1m218 | [0m[35m        return [[0m
[30;1m219 | [0m[35m            instance.get("InstanceId")[0m
[30;1m220 | [0m[35m            for result in self._paginate_results([0m
[30;1m221 | [0m[35m                self._client.describe_instances,[0m
[30;1m222 | [0m[35m                Filters=[[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m138 | [0m[35m        """Return cidr block  of the given subnet."""[0m
[30;1m139 | [0m[35m        subnets = self.describe_subnets([subnet_id])[0m
[30;1m140 | [0m[35m        if subnets:[0m
[30;1m141 | [0m[35m            return subnets[0].get("CidrBlock")[0m
[30;1m142 | [0m[35m        raise AWSClientError(function_name="describe_subnets", message=f"Subnet {subnet_id} not foun[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35m        """Return a vpc associated to the given subnet."""[0m
[30;1m130 | [0m[35m        subnets = self.describe_subnets([subnet_id])[0m
[30;1m131 | [0m[35m        if subnets:[0m
[30;1m132 | [0m[35m            return subnets[0].get("VpcId")[0m
[30;1m133 | [0m[35m        raise AWSClientError(function_name="describe_subnets", message=f"Subnet {subnet_id} not foun[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m        """Return the availability zone associated to the given subnet."""[0m
[30;1m117 | [0m[35m        subnets = self.describe_subnets([subnet_id])[0m
[30;1m118 | [0m[35m        if subnets:[0m
[30;1m119 | [0m[35m            return subnets[0].get("AvailabilityZone")[0m
[30;1m120 | [0m[35m        raise AWSClientError(function_name="describe_subnets", message=f"Subnet {subnet_id} not foun[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m    def get_subnets_az_mapping(self, subnet_ids):[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m                )[0m
[30;1m105 | [0m[35m            )[0m
[30;1m106 | [0m[35m            for capacity_reservation in response:[0m
[30;1m107 | [0m[35m                self.capacity_reservations_cache[capacity_reservation.get("CapacityReservationId")] [0m
[30;1m108 | [0m[35m                    CapacityReservationInfo(capacity_reservation)[0m
[30;1m109 | [0m[35m                )[0m
[30;1m110 | [0m[35m                result.append(CapacityReservationInfo(capacity_reservation))[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m        result = [][0m
[30;1m93 | [0m[35m        missed_capacity_reservations = [][0m
[30;1m94 | [0m[35m        for capacity_reservation_id in capacity_reservation_ids:[0m
[30;1m95 | [0m[35m            cached_data = self.capacity_reservations_cache.get(capacity_reservation_id)[0m
[30;1m96 | [0m[35m            if cached_data:[0m
[30;1m97 | [0m[35m                result.append(cached_data)[0m
[30;1m98 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35m        if missed_subnets:[0m
[30;1m83 | [0m[35m            response = list(self._paginate_results(self._client.describe_subnets, SubnetIds=missed_s[0m
[30;1m84 | [0m[35m            for subnet in response:[0m
[30;1m85 | [0m[35m                self.subnets_cache[subnet.get("SubnetId")] = subnet[0m
[30;1m86 | [0m[35m                result.append(subnet)[0m
[30;1m87 | [0m[35m        return result[0m
[30;1m88 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m        result = [][0m
[30;1m75 | [0m[35m        missed_subnets = [][0m
[30;1m76 | [0m[35m        for subnet_id in subnet_ids:[0m
[30;1m77 | [0m[35m            cached_data = self.subnets_cache.get(subnet_id)[0m
[30;1m78 | [0m[35m            if cached_data:[0m
[30;1m79 | [0m[35m                result.append(cached_data)[0m
[30;1m80 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m    @Cache.cached[0m
[30;1m44 | [0m[35m    def list_instance_types(self) -> List[str]:[0m
[30;1m45 | [0m[35m        """Return a list of instance types."""[0m
[30;1m46 | [0m[35m        return [offering.get("InstanceType") for offering in self.describe_instance_type_offerings()[0m
[30;1m47 | [0m[35m            self.additional_instance_types_data.keys()[0m
[30;1m48 | [0m[35m        )[0m
[30;1m49 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ec2.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m314 | [0m[35m        filters.extend([{"Name": f"tag:{tag.key}", "Values": [tag.value]} for tag in tags])[0m
[30;1m315 | [0m[35m        images = self._describe_images_with_pagination(Owners=[owner], Filters=filters, IncludeDepre[0m
[30;1m316 | [0m[35m        if not images:[0m
[30;1m317 | [0m[35m            raise AWSClientError(function_name="describe_images", message="Cannot find official Para[0m
[30;1m318 | [0m[35m        return self._find_valid_official_image(images).get("ImageId")[0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/s3_resource.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/exceptions.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m3 | [0m[35m#[0m
[30;1m4 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not[0m
[30;1m5 | [0m[35m# use this file except in compliance with the License. A copy of the License is[0m
[30;1m6 | [0m[35m# located at[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m9 | [0m[35m#[0m
[30;1m10 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/constants.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m281 | [0m[35m    Enumeration of operations.[0m
[30;1m282 | [0m[35m[0m
[30;1m283 | [0m[35m    We do not expect this enumeration to list all the operations,[0m
[30;1m284 | [0m[35m    but at least those that are considered for operations flagging.[0m
[30;1m285 | [0m[35m    """[0m
[30;1m286 | [0m[35m[0m
[30;1m287 | [0m[35m    BUILD_IMAGE = "build-image"[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/constants.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m243 | [0m[35m    Enumeration of features.[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m    We do not expect this enumeration to list all the features,[0m
[30;1m246 | [0m[35m    but at least those that are considered for feature flagging.[0m
[30;1m247 | [0m[35m    """[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m    BATCH = "AWS Batch scheduler"[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/constants.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m13 | [0m[35mPCLUSTER_NAME_MAX_LENGTH = 60[0m
[30;1m14 | [0m[35m# When Slurm accounting is enabled, Slurm creates database tables with the format 'cluster_name' + '[0m
[30;1m15 | [0m[35m# MySQL and MariaDB have a maximum table name length of 64 characters.[0m
[30;1m16 | [0m[35m# The longest suffix used by Slurm is 24 chars, therefore the cluster name must be at most 40 chars [0m
[30;1m17 | [0m[35mPCLUSTER_NAME_MAX_LENGTH_SLURM_ACCOUNTING = 40[0m
[30;1m18 | [0m[35mPCLUSTER_NAME_REGEX = r"^([a-zA-Z][a-zA-Z0-9-]{0,%d})$"[0m
[30;1m19 | [0m[35mPCLUSTER_ISSUES_LINK = "https://github.com/aws/aws-parallelcluster/issues"[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/constants.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m306 | [0m[35m    LIST_IMAGES = "list-images"[0m
[30;1m307 | [0m[35m    LIST_IMAGE_LOG_STREAMS = "list-image-log-streams"[0m
[30;1m308 | [0m[35m    LIST_OFFICIAL_IMAGES = "list-official-images"[0m
[30;1m309 | [0m[35m    SSH = "ssh"[0m
[30;1m310 | [0m[35m    UPDATE_CLUSTER = "update-cluster"[0m
[30;1m311 | [0m[35m    UPDATE_COMOPUTE_FLEET = "update-compute-fleet"[0m
[30;1m312 | [0m[35m    VERSION = "version"[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m280 | [0m[35m    """[0m
[30;1m281 | [0m[35m    Enumeration of operations.[0m
[30;1m282 | [0m[35m[0m
[30;1m283 | [0m[35m    We do not expect this enumeration to list all the operations,[0m
[30;1m284 | [0m[35m    but at least those that are considered for operations flagging.[0m
[30;1m285 | [0m[35m    """[0m
[30;1m286 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m242 | [0m[35m    """[0m
[30;1m243 | [0m[35m    Enumeration of features.[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m    We do not expect this enumeration to list all the features,[0m
[30;1m246 | [0m[35m    but at least those that are considered for feature flagging.[0m
[30;1m247 | [0m[35m    """[0m
[30;1m248 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m189 | [0m[35m# PCLUSTER_CLUSTER_NAME_TAG needs to be the same as the hard coded strings in node package[0m
[30;1m190 | [0m[35m# and in cleanup_resource.py used by Lambda function[0m
[30;1m191 | [0m[35mPCLUSTER_CLUSTER_NAME_TAG = f"{PCLUSTER_PREFIX}cluster-name"[0m
[30;1m192 | [0m[35m# PCLUSTER_NODE_TYPE_TAG needs to be the same as the hard coded strings in node package[0m
[30;1m193 | [0m[35mPCLUSTER_NODE_TYPE_TAG = f"{PCLUSTER_PREFIX}node-type"[0m
[30;1m194 | [0m[35mPCLUSTER_QUEUE_NAME_TAG = f"{PCLUSTER_PREFIX}queue-name"[0m
[30;1m195 | [0m[35mPCLUSTER_COMPUTE_RESOURCE_NAME_TAG = f"{PCLUSTER_PREFIX}compute-resource-name"[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m186 | [0m[35mPCLUSTER_IMAGE_OS_TAG = f"{PCLUSTER_PREFIX}os"[0m
[30;1m187 | [0m[35mPCLUSTER_IMAGE_BUILD_LOG_TAG = f"{PCLUSTER_PREFIX}build_log"[0m
[30;1m188 | [0m[35mPCLUSTER_VERSION_TAG = f"{PCLUSTER_PREFIX}version"[0m
[30;1m189 | [0m[35m# PCLUSTER_CLUSTER_NAME_TAG needs to be the same as the hard coded strings in node package[0m
[30;1m190 | [0m[35m# and in cleanup_resource.py used by Lambda function[0m
[30;1m191 | [0m[35mPCLUSTER_CLUSTER_NAME_TAG = f"{PCLUSTER_PREFIX}cluster-name"[0m
[30;1m192 | [0m[35m# PCLUSTER_NODE_TYPE_TAG needs to be the same as the hard coded strings in node package[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/constants.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mPCLUSTER_NAME_MAX_LENGTH = 60[0m
[30;1m14 | [0m[35m# When Slurm accounting is enabled, Slurm creates database tables with the format 'cluster_name' + '[0m
[30;1m15 | [0m[35m# MySQL and MariaDB have a maximum table name length of 64 characters.[0m
[30;1m16 | [0m[35m# The longest suffix used by Slurm is 24 chars, therefore the cluster name must be at most 40 chars [0m
[30;1m17 | [0m[35mPCLUSTER_NAME_MAX_LENGTH_SLURM_ACCOUNTING = 40[0m
[30;1m18 | [0m[35mPCLUSTER_NAME_REGEX = r"^([a-zA-Z][a-zA-Z0-9-]{0,%d})$"[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/batch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m            self._call_create_compute_environment_with_bad_instance_type()[0m
[30;1m70 | [0m[35m        except ClientError as e:[0m
[30;1m71 | [0m[35m            # This is the expected behavior[0m
[30;1m72 | [0m[35m            return e.response.get("Error").get("Message")[0m
[30;1m73 | [0m[35m        except EndpointConnectionError:[0m
[30;1m74 | [0m[35m            raise BatchErrorMessageParsingException([0m
[30;1m75 | [0m[35m                f"Could not connect to the batch endpoint for region {get_region()}. Probably Batch [0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/batch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m69 | [0m[35m            self._call_create_compute_environment_with_bad_instance_type()[0m
[30;1m70 | [0m[35m        except ClientError as e:[0m
[30;1m71 | [0m[35m            # This is the expected behavior[0m
[30;1m72 | [0m[35m            return e.response.get("Error").get("Message")[0m
[30;1m73 | [0m[35m        except EndpointConnectionError:[0m
[30;1m74 | [0m[35m            raise BatchErrorMessageParsingException([0m
[30;1m75 | [0m[35m                f"Could not connect to the batch endpoint for region {get_region()}. Probably Batch [0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/batch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m            self._client.describe_compute_environments(computeEnvironments=[ce_name])[0m
[30;1m57 | [0m[35m            .get("computeEnvironments")[0][0m
[30;1m58 | [0m[35m            .get("computeResources")[0m
[30;1m59 | [0m[35m            .get("desiredvCpus")[0m
[30;1m60 | [0m[35m        )[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    def _get_cce_emsg_containing_supported_instance_types(self):[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/batch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m        return ([0m
[30;1m56 | [0m[35m            self._client.describe_compute_environments(computeEnvironments=[ce_name])[0m
[30;1m57 | [0m[35m            .get("computeEnvironments")[0][0m
[30;1m58 | [0m[35m            .get("computeResources")[0m
[30;1m59 | [0m[35m            .get("desiredvCpus")[0m
[30;1m60 | [0m[35m        )[0m
[30;1m61 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/batch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m        """Describe compute environment and return ."""[0m
[30;1m55 | [0m[35m        return ([0m
[30;1m56 | [0m[35m            self._client.describe_compute_environments(computeEnvironments=[ce_name])[0m
[30;1m57 | [0m[35m            .get("computeEnvironments")[0][0m
[30;1m58 | [0m[35m            .get("computeResources")[0m
[30;1m59 | [0m[35m            .get("desiredvCpus")[0m
[30;1m60 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/batch.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/lib/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2023 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/encoder.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/secretsmanager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2022 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/imagebuilder_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35mdef search_tag(resource_info, tag_key):[0m
[30;1m39 | [0m[35m    """Search tag in tag list by given tag key."""[0m
[30;1m40 | [0m[35m    return next([0m
[30;1m41 | [0m[35m        (tag["Value"] for tag in resource_info.get("Tags", []) if tag["Key"] == tag_key),[0m
[30;1m42 | [0m[35m        None,[0m
[30;1m43 | [0m[35m    )[0m
[30;1m44 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/imagebuilder_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/imagebuilder_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35mdef wrap_script_to_component(url):[0m
[30;1m47 | [0m[35m    """Wrap script to custom component data property."""[0m
[30;1m48 | [0m[35m    scheme = get_url_scheme(url)[0m
[30;1m49 | [0m[35m    current_dir = os.path.dirname(os.path.abspath(__file__))[0m
[30;1m50 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/cleanup_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m177 | [0m[35m        instances = [][0m
[30;1m178 | [0m[35m        for reservation in page.get("Reservations", []):[0m
[30;1m179 | [0m[35m            for instance in reservation.get("Instances", []):[0m
[30;1m180 | [0m[35m                instances.append(instance.get("InstanceId"))[0m
[30;1m181 | [0m[35m        yield instances[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/cleanup_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m176 | [0m[35m    for page in paginator.paginate(Filters=filters, PaginationConfig=pagination_config):[0m
[30;1m177 | [0m[35m        instances = [][0m
[30;1m178 | [0m[35m        for reservation in page.get("Reservations", []):[0m
[30;1m179 | [0m[35m            for instance in reservation.get("Instances", []):[0m
[30;1m180 | [0m[35m                instances.append(instance.get("InstanceId"))[0m
[30;1m181 | [0m[35m        yield instances[0m
[30;1m182 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/cleanup_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m175 | [0m[35m    paginator = ec2.get_paginator("describe_instances")[0m
[30;1m176 | [0m[35m    for page in paginator.paginate(Filters=filters, PaginationConfig=pagination_config):[0m
[30;1m177 | [0m[35m        instances = [][0m
[30;1m178 | [0m[35m        for reservation in page.get("Reservations", []):[0m
[30;1m179 | [0m[35m            for instance in reservation.get("Instances", []):[0m
[30;1m180 | [0m[35m                instances.append(instance.get("InstanceId"))[0m
[30;1m181 | [0m[35m        yield instances[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/cleanup_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m161 | [0m[35m    ][0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    result = ec2.describe_instances(Filters=filters)[0m
[30;1m164 | [0m[35m    return len(result.get("Reservations", [])) > 0[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35mdef _describe_instance_ids_iterator(stack_name, instance_state=("pending", "running", "stopping", "s[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/cleanup_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m        changes = [][0m
[30;1m68 | [0m[35m        logger.info(f"Deleting ResourceRecordSets end with {domain_name}")[0m
[30;1m69 | [0m[35m        for record_set in page.get("ResourceRecordSets", []):[0m
[30;1m70 | [0m[35m            if record_set.get("Type") == "A" and record_set.get("Name").endswith(domain_name):[0m
[30;1m71 | [0m[35m                changes.append({"Action": "DELETE", "ResourceRecordSet": record_set})[0m
[30;1m72 | [0m[35m        yield changes[0m
[30;1m73 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/cleanup_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m        changes = [][0m
[30;1m68 | [0m[35m        logger.info(f"Deleting ResourceRecordSets end with {domain_name}")[0m
[30;1m69 | [0m[35m        for record_set in page.get("ResourceRecordSets", []):[0m
[30;1m70 | [0m[35m            if record_set.get("Type") == "A" and record_set.get("Name").endswith(domain_name):[0m
[30;1m71 | [0m[35m                changes.append({"Action": "DELETE", "ResourceRecordSet": record_set})[0m
[30;1m72 | [0m[35m        yield changes[0m
[30;1m73 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/cleanup_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m    for page in paginator.paginate(HostedZoneId=hosted_zone_id, PaginationConfig=pagination_config):[0m
[30;1m67 | [0m[35m        changes = [][0m
[30;1m68 | [0m[35m        logger.info(f"Deleting ResourceRecordSets end with {domain_name}")[0m
[30;1m69 | [0m[35m        for record_set in page.get("ResourceRecordSets", []):[0m
[30;1m70 | [0m[35m            if record_set.get("Type") == "A" and record_set.get("Name").endswith(domain_name):[0m
[30;1m71 | [0m[35m                changes.append({"Action": "DELETE", "ResourceRecordSet": record_set})[0m
[30;1m72 | [0m[35m        yield changes[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/cleanup_resources.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m144 | [0m[35m            logger.info("Waiting for all nodes terminated...")[0m
[30;1m145 | [0m[35m            time.sleep(10)[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m        # Sleep for 30 more seconds to give PlacementGroups the time to update[0m
[30;1m148 | [0m[35m        time.sleep(30)[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m        logger.info("Compute fleet nodes terminate: COMPLETED")[0m
[30;1m151 | [0m[35m    except Exception as e:[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/cleanup_resources.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m#  the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/cleanup_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m144 | [0m[35m            logger.info("Waiting for all nodes terminated...")[0m
[30;1m145 | [0m[35m            time.sleep(10)[0m
[30;1m146 | [0m[35m[0m
[30;1m147 | [0m[35m        # Sleep for 30 more seconds to give PlacementGroups the time to update[0m
[30;1m148 | [0m[35m        time.sleep(30)[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m        logger.info("Compute fleet nodes terminate: COMPLETED")[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/cleanup_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m135 | [0m[35m            # and instance termination time exceeds 15 minutes simultaneously. Resolve the above pot[0m
[30;1m136 | [0m[35m            if time.time() - start_time > max_exeution_time:[0m
[30;1m137 | [0m[35m                logger.warning([0m
[30;1m138 | [0m[35m                    "Lambda execution time has exceeded 14 minutes, approaching timeout. "[0m
[30;1m139 | [0m[35m                    "Returning from Lambda after a 30-second delay; instances may still be in a shut[0m
[30;1m140 | [0m[35m                    "Note: Instances in shutting-down state are not recoverable and are not billed d[0m
[30;1m141 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/cleanup_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m132 | [0m[35m        while _has_shuttingdown_instances(stack_name):[0m
[30;1m133 | [0m[35m            # This logic prevents Lambda function from timing out if instance termination exceeds 15[0m
[30;1m134 | [0m[35m            # TODO: This approach may cause potential cluster deletion failure when PlacementGroups [0m
[30;1m135 | [0m[35m            # and instance termination time exceeds 15 minutes simultaneously. Resolve the above pot[0m
[30;1m136 | [0m[35m            if time.time() - start_time > max_exeution_time:[0m
[30;1m137 | [0m[35m                logger.warning([0m
[30;1m138 | [0m[35m                    "Lambda execution time has exceeded 14 minutes, approaching timeout. "[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/cleanup_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m109 | [0m[35m    """[0m
[30;1m110 | [0m[35m    try:[0m
[30;1m111 | [0m[35m        start_time = time.time()[0m
[30;1m112 | [0m[35m        max_exeution_time = 14 * 60  # Maximum allowed time for Lambda function execution (14 minute[0m
[30;1m113 | [0m[35m        logger.info("Compute fleet nodes terminate: STARTED")[0m
[30;1m114 | [0m[35m        stack_name = event["ResourceProperties"]["StackName"][0m
[30;1m115 | [0m[35m        ec2 = boto3.client("ec2", config=boto3_config)[0m
[30;1m116 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/cleanup_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m109 | [0m[35m    """[0m
[30;1m110 | [0m[35m    try:[0m
[30;1m111 | [0m[35m        start_time = time.time()[0m
[30;1m112 | [0m[35m        max_exeution_time = 14 * 60  # Maximum allowed time for Lambda function execution (14 minute[0m
[30;1m113 | [0m[35m        logger.info("Compute fleet nodes terminate: STARTED")[0m
[30;1m114 | [0m[35m        stack_name = event["ResourceProperties"]["StackName"][0m
[30;1m115 | [0m[35m        ec2 = boto3.client("ec2", config=boto3_config)[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/cleanup_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m10 | [0m[35m# limitations under the License.[0m
[30;1m11 | [0m[35mimport logging[0m
[30;1m12 | [0m[35mimport time[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mimport boto3[0m
[30;1m15 | [0m[35mfrom botocore.config import Config[0m
[30;1m16 | [0m[35mfrom crhelper import CfnResource[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/entrypoint.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m            logger.info("Initializing Flask Application")[0m
[30;1m49 | [0m[35m            pcluster_api = _init_flask_app()[0m
[30;1m50 | [0m[35m            # Instrument X-Ray recorder to trace requests served by the Flask application[0m
[30;1m51 | [0m[35m            if event.get("version") == "2.0":[0m
[30;1m52 | [0m[35m                xray_recorder.configure(service="ParallelCluster Flask App")[0m
[30;1m53 | [0m[35m                XRayMiddleware(pcluster_api.flask_app, xray_recorder)[0m
[30;1m54 | [0m[35m        # Setting default region to region where lambda function is executed[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/entrypoint.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m# Initialize as a global to re-use across Lambda invocations[0m
[30;1m26 | [0m[35mpcluster_api = None  # pylint: disable=invalid-name[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35mprofile = environ.get("PROFILE", "prod")[0m
[30;1m29 | [0m[35mis_dev_profile = profile == "dev"[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35mif is_dev_profile:[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/entrypoint.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m56 | [0m[35m        return handle_request(pcluster_api.app, event, context)[0m
[30;1m57 | [0m[35m    except Exception as e:[0m
[30;1m58 | [0m[35m        logger.critical("Unexpected exception: %s", e, exc_info=True)[0m
[30;1m59 | [0m[35m        raise Exception("Unexpected fatal exception. Please look at API logs for details on the enco[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/entrypoint.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m189 | [0m[35m    def get_unhealthy_nodes(self, pool_name=None):[0m
[30;1m190 | [0m[35m        """Return the total number of unhealthy login nodes in the cluster or a specific pool."""[0m
[30;1m191 | [0m[35m        unhealthy_nodes = ([0m
[30;1m192 | [0m[35m            self._pool_status_dict.get(pool_name).get_unhealthy_nodes() if pool_name else self._tota[0m
[30;1m193 | [0m[35m        )[0m
[30;1m194 | [0m[35m        return unhealthy_nodes[0m
[30;1m195 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m182 | [0m[35m    def get_healthy_nodes(self, pool_name=None):[0m
[30;1m183 | [0m[35m        """Return the total number of healthy login nodes in the cluster or a specific pool."""[0m
[30;1m184 | [0m[35m        healthy_nodes = ([0m
[30;1m185 | [0m[35m            self._pool_status_dict.get(pool_name).get_healthy_nodes() if pool_name else self._total_[0m
[30;1m186 | [0m[35m        )[0m
[30;1m187 | [0m[35m        return healthy_nodes[0m
[30;1m188 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m                healthy_target = [[0m
[30;1m144 | [0m[35m                    target_health.get("Target").get("Id")[0m
[30;1m145 | [0m[35m                    for target_health in target_group_healths[0m
[30;1m146 | [0m[35m                    if target_health.get("TargetHealth").get("State") == "healthy"[0m
[30;1m147 | [0m[35m                ][0m
[30;1m148 | [0m[35m                self._healthy_nodes = len(healthy_target)[0m
[30;1m149 | [0m[35m                self._unhealthy_nodes = len(target_group_healths) - len(healthy_target)[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m                healthy_target = [[0m
[30;1m144 | [0m[35m                    target_health.get("Target").get("Id")[0m
[30;1m145 | [0m[35m                    for target_health in target_group_healths[0m
[30;1m146 | [0m[35m                    if target_health.get("TargetHealth").get("State") == "healthy"[0m
[30;1m147 | [0m[35m                ][0m
[30;1m148 | [0m[35m                self._healthy_nodes = len(healthy_target)[0m
[30;1m149 | [0m[35m                self._unhealthy_nodes = len(target_group_healths) - len(healthy_target)[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m            try:[0m
[30;1m142 | [0m[35m                target_group_healths = AWSApi.instance().elb.describe_target_health(self._target_gro[0m
[30;1m143 | [0m[35m                healthy_target = [[0m
[30;1m144 | [0m[35m                    target_health.get("Target").get("Id")[0m
[30;1m145 | [0m[35m                    for target_health in target_group_healths[0m
[30;1m146 | [0m[35m                    if target_health.get("TargetHealth").get("State") == "healthy"[0m
[30;1m147 | [0m[35m                ][0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m            try:[0m
[30;1m142 | [0m[35m                target_group_healths = AWSApi.instance().elb.describe_target_health(self._target_gro[0m
[30;1m143 | [0m[35m                healthy_target = [[0m
[30;1m144 | [0m[35m                    target_health.get("Target").get("Id")[0m
[30;1m145 | [0m[35m                    for target_health in target_group_healths[0m
[30;1m146 | [0m[35m                    if target_health.get("TargetHealth").get("State") == "healthy"[0m
[30;1m147 | [0m[35m                ][0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m            try:[0m
[30;1m129 | [0m[35m                target_groups = AWSApi.instance().elb.describe_target_groups(self._load_balancer_arn[0m
[30;1m130 | [0m[35m                if target_groups:[0m
[30;1m131 | [0m[35m                    self._target_group_arn = target_groups[0].get("TargetGroupArn")[0m
[30;1m132 | [0m[35m            except Exception as e:[0m
[30;1m133 | [0m[35m                LOGGER.warning([0m
[30;1m134 | [0m[35m                    "Failed when retrieving target_groups with error %s. "[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m103 | [0m[35m                break[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    def _key_value_tag_found(self, tags, key, value):[0m
[30;1m106 | [0m[35m        if any(key == kv.get("Key") and kv.get("Value") == value for kv in tags.get("Tags")):[0m
[30;1m107 | [0m[35m            return True[0m
[30;1m108 | [0m[35m        return False[0m
[30;1m109 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m103 | [0m[35m                break[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    def _key_value_tag_found(self, tags, key, value):[0m
[30;1m106 | [0m[35m        if any(key == kv.get("Key") and kv.get("Value") == value for kv in tags.get("Tags")):[0m
[30;1m107 | [0m[35m            return True[0m
[30;1m108 | [0m[35m        return False[0m
[30;1m109 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m103 | [0m[35m                break[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    def _key_value_tag_found(self, tags, key, value):[0m
[30;1m106 | [0m[35m        if any(key == kv.get("Key") and kv.get("Value") == value for kv in tags.get("Tags")):[0m
[30;1m107 | [0m[35m            return True[0m
[30;1m108 | [0m[35m        return False[0m
[30;1m109 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m            if self._key_value_tag_found([0m
[30;1m100 | [0m[35m                tags, "parallelcluster:cluster-name", self._stack_name[0m
[30;1m101 | [0m[35m            ) and self._key_value_tag_found(tags, "parallelcluster:login-nodes-pool", self._pool_nam[0m
[30;1m102 | [0m[35m                self._load_balancer_arn = tags.get("ResourceArn")[0m
[30;1m103 | [0m[35m                break[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m    def _key_value_tag_found(self, tags, key, value):[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m                if load_balancer.get("LoadBalancerArn") == self._load_balancer_arn:[0m
[30;1m92 | [0m[35m                    self._map_status(load_balancer.get("State").get("Code"))[0m
[30;1m93 | [0m[35m                    self._dns_name = load_balancer.get("DNSName")[0m
[30;1m94 | [0m[35m                    self._scheme = load_balancer.get("Scheme")[0m
[30;1m95 | [0m[35m                    break[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m    def _load_balancer_arn_from_tags(self, tags_list):[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m            for load_balancer in load_balancers:[0m
[30;1m91 | [0m[35m                if load_balancer.get("LoadBalancerArn") == self._load_balancer_arn:[0m
[30;1m92 | [0m[35m                    self._map_status(load_balancer.get("State").get("Code"))[0m
[30;1m93 | [0m[35m                    self._dns_name = load_balancer.get("DNSName")[0m
[30;1m94 | [0m[35m                    self._scheme = load_balancer.get("Scheme")[0m
[30;1m95 | [0m[35m                    break[0m
[30;1m96 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35m        if self._load_balancer_arn:[0m
[30;1m90 | [0m[35m            for load_balancer in load_balancers:[0m
[30;1m91 | [0m[35m                if load_balancer.get("LoadBalancerArn") == self._load_balancer_arn:[0m
[30;1m92 | [0m[35m                    self._map_status(load_balancer.get("State").get("Code"))[0m
[30;1m93 | [0m[35m                    self._dns_name = load_balancer.get("DNSName")[0m
[30;1m94 | [0m[35m                    self._scheme = load_balancer.get("Scheme")[0m
[30;1m95 | [0m[35m                    break[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35m        if self._load_balancer_arn:[0m
[30;1m90 | [0m[35m            for load_balancer in load_balancers:[0m
[30;1m91 | [0m[35m                if load_balancer.get("LoadBalancerArn") == self._load_balancer_arn:[0m
[30;1m92 | [0m[35m                    self._map_status(load_balancer.get("State").get("Code"))[0m
[30;1m93 | [0m[35m                    self._dns_name = load_balancer.get("DNSName")[0m
[30;1m94 | [0m[35m                    self._scheme = load_balancer.get("Scheme")[0m
[30;1m95 | [0m[35m                    break[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m        self._load_balancer_arn_from_tags(tags_list)[0m
[30;1m89 | [0m[35m        if self._load_balancer_arn:[0m
[30;1m90 | [0m[35m            for load_balancer in load_balancers:[0m
[30;1m91 | [0m[35m                if load_balancer.get("LoadBalancerArn") == self._load_balancer_arn:[0m
[30;1m92 | [0m[35m                    self._map_status(load_balancer.get("State").get("Code"))[0m
[30;1m93 | [0m[35m                    self._dns_name = load_balancer.get("DNSName")[0m
[30;1m94 | [0m[35m                    self._scheme = load_balancer.get("Scheme")[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    def _retrieve_assigned_load_balancer(self):[0m
[30;1m86 | [0m[35m        load_balancers = AWSApi.instance().elb.list_load_balancers()[0m
[30;1m87 | [0m[35m        tags_list = self._retrieve_all_tags([o.get("LoadBalancerArn") for o in load_balancers])[0m
[30;1m88 | [0m[35m        self._load_balancer_arn_from_tags(tags_list)[0m
[30;1m89 | [0m[35m        if self._load_balancer_arn:[0m
[30;1m90 | [0m[35m            for load_balancer in load_balancers:[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m194 | [0m[35m        return unhealthy_nodes[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m    def retrieve_data(self, login_node_pool_names):[0m
[30;1m197 | [0m[35m        """Initialize the class with the information related to the login node fleet."""[0m
[30;1m198 | [0m[35m        for pool_name in login_node_pool_names:[0m
[30;1m199 | [0m[35m            self._pool_status_dict[pool_name] = PoolStatus(self._stack_name, pool_name)[0m
[30;1m200 | [0m[35m        self._total_healthy_nodes = sum([0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m176 | [0m[35m        return self._login_nodes_pool_available[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m    def get_pool_status_dict(self):[0m
[30;1m179 | [0m[35m        """Return a dictionary mapping each login node pool name to respective pool status."""[0m
[30;1m180 | [0m[35m        return self._pool_status_dict[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m    def get_healthy_nodes(self, pool_name=None):[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35m        return self._dns_name[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    def get_scheme(self):[0m
[30;1m74 | [0m[35m        """Return the schema of the login node pool."""[0m
[30;1m75 | [0m[35m        return self._scheme[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    def _retrieve_data(self):[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m        return self._status[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    def get_address(self):[0m
[30;1m70 | [0m[35m        """Return the connection addresses of the login node pool."""[0m
[30;1m71 | [0m[35m        return self._dns_name[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    def get_scheme(self):[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m63 | [0m[35m        return self._pool_available[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m    def get_status(self):[0m
[30;1m66 | [0m[35m        """Return the status of the login node pool."""[0m
[30;1m67 | [0m[35m        return self._status[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    def get_address(self):[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m        return self._healthy_nodes[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    def get_unhealthy_nodes(self):[0m
[30;1m58 | [0m[35m        """Return the number of unhealthy nodes of the login node pool."""[0m
[30;1m59 | [0m[35m        return self._unhealthy_nodes[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m    def get_pool_available(self):[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/login_nodes_status.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m        )[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    def get_healthy_nodes(self):[0m
[30;1m54 | [0m[35m        """Return the number of healthy nodes of the login node pool."""[0m
[30;1m55 | [0m[35m        return self._healthy_nodes[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m    def get_unhealthy_nodes(self):[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/fsx_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/send_build_notification.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m            # [B309:blacklist] Use of HTTPSConnection on older versions of Python prior to 2.7.9 and[0m
[30;1m44 | [0m[35m            # do not provide security, see https://wiki.openstack.org/wiki/OSSN/OSSN-0033[0m
[30;1m45 | [0m[35m            connection = HTTPSConnection(host)  # nosec B309 nosemgrep[0m
[30;1m46 | [0m[35m            connection.request([0m
[30;1m47 | [0m[35m                method="PUT", url=url, body=data, headers={"Content-Type": "", "content-length": str[0m
[30;1m48 | [0m[35m            )[0m
[30;1m49 | [0m[35m            response = connection.getresponse()[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/send_build_notification.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m    """Handle CodeBuild build status changes and send notifications to CFN WaitCondition."""[0m
[30;1m19 | [0m[35m    print("CodeBuild event: %s" % json.dumps(event))[0m
[30;1m20 | [0m[35m    environment_variables = event["detail"]["additional-information"]["environment"]["environment-va[0m
[30;1m21 | [0m[35m    notification_url = next(var.get("value") for var in environment_variables if var.get("name") == [0m
[30;1m22 | [0m[35m    succeeded = event["detail"]["build-status"] == "SUCCEEDED"[0m
[30;1m23 | [0m[35m    data = json.dumps([0m
[30;1m24 | [0m[35m        {[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/send_build_notification.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m    """Handle CodeBuild build status changes and send notifications to CFN WaitCondition."""[0m
[30;1m19 | [0m[35m    print("CodeBuild event: %s" % json.dumps(event))[0m
[30;1m20 | [0m[35m    environment_variables = event["detail"]["additional-information"]["environment"]["environment-va[0m
[30;1m21 | [0m[35m    notification_url = next(var.get("value") for var in environment_variables if var.get("name") == [0m
[30;1m22 | [0m[35m    succeeded = event["detail"]["build-status"] == "SUCCEEDED"[0m
[30;1m23 | [0m[35m    data = json.dumps([0m
[30;1m24 | [0m[35m        {[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/send_build_notification.py[0m
   Pattern: [32m.hostname[0m
[30;1m34 | [0m[35m    # This function returns a 5-tuple: (addressing scheme, network location, path, query, fragment i[0m
[30;1m35 | [0m[35m    split_url = urlsplit(notification_url)[0m
[30;1m36 | [0m[35m    host = split_url.netloc[0m
[30;1m37 | [0m[35m    # Building the url without scheme and hostname[0m
[30;1m38 | [0m[35m    url = urlunsplit(("", "", *split_url[2:]))[0m
[30;1m39 | [0m[35m    while True:[0m
[30;1m40 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/send_build_notification.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m#  the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/send_build_notification.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m10 | [0m[35m# limitations under the License.[0m
[30;1m11 | [0m[35mimport json[0m
[30;1m12 | [0m[35mimport time[0m
[30;1m13 | [0m[35mfrom http.client import HTTPSConnection[0m
[30;1m14 | [0m[35mfrom urllib.parse import urlsplit, urlunsplit[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_logs_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m123 | [0m[35m        return StackEvent.from_dict(event)[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m    events = [convert_event(event) for event in stack_events["StackEvents"]][0m
[30;1m126 | [0m[35m    return GetImageStackEventsResponseContent(next_token=stack_events.get("NextToken", None), events[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m@configure_aws_region()[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_logs_controller.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_logs_controller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m62 | [0m[35m                       than this time are included.[0m
[30;1m63 | [0m[35m    :type start_time: str[0m
[30;1m64 | [0m[35m    :param end_time: The end of the time range, expressed in ISO 8601 format (e.g. &#39;2021-01-01T2[0m
[30;1m65 | [0m[35m                     Events with a timestamp equal to or later than this time are not included.[0m
[30;1m66 | [0m[35m    :type end_time: str[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m    :rtype: GetImageLogEventsResponseContent[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_logs_controller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35m                       (e.g. &#39;2021-01-01T20:00:00Z&#39;). Events with a timestamp equal to this [0m
[30;1m62 | [0m[35m                       than this time are included.[0m
[30;1m63 | [0m[35m    :type start_time: str[0m
[30;1m64 | [0m[35m    :param end_time: The end of the time range, expressed in ISO 8601 format (e.g. &#39;2021-01-01T2[0m
[30;1m65 | [0m[35m                     Events with a timestamp equal to or later than this time are not included.[0m
[30;1m66 | [0m[35m    :type end_time: str[0m
[30;1m67 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_logs_controller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m    :type limit:[0m
[30;1m60 | [0m[35m    :param start_time: The start of the time range, expressed in ISO 8601 format[0m
[30;1m61 | [0m[35m                       (e.g. &#39;2021-01-01T20:00:00Z&#39;). Events with a timestamp equal to this [0m
[30;1m62 | [0m[35m                       than this time are included.[0m
[30;1m63 | [0m[35m    :type start_time: str[0m
[30;1m64 | [0m[35m    :param end_time: The end of the time range, expressed in ISO 8601 format (e.g. &#39;2021-01-01T2[0m
[30;1m65 | [0m[35m                     Events with a timestamp equal to or later than this time are not included.[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_logs_controller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m58 | [0m[35m                  log events as can fit in a response size of 1 MB, up to 10,000 log events.[0m
[30;1m59 | [0m[35m    :type limit:[0m
[30;1m60 | [0m[35m    :param start_time: The start of the time range, expressed in ISO 8601 format[0m
[30;1m61 | [0m[35m                       (e.g. &#39;2021-01-01T20:00:00Z&#39;). Events with a timestamp equal to this [0m
[30;1m62 | [0m[35m                       than this time are included.[0m
[30;1m63 | [0m[35m    :type start_time: str[0m
[30;1m64 | [0m[35m    :param end_time: The end of the time range, expressed in ISO 8601 format (e.g. &#39;2021-01-01T2[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_logs_controller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m    :param limit: The maximum number of log events returned. If you don&#39;t specify a value, the m[0m
[30;1m58 | [0m[35m                  log events as can fit in a response size of 1 MB, up to 10,000 log events.[0m
[30;1m59 | [0m[35m    :type limit:[0m
[30;1m60 | [0m[35m    :param start_time: The start of the time range, expressed in ISO 8601 format[0m
[30;1m61 | [0m[35m                       (e.g. &#39;2021-01-01T20:00:00Z&#39;). Events with a timestamp equal to this [0m
[30;1m62 | [0m[35m                       than this time are included.[0m
[30;1m63 | [0m[35m    :type start_time: str[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m321 | [0m[35m[0m
[30;1m322 | [0m[35mdef get_cli_log_file():[0m
[30;1m323 | [0m[35m    default_log_file = os.path.expanduser(os.path.join("~", ".parallelcluster", "pcluster-cli.log"))[0m
[30;1m324 | [0m[35m    return os.environ.get("PCLUSTER_LOG_FILE", default=default_log_file)[0m
[30;1m325 | [0m[35m[0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35mdef ellipsize(text, max_length):[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m282 | [0m[35m    while status in waiting_states:[0m
[30;1m283 | [0m[35m        status = AWSApi.instance().cfn.describe_stack(stack_name).get("StackStatus")[0m
[30;1m284 | [0m[35m        events = AWSApi.instance().cfn.get_stack_events(stack_name)["StackEvents"][0][0m
[30;1m285 | [0m[35m        resource_status = ("Status: %s - %s" % (events.get("LogicalResourceId"), events.get("Resourc[0m
[30;1m286 | [0m[35m            80[0m
[30;1m287 | [0m[35m        )[0m
[30;1m288 | [0m[35m        sys.stdout.write("\r%s" % resource_status)[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m282 | [0m[35m    while status in waiting_states:[0m
[30;1m283 | [0m[35m        status = AWSApi.instance().cfn.describe_stack(stack_name).get("StackStatus")[0m
[30;1m284 | [0m[35m        events = AWSApi.instance().cfn.get_stack_events(stack_name)["StackEvents"][0][0m
[30;1m285 | [0m[35m        resource_status = ("Status: %s - %s" % (events.get("LogicalResourceId"), events.get("Resourc[0m
[30;1m286 | [0m[35m            80[0m
[30;1m287 | [0m[35m        )[0m
[30;1m288 | [0m[35m        sys.stdout.write("\r%s" % resource_status)[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m283 | [0m[35m    status = AWSApi.instance().cfn.describe_stack(stack_name).get("StackStatus")[0m
[30;1m284 | [0m[35m    resource_status = ""[0m
[30;1m285 | [0m[35m    while status in waiting_states:[0m
[30;1m286 | [0m[35m        status = AWSApi.instance().cfn.describe_stack(stack_name).get("StackStatus")[0m
[30;1m287 | [0m[35m        events = AWSApi.instance().cfn.get_stack_events(stack_name)["StackEvents"][0][0m
[30;1m288 | [0m[35m        resource_status = ("Status: %s - %s" % (events.get("LogicalResourceId"), events.get("Resourc[0m
[30;1m289 | [0m[35m            80[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m277 | [0m[35m    """[0m
[30;1m278 | [0m[35m    from pcluster.aws.aws_api import AWSApi  # pylint: disable=import-outside-toplevel[0m
[30;1m279 | [0m[35m[0m
[30;1m280 | [0m[35m    status = AWSApi.instance().cfn.describe_stack(stack_name).get("StackStatus")[0m
[30;1m281 | [0m[35m    resource_status = ""[0m
[30;1m282 | [0m[35m    while status in waiting_states:[0m
[30;1m283 | [0m[35m        status = AWSApi.instance().cfn.describe_stack(stack_name).get("StackStatus")[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m263 | [0m[35m    :param output_key: Output Key[0m
[30;1m264 | [0m[35m    :return: OutputValue if that output exists, otherwise None[0m
[30;1m265 | [0m[35m    """[0m
[30;1m266 | [0m[35m    return next((o.get("OutputValue") for o in stack_outputs if o.get("OutputKey") == output_key), N[0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35mdef verify_stack_status(stack_name, waiting_states, successful_states):[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m263 | [0m[35m    :param output_key: Output Key[0m
[30;1m264 | [0m[35m    :return: OutputValue if that output exists, otherwise None[0m
[30;1m265 | [0m[35m    """[0m
[30;1m266 | [0m[35m    return next((o.get("OutputValue") for o in stack_outputs if o.get("OutputKey") == output_key), N[0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35mdef verify_stack_status(stack_name, waiting_states, successful_states):[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m182 | [0m[35m    If region is None, consider the region set in the environment.[0m
[30;1m183 | [0m[35m    """[0m
[30;1m184 | [0m[35m    _region = get_region() if region is None else region[0m
[30;1m185 | [0m[35m    prefixes_of_unsupported_regions = UNSUPPORTED_FEATURES_MAP.get(feature, [])[0m
[30;1m186 | [0m[35m    return all(not _region.startswith(region_prefix) for region_prefix in prefixes_of_unsupported_re[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m172 | [0m[35m[0m
[30;1m173 | [0m[35mdef get_supported_os_for_architecture(architecture):[0m
[30;1m174 | [0m[35m    """Return list of supported OSes for the specified architecture."""[0m
[30;1m175 | [0m[35m    return SUPPORTED_OSES_FOR_ARCHITECTURE.get(architecture, [])[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35mdef is_feature_supported(feature: Feature, region: str = None):[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m167 | [0m[35m    :param scheduler: the scheduler for which we want to know the supported os[0m
[30;1m168 | [0m[35m    :return: an array of strings of the supported OSes[0m
[30;1m169 | [0m[35m    """[0m
[30;1m170 | [0m[35m    return SUPPORTED_OSES_FOR_SCHEDULER.get(scheduler, [])[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m[0m
[30;1m173 | [0m[35mdef get_supported_os_for_architecture(architecture):[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35mdef get_docs_base_url(partition: str = None):[0m
[30;1m89 | [0m[35m    """Get the docs url for the given partition. If partition is None, consider the partition set in[0m
[30;1m90 | [0m[35m    _partition = get_partition() if partition is None else partition[0m
[30;1m91 | [0m[35m    return DOCS_URL_MAP.get(_partition, DEFAULT_DOCS_URL)[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35mdef get_service_endpoint(service: str, region: str):[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m82 | [0m[35mdef get_url_domain_suffix(partition: str = None):[0m
[30;1m83 | [0m[35m    """Get domain for the given partition. If partition is None, consider the partition set in the e[0m
[30;1m84 | [0m[35m    _partition = get_partition() if partition is None else partition[0m
[30;1m85 | [0m[35m    return DOMAIN_MAP.get(_partition, DEFAULT_DOMAIN)[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35mdef get_docs_base_url(partition: str = None):[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m582 | [0m[35m[0m
[30;1m583 | [0m[35m[0m
[30;1m584 | [0m[35mdef get_service_principal(service_name: str, partition: str, region: str = None, regional: bool = Fa[0m
[30;1m585 | [0m[35m    """Generate the service principal for a given service."""[0m
[30;1m586 | [0m[35m    domain_suffix = get_url_domain_suffix(partition)[0m
[30;1m587 | [0m[35m    if regional:[0m
[30;1m588 | [0m[35m        if not region:[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m522 | [0m[35m        """[0m
[30;1m523 | [0m[35m        Decorate a function to cache the result of a call for a given time period.[0m
[30;1m524 | [0m[35m[0m
[30;1m525 | [0m[35m        :param timeout: Timeout in seconds.[0m
[30;1m526 | [0m[35m        :return:[0m
[30;1m527 | [0m[35m        """[0m
[30;1m528 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m520 | [0m[35m    @staticmethod[0m
[30;1m521 | [0m[35m    def async_timeout_cache(timeout=10):[0m
[30;1m522 | [0m[35m        """[0m
[30;1m523 | [0m[35m        Decorate a function to cache the result of a call for a given time period.[0m
[30;1m524 | [0m[35m[0m
[30;1m525 | [0m[35m        :param timeout: Timeout in seconds.[0m
[30;1m526 | [0m[35m        :return:[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m489 | [0m[35m        Decorate an async coroutine function to retry its execution when an exception is risen.[0m
[30;1m490 | [0m[35m[0m
[30;1m491 | [0m[35m        :param stop_max_attempt_number: Max number of retries.[0m
[30;1m492 | [0m[35m        :param wait_fixed: Wait time (in seconds) between retries.[0m
[30;1m493 | [0m[35m        :param retry_on_exception: Exception to retry on.[0m
[30;1m494 | [0m[35m        :return:[0m
[30;1m495 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m217 | [0m[35m    Convert a given datetime ISO 8601 format with milliseconds.[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m    :param time_in: datetime to be converted[0m
[30;1m220 | [0m[35m    :return: time in ISO 8601 UTC format with ms (e.g. 2021-07-15T01:22:02.655Z)[0m
[30;1m221 | [0m[35m    """[0m
[30;1m222 | [0m[35m    if time_in.tzinfo is None:[0m
[30;1m223 | [0m[35m        time_ = time_in.replace(tzinfo=datetime.timezone.utc)[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m194 | [0m[35m    be timestamps in UTC timezone.[0m
[30;1m195 | [0m[35m    :param default_timezone: Timezone to assum in the event that the time is[0m
[30;1m196 | [0m[35m    unspecified in the input parameter. This applies only for datetime and str inputs[0m
[30;1m197 | [0m[35m    :return: time as a datetime in UTC timezone[0m
[30;1m198 | [0m[35m    """[0m
[30;1m199 | [0m[35m    if isinstance(time_in, int):[0m
[30;1m200 | [0m[35m        if time_in > 1e12:[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m    :param time_in: Time in a format that may be parsed, integers are assumed to[0m
[30;1m194 | [0m[35m    be timestamps in UTC timezone.[0m
[30;1m195 | [0m[35m    :param default_timezone: Timezone to assum in the event that the time is[0m
[30;1m196 | [0m[35m    unspecified in the input parameter. This applies only for datetime and str inputs[0m
[30;1m197 | [0m[35m    :return: time as a datetime in UTC timezone[0m
[30;1m198 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m190 | [0m[35m    """[0m
[30;1m191 | [0m[35m    Convert a given string, datetime or int into utc datetime.[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m    :param time_in: Time in a format that may be parsed, integers are assumed to[0m
[30;1m194 | [0m[35m    be timestamps in UTC timezone.[0m
[30;1m195 | [0m[35m    :param default_timezone: Timezone to assum in the event that the time is[0m
[30;1m196 | [0m[35m    unspecified in the input parameter. This applies only for datetime and str inputs[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35mimport re[0m
[30;1m20 | [0m[35mimport string[0m
[30;1m21 | [0m[35mimport sys[0m
[30;1m22 | [0m[35mimport time[0m
[30;1m23 | [0m[35mimport urllib[0m
[30;1m24 | [0m[35mimport zipfile[0m
[30;1m25 | [0m[35mfrom concurrent.futures import ThreadPoolExecutor[0m
[30;1m26 | [0m[35mfrom io import BytesIO[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m288 | [0m[35m        sys.stdout.write("\r%s" % resource_status)[0m
[30;1m289 | [0m[35m        sys.stdout.flush()[0m
[30;1m290 | [0m[35m        time.sleep(5)[0m
[30;1m291 | [0m[35m    # print the last status update in the logs[0m
[30;1m292 | [0m[35m    if resource_status != "":[0m
[30;1m293 | [0m[35m        LOGGER.debug(resource_status)[0m
[30;1m294 | [0m[35m    return status in successful_states[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35mdef _add_file_to_zip(zip_file, path, arcname):[0m
[30;1m129 | [0m[35m    """[0m
[30;1m130 | [0m[35m    Add the file at path under the name arcname to the archive represented by zip_file.[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m    :param zip_file: zipfile.ZipFile object[0m
[30;1m133 | [0m[35m    :param path: string; path to file being added[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/logger.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m            "pcluster": {"handlers": ["default"], "level": "INFO", "propagate": False},[0m
[30;1m55 | [0m[35m        },[0m
[30;1m56 | [0m[35m    }[0m
[30;1m57 | [0m[35m    if os.environ.get("PCLUSTER_LOG_TO_STDOUT"):[0m
[30;1m58 | [0m[35m        for logger in logging_config["loggers"].values():[0m
[30;1m59 | [0m[35m            logger["handlers"] = ["console"][0m
[30;1m60 | [0m[35m    os.makedirs(os.path.dirname(logfile), exist_ok=True)[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/logger.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m3 | [0m[35m#[0m
[30;1m4 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not[0m
[30;1m5 | [0m[35m# use this file except in compliance with the License. A copy of the License is[0m
[30;1m6 | [0m[35m# located at[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m9 | [0m[35m#[0m
[30;1m10 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/secret_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m        try:[0m
[30;1m53 | [0m[35m            # Get the actual key value to check if it is a valid Base64[0m
[30;1m54 | [0m[35m            secret_response = AWSApi.instance().secretsmanager.get_secret_value(munge_key_secret_arn[0m
[30;1m55 | [0m[35m            secret_value = secret_response.get("SecretString")[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m            if not secret_value:[0m
[30;1m58 | [0m[35m                self._add_failure([0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/secret_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/secret_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m74 | [0m[35m                    )[0m
[30;1m75 | [0m[35m            except binascii.Error:[0m
[30;1m76 | [0m[35m                self._add_failure([0m
[30;1m77 | [0m[35m                    f"The content of the secret {munge_key_secret_arn} is not a valid Base64 encoded[0m
[30;1m78 | [0m[35m                    f"Please refer to the ParallelCluster official documentation for more informatio[0m
[30;1m79 | [0m[35m                    FailureLevel.ERROR,[0m
[30;1m80 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/secret_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m62 | [0m[35m                return[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m            try:[0m
[30;1m65 | [0m[35m                # Try decoding key value from Base64[0m
[30;1m66 | [0m[35m                decoded_secret = base64.b64decode(secret_value, validate=True)[0m
[30;1m67 | [0m[35m                # Check if the size of the decoding key is within the accepted range[0m
[30;1m68 | [0m[35m                decoded_secret_size_in_bits = len(decoded_secret) * 8[0m
[30;1m69 | [0m[35m                if decoded_secret_size_in_bits < 256 or decoded_secret_size_in_bits > 8192:[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/secret_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    def _validate(self, munge_key_secret_arn: str):[0m
[30;1m52 | [0m[35m        try:[0m
[30;1m53 | [0m[35m            # Get the actual key value to check if it is a valid Base64[0m
[30;1m54 | [0m[35m            secret_response = AWSApi.instance().secretsmanager.get_secret_value(munge_key_secret_arn[0m
[30;1m55 | [0m[35m            secret_value = secret_response.get("SecretString")[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m            if not secret_value:[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/secret_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m      numbers, '+', '/', and possibly trailing '=' padding chars.[0m
[30;1m42 | [0m[35m    - The '=' padding is used if the number of bytes being encoded is not divisible by 3.[0m
[30;1m43 | [0m[35m    Given these rules:[0m
[30;1m44 | [0m[35m    - "validBase64" is valid because its length is a multiple of 4 and uses valid Base64 characters.[0m
[30;1m45 | [0m[35m    - "invalidBase64" is invalid because its length is not a multiple of 4.[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    Also:[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/secret_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m    In Base64 encoding:[0m
[30;1m38 | [0m[35m    - Every 3 bytes of input are represented as 4 characters in the encoded string.[0m
[30;1m39 | [0m[35m    - The length of the encoded string must be a multiple of 4.[0m
[30;1m40 | [0m[35m    - Valid Base64 characters include upper/lowercase letters,[0m
[30;1m41 | [0m[35m      numbers, '+', '/', and possibly trailing '=' padding chars.[0m
[30;1m42 | [0m[35m    - The '=' padding is used if the number of bytes being encoded is not divisible by 3.[0m
[30;1m43 | [0m[35m    Given these rules:[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/secret_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35mclass MungeKeySecretSizeAndBase64Validator(Validator):[0m
[30;1m35 | [0m[35m    """Validate that MungeKeySecretArn exists.[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    In Base64 encoding:[0m
[30;1m38 | [0m[35m    - Every 3 bytes of input are represented as 4 characters in the encoded string.[0m
[30;1m39 | [0m[35m    - The length of the encoded string must be a multiple of 4.[0m
[30;1m40 | [0m[35m    - Valid Base64 characters include upper/lowercase letters,[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/secret_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m9 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m10 | [0m[35m# limitations under the License.[0m
[30;1m11 | [0m[35mimport base64[0m
[30;1m12 | [0m[35mimport binascii[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mfrom pcluster.aws.aws_api import AWSApi[0m
[30;1m15 | [0m[35mfrom pcluster.aws.common import AWSClientError[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m301 | [0m[35m        self.events = log_events_response.get("events", [])[0m
[30;1m302 | [0m[35m        # The next_tokens are not present when the log stream is the Stack Events log stream[0m
[30;1m303 | [0m[35m        self.next_ftoken = log_events_response.get("nextForwardToken", None)[0m
[30;1m304 | [0m[35m        self.next_btoken = log_events_response.get("nextBackwardToken", None)[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m300 | [0m[35m        self.log_stream_name = log_stream_name[0m
[30;1m301 | [0m[35m        self.events = log_events_response.get("events", [])[0m
[30;1m302 | [0m[35m        # The next_tokens are not present when the log stream is the Stack Events log stream[0m
[30;1m303 | [0m[35m        self.next_ftoken = log_events_response.get("nextForwardToken", None)[0m
[30;1m304 | [0m[35m        self.next_btoken = log_events_response.get("nextBackwardToken", None)[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m298 | [0m[35m        """Initialize log events starting from a dict with the form {"events": ..., "nextForwardToke[0m
[30;1m299 | [0m[35m        self.resource_id = resource_id[0m
[30;1m300 | [0m[35m        self.log_stream_name = log_stream_name[0m
[30;1m301 | [0m[35m        self.events = log_events_response.get("events", [])[0m
[30;1m302 | [0m[35m        # The next_tokens are not present when the log stream is the Stack Events log stream[0m
[30;1m303 | [0m[35m        self.next_ftoken = log_events_response.get("nextForwardToken", None)[0m
[30;1m304 | [0m[35m        self.next_btoken = log_events_response.get("nextBackwardToken", None)[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m250 | [0m[35m    stack_events = [][0m
[30;1m251 | [0m[35m    chunk = AWSApi.instance().cfn.get_stack_events(stack_name)[0m
[30;1m252 | [0m[35m    stack_events.append(chunk["StackEvents"])[0m
[30;1m253 | [0m[35m    while chunk.get("nextToken"):[0m
[30;1m254 | [0m[35m        chunk = AWSApi.instance().cfn.get_stack_events(stack_name, next_token=chunk["nextToken"])[0m
[30;1m255 | [0m[35m        stack_events.append(chunk["StackEvents"])[0m
[30;1m256 | [0m[35m    return stack_events[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m        """Get start time filter."""[0m
[30;1m101 | [0m[35m        if not self._start_time:[0m
[30;1m102 | [0m[35m            try:[0m
[30;1m103 | [0m[35m                creation_time = AWSApi.instance().logs.describe_log_group(self._log_group_name).get([0m
[30;1m104 | [0m[35m                self._start_time = to_utc_datetime(creation_time)[0m
[30;1m105 | [0m[35m            except AWSClientError as e:[0m
[30;1m106 | [0m[35m                raise FiltersParserError([0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/common.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m239 | [0m[35m            )[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m            # Create a decompressed copy of the downloaded archive and remove the original[0m
[30;1m242 | [0m[35m            LOGGER.debug("Extracting object at %s to %s", compressed_path, decompressed_path)[0m
[30;1m243 | [0m[35m            with gzip.open(compressed_path) as gfile, open(decompressed_path, "wb") as outfile:[0m
[30;1m244 | [0m[35m                outfile.write(gfile.read())[0m
[30;1m245 | [0m[35m            os.remove(compressed_path)[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/common.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m122 | [0m[35m        if not event_in_window:[0m
[30;1m123 | [0m[35m            raise FiltersParserError([0m
[30;1m124 | [0m[35m                f"No log events in the log group {self._log_group_name} in interval starting "[0m
[30;1m125 | [0m[35m                f"at {self.start_time} and ending at {self.end_time}"[0m
[30;1m126 | [0m[35m                + (f", with log stream name prefix '{log_stream_prefix}'" if log_stream_prefix else [0m
[30;1m127 | [0m[35m            )[0m
[30;1m128 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/common.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m    def validate(self, log_stream_prefix=None):[0m
[30;1m112 | [0m[35m        """Check filter consistency."""[0m
[30;1m113 | [0m[35m        if self.start_time >= self.end_time:[0m
[30;1m114 | [0m[35m            raise FiltersParserError("Start time must be earlier than end time.")[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m        event_in_window = AWSApi.instance().logs.filter_log_events([0m
[30;1m117 | [0m[35m            log_group_name=self._log_group_name,[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m                self._start_time = to_utc_datetime(creation_time)[0m
[30;1m105 | [0m[35m            except AWSClientError as e:[0m
[30;1m106 | [0m[35m                raise FiltersParserError([0m
[30;1m107 | [0m[35m                    f"Unable to retrieve creation time of log group {self._log_group_name}, {str(e)}[0m
[30;1m108 | [0m[35m                )[0m
[30;1m109 | [0m[35m        return self._start_time[0m
[30;1m110 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m    @property[0m
[30;1m99 | [0m[35m    def start_time(self):[0m
[30;1m100 | [0m[35m        """Get start time filter."""[0m
[30;1m101 | [0m[35m        if not self._start_time:[0m
[30;1m102 | [0m[35m            try:[0m
[30;1m103 | [0m[35m                creation_time = AWSApi.instance().logs.describe_log_group(self._log_group_name).get([0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m90 | [0m[35m        if ([0m
[30;1m91 | [0m[35m            start_time and (not isinstance(start_time, datetime.datetime) or start_time.tzinfo != da[0m
[30;1m92 | [0m[35m        ) or (end_time and (not isinstance(end_time, datetime.datetime) or end_time.tzinfo != dateti[0m
[30;1m93 | [0m[35m            raise FiltersParserError("Invalid time filter, must be of type 'datetime' with utc timez[0m
[30;1m94 | [0m[35m        self._start_time = start_time[0m
[30;1m95 | [0m[35m        now_utc = datetime.datetime.now().astimezone(datetime.timezone.utc)[0m
[30;1m96 | [0m[35m        self.end_time = end_time or now_utc[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35mimport os[0m
[30;1m16 | [0m[35mimport os.path[0m
[30;1m17 | [0m[35mimport tarfile[0m
[30;1m18 | [0m[35mimport time[0m
[30;1m19 | [0m[35mfrom typing import List[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mimport configparser[0m
[30;1m22 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m3480 | [0m[35m        status:[0m
[30;1m3481 | [0m[35m          $ref: '#/components/schemas/ComputeFleetStatus'[0m
[30;1m3482 | [0m[35m        lastStatusUpdatedTime:[0m
[30;1m3483 | [0m[35m          description: Timestamp representing the last status update time.[0m
[30;1m3484 | [0m[35m          format: date-time[0m
[30;1m3485 | [0m[35m          title: lastStatusUpdatedTime[0m
[30;1m3486 | [0m[35m          type: string[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m3452 | [0m[35m          title: validationMessages[0m
[30;1m3453 | [0m[35m          type: array[0m
[30;1m3454 | [0m[35m        changeSet:[0m
[30;1m3455 | [0m[35m          description: List of configuration changes requested by the update operation.[0m
[30;1m3456 | [0m[35m          items:[0m
[30;1m3457 | [0m[35m            $ref: '#/components/schemas/Change'[0m
[30;1m3458 | [0m[35m          title: changeSet[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2482 | [0m[35m        status:[0m
[30;1m2483 | [0m[35m          $ref: '#/components/schemas/ComputeFleetStatus'[0m
[30;1m2484 | [0m[35m        lastStatusUpdatedTime:[0m
[30;1m2485 | [0m[35m          description: Timestamp representing the last status update time.[0m
[30;1m2486 | [0m[35m          format: date-time[0m
[30;1m2487 | [0m[35m          title: lastStatusUpdatedTime[0m
[30;1m2488 | [0m[35m          type: string[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2432 | [0m[35m          title: creationTime[0m
[30;1m2433 | [0m[35m          type: string[0m
[30;1m2434 | [0m[35m        lastUpdatedTime:[0m
[30;1m2435 | [0m[35m          description: Timestamp representing the last cluster update time.[0m
[30;1m2436 | [0m[35m          format: date-time[0m
[30;1m2437 | [0m[35m          title: lastUpdatedTime[0m
[30;1m2438 | [0m[35m          type: string[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m560 | [0m[35m        payloadFormatVersion: "2.0"[0m
[30;1m561 | [0m[35m      x-openapi-router-controller: pcluster.api.controllers.cluster_compute_fleet_controller[0m
[30;1m562 | [0m[35m    patch:[0m
[30;1m563 | [0m[35m      description: Update the status of the cluster compute fleet.[0m
[30;1m564 | [0m[35m      operationId: update_compute_fleet[0m
[30;1m565 | [0m[35m      parameters:[0m
[30;1m566 | [0m[35m      - description: Name of the cluster[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m416 | [0m[35m        name: forceUpdate[0m
[30;1m417 | [0m[35m        required: false[0m
[30;1m418 | [0m[35m        schema:[0m
[30;1m419 | [0m[35m          description: Force update by ignoring the update validation errors. (Defaults[0m
[30;1m420 | [0m[35m            to 'false'.)[0m
[30;1m421 | [0m[35m          type: boolean[0m
[30;1m422 | [0m[35m        style: form[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m416 | [0m[35m        name: forceUpdate[0m
[30;1m417 | [0m[35m        required: false[0m
[30;1m418 | [0m[35m        schema:[0m
[30;1m419 | [0m[35m          description: Force update by ignoring the update validation errors. (Defaults[0m
[30;1m420 | [0m[35m            to 'false'.)[0m
[30;1m421 | [0m[35m          type: boolean[0m
[30;1m422 | [0m[35m        style: form[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m409 | [0m[35m            (Defaults to 'false'.)[0m
[30;1m410 | [0m[35m          type: boolean[0m
[30;1m411 | [0m[35m        style: form[0m
[30;1m412 | [0m[35m      - description: Force update by ignoring the update validation errors. (Defaults[0m
[30;1m413 | [0m[35m          to 'false'.)[0m
[30;1m414 | [0m[35m        explode: true[0m
[30;1m415 | [0m[35m        in: query[0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m409 | [0m[35m            (Defaults to 'false'.)[0m
[30;1m410 | [0m[35m          type: boolean[0m
[30;1m411 | [0m[35m        style: form[0m
[30;1m412 | [0m[35m      - description: Force update by ignoring the update validation errors. (Defaults[0m
[30;1m413 | [0m[35m          to 'false'.)[0m
[30;1m414 | [0m[35m        explode: true[0m
[30;1m415 | [0m[35m        in: query[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m405 | [0m[35m        required: false[0m
[30;1m406 | [0m[35m        schema:[0m
[30;1m407 | [0m[35m          description: Only perform request validation without creating any resource.[0m
[30;1m408 | [0m[35m            May be used to validate the cluster configuration and update requirements.[0m
[30;1m409 | [0m[35m            (Defaults to 'false'.)[0m
[30;1m410 | [0m[35m          type: boolean[0m
[30;1m411 | [0m[35m        style: form[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m397 | [0m[35m          type: string[0m
[30;1m398 | [0m[35m        style: form[0m
[30;1m399 | [0m[35m      - description: Only perform request validation without creating any resource.[0m
[30;1m400 | [0m[35m          May be used to validate the cluster configuration and update requirements.[0m
[30;1m401 | [0m[35m          (Defaults to 'false'.)[0m
[30;1m402 | [0m[35m        explode: true[0m
[30;1m403 | [0m[35m        in: query[0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m378 | [0m[35m          type: array[0m
[30;1m379 | [0m[35m          uniqueItems: true[0m
[30;1m380 | [0m[35m        style: form[0m
[30;1m381 | [0m[35m      - description: Min validation level that will cause the update to fail. (Defaults[0m
[30;1m382 | [0m[35m          to 'ERROR'.)[0m
[30;1m383 | [0m[35m        explode: true[0m
[30;1m384 | [0m[35m        in: query[0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m350 | [0m[35m        payloadFormatVersion: "2.0"[0m
[30;1m351 | [0m[35m      x-openapi-router-controller: pcluster.api.controllers.cluster_operations_controller[0m
[30;1m352 | [0m[35m    put:[0m
[30;1m353 | [0m[35m      description: Update a cluster managed in a given region.[0m
[30;1m354 | [0m[35m      operationId: update_cluster[0m
[30;1m355 | [0m[35m      parameters:[0m
[30;1m356 | [0m[35m      - description: Name of the cluster[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3321 | [0m[35m          title: resourceType[0m
[30;1m3322 | [0m[35m          type: string[0m
[30;1m3323 | [0m[35m        timestamp:[0m
[30;1m3324 | [0m[35m          description: Time the status was updated.[0m
[30;1m3325 | [0m[35m          format: date-time[0m
[30;1m3326 | [0m[35m          title: timestamp[0m
[30;1m3327 | [0m[35m          type: string[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3160 | [0m[35m          title: firstEventTimestamp[0m
[30;1m3161 | [0m[35m          type: string[0m
[30;1m3162 | [0m[35m        lastEventTimestamp:[0m
[30;1m3163 | [0m[35m          description: "The time of the last event of the stream. The lastEventTime\[0m
[30;1m3164 | [0m[35m            \ value updates on an eventual consistency basis. It typically updates\[0m
[30;1m3165 | [0m[35m            \ in less than an hour from ingestion, but in rare situations might take\[0m
[30;1m3166 | [0m[35m            \ longer."[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3155 | [0m[35m          title: creationTime[0m
[30;1m3156 | [0m[35m          type: string[0m
[30;1m3157 | [0m[35m        firstEventTimestamp:[0m
[30;1m3158 | [0m[35m          description: The time of the first event of the stream.[0m
[30;1m3159 | [0m[35m          format: date-time[0m
[30;1m3160 | [0m[35m          title: firstEventTimestamp[0m
[30;1m3161 | [0m[35m          type: string[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3150 | [0m[35m          title: logStreamName[0m
[30;1m3151 | [0m[35m          type: string[0m
[30;1m3152 | [0m[35m        creationTime:[0m
[30;1m3153 | [0m[35m          description: The creation time of the stream.[0m
[30;1m3154 | [0m[35m          format: date-time[0m
[30;1m3155 | [0m[35m          title: creationTime[0m
[30;1m3156 | [0m[35m          type: string[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2941 | [0m[35m      title: InstanceState[0m
[30;1m2942 | [0m[35m      type: string[0m
[30;1m2943 | [0m[35m    InternalServiceExceptionResponseContent:[0m
[30;1m2944 | [0m[35m      description: This exception is thrown on an unhandled service error.[0m
[30;1m2945 | [0m[35m      properties:[0m
[30;1m2946 | [0m[35m        message:[0m
[30;1m2947 | [0m[35m          title: message[0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1658 | [0m[35m        schema:[0m
[30;1m1659 | [0m[35m          description: "The end of the time range, expressed in ISO 8601 format (e.g.\[0m
[30;1m1660 | [0m[35m            \ '2021-01-01T20:00:00Z'). Events with a timestamp equal to or later than\[0m
[30;1m1661 | [0m[35m            \ this time are not included."[0m
[30;1m1662 | [0m[35m          format: date-time[0m
[30;1m1663 | [0m[35m          type: string[0m
[30;1m1664 | [0m[35m        style: form[0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1656 | [0m[35m        name: endTime[0m
[30;1m1657 | [0m[35m        required: false[0m
[30;1m1658 | [0m[35m        schema:[0m
[30;1m1659 | [0m[35m          description: "The end of the time range, expressed in ISO 8601 format (e.g.\[0m
[30;1m1660 | [0m[35m            \ '2021-01-01T20:00:00Z'). Events with a timestamp equal to or later than\[0m
[30;1m1661 | [0m[35m            \ this time are not included."[0m
[30;1m1662 | [0m[35m          format: date-time[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1650 | [0m[35m        style: form[0m
[30;1m1651 | [0m[35m      - description: "The end of the time range, expressed in ISO 8601 format (e.g.\[0m
[30;1m1652 | [0m[35m          \ '2021-01-01T20:00:00Z'). Events with a timestamp equal to or later than\[0m
[30;1m1653 | [0m[35m          \ this time are not included."[0m
[30;1m1654 | [0m[35m        explode: true[0m
[30;1m1655 | [0m[35m        in: query[0m
[30;1m1656 | [0m[35m        name: endTime[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1648 | [0m[35m          format: date-time[0m
[30;1m1649 | [0m[35m          type: string[0m
[30;1m1650 | [0m[35m        style: form[0m
[30;1m1651 | [0m[35m      - description: "The end of the time range, expressed in ISO 8601 format (e.g.\[0m
[30;1m1652 | [0m[35m          \ '2021-01-01T20:00:00Z'). Events with a timestamp equal to or later than\[0m
[30;1m1653 | [0m[35m          \ this time are not included."[0m
[30;1m1654 | [0m[35m        explode: true[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1644 | [0m[35m        schema:[0m
[30;1m1645 | [0m[35m          description: "The start of the time range, expressed in ISO 8601 format\[0m
[30;1m1646 | [0m[35m            \ (e.g. '2021-01-01T20:00:00Z'). Events with a timestamp equal to this\[0m
[30;1m1647 | [0m[35m            \ time or later than this time are included."[0m
[30;1m1648 | [0m[35m          format: date-time[0m
[30;1m1649 | [0m[35m          type: string[0m
[30;1m1650 | [0m[35m        style: form[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1644 | [0m[35m        schema:[0m
[30;1m1645 | [0m[35m          description: "The start of the time range, expressed in ISO 8601 format\[0m
[30;1m1646 | [0m[35m            \ (e.g. '2021-01-01T20:00:00Z'). Events with a timestamp equal to this\[0m
[30;1m1647 | [0m[35m            \ time or later than this time are included."[0m
[30;1m1648 | [0m[35m          format: date-time[0m
[30;1m1649 | [0m[35m          type: string[0m
[30;1m1650 | [0m[35m        style: form[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1642 | [0m[35m        name: startTime[0m
[30;1m1643 | [0m[35m        required: false[0m
[30;1m1644 | [0m[35m        schema:[0m
[30;1m1645 | [0m[35m          description: "The start of the time range, expressed in ISO 8601 format\[0m
[30;1m1646 | [0m[35m            \ (e.g. '2021-01-01T20:00:00Z'). Events with a timestamp equal to this\[0m
[30;1m1647 | [0m[35m            \ time or later than this time are included."[0m
[30;1m1648 | [0m[35m          format: date-time[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1636 | [0m[35m        style: form[0m
[30;1m1637 | [0m[35m      - description: "The start of the time range, expressed in ISO 8601 format (e.g.\[0m
[30;1m1638 | [0m[35m          \ '2021-01-01T20:00:00Z'). Events with a timestamp equal to this time or\[0m
[30;1m1639 | [0m[35m          \ later than this time are included."[0m
[30;1m1640 | [0m[35m        explode: true[0m
[30;1m1641 | [0m[35m        in: query[0m
[30;1m1642 | [0m[35m        name: startTime[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1635 | [0m[35m          type: integer[0m
[30;1m1636 | [0m[35m        style: form[0m
[30;1m1637 | [0m[35m      - description: "The start of the time range, expressed in ISO 8601 format (e.g.\[0m
[30;1m1638 | [0m[35m          \ '2021-01-01T20:00:00Z'). Events with a timestamp equal to this time or\[0m
[30;1m1639 | [0m[35m          \ later than this time are included."[0m
[30;1m1640 | [0m[35m        explode: true[0m
[30;1m1641 | [0m[35m        in: query[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1634 | [0m[35m          nullable: true[0m
[30;1m1635 | [0m[35m          type: integer[0m
[30;1m1636 | [0m[35m        style: form[0m
[30;1m1637 | [0m[35m      - description: "The start of the time range, expressed in ISO 8601 format (e.g.\[0m
[30;1m1638 | [0m[35m          \ '2021-01-01T20:00:00Z'). Events with a timestamp equal to this time or\[0m
[30;1m1639 | [0m[35m          \ later than this time are included."[0m
[30;1m1640 | [0m[35m        explode: true[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1003 | [0m[35m        schema:[0m
[30;1m1004 | [0m[35m          description: "The end of the time range, expressed in ISO 8601 format (e.g.\[0m
[30;1m1005 | [0m[35m            \ '2021-01-01T20:00:00Z'). Events with a timestamp equal to or later than\[0m
[30;1m1006 | [0m[35m            \ this time are not included."[0m
[30;1m1007 | [0m[35m          format: date-time[0m
[30;1m1008 | [0m[35m          type: string[0m
[30;1m1009 | [0m[35m        style: form[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1001 | [0m[35m        name: endTime[0m
[30;1m1002 | [0m[35m        required: false[0m
[30;1m1003 | [0m[35m        schema:[0m
[30;1m1004 | [0m[35m          description: "The end of the time range, expressed in ISO 8601 format (e.g.\[0m
[30;1m1005 | [0m[35m            \ '2021-01-01T20:00:00Z'). Events with a timestamp equal to or later than\[0m
[30;1m1006 | [0m[35m            \ this time are not included."[0m
[30;1m1007 | [0m[35m          format: date-time[0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m995 | [0m[35m        style: form[0m
[30;1m996 | [0m[35m      - description: "The end of the time range, expressed in ISO 8601 format (e.g.\[0m
[30;1m997 | [0m[35m          \ '2021-01-01T20:00:00Z'). Events with a timestamp equal to or later than\[0m
[30;1m998 | [0m[35m          \ this time are not included."[0m
[30;1m999 | [0m[35m        explode: true[0m
[30;1m1000 | [0m[35m        in: query[0m
[30;1m1001 | [0m[35m        name: endTime[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m993 | [0m[35m          format: date-time[0m
[30;1m994 | [0m[35m          type: string[0m
[30;1m995 | [0m[35m        style: form[0m
[30;1m996 | [0m[35m      - description: "The end of the time range, expressed in ISO 8601 format (e.g.\[0m
[30;1m997 | [0m[35m          \ '2021-01-01T20:00:00Z'). Events with a timestamp equal to or later than\[0m
[30;1m998 | [0m[35m          \ this time are not included."[0m
[30;1m999 | [0m[35m        explode: true[0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m989 | [0m[35m        schema:[0m
[30;1m990 | [0m[35m          description: "The start of the time range, expressed in ISO 8601 format\[0m
[30;1m991 | [0m[35m            \ (e.g. '2021-01-01T20:00:00Z'). Events with a timestamp equal to this\[0m
[30;1m992 | [0m[35m            \ time or later than this time are included."[0m
[30;1m993 | [0m[35m          format: date-time[0m
[30;1m994 | [0m[35m          type: string[0m
[30;1m995 | [0m[35m        style: form[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m989 | [0m[35m        schema:[0m
[30;1m990 | [0m[35m          description: "The start of the time range, expressed in ISO 8601 format\[0m
[30;1m991 | [0m[35m            \ (e.g. '2021-01-01T20:00:00Z'). Events with a timestamp equal to this\[0m
[30;1m992 | [0m[35m            \ time or later than this time are included."[0m
[30;1m993 | [0m[35m          format: date-time[0m
[30;1m994 | [0m[35m          type: string[0m
[30;1m995 | [0m[35m        style: form[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m987 | [0m[35m        name: startTime[0m
[30;1m988 | [0m[35m        required: false[0m
[30;1m989 | [0m[35m        schema:[0m
[30;1m990 | [0m[35m          description: "The start of the time range, expressed in ISO 8601 format\[0m
[30;1m991 | [0m[35m            \ (e.g. '2021-01-01T20:00:00Z'). Events with a timestamp equal to this\[0m
[30;1m992 | [0m[35m            \ time or later than this time are included."[0m
[30;1m993 | [0m[35m          format: date-time[0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m981 | [0m[35m        style: form[0m
[30;1m982 | [0m[35m      - description: "The start of the time range, expressed in ISO 8601 format (e.g.\[0m
[30;1m983 | [0m[35m          \ '2021-01-01T20:00:00Z'). Events with a timestamp equal to this time or\[0m
[30;1m984 | [0m[35m          \ later than this time are included."[0m
[30;1m985 | [0m[35m        explode: true[0m
[30;1m986 | [0m[35m        in: query[0m
[30;1m987 | [0m[35m        name: startTime[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m980 | [0m[35m          type: integer[0m
[30;1m981 | [0m[35m        style: form[0m
[30;1m982 | [0m[35m      - description: "The start of the time range, expressed in ISO 8601 format (e.g.\[0m
[30;1m983 | [0m[35m          \ '2021-01-01T20:00:00Z'). Events with a timestamp equal to this time or\[0m
[30;1m984 | [0m[35m          \ later than this time are included."[0m
[30;1m985 | [0m[35m        explode: true[0m
[30;1m986 | [0m[35m        in: query[0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m979 | [0m[35m          nullable: true[0m
[30;1m980 | [0m[35m          type: integer[0m
[30;1m981 | [0m[35m        style: form[0m
[30;1m982 | [0m[35m      - description: "The start of the time range, expressed in ISO 8601 format (e.g.\[0m
[30;1m983 | [0m[35m          \ '2021-01-01T20:00:00Z'). Events with a timestamp equal to this time or\[0m
[30;1m984 | [0m[35m          \ later than this time are included."[0m
[30;1m985 | [0m[35m        explode: true[0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m846 | [0m[35m            Filter the log streams. Format: 'Name=a,Values=1 Name=b,Values=2,3'.[0m
[30;1m847 | [0m[35m            Accepted filters are:[0m
[30;1m848 | [0m[35m            private-dns-name - The short form of the private DNS name of the instance (e.g. ip-10-0-[0m
[30;1m849 | [0m[35m            node-type - The node type, the only accepted value for this filter is HeadNode.[0m
[30;1m850 | [0m[35m          items:[0m
[30;1m851 | [0m[35m            type: string[0m
[30;1m852 | [0m[35m          type: array[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m836 | [0m[35m          Filter the log streams. Format: 'Name=a,Values=1 Name=b,Values=2,3'.[0m
[30;1m837 | [0m[35m          Accepted filters are:[0m
[30;1m838 | [0m[35m          private-dns-name - The short form of the private DNS name of the instance (e.g. ip-10-0-0-[0m
[30;1m839 | [0m[35m          node-type - The node type, the only accepted value for this filter is HeadNode.[0m
[30;1m840 | [0m[35m        explode: true[0m
[30;1m841 | [0m[35m        in: query[0m
[30;1m842 | [0m[35m        name: filters[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/openapi/openapi.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m749 | [0m[35m          description: Token to use for paginated requests.[0m
[30;1m750 | [0m[35m          type: string[0m
[30;1m751 | [0m[35m        style: form[0m
[30;1m752 | [0m[35m      - description: Filter the instances by node type.[0m
[30;1m753 | [0m[35m        explode: true[0m
[30;1m754 | [0m[35m        in: query[0m
[30;1m755 | [0m[35m        name: nodeType[0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/elb.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m    def describe_target_health(self, target_group_arn: str):[0m
[30;1m58 | [0m[35m        """Retrieve a list of target health associated to the target group arn provided as parameter[0m
[30;1m59 | [0m[35m        target_group_health = self._client.describe_target_health(TargetGroupArn=target_group_arn)[0m
[30;1m60 | [0m[35m        return target_group_health.get("TargetHealthDescriptions")[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/elb.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m    def describe_target_groups(self, load_balancer_arn: str):[0m
[30;1m52 | [0m[35m        """Retrieve a list of target groups associated to the load balancer arn provided as paramete[0m
[30;1m53 | [0m[35m        target_group = self._client.describe_target_groups(LoadBalancerArn=load_balancer_arn)[0m
[30;1m54 | [0m[35m        return target_group.get("TargetGroups")[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m57 | [0m[35m    def describe_target_health(self, target_group_arn: str):[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/elb.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m        """Retrieve a list of tags associated to the load balancer arns provided as parameter."""[0m
[30;1m46 | [0m[35m        """You can specify up to 20 load balancer arns in a single call."""[0m
[30;1m47 | [0m[35m        tags_response = self._client.describe_tags(ResourceArns=load_balancer_arns)[0m
[30;1m48 | [0m[35m        return tags_response.get("TagDescriptions")[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m51 | [0m[35m    def describe_target_groups(self, load_balancer_arn: str):[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/elb.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m        if next_marker:[0m
[30;1m39 | [0m[35m            describe_load_balancers_kwargs["Marker"] = next_marker[0m
[30;1m40 | [0m[35m        response = self._client.describe_load_balancers(**describe_load_balancers_kwargs)[0m
[30;1m41 | [0m[35m        return response["LoadBalancers"], response.get("NextMarker")[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m44 | [0m[35m    def describe_tags(self, load_balancer_arns: []):[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/elb.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m501 | [0m[35m    def _add_custom_cookbook_policies_to_role(self, role_ref: str, name: str):[0m
[30;1m502 | [0m[35m        bucket_info = parse_bucket_url(self._config.dev_settings.cookbook.chef_cookbook)[0m
[30;1m503 | [0m[35m        bucket_name = bucket_info.get("bucket_name")[0m
[30;1m504 | [0m[35m        object_key = bucket_info.get("object_key")[0m
[30;1m505 | [0m[35m        iam.CfnPolicy([0m
[30;1m506 | [0m[35m            Stack.of(self),[0m
[30;1m507 | [0m[35m            name,[0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m500 | [0m[35m[0m
[30;1m501 | [0m[35m    def _add_custom_cookbook_policies_to_role(self, role_ref: str, name: str):[0m
[30;1m502 | [0m[35m        bucket_info = parse_bucket_url(self._config.dev_settings.cookbook.chef_cookbook)[0m
[30;1m503 | [0m[35m        bucket_name = bucket_info.get("bucket_name")[0m
[30;1m504 | [0m[35m        object_key = bucket_info.get("object_key")[0m
[30;1m505 | [0m[35m        iam.CfnPolicy([0m
[30;1m506 | [0m[35m            Stack.of(self),[0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m.hostname[0m
[30;1m104 | [0m[35m        "dns_domain": scheduler_resources.cluster_hosted_zone.name if scheduler_resources.cluster_ho[0m
[30;1m105 | [0m[35m        "hosted_zone": scheduler_resources.cluster_hosted_zone.ref if scheduler_resources.cluster_ho[0m
[30;1m106 | [0m[35m        "slurm_ddb_table": scheduler_resources.dynamodb_table.ref,[0m
[30;1m107 | [0m[35m        "use_private_hostname": str(config.scheduling.settings.dns.use_ec2_hostnames).lower(),[0m
[30;1m108 | [0m[35m    }[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m872 | [0m[35m        )[0m
[30;1m873 | [0m[35m[0m
[30;1m874 | [0m[35m        # If there are any queues where a custom instance role was specified,[0m
[30;1m875 | [0m[35m        # enable the head node to pass permissions to those roles.[0m
[30;1m876 | [0m[35m        custom_queue_role_arns = {[0m
[30;1m877 | [0m[35m            arn for queue in self._config.scheduling.queues for arn in queue.iam.instance_role_arns[0m
[30;1m878 | [0m[35m        }[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m861 | [0m[35m            )[0m
[30;1m862 | [0m[35m[0m
[30;1m863 | [0m[35m    def _generate_head_node_pass_role_resources(self):[0m
[30;1m864 | [0m[35m        """Return a unique list of ARNs that the head node should be able to use when calling PassRo[0m
[30;1m865 | [0m[35m        resource_iam_path, _ = add_cluster_iam_resource_prefix([0m
[30;1m866 | [0m[35m            self._config.cluster_name, self._config, "", iam_type="AWS::IAM::Role"[0m
[30;1m867 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m585 | [0m[35m[0m
[30;1m586 | [0m[35m[0m
[30;1m587 | [0m[35mclass HeadNodeIamResources(NodeIamResourcesBase):[0m
[30;1m588 | [0m[35m    """Construct defining IAM resources for the head node."""[0m
[30;1m589 | [0m[35m[0m
[30;1m590 | [0m[35m    def __init__([0m
[30;1m591 | [0m[35m        self,[0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m418 | [0m[35m            if isinstance(node, (BaseQueue, HeadNode)) and self._condition_create_s3_access_policies[0m
[30;1m419 | [0m[35m                self._add_s3_access_policies_to_role(node, self.instance_role.ref, f"S3AccessPolicie[0m
[30;1m420 | [0m[35m[0m
[30;1m421 | [0m[35m            # Head node Instance Profile[0m
[30;1m422 | [0m[35m            self.instance_profile = self._add_instance_profile(self.instance_role.ref, f"InstancePro[0m
[30;1m423 | [0m[35m[0m
[30;1m424 | [0m[35m    def _add_instance_profile(self, role_ref: str, name: str):[0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35mdef get_assume_role_policy_document(service: str):[0m
[30;1m209 | [0m[35m    """Return default service assume role policy document."""[0m
[30;1m210 | [0m[35m    return iam.PolicyDocument([0m
[30;1m211 | [0m[35m        statements=[[0m
[30;1m212 | [0m[35m            iam.PolicyStatement([0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35mdef get_directory_service_dna_json_for_head_node(config: BaseClusterConfig) -> dict:[0m
[30;1m112 | [0m[35m    """Return a dict containing directory service settings to be written to dna.json of head node.""[0m
[30;1m113 | [0m[35m    directory_service = config.directory_service[0m
[30;1m114 | [0m[35m    return ([0m
[30;1m115 | [0m[35m        {[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35mdef get_directory_service_dna_json_for_head_node(config: BaseClusterConfig) -> dict:[0m
[30;1m112 | [0m[35m    """Return a dict containing directory service settings to be written to dna.json of head node.""[0m
[30;1m113 | [0m[35m    directory_service = config.directory_service[0m
[30;1m114 | [0m[35m    return ([0m
[30;1m115 | [0m[35m        {[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35mdef get_slurm_specific_dna_json_for_head_node(config: SlurmClusterConfig, scheduler_resources) -> di[0m
[30;1m102 | [0m[35m    """Return a dict containing slurm specific settings to be written to dna.json of head node."""[0m
[30;1m103 | [0m[35m    return {[0m
[30;1m104 | [0m[35m        "dns_domain": scheduler_resources.cluster_hosted_zone.name if scheduler_resources.cluster_ho[0m
[30;1m105 | [0m[35m        "hosted_zone": scheduler_resources.cluster_hosted_zone.ref if scheduler_resources.cluster_ho[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35mdef get_common_user_data_env(node: Union[HeadNode, SlurmQueue, LoginNodesPool], config: BaseClusterC[0m
[30;1m87 | [0m[35m    """Return a dict containing the common env variables to be replaced in user data."""[0m
[30;1m88 | [0m[35m    return {[0m
[30;1m89 | [0m[35m        "YumProxy": node.networking.proxy.http_proxy_address if node.networking.proxy else "_none_",[0m
[30;1m90 | [0m[35m        "DnfProxy": node.networking.proxy.http_proxy_address if node.networking.proxy else "",[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/iam_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/database_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m41 | [0m[35m    def _check_leading_slash(self, uri: str) -> bool:[0m
[30;1m42 | [0m[35m        if uri.startswith("/"):[0m
[30;1m43 | [0m[35m            self._add_failure([0m
[30;1m44 | [0m[35m                f"Invalid URI specified. Please remove any leading / at the beginning of the provide[0m
[30;1m45 | [0m[35m                FailureLevel.ERROR,[0m
[30;1m46 | [0m[35m            )[0m
[30;1m47 | [0m[35m            return False[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/database_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/build-docker-images.sh[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m#!/usr/bin/env bash[0m
[30;1m2 | [0m[35mset -eu[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mretry() {[0m
[30;1m5 | [0m[35m    local loop=1[0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/build-docker-images.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35mif [ -z "${IMAGE}" ]; then[0m
[30;1m36 | [0m[35m    echo "No image to build specified. Building all images..."[0m
[30;1m37 | [0m[35m    find "$(pwd)" -type f -name Dockerfile -print0 | while read -d $'\0' file; do[0m
[30;1m38 | [0m[35m        IMAGE_TAG=$(dirname "${file}" | xargs basename)[0m
[30;1m39 | [0m[35m        build_docker_image "${IMAGE_TAG}"[0m
[30;1m40 | [0m[35m    done[0m
[30;1m41 | [0m[35melse[0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/build-docker-images.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mif [ -z "${IMAGE}" ]; then[0m
[30;1m36 | [0m[35m    echo "No image to build specified. Building all images..."[0m
[30;1m37 | [0m[35m    find "$(pwd)" -type f -name Dockerfile -print0 | while read -d $'\0' file; do[0m
[30;1m38 | [0m[35m        IMAGE_TAG=$(dirname "${file}" | xargs basename)[0m
[30;1m39 | [0m[35m        build_docker_image "${IMAGE_TAG}"[0m
[30;1m40 | [0m[35m    done[0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/build-docker-images.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m        echo "Dockerfile not found for image ${image}. Exiting..."[0m
[30;1m30 | [0m[35m        exit 1[0m
[30;1m31 | [0m[35m    fi[0m
[30;1m32 | [0m[35m    retry docker build --build-arg AWS_REGION="${AWS_REGION}" -f "${image}/Dockerfile" -t "${IMAGE_R[0m
[30;1m33 | [0m[35m}[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35mif [ -z "${IMAGE}" ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/build-docker-images.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m#!/usr/bin/env bash[0m
[30;1m2 | [0m[35mset -eu[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mretry() {[0m
[30;1m5 | [0m[35m    local loop=1[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m67 | [0m[35mAWS ParallelCluster facilitates both quick start proof of concepts (POCs) and production deployments[0m
[30;1m68 | [0m[35mYou can build higher level workflows, such as a Genomics portal that automates the entire DNA sequen[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35mDocumentation can be found at https://docs.aws.amazon.com/parallelcluster/[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35mBuilt on the Open Source CfnCluster project, AWS ParallelCluster enables you to quickly build an HPC[0m
[30;1m66 | [0m[35mIt automatically sets up the required compute resources and a shared filesystem and offers a variety[0m
[30;1m67 | [0m[35mAWS ParallelCluster facilitates both quick start proof of concepts (POCs) and production deployments[0m
[30;1m68 | [0m[35mYou can build higher level workflows, such as a Genomics portal that automates the entire DNA sequen[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35mDocumentation can be found at https://docs.aws.amazon.com/parallelcluster/[0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m175 | [0m[35m    @staticmethod[0m
[30;1m176 | [0m[35m    def is_enabled():[0m
[30;1m177 | [0m[35m        """Tell if the cache is enabled."""[0m
[30;1m178 | [0m[35m        return not os.environ.get("PCLUSTER_CACHE_DISABLED")[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m    @staticmethod[0m
[30;1m181 | [0m[35m    def clear_all():[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35mdef _log_boto3_calls(params, **kwargs):[0m
[30;1m131 | [0m[35m    service = kwargs["event_name"].split(".")[-2][0m
[30;1m132 | [0m[35m    operation = kwargs["event_name"].split(".")[-1][0m
[30;1m133 | [0m[35m    region = kwargs["context"].get("client_region", boto3.session.Session().region_name)[0m
[30;1m134 | [0m[35m    LOGGER.info([0m
[30;1m135 | [0m[35m        "Executing boto3 call: region=%s, service=%s, operation=%s, params=%s", region, service, ope[0m
[30;1m136 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/common.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m201 | [0m[35m        Decorate a function to make it use a results cache based on passed arguments.[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m        Note: for threaded invocations, only a single instance for a given set of arguments[0m
[30;1m204 | [0m[35m        will execute at a given time.[0m
[30;1m205 | [0m[35m        """[0m
[30;1m206 | [0m[35m        cache = {}[0m
[30;1m207 | [0m[35m        mutexes = {}[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/common.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35mdef _log_boto3_calls(params, **kwargs):[0m
[30;1m131 | [0m[35m    service = kwargs["event_name"].split(".")[-2][0m
[30;1m132 | [0m[35m    operation = kwargs["event_name"].split(".")[-1][0m
[30;1m133 | [0m[35m    region = kwargs["context"].get("client_region", boto3.session.Session().region_name)[0m
[30;1m134 | [0m[35m    LOGGER.info([0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m        @classmethod[0m
[30;1m39 | [0m[35m        def throttling_error_codes(cls):[0m
[30;1m40 | [0m[35m            """Return a set of error codes returned when service rate limits are exceeded."""[0m
[30;1m41 | [0m[35m            return {cls.REQUEST_LIMIT_EXCEEDED.value, cls.THROTTLING_EXCEPTION.value}[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    def __init__(self, function_name: str, message: str, error_code: str = None):[0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35mimport logging[0m
[30;1m14 | [0m[35mimport os[0m
[30;1m15 | [0m[35mimport threading[0m
[30;1m16 | [0m[35mimport time[0m
[30;1m17 | [0m[35mfrom enum import Enum[0m
[30;1m18 | [0m[35mfrom typing import Dict[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mimport boto3[0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/feature_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2023 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/dynamo.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m365 | [0m[35m              if [ ${PLATFORM} != DEBIAN ]; then[0m
[30;1m366 | [0m[35m                echo "Checking dpkg is not installed on non-debian OS..."[0m
[30;1m367 | [0m[35m                if command -v dpkg &> /dev/null; then[0m
[30;1m368 | [0m[35m                  echo "ERROR: dpkg found on non-Debian system" && exit 1[0m
[30;1m369 | [0m[35m                fi[0m
[30;1m370 | [0m[35m                echo "dpkg test passed"[0m
[30;1m371 | [0m[35m              fi[0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m364 | [0m[35m              PLATFORM='{{ validate.PlatformName.outputs.stdout }}'[0m
[30;1m365 | [0m[35m              if [ ${PLATFORM} != DEBIAN ]; then[0m
[30;1m366 | [0m[35m                echo "Checking dpkg is not installed on non-debian OS..."[0m
[30;1m367 | [0m[35m                if command -v dpkg &> /dev/null; then[0m
[30;1m368 | [0m[35m                  echo "ERROR: dpkg found on non-Debian system" && exit 1[0m
[30;1m369 | [0m[35m                fi[0m
[30;1m370 | [0m[35m                echo "dpkg test passed"[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m363 | [0m[35m              set -vx[0m
[30;1m364 | [0m[35m              PLATFORM='{{ validate.PlatformName.outputs.stdout }}'[0m
[30;1m365 | [0m[35m              if [ ${PLATFORM} != DEBIAN ]; then[0m
[30;1m366 | [0m[35m                echo "Checking dpkg is not installed on non-debian OS..."[0m
[30;1m367 | [0m[35m                if command -v dpkg &> /dev/null; then[0m
[30;1m368 | [0m[35m                  echo "ERROR: dpkg found on non-Debian system" && exit 1[0m
[30;1m369 | [0m[35m                fi[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m355 | [0m[35m              [[ $? -ne 0 ]] && echo "Python3 is not installed" && exit 1[0m
[30;1m356 | [0m[35m              echo "Python test passed"[0m
[30;1m357 | [0m[35m[0m
[30;1m358 | [0m[35m      - name: DPKG[0m
[30;1m359 | [0m[35m        action: ExecuteBash[0m
[30;1m360 | [0m[35m        inputs:[0m
[30;1m361 | [0m[35m          commands:[0m
[30;1m362 | [0m[35m            - |[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m323 | [0m[35m                    -DCMAKE_PREFIX_PATH=/usr/local/cuda-cuda-${cuda_ver} \[0m
[30;1m324 | [0m[35m                     ${CMAKE_ARGS}[0m
[30;1m325 | [0m[35m                   make[0m
[30;1m326 | [0m[35m                   ./deviceQuery | grep -o "Result = PASS"[0m
[30;1m327 | [0m[35m                   if [ "${OS}" == 'ubuntu2004' ]; then[0m
[30;1m328 | [0m[35m                     $COOKBOOK_ENV_PATH/bin/pip3 uninstall cmake -y[0m
[30;1m329 | [0m[35m                     deactivate[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m307 | [0m[35m         MINI_CMAKE_VER_REQ=$(sed -n 's/cmake_minimum_required(\(VERSION \)\?\([0-9.]*\)).*/\2/p' CM[0m
[30;1m308 | [0m[35m                     COOKBOOK_ENV=$(jq '.default.cluster.cookbook_virtualenv_path' {{ CookbookDefaul[0m
[30;1m309 | [0m[35m                     COOKBOOK_ENV_PATH=$(echo ${COOKBOOK_ENV} | tr -d '\n' | cut -d = -f 2 | xargs)[0m
[30;1m310 | [0m[35m                     echo "Installing Cmake >= ${MINI_CMAKE_VER_REQ} in $COOKBOOK_ENV_PATH/bin"[0m
[30;1m311 | [0m[35m                     . $COOKBOOK_ENV_PATH/bin/activate[0m
[30;1m312 | [0m[35m                     $COOKBOOK_ENV_PATH/bin/pip3 install cmake>=$MINI_CMAKE_VER_REQ[0m
[30;1m313 | [0m[35m                     CMAKE_ARGS=""[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m301 | [0m[35midate.CudaSamplesDir.outputs.stdout }}//Samples/1_Utilities/deviceQuery[0m
[30;1m302 | [0m[35m                 if [ {{ validate.OperatingSystemName.outputs.stdout }} == 'alinux2' ]; then[0m
[30;1m303 | [0m[35m                   make[0m
[30;1m304 | [0m[35m                   /usr/local/{{ validate.CudaSamplesDir.outputs.stdout }}/bin/sbsa/linux/release/de[0m
[30;1m305 | [0m[35m                 else[0m
[30;1m306 | [0m[35m                   if [ {{ validate.OperatingSystemName.outputs.stdout }} == 'ubuntu2004' ]; then[0m
[30;1m307 | [0m[35m                     MINI_CMAKE_VER_REQ=$(sed -n 's/cmake_minimum_required(\(VERSION \)\?\([0-9.]*\)[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m              echo "Testing CUDA with deviceQuery..."[0m
[30;1m297 | [0m[35m              if [ {{ validate.OperatingSystemArchitecture.outputs.stdout }} != 'arm64' ]; then[0m
[30;1m298 | [0m[35m                /usr/local/cuda-${cuda_ver}/extras/demo_suite/deviceQuery | grep -o "Result = PASS"[0m
[30;1m299 | [0m[35m                [[ $? -ne 0 ]] && echo "CUDA deviceQuery test failed" && exit 1[0m
[30;1m300 | [0m[35m              else[0m
[30;1m301 | [0m[35m                 cd /usr/local/{{ validate.CudaSamplesDir.outputs.stdout }}//Samples/1_Utilities/dev[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m289 | [0m[35m              cuda_ver="{{ validate.CudaVersion.outputs.stdout }}"[0m
[30;1m290 | [0m[35m              export PATH=/usr/local/cuda-${cuda_ver}/bin:${PATH}[0m
[30;1m291 | [0m[35m              export LD_LIBRARY_PATH=/usr/local/cuda-${cuda_ver}/lib64:${LD_LIBRARY_PATH}[0m
[30;1m292 | [0m[35m              cuda_output=$(nvcc -V | grep -E -o "release [0-9]+.[0-9]+")[0m
[30;1m293 | [0m[35m              [[ "${cuda_output}" != "release ${cuda_ver}" ]] && echo "ERROR Installed version ${cud[0m
[30;1m294 | [0m[35m              echo "Correctly installed CUDA ${cuda_output}"[0m
[30;1m295 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m280 | [0m[35m                  yum versionlock list | grep "nvidia-fabric.*manager" || exit 1[0m
[30;1m281 | [0m[35m                else[0m
[30;1m282 | [0m[35m                  apt list --installed | grep "nvidia-fabric.*manager" | grep "${nvidia_driver_versi[0m
[30;1m283 | [0m[35m                  apt-mark showhold | grep "nvidia-fabric.*manager" || exit 1[0m
[30;1m284 | [0m[35m                fi[0m
[30;1m285 | [0m[35m                echo "Fabric Manager match Nvidia driver and version is locked"[0m
[30;1m286 | [0m[35m              fi[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m279 | [0m[35m                  yum list installed | grep "nvidia-fabric.*manager" | grep "${nvidia_driver_version[0m
[30;1m280 | [0m[35m                  yum versionlock list | grep "nvidia-fabric.*manager" || exit 1[0m
[30;1m281 | [0m[35m                else[0m
[30;1m282 | [0m[35m                  apt list --installed | grep "nvidia-fabric.*manager" | grep "${nvidia_driver_versi[0m
[30;1m283 | [0m[35m                  apt-mark showhold | grep "nvidia-fabric.*manager" || exit 1[0m
[30;1m284 | [0m[35m                fi[0m
[30;1m285 | [0m[35m                echo "Fabric Manager match Nvidia driver and version is locked"[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m279 | [0m[35m                  yum list installed | grep "nvidia-fabric.*manager" | grep "${nvidia_driver_version[0m
[30;1m280 | [0m[35m                  yum versionlock list | grep "nvidia-fabric.*manager" || exit 1[0m
[30;1m281 | [0m[35m                else[0m
[30;1m282 | [0m[35m                  apt list --installed | grep "nvidia-fabric.*manager" | grep "${nvidia_driver_versi[0m
[30;1m283 | [0m[35m                  apt-mark showhold | grep "nvidia-fabric.*manager" || exit 1[0m
[30;1m284 | [0m[35m                fi[0m
[30;1m285 | [0m[35m                echo "Fabric Manager match Nvidia driver and version is locked"[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m279 | [0m[35m                  yum list installed | grep "nvidia-fabric.*manager" | grep "${nvidia_driver_version[0m
[30;1m280 | [0m[35m                  yum versionlock list | grep "nvidia-fabric.*manager" || exit 1[0m
[30;1m281 | [0m[35m                else[0m
[30;1m282 | [0m[35m                  apt list --installed | grep "nvidia-fabric.*manager" | grep "${nvidia_driver_versi[0m
[30;1m283 | [0m[35m                  apt-mark showhold | grep "nvidia-fabric.*manager" || exit 1[0m
[30;1m284 | [0m[35m                fi[0m
[30;1m285 | [0m[35m                echo "Fabric Manager match Nvidia driver and version is locked"[0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m277 | [0m[35m                nvidia_driver_version=$(modinfo -F version nvidia)[0m
[30;1m278 | [0m[35m                if [ "${PLATFORM}" == "RHEL" ]; then[0m
[30;1m279 | [0m[35m                  yum list installed | grep "nvidia-fabric.*manager" | grep "${nvidia_driver_version[0m
[30;1m280 | [0m[35m                  yum versionlock list | grep "nvidia-fabric.*manager" || exit 1[0m
[30;1m281 | [0m[35m                else[0m
[30;1m282 | [0m[35m                  apt list --installed | grep "nvidia-fabric.*manager" | grep "${nvidia_driver_versi[0m
[30;1m283 | [0m[35m                  apt-mark showhold | grep "nvidia-fabric.*manager" || exit 1[0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m277 | [0m[35m                nvidia_driver_version=$(modinfo -F version nvidia)[0m
[30;1m278 | [0m[35m                if [ "${PLATFORM}" == "RHEL" ]; then[0m
[30;1m279 | [0m[35m                  yum list installed | grep "nvidia-fabric.*manager" | grep "${nvidia_driver_version[0m
[30;1m280 | [0m[35m                  yum versionlock list | grep "nvidia-fabric.*manager" || exit 1[0m
[30;1m281 | [0m[35m                else[0m
[30;1m282 | [0m[35m                  apt list --installed | grep "nvidia-fabric.*manager" | grep "${nvidia_driver_versi[0m
[30;1m283 | [0m[35m                  apt-mark showhold | grep "nvidia-fabric.*manager" || exit 1[0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m276 | [0m[35m                echo "Testing Nvidia Fabric Manager version"[0m
[30;1m277 | [0m[35m                nvidia_driver_version=$(modinfo -F version nvidia)[0m
[30;1m278 | [0m[35m                if [ "${PLATFORM}" == "RHEL" ]; then[0m
[30;1m279 | [0m[35m                  yum list installed | grep "nvidia-fabric.*manager" | grep "${nvidia_driver_version[0m
[30;1m280 | [0m[35m                  yum versionlock list | grep "nvidia-fabric.*manager" || exit 1[0m
[30;1m281 | [0m[35m                else[0m
[30;1m282 | [0m[35m                  apt list --installed | grep "nvidia-fabric.*manager" | grep "${nvidia_driver_versi[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m276 | [0m[35m                echo "Testing Nvidia Fabric Manager version"[0m
[30;1m277 | [0m[35m                nvidia_driver_version=$(modinfo -F version nvidia)[0m
[30;1m278 | [0m[35m                if [ "${PLATFORM}" == "RHEL" ]; then[0m
[30;1m279 | [0m[35m                  yum list installed | grep "nvidia-fabric.*manager" | grep "${nvidia_driver_version[0m
[30;1m280 | [0m[35m                  yum versionlock list | grep "nvidia-fabric.*manager" || exit 1[0m
[30;1m281 | [0m[35m                else[0m
[30;1m282 | [0m[35m                  apt list --installed | grep "nvidia-fabric.*manager" | grep "${nvidia_driver_versi[0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m276 | [0m[35m                echo "Testing Nvidia Fabric Manager version"[0m
[30;1m277 | [0m[35m                nvidia_driver_version=$(modinfo -F version nvidia)[0m
[30;1m278 | [0m[35m                if [ "${PLATFORM}" == "RHEL" ]; then[0m
[30;1m279 | [0m[35m                  yum list installed | grep "nvidia-fabric.*manager" | grep "${nvidia_driver_version[0m
[30;1m280 | [0m[35m                  yum versionlock list | grep "nvidia-fabric.*manager" || exit 1[0m
[30;1m281 | [0m[35m                else[0m
[30;1m282 | [0m[35m                  apt list --installed | grep "nvidia-fabric.*manager" | grep "${nvidia_driver_versi[0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m268 | [0m[35m              export PATH="/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/opt/aws/bin[0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35m              echo "Testing Nvidia driver version"[0m
[30;1m271 | [0m[35m              driver_output=$(nvidia-smi | grep -E -o "Driver Version: [0-9.]+")[0m
[30;1m272 | [0m[35m              [[ "${driver_output}" != "Driver Version: ${driver_ver}" ]] && "ERROR Installed versio[0m
[30;1m273 | [0m[35m              echo "Correctly installed Nvidia ${driver_output}"[0m
[30;1m274 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m243 | [0m[35m                  (module avail intelmpi)2>&1 | grep "/opt/intel/mpi/20.*/modulefiles"[0m
[30;1m244 | [0m[35m                  [[ $? -ne 0 ]] && echo "Check Intel MPI failed" && exit 1[0m
[30;1m245 | [0m[35m                else[0m
[30;1m246 | [0m[35m                  dpkg -l | grep libfabric && modinfo efa | grep efa && [ -d /opt/amazon/efa ][0m
[30;1m247 | [0m[35m                  [[ $? -ne 0 ]] && echo "Check efa deb failed" && exit 1[0m
[30;1m248 | [0m[35m                fi[0m
[30;1m249 | [0m[35m              fi[0m

[31m--[ [0m[34mMatch #[0m[33m404[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m243 | [0m[35m                  (module avail intelmpi)2>&1 | grep "/opt/intel/mpi/20.*/modulefiles"[0m
[30;1m244 | [0m[35m                  [[ $? -ne 0 ]] && echo "Check Intel MPI failed" && exit 1[0m
[30;1m245 | [0m[35m                else[0m
[30;1m246 | [0m[35m                  dpkg -l | grep libfabric && modinfo efa | grep efa && [ -d /opt/amazon/efa ][0m
[30;1m247 | [0m[35m                  [[ $? -ne 0 ]] && echo "Check efa deb failed" && exit 1[0m
[30;1m248 | [0m[35m                fi[0m
[30;1m249 | [0m[35m              fi[0m

[31m--[ [0m[34mMatch #[0m[33m405[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m243 | [0m[35m                  (module avail intelmpi)2>&1 | grep "/opt/intel/mpi/20.*/modulefiles"[0m
[30;1m244 | [0m[35m                  [[ $? -ne 0 ]] && echo "Check Intel MPI failed" && exit 1[0m
[30;1m245 | [0m[35m                else[0m
[30;1m246 | [0m[35m                  dpkg -l | grep libfabric && modinfo efa | grep efa && [ -d /opt/amazon/efa ][0m
[30;1m247 | [0m[35m                  [[ $? -ne 0 ]] && echo "Check efa deb failed" && exit 1[0m
[30;1m248 | [0m[35m                fi[0m
[30;1m249 | [0m[35m              fi[0m

[31m--[ [0m[34mMatch #[0m[33m406[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m240 | [0m[35m                  echo "Checking Intel MPI 20xx installed and module available..."[0m
[30;1m241 | [0m[35m                  unset MODULEPATH[0m
[30;1m242 | [0m[35m                  source /etc/profile.d/modules.sh[0m
[30;1m243 | [0m[35m                  (module avail intelmpi)2>&1 | grep "/opt/intel/mpi/20.*/modulefiles"[0m
[30;1m244 | [0m[35m                  [[ $? -ne 0 ]] && echo "Check Intel MPI failed" && exit 1[0m
[30;1m245 | [0m[35m                else[0m
[30;1m246 | [0m[35m                  dpkg -l | grep libfabric && modinfo efa | grep efa && [ -d /opt/amazon/efa ][0m

[31m--[ [0m[34mMatch #[0m[33m407[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m235 | [0m[35m                echo "Checking efa packages installed..."[0m
[30;1m236 | [0m[35m                if [ ${PLATFORM} == RHEL ]; then[0m
[30;1m237 | [0m[35m                  rpm -qa | grep libfabric && rpm -qa | grep efa-[0m
[30;1m238 | [0m[35m                  [[ $? -ne 0 ]] && echo "Check efa rpm failed" && exit 1[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m                  echo "Checking Intel MPI 20xx installed and module available..."[0m
[30;1m241 | [0m[35m                  unset MODULEPATH[0m

[31m--[ [0m[34mMatch #[0m[33m408[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m234 | [0m[35m              if [ {{ validate.IntelMPISupported.outputs.stdout }} == true ]; then[0m
[30;1m235 | [0m[35m                echo "Checking efa packages installed..."[0m
[30;1m236 | [0m[35m                if [ ${PLATFORM} == RHEL ]; then[0m
[30;1m237 | [0m[35m                  rpm -qa | grep libfabric && rpm -qa | grep efa-[0m
[30;1m238 | [0m[35m                  [[ $? -ne 0 ]] && echo "Check efa rpm failed" && exit 1[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m                  echo "Checking Intel MPI 20xx installed and module available..."[0m

[31m--[ [0m[34mMatch #[0m[33m409[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m234 | [0m[35m              if [ {{ validate.IntelMPISupported.outputs.stdout }} == true ]; then[0m
[30;1m235 | [0m[35m                echo "Checking efa packages installed..."[0m
[30;1m236 | [0m[35m                if [ ${PLATFORM} == RHEL ]; then[0m
[30;1m237 | [0m[35m                  rpm -qa | grep libfabric && rpm -qa | grep efa-[0m
[30;1m238 | [0m[35m                  [[ $? -ne 0 ]] && echo "Check efa rpm failed" && exit 1[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m                  echo "Checking Intel MPI 20xx installed and module available..."[0m

[31m--[ [0m[34mMatch #[0m[33m410[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m234 | [0m[35m              if [ {{ validate.IntelMPISupported.outputs.stdout }} == true ]; then[0m
[30;1m235 | [0m[35m                echo "Checking efa packages installed..."[0m
[30;1m236 | [0m[35m                if [ ${PLATFORM} == RHEL ]; then[0m
[30;1m237 | [0m[35m                  rpm -qa | grep libfabric && rpm -qa | grep efa-[0m
[30;1m238 | [0m[35m                  [[ $? -ne 0 ]] && echo "Check efa rpm failed" && exit 1[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m                  echo "Checking Intel MPI 20xx installed and module available..."[0m

[31m--[ [0m[34mMatch #[0m[33m411[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m234 | [0m[35m              if [ {{ validate.IntelMPISupported.outputs.stdout }} == true ]; then[0m
[30;1m235 | [0m[35m                echo "Checking efa packages installed..."[0m
[30;1m236 | [0m[35m                if [ ${PLATFORM} == RHEL ]; then[0m
[30;1m237 | [0m[35m                  rpm -qa | grep libfabric && rpm -qa | grep efa-[0m
[30;1m238 | [0m[35m                  [[ $? -ne 0 ]] && echo "Check efa rpm failed" && exit 1[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m                  echo "Checking Intel MPI 20xx installed and module available..."[0m

[31m--[ [0m[34mMatch #[0m[33m412[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m219 | [0m[35m            - |[0m
[30;1m220 | [0m[35m              set -vx[0m
[30;1m221 | [0m[35m              echo "check munge installed"[0m
[30;1m222 | [0m[35m              munge --version | grep {{ validate.MungeVersion.outputs.stdout }}[0m
[30;1m223 | [0m[35m              [[ $? -ne 0 ]] && echo "Check munge version failed" && exit 1[0m
[30;1m224 | [0m[35m              echo "Munge test passed"[0m
[30;1m225 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m413[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m209 | [0m[35m          commands:[0m
[30;1m210 | [0m[35m            - |[0m
[30;1m211 | [0m[35m              set -v[0m
[30;1m212 | [0m[35m              HAS_GPU=$(lspci | grep -o "NVIDIA") || HAS_GPU="false"[0m
[30;1m213 | [0m[35m              echo "${HAS_GPU}"[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m      - name: Munge[0m

[31m--[ [0m[34mMatch #[0m[33m414[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m191 | [0m[35m          commands:[0m
[30;1m192 | [0m[35m            - |[0m
[30;1m193 | [0m[35m              set -v[0m
[30;1m194 | [0m[35m              sed -Ei "s#path: cookbooks/aws-parallelcluster#path: /etc/chef/cookbooks/aws-parallelc[0m
[30;1m195 | [0m[35m              echo "InSpec profiles patched"[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m      - name: NvidiaEnabled[0m

[31m--[ [0m[34mMatch #[0m[33m415[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m178 | [0m[35m              cuda_ver="{{ validate.CudaVersion.outputs.stdout }}"[0m
[30;1m179 | [0m[35m              if [ ${cuda_ver} \> '11.4' ]; then[0m
[30;1m180 | [0m[35m                PATTERN=$(jq '.default.cluster.nvidia.cuda_samples_version' {{ CookbookDefaultFile }[0m
[30;1m181 | [0m[35m                VERSION=$(echo ${PATTERN} | tr -d '\n' | cut -d = -f 2 | xargs)[0m
[30;1m182 | [0m[35m                echo cuda-samples-${VERSION}[0m
[30;1m183 | [0m[35m              else[0m
[30;1m184 | [0m[35m                echo cuda-${cuda_ver}[0m

[31m--[ [0m[34mMatch #[0m[33m416[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m166 | [0m[35m            - |[0m
[30;1m167 | [0m[35m              set -v[0m
[30;1m168 | [0m[35m              PATTERN=$(jq '.default.cluster.nvidia.cuda.version' {{ CookbookDefaultFile }})[0m
[30;1m169 | [0m[35m              VERSION=$(echo ${PATTERN} | tr -d '\n' | cut -d = -f 2 | xargs)[0m
[30;1m170 | [0m[35m              echo ${VERSION}[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m      - name: CudaSamplesDir[0m

[31m--[ [0m[34mMatch #[0m[33m417[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m156 | [0m[35m            - |[0m
[30;1m157 | [0m[35m              set -v[0m
[30;1m158 | [0m[35m              PATTERN=$(jq '.default.cluster.nvidia.driver_version' {{ CookbookDefaultFile }})[0m
[30;1m159 | [0m[35m              VERSION=$(echo ${PATTERN} | tr -d '\n' | cut -d = -f 2 | xargs)[0m
[30;1m160 | [0m[35m              echo ${VERSION}[0m
[30;1m161 | [0m[35m[0m
[30;1m162 | [0m[35m      - name: CudaVersion[0m

[31m--[ [0m[34mMatch #[0m[33m418[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m146 | [0m[35m            - |[0m
[30;1m147 | [0m[35m              set -v[0m
[30;1m148 | [0m[35m              PATTERN=$(jq '.default.cluster.munge.munge_version' {{ CookbookDefaultFile }})[0m
[30;1m149 | [0m[35m              VERSION=$(echo ${PATTERN} | tr -d '\n' | cut -d = -f 2 | xargs)[0m
[30;1m150 | [0m[35m              echo ${VERSION}[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m      - name: NvidiaDriverVersion[0m

[31m--[ [0m[34mMatch #[0m[33m419[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m              if [ `echo "${OS}" | grep -E '^(alinux|centos|rhel|rocky)'` ]; then[0m
[30;1m91 | [0m[35m                PLATFORM='RHEL'[0m
[30;1m92 | [0m[35m              elif [ `echo "${OS}" | grep -E '^ubuntu'` ]; then[0m
[30;1m93 | [0m[35m                PLATFORM='DEBIAN'[0m
[30;1m94 | [0m[35m              fi[0m
[30;1m95 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m420[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m              set -v[0m
[30;1m88 | [0m[35m              OS='{{ validate.OperatingSystemName.outputs.stdout }}'[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m              if [ `echo "${OS}" | grep -E '^(alinux|centos|rhel|rocky)'` ]; then[0m
[30;1m91 | [0m[35m                PLATFORM='RHEL'[0m
[30;1m92 | [0m[35m              elif [ `echo "${OS}" | grep -E '^ubuntu'` ]; then[0m
[30;1m93 | [0m[35m                PLATFORM='DEBIAN'[0m

[31m--[ [0m[34mMatch #[0m[33m421[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m                OS='rocky8'[0m
[30;1m51 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rhel\.9'` ]; then[0m
[30;1m52 | [0m[35m                OS='rhel9'[0m
[30;1m53 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rocky\.9'` ]; then[0m
[30;1m54 | [0m[35m                OS='rocky9'[0m
[30;1m55 | [0m[35m              else[0m
[30;1m56 | [0m[35m                echo "Operating System '${RELEASE}' is not supported. Failing build." && exit 1[0m

[31m--[ [0m[34mMatch #[0m[33m422[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m                OS='rhel8'[0m
[30;1m49 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rocky\.8'` ]; then[0m
[30;1m50 | [0m[35m                OS='rocky8'[0m
[30;1m51 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rhel\.9'` ]; then[0m
[30;1m52 | [0m[35m                OS='rhel9'[0m
[30;1m53 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rocky\.9'` ]; then[0m
[30;1m54 | [0m[35m                OS='rocky9'[0m

[31m--[ [0m[34mMatch #[0m[33m423[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m                OS='ubuntu2404'[0m
[30;1m47 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rhel\.8'` ]; then[0m
[30;1m48 | [0m[35m                OS='rhel8'[0m
[30;1m49 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rocky\.8'` ]; then[0m
[30;1m50 | [0m[35m                OS='rocky8'[0m
[30;1m51 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rhel\.9'` ]; then[0m
[30;1m52 | [0m[35m                OS='rhel9'[0m

[31m--[ [0m[34mMatch #[0m[33m424[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m                OS='ubuntu2204'[0m
[30;1m45 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^ubuntu\.24'` ]; then[0m
[30;1m46 | [0m[35m                OS='ubuntu2404'[0m
[30;1m47 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rhel\.8'` ]; then[0m
[30;1m48 | [0m[35m                OS='rhel8'[0m
[30;1m49 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rocky\.8'` ]; then[0m
[30;1m50 | [0m[35m                OS='rocky8'[0m

[31m--[ [0m[34mMatch #[0m[33m425[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35m                OS='ubuntu2004'[0m
[30;1m43 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^ubuntu\.22'` ]; then[0m
[30;1m44 | [0m[35m                OS='ubuntu2204'[0m
[30;1m45 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^ubuntu\.24'` ]; then[0m
[30;1m46 | [0m[35m                OS='ubuntu2404'[0m
[30;1m47 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rhel\.8'` ]; then[0m
[30;1m48 | [0m[35m                OS='rhel8'[0m

[31m--[ [0m[34mMatch #[0m[33m426[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m                OS='alinux2023'[0m
[30;1m41 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^ubuntu\.20'` ]; then[0m
[30;1m42 | [0m[35m                OS='ubuntu2004'[0m
[30;1m43 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^ubuntu\.22'` ]; then[0m
[30;1m44 | [0m[35m                OS='ubuntu2204'[0m
[30;1m45 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^ubuntu\.24'` ]; then[0m
[30;1m46 | [0m[35m                OS='ubuntu2404'[0m

[31m--[ [0m[34mMatch #[0m[33m427[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m                OS='alinux2'[0m
[30;1m39 | [0m[35m              elif [ `echo "${RELEASE}" | grep -w '^amzn\.2023'` ]; then[0m
[30;1m40 | [0m[35m                OS='alinux2023'[0m
[30;1m41 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^ubuntu\.20'` ]; then[0m
[30;1m42 | [0m[35m                OS='ubuntu2004'[0m
[30;1m43 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^ubuntu\.22'` ]; then[0m
[30;1m44 | [0m[35m                OS='ubuntu2204'[0m

[31m--[ [0m[34mMatch #[0m[33m428[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m              if [ `echo "${RELEASE}" | grep -w '^amzn\.2'` ]; then[0m
[30;1m38 | [0m[35m                OS='alinux2'[0m
[30;1m39 | [0m[35m              elif [ `echo "${RELEASE}" | grep -w '^amzn\.2023'` ]; then[0m
[30;1m40 | [0m[35m                OS='alinux2023'[0m
[30;1m41 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^ubuntu\.20'` ]; then[0m
[30;1m42 | [0m[35m                OS='ubuntu2004'[0m

[31m--[ [0m[34mMatch #[0m[33m429[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_validate.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m              set -v[0m
[30;1m35 | [0m[35m              RELEASE='{{ validate.OperatingSystemRelease.outputs.stdout }}'[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m              if [ `echo "${RELEASE}" | grep -w '^amzn\.2'` ]; then[0m
[30;1m38 | [0m[35m                OS='alinux2'[0m
[30;1m39 | [0m[35m              elif [ `echo "${RELEASE}" | grep -w '^amzn\.2023'` ]; then[0m
[30;1m40 | [0m[35m                OS='alinux2023'[0m

[31m--[ [0m[34mMatch #[0m[33m430[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3124 | [0m[35m                    )[0m
[30;1m3125 | [0m[35m                    self._register_validator([0m
[30;1m3126 | [0m[35m                        PlacementGroupCapacityReservationValidator,[0m
[30;1m3127 | [0m[35m                        placement_group=queue.get_placement_group_settings_for_compute_resource(comp[0m
[30;1m3128 | [0m[35m                            "key"[0m
[30;1m3129 | [0m[35m                        ),[0m
[30;1m3130 | [0m[35m                        odcr=cr_target,[0m

[31m--[ [0m[34mMatch #[0m[33m431[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m3100 | [0m[35m                    if cr_target.capacity_reservation_id:[0m
[30;1m3101 | [0m[35m                        # increment counter of number of instances used for a given capacity reserva[0m
[30;1m3102 | [0m[35m                        # to verify to not exceed instance count when considering all the configured[0m
[30;1m3103 | [0m[35m                        num_of_instances_in_capacity_reservation = capacity_reservation_id_max_count[0m
[30;1m3104 | [0m[35m                            cr_target.capacity_reservation_id, 0[0m
[30;1m3105 | [0m[35m                        )[0m
[30;1m3106 | [0m[35m                        capacity_reservation_id_max_count_map[cr_target.capacity_reservation_id] = ([0m

[31m--[ [0m[34mMatch #[0m[33m432[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2668 | [0m[35m            self._register_validator([0m
[30;1m2669 | [0m[35m                EfaPlacementGroupValidator,[0m
[30;1m2670 | [0m[35m                efa_enabled=compute_resource.efa.enabled,[0m
[30;1m2671 | [0m[35m                placement_group_key=self.get_placement_group_settings_for_compute_resource(compute_r[0m
[30;1m2672 | [0m[35m                placement_group_disabled=self.get_chosen_placement_group_setting_for_compute_resourc[0m
[30;1m2673 | [0m[35m                    compute_resource[0m
[30;1m2674 | [0m[35m                ).enabled[0m

[31m--[ [0m[34mMatch #[0m[33m433[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2525 | [0m[35m        return {"key": placement_group_key, "is_managed": managed}[0m
[30;1m2526 | [0m[35m[0m
[30;1m2527 | [0m[35m    def is_placement_group_enabled_for_compute_resource(self, compute_resource: _BaseSlurmComputeRes[0m
[30;1m2528 | [0m[35m        return self.get_placement_group_settings_for_compute_resource(compute_resource).get("key") i[0m
[30;1m2529 | [0m[35m[0m
[30;1m2530 | [0m[35m    def get_chosen_placement_group_setting_for_compute_resource([0m
[30;1m2531 | [0m[35m        self, compute_resource: _BaseSlurmComputeResource[0m

[31m--[ [0m[34mMatch #[0m[33m434[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2508 | [0m[35m        for compute_resource in self.compute_resources:[0m
[30;1m2509 | [0m[35m            placement_group_setting = self.get_placement_group_settings_for_compute_resource(compute[0m
[30;1m2510 | [0m[35m            if placement_group_setting.get("is_managed"):[0m
[30;1m2511 | [0m[35m                managed_placement_group_keys.append(placement_group_setting.get("key"))[0m
[30;1m2512 | [0m[35m        return managed_placement_group_keys[0m
[30;1m2513 | [0m[35m[0m
[30;1m2514 | [0m[35m    def get_placement_group_settings_for_compute_resource([0m

[31m--[ [0m[34mMatch #[0m[33m435[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m2507 | [0m[35m        managed_placement_group_keys = [][0m
[30;1m2508 | [0m[35m        for compute_resource in self.compute_resources:[0m
[30;1m2509 | [0m[35m            placement_group_setting = self.get_placement_group_settings_for_compute_resource(compute[0m
[30;1m2510 | [0m[35m            if placement_group_setting.get("is_managed"):[0m
[30;1m2511 | [0m[35m                managed_placement_group_keys.append(placement_group_setting.get("key"))[0m
[30;1m2512 | [0m[35m        return managed_placement_group_keys[0m
[30;1m2513 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m436[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1817 | [0m[35m            self._register_validator([0m
[30;1m1818 | [0m[35m                NumberOfStorageValidator,[0m
[30;1m1819 | [0m[35m                storage_type=f"existing {storage_type}",[0m
[30;1m1820 | [0m[35m                max_number=MAX_EXISTING_STORAGE_COUNT.get(storage_type_lower_case),[0m
[30;1m1821 | [0m[35m                storage_count=existing_storage_count[storage_type_lower_case],[0m
[30;1m1822 | [0m[35m            )[0m
[30;1m1823 | [0m[35m        self._register_validator([0m

[31m--[ [0m[34mMatch #[0m[33m437[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1811 | [0m[35m            self._register_validator([0m
[30;1m1812 | [0m[35m                NumberOfStorageValidator,[0m
[30;1m1813 | [0m[35m                storage_type=f"new {storage_type}",[0m
[30;1m1814 | [0m[35m                max_number=MAX_NEW_STORAGE_COUNT.get(storage_type_lower_case),[0m
[30;1m1815 | [0m[35m                storage_count=new_storage_count[storage_type_lower_case],[0m
[30;1m1816 | [0m[35m            )[0m
[30;1m1817 | [0m[35m            self._register_validator([0m

[31m--[ [0m[34mMatch #[0m[33m438[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1036 | [0m[35m        return [[0m
[30;1m1037 | [0m[35m            role.get("Arn")[0m
[30;1m1038 | [0m[35m            for role in ([0m
[30;1m1039 | [0m[35m                AWSApi.instance().iam.get_instance_profile(instance_profile_name).get("InstanceProfi[0m
[30;1m1040 | [0m[35m            )[0m
[30;1m1041 | [0m[35m        ][0m
[30;1m1042 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m439[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1036 | [0m[35m        return [[0m
[30;1m1037 | [0m[35m            role.get("Arn")[0m
[30;1m1038 | [0m[35m            for role in ([0m
[30;1m1039 | [0m[35m                AWSApi.instance().iam.get_instance_profile(instance_profile_name).get("InstanceProfi[0m
[30;1m1040 | [0m[35m            )[0m
[30;1m1041 | [0m[35m        ][0m
[30;1m1042 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m440[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1034 | [0m[35m    def _extract_roles_from_instance_profile(self, instance_profile_name) -> List[str]:[0m
[30;1m1035 | [0m[35m        """Return the ARNs of the IAM roles attached to the given instance profile."""[0m
[30;1m1036 | [0m[35m        return [[0m
[30;1m1037 | [0m[35m            role.get("Arn")[0m
[30;1m1038 | [0m[35m            for role in ([0m
[30;1m1039 | [0m[35m                AWSApi.instance().iam.get_instance_profile(instance_profile_name).get("InstanceProfi[0m
[30;1m1040 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m441[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m235 | [0m[35m            volume_type,[0m
[30;1m236 | [0m[35m            default=EBS_VOLUME_TYPE_DEFAULT,[0m
[30;1m237 | [0m[35m        )[0m
[30;1m238 | [0m[35m        self.iops = Resource.init_param(iops, default=EBS_VOLUME_TYPE_IOPS_DEFAULT.get(self.volume_t[0m
[30;1m239 | [0m[35m        self.throughput = Resource.init_param(throughput, default=125 if self.volume_type == "gp3" e[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m    def _register_validators(self, context: ValidatorContext = None):  # noqa: D102 #pylint: disable[0m

[31m--[ [0m[34mMatch #[0m[33m442[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3002 | [0m[35m                    instance_type=pool.instance_type,[0m
[30;1m3003 | [0m[35m                    os=self.image.os,[0m
[30;1m3004 | [0m[35m                )[0m
[30;1m3005 | [0m[35m            # Check pool instance compatability with NICE DCV.[0m
[30;1m3006 | [0m[35m            if pool.dcv:[0m
[30;1m3007 | [0m[35m                self._register_validator([0m
[30;1m3008 | [0m[35m                    DcvValidator,[0m

[31m--[ [0m[34mMatch #[0m[33m443[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2972 | [0m[35m        return list(subnet_ids_set)[0m
[30;1m2973 | [0m[35m[0m
[30;1m2974 | [0m[35m    def _register_login_node_validators(self):[0m
[30;1m2975 | [0m[35m        """Register all login node validators to ensure that the resource parameters are valid."""[0m
[30;1m2976 | [0m[35m        has_dcv_configured = False[0m
[30;1m2977 | [0m[35m        # Check if all subnets(head node, Login nodes, compute nodes) are in the same VPC and suppor[0m
[30;1m2978 | [0m[35m        self._register_validator([0m

[31m--[ [0m[34mMatch #[0m[33m444[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2911 | [0m[35m                elif not pool.ssh:[0m
[30;1m2912 | [0m[35m                    pool.ssh = LoginNodesSsh(key_name=self.head_node.ssh.key_name)[0m
[30;1m2913 | [0m[35m                # If the login node pool allowed IPs is not specified, forces the source allowed IP [0m
[30;1m2914 | [0m[35m                # SSH connection to the one defined in the HeadNode[0m
[30;1m2915 | [0m[35m                if not pool.ssh.allowed_ips:[0m
[30;1m2916 | [0m[35m                    pool.ssh.allowed_ips = self.head_node.ssh.allowed_ips[0m
[30;1m2917 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m445[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2910 | [0m[35m                    pool.ssh.key_name = self.head_node.ssh.key_name[0m
[30;1m2911 | [0m[35m                elif not pool.ssh:[0m
[30;1m2912 | [0m[35m                    pool.ssh = LoginNodesSsh(key_name=self.head_node.ssh.key_name)[0m
[30;1m2913 | [0m[35m                # If the login node pool allowed IPs is not specified, forces the source allowed IP [0m
[30;1m2914 | [0m[35m                # SSH connection to the one defined in the HeadNode[0m
[30;1m2915 | [0m[35m                if not pool.ssh.allowed_ips:[0m
[30;1m2916 | [0m[35m                    pool.ssh.allowed_ips = self.head_node.ssh.allowed_ips[0m

[31m--[ [0m[34mMatch #[0m[33m446[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2910 | [0m[35m                    pool.ssh.key_name = self.head_node.ssh.key_name[0m
[30;1m2911 | [0m[35m                elif not pool.ssh:[0m
[30;1m2912 | [0m[35m                    pool.ssh = LoginNodesSsh(key_name=self.head_node.ssh.key_name)[0m
[30;1m2913 | [0m[35m                # If the login node pool allowed IPs is not specified, forces the source allowed IP [0m
[30;1m2914 | [0m[35m                # SSH connection to the one defined in the HeadNode[0m
[30;1m2915 | [0m[35m                if not pool.ssh.allowed_ips:[0m
[30;1m2916 | [0m[35m                    pool.ssh.allowed_ips = self.head_node.ssh.allowed_ips[0m

[31m--[ [0m[34mMatch #[0m[33m447[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2905 | [0m[35m            # Create a LocalStorage for the LoginNodesPool and ensure that encrypted = true[0m
[30;1m2906 | [0m[35m            for pool in self.login_nodes.pools:[0m
[30;1m2907 | [0m[35m                pool.local_storage = LocalStorage(implied=True)[0m
[30;1m2908 | [0m[35m                # If there's no customer ssh key for LoginNodes pool, set a default value as HeadNod[0m
[30;1m2909 | [0m[35m                if pool.ssh and not pool.ssh.key_name:[0m
[30;1m2910 | [0m[35m                    pool.ssh.key_name = self.head_node.ssh.key_name[0m
[30;1m2911 | [0m[35m                elif not pool.ssh:[0m

[31m--[ [0m[34mMatch #[0m[33m448[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2905 | [0m[35m            # Create a LocalStorage for the LoginNodesPool and ensure that encrypted = true[0m
[30;1m2906 | [0m[35m            for pool in self.login_nodes.pools:[0m
[30;1m2907 | [0m[35m                pool.local_storage = LocalStorage(implied=True)[0m
[30;1m2908 | [0m[35m                # If there's no customer ssh key for LoginNodes pool, set a default value as HeadNod[0m
[30;1m2909 | [0m[35m                if pool.ssh and not pool.ssh.key_name:[0m
[30;1m2910 | [0m[35m                    pool.ssh.key_name = self.head_node.ssh.key_name[0m
[30;1m2911 | [0m[35m                elif not pool.ssh:[0m

[31m--[ [0m[34mMatch #[0m[33m449[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2410 | [0m[35m[0m
[30;1m2411 | [0m[35m    @property[0m
[30;1m2412 | [0m[35m    def architecture(self) -> str:[0m
[30;1m2413 | [0m[35m        """Compute cluster's architecture based on its head node instance type."""[0m
[30;1m2414 | [0m[35m        return self._instance_type_info.supported_architecture()[0][0m
[30;1m2415 | [0m[35m[0m
[30;1m2416 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m450[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2173 | [0m[35m        self._register_validator(FeatureRegionValidator, feature=Feature.BATCH, region=self.region)[0m
[30;1m2174 | [0m[35m        # TODO add InstanceTypesBaseAMICompatibleValidator[0m
[30;1m2175 | [0m[35m[0m
[30;1m2176 | [0m[35m        # Check that all subnets in the cluster (head node subnet included) are in the same VPC and [0m
[30;1m2177 | [0m[35m        self._register_validator([0m
[30;1m2178 | [0m[35m            SubnetsValidator, subnet_ids=self.compute_subnet_ids + [self.head_node.networking.subnet[0m
[30;1m2179 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m451[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2055 | [0m[35m[0m
[30;1m2056 | [0m[35m    @property[0m
[30;1m2057 | [0m[35m    def custom_node_package(self):[0m
[30;1m2058 | [0m[35m        """Return custom node package value or None."""[0m
[30;1m2059 | [0m[35m        return self.dev_settings.node_package if self.dev_settings else None[0m
[30;1m2060 | [0m[35m[0m
[30;1m2061 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m452[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2011 | [0m[35m        Return Security groups by nodes.[0m
[30;1m2012 | [0m[35m[0m
[30;1m2013 | [0m[35m        The result is a set of frozenset,[0m
[30;1m2014 | [0m[35m        e.g. {frozenset(security groups for head node), frozenset(security groups for queue 1), ...}[0m
[30;1m2015 | [0m[35m        """[0m
[30;1m2016 | [0m[35m        head_node_networking = self.head_node.networking[0m
[30;1m2017 | [0m[35m        security_groups_for_head_node = set()[0m

[31m--[ [0m[34mMatch #[0m[33m453[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1862 | [0m[35m[0m
[30;1m1863 | [0m[35m    @property[0m
[30;1m1864 | [0m[35m    def local_mount_dir_instance_types_dict(self):[0m
[30;1m1865 | [0m[35m        """Retrieve a dictionary of local mount dirs and corresponding instance types."""[0m
[30;1m1866 | [0m[35m        mount_dir_instance_types_dict = defaultdict(set)[0m
[30;1m1867 | [0m[35m        if self.head_node.instance_type_info.instance_storage_supported():[0m
[30;1m1868 | [0m[35m            mount_dir_instance_types_dict[[0m

[31m--[ [0m[34mMatch #[0m[33m454[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1853 | [0m[35m[0m
[30;1m1854 | [0m[35m    @property[0m
[30;1m1855 | [0m[35m    def shared_storage_name_mount_dir_tuple_list(self):[0m
[30;1m1856 | [0m[35m        """Retrieve the list of shared storage names and mount dirs."""[0m
[30;1m1857 | [0m[35m        mount_dir_list = [][0m
[30;1m1858 | [0m[35m        if self.shared_storage:[0m
[30;1m1859 | [0m[35m            for storage in self.shared_storage:[0m

[31m--[ [0m[34mMatch #[0m[33m455[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1502 | [0m[35m[0m
[30;1m1503 | [0m[35m    @property[0m
[30;1m1504 | [0m[35m    def instance_profile(self):[0m
[30;1m1505 | [0m[35m        """Return the IAM instance profile for head node, if set."""[0m
[30;1m1506 | [0m[35m        return self.iam.instance_profile if self.iam else None[0m
[30;1m1507 | [0m[35m[0m
[30;1m1508 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m456[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1497 | [0m[35m[0m
[30;1m1498 | [0m[35m    @property[0m
[30;1m1499 | [0m[35m    def instance_role(self):[0m
[30;1m1500 | [0m[35m        """Return the IAM role for head node, if set."""[0m
[30;1m1501 | [0m[35m        return self.iam.instance_role if self.iam else None[0m
[30;1m1502 | [0m[35m[0m
[30;1m1503 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m457[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1485 | [0m[35m[0m
[30;1m1486 | [0m[35m    @property[0m
[30;1m1487 | [0m[35m    def instance_type_info(self) -> InstanceTypeInfo:[0m
[30;1m1488 | [0m[35m        """Return head node instance type information as returned from aws ec2 describe-instance-typ[0m
[30;1m1489 | [0m[35m        if not self.__instance_type_info:[0m
[30;1m1490 | [0m[35m            self.__instance_type_info = AWSApi.instance().ec2.get_instance_type_info(self.instance_t[0m
[30;1m1491 | [0m[35m        return self.__instance_type_info[0m

[31m--[ [0m[34mMatch #[0m[33m458[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1465 | [0m[35m[0m
[30;1m1466 | [0m[35m    @property[0m
[30;1m1467 | [0m[35m    def architecture(self) -> str:[0m
[30;1m1468 | [0m[35m        """Compute cluster's architecture based on its head node instance type."""[0m
[30;1m1469 | [0m[35m        return self.instance_type_info.supported_architecture()[0][0m
[30;1m1470 | [0m[35m[0m
[30;1m1471 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m459[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1447 | [0m[35m            disable_simultaneous_multithreading, default=False[0m
[30;1m1448 | [0m[35m        )[0m
[30;1m1449 | [0m[35m        self.networking = networking[0m
[30;1m1450 | [0m[35m        self.ssh = ssh or HeadNodeSsh(implied=True)[0m
[30;1m1451 | [0m[35m        self.local_storage = local_storage or LocalStorage(implied=True)[0m
[30;1m1452 | [0m[35m        self.shared_storage_type = Resource.init_param([0m
[30;1m1453 | [0m[35m            shared_storage_type,[0m

[31m--[ [0m[34mMatch #[0m[33m460[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1425 | [0m[35m[0m
[30;1m1426 | [0m[35m[0m
[30;1m1427 | [0m[35mclass HeadNode(Resource):[0m
[30;1m1428 | [0m[35m    """Represent the Head Node resource."""[0m
[30;1m1429 | [0m[35m[0m
[30;1m1430 | [0m[35m    def __init__([0m
[30;1m1431 | [0m[35m        self,[0m

[31m--[ [0m[34mMatch #[0m[33m461[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1392 | [0m[35m[0m
[30;1m1393 | [0m[35m    @property[0m
[30;1m1394 | [0m[35m    def instance_type_info(self) -> InstanceTypeInfo:[0m
[30;1m1395 | [0m[35m        """Return login node pool instance type information as returned from aws ec2 describe-instan[0m
[30;1m1396 | [0m[35m        if not self.__instance_type_info:[0m
[30;1m1397 | [0m[35m            self.__instance_type_info = AWSApi.instance().ec2.get_instance_type_info(self.instance_t[0m
[30;1m1398 | [0m[35m        return self.__instance_type_info[0m

[31m--[ [0m[34mMatch #[0m[33m462[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1387 | [0m[35m[0m
[30;1m1388 | [0m[35m    @property[0m
[30;1m1389 | [0m[35m    def architecture(self):[0m
[30;1m1390 | [0m[35m        """Return login node pool architecture based on instance type."""[0m
[30;1m1391 | [0m[35m        return self.instance_type_info.supported_architecture()[0][0m
[30;1m1392 | [0m[35m[0m
[30;1m1393 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m463[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1368 | [0m[35m        self.image = image[0m
[30;1m1369 | [0m[35m        self.networking = networking[0m
[30;1m1370 | [0m[35m        self.count = Resource.init_param(count, default=1)[0m
[30;1m1371 | [0m[35m        self.ssh = ssh[0m
[30;1m1372 | [0m[35m        self.dcv = dcv[0m
[30;1m1373 | [0m[35m        self.custom_actions = custom_actions[0m
[30;1m1374 | [0m[35m        self.iam = iam or LoginNodesIam(implied=True)[0m
[30;1m1375 | [0m[35m        self.gracetime_period = Resource.init_param(gracetime_period, default=10)[0m

[31m--[ [0m[34mMatch #[0m[33m464[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1293 | [0m[35m[0m
[30;1m1294 | [0m[35m[0m
[30;1m1295 | [0m[35mclass CustomAction(Resource):[0m
[30;1m1296 | [0m[35m    """Represent a custom action script resource."""[0m
[30;1m1297 | [0m[35m[0m
[30;1m1298 | [0m[35m    def __init__(self, script: str, args: List[str] = None):[0m
[30;1m1299 | [0m[35m        super().__init__()[0m

[31m--[ [0m[34mMatch #[0m[33m465[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1187 | [0m[35m[0m
[30;1m1188 | [0m[35m[0m
[30;1m1189 | [0m[35mclass Timeouts(Resource):[0m
[30;1m1190 | [0m[35m    """Represent the configuration for node boostrap timeout."""[0m
[30;1m1191 | [0m[35m[0m
[30;1m1192 | [0m[35m    def __init__(self, head_node_bootstrap_timeout: int = None, compute_node_bootstrap_timeout: int [0m
[30;1m1193 | [0m[35m        super().__init__()[0m

[31m--[ [0m[34mMatch #[0m[33m466[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m848 | [0m[35m    def __init__(self, allowed_ips: str = None, **kwargs):[0m
[30;1m849 | [0m[35m        super().__init__(**kwargs)[0m
[30;1m850 | [0m[35m        # If AllowedIPs is not specified for the login node pool, then allowed_ips will default to t[0m
[30;1m851 | [0m[35m        # in the HeadNode to restrict SSH access from a specific CIDR or prefix-list.[0m
[30;1m852 | [0m[35m        self.allowed_ips = Resource.init_param(allowed_ips)[0m
[30;1m853 | [0m[35m[0m
[30;1m854 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m467[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m847 | [0m[35m[0m
[30;1m848 | [0m[35m    def __init__(self, allowed_ips: str = None, **kwargs):[0m
[30;1m849 | [0m[35m        super().__init__(**kwargs)[0m
[30;1m850 | [0m[35m        # If AllowedIPs is not specified for the login node pool, then allowed_ips will default to t[0m
[30;1m851 | [0m[35m        # in the HeadNode to restrict SSH access from a specific CIDR or prefix-list.[0m
[30;1m852 | [0m[35m        self.allowed_ips = Resource.init_param(allowed_ips)[0m
[30;1m853 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m468[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m843 | [0m[35m[0m
[30;1m844 | [0m[35m[0m
[30;1m845 | [0m[35mclass LoginNodesSsh(_BaseSsh):[0m
[30;1m846 | [0m[35m    """Represent the SSH configuration for LoginNodes."""[0m
[30;1m847 | [0m[35m[0m
[30;1m848 | [0m[35m    def __init__(self, allowed_ips: str = None, **kwargs):[0m
[30;1m849 | [0m[35m        super().__init__(**kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m469[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m835 | [0m[35m[0m
[30;1m836 | [0m[35m[0m
[30;1m837 | [0m[35mclass HeadNodeSsh(_BaseSsh):[0m
[30;1m838 | [0m[35m    """Represent the SSH configuration for HeadNode."""[0m
[30;1m839 | [0m[35m[0m
[30;1m840 | [0m[35m    def __init__(self, allowed_ips: str = None, **kwargs):[0m
[30;1m841 | [0m[35m        super().__init__(**kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m470[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m827 | [0m[35m[0m
[30;1m828 | [0m[35m[0m
[30;1m829 | [0m[35mclass _BaseSsh(Resource):[0m
[30;1m830 | [0m[35m    """Represent the base SSH configuration, with the fields in common between all the Ssh."""[0m
[30;1m831 | [0m[35m[0m
[30;1m832 | [0m[35m    def __init__(self, key_name: str = None, **kwargs):[0m
[30;1m833 | [0m[35m        super().__init__(**kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m471[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m742 | [0m[35m[0m
[30;1m743 | [0m[35m[0m
[30;1m744 | [0m[35mclass HeadNodeNetworking(_BaseNetworking):[0m
[30;1m745 | [0m[35m    """Represent the networking configuration for the head node."""[0m
[30;1m746 | [0m[35m[0m
[30;1m747 | [0m[35m    def __init__(self, subnet_id: str, elastic_ip: Union[str, bool] = None, proxy: Proxy = None, **k[0m
[30;1m748 | [0m[35m        super().__init__(**kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m472[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m702 | [0m[35m[0m
[30;1m703 | [0m[35m[0m
[30;1m704 | [0m[35mclass _BaseNetworking(Resource):[0m
[30;1m705 | [0m[35m    """Represent the networking configuration shared by head node and compute node."""[0m
[30;1m706 | [0m[35m[0m
[30;1m707 | [0m[35m    def __init__(self, security_groups: List[str] = None, additional_security_groups: List[str] = No[0m
[30;1m708 | [0m[35m        super().__init__(**kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m473[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m686 | [0m[35m[0m
[30;1m687 | [0m[35m    @property[0m
[30;1m688 | [0m[35m    def file_cache_mount_name(self):[0m
[30;1m689 | [0m[35m        """Return Mount Name of the existing File Cache."""[0m
[30;1m690 | [0m[35m        return AWSApi.instance().fsx.describe_file_caches([self.file_cache_id])[0].mount_name[0m
[30;1m691 | [0m[35m[0m
[30;1m692 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m474[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m284 | [0m[35m[0m
[30;1m285 | [0m[35m[0m
[30;1m286 | [0m[35mclass LocalStorage(Resource):[0m
[30;1m287 | [0m[35m    """Represent the entire node storage configuration."""[0m
[30;1m288 | [0m[35m[0m
[30;1m289 | [0m[35m    def __init__(self, root_volume: RootVolume = None, ephemeral_volume: EphemeralVolume = None, **k[0m
[30;1m290 | [0m[35m        super().__init__(**kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m475[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m262 | [0m[35m            size, EBS_ROOT_VOLUME_SIZE_DEFAULT if get_region().startswith("us-iso") else None[0m
[30;1m263 | [0m[35m        )[0m
[30;1m264 | [0m[35m        # The default delete_on_termination takes effect both on head and compute nodes.[0m
[30;1m265 | [0m[35m        # If the default of the head node is to be changed, please separate this class for different[0m
[30;1m266 | [0m[35m        self.delete_on_termination = Resource.init_param(delete_on_termination, default=True)[0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m476[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m261 | [0m[35m        self.size = Resource.init_param([0m
[30;1m262 | [0m[35m            size, EBS_ROOT_VOLUME_SIZE_DEFAULT if get_region().startswith("us-iso") else None[0m
[30;1m263 | [0m[35m        )[0m
[30;1m264 | [0m[35m        # The default delete_on_termination takes effect both on head and compute nodes.[0m
[30;1m265 | [0m[35m        # If the default of the head node is to be changed, please separate this class for different[0m
[30;1m266 | [0m[35m        self.delete_on_termination = Resource.init_param(delete_on_termination, default=True)[0m
[30;1m267 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m477[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2838 | [0m[35m[0m
[30;1m2839 | [0m[35m[0m
[30;1m2840 | [0m[35mclass QueueUpdateStrategy(Enum):[0m
[30;1m2841 | [0m[35m    """Enum to identify the update strategy supported by the queue."""[0m
[30;1m2842 | [0m[35m[0m
[30;1m2843 | [0m[35m    DRAIN = "DRAIN"[0m
[30;1m2844 | [0m[35m    COMPUTE_FLEET_STOP = "COMPUTE_FLEET_STOP"[0m

[31m--[ [0m[34mMatch #[0m[33m478[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/cluster_config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m479[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/resource_groups.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m480[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/resource_groups.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m38 | [0m[35m    @Cache.cached[0m
[30;1m39 | [0m[35m    def get_group_configuration(self, group):[0m
[30;1m40 | [0m[35m        """Return the group config or throw an exception if not a Service Linked Group."""[0m
[30;1m41 | [0m[35m        return self._client.get_group_configuration(Group=group)[0m

[31m--[ [0m[34mMatch #[0m[33m481[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/iam.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m482[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/imagebuilder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m    def get_image_id(self, image_arn):[0m
[30;1m22 | [0m[35m        """Retrieve image id by image arn."""[0m
[30;1m23 | [0m[35m        ami_list = self.get_image_resources(image_arn).get("image", {}).get("outputResources", {}).g[0m
[30;1m24 | [0m[35m        return ami_list[0].get("image") if ami_list else None[0m

[31m--[ [0m[34mMatch #[0m[33m483[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/imagebuilder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m21 | [0m[35m    def get_image_id(self, image_arn):[0m
[30;1m22 | [0m[35m        """Retrieve image id by image arn."""[0m
[30;1m23 | [0m[35m        ami_list = self.get_image_resources(image_arn).get("image", {}).get("outputResources", {}).g[0m
[30;1m24 | [0m[35m        return ami_list[0].get("image") if ami_list else None[0m

[31m--[ [0m[34mMatch #[0m[33m484[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/imagebuilder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m21 | [0m[35m    def get_image_id(self, image_arn):[0m
[30;1m22 | [0m[35m        """Retrieve image id by image arn."""[0m
[30;1m23 | [0m[35m        ami_list = self.get_image_resources(image_arn).get("image", {}).get("outputResources", {}).g[0m
[30;1m24 | [0m[35m        return ami_list[0].get("image") if ami_list else None[0m

[31m--[ [0m[34mMatch #[0m[33m485[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/imagebuilder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m21 | [0m[35m    def get_image_id(self, image_arn):[0m
[30;1m22 | [0m[35m        """Retrieve image id by image arn."""[0m
[30;1m23 | [0m[35m        ami_list = self.get_image_resources(image_arn).get("image", {}).get("outputResources", {}).g[0m
[30;1m24 | [0m[35m        return ami_list[0].get("image") if ami_list else None[0m

[31m--[ [0m[34mMatch #[0m[33m486[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/imagebuilder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m16 | [0m[35m    def get_image_state(self, image_arn):[0m
[30;1m17 | [0m[35m        """Get image state by ami arn."""[0m
[30;1m18 | [0m[35m        return self.get_image_resources(image_arn).get("image", {}).get("state", {})[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m21 | [0m[35m    def get_image_id(self, image_arn):[0m

[31m--[ [0m[34mMatch #[0m[33m487[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/imagebuilder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m16 | [0m[35m    def get_image_state(self, image_arn):[0m
[30;1m17 | [0m[35m        """Get image state by ami arn."""[0m
[30;1m18 | [0m[35m        return self.get_image_resources(image_arn).get("image", {}).get("state", {})[0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m21 | [0m[35m    def get_image_id(self, image_arn):[0m

[31m--[ [0m[34mMatch #[0m[33m488[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/entrypoint.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m            subparser.add_argument([0m
[30;1m179 | [0m[35m                *arg_name,[0m
[30;1m180 | [0m[35m                required=param.get("required", False),[0m
[30;1m181 | [0m[35m                choices=param.get("enum", None),[0m
[30;1m182 | [0m[35m                nargs="+" if "multi" in param else None,[0m
[30;1m183 | [0m[35m                type=param_coerce(param),[0m
[30;1m184 | [0m[35m                help=help,[0m

[31m--[ [0m[34mMatch #[0m[33m489[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/entrypoint.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m177 | [0m[35m            # add the parameter to the parser based on type from model / specification[0m
[30;1m178 | [0m[35m            subparser.add_argument([0m
[30;1m179 | [0m[35m                *arg_name,[0m
[30;1m180 | [0m[35m                required=param.get("required", False),[0m
[30;1m181 | [0m[35m                choices=param.get("enum", None),[0m
[30;1m182 | [0m[35m                nargs="+" if "multi" in param else None,[0m
[30;1m183 | [0m[35m                type=param_coerce(param),[0m

[31m--[ [0m[34mMatch #[0m[33m490[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/entrypoint.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m        parser_map[op_name] = subparser[0m
[30;1m161 | [0m[35m[0m
[30;1m162 | [0m[35m        for param in operation["params"]:[0m
[30;1m163 | [0m[35m            help = param.get("description", "")[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m            abbrev_args = {[0m
[30;1m166 | [0m[35m                "cluster-name": "-n",[0m

[31m--[ [0m[34mMatch #[0m[33m491[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/entrypoint.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m    # Add each operation as it's onn parser with params / body as arguments[0m
[30;1m157 | [0m[35m    for op_name, operation in model.items():[0m
[30;1m158 | [0m[35m        op_help = operation.get("description", f"{op_name} command help")[0m
[30;1m159 | [0m[35m        subparser = subparsers.add_parser(op_name, help=op_help, description=op_help)[0m
[30;1m160 | [0m[35m        parser_map[op_name] = subparser[0m
[30;1m161 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m492[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/entrypoint.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35m    # handle regexp parameter validation (or perform type coercion)[0m
[30;1m135 | [0m[35m    if "pattern" in param:[0m
[30;1m136 | [0m[35m        coerce_fn = partial(re_validator, param["pattern"], param["name"])[0m
[30;1m137 | [0m[35m    elif param.get("type") in type_map:[0m
[30;1m138 | [0m[35m        coerce_fn = partial(type_map[param["type"]], param["name"])[0m
[30;1m139 | [0m[35m    else:[0m
[30;1m140 | [0m[35m        coerce_fn = identity[0m

[31m--[ [0m[34mMatch #[0m[33m493[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/entrypoint.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m            kwargs[param_name] = value[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m    kwargs.update(args_in)[0m
[30;1m95 | [0m[35m    body_name = model[op_name].get("body_name")[0m
[30;1m96 | [0m[35m    if body_name:[0m
[30;1m97 | [0m[35m        kwargs[body_name] = body[0m
[30;1m98 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m494[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/entrypoint.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m3 | [0m[35m#[0m
[30;1m4 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not[0m
[30;1m5 | [0m[35m# use this file except in compliance with the License. A copy of the License is[0m
[30;1m6 | [0m[35m# located at[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m9 | [0m[35m#[0m
[30;1m10 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed[0m

[31m--[ [0m[34mMatch #[0m[33m495[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/entrypoint.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m238 | [0m[35m    add_cli_commands(parser_map)[0m
[30;1m239 | [0m[35m    args, extra_args = parser.parse_known_args(sys_args)[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m    # some commands (e.g. ssh and those defined as CliCommand objects) require 'extra_args'[0m
[30;1m242 | [0m[35m    if extra_args and (not hasattr(args, "expects_extra_args") or not args.expects_extra_args):[0m
[30;1m243 | [0m[35m        parser.print_usage()[0m
[30;1m244 | [0m[35m        print(f"Invalid arguments {extra_args}")[0m

[31m--[ [0m[34mMatch #[0m[33m496[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/entrypoint.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35mimport argparse[0m
[30;1m24 | [0m[35mfrom botocore.exceptions import NoCredentialsError  # TODO: remove[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m# Suppress JSII warnings for Node version[0m
[30;1m27 | [0m[35mos.environ["JSII_SILENCE_WARNING_KNOWN_BROKEN_NODE_VERSION"] = "1"[0m
[30;1m28 | [0m[35mos.environ["JSII_SILENCE_WARNING_UNTESTED_NODE_VERSION"] = "1"[0m
[30;1m29 | [0m[35mos.environ["JSII_SILENCE_WARNING_DEPRECATED_NODE_VERSION"] = "1"[0m

[31m--[ [0m[34mMatch #[0m[33m497[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m498[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/imagebuilder_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m892 | [0m[35m                if custom_component.type == "script" and utils.get_url_scheme(custom_component.value[0m
[30;1m893 | [0m[35m                    bucket_info = parse_bucket_url(custom_component.value)[0m
[30;1m894 | [0m[35m                    bucket_name = bucket_info.get("bucket_name")[0m
[30;1m895 | [0m[35m                    object_key = bucket_info.get("object_key")[0m
[30;1m896 | [0m[35m                    instancerole_policy_document.add_statements([0m
[30;1m897 | [0m[35m                        iam.PolicyStatement([0m
[30;1m898 | [0m[35m                            actions=["s3:GetObject"],[0m

[31m--[ [0m[34mMatch #[0m[33m499[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/imagebuilder_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m891 | [0m[35m                # Check custom component is script, and the url is S3 url[0m
[30;1m892 | [0m[35m                if custom_component.type == "script" and utils.get_url_scheme(custom_component.value[0m
[30;1m893 | [0m[35m                    bucket_info = parse_bucket_url(custom_component.value)[0m
[30;1m894 | [0m[35m                    bucket_name = bucket_info.get("bucket_name")[0m
[30;1m895 | [0m[35m                    object_key = bucket_info.get("object_key")[0m
[30;1m896 | [0m[35m                    instancerole_policy_document.add_statements([0m
[30;1m897 | [0m[35m                        iam.PolicyStatement([0m

[31m--[ [0m[34mMatch #[0m[33m500[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/imagebuilder_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m227 | [0m[35m                and json.loads(self.config.dev_settings.cookbook.extra_chef_attributes).get("cluster[0m
[30;1m228 | [0m[35m                and json.loads(self.config.dev_settings.cookbook.extra_chef_attributes)[0m
[30;1m229 | [0m[35m                .get("cluster")[0m
[30;1m230 | [0m[35m                .get("is_official_ami_build")[0m
[30;1m231 | [0m[35m                else "false"[0m
[30;1m232 | [0m[35m            ),[0m
[30;1m233 | [0m[35m            description="IsOfficialAmiBuild",[0m

[31m--[ [0m[34mMatch #[0m[33m501[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/imagebuilder_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m226 | [0m[35m                and self.config.dev_settings.cookbook.extra_chef_attributes[0m
[30;1m227 | [0m[35m                and json.loads(self.config.dev_settings.cookbook.extra_chef_attributes).get("cluster[0m
[30;1m228 | [0m[35m                and json.loads(self.config.dev_settings.cookbook.extra_chef_attributes)[0m
[30;1m229 | [0m[35m                .get("cluster")[0m
[30;1m230 | [0m[35m                .get("is_official_ami_build")[0m
[30;1m231 | [0m[35m                else "false"[0m
[30;1m232 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m502[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/imagebuilder_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m224 | [0m[35m                if self.config.dev_settings[0m
[30;1m225 | [0m[35m                and self.config.dev_settings.cookbook[0m
[30;1m226 | [0m[35m                and self.config.dev_settings.cookbook.extra_chef_attributes[0m
[30;1m227 | [0m[35m                and json.loads(self.config.dev_settings.cookbook.extra_chef_attributes).get("cluster[0m
[30;1m228 | [0m[35m                and json.loads(self.config.dev_settings.cookbook.extra_chef_attributes)[0m
[30;1m229 | [0m[35m                .get("cluster")[0m
[30;1m230 | [0m[35m                .get("is_official_ami_build")[0m

[31m--[ [0m[34mMatch #[0m[33m503[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/imagebuilder_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m220 | [0m[35m            default=([0m
[30;1m221 | [0m[35m                json.loads(self.config.dev_settings.cookbook.extra_chef_attributes)[0m
[30;1m222 | [0m[35m                .get("cluster")[0m
[30;1m223 | [0m[35m                .get("is_official_ami_build")[0m
[30;1m224 | [0m[35m                if self.config.dev_settings[0m
[30;1m225 | [0m[35m                and self.config.dev_settings.cookbook[0m
[30;1m226 | [0m[35m                and self.config.dev_settings.cookbook.extra_chef_attributes[0m

[31m--[ [0m[34mMatch #[0m[33m504[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/imagebuilder_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m219 | [0m[35m            type="String",[0m
[30;1m220 | [0m[35m            default=([0m
[30;1m221 | [0m[35m                json.loads(self.config.dev_settings.cookbook.extra_chef_attributes)[0m
[30;1m222 | [0m[35m                .get("cluster")[0m
[30;1m223 | [0m[35m                .get("is_official_ami_build")[0m
[30;1m224 | [0m[35m                if self.config.dev_settings[0m
[30;1m225 | [0m[35m                and self.config.dev_settings.cookbook[0m

[31m--[ [0m[34mMatch #[0m[33m505[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/imagebuilder_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m            {"key": PCLUSTER_IMAGE_CONFIG_TAG, "value": self.bucket.get_config_s3_url("image-config.[0m
[30;1m145 | [0m[35m        ][0m
[30;1m146 | [0m[35m        for tag in tag_list:[0m
[30;1m147 | [0m[35m            image_tags.append(BaseTag(key=tag.get("key"), value=tag.get("value")))[0m
[30;1m148 | [0m[35m        return {tag.key: tag.value for tag in image_tags}[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m    def _get_distribution_regions(self) -> set:[0m

[31m--[ [0m[34mMatch #[0m[33m506[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/imagebuilder_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m            {"key": PCLUSTER_IMAGE_CONFIG_TAG, "value": self.bucket.get_config_s3_url("image-config.[0m
[30;1m145 | [0m[35m        ][0m
[30;1m146 | [0m[35m        for tag in tag_list:[0m
[30;1m147 | [0m[35m            image_tags.append(BaseTag(key=tag.get("key"), value=tag.get("value")))[0m
[30;1m148 | [0m[35m        return {tag.key: tag.value for tag in image_tags}[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m    def _get_distribution_regions(self) -> set:[0m

[31m--[ [0m[34mMatch #[0m[33m507[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/imagebuilder_stack.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m508[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/imagebuilder_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m995 | [0m[35m                        IMAGEBUILDER_RESOURCE_NAME_PREFIX + "-Script-{0}".format(str(custom_componen[0m
[30;1m996 | [0m[35m                    ),[0m
[30;1m997 | [0m[35m                    version=utils.get_installed_version(base_version_only=True),[0m
[30;1m998 | [0m[35m                    description="This component is custom component for script, script name is {0}, [0m
[30;1m999 | [0m[35m                    "{1}".format(component_script_name, custom_component.value),[0m
[30;1m1000 | [0m[35m                    platform="Linux",[0m
[30;1m1001 | [0m[35m                    data=Fn.sub(wrap_script_to_component(custom_component.value)),[0m

[31m--[ [0m[34mMatch #[0m[33m509[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/imagebuilder_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m995 | [0m[35m                        IMAGEBUILDER_RESOURCE_NAME_PREFIX + "-Script-{0}".format(str(custom_componen[0m
[30;1m996 | [0m[35m                    ),[0m
[30;1m997 | [0m[35m                    version=utils.get_installed_version(base_version_only=True),[0m
[30;1m998 | [0m[35m                    description="This component is custom component for script, script name is {0}, [0m
[30;1m999 | [0m[35m                    "{1}".format(component_script_name, custom_component.value),[0m
[30;1m1000 | [0m[35m                    platform="Linux",[0m
[30;1m1001 | [0m[35m                    data=Fn.sub(wrap_script_to_component(custom_component.value)),[0m

[31m--[ [0m[34mMatch #[0m[33m510[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/sts.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m21 | [0m[35m    @Cache.cached[0m
[30;1m22 | [0m[35m    def get_account_id(self):[0m
[30;1m23 | [0m[35m        """Get account id by get_caller_identity."""[0m
[30;1m24 | [0m[35m        return self._client.get_caller_identity().get("Account")[0m

[31m--[ [0m[34mMatch #[0m[33m511[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/sts.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m512[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1992 | [0m[35m    @post_load(pass_original=True)[0m
[30;1m1993 | [0m[35m    def make_resource(self, data, original_data, **kwargs):[0m
[30;1m1994 | [0m[35m        """Generate cluster according to the scheduler. Save original configuration."""[0m
[30;1m1995 | [0m[35m        scheduler = data.get("scheduling").scheduler[0m
[30;1m1996 | [0m[35m        if scheduler == "slurm":[0m
[30;1m1997 | [0m[35m            cluster = SlurmClusterConfig(cluster_name=self.cluster_name, **data)[0m
[30;1m1998 | [0m[35m        elif scheduler == "awsbatch":[0m

[31m--[ [0m[34mMatch #[0m[33m513[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1986 | [0m[35m                raise ValidationError(error_message.format("IntelSoftware"))[0m
[30;1m1987 | [0m[35m            if head_node.custom_actions and head_node.custom_actions.on_node_updated:[0m
[30;1m1988 | [0m[35m                raise ValidationError(error_message.format("OnNodeUpdated"))[0m
[30;1m1989 | [0m[35m            if data.get("directory_service"):[0m
[30;1m1990 | [0m[35m                raise ValidationError(error_message.format("DirectoryService"))[0m
[30;1m1991 | [0m[35m[0m
[30;1m1992 | [0m[35m    @post_load(pass_original=True)[0m

[31m--[ [0m[34mMatch #[0m[33m514[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1977 | [0m[35m        head_node = data.get("head_node")[0m
[30;1m1978 | [0m[35m        if scheduling and scheduling.scheduler == "awsbatch":[0m
[30;1m1979 | [0m[35m            error_message = "The use of the {} configuration is not supported when using awsbatch as[0m
[30;1m1980 | [0m[35m            additional_packages = data.get("additional_packages")[0m
[30;1m1981 | [0m[35m            if ([0m
[30;1m1982 | [0m[35m                additional_packages[0m
[30;1m1983 | [0m[35m                and additional_packages.intel_software[0m

[31m--[ [0m[34mMatch #[0m[33m515[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1974 | [0m[35m    def no_settings_for_batch(self, data, **kwargs):[0m
[30;1m1975 | [0m[35m        """Ensure IntelSoftware and DirectoryService section is not included when AWS Batch is the s[0m
[30;1m1976 | [0m[35m        scheduling = data.get("scheduling")[0m
[30;1m1977 | [0m[35m        head_node = data.get("head_node")[0m
[30;1m1978 | [0m[35m        if scheduling and scheduling.scheduler == "awsbatch":[0m
[30;1m1979 | [0m[35m            error_message = "The use of the {} configuration is not supported when using awsbatch as[0m
[30;1m1980 | [0m[35m            additional_packages = data.get("additional_packages")[0m

[31m--[ [0m[34mMatch #[0m[33m516[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1973 | [0m[35m    @validates_schema[0m
[30;1m1974 | [0m[35m    def no_settings_for_batch(self, data, **kwargs):[0m
[30;1m1975 | [0m[35m        """Ensure IntelSoftware and DirectoryService section is not included when AWS Batch is the s[0m
[30;1m1976 | [0m[35m        scheduling = data.get("scheduling")[0m
[30;1m1977 | [0m[35m        head_node = data.get("head_node")[0m
[30;1m1978 | [0m[35m        if scheduling and scheduling.scheduler == "awsbatch":[0m
[30;1m1979 | [0m[35m            error_message = "The use of the {} configuration is not supported when using awsbatch as[0m

[31m--[ [0m[34mMatch #[0m[33m517[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1881 | [0m[35m        if scheduler == "awsbatch":[0m
[30;1m1882 | [0m[35m            # scaling_strategy is ignored by AWS Batch plugin[0m
[30;1m1883 | [0m[35m            return AwsBatchScheduling([0m
[30;1m1884 | [0m[35m                queues=data.get("aws_batch_queues"), settings=data.get("aws_batch_settings", None)[0m
[30;1m1885 | [0m[35m            )[0m
[30;1m1886 | [0m[35m        return None[0m
[30;1m1887 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m518[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1881 | [0m[35m        if scheduler == "awsbatch":[0m
[30;1m1882 | [0m[35m            # scaling_strategy is ignored by AWS Batch plugin[0m
[30;1m1883 | [0m[35m            return AwsBatchScheduling([0m
[30;1m1884 | [0m[35m                queues=data.get("aws_batch_queues"), settings=data.get("aws_batch_settings", None)[0m
[30;1m1885 | [0m[35m            )[0m
[30;1m1886 | [0m[35m        return None[0m
[30;1m1887 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m519[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1876 | [0m[35m            return SlurmScheduling([0m
[30;1m1877 | [0m[35m                queues=data.get("slurm_queues"),[0m
[30;1m1878 | [0m[35m                settings=data.get("slurm_settings", None),[0m
[30;1m1879 | [0m[35m                scaling_strategy=data.get("scaling_strategy", None),[0m
[30;1m1880 | [0m[35m            )[0m
[30;1m1881 | [0m[35m        if scheduler == "awsbatch":[0m
[30;1m1882 | [0m[35m            # scaling_strategy is ignored by AWS Batch plugin[0m

[31m--[ [0m[34mMatch #[0m[33m520[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1875 | [0m[35m        if scheduler == "slurm":[0m
[30;1m1876 | [0m[35m            return SlurmScheduling([0m
[30;1m1877 | [0m[35m                queues=data.get("slurm_queues"),[0m
[30;1m1878 | [0m[35m                settings=data.get("slurm_settings", None),[0m
[30;1m1879 | [0m[35m                scaling_strategy=data.get("scaling_strategy", None),[0m
[30;1m1880 | [0m[35m            )[0m
[30;1m1881 | [0m[35m        if scheduler == "awsbatch":[0m

[31m--[ [0m[34mMatch #[0m[33m521[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1874 | [0m[35m        scheduler = data.get("scheduler")[0m
[30;1m1875 | [0m[35m        if scheduler == "slurm":[0m
[30;1m1876 | [0m[35m            return SlurmScheduling([0m
[30;1m1877 | [0m[35m                queues=data.get("slurm_queues"),[0m
[30;1m1878 | [0m[35m                settings=data.get("slurm_settings", None),[0m
[30;1m1879 | [0m[35m                scaling_strategy=data.get("scaling_strategy", None),[0m
[30;1m1880 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m522[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1871 | [0m[35m    @post_load[0m
[30;1m1872 | [0m[35m    def make_resource(self, data, **kwargs):[0m
[30;1m1873 | [0m[35m        """Generate the right type of scheduling according to the child type (Slurm vs AwsBatch vs C[0m
[30;1m1874 | [0m[35m        scheduler = data.get("scheduler")[0m
[30;1m1875 | [0m[35m        if scheduler == "slurm":[0m
[30;1m1876 | [0m[35m            return SlurmScheduling([0m
[30;1m1877 | [0m[35m                queues=data.get("slurm_queues"),[0m

[31m--[ [0m[34mMatch #[0m[33m523[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1858 | [0m[35m            ("slurm", "slurm_settings", "slurm_queues"),[0m
[30;1m1859 | [0m[35m        ]:[0m
[30;1m1860 | [0m[35m            # Verify the settings section is associated to the right scheduler type[0m
[30;1m1861 | [0m[35m            configured_scheduler = data.get("scheduler")[0m
[30;1m1862 | [0m[35m            if settings in data and scheduler != configured_scheduler:[0m
[30;1m1863 | [0m[35m                raise ValidationError([0m
[30;1m1864 | [0m[35m                    f"Scheduling > *Settings section is not appropriate to the Scheduler: {configure[0m

[31m--[ [0m[34mMatch #[0m[33m524[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1840 | [0m[35m    @validates_schema[0m
[30;1m1841 | [0m[35m    def no_coexist_schedulers(self, data, **kwargs):[0m
[30;1m1842 | [0m[35m        """Validate that *_settings and *_queues for different schedulers do not co-exist."""[0m
[30;1m1843 | [0m[35m        scheduler = data.get("scheduler")[0m
[30;1m1844 | [0m[35m        if self.fields_coexist(data, ["aws_batch_settings", "slurm_settings"], **kwargs):[0m
[30;1m1845 | [0m[35m            raise ValidationError("Multiple *Settings sections cannot be specified in the Scheduling[0m
[30;1m1846 | [0m[35m        if self.fields_coexist(data, ["aws_batch_queues", "slurm_queues"], one_required=True, **kwar[0m

[31m--[ [0m[34mMatch #[0m[33m525[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1600 | [0m[35m    @post_load[0m
[30;1m1601 | [0m[35m    def make_resource(self, data, **kwargs):[0m
[30;1m1602 | [0m[35m        """Generate resource."""[0m
[30;1m1603 | [0m[35m        if data.get("instances"):[0m
[30;1m1604 | [0m[35m            return SlurmFlexibleComputeResource(**data)[0m
[30;1m1605 | [0m[35m        return SlurmComputeResource(**data)[0m
[30;1m1606 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m526[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1573 | [0m[35m            capacity_reservation_id = ([0m
[30;1m1574 | [0m[35m                capacity_reservation_target.capacity_reservation_id if capacity_reservation_target e[0m
[30;1m1575 | [0m[35m            )[0m
[30;1m1576 | [0m[35m            if not data.get("instance_type") and not capacity_reservation_id:[0m
[30;1m1577 | [0m[35m                raise ValidationError([0m
[30;1m1578 | [0m[35m                    "A Compute Resource needs to specify Instances, InstanceType or CapacityReservat[0m
[30;1m1579 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m527[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1569 | [0m[35m    def instance_type_declaration(self, data, **kwargs):[0m
[30;1m1570 | [0m[35m        """Validate that 'instance_type' is specified, directly or through capacity reservation id."[0m
[30;1m1571 | [0m[35m        if not data.get("instances"):[0m
[30;1m1572 | [0m[35m            capacity_reservation_target = data.get("capacity_reservation_target")[0m
[30;1m1573 | [0m[35m            capacity_reservation_id = ([0m
[30;1m1574 | [0m[35m                capacity_reservation_target.capacity_reservation_id if capacity_reservation_target e[0m
[30;1m1575 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m528[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1568 | [0m[35m    @validates_schema[0m
[30;1m1569 | [0m[35m    def instance_type_declaration(self, data, **kwargs):[0m
[30;1m1570 | [0m[35m        """Validate that 'instance_type' is specified, directly or through capacity reservation id."[0m
[30;1m1571 | [0m[35m        if not data.get("instances"):[0m
[30;1m1572 | [0m[35m            capacity_reservation_target = data.get("capacity_reservation_target")[0m
[30;1m1573 | [0m[35m            capacity_reservation_id = ([0m
[30;1m1574 | [0m[35m                capacity_reservation_target.capacity_reservation_id if capacity_reservation_target e[0m

[31m--[ [0m[34mMatch #[0m[33m529[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1239 | [0m[35m[0m
[30;1m1240 | [0m[35m    def __init__(self, **kwargs):[0m
[30;1m1241 | [0m[35m        schema = self._build_dynamic_schema_class([0m
[30;1m1242 | [0m[35m            kwargs.get("metadata", {}).get("update_policy", UpdatePolicy.UNSUPPORTED)[0m
[30;1m1243 | [0m[35m        )[0m
[30;1m1244 | [0m[35m        super().__init__(schema, **kwargs)[0m
[30;1m1245 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m530[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1239 | [0m[35m[0m
[30;1m1240 | [0m[35m    def __init__(self, **kwargs):[0m
[30;1m1241 | [0m[35m        schema = self._build_dynamic_schema_class([0m
[30;1m1242 | [0m[35m            kwargs.get("metadata", {}).get("update_policy", UpdatePolicy.UNSUPPORTED)[0m
[30;1m1243 | [0m[35m        )[0m
[30;1m1244 | [0m[35m        super().__init__(schema, **kwargs)[0m
[30;1m1245 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m531[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m634 | [0m[35m        # Restore storage type attribute[0m
[30;1m635 | [0m[35m        if adapted_data.shared_storage_type == "fsx":[0m
[30;1m636 | [0m[35m            mapping = {LUSTRE: FSX_LUSTRE, OPENZFS: FSX_OPENZFS, ONTAP: FSX_ONTAP, FILECACHE: FILE_C[0m
[30;1m637 | [0m[35m            adapted_data.storage_type = mapping.get(adapted_data.file_system_type)[0m
[30;1m638 | [0m[35m        else:[0m
[30;1m639 | [0m[35m            adapted_data.storage_type = storage_type.capitalize()[0m
[30;1m640 | [0m[35m        return adapted_data[0m

[31m--[ [0m[34mMatch #[0m[33m532[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m627 | [0m[35m                ONTAP: "fsx_ontap",[0m
[30;1m628 | [0m[35m                FILECACHE: "file_cache_settings",[0m
[30;1m629 | [0m[35m            }[0m
[30;1m630 | [0m[35m            storage_type = mapping.get(adapted_data.file_system_type)[0m
[30;1m631 | [0m[35m        else:  # "raid", "ebs"[0m
[30;1m632 | [0m[35m            storage_type = "ebs"[0m
[30;1m633 | [0m[35m        setattr(adapted_data, f"{storage_type}_settings", copy.copy(adapted_data))[0m

[31m--[ [0m[34mMatch #[0m[33m533[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m595 | [0m[35m            or data.get("fsx_lustre_settings", None)[0m
[30;1m596 | [0m[35m            or data.get("fsx_open_zfs_settings", None)[0m
[30;1m597 | [0m[35m            or data.get("fsx_ontap_settings", None)[0m
[30;1m598 | [0m[35m            or data.get("file_cache_settings", None)[0m
[30;1m599 | [0m[35m        )[0m
[30;1m600 | [0m[35m        if settings:[0m
[30;1m601 | [0m[35m            shared_volume_attributes.update(**settings)[0m

[31m--[ [0m[34mMatch #[0m[33m534[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m594 | [0m[35m            or data.get("ebs_settings", None)[0m
[30;1m595 | [0m[35m            or data.get("fsx_lustre_settings", None)[0m
[30;1m596 | [0m[35m            or data.get("fsx_open_zfs_settings", None)[0m
[30;1m597 | [0m[35m            or data.get("fsx_ontap_settings", None)[0m
[30;1m598 | [0m[35m            or data.get("file_cache_settings", None)[0m
[30;1m599 | [0m[35m        )[0m
[30;1m600 | [0m[35m        if settings:[0m

[31m--[ [0m[34mMatch #[0m[33m535[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m593 | [0m[35m            data.get("efs_settings", None)[0m
[30;1m594 | [0m[35m            or data.get("ebs_settings", None)[0m
[30;1m595 | [0m[35m            or data.get("fsx_lustre_settings", None)[0m
[30;1m596 | [0m[35m            or data.get("fsx_open_zfs_settings", None)[0m
[30;1m597 | [0m[35m            or data.get("fsx_ontap_settings", None)[0m
[30;1m598 | [0m[35m            or data.get("file_cache_settings", None)[0m
[30;1m599 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m536[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m592 | [0m[35m        settings = ([0m
[30;1m593 | [0m[35m            data.get("efs_settings", None)[0m
[30;1m594 | [0m[35m            or data.get("ebs_settings", None)[0m
[30;1m595 | [0m[35m            or data.get("fsx_lustre_settings", None)[0m
[30;1m596 | [0m[35m            or data.get("fsx_open_zfs_settings", None)[0m
[30;1m597 | [0m[35m            or data.get("fsx_ontap_settings", None)[0m
[30;1m598 | [0m[35m            or data.get("file_cache_settings", None)[0m

[31m--[ [0m[34mMatch #[0m[33m537[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m591 | [0m[35m        shared_volume_attributes = {"mount_dir": data.get("mount_dir"), "name": data.get("name")}[0m
[30;1m592 | [0m[35m        settings = ([0m
[30;1m593 | [0m[35m            data.get("efs_settings", None)[0m
[30;1m594 | [0m[35m            or data.get("ebs_settings", None)[0m
[30;1m595 | [0m[35m            or data.get("fsx_lustre_settings", None)[0m
[30;1m596 | [0m[35m            or data.get("fsx_open_zfs_settings", None)[0m
[30;1m597 | [0m[35m            or data.get("fsx_ontap_settings", None)[0m

[31m--[ [0m[34mMatch #[0m[33m538[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m590 | [0m[35m        storage_type = data.get("storage_type")[0m
[30;1m591 | [0m[35m        shared_volume_attributes = {"mount_dir": data.get("mount_dir"), "name": data.get("name")}[0m
[30;1m592 | [0m[35m        settings = ([0m
[30;1m593 | [0m[35m            data.get("efs_settings", None)[0m
[30;1m594 | [0m[35m            or data.get("ebs_settings", None)[0m
[30;1m595 | [0m[35m            or data.get("fsx_lustre_settings", None)[0m
[30;1m596 | [0m[35m            or data.get("fsx_open_zfs_settings", None)[0m

[31m--[ [0m[34mMatch #[0m[33m539[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m588 | [0m[35m    def make_resource(self, data, **kwargs):[0m
[30;1m589 | [0m[35m        """Generate the right type of shared storage according to the child type (EBS vs EFS vs FsxL[0m
[30;1m590 | [0m[35m        storage_type = data.get("storage_type")[0m
[30;1m591 | [0m[35m        shared_volume_attributes = {"mount_dir": data.get("mount_dir"), "name": data.get("name")}[0m
[30;1m592 | [0m[35m        settings = ([0m
[30;1m593 | [0m[35m            data.get("efs_settings", None)[0m
[30;1m594 | [0m[35m            or data.get("ebs_settings", None)[0m

[31m--[ [0m[34mMatch #[0m[33m540[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m588 | [0m[35m    def make_resource(self, data, **kwargs):[0m
[30;1m589 | [0m[35m        """Generate the right type of shared storage according to the child type (EBS vs EFS vs FsxL[0m
[30;1m590 | [0m[35m        storage_type = data.get("storage_type")[0m
[30;1m591 | [0m[35m        shared_volume_attributes = {"mount_dir": data.get("mount_dir"), "name": data.get("name")}[0m
[30;1m592 | [0m[35m        settings = ([0m
[30;1m593 | [0m[35m            data.get("efs_settings", None)[0m
[30;1m594 | [0m[35m            or data.get("ebs_settings", None)[0m

[31m--[ [0m[34mMatch #[0m[33m541[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m587 | [0m[35m    @post_load[0m
[30;1m588 | [0m[35m    def make_resource(self, data, **kwargs):[0m
[30;1m589 | [0m[35m        """Generate the right type of shared storage according to the child type (EBS vs EFS vs FsxL[0m
[30;1m590 | [0m[35m        storage_type = data.get("storage_type")[0m
[30;1m591 | [0m[35m        shared_volume_attributes = {"mount_dir": data.get("mount_dir"), "name": data.get("name")}[0m
[30;1m592 | [0m[35m        settings = ([0m
[30;1m593 | [0m[35m            data.get("efs_settings", None)[0m

[31m--[ [0m[34mMatch #[0m[33m542[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m581 | [0m[35m            if data.get(settings, None) and storage_type != data.get("storage_type"):[0m
[30;1m582 | [0m[35m                raise ValidationError([0m
[30;1m583 | [0m[35m                    "SharedStorage > *Settings section is not appropriate to the "[0m
[30;1m584 | [0m[35m                    f"StorageType {data.get('storage_type')}."[0m
[30;1m585 | [0m[35m                )[0m
[30;1m586 | [0m[35m[0m
[30;1m587 | [0m[35m    @post_load[0m

[31m--[ [0m[34mMatch #[0m[33m543[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m578 | [0m[35m            (FILE_CACHE, "file_cache_settings"),[0m
[30;1m579 | [0m[35m        ]:[0m
[30;1m580 | [0m[35m            # Verify the settings section is associated to the right storage type[0m
[30;1m581 | [0m[35m            if data.get(settings, None) and storage_type != data.get("storage_type"):[0m
[30;1m582 | [0m[35m                raise ValidationError([0m
[30;1m583 | [0m[35m                    "SharedStorage > *Settings section is not appropriate to the "[0m
[30;1m584 | [0m[35m                    f"StorageType {data.get('storage_type')}."[0m

[31m--[ [0m[34mMatch #[0m[33m544[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m578 | [0m[35m            (FILE_CACHE, "file_cache_settings"),[0m
[30;1m579 | [0m[35m        ]:[0m
[30;1m580 | [0m[35m            # Verify the settings section is associated to the right storage type[0m
[30;1m581 | [0m[35m            if data.get(settings, None) and storage_type != data.get("storage_type"):[0m
[30;1m582 | [0m[35m                raise ValidationError([0m
[30;1m583 | [0m[35m                    "SharedStorage > *Settings section is not appropriate to the "[0m
[30;1m584 | [0m[35m                    f"StorageType {data.get('storage_type')}."[0m

[31m--[ [0m[34mMatch #[0m[33m545[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m477 | [0m[35m        """Return errors for parameters in the FSx config section that would be ignored."""[0m
[30;1m478 | [0m[35m        # If file_system_id is specified, all parameters are ignored.[0m
[30;1m479 | [0m[35m        messages = [][0m
[30;1m480 | [0m[35m        if data.get("backup_id") is not None:[0m
[30;1m481 | [0m[35m            unsupported_config_param_names = [[0m
[30;1m482 | [0m[35m                "deployment_type",[0m
[30;1m483 | [0m[35m                "per_unit_storage_throughput",[0m

[31m--[ [0m[34mMatch #[0m[33m546[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m465 | [0m[35m        """Return errors for parameters in the FSx config section that would be ignored."""[0m
[30;1m466 | [0m[35m        # If file_system_id is specified, all parameters are ignored.[0m
[30;1m467 | [0m[35m        messages = [][0m
[30;1m468 | [0m[35m        if data.get("file_system_id") is not None:[0m
[30;1m469 | [0m[35m            for key in data:[0m
[30;1m470 | [0m[35m                if key is not None and key != "file_system_id":[0m
[30;1m471 | [0m[35m                    messages.append(FSX_MESSAGES["errors"]["ignored_param_with_fsx_fs_id"].format(fs[0m

[31m--[ [0m[34mMatch #[0m[33m547[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m351 | [0m[35m            # If the schema is to be loaded partially, do not check existence constrain.[0m
[30;1m352 | [0m[35m            return[0m
[30;1m353 | [0m[35m        throughput_mode = data.get("throughput_mode")[0m
[30;1m354 | [0m[35m        provisioned_throughput = data.get("provisioned_throughput")[0m
[30;1m355 | [0m[35m        if throughput_mode != "provisioned" and provisioned_throughput:[0m
[30;1m356 | [0m[35m            raise ValidationError([0m
[30;1m357 | [0m[35m                message="When specifying provisioned throughput, the throughput mode must be set to [0m

[31m--[ [0m[34mMatch #[0m[33m548[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m350 | [0m[35m        if kwargs.get("partial"):[0m
[30;1m351 | [0m[35m            # If the schema is to be loaded partially, do not check existence constrain.[0m
[30;1m352 | [0m[35m            return[0m
[30;1m353 | [0m[35m        throughput_mode = data.get("throughput_mode")[0m
[30;1m354 | [0m[35m        provisioned_throughput = data.get("provisioned_throughput")[0m
[30;1m355 | [0m[35m        if throughput_mode != "provisioned" and provisioned_throughput:[0m
[30;1m356 | [0m[35m            raise ValidationError([0m

[31m--[ [0m[34mMatch #[0m[33m549[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m347 | [0m[35m    @validates_schema[0m
[30;1m348 | [0m[35m    def validate_existence_of_mode_throughput(self, data, **kwargs):[0m
[30;1m349 | [0m[35m        """Validate the conditional existence requirement between throughput_mode and provisioned_th[0m
[30;1m350 | [0m[35m        if kwargs.get("partial"):[0m
[30;1m351 | [0m[35m            # If the schema is to be loaded partially, do not check existence constrain.[0m
[30;1m352 | [0m[35m            return[0m
[30;1m353 | [0m[35m        throughput_mode = data.get("throughput_mode")[0m

[31m--[ [0m[34mMatch #[0m[33m550[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m332 | [0m[35m        """Return errors for parameters in the Efs config section that would be ignored."""[0m
[30;1m333 | [0m[35m        # If file_system_id is specified, all parameters are ignored.[0m
[30;1m334 | [0m[35m        messages = [][0m
[30;1m335 | [0m[35m        if data.get("file_system_id") is not None:[0m
[30;1m336 | [0m[35m            for key in data:[0m
[30;1m337 | [0m[35m                if key is not None and key not in [[0m
[30;1m338 | [0m[35m                    "encryption_in_transit",[0m

[31m--[ [0m[34mMatch #[0m[33m551[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1447 | [0m[35m        metadata={"update_policy": UpdatePolicy.SUPPORTED},[0m
[30;1m1448 | [0m[35m    )[0m
[30;1m1449 | [0m[35m    dcv = fields.Nested(DcvSchema, metadata={"update_policy": UpdatePolicy.UNSUPPORTED})[0m
[30;1m1450 | [0m[35m    ssh = fields.Nested(LoginNodesSshSchema, metadata={"update_policy": UpdatePolicy.LOGIN_NODES_POO[0m
[30;1m1451 | [0m[35m    custom_actions = fields.Nested(LoginNodesCustomActionsSchema, metadata={"update_policy": UpdateP[0m
[30;1m1452 | [0m[35m    iam = fields.Nested(LoginNodesIamSchema, metadata={"update_policy": UpdatePolicy.LOGIN_NODES_POO[0m
[30;1m1453 | [0m[35m    gracetime_period = fields.Int([0m

[31m--[ [0m[34mMatch #[0m[33m552[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1409 | [0m[35m    subnet_ids = fields.List([0m
[30;1m1410 | [0m[35m        fields.Str(validate=get_field_validator("subnet_id")),[0m
[30;1m1411 | [0m[35m        required=True,[0m
[30;1m1412 | [0m[35m        validate=validate.Length(equal=1, error="Only one subnet can be associated with a login node[0m
[30;1m1413 | [0m[35m        metadata={"update_policy": UpdatePolicy.LOGIN_NODES_POOL_STOP},[0m
[30;1m1414 | [0m[35m    )[0m
[30;1m1415 | [0m[35m    additional_security_groups = fields.List([0m

[31m--[ [0m[34mMatch #[0m[33m553[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1390 | [0m[35m[0m
[30;1m1391 | [0m[35m[0m
[30;1m1392 | [0m[35mclass LoginNodesSshSchema(BaseSshSchema):[0m
[30;1m1393 | [0m[35m    """Represent the Ssh schema of LoginNodes."""[0m
[30;1m1394 | [0m[35m[0m
[30;1m1395 | [0m[35m    key_name = fields.Str(metadata={"update_policy": UpdatePolicy.LOGIN_NODES_POOL_STOP})[0m
[30;1m1396 | [0m[35m    allowed_ips = fields.Str([0m

[31m--[ [0m[34mMatch #[0m[33m554[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1356 | [0m[35m    networking = fields.Nested([0m
[30;1m1357 | [0m[35m        HeadNodeNetworkingSchema, required=True, metadata={"update_policy": UpdatePolicy.UNSUPPORTED[0m
[30;1m1358 | [0m[35m    )[0m
[30;1m1359 | [0m[35m    ssh = fields.Nested(HeadNodeSshSchema, metadata={"update_policy": UpdatePolicy.SUPPORTED})[0m
[30;1m1360 | [0m[35m    local_storage = fields.Nested(HeadNodeStorageSchema, metadata={"update_policy": UpdatePolicy.SUP[0m
[30;1m1361 | [0m[35m    shared_storage_type = fields.Str([0m
[30;1m1362 | [0m[35m        required=False,[0m

[31m--[ [0m[34mMatch #[0m[33m555[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1325 | [0m[35m[0m
[30;1m1326 | [0m[35m[0m
[30;1m1327 | [0m[35mclass LoginNodesCustomActionsSchema(BaseSchema):[0m
[30;1m1328 | [0m[35m    """Represent the schema for all available custom actions in a login node pool."""[0m
[30;1m1329 | [0m[35m[0m
[30;1m1330 | [0m[35m    on_node_start = OneOrManyCustomActionField(metadata={"update_policy": UpdatePolicy.UNSUPPORTED})[0m
[30;1m1331 | [0m[35m    on_node_configured = OneOrManyCustomActionField(metadata={"update_policy": UpdatePolicy.UNSUPPOR[0m

[31m--[ [0m[34mMatch #[0m[33m556[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1312 | [0m[35m[0m
[30;1m1313 | [0m[35m[0m
[30;1m1314 | [0m[35mclass HeadNodeCustomActionsSchema(BaseSchema):[0m
[30;1m1315 | [0m[35m    """Represent the schema for all available custom actions in the head node."""[0m
[30;1m1316 | [0m[35m[0m
[30;1m1317 | [0m[35m    on_node_start = OneOrManyCustomActionField(metadata={"update_policy": UpdatePolicy.UNSUPPORTED})[0m
[30;1m1318 | [0m[35m    on_node_configured = OneOrManyCustomActionField(metadata={"update_policy": UpdatePolicy.UNSUPPOR[0m

[31m--[ [0m[34mMatch #[0m[33m557[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1291 | [0m[35m[0m
[30;1m1292 | [0m[35m[0m
[30;1m1293 | [0m[35mclass CustomActionScriptSchemaBase(BaseSchema):[0m
[30;1m1294 | [0m[35m    """Represent the schema of the custom action script that cannot be updated."""[0m
[30;1m1295 | [0m[35m[0m
[30;1m1296 | [0m[35m    @post_load[0m
[30;1m1297 | [0m[35m    def make_resource(self, data, **kwargs):[0m

[31m--[ [0m[34mMatch #[0m[33m558[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1277 | [0m[35m                res.append(super()._deserialize(item, attr, data, **kwargs))[0m
[30;1m1278 | [0m[35m            return res[0m
[30;1m1279 | [0m[35m[0m
[30;1m1280 | [0m[35m        raise ValidationError("Either Script or Sequence field must be provided.")[0m
[30;1m1281 | [0m[35m[0m
[30;1m1282 | [0m[35m    def _serialize(self, nested_obj, attr, obj, **kwargs):[0m
[30;1m1283 | [0m[35m        if isinstance(nested_obj, list):[0m

[31m--[ [0m[34mMatch #[0m[33m559[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1263 | [0m[35m[0m
[30;1m1264 | [0m[35m    def _deserialize(self, value, attr, data, **kwargs):[0m
[30;1m1265 | [0m[35m        if "Script" in value and "Sequence" in value:[0m
[30;1m1266 | [0m[35m            raise ValidationError("Both Script and Sequence fields are provided. Only one is allowed[0m
[30;1m1267 | [0m[35m[0m
[30;1m1268 | [0m[35m        if "Script" in value:[0m
[30;1m1269 | [0m[35m            return super()._deserialize(value, attr, data, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m560[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1235 | [0m[35m[0m
[30;1m1236 | [0m[35m[0m
[30;1m1237 | [0m[35mclass OneOrManyCustomActionField(fields.Nested):[0m
[30;1m1238 | [0m[35m    """Custom Marshmallow filed to handle backward compatible single script custom actions."""[0m
[30;1m1239 | [0m[35m[0m
[30;1m1240 | [0m[35m    def __init__(self, **kwargs):[0m
[30;1m1241 | [0m[35m        schema = self._build_dynamic_schema_class([0m

[31m--[ [0m[34mMatch #[0m[33m561[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1186 | [0m[35m        return HealthChecks(**data)[0m
[30;1m1187 | [0m[35m[0m
[30;1m1188 | [0m[35m[0m
[30;1m1189 | [0m[35m# ---------------------- Node and Cluster Schema ---------------------- #[0m
[30;1m1190 | [0m[35m[0m
[30;1m1191 | [0m[35m[0m
[30;1m1192 | [0m[35mclass ImageSchema(BaseSchema):[0m

[31m--[ [0m[34mMatch #[0m[33m562[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m776 | [0m[35m[0m
[30;1m777 | [0m[35m[0m
[30;1m778 | [0m[35mclass BaseSshSchema(BaseSchema):[0m
[30;1m779 | [0m[35m    """Represent the schema of common Ssh parameters used by head and login nodes."""[0m
[30;1m780 | [0m[35m[0m
[30;1m781 | [0m[35m    key_name = fields.Str(metadata={"update_policy": UpdatePolicy.UNSUPPORTED})[0m
[30;1m782 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m563[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m776 | [0m[35m[0m
[30;1m777 | [0m[35m[0m
[30;1m778 | [0m[35mclass BaseSshSchema(BaseSchema):[0m
[30;1m779 | [0m[35m    """Represent the schema of common Ssh parameters used by head and login nodes."""[0m
[30;1m780 | [0m[35m[0m
[30;1m781 | [0m[35m    key_name = fields.Str(metadata={"update_policy": UpdatePolicy.UNSUPPORTED})[0m
[30;1m782 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m564[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m654 | [0m[35m[0m
[30;1m655 | [0m[35m[0m
[30;1m656 | [0m[35mclass HeadNodeProxySchema(BaseSchema):[0m
[30;1m657 | [0m[35m    """Represent the schema of proxy for the Head node."""[0m
[30;1m658 | [0m[35m[0m
[30;1m659 | [0m[35m    http_proxy_address = fields.Str(metadata={"update_policy": UpdatePolicy.UNSUPPORTED})[0m
[30;1m660 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m565[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m643 | [0m[35m    def shared_dir_validator(self, value):[0m
[30;1m644 | [0m[35m        """Validate that user is not specifying /NONE or NONE as shared_dir for any filesystem."""[0m
[30;1m645 | [0m[35m        # FIXME: pcluster2 doesn't allow "^/?NONE$" mount dir to avoid an ambiguity in cookbook.[0m
[30;1m646 | [0m[35m        #  We should change cookbook to solve the ambiguity and allow "^/?NONE$" for mount dir[0m
[30;1m647 | [0m[35m        #  Cookbook location to be modified:[0m
[30;1m648 | [0m[35m        #  https://github.com/aws/aws-parallelcluster-cookbook/blob/develop/recipes/head_node_base_c[0m
[30;1m649 | [0m[35m        if re.match("^/?NONE$", value):[0m

[31m--[ [0m[34mMatch #[0m[33m566[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m642 | [0m[35m    @validates("mount_dir")[0m
[30;1m643 | [0m[35m    def shared_dir_validator(self, value):[0m
[30;1m644 | [0m[35m        """Validate that user is not specifying /NONE or NONE as shared_dir for any filesystem."""[0m
[30;1m645 | [0m[35m        # FIXME: pcluster2 doesn't allow "^/?NONE$" mount dir to avoid an ambiguity in cookbook.[0m
[30;1m646 | [0m[35m        #  We should change cookbook to solve the ambiguity and allow "^/?NONE$" for mount dir[0m
[30;1m647 | [0m[35m        #  Cookbook location to be modified:[0m
[30;1m648 | [0m[35m        #  https://github.com/aws/aws-parallelcluster-cookbook/blob/develop/recipes/head_node_base_c[0m

[31m--[ [0m[34mMatch #[0m[33m567[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35mclass HeadNodeRootVolumeSchema(BaseSchema):[0m
[30;1m147 | [0m[35m    """Represent the RootVolume schema for the Head node."""[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    volume_type = fields.Str([0m
[30;1m150 | [0m[35m        validate=get_field_validator("volume_type"),[0m

[31m--[ [0m[34mMatch #[0m[33m568[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/cluster_schema.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m569[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1335 | [0m[35m              "change_set_s3_key": f"{self.bucket.artifact_directory}/configs/"[0m
[30;1m1336 | [0m[35m                    f"{PCLUSTER_S3_ARTIFACTS_DICT.get('change_set_name')}",[0m
[30;1m1337 | [0m[35m                    "instance_types_data_s3_key": f"{self.bucket.artifact_directory}/configs/"[0m
[30;1m1338 | [0m[35m                    f"{PCLUSTER_S3_ARTIFACTS_DICT.get('instance_types_data_name')}",[0m
[30;1m1339 | [0m[35m                    "custom_node_package": self.config.custom_node_package or "",[0m
[30;1m1340 | [0m[35m                    "custom_awsbatchcli_package": self.config.custom_aws_batch_cli_package or "",[0m

[31m--[ [0m[34mMatch #[0m[33m570[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1333 | [0m[35m                    "cluster_config_version": self.config.config_version,[0m
[30;1m1334 | [0m[35m                    "instance_types_data_version": self.config.instance_types_data_version,[0m
[30;1m1335 | [0m[35m                    "change_set_s3_key": f"{self.bucket.artifact_directory}/configs/"[0m
[30;1m1336 | [0m[35m                    f"{PCLUSTER_S3_ARTIFACTS_DICT.get('change_set_name')}",[0m
[30;1m1337 | [0m[35m                    "instance_types_data_s3_key": f"{self.bucket.artifact_directory}/configs/"[0m
[30;1m1338 | [0m[35m                    f"{PCLUSTER_S3_ARTIFACTS_DICT.get('instance_types_data_name')}",[0m
[30;1m1339 | [0m[35m                    "custom_node_package": self.config.custom_node_package or "",[0m

[31m--[ [0m[34mMatch #[0m[33m571[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1328 | [0m[35m                    "log_rotation_enabled": "true" if self.config.is_log_rotation_enabled else "fals[0m
[30;1m1329 | [0m[35m                    "cluster_s3_bucket": self.bucket.name,[0m
[30;1m1330 | [0m[35m                    "cluster_config_s3_key": "{0}/configs/{1}".format([0m
[30;1m1331 | [0m[35m                        self.bucket.artifact_directory, PCLUSTER_S3_ARTIFACTS_DICT.get("config_name"[0m
[30;1m1332 | [0m[35m                    ),[0m
[30;1m1333 | [0m[35m                    "cluster_config_version": self.config.config_version,[0m
[30;1m1334 | [0m[35m                    "instance_types_data_version": self.config.instance_types_data_version,[0m

[31m--[ [0m[34mMatch #[0m[33m572[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1577 | [0m[35m        CfnOutput([0m
[30;1m1578 | [0m[35m            self.stack,[0m
[30;1m1579 | [0m[35m            "HeadNodePrivateDnsName",[0m
[30;1m1580 | [0m[35m            description="Private DNS name of the head node",[0m
[30;1m1581 | [0m[35m            value=self.head_node_instance.attr_private_dns_name,[0m
[30;1m1582 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m573[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1570 | [0m[35m        CfnOutput([0m
[30;1m1571 | [0m[35m            self.stack,[0m
[30;1m1572 | [0m[35m            "HeadNodePrivateIP",[0m
[30;1m1573 | [0m[35m            description="Private IP Address of the head node",[0m
[30;1m1574 | [0m[35m            value=self.head_node_instance.attr_private_ip,[0m
[30;1m1575 | [0m[35m        )[0m
[30;1m1576 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m574[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1570 | [0m[35m        CfnOutput([0m
[30;1m1571 | [0m[35m            self.stack,[0m
[30;1m1572 | [0m[35m            "HeadNodePrivateIP",[0m
[30;1m1573 | [0m[35m            description="Private IP Address of the head node",[0m
[30;1m1574 | [0m[35m            value=self.head_node_instance.attr_private_ip,[0m
[30;1m1575 | [0m[35m        )[0m
[30;1m1576 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m575[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1563 | [0m[35m        CfnOutput([0m
[30;1m1564 | [0m[35m            self.stack,[0m
[30;1m1565 | [0m[35m            "HeadNodeInstanceID",[0m
[30;1m1566 | [0m[35m            description="ID of the head node instance",[0m
[30;1m1567 | [0m[35m            value=self.head_node_instance.ref,[0m
[30;1m1568 | [0m[35m        )[0m
[30;1m1569 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m576[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1460 | [0m[35m                    "bootstrap": {[0m
[30;1m1461 | [0m[35m                        "command": ([0m
[30;1m1462 | [0m[35m                            "[ ! -f /opt/parallelcluster/.bootstrapped ] && echo ${cookbook_version}[0m
[30;1m1463 | [0m[35m                            "| tee /opt/parallelcluster/.bootstrapped || exit 0"[0m
[30;1m1464 | [0m[35m                        )  # TODO check[0m
[30;1m1465 | [0m[35m                    },[0m
[30;1m1466 | [0m[35m                }[0m

[31m--[ [0m[34mMatch #[0m[33m577[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1409 | [0m[35m                    "jq": {[0m
[30;1m1410 | [0m[35m                        "command": ([0m
[30;1m1411 | [0m[35m                            'jq -s ".[0] * .[1]" /tmp/dna.json /tmp/extra.json > /etc/chef/dna.json [0m
[30;1m1412 | [0m[35m                            '|| ( echo "jq not installed"; cp /tmp/dna.json /etc/chef/dna.json )'[0m
[30;1m1413 | [0m[35m                        )[0m
[30;1m1414 | [0m[35m                    },[0m
[30;1m1415 | [0m[35m                },[0m

[31m--[ [0m[34mMatch #[0m[33m578[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1253 | [0m[35m        )[0m
[30;1m1254 | [0m[35m[0m
[30;1m1255 | [0m[35m        # Metadata[0m
[30;1m1256 | [0m[35m        head_node_launch_template.add_metadata("Comment", "AWS ParallelCluster Head Node")[0m
[30;1m1257 | [0m[35m        # CloudFormation::Init metadata[0m
[30;1m1258 | [0m[35m[0m
[30;1m1259 | [0m[35m        dna_json = json.dumps([0m

[31m--[ [0m[34mMatch #[0m[33m579[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1208 | [0m[35m[0m
[30;1m1209 | [0m[35m        cloudformation_url = get_service_endpoint("cloudformation", self.config.region)[0m
[30;1m1210 | [0m[35m[0m
[30;1m1211 | [0m[35m        # Head node Launch Template[0m
[30;1m1212 | [0m[35m        launch_template_id = "HeadNodeLaunchTemplate"[0m
[30;1m1213 | [0m[35m        head_node_launch_template = ec2.CfnLaunchTemplate([0m
[30;1m1214 | [0m[35m            self.stack,[0m

[31m--[ [0m[34mMatch #[0m[33m580[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1121 | [0m[35m        checked_availability_zones,[0m
[30;1m1122 | [0m[35m        deletion_policy,[0m
[30;1m1123 | [0m[35m    ):[0m
[30;1m1124 | [0m[35m        """Create a EFS Mount Point for the file system, if not already available on the same AZ."""[0m
[30;1m1125 | [0m[35m        availability_zone = AWSApi.instance().ec2.get_subnet_avail_zone(subnet_id)[0m
[30;1m1126 | [0m[35m        if availability_zone not in checked_availability_zones:[0m
[30;1m1127 | [0m[35m            efs_resource = efs.CfnMountTarget([0m

[31m--[ [0m[34mMatch #[0m[33m581[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1094 | [0m[35m                    deletion_policy,[0m
[30;1m1095 | [0m[35m                )[0m
[30;1m1096 | [0m[35m[0m
[30;1m1097 | [0m[35m            # Mount Target for Head Node[0m
[30;1m1098 | [0m[35m            self._add_efs_mount_target([0m
[30;1m1099 | [0m[35m                id,[0m
[30;1m1100 | [0m[35m                efs_id,[0m

[31m--[ [0m[34mMatch #[0m[33m582[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1094 | [0m[35m                    deletion_policy,[0m
[30;1m1095 | [0m[35m                )[0m
[30;1m1096 | [0m[35m[0m
[30;1m1097 | [0m[35m            # Mount Target for Head Node[0m
[30;1m1098 | [0m[35m            self._add_efs_mount_target([0m
[30;1m1099 | [0m[35m                id,[0m
[30;1m1100 | [0m[35m                efs_id,[0m

[31m--[ [0m[34mMatch #[0m[33m583[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1080 | [0m[35m            # Create Mount Targets[0m
[30;1m1081 | [0m[35m            checked_availability_zones = [][0m
[30;1m1082 | [0m[35m[0m
[30;1m1083 | [0m[35m            # Mount Targets for Compute Fleet[0m
[30;1m1084 | [0m[35m            compute_subnet_ids = self.config.compute_subnet_ids[0m
[30;1m1085 | [0m[35m            file_system_security_group, _ = self._add_storage_security_group(id, shared_efs)[0m
[30;1m1086 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m584[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1077 | [0m[35m            efs_resource.cfn_options.deletion_policy = efs_resource.cfn_options.update_replace_polic[0m
[30;1m1078 | [0m[35m            efs_id = efs_resource.ref[0m
[30;1m1079 | [0m[35m[0m
[30;1m1080 | [0m[35m            # Create Mount Targets[0m
[30;1m1081 | [0m[35m            checked_availability_zones = [][0m
[30;1m1082 | [0m[35m[0m
[30;1m1083 | [0m[35m            # Mount Targets for Compute Fleet[0m

[31m--[ [0m[34mMatch #[0m[33m585[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m918 | [0m[35m        return ec2.CfnSecurityGroup([0m
[30;1m919 | [0m[35m            self.stack,[0m
[30;1m920 | [0m[35m            "HeadNodeSecurityGroup",[0m
[30;1m921 | [0m[35m            group_description="Enable access to the head node",[0m
[30;1m922 | [0m[35m            vpc_id=self.config.vpc_id,[0m
[30;1m923 | [0m[35m            security_group_ingress=head_security_group_ingress,[0m
[30;1m924 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m586[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m901 | [0m[35m[0m
[30;1m902 | [0m[35m    def _add_head_security_group(self):[0m
[30;1m903 | [0m[35m        head_security_group_ingress = [[0m
[30;1m904 | [0m[35m            # SSH access[0m
[30;1m905 | [0m[35m            get_source_ingress_rule(self.config.head_node.ssh.allowed_ips)[0m
[30;1m906 | [0m[35m        ][0m
[30;1m907 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m587[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m876 | [0m[35m            # Check if the pool has user-defined security groups[0m
[30;1m877 | [0m[35m            if not pool.networking.security_groups:[0m
[30;1m878 | [0m[35m                security_group_ingress_rules = [[0m
[30;1m879 | [0m[35m                    # Add rule for SSH access[0m
[30;1m880 | [0m[35m                    get_source_ingress_rule(pool.ssh.allowed_ips)[0m
[30;1m881 | [0m[35m                ][0m
[30;1m882 | [0m[35m                # Add rule for DCV access if enabled[0m

[31m--[ [0m[34mMatch #[0m[33m588[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m869 | [0m[35m        return compute_security_group[0m
[30;1m870 | [0m[35m[0m
[30;1m871 | [0m[35m    def _add_login_nodes_security_group(self):[0m
[30;1m872 | [0m[35m        """Return a dictionary mapping each login node pool name to its respective managed security [0m
[30;1m873 | [0m[35m        pool_to_managed_security_group_dict = dict()[0m
[30;1m874 | [0m[35m[0m
[30;1m875 | [0m[35m        for pool in self.config.login_nodes.pools:[0m

[31m--[ [0m[34mMatch #[0m[33m589[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m720 | [0m[35m        managed_compute_security_group,[0m
[30;1m721 | [0m[35m    ):[0m
[30;1m722 | [0m[35m        if managed_compute_security_group:[0m
[30;1m723 | [0m[35m            # Access to compute nodes from head node and login nodes[0m
[30;1m724 | [0m[35m            for index, security_group in enumerate(head_node_security_groups):[0m
[30;1m725 | [0m[35m                self._allow_all_ingress([0m
[30;1m726 | [0m[35m                    f"ComputeSecurityGroupHeadNodeIngress{index}",[0m

[31m--[ [0m[34mMatch #[0m[33m590[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m697 | [0m[35m    ):[0m
[30;1m698 | [0m[35m        if managed_login_security_groups:[0m
[30;1m699 | [0m[35m            for pool_name, managed_security_group in managed_login_security_groups.items():[0m
[30;1m700 | [0m[35m                # Access to login nodes from head node[0m
[30;1m701 | [0m[35m                for index, security_group in enumerate(head_node_security_groups):[0m
[30;1m702 | [0m[35m                    self._allow_all_ingress([0m
[30;1m703 | [0m[35m                        f"{pool_name}LoginSecurityGroupHeadNodeIngress{index}",[0m

[31m--[ [0m[34mMatch #[0m[33m591[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m673 | [0m[35m                    f"HeadNodeSecurityGroupComputeIngress{index}", security_group, managed_head_secu[0m
[30;1m674 | [0m[35m                )[0m
[30;1m675 | [0m[35m            for index, security_group in enumerate(login_security_groups):[0m
[30;1m676 | [0m[35m                # Access to head node from login nodes[0m
[30;1m677 | [0m[35m                self._allow_all_ingress([0m
[30;1m678 | [0m[35m                    f"HeadNodeSecurityGroupLoginSlurmIngress{index}",[0m
[30;1m679 | [0m[35m                    security_group,[0m

[31m--[ [0m[34mMatch #[0m[33m592[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m668 | [0m[35m    ):[0m
[30;1m669 | [0m[35m        if managed_head_security_group:[0m
[30;1m670 | [0m[35m            for index, security_group in enumerate(compute_security_groups):[0m
[30;1m671 | [0m[35m                # Access to head node from compute nodes[0m
[30;1m672 | [0m[35m                self._allow_all_ingress([0m
[30;1m673 | [0m[35m                    f"HeadNodeSecurityGroupComputeIngress{index}", security_group, managed_head_secu[0m
[30;1m674 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m593[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m555 | [0m[35m[0m
[30;1m556 | [0m[35m        elastic_ip = self.config.head_node.networking.headnode_elastic_ip[0m
[30;1m557 | [0m[35m        if elastic_ip:[0m
[30;1m558 | [0m[35m            # Create and associate EIP to Head Node[0m
[30;1m559 | [0m[35m            if elastic_ip is True:[0m
[30;1m560 | [0m[35m                allocation_id = ec2.CfnEIP(self.stack, "HeadNodeEIP", domain="vpc").attr_allocation_[0m
[30;1m561 | [0m[35m            # Attach existing EIP[0m

[31m--[ [0m[34mMatch #[0m[33m594[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m547 | [0m[35m        head_eni = ec2.CfnNetworkInterface([0m
[30;1m548 | [0m[35m            self.stack,[0m
[30;1m549 | [0m[35m            "HeadNodeENI",[0m
[30;1m550 | [0m[35m            description="AWS ParallelCluster head node interface",[0m
[30;1m551 | [0m[35m            subnet_id=self.config.head_node.networking.subnet_id,[0m
[30;1m552 | [0m[35m            source_dest_check=False,[0m
[30;1m553 | [0m[35m            group_set=head_eni_group_set,[0m

[31m--[ [0m[34mMatch #[0m[33m595[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m541 | [0m[35m        return cleanup_resources_lambda_role, cleanup_resources_lambda[0m
[30;1m542 | [0m[35m[0m
[30;1m543 | [0m[35m    def _add_head_eni(self):[0m
[30;1m544 | [0m[35m        """Create Head Node Elastic Network Interface."""[0m
[30;1m545 | [0m[35m        head_eni_group_set = self._get_head_node_security_groups_full()[0m
[30;1m546 | [0m[35m[0m
[30;1m547 | [0m[35m        head_eni = ec2.CfnNetworkInterface([0m

[31m--[ [0m[34mMatch #[0m[33m596[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m473 | [0m[35m                cluster_hosted_zone=self.scheduler_resources.cluster_hosted_zone if self.scheduler_r[0m
[30;1m474 | [0m[35m                cluster_bucket=self.bucket,[0m
[30;1m475 | [0m[35m            )[0m
[30;1m476 | [0m[35m            # Add dependency on the Head Node construct[0m
[30;1m477 | [0m[35m            self.login_nodes_stack.node.add_dependency(self.head_node_instance)[0m
[30;1m478 | [0m[35m[0m
[30;1m479 | [0m[35m    def _add_cleanup_resources_lambda(self):[0m

[31m--[ [0m[34mMatch #[0m[33m597[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m292 | [0m[35m[0m
[30;1m293 | [0m[35m        # Head Node[0m
[30;1m294 | [0m[35m        self.head_node_instance = self._add_head_node()[0m
[30;1m295 | [0m[35m        # Add a dependency to the cleanup Route53 resource, so that Route53 Hosted Zone is cleaned a[0m
[30;1m296 | [0m[35m        if self._condition_is_slurm() and hasattr(self.scheduler_resources, "cleanup_route53_custom_[0m
[30;1m297 | [0m[35m            self.head_node_instance.add_depends_on(self.scheduler_resources.cleanup_route53_custom_r[0m
[30;1m298 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m598[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m290 | [0m[35m        # Wait condition[0m
[30;1m291 | [0m[35m        self.wait_condition, self.wait_condition_handle = self._add_wait_condition()[0m
[30;1m292 | [0m[35m[0m
[30;1m293 | [0m[35m        # Head Node[0m
[30;1m294 | [0m[35m        self.head_node_instance = self._add_head_node()[0m
[30;1m295 | [0m[35m        # Add a dependency to the cleanup Route53 resource, so that Route53 Hosted Zone is cleaned a[0m
[30;1m296 | [0m[35m        if self._condition_is_slurm() and hasattr(self.scheduler_resources, "cleanup_route53_custom_[0m

[31m--[ [0m[34mMatch #[0m[33m599[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m264 | [0m[35m        # Add the internal use shared storage to the stack[0m
[30;1m265 | [0m[35m        # This FS will be mounted, the shared dirs will be added,[0m
[30;1m266 | [0m[35m        # then it will be unmounted and the shared dirs will be[0m
[30;1m267 | [0m[35m        # mounted.  We need to create the additional mount points first.[0m
[30;1m268 | [0m[35m        if self.config.head_node.shared_storage_type.lower() == SharedStorageType.EFS.value:[0m
[30;1m269 | [0m[35m            internal_efs_storage_shared = SharedEfs([0m
[30;1m270 | [0m[35m                mount_dir="/opt/parallelcluster/init_shared", name="internal_pcluster_shared", throu[0m

[31m--[ [0m[34mMatch #[0m[33m600[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m258 | [0m[35m            self._compute_security_group,[0m
[30;1m259 | [0m[35m            self._login_security_group,[0m
[30;1m260 | [0m[35m        ) = self._add_security_groups()[0m
[30;1m261 | [0m[35m        # Head Node ENI[0m
[30;1m262 | [0m[35m        self._head_eni = self._add_head_eni()[0m
[30;1m263 | [0m[35m[0m
[30;1m264 | [0m[35m        # Add the internal use shared storage to the stack[0m

[31m--[ [0m[34mMatch #[0m[33m601[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m247 | [0m[35m    # -- Resources ---------------------------------------------------------------------------------[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m    def _add_resources(self):[0m
[30;1m250 | [0m[35m        # Cloud Watch Logs[0m
[30;1m251 | [0m[35m        self.log_group = None[0m
[30;1m252 | [0m[35m        if self.config.is_cw_logging_enabled:[0m
[30;1m253 | [0m[35m            self.log_group = self._add_cluster_log_group()[0m

[31m--[ [0m[34mMatch #[0m[33m602[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m227 | [0m[35m            CfnParameter(self.stack, "OfficialAmi", default=self.config.official_ami)[0m
[30;1m228 | [0m[35m        except AWSClientError:[0m
[30;1m229 | [0m[35m            # This might happen if there is no official AMI[0m
[30;1m230 | [0m[35m            # and custom AMIs are defined for the head node and compute nodes[0m
[30;1m231 | [0m[35m            pass[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m        CfnParameter([0m

[31m--[ [0m[34mMatch #[0m[33m603[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m206 | [0m[35m        CfnParameter([0m
[30;1m207 | [0m[35m            self.stack,[0m
[30;1m208 | [0m[35m            "ClusterUser",[0m
[30;1m209 | [0m[35m            description="Username to login to head node",[0m
[30;1m210 | [0m[35m            default=OS_MAPPING[self.config.image.os]["user"],[0m
[30;1m211 | [0m[35m        )[0m
[30;1m212 | [0m[35m        CfnParameter([0m

[31m--[ [0m[34mMatch #[0m[33m604[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m193 | [0m[35m            if isinstance(self.config, SlurmClusterConfig) and self.config.login_nodes[0m
[30;1m194 | [0m[35m            else [][0m
[30;1m195 | [0m[35m        )[0m
[30;1m196 | [0m[35m        # Add the managed login node security groups[0m
[30;1m197 | [0m[35m        if self._login_security_group:[0m
[30;1m198 | [0m[35m            for _, managed_security_group in self._login_security_group.items():[0m
[30;1m199 | [0m[35m                login_security_groups.append(managed_security_group.ref)[0m

[31m--[ [0m[34mMatch #[0m[33m605[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m165 | [0m[35m        return self.config.head_node.networking.security_groups or [self._head_security_group.ref][0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m    def _get_head_node_security_groups_full(self):[0m
[30;1m168 | [0m[35m        """Return full security groups to be used for the head node, default plus additional ones.""[0m
[30;1m169 | [0m[35m        head_node_group_set = self._get_head_node_security_groups()[0m
[30;1m170 | [0m[35m        # Additional security groups[0m
[30;1m171 | [0m[35m        if self.config.head_node.networking.additional_security_groups:[0m

[31m--[ [0m[34mMatch #[0m[33m606[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m161 | [0m[35m        return self.stack.stack_id[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    def _get_head_node_security_groups(self):[0m
[30;1m164 | [0m[35m        """Return the security groups to be used for the head node, created by us OR provided by the[0m
[30;1m165 | [0m[35m        return self.config.head_node.networking.security_groups or [self._head_security_group.ref][0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m    def _get_head_node_security_groups_full(self):[0m

[31m--[ [0m[34mMatch #[0m[33m607[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m131 | [0m[35m        self.timestamp = datetime.utcnow().strftime("%Y%m%d%H%M%S")[0m
[30;1m132 | [0m[35m        if self.config.is_cw_logging_enabled:[0m
[30;1m133 | [0m[35m            if log_group_name:[0m
[30;1m134 | [0m[35m                # pcluster update keep the log group,[0m
[30;1m135 | [0m[35m                # It has to be passed in order to avoid the change of log group name because of the [0m
[30;1m136 | [0m[35m                self.log_group_name = log_group_name[0m
[30;1m137 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m608[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cluster_stack.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m609[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1046 | [0m[35m                queue_section = f"queue {queue_name}"[0m
[30;1m1047 | [0m[35m                self.validate_default_name(queue_name, queue_section)[0m
[30;1m1048 | [0m[35m                self.validate_underscore_in_name(queue_name, queue_section)[0m
[30;1m1049 | [0m[35m                compute_resource_settings = self.config_parser.get([0m
[30;1m1050 | [0m[35m                    queue_section, "compute_resource_settings", fallback=None[0m
[30;1m1051 | [0m[35m                )[0m
[30;1m1052 | [0m[35m                if not compute_resource_settings:[0m

[31m--[ [0m[34mMatch #[0m[33m610[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m913 | [0m[35m[0m
[30;1m914 | [0m[35m    def get_region(self):[0m
[30;1m915 | [0m[35m        """Get region to use for instance role arn and instance profile arn."""[0m
[30;1m916 | [0m[35m        config_region = self.config_parser.get("aws", "aws_region_name", fallback=None)[0m
[30;1m917 | [0m[35m        boto_region = boto3.Session().region_name[0m
[30;1m918 | [0m[35m        if not config_region and not boto_region:[0m
[30;1m919 | [0m[35m            _error("Region not found. Please specify aws_region_name in the configuration or set reg[0m

[31m--[ [0m[34mMatch #[0m[33m611[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m799 | [0m[35m[0m
[30;1m800 | [0m[35m    def validate_single_field(self, section, field, message):[0m
[30;1m801 | [0m[35m        """Validate whether a filed in AWS ParallelCluster version 2 is supported in AWS ParallelClu[0m
[30;1m802 | [0m[35m        value = self.config_parser.get(section, field, fallback=None)[0m
[30;1m803 | [0m[35m        if not value:[0m
[30;1m804 | [0m[35m            return[0m
[30;1m805 | [0m[35m        if message == "ignored":[0m

[31m--[ [0m[34mMatch #[0m[33m612[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m741 | [0m[35m    def convert_slurm_compute_resources(self, queue, queue_section):[0m
[30;1m742 | [0m[35m        """Convert all slurm conpute resources under a Slurm Queue."""[0m
[30;1m743 | [0m[35m        compute_resources = [][0m
[30;1m744 | [0m[35m        compute_resource_settings = self.config_parser.get(queue_section, "compute_resource_settings[0m
[30;1m745 | [0m[35m        for compute_resource_label in compute_resource_settings.split(","):[0m
[30;1m746 | [0m[35m            compute_resource = self.convert_single_slurm_compute_resource(compute_resource_label, qu[0m
[30;1m747 | [0m[35m            _append_if(compute_resources, compute_resource)[0m

[31m--[ [0m[34mMatch #[0m[33m613[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m708 | [0m[35m[0m
[30;1m709 | [0m[35m    def cluster_config_get(self, param):[0m
[30;1m710 | [0m[35m        """Get parameter from cluster section."""[0m
[30;1m711 | [0m[35m        return self.config_parser.get(self.cluster_section_name, param, fallback=None)[0m
[30;1m712 | [0m[35m[0m
[30;1m713 | [0m[35m    def convert_slurm_queues(self, scheduling, param):[0m
[30;1m714 | [0m[35m        """Convert all queues from queue_settings."""[0m

[31m--[ [0m[34mMatch #[0m[33m614[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m653 | [0m[35m                additional_iam_policies.append({"Policy": policy.strip()})[0m
[30;1m654 | [0m[35m[0m
[30;1m655 | [0m[35m        s3_read_resource = self.cluster_config_get("s3_read_resource")[0m
[30;1m656 | [0m[35m        s3_read_write_resource = self.config_parser.get([0m
[30;1m657 | [0m[35m            self.cluster_section_name, "s3_read_write_resource", fallback=None[0m
[30;1m658 | [0m[35m        )[0m
[30;1m659 | [0m[35m        if s3_read_resource:[0m

[31m--[ [0m[34mMatch #[0m[33m615[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m610 | [0m[35m        dcv_settings = self.cluster_config_get("dcv_settings")[0m
[30;1m611 | [0m[35m        if dcv_settings:[0m
[30;1m612 | [0m[35m            section_label = f"dcv {dcv_settings.strip()}"[0m
[30;1m613 | [0m[35m            if self.config_parser.get(section_label, "enable") == "master":[0m
[30;1m614 | [0m[35m                dcv["Enabled"] = True[0m
[30;1m615 | [0m[35m            self.convert_single_field(section_label, "port", dcv, "Port", "getint")[0m
[30;1m616 | [0m[35m            self.convert_single_field(section_label, "access_from", dcv, "AllowedIps")[0m

[31m--[ [0m[34mMatch #[0m[33m616[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m551 | [0m[35m                self.vpc_section_label, "vpc_security_group_id", fallback=None[0m
[30;1m552 | [0m[35m            )[0m
[30;1m553 | [0m[35m            _append_if(security_groups, vpc_security_group_id)[0m
[30;1m554 | [0m[35m            additional_sg = self.config_parser.get(self.vpc_section_label, "additional_sg", fallback[0m
[30;1m555 | [0m[35m            _append_if(additional_security_groups, additional_sg)[0m
[30;1m556 | [0m[35m        _add_if(networking, "SubnetIds", subnet_ids)[0m
[30;1m557 | [0m[35m        _add_if(networking, "SecurityGroups", security_groups)[0m

[31m--[ [0m[34mMatch #[0m[33m617[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m547 | [0m[35m                subnet_field = "master_subnet_id"[0m
[30;1m548 | [0m[35m            subnet_id = self.config_parser.get(self.vpc_section_label, subnet_field, fallback=None)[0m
[30;1m549 | [0m[35m            _append_if(subnet_ids, subnet_id)[0m
[30;1m550 | [0m[35m            vpc_security_group_id = self.config_parser.get([0m
[30;1m551 | [0m[35m                self.vpc_section_label, "vpc_security_group_id", fallback=None[0m
[30;1m552 | [0m[35m            )[0m
[30;1m553 | [0m[35m            _append_if(security_groups, vpc_security_group_id)[0m

[31m--[ [0m[34mMatch #[0m[33m618[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m545 | [0m[35m                subnet_field = "compute_subnet_id"[0m
[30;1m546 | [0m[35m            else:[0m
[30;1m547 | [0m[35m                subnet_field = "master_subnet_id"[0m
[30;1m548 | [0m[35m            subnet_id = self.config_parser.get(self.vpc_section_label, subnet_field, fallback=None)[0m
[30;1m549 | [0m[35m            _append_if(subnet_ids, subnet_id)[0m
[30;1m550 | [0m[35m            vpc_security_group_id = self.config_parser.get([0m
[30;1m551 | [0m[35m                self.vpc_section_label, "vpc_security_group_id", fallback=None[0m

[31m--[ [0m[34mMatch #[0m[33m619[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m541 | [0m[35m        subnet_ids = [][0m
[30;1m542 | [0m[35m[0m
[30;1m543 | [0m[35m        if self.vpc_section_label:[0m
[30;1m544 | [0m[35m            if self.config_parser.get(self.vpc_section_label, "compute_subnet_id", fallback=None):[0m
[30;1m545 | [0m[35m                subnet_field = "compute_subnet_id"[0m
[30;1m546 | [0m[35m            else:[0m
[30;1m547 | [0m[35m                subnet_field = "master_subnet_id"[0m

[31m--[ [0m[34mMatch #[0m[33m620[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m521 | [0m[35m        """Convert SlurmQueue Networking."""[0m
[30;1m522 | [0m[35m        networking = self.convert_base_queue_networking()[0m
[30;1m523 | [0m[35m        placement_group = dict()[0m
[30;1m524 | [0m[35m        placement = self.config_parser.get(queue_section, "placement_group", fallback=None)[0m
[30;1m525 | [0m[35m        if placement == "DYNAMIC":[0m
[30;1m526 | [0m[35m            placement_group["Enabled"] = True[0m
[30;1m527 | [0m[35m        elif placement:[0m

[31m--[ [0m[34mMatch #[0m[33m621[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m508 | [0m[35m                self.vpc_section_label, "vpc_security_group_id", fallback=None[0m
[30;1m509 | [0m[35m            )[0m
[30;1m510 | [0m[35m            _append_if(security_groups, vpc_security_group_id)[0m
[30;1m511 | [0m[35m            additional_sg = self.config_parser.get(self.vpc_section_label, "additional_sg", fallback[0m
[30;1m512 | [0m[35m            _append_if(additional_security_groups, additional_sg)[0m
[30;1m513 | [0m[35m        proxy = dict()[0m
[30;1m514 | [0m[35m        self.convert_single_field(self.cluster_section_name, "proxy_server", proxy, "HttpProxyAddres[0m

[31m--[ [0m[34mMatch #[0m[33m622[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m504 | [0m[35m                (self.vpc_section_label, "use_public_ips", networking, "ElasticIp", "getboolean"),[0m
[30;1m505 | [0m[35m            ]:[0m
[30;1m506 | [0m[35m                self.convert_single_field(*item)[0m
[30;1m507 | [0m[35m            vpc_security_group_id = self.config_parser.get([0m
[30;1m508 | [0m[35m                self.vpc_section_label, "vpc_security_group_id", fallback=None[0m
[30;1m509 | [0m[35m            )[0m
[30;1m510 | [0m[35m            _append_if(security_groups, vpc_security_group_id)[0m

[31m--[ [0m[34mMatch #[0m[33m623[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m446 | [0m[35m        if self.cluster_label:[0m
[30;1m447 | [0m[35m            self.cluster_section_name = f"cluster {self.cluster_label}"[0m
[30;1m448 | [0m[35m        elif self.config_parser.get("global", "cluster_template", fallback=None):[0m
[30;1m449 | [0m[35m            cluster_template = self.config_parser.get("global", "cluster_template", fallback=None)[0m
[30;1m450 | [0m[35m            self.cluster_section_name = f"cluster {cluster_template}"[0m
[30;1m451 | [0m[35m        elif "cluster default" in self.config_parser:[0m
[30;1m452 | [0m[35m            self.cluster_section_name = "cluster default"[0m

[31m--[ [0m[34mMatch #[0m[33m624[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m445 | [0m[35m        """[0m
[30;1m446 | [0m[35m        if self.cluster_label:[0m
[30;1m447 | [0m[35m            self.cluster_section_name = f"cluster {self.cluster_label}"[0m
[30;1m448 | [0m[35m        elif self.config_parser.get("global", "cluster_template", fallback=None):[0m
[30;1m449 | [0m[35m            cluster_template = self.config_parser.get("global", "cluster_template", fallback=None)[0m
[30;1m450 | [0m[35m            self.cluster_section_name = f"cluster {cluster_template}"[0m
[30;1m451 | [0m[35m        elif "cluster default" in self.config_parser:[0m

[31m--[ [0m[34mMatch #[0m[33m625[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m390 | [0m[35m                "getint": self.config_parser.getint,[0m
[30;1m391 | [0m[35m                "getfloat": self.config_parser.getfloat,[0m
[30;1m392 | [0m[35m            }[0m
[30;1m393 | [0m[35m            function = function_map.get(function_name, self.config_parser.get)[0m
[30;1m394 | [0m[35m            attribute = function(pcluster2_model, pcluster2_attribute, fallback=None)[0m
[30;1m395 | [0m[35m            if attribute is not None:[0m
[30;1m396 | [0m[35m                pcluster3_model[pcluster3_attribute] = attribute[0m

[31m--[ [0m[34mMatch #[0m[33m626[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35mdef _get_account_id():[0m
[30;1m39 | [0m[35m    """Get account id from boto3 call."""[0m
[30;1m40 | [0m[35m    return boto3.client("sts").get_caller_identity().get("Account")[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35mdef _error(message):[0m

[31m--[ [0m[34mMatch #[0m[33m627[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1087 | [0m[35m        "--cluster-template",[0m
[30;1m1088 | [0m[35m        help=([0m
[30;1m1089 | [0m[35m            "Indicates the 'cluster' section of the configuration file to convert. "[0m
[30;1m1090 | [0m[35m            "If not specified the script will look for the cluster_template parameter in the [global[0m
[30;1m1091 | [0m[35m            "or will search for '[cluster default]'."[0m
[30;1m1092 | [0m[35m        ),[0m
[30;1m1093 | [0m[35m        required=False,[0m

[31m--[ [0m[34mMatch #[0m[33m628[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m891 | [0m[35m                self.comments += ([0m
[30;1m892 | [0m[35m                    "# The configuration parameters under DevSettings are not officially supported a[0m
[30;1m893 | [0m[35m                    "structure may change\n"[0m
[30;1m894 | [0m[35m                    "# over time without any commitment to be backward compatible.\n"[0m
[30;1m895 | [0m[35m                )[0m
[30;1m896 | [0m[35m            else:[0m
[30;1m897 | [0m[35m                _error([0m

[31m--[ [0m[34mMatch #[0m[33m629[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m580 | [0m[35m[0m
[30;1m581 | [0m[35m    def convert_ssh(self, headnode):[0m
[30;1m582 | [0m[35m        """Convert HeadNode Ssh section."""[0m
[30;1m583 | [0m[35m        ssh = dict()[0m
[30;1m584 | [0m[35m        self.convert_single_field(self.cluster_section_name, "key_name", ssh, "KeyName")[0m
[30;1m585 | [0m[35m        self.convert_single_field(self.vpc_section_label, "ssh_from", ssh, "AllowedIps")[0m
[30;1m586 | [0m[35m        _add_if(headnode, "Ssh", ssh)[0m

[31m--[ [0m[34mMatch #[0m[33m630[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m579 | [0m[35m        )[0m
[30;1m580 | [0m[35m[0m
[30;1m581 | [0m[35m    def convert_ssh(self, headnode):[0m
[30;1m582 | [0m[35m        """Convert HeadNode Ssh section."""[0m
[30;1m583 | [0m[35m        ssh = dict()[0m
[30;1m584 | [0m[35m        self.convert_single_field(self.cluster_section_name, "key_name", ssh, "KeyName")[0m
[30;1m585 | [0m[35m        self.convert_single_field(self.vpc_section_label, "ssh_from", ssh, "AllowedIps")[0m

[31m--[ [0m[34mMatch #[0m[33m631[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m467 | [0m[35m        )[0m
[30;1m468 | [0m[35m        if self.cluster_config_get("scheduler") == "slurm":[0m
[30;1m469 | [0m[35m            message = ([0m
[30;1m470 | [0m[35m                "In AWS ParallelCluster version 3, access to the Instance Metadata Service(IMDS) on [0m
[30;1m471 | [0m[35m                "restricted to the cluster administrator. If additional users required access to IMD[0m
[30;1m472 | [0m[35m                "HeadNode/Imds/Secured to False."[0m
[30;1m473 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m632[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m451 | [0m[35m        elif "cluster default" in self.config_parser:[0m
[30;1m452 | [0m[35m            self.cluster_section_name = "cluster default"[0m
[30;1m453 | [0m[35m        else:[0m
[30;1m454 | [0m[35m            _error("Can not find a valid cluster section.")[0m
[30;1m455 | [0m[35m        if self.cluster_section_name not in self.config_parser.sections():[0m
[30;1m456 | [0m[35m            _error("The specified cluster section is not in the configuration.")[0m
[30;1m457 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m633[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m439 | [0m[35m        """[0m
[30;1m440 | [0m[35m        Validate cluster section name.[0m
[30;1m441 | [0m[35m[0m
[30;1m442 | [0m[35m        If cluster_template is specified in the command, use specifeid cluster_template to find the [0m
[30;1m443 | [0m[35m        If cluster_label is not specified, use cluster template specified in global section.[0m
[30;1m444 | [0m[35m        If no cluster_label sepcified in the cluster section, verify if default cluster section exis[0m
[30;1m445 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m634[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/pcluster3_config_converter.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m3 | [0m[35m#  Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m4 | [0m[35m#[0m
[30;1m5 | [0m[35m#  Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except [0m
[30;1m6 | [0m[35m#  with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#  or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS[0m
[30;1m8 | [0m[35m#  OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governin[0m
[30;1m9 | [0m[35m#  limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m635[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/queues_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m194 | [0m[35m                    "stack_arn": self.stack_id,[0m
[30;1m195 | [0m[35m                    "cluster_s3_bucket": self._cluster_bucket.name,[0m
[30;1m196 | [0m[35m                    "cluster_config_s3_key": "{0}/configs/{1}".format([0m
[30;1m197 | [0m[35m                        self._cluster_bucket.artifact_directory, PCLUSTER_S3_ARTIFACTS_DICT.get("con[0m
[30;1m198 | [0m[35m                    ),[0m
[30;1m199 | [0m[35m                    "cluster_config_version": self._config.config_version,[0m
[30;1m200 | [0m[35m                    "enable_efa": "efa" if compute_resource.efa and compute_resource.efa.enabled els[0m

[31m--[ [0m[34mMatch #[0m[33m636[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/queues_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m    def _get_placement_group_for_compute_resource(queue, managed_placement_groups, compute_resource)[0m
[30;1m77 | [0m[35m        placement_group_settings = queue.get_placement_group_settings_for_compute_resource(compute_r[0m
[30;1m78 | [0m[35m        placement_group_key = placement_group_settings.get("key")[0m
[30;1m79 | [0m[35m        managed = placement_group_settings.get("is_managed")[0m
[30;1m80 | [0m[35m        return managed_placement_groups[placement_group_key].ref if managed else placement_group_key[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m637[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/queues_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m    @staticmethod[0m
[30;1m76 | [0m[35m    def _get_placement_group_for_compute_resource(queue, managed_placement_groups, compute_resource)[0m
[30;1m77 | [0m[35m        placement_group_settings = queue.get_placement_group_settings_for_compute_resource(compute_r[0m
[30;1m78 | [0m[35m        placement_group_key = placement_group_settings.get("key")[0m
[30;1m79 | [0m[35m        managed = placement_group_settings.get("is_managed")[0m
[30;1m80 | [0m[35m        return managed_placement_groups[placement_group_key].ref if managed else placement_group_key[0m
[30;1m81 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m638[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/queues_stack.py[0m
   Pattern: [32m.hostname[0m
[30;1m275 | [0m[35m                    ),[0m
[30;1m276 | [0m[35m                    "custom_node_package": self._config.custom_node_package or "",[0m
[30;1m277 | [0m[35m                    "custom_awsbatchcli_package": self._config.custom_aws_batch_cli_package or "",[0m
[30;1m278 | [0m[35m                    "use_private_hostname": str([0m
[30;1m279 | [0m[35m                        get_attr(self._config, "scheduling.settings.dns.use_ec2_hostnames", default=[0m
[30;1m280 | [0m[35m                    ).lower(),[0m
[30;1m281 | [0m[35m                    "head_node_private_ip": self._head_eni.attr_primary_private_ip_address,[0m

[31m--[ [0m[34mMatch #[0m[33m639[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/queues_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m334 | [0m[35m                                #                        # instead of a comma[0m
[30;1m335 | [0m[35m                                #     | cut -s -d, -f2-  # split over comma (,) and take the right p[0m
[30;1m336 | [0m[35m                                #     | tr ',' '\n'      # convert remaining comma (,) into new line[0m
[30;1m337 | [0m[35m                                #     | sort -un         # sort and unique[0m
[30;1m338 | [0m[35m                                "DisableMultiThreadingManually": ([0m
[30;1m339 | [0m[35m                                    "true" if compute_resource.disable_simultaneous_multithreading_m[0m
[30;1m340 | [0m[35m                                ),[0m

[31m--[ [0m[34mMatch #[0m[33m640[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/queues_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m334 | [0m[35m                                #                        # instead of a comma[0m
[30;1m335 | [0m[35m                                #     | cut -s -d, -f2-  # split over comma (,) and take the right p[0m
[30;1m336 | [0m[35m                                #     | tr ',' '\n'      # convert remaining comma (,) into new line[0m
[30;1m337 | [0m[35m                                #     | sort -un         # sort and unique[0m
[30;1m338 | [0m[35m                                "DisableMultiThreadingManually": ([0m
[30;1m339 | [0m[35m                                    "true" if compute_resource.disable_simultaneous_multithreading_m[0m
[30;1m340 | [0m[35m                                ),[0m

[31m--[ [0m[34mMatch #[0m[33m641[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/queues_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m332 | [0m[35m#     | tr '-' ','       # convert hyphen (-) to comma (,), to account that[0m
[30;1m333 | [0m[35m                                #                        # some kernels and CPU architectures use a [0m
[30;1m334 | [0m[35m                                #                        # instead of a comma[0m
[30;1m335 | [0m[35m                                #     | cut -s -d, -f2-  # split over comma (,) and take the right p[0m
[30;1m336 | [0m[35m                                #     | tr ',' '\n'      # convert remaining comma (,) into new line[0m
[30;1m337 | [0m[35m                                #     | sort -un         # sort and unique[0m

[31m--[ [0m[34mMatch #[0m[33m642[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/queues_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m327 | [0m[35mtechnology-on-amazon-linux/[0m
[30;1m328 | [0m[35m                                # thread_siblings_list contains a comma (,) or dash (-) separated li[0m
[30;1m329 | [0m[35m                                # threads within the same core as cpu[0m
[30;1m330 | [0m[35m                                # e.g. 0-1 or 0,1[0m
[30;1m331 | [0m[35m                                # cat /sys/devices/system/cpu/cpu*/topology/thread_siblings_list[0m
[30;1m332 | [0m[35m                                #     | tr '-' ','       # convert hyphen (-) to comma (,), to accou[0m
[30;1m333 | [0m[35m                                #                        # some kernels and CPU architectures use a [0m

[31m--[ [0m[34mMatch #[0m[33m643[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/queues_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m325 | [0m[35m                            **{[0m
[30;1m326 | [0m[35m                                # Disable multithreading using logic from[0m
[30;1m327 | [0m[35m                                # https://aws.amazon.com/blogs/compute/disabling-intel-hyper-threadi[0m
[30;1m328 | [0m[35m                                # thread_siblings_list contains a comma (,) or dash (-) separated li[0m
[30;1m329 | [0m[35m                                # threads within the same core as cpu[0m
[30;1m330 | [0m[35m                                # e.g. 0-1 or 0,1[0m
[30;1m331 | [0m[35m                                # cat /sys/devices/system/cpu/cpu*/topology/thread_siblings_list[0m

[31m--[ [0m[34mMatch #[0m[33m644[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/s3_bucket.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m291 | [0m[35m            file_content = response["Body"].read().decode("utf-8")[0m
[30;1m292 | [0m[35m            try:[0m
[30;1m293 | [0m[35m                bootstrapped_info = json.loads(file_content)[0m
[30;1m294 | [0m[35m                bootstrapped_features = bootstrapped_info.get("bootstrapped_features", [])[0m
[30;1m295 | [0m[35m            except json.JSONDecodeError:[0m
[30;1m296 | [0m[35m                # The bootstrap file old format is a simple String "bucket is configured successfull[0m
[30;1m297 | [0m[35m                LOGGER.info("Bootstrap file is in old format. Assuming basic features are bootstrapp[0m

[31m--[ [0m[34mMatch #[0m[33m645[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/s3_bucket.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m646[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/s3_bucket.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m513 | [0m[35m    """Generate a presigned URL to share an S3 object.[0m
[30;1m514 | [0m[35m[0m
[30;1m515 | [0m[35m    :param s3_uri: s3 uri, e.g. s3://my.bucket/my.object[0m
[30;1m516 | [0m[35m    :param expiration: Time in seconds for the presigned URL to remain valid[0m
[30;1m517 | [0m[35m    :return: Presigned URL as string[0m
[30;1m518 | [0m[35m    """[0m
[30;1m519 | [0m[35m    s3_uri_info = parse_bucket_url(s3_uri)[0m

[31m--[ [0m[34mMatch #[0m[33m647[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/imagebuilder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m766 | [0m[35m                    log_group_name=self._log_group_name, next_token=next_token[0m
[30;1m767 | [0m[35m                )[0m
[30;1m768 | [0m[35m                log_streams.extend(log_stream_resp["logStreams"])[0m
[30;1m769 | [0m[35m                next_token = log_stream_resp.get("nextToken")[0m
[30;1m770 | [0m[35m            else:[0m
[30;1m771 | [0m[35m                LOGGER.debug("Log Group %s doesn't exist.", self._log_group_name)[0m
[30;1m772 | [0m[35m                raise NotFoundImageBuilderActionError([0m

[31m--[ [0m[34mMatch #[0m[33m648[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/imagebuilder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m655 | [0m[35m            {"key": PCLUSTER_IMAGE_CONFIG_TAG, "value": self.config_url},[0m
[30;1m656 | [0m[35m        ][0m
[30;1m657 | [0m[35m        for tag in tag_list:[0m
[30;1m658 | [0m[35m            cfn_tags.append(BaseTag(key=tag.get("key"), value=tag.get("value")))[0m
[30;1m659 | [0m[35m        return [{"Key": tag.key, "Value": tag.value} for tag in cfn_tags][0m
[30;1m660 | [0m[35m[0m
[30;1m661 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m649[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/imagebuilder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m655 | [0m[35m            {"key": PCLUSTER_IMAGE_CONFIG_TAG, "value": self.config_url},[0m
[30;1m656 | [0m[35m        ][0m
[30;1m657 | [0m[35m        for tag in tag_list:[0m
[30;1m658 | [0m[35m            cfn_tags.append(BaseTag(key=tag.get("key"), value=tag.get("value")))[0m
[30;1m659 | [0m[35m        return [{"Key": tag.key, "Value": tag.value} for tag in cfn_tags][0m
[30;1m660 | [0m[35m[0m
[30;1m661 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m650[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/imagebuilder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m641 | [0m[35m    def _get_cfn_tags(self):[0m
[30;1m642 | [0m[35m        """Get cfn tags."""[0m
[30;1m643 | [0m[35m        cfn_tags = copy.deepcopy(self.config.build.tags) or [][0m
[30;1m644 | [0m[35m        self.__config_url = self.bucket.get_config_s3_url(self._s3_artifacts_dict.get("config_name")[0m
[30;1m645 | [0m[35m        tag_list = [[0m
[30;1m646 | [0m[35m            {[0m
[30;1m647 | [0m[35m                "key": PCLUSTER_IMAGE_NAME_TAG,[0m

[31m--[ [0m[34mMatch #[0m[33m651[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/imagebuilder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m534 | [0m[35m[0m
[30;1m535 | [0m[35m            resources = pkg_resources.resource_filename(__name__, "../resources/custom_resources")[0m
[30;1m536 | [0m[35m            self.bucket.upload_resources([0m
[30;1m537 | [0m[35m                resource_dir=resources, custom_artifacts_name=self._s3_artifacts_dict.get("custom_ar[0m
[30;1m538 | [0m[35m            )[0m
[30;1m539 | [0m[35m        except Exception as e:[0m
[30;1m540 | [0m[35m            raise _imagebuilder_error_mapper([0m

[31m--[ [0m[34mMatch #[0m[33m652[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/imagebuilder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m530 | [0m[35m        try:[0m
[30;1m531 | [0m[35m            if self.template_body:[0m
[30;1m532 | [0m[35m                # upload cfn template[0m
[30;1m533 | [0m[35m                self.bucket.upload_cfn_template(self.template_body, self._s3_artifacts_dict.get("tem[0m
[30;1m534 | [0m[35m[0m
[30;1m535 | [0m[35m            resources = pkg_resources.resource_filename(__name__, "../resources/custom_resources")[0m
[30;1m536 | [0m[35m            self.bucket.upload_resources([0m

[31m--[ [0m[34mMatch #[0m[33m653[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/imagebuilder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m503 | [0m[35m                # Upload original config[0m
[30;1m504 | [0m[35m                self.bucket.upload_config([0m
[30;1m505 | [0m[35m                    config=self.source_config_text,[0m
[30;1m506 | [0m[35m                    config_name=self._s3_artifacts_dict.get("config_name"),[0m
[30;1m507 | [0m[35m                    format=S3FileFormat.TEXT,[0m
[30;1m508 | [0m[35m                )[0m
[30;1m509 | [0m[35m        except Exception as e:[0m

[31m--[ [0m[34mMatch #[0m[33m654[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/imagebuilder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m474 | [0m[35m            creation_result = AWSApi.instance().cfn.create_stack_from_url([0m
[30;1m475 | [0m[35m                stack_name=self.image_id,[0m
[30;1m476 | [0m[35m                template_url=self.bucket.get_cfn_template_url([0m
[30;1m477 | [0m[35m                    template_name=self._s3_artifacts_dict.get("template_name")[0m
[30;1m478 | [0m[35m                ),[0m
[30;1m479 | [0m[35m                disable_rollback=disable_rollback,[0m
[30;1m480 | [0m[35m                tags=self._get_cfn_tags(),[0m

[31m--[ [0m[34mMatch #[0m[33m655[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/imagebuilder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m399 | [0m[35m            [[0m
[30;1m400 | [0m[35m                self._s3_artifacts_dict.get("root_directory"),[0m
[30;1m401 | [0m[35m                get_installed_version(),[0m
[30;1m402 | [0m[35m                self._s3_artifacts_dict.get("root_image_directory"),[0m
[30;1m403 | [0m[35m                service_directory,[0m
[30;1m404 | [0m[35m            ][0m
[30;1m405 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m656[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/imagebuilder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m397 | [0m[35m        service_directory = generate_random_name_with_prefix(self.image_id)[0m
[30;1m398 | [0m[35m        self.__s3_artifact_dir = "/".join([0m
[30;1m399 | [0m[35m            [[0m
[30;1m400 | [0m[35m                self._s3_artifacts_dict.get("root_directory"),[0m
[30;1m401 | [0m[35m                get_installed_version(),[0m
[30;1m402 | [0m[35m                self._s3_artifacts_dict.get("root_image_directory"),[0m
[30;1m403 | [0m[35m                service_directory,[0m

[31m--[ [0m[34mMatch #[0m[33m657[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/imagebuilder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m    @property[0m
[30;1m261 | [0m[35m    def presigned_config_url(self) -> str:[0m
[30;1m262 | [0m[35m        """Return a pre-signed Url to download the config from the S3 bucket."""[0m
[30;1m263 | [0m[35m        return self.bucket.get_config_presigned_url(config_name=PCLUSTER_S3_ARTIFACTS_DICT.get("imag[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m    @property[0m
[30;1m266 | [0m[35m    def stack(self):[0m

[31m--[ [0m[34mMatch #[0m[33m658[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/imagebuilder.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m247 | [0m[35m        if not self.__config_url:[0m
[30;1m248 | [0m[35m            # get config url in build image command[0m
[30;1m249 | [0m[35m            if self.__source_config_text:[0m
[30;1m250 | [0m[35m                self.__config_url = self.bucket.get_config_s3_url(self._s3_artifacts_dict.get("confi[0m
[30;1m251 | [0m[35m            else:[0m
[30;1m252 | [0m[35m                if self.__image:[0m
[30;1m253 | [0m[35m                    self.__config_url = self.image.config_url[0m

[31m--[ [0m[34mMatch #[0m[33m659[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/imagebuilder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m825 | [0m[35m            if e.message.startswith("The specified log group"):[0m
[30;1m826 | [0m[35m                LOGGER.debug("Log Group %s doesn't exist.", self._log_group_name)[0m
[30;1m827 | [0m[35m                raise NotFoundImageBuilderActionError([0m
[30;1m828 | [0m[35m                    ("Unable to find image logs, please double check if image id=" f"{self.image_id}[0m
[30;1m829 | [0m[35m                )[0m
[30;1m830 | [0m[35m            if e.message.startswith("The specified log stream"):[0m
[30;1m831 | [0m[35m                LOGGER.debug("Log Stream %s doesn't exist.", log_stream_name)[0m

[31m--[ [0m[34mMatch #[0m[33m660[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/imagebuilder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m802 | [0m[35m[0m
[30;1m803 | [0m[35m        :param log_stream_name: Log stream name[0m
[30;1m804 | [0m[35m        :param start_time: Start time of interval of interest for log events. ISO 8601 format: YYYY-[0m
[30;1m805 | [0m[35m        :param end_time: End time of interval of interest for log events. ISO 8601 format: YYYY-MM-D[0m
[30;1m806 | [0m[35m        :param start_from_head: If the value is true, the earliest log events are returned first.[0m
[30;1m807 | [0m[35m            If the value is false, the latest log events are returned first. The default value is fa[0m
[30;1m808 | [0m[35m        :param limit: The maximum number of log events returned. If you don't specify a value,[0m

[31m--[ [0m[34mMatch #[0m[33m661[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/imagebuilder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m801 | [0m[35m        Get the log stream events.[0m
[30;1m802 | [0m[35m[0m
[30;1m803 | [0m[35m        :param log_stream_name: Log stream name[0m
[30;1m804 | [0m[35m        :param start_time: Start time of interval of interest for log events. ISO 8601 format: YYYY-[0m
[30;1m805 | [0m[35m        :param end_time: End time of interval of interest for log events. ISO 8601 format: YYYY-MM-D[0m
[30;1m806 | [0m[35m        :param start_from_head: If the value is true, the earliest log events are returned first.[0m
[30;1m807 | [0m[35m            If the value is false, the latest log events are returned first. The default value is fa[0m

[31m--[ [0m[34mMatch #[0m[33m662[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/imagebuilder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m770 | [0m[35m            else:[0m
[30;1m771 | [0m[35m                LOGGER.debug("Log Group %s doesn't exist.", self._log_group_name)[0m
[30;1m772 | [0m[35m                raise NotFoundImageBuilderActionError([0m
[30;1m773 | [0m[35m                    ("Unable to find image logs, please double check if image id=" f"{self.image_id}[0m
[30;1m774 | [0m[35m                )[0m
[30;1m775 | [0m[35m[0m
[30;1m776 | [0m[35m            return LogStreams(log_streams, next_token)[0m

[31m--[ [0m[34mMatch #[0m[33m663[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/imagebuilder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m687 | [0m[35m               also serves as top-level directory in resulting archive[0m
[30;1m688 | [0m[35m        :param keep_s3_objects: Keep the exported objects exports to S3. The default behavior is to [0m
[30;1m689 | [0m[35m        :param start_time: Start time of interval of interest for log events. ISO 8601 format: YYYY-[0m
[30;1m690 | [0m[35m        :param end_time: End time of interval of interest for log events. ISO 8601 format: YYYY-MM-D[0m
[30;1m691 | [0m[35m        """[0m
[30;1m692 | [0m[35m        # check stack[0m
[30;1m693 | [0m[35m        stack_exists = self._stack_exists()[0m

[31m--[ [0m[34mMatch #[0m[33m664[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/imagebuilder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m686 | [0m[35m        :param bucket_prefix: Key path under which exported logs data will be stored in s3 bucket,[0m
[30;1m687 | [0m[35m               also serves as top-level directory in resulting archive[0m
[30;1m688 | [0m[35m        :param keep_s3_objects: Keep the exported objects exports to S3. The default behavior is to [0m
[30;1m689 | [0m[35m        :param start_time: Start time of interval of interest for log events. ISO 8601 format: YYYY-[0m
[30;1m690 | [0m[35m        :param end_time: End time of interval of interest for log events. ISO 8601 format: YYYY-MM-D[0m
[30;1m691 | [0m[35m        """[0m
[30;1m692 | [0m[35m        # check stack[0m

[31m--[ [0m[34mMatch #[0m[33m665[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/imagebuilder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m371 | [0m[35m            s3_artifact_dir = self.image.s3_artifact_directory[0m
[30;1m372 | [0m[35m        except ImageError as e:[0m
[30;1m373 | [0m[35m            if not isinstance(e, NonExistingImageError):[0m
[30;1m374 | [0m[35m                LOGGER.error("Unable to find tag %s in image %s.", PCLUSTER_S3_IMAGE_DIR_TAG, self.i[0m
[30;1m375 | [0m[35m                raise _imagebuilder_error_mapper(e, f"Unable to get artifact directory from image {s[0m
[30;1m376 | [0m[35m[0m
[30;1m377 | [0m[35m        if s3_artifact_dir is None:[0m

[31m--[ [0m[34mMatch #[0m[33m666[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/imagebuilder.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m667[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_operations_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m394 | [0m[35m        image_id=image.pcluster_image_id,[0m
[30;1m395 | [0m[35m        image_build_status=ImageBuildStatus.BUILD_COMPLETE,[0m
[30;1m396 | [0m[35m        ec2_ami_info=Ec2AmiInfoSummary(ami_id=image.id),[0m
[30;1m397 | [0m[35m        region=os_lib.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m398 | [0m[35m        version=image.version,[0m
[30;1m399 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m668[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_operations_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m384 | [0m[35m        image_build_status=cloud_formation_status_to_image_status(stack.status),[0m
[30;1m385 | [0m[35m        cloudformation_stack_status=stack.status,[0m
[30;1m386 | [0m[35m        cloudformation_stack_arn=stack.id,[0m
[30;1m387 | [0m[35m        region=os_lib.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m388 | [0m[35m        version=stack.version,[0m
[30;1m389 | [0m[35m    )[0m
[30;1m390 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m669[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_operations_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m375 | [0m[35m            CloudFormationStackStatus.ROLLBACK_IN_PROGRESS,[0m
[30;1m376 | [0m[35m        },[0m
[30;1m377 | [0m[35m    }[0m
[30;1m378 | [0m[35m    return mapping.get(image_status, set())[0m
[30;1m379 | [0m[35m[0m
[30;1m380 | [0m[35m[0m
[30;1m381 | [0m[35mdef _imagebuilder_stack_to_image_info_summary(stack):[0m

[31m--[ [0m[34mMatch #[0m[33m670[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_operations_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m263 | [0m[35m        cloudformation_stack_arn=imagebuilder.stack.id,[0m
[30;1m264 | [0m[35m        cloudformation_stack_creation_time=to_utc_datetime(imagebuilder.stack.creation_time),[0m
[30;1m265 | [0m[35m        cloudformation_stack_tags=[Tag(key=tag["Key"], value=tag["Value"]) for tag in imagebuilder.s[0m
[30;1m266 | [0m[35m        region=os_lib.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m267 | [0m[35m        version=imagebuilder.stack.version,[0m
[30;1m268 | [0m[35m    )[0m
[30;1m269 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m671[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_operations_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m257 | [0m[35m        image_build_status=imagebuilder.imagebuild_status,[0m
[30;1m258 | [0m[35m        image_build_logs_arn=imagebuilder.stack.build_log,[0m
[30;1m259 | [0m[35m        imagebuilder_image_status=imagebuilder_image_state.get("status", None),[0m
[30;1m260 | [0m[35m        imagebuilder_image_status_reason=imagebuilder_image_state.get("reason", None),[0m
[30;1m261 | [0m[35m        cloudformation_stack_status=imagebuilder.stack.status,[0m
[30;1m262 | [0m[35m        cloudformation_stack_status_reason=imagebuilder.stack.status_reason,[0m
[30;1m263 | [0m[35m        cloudformation_stack_arn=imagebuilder.stack.id,[0m

[31m--[ [0m[34mMatch #[0m[33m672[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_operations_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m256 | [0m[35m        image_id=imagebuilder.image_id,[0m
[30;1m257 | [0m[35m        image_build_status=imagebuilder.imagebuild_status,[0m
[30;1m258 | [0m[35m        image_build_logs_arn=imagebuilder.stack.build_log,[0m
[30;1m259 | [0m[35m        imagebuilder_image_status=imagebuilder_image_state.get("status", None),[0m
[30;1m260 | [0m[35m        imagebuilder_image_status_reason=imagebuilder_image_state.get("reason", None),[0m
[30;1m261 | [0m[35m        cloudformation_stack_status=imagebuilder.stack.status,[0m
[30;1m262 | [0m[35m        cloudformation_stack_status_reason=imagebuilder.stack.status_reason,[0m

[31m--[ [0m[34mMatch #[0m[33m673[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_operations_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m244 | [0m[35m            architecture=imagebuilder.image.architecture,[0m
[30;1m245 | [0m[35m            description=imagebuilder.image.description,[0m
[30;1m246 | [0m[35m        ),[0m
[30;1m247 | [0m[35m        region=os_lib.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m248 | [0m[35m        version=imagebuilder.image.version,[0m
[30;1m249 | [0m[35m    )[0m
[30;1m250 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m674[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_operations_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m173 | [0m[35m            image_build_status=ImageBuildStatus.DELETE_IN_PROGRESS,[0m
[30;1m174 | [0m[35m            cloudformation_stack_status=CloudFormationStackStatus.DELETE_IN_PROGRESS if stack else N[0m
[30;1m175 | [0m[35m            cloudformation_stack_arn=stack.id if stack else None,[0m
[30;1m176 | [0m[35m            region=os_lib.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m177 | [0m[35m            version=stack.version if stack else image.version,[0m
[30;1m178 | [0m[35m        )[0m
[30;1m179 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m675[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/image_operations_controller.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m676[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/config_patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m        # Then, compare all non visited base sections vs target config.[0m
[30;1m213 | [0m[35m        if base_section:[0m
[30;1m214 | [0m[35m            for base_nested_section in base_section.get(data_key, []):[0m
[30;1m215 | [0m[35m                if not base_nested_section.get("visited", False):[0m
[30;1m216 | [0m[35m                    self.changes.append([0m
[30;1m217 | [0m[35m                        Change([0m
[30;1m218 | [0m[35m                            param_path,[0m

[31m--[ [0m[34mMatch #[0m[33m677[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/config_patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m211 | [0m[35m                )[0m
[30;1m212 | [0m[35m        # Then, compare all non visited base sections vs target config.[0m
[30;1m213 | [0m[35m        if base_section:[0m
[30;1m214 | [0m[35m            for base_nested_section in base_section.get(data_key, []):[0m
[30;1m215 | [0m[35m                if not base_nested_section.get("visited", False):[0m
[30;1m216 | [0m[35m                    self.changes.append([0m
[30;1m217 | [0m[35m                        Change([0m

[31m--[ [0m[34mMatch #[0m[33m678[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/config_patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m189 | [0m[35m                ([0m
[30;1m190 | [0m[35m                    nested_section[0m
[30;1m191 | [0m[35m                    for nested_section in base_section.get(data_key, [])[0m
[30;1m192 | [0m[35m                    if nested_section.get(update_key) == update_key_value[0m
[30;1m193 | [0m[35m                ),[0m
[30;1m194 | [0m[35m                None,[0m
[30;1m195 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m679[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/config_patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m188 | [0m[35m            base_nested_section = next([0m
[30;1m189 | [0m[35m                ([0m
[30;1m190 | [0m[35m                    nested_section[0m
[30;1m191 | [0m[35m                    for nested_section in base_section.get(data_key, [])[0m
[30;1m192 | [0m[35m                    if nested_section.get(update_key) == update_key_value[0m
[30;1m193 | [0m[35m                ),[0m
[30;1m194 | [0m[35m                None,[0m

[31m--[ [0m[34mMatch #[0m[33m680[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/config_patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m        # Compare items in the list by searching the right item to compare through update_key value[0m
[30;1m185 | [0m[35m        # First, compare all sections from target vs base config and mark visited base sections.[0m
[30;1m186 | [0m[35m        for target_nested_section in target_section.get(data_key, []):[0m
[30;1m187 | [0m[35m            update_key_value = target_nested_section.get(update_key)[0m
[30;1m188 | [0m[35m            base_nested_section = next([0m
[30;1m189 | [0m[35m                ([0m
[30;1m190 | [0m[35m                    nested_section[0m

[31m--[ [0m[34mMatch #[0m[33m681[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/config_patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m        # Compare items in the list by searching the right item to compare through update_key value[0m
[30;1m185 | [0m[35m        # First, compare all sections from target vs base config and mark visited base sections.[0m
[30;1m186 | [0m[35m        for target_nested_section in target_section.get(data_key, []):[0m
[30;1m187 | [0m[35m            update_key_value = target_nested_section.get(update_key)[0m
[30;1m188 | [0m[35m            base_nested_section = next([0m
[30;1m189 | [0m[35m                ([0m

[31m--[ [0m[34mMatch #[0m[33m682[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/config_patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m        If update_key is not set we're considering Name as identifier.[0m
[30;1m181 | [0m[35m        """[0m
[30;1m182 | [0m[35m        update_key = field_obj.metadata.get("update_key")[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m        # Compare items in the list by searching the right item to compare through update_key value[0m
[30;1m185 | [0m[35m        # First, compare all sections from target vs base config and mark visited base sections.[0m

[31m--[ [0m[34mMatch #[0m[33m683[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/config_patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m162 | [0m[35m            if data_key == "Script" and value is None:[0m
[30;1m163 | [0m[35m                # This handles special case when multiple installation scripts are provided.[0m
[30;1m164 | [0m[35m                # The schema of script sequence is customized. The following code correctly detect c[0m
[30;1m165 | [0m[35m                value = section.get("Sequence", None)[0m
[30;1m166 | [0m[35m                if value:[0m
[30;1m167 | [0m[35m                    data_key = "Sequence"[0m
[30;1m168 | [0m[35m        return value, data_key[0m

[31m--[ [0m[34mMatch #[0m[33m684[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/config_patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m158 | [0m[35m    def _get_value_from_section(self, data_key, section):[0m
[30;1m159 | [0m[35m        value = None[0m
[30;1m160 | [0m[35m        if section:[0m
[30;1m161 | [0m[35m            value = section.get(data_key, None)[0m
[30;1m162 | [0m[35m            if data_key == "Script" and value is None:[0m
[30;1m163 | [0m[35m                # This handles special case when multiple installation scripts are provided.[0m
[30;1m164 | [0m[35m                # The schema of script sequence is customized. The following code correctly detect c[0m

[31m--[ [0m[34mMatch #[0m[33m685[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/config_patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m114 | [0m[35m                else:[0m
[30;1m115 | [0m[35m                    # Single nested section[0m
[30;1m116 | [0m[35m                    target_value = target_section.get(data_key, None) if target_section else None[0m
[30;1m117 | [0m[35m                    base_value = base_section.get(data_key, None) if base_section else None[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m                    if target_value and base_value:[0m
[30;1m120 | [0m[35m                        self._compare_nested_section(param_path, data_key, base_value, target_value,[0m

[31m--[ [0m[34mMatch #[0m[33m686[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/config_patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m113 | [0m[35m                    )[0m
[30;1m114 | [0m[35m                else:[0m
[30;1m115 | [0m[35m                    # Single nested section[0m
[30;1m116 | [0m[35m                    target_value = target_section.get(data_key, None) if target_section else None[0m
[30;1m117 | [0m[35m                    base_value = base_section.get(data_key, None) if base_section else None[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m                    if target_value and base_value:[0m

[31m--[ [0m[34mMatch #[0m[33m687[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/config_patch.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m            is_nested_section = hasattr(field_obj, "nested")[0m
[30;1m105 | [0m[35m            is_list = hasattr(field_obj, "many") and field_obj.many[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m            change_update_policy = field_obj.metadata.get("update_policy", UpdatePolicy.UNSUPPORTED)[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m            if is_nested_section:[0m
[30;1m110 | [0m[35m                if is_list:[0m

[31m--[ [0m[34mMatch #[0m[33m688[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/config_patch.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m227 | [0m[35m    @property[0m
[30;1m228 | [0m[35m    def update_policy_level(self):[0m
[30;1m229 | [0m[35m        """[0m
[30;1m230 | [0m[35m        Get the max update policy level of the ConfigPatch.[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m        This method provides a static indication of the actual applicability of the patch and it's m[0m
[30;1m233 | [0m[35m        purposes. The real applicability of a patch, which involves dynamic condition checks, must b[0m

[31m--[ [0m[34mMatch #[0m[33m689[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/config_patch.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m40 | [0m[35m        - target_config: the target configuration; namely the new configuration wanted by the user.[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m    The patch will contain all the changes that will be needed to transform the base configuration i[0m
[30;1m43 | [0m[35m    Together with each change, a check will be performed based on the Update Policy of the related p[0m
[30;1m44 | [0m[35m    result will be returned with one of the following values:[0m
[30;1m45 | [0m[35m        - SUCCEEDED: The change can be safely done[0m
[30;1m46 | [0m[35m        - ACTION NEEDED: The change could be done but an action is needed from the user to unlock it[0m

[31m--[ [0m[34mMatch #[0m[33m690[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/config_patch.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m691[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/config_patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m161 | [0m[35m            value = section.get(data_key, None)[0m
[30;1m162 | [0m[35m            if data_key == "Script" and value is None:[0m
[30;1m163 | [0m[35m                # This handles special case when multiple installation scripts are provided.[0m
[30;1m164 | [0m[35m                # The schema of script sequence is customized. The following code correctly detect c[0m
[30;1m165 | [0m[35m                value = section.get("Sequence", None)[0m
[30;1m166 | [0m[35m                if value:[0m
[30;1m167 | [0m[35m                    data_key = "Sequence"[0m

[31m--[ [0m[34mMatch #[0m[33m692[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/config_patch.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35mclass ConfigPatch:[0m
[30;1m35 | [0m[35m    """[0m
[30;1m36 | [0m[35m    Represents the Diff Patch between two PclusterConfig instances.[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    The two configurations that must be provided to create the patch are:[0m
[30;1m39 | [0m[35m        - base_config: the original configuration[0m

[31m--[ [0m[34mMatch #[0m[33m693[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/slurm_settings_validator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m194 | [0m[35m    def _validate(self, database, external_slurmdbd):[0m
[30;1m195 | [0m[35m        if (database is not None) and (external_slurmdbd is not None):[0m
[30;1m196 | [0m[35m            self._add_failure([0m
[30;1m197 | [0m[35m                "Database and ExternalSlurmdbd cannot be defined at the same time within SlurmSettin[0m
[30;1m198 | [0m[35m                FailureLevel.ERROR,[0m
[30;1m199 | [0m[35m            )[0m
[30;1m200 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m694[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/slurm_settings_validator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m187 | [0m[35m    """[0m
[30;1m188 | [0m[35m    External Slurmdbd vs Database Validator.[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m    This validator checks that ExternalSlurmdbd and Database are not defined at the same time in the[0m
[30;1m191 | [0m[35m    configuration within SlurmSettings.[0m
[30;1m192 | [0m[35m    """[0m
[30;1m193 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m695[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/slurm_settings_validator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m177 | [0m[35m                f"other dynamic nodes in the same queue. "[0m
[30;1m178 | [0m[35m                f"The following static node priorities are higher than or equal to the minimum dynam[0m
[30;1m179 | [0m[35m                f"({min_dynamic}): {bad_static_priorities}. "[0m
[30;1m180 | [0m[35m                f"The following dynamic node priorities are lower than or equal to the maximum stati[0m
[30;1m181 | [0m[35m                f"({max_static}): {bad_dynamic_priorities}.",[0m
[30;1m182 | [0m[35m                FailureLevel.WARNING,[0m
[30;1m183 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m696[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/slurm_settings_validator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m175 | [0m[35m            self._add_failure([0m
[30;1m176 | [0m[35m                f"Some compute resources in queue {queue_name} have static nodes with higher or equa[0m
[30;1m177 | [0m[35m                f"other dynamic nodes in the same queue. "[0m
[30;1m178 | [0m[35m                f"The following static node priorities are higher than or equal to the minimum dynam[0m
[30;1m179 | [0m[35m                f"({min_dynamic}): {bad_static_priorities}. "[0m
[30;1m180 | [0m[35m                f"The following dynamic node priorities are lower than or equal to the maximum stati[0m
[30;1m181 | [0m[35m                f"({max_static}): {bad_dynamic_priorities}.",[0m

[31m--[ [0m[34mMatch #[0m[33m697[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/slurm_settings_validator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m163 | [0m[35m        dy_priorities = {cr.name: cr.dynamic_node_priority for cr in compute_resources if cr.max_cou[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m        # If no compute resources have any static or dynamic nodes, we set these thresholds to impos[0m
[30;1m166 | [0m[35m        # node priority...[0m
[30;1m167 | [0m[35m        max_static = max(st_priorities.values()) if len(st_priorities) > 0 else MIN_SLURM_NODE_PRIOR[0m
[30;1m168 | [0m[35m        min_dynamic = min(dy_priorities.values()) if len(dy_priorities) > 0 else MAX_SLURM_NODE_PRIO[0m
[30;1m169 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m698[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/slurm_settings_validator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m154 | [0m[35m    """[0m
[30;1m155 | [0m[35m    Slurm Node Weights Warning Validator.[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m    This validator checks, within a queue, whether any dynamic nodes have lower node weights than an[0m
[30;1m158 | [0m[35m    nodes and throws a warning if that's the case.[0m
[30;1m159 | [0m[35m    """[0m
[30;1m160 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m699[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/slurm_settings_validator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35mclass SlurmNodePrioritiesWarningValidator(Validator):[0m
[30;1m154 | [0m[35m    """[0m
[30;1m155 | [0m[35m    Slurm Node Weights Warning Validator.[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m    This validator checks, within a queue, whether any dynamic nodes have lower node weights than an[0m
[30;1m158 | [0m[35m    nodes and throws a warning if that's the case.[0m

[31m--[ [0m[34mMatch #[0m[33m700[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/slurm_settings_validator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m127 | [0m[35m        if bad_nodelists:[0m
[30;1m128 | [0m[35m            nodelists = ", ".join(sorted(bad_nodelists))[0m
[30;1m129 | [0m[35m            self._add_failure([0m
[30;1m130 | [0m[35m                f"Substrings '-st-' and '-dy-' in node names are reserved for nodes managed by Paral[0m
[30;1m131 | [0m[35m                f"Please rename the following custom Slurm nodes: {nodelists}",[0m
[30;1m132 | [0m[35m                FailureLevel.ERROR,[0m
[30;1m133 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m701[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/slurm_settings_validator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m109 | [0m[35m    Custom Slurm Nodelists Names validator.[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    This validator ensures that any eventual custom node list passed via SlurmSettings/CustomSlurmSe[0m
[30;1m112 | [0m[35m    does not contain the `-st-` or `-dy-` patterns in the node names, as this would cause the Parall[0m
[30;1m113 | [0m[35m    daemons to interfere with them.[0m
[30;1m114 | [0m[35m    """[0m
[30;1m115 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m702[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/slurm_settings_validator.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m108 | [0m[35m    """[0m
[30;1m109 | [0m[35m    Custom Slurm Nodelists Names validator.[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    This validator ensures that any eventual custom node list passed via SlurmSettings/CustomSlurmSe[0m
[30;1m112 | [0m[35m    does not contain the `-st-` or `-dy-` patterns in the node names, as this would cause the Parall[0m
[30;1m113 | [0m[35m    daemons to interfere with them.[0m
[30;1m114 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m703[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/slurm_settings_validator.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m194 | [0m[35m    def _validate(self, database, external_slurmdbd):[0m
[30;1m195 | [0m[35m        if (database is not None) and (external_slurmdbd is not None):[0m
[30;1m196 | [0m[35m            self._add_failure([0m
[30;1m197 | [0m[35m                "Database and ExternalSlurmdbd cannot be defined at the same time within SlurmSettin[0m
[30;1m198 | [0m[35m                FailureLevel.ERROR,[0m
[30;1m199 | [0m[35m            )[0m
[30;1m200 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m704[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/slurm_settings_validator.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m187 | [0m[35m    """[0m
[30;1m188 | [0m[35m    External Slurmdbd vs Database Validator.[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m    This validator checks that ExternalSlurmdbd and Database are not defined at the same time in the[0m
[30;1m191 | [0m[35m    configuration within SlurmSettings.[0m
[30;1m192 | [0m[35m    """[0m
[30;1m193 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m705[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/slurm_settings_validator.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m99 | [0m[35m        if len(denied_settings) > 0:[0m
[30;1m100 | [0m[35m            settings = ",".join(sorted(denied_settings))[0m
[30;1m101 | [0m[35m            self._add_failure([0m
[30;1m102 | [0m[35m                f"Using the following custom Slurm settings at {settings_level.value} level is not a[0m
[30;1m103 | [0m[35m                FailureLevel.ERROR,[0m
[30;1m104 | [0m[35m            )[0m
[30;1m105 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m706[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/slurm_settings_validator.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2023 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m707[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/errors.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35mclass InternalServiceException(ParallelClusterApiException):[0m
[30;1m109 | [0m[35m    """Exception raised for internal service errors."""[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    code = 500[0m
[30;1m112 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m708[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/errors.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m        if exception.error_code in AWSClientError.ErrorCode.throttling_error_codes():[0m
[30;1m38 | [0m[35m            return exception_message(LimitExceededException(str(exception)))[0m
[30;1m39 | [0m[35m        return exception_message([0m
[30;1m40 | [0m[35m            InternalServiceException(f"Failed when calling AWS service in {exception.function_name}:[0m
[30;1m41 | [0m[35m        )[0m
[30;1m42 | [0m[35m    elif isinstance(exception, ParallelClusterApiException):[0m
[30;1m43 | [0m[35m        return exception.content[0m

[31m--[ [0m[34mMatch #[0m[33m709[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/errors.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35mclass UpdateClusterBadRequestException(ParallelClusterApiException):[0m
[30;1m91 | [0m[35m    """Exception raised when receiving an invalid cluster config on an update operation."""[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m    code = 400[0m
[30;1m94 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m710[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/errors.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m54 | [0m[35m    else:[0m
[30;1m55 | [0m[35m        return {[0m
[30;1m56 | [0m[35m            "message": "Unexpected fatal exception. "[0m
[30;1m57 | [0m[35m            "Please look at the application logs for details on the encountered failure."[0m
[30;1m58 | [0m[35m        }[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m711[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/errors.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m712[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/login_nodes_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m535 | [0m[35m                self._shared_storage_infos,[0m
[30;1m536 | [0m[35m                self._shared_storage_mount_dirs,[0m
[30;1m537 | [0m[35m                self._shared_storage_attributes,[0m
[30;1m538 | [0m[35m                self._login_security_groups.get(pool.name),[0m
[30;1m539 | [0m[35m                self.stack_name,[0m
[30;1m540 | [0m[35m                self.stack_id,[0m
[30;1m541 | [0m[35m                self._head_eni,[0m

[31m--[ [0m[34mMatch #[0m[33m713[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/login_nodes_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m212 | [0m[35m                    "cluster_user": OS_MAPPING[self._config.image.os]["user"],[0m
[30;1m213 | [0m[35m                    "cluster_s3_bucket": self._cluster_bucket.name,[0m
[30;1m214 | [0m[35m                    "cluster_config_s3_key": "{0}/configs/{1}".format([0m
[30;1m215 | [0m[35m                        self._cluster_bucket.artifact_directory, PCLUSTER_S3_ARTIFACTS_DICT.get("con[0m
[30;1m216 | [0m[35m                    ),[0m
[30;1m217 | [0m[35m                    "cluster_config_version": self._config.config_version,[0m
[30;1m218 | [0m[35m                    "custom_node_package": self._config.custom_node_package or "",[0m

[31m--[ [0m[34mMatch #[0m[33m714[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/login_nodes_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m                .iam.get_instance_profile(instance_profile_name)[0m
[30;1m137 | [0m[35m                .get("InstanceProfile")[0m
[30;1m138 | [0m[35m                .get("Roles")[0][0m
[30;1m139 | [0m[35m                .get("RoleName")[0m
[30;1m140 | [0m[35m            )[0m
[30;1m141 | [0m[35m        elif self._pool.instance_role:[0m
[30;1m142 | [0m[35m            instance_role_name = get_resource_name_from_resource_arn(self._pool.instance_role)[0m

[31m--[ [0m[34mMatch #[0m[33m715[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/login_nodes_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m                AWSApi.instance()[0m
[30;1m136 | [0m[35m                .iam.get_instance_profile(instance_profile_name)[0m
[30;1m137 | [0m[35m                .get("InstanceProfile")[0m
[30;1m138 | [0m[35m                .get("Roles")[0][0m
[30;1m139 | [0m[35m                .get("RoleName")[0m
[30;1m140 | [0m[35m            )[0m
[30;1m141 | [0m[35m        elif self._pool.instance_role:[0m

[31m--[ [0m[34mMatch #[0m[33m716[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/login_nodes_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35m            instance_role_name = ([0m
[30;1m135 | [0m[35m                AWSApi.instance()[0m
[30;1m136 | [0m[35m                .iam.get_instance_profile(instance_profile_name)[0m
[30;1m137 | [0m[35m                .get("InstanceProfile")[0m
[30;1m138 | [0m[35m                .get("Roles")[0][0m
[30;1m139 | [0m[35m                .get("RoleName")[0m
[30;1m140 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m717[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/login_nodes_stack.py[0m
   Pattern: [32m.hostname[0m
[30;1m289 | [0m[35m                    "scheduler": self._config.scheduling.scheduler,[0m
[30;1m290 | [0m[35m                    "stack_name": self.stack_name,[0m
[30;1m291 | [0m[35m                    "stack_arn": self.stack_id,[0m
[30;1m292 | [0m[35m                    "use_private_hostname": str([0m
[30;1m293 | [0m[35m                        get_attr(self._config, "scheduling.settings.dns.use_ec2_hostnames", default=[0m
[30;1m294 | [0m[35m                    ).lower(),[0m
[30;1m295 | [0m[35m                    "disable_sudo_access_for_default_user": ([0m

[31m--[ [0m[34mMatch #[0m[33m718[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/login_nodes_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m481 | [0m[35m        managed_load_balancer_security_group = None[0m
[30;1m482 | [0m[35m        if not self._pool.networking.security_groups:[0m
[30;1m483 | [0m[35m            managed_load_balancer_security_group = self._add_managed_load_balancer_security_group()[0m
[30;1m484 | [0m[35m            # Get the same security groups used on the login node pool[0m
[30;1m485 | [0m[35m        load_balancer_security_groups = get_login_nodes_security_groups_full([0m
[30;1m486 | [0m[35m            managed_load_balancer_security_group, self._pool[0m
[30;1m487 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m719[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/login_nodes_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m462 | [0m[35m            security_group_ingress=load_balancer_security_group_ingress,[0m
[30;1m463 | [0m[35m        )[0m
[30;1m464 | [0m[35m[0m
[30;1m465 | [0m[35m        # Add a rule to the managed login node security group which grants access from the managed N[0m
[30;1m466 | [0m[35m        ec2.CfnSecurityGroupIngress([0m
[30;1m467 | [0m[35m            Stack.of(self),[0m
[30;1m468 | [0m[35m            f"{self._pool.name}LoginSecurityGroupLoadBalancerIngress",[0m

[31m--[ [0m[34mMatch #[0m[33m720[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/login_nodes_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m451 | [0m[35m        return login_nodes_load_balancer[0m
[30;1m452 | [0m[35m[0m
[30;1m453 | [0m[35m    def _add_managed_load_balancer_security_group(self):[0m
[30;1m454 | [0m[35m        # The load balancer shares the same SSH restrictions as the login nodes[0m
[30;1m455 | [0m[35m        load_balancer_security_group_ingress = [get_source_ingress_rule(self._pool.ssh.allowed_ips)][0m
[30;1m456 | [0m[35m[0m
[30;1m457 | [0m[35m        load_balancer_managed_security_group = ec2.CfnSecurityGroup([0m

[31m--[ [0m[34mMatch #[0m[33m721[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/login_nodes_stack.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m337 | [0m[35m                    "jq": {[0m
[30;1m338 | [0m[35m                        "command": ([0m
[30;1m339 | [0m[35m                            'jq -s ".[0] * .[1]" /tmp/dna.json /tmp/extra.json > /etc/chef/dna.json [0m
[30;1m340 | [0m[35m                            '|| ( echo "jq not installed"; cp /tmp/dna.json /etc/chef/dna.json )'[0m
[30;1m341 | [0m[35m                        )[0m
[30;1m342 | [0m[35m                    },[0m
[30;1m343 | [0m[35m                },[0m

[31m--[ [0m[34mMatch #[0m[33m722[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m311 | [0m[35m        "wsgi.run_once": False,[0m
[30;1m312 | [0m[35m        "wsgi.url_scheme": headers.get("X-Forwarded-Proto", "http"),[0m
[30;1m313 | [0m[35m        "wsgi.version": (1, 0),[0m
[30;1m314 | [0m[35m        "serverless.authorizer": event.get("enhancedAuthContext"),[0m
[30;1m315 | [0m[35m        "serverless.event": event,[0m
[30;1m316 | [0m[35m        "serverless.context": context,[0m
[30;1m317 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m723[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m309 | [0m[35m        "wsgi.multiprocess": False,[0m
[30;1m310 | [0m[35m        "wsgi.multithread": False,[0m
[30;1m311 | [0m[35m        "wsgi.run_once": False,[0m
[30;1m312 | [0m[35m        "wsgi.url_scheme": headers.get("X-Forwarded-Proto", "http"),[0m
[30;1m313 | [0m[35m        "wsgi.version": (1, 0),[0m
[30;1m314 | [0m[35m        "serverless.authorizer": event.get("enhancedAuthContext"),[0m
[30;1m315 | [0m[35m        "serverless.event": event,[0m

[31m--[ [0m[34mMatch #[0m[33m724[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m302 | [0m[35m        "REQUEST_METHOD": event.get("method", ""),[0m
[30;1m303 | [0m[35m        "SCRIPT_NAME": script_name,[0m
[30;1m304 | [0m[35m        "SERVER_NAME": headers.get("Host", "lambda"),[0m
[30;1m305 | [0m[35m        "SERVER_PORT": headers.get("X-Forwarded-Port", "80"),[0m
[30;1m306 | [0m[35m        "SERVER_PROTOCOL": "HTTP/1.1",[0m
[30;1m307 | [0m[35m        "wsgi.errors": sys.stderr,[0m
[30;1m308 | [0m[35m        "wsgi.input": io.BytesIO(body),[0m

[31m--[ [0m[34mMatch #[0m[33m725[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m301 | [0m[35m        "REMOTE_USER": event.get("principalId", ""),[0m
[30;1m302 | [0m[35m        "REQUEST_METHOD": event.get("method", ""),[0m
[30;1m303 | [0m[35m        "SCRIPT_NAME": script_name,[0m
[30;1m304 | [0m[35m        "SERVER_NAME": headers.get("Host", "lambda"),[0m
[30;1m305 | [0m[35m        "SERVER_PORT": headers.get("X-Forwarded-Port", "80"),[0m
[30;1m306 | [0m[35m        "SERVER_PROTOCOL": "HTTP/1.1",[0m
[30;1m307 | [0m[35m        "wsgi.errors": sys.stderr,[0m

[31m--[ [0m[34mMatch #[0m[33m726[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m299 | [0m[35m        "QUERY_STRING": url_encode(event.get("query", {})),[0m
[30;1m300 | [0m[35m        "REMOTE_ADDR": event.get("identity", {}).get("sourceIp", ""),[0m
[30;1m301 | [0m[35m        "REMOTE_USER": event.get("principalId", ""),[0m
[30;1m302 | [0m[35m        "REQUEST_METHOD": event.get("method", ""),[0m
[30;1m303 | [0m[35m        "SCRIPT_NAME": script_name,[0m
[30;1m304 | [0m[35m        "SERVER_NAME": headers.get("Host", "lambda"),[0m
[30;1m305 | [0m[35m        "SERVER_PORT": headers.get("X-Forwarded-Port", "80"),[0m

[31m--[ [0m[34mMatch #[0m[33m727[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m298 | [0m[35m        "PATH_INFO": url_unquote(path_info),[0m
[30;1m299 | [0m[35m        "QUERY_STRING": url_encode(event.get("query", {})),[0m
[30;1m300 | [0m[35m        "REMOTE_ADDR": event.get("identity", {}).get("sourceIp", ""),[0m
[30;1m301 | [0m[35m        "REMOTE_USER": event.get("principalId", ""),[0m
[30;1m302 | [0m[35m        "REQUEST_METHOD": event.get("method", ""),[0m
[30;1m303 | [0m[35m        "SCRIPT_NAME": script_name,[0m
[30;1m304 | [0m[35m        "SERVER_NAME": headers.get("Host", "lambda"),[0m

[31m--[ [0m[34mMatch #[0m[33m728[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m297 | [0m[35m        "CONTENT_TYPE": headers.get("Content-Type", ""),[0m
[30;1m298 | [0m[35m        "PATH_INFO": url_unquote(path_info),[0m
[30;1m299 | [0m[35m        "QUERY_STRING": url_encode(event.get("query", {})),[0m
[30;1m300 | [0m[35m        "REMOTE_ADDR": event.get("identity", {}).get("sourceIp", ""),[0m
[30;1m301 | [0m[35m        "REMOTE_USER": event.get("principalId", ""),[0m
[30;1m302 | [0m[35m        "REQUEST_METHOD": event.get("method", ""),[0m
[30;1m303 | [0m[35m        "SCRIPT_NAME": script_name,[0m

[31m--[ [0m[34mMatch #[0m[33m729[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m297 | [0m[35m        "CONTENT_TYPE": headers.get("Content-Type", ""),[0m
[30;1m298 | [0m[35m        "PATH_INFO": url_unquote(path_info),[0m
[30;1m299 | [0m[35m        "QUERY_STRING": url_encode(event.get("query", {})),[0m
[30;1m300 | [0m[35m        "REMOTE_ADDR": event.get("identity", {}).get("sourceIp", ""),[0m
[30;1m301 | [0m[35m        "REMOTE_USER": event.get("principalId", ""),[0m
[30;1m302 | [0m[35m        "REQUEST_METHOD": event.get("method", ""),[0m
[30;1m303 | [0m[35m        "SCRIPT_NAME": script_name,[0m

[31m--[ [0m[34mMatch #[0m[33m730[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m296 | [0m[35m        "CONTENT_LENGTH": str(len(body)),[0m
[30;1m297 | [0m[35m        "CONTENT_TYPE": headers.get("Content-Type", ""),[0m
[30;1m298 | [0m[35m        "PATH_INFO": url_unquote(path_info),[0m
[30;1m299 | [0m[35m        "QUERY_STRING": url_encode(event.get("query", {})),[0m
[30;1m300 | [0m[35m        "REMOTE_ADDR": event.get("identity", {}).get("sourceIp", ""),[0m
[30;1m301 | [0m[35m        "REMOTE_USER": event.get("principalId", ""),[0m
[30;1m302 | [0m[35m        "REQUEST_METHOD": event.get("method", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m731[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m294 | [0m[35m[0m
[30;1m295 | [0m[35m    environ = {[0m
[30;1m296 | [0m[35m        "CONTENT_LENGTH": str(len(body)),[0m
[30;1m297 | [0m[35m        "CONTENT_TYPE": headers.get("Content-Type", ""),[0m
[30;1m298 | [0m[35m        "PATH_INFO": url_unquote(path_info),[0m
[30;1m299 | [0m[35m        "QUERY_STRING": url_encode(event.get("query", {})),[0m
[30;1m300 | [0m[35m        "REMOTE_ADDR": event.get("identity", {}).get("sourceIp", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m732[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m288 | [0m[35m        path_info = path_info.replace("{%s}" % key, value)[0m
[30;1m289 | [0m[35m        path_info = path_info.replace("{%s+}" % key, value)[0m
[30;1m290 | [0m[35m[0m
[30;1m291 | [0m[35m    body = event.get("body", {})[0m
[30;1m292 | [0m[35m    body = json.dumps(body) if body else ""[0m
[30;1m293 | [0m[35m    body = get_body_bytes(event, body)[0m
[30;1m294 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m733[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m284 | [0m[35m[0m
[30;1m285 | [0m[35m    path_info = event["requestPath"][0m
[30;1m286 | [0m[35m[0m
[30;1m287 | [0m[35m    for key, value in event.get("path", {}).items():[0m
[30;1m288 | [0m[35m        path_info = path_info.replace("{%s}" % key, value)[0m
[30;1m289 | [0m[35m        path_info = path_info.replace("{%s+}" % key, value)[0m
[30;1m290 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m734[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m263 | [0m[35m        "wsgi.run_once": False,[0m
[30;1m264 | [0m[35m        "wsgi.url_scheme": headers.get("X-Forwarded-Proto", "http"),[0m
[30;1m265 | [0m[35m        "wsgi.version": (1, 0),[0m
[30;1m266 | [0m[35m        "serverless.authorizer": event.get("requestContext", {}).get("authorizer"),[0m
[30;1m267 | [0m[35m        "serverless.event": event,[0m
[30;1m268 | [0m[35m        "serverless.context": context,[0m
[30;1m269 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m735[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m263 | [0m[35m        "wsgi.run_once": False,[0m
[30;1m264 | [0m[35m        "wsgi.url_scheme": headers.get("X-Forwarded-Proto", "http"),[0m
[30;1m265 | [0m[35m        "wsgi.version": (1, 0),[0m
[30;1m266 | [0m[35m        "serverless.authorizer": event.get("requestContext", {}).get("authorizer"),[0m
[30;1m267 | [0m[35m        "serverless.event": event,[0m
[30;1m268 | [0m[35m        "serverless.context": context,[0m
[30;1m269 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m736[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m261 | [0m[35m        "wsgi.multiprocess": False,[0m
[30;1m262 | [0m[35m        "wsgi.multithread": False,[0m
[30;1m263 | [0m[35m        "wsgi.run_once": False,[0m
[30;1m264 | [0m[35m        "wsgi.url_scheme": headers.get("X-Forwarded-Proto", "http"),[0m
[30;1m265 | [0m[35m        "wsgi.version": (1, 0),[0m
[30;1m266 | [0m[35m        "serverless.authorizer": event.get("requestContext", {}).get("authorizer"),[0m
[30;1m267 | [0m[35m        "serverless.event": event,[0m

[31m--[ [0m[34mMatch #[0m[33m737[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m254 | [0m[35m        "REQUEST_METHOD": event.get("requestContext", {}).get("http", {}).get("method", ""),[0m
[30;1m255 | [0m[35m        "SCRIPT_NAME": script_name,[0m
[30;1m256 | [0m[35m        "SERVER_NAME": headers.get("Host", "lambda"),[0m
[30;1m257 | [0m[35m        "SERVER_PORT": headers.get("X-Forwarded-Port", "80"),[0m
[30;1m258 | [0m[35m        "SERVER_PROTOCOL": "HTTP/1.1",[0m
[30;1m259 | [0m[35m        "wsgi.errors": sys.stderr,[0m
[30;1m260 | [0m[35m        "wsgi.input": io.BytesIO(body),[0m

[31m--[ [0m[34mMatch #[0m[33m738[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m253 | [0m[35m        "REMOTE_USER": event.get("requestContext", {}).get("authorizer", {}).get("principalId", ""),[0m
[30;1m254 | [0m[35m        "REQUEST_METHOD": event.get("requestContext", {}).get("http", {}).get("method", ""),[0m
[30;1m255 | [0m[35m        "SCRIPT_NAME": script_name,[0m
[30;1m256 | [0m[35m        "SERVER_NAME": headers.get("Host", "lambda"),[0m
[30;1m257 | [0m[35m        "SERVER_PORT": headers.get("X-Forwarded-Port", "80"),[0m
[30;1m258 | [0m[35m        "SERVER_PROTOCOL": "HTTP/1.1",[0m
[30;1m259 | [0m[35m        "wsgi.errors": sys.stderr,[0m

[31m--[ [0m[34mMatch #[0m[33m739[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m251 | [0m[35m        "QUERY_STRING": event.get("rawQueryString", ""),[0m
[30;1m252 | [0m[35m        "REMOTE_ADDR": event.get("requestContext", {}).get("http", {}).get("sourceIp", ""),[0m
[30;1m253 | [0m[35m        "REMOTE_USER": event.get("requestContext", {}).get("authorizer", {}).get("principalId", ""),[0m
[30;1m254 | [0m[35m        "REQUEST_METHOD": event.get("requestContext", {}).get("http", {}).get("method", ""),[0m
[30;1m255 | [0m[35m        "SCRIPT_NAME": script_name,[0m
[30;1m256 | [0m[35m        "SERVER_NAME": headers.get("Host", "lambda"),[0m
[30;1m257 | [0m[35m        "SERVER_PORT": headers.get("X-Forwarded-Port", "80"),[0m

[31m--[ [0m[34mMatch #[0m[33m740[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m251 | [0m[35m        "QUERY_STRING": event.get("rawQueryString", ""),[0m
[30;1m252 | [0m[35m        "REMOTE_ADDR": event.get("requestContext", {}).get("http", {}).get("sourceIp", ""),[0m
[30;1m253 | [0m[35m        "REMOTE_USER": event.get("requestContext", {}).get("authorizer", {}).get("principalId", ""),[0m
[30;1m254 | [0m[35m        "REQUEST_METHOD": event.get("requestContext", {}).get("http", {}).get("method", ""),[0m
[30;1m255 | [0m[35m        "SCRIPT_NAME": script_name,[0m
[30;1m256 | [0m[35m        "SERVER_NAME": headers.get("Host", "lambda"),[0m
[30;1m257 | [0m[35m        "SERVER_PORT": headers.get("X-Forwarded-Port", "80"),[0m

[31m--[ [0m[34mMatch #[0m[33m741[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m251 | [0m[35m        "QUERY_STRING": event.get("rawQueryString", ""),[0m
[30;1m252 | [0m[35m        "REMOTE_ADDR": event.get("requestContext", {}).get("http", {}).get("sourceIp", ""),[0m
[30;1m253 | [0m[35m        "REMOTE_USER": event.get("requestContext", {}).get("authorizer", {}).get("principalId", ""),[0m
[30;1m254 | [0m[35m        "REQUEST_METHOD": event.get("requestContext", {}).get("http", {}).get("method", ""),[0m
[30;1m255 | [0m[35m        "SCRIPT_NAME": script_name,[0m
[30;1m256 | [0m[35m        "SERVER_NAME": headers.get("Host", "lambda"),[0m
[30;1m257 | [0m[35m        "SERVER_PORT": headers.get("X-Forwarded-Port", "80"),[0m

[31m--[ [0m[34mMatch #[0m[33m742[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m250 | [0m[35m        "PATH_INFO": url_unquote(path_info),[0m
[30;1m251 | [0m[35m        "QUERY_STRING": event.get("rawQueryString", ""),[0m
[30;1m252 | [0m[35m        "REMOTE_ADDR": event.get("requestContext", {}).get("http", {}).get("sourceIp", ""),[0m
[30;1m253 | [0m[35m        "REMOTE_USER": event.get("requestContext", {}).get("authorizer", {}).get("principalId", ""),[0m
[30;1m254 | [0m[35m        "REQUEST_METHOD": event.get("requestContext", {}).get("http", {}).get("method", ""),[0m
[30;1m255 | [0m[35m        "SCRIPT_NAME": script_name,[0m
[30;1m256 | [0m[35m        "SERVER_NAME": headers.get("Host", "lambda"),[0m

[31m--[ [0m[34mMatch #[0m[33m743[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m250 | [0m[35m        "PATH_INFO": url_unquote(path_info),[0m
[30;1m251 | [0m[35m        "QUERY_STRING": event.get("rawQueryString", ""),[0m
[30;1m252 | [0m[35m        "REMOTE_ADDR": event.get("requestContext", {}).get("http", {}).get("sourceIp", ""),[0m
[30;1m253 | [0m[35m        "REMOTE_USER": event.get("requestContext", {}).get("authorizer", {}).get("principalId", ""),[0m
[30;1m254 | [0m[35m        "REQUEST_METHOD": event.get("requestContext", {}).get("http", {}).get("method", ""),[0m
[30;1m255 | [0m[35m        "SCRIPT_NAME": script_name,[0m
[30;1m256 | [0m[35m        "SERVER_NAME": headers.get("Host", "lambda"),[0m

[31m--[ [0m[34mMatch #[0m[33m744[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m250 | [0m[35m        "PATH_INFO": url_unquote(path_info),[0m
[30;1m251 | [0m[35m        "QUERY_STRING": event.get("rawQueryString", ""),[0m
[30;1m252 | [0m[35m        "REMOTE_ADDR": event.get("requestContext", {}).get("http", {}).get("sourceIp", ""),[0m
[30;1m253 | [0m[35m        "REMOTE_USER": event.get("requestContext", {}).get("authorizer", {}).get("principalId", ""),[0m
[30;1m254 | [0m[35m        "REQUEST_METHOD": event.get("requestContext", {}).get("http", {}).get("method", ""),[0m
[30;1m255 | [0m[35m        "SCRIPT_NAME": script_name,[0m
[30;1m256 | [0m[35m        "SERVER_NAME": headers.get("Host", "lambda"),[0m

[31m--[ [0m[34mMatch #[0m[33m745[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m249 | [0m[35m        "CONTENT_TYPE": headers.get("Content-Type", ""),[0m
[30;1m250 | [0m[35m        "PATH_INFO": url_unquote(path_info),[0m
[30;1m251 | [0m[35m        "QUERY_STRING": event.get("rawQueryString", ""),[0m
[30;1m252 | [0m[35m        "REMOTE_ADDR": event.get("requestContext", {}).get("http", {}).get("sourceIp", ""),[0m
[30;1m253 | [0m[35m        "REMOTE_USER": event.get("requestContext", {}).get("authorizer", {}).get("principalId", ""),[0m
[30;1m254 | [0m[35m        "REQUEST_METHOD": event.get("requestContext", {}).get("http", {}).get("method", ""),[0m
[30;1m255 | [0m[35m        "SCRIPT_NAME": script_name,[0m

[31m--[ [0m[34mMatch #[0m[33m746[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m249 | [0m[35m        "CONTENT_TYPE": headers.get("Content-Type", ""),[0m
[30;1m250 | [0m[35m        "PATH_INFO": url_unquote(path_info),[0m
[30;1m251 | [0m[35m        "QUERY_STRING": event.get("rawQueryString", ""),[0m
[30;1m252 | [0m[35m        "REMOTE_ADDR": event.get("requestContext", {}).get("http", {}).get("sourceIp", ""),[0m
[30;1m253 | [0m[35m        "REMOTE_USER": event.get("requestContext", {}).get("authorizer", {}).get("principalId", ""),[0m
[30;1m254 | [0m[35m        "REQUEST_METHOD": event.get("requestContext", {}).get("http", {}).get("method", ""),[0m
[30;1m255 | [0m[35m        "SCRIPT_NAME": script_name,[0m

[31m--[ [0m[34mMatch #[0m[33m747[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m249 | [0m[35m        "CONTENT_TYPE": headers.get("Content-Type", ""),[0m
[30;1m250 | [0m[35m        "PATH_INFO": url_unquote(path_info),[0m
[30;1m251 | [0m[35m        "QUERY_STRING": event.get("rawQueryString", ""),[0m
[30;1m252 | [0m[35m        "REMOTE_ADDR": event.get("requestContext", {}).get("http", {}).get("sourceIp", ""),[0m
[30;1m253 | [0m[35m        "REMOTE_USER": event.get("requestContext", {}).get("authorizer", {}).get("principalId", ""),[0m
[30;1m254 | [0m[35m        "REQUEST_METHOD": event.get("requestContext", {}).get("http", {}).get("method", ""),[0m
[30;1m255 | [0m[35m        "SCRIPT_NAME": script_name,[0m

[31m--[ [0m[34mMatch #[0m[33m748[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m248 | [0m[35m        "CONTENT_LENGTH": str(len(body)),[0m
[30;1m249 | [0m[35m        "CONTENT_TYPE": headers.get("Content-Type", ""),[0m
[30;1m250 | [0m[35m        "PATH_INFO": url_unquote(path_info),[0m
[30;1m251 | [0m[35m        "QUERY_STRING": event.get("rawQueryString", ""),[0m
[30;1m252 | [0m[35m        "REMOTE_ADDR": event.get("requestContext", {}).get("http", {}).get("sourceIp", ""),[0m
[30;1m253 | [0m[35m        "REMOTE_USER": event.get("requestContext", {}).get("authorizer", {}).get("principalId", ""),[0m
[30;1m254 | [0m[35m        "REQUEST_METHOD": event.get("requestContext", {}).get("http", {}).get("method", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m749[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m    environ = {[0m
[30;1m248 | [0m[35m        "CONTENT_LENGTH": str(len(body)),[0m
[30;1m249 | [0m[35m        "CONTENT_TYPE": headers.get("Content-Type", ""),[0m
[30;1m250 | [0m[35m        "PATH_INFO": url_unquote(path_info),[0m
[30;1m251 | [0m[35m        "QUERY_STRING": event.get("rawQueryString", ""),[0m
[30;1m252 | [0m[35m        "REMOTE_ADDR": event.get("requestContext", {}).get("http", {}).get("sourceIp", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m750[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m242 | [0m[35m    body = event.get("body", "")[0m
[30;1m243 | [0m[35m    body = get_body_bytes(event, body)[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m    headers["Cookie"] = "; ".join(event.get("cookies", []))[0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m    environ = {[0m
[30;1m248 | [0m[35m        "CONTENT_LENGTH": str(len(body)),[0m

[31m--[ [0m[34mMatch #[0m[33m751[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m    path_info = event["rawPath"][0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35m    body = event.get("body", "")[0m
[30;1m243 | [0m[35m    body = get_body_bytes(event, body)[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m    headers["Cookie"] = "; ".join(event.get("cookies", []))[0m

[31m--[ [0m[34mMatch #[0m[33m752[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m235 | [0m[35mdef handle_payload_v2(app, event, context):[0m
[30;1m236 | [0m[35m    headers = Headers(event["headers"])[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m    script_name = get_script_name(headers, event.get("requestContext", {}))[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m    path_info = event["rawPath"][0m
[30;1m241 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m753[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m219 | [0m[35m        "wsgi.run_once": False,[0m
[30;1m220 | [0m[35m        "wsgi.url_scheme": headers.get("X-Forwarded-Proto", "http"),[0m
[30;1m221 | [0m[35m        "wsgi.version": (1, 0),[0m
[30;1m222 | [0m[35m        "serverless.authorizer": event.get("requestContext", {}).get("authorizer"),[0m
[30;1m223 | [0m[35m        "serverless.event": event,[0m
[30;1m224 | [0m[35m        "serverless.context": context,[0m
[30;1m225 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m754[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m219 | [0m[35m        "wsgi.run_once": False,[0m
[30;1m220 | [0m[35m        "wsgi.url_scheme": headers.get("X-Forwarded-Proto", "http"),[0m
[30;1m221 | [0m[35m        "wsgi.version": (1, 0),[0m
[30;1m222 | [0m[35m        "serverless.authorizer": event.get("requestContext", {}).get("authorizer"),[0m
[30;1m223 | [0m[35m        "serverless.event": event,[0m
[30;1m224 | [0m[35m        "serverless.context": context,[0m
[30;1m225 | [0m[35m    }[0m

[31m--[ [0m[34mMatch #[0m[33m755[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m217 | [0m[35m        "wsgi.multiprocess": False,[0m
[30;1m218 | [0m[35m        "wsgi.multithread": False,[0m
[30;1m219 | [0m[35m        "wsgi.run_once": False,[0m
[30;1m220 | [0m[35m        "wsgi.url_scheme": headers.get("X-Forwarded-Proto", "http"),[0m
[30;1m221 | [0m[35m        "wsgi.version": (1, 0),[0m
[30;1m222 | [0m[35m        "serverless.authorizer": event.get("requestContext", {}).get("authorizer"),[0m
[30;1m223 | [0m[35m        "serverless.event": event,[0m

[31m--[ [0m[34mMatch #[0m[33m756[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m210 | [0m[35m        "REQUEST_METHOD": event.get("httpMethod", {}),[0m
[30;1m211 | [0m[35m        "SCRIPT_NAME": script_name,[0m
[30;1m212 | [0m[35m        "SERVER_NAME": headers.get("Host", "lambda"),[0m
[30;1m213 | [0m[35m        "SERVER_PORT": headers.get("X-Forwarded-Port", "80"),[0m
[30;1m214 | [0m[35m        "SERVER_PROTOCOL": "HTTP/1.1",[0m
[30;1m215 | [0m[35m        "wsgi.errors": sys.stderr,[0m
[30;1m216 | [0m[35m        "wsgi.input": io.BytesIO(body),[0m

[31m--[ [0m[34mMatch #[0m[33m757[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m        "REMOTE_USER": event.get("requestContext", {}).get("authorizer", {}).get("principalId", ""),[0m
[30;1m210 | [0m[35m        "REQUEST_METHOD": event.get("httpMethod", {}),[0m
[30;1m211 | [0m[35m        "SCRIPT_NAME": script_name,[0m
[30;1m212 | [0m[35m        "SERVER_NAME": headers.get("Host", "lambda"),[0m
[30;1m213 | [0m[35m        "SERVER_PORT": headers.get("X-Forwarded-Port", "80"),[0m
[30;1m214 | [0m[35m        "SERVER_PROTOCOL": "HTTP/1.1",[0m
[30;1m215 | [0m[35m        "wsgi.errors": sys.stderr,[0m

[31m--[ [0m[34mMatch #[0m[33m758[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m        "QUERY_STRING": encode_query_string(event),[0m
[30;1m208 | [0m[35m        "REMOTE_ADDR": event.get("requestContext", {}).get("identity", {}).get("sourceIp", ""),[0m
[30;1m209 | [0m[35m        "REMOTE_USER": event.get("requestContext", {}).get("authorizer", {}).get("principalId", ""),[0m
[30;1m210 | [0m[35m        "REQUEST_METHOD": event.get("httpMethod", {}),[0m
[30;1m211 | [0m[35m        "SCRIPT_NAME": script_name,[0m
[30;1m212 | [0m[35m        "SERVER_NAME": headers.get("Host", "lambda"),[0m
[30;1m213 | [0m[35m        "SERVER_PORT": headers.get("X-Forwarded-Port", "80"),[0m

[31m--[ [0m[34mMatch #[0m[33m759[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m206 | [0m[35m        "PATH_INFO": url_unquote(path_info),[0m
[30;1m207 | [0m[35m        "QUERY_STRING": encode_query_string(event),[0m
[30;1m208 | [0m[35m        "REMOTE_ADDR": event.get("requestContext", {}).get("identity", {}).get("sourceIp", ""),[0m
[30;1m209 | [0m[35m        "REMOTE_USER": event.get("requestContext", {}).get("authorizer", {}).get("principalId", ""),[0m
[30;1m210 | [0m[35m        "REQUEST_METHOD": event.get("httpMethod", {}),[0m
[30;1m211 | [0m[35m        "SCRIPT_NAME": script_name,[0m
[30;1m212 | [0m[35m        "SERVER_NAME": headers.get("Host", "lambda"),[0m

[31m--[ [0m[34mMatch #[0m[33m760[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m206 | [0m[35m        "PATH_INFO": url_unquote(path_info),[0m
[30;1m207 | [0m[35m        "QUERY_STRING": encode_query_string(event),[0m
[30;1m208 | [0m[35m        "REMOTE_ADDR": event.get("requestContext", {}).get("identity", {}).get("sourceIp", ""),[0m
[30;1m209 | [0m[35m        "REMOTE_USER": event.get("requestContext", {}).get("authorizer", {}).get("principalId", ""),[0m
[30;1m210 | [0m[35m        "REQUEST_METHOD": event.get("httpMethod", {}),[0m
[30;1m211 | [0m[35m        "SCRIPT_NAME": script_name,[0m
[30;1m212 | [0m[35m        "SERVER_NAME": headers.get("Host", "lambda"),[0m

[31m--[ [0m[34mMatch #[0m[33m761[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m206 | [0m[35m        "PATH_INFO": url_unquote(path_info),[0m
[30;1m207 | [0m[35m        "QUERY_STRING": encode_query_string(event),[0m
[30;1m208 | [0m[35m        "REMOTE_ADDR": event.get("requestContext", {}).get("identity", {}).get("sourceIp", ""),[0m
[30;1m209 | [0m[35m        "REMOTE_USER": event.get("requestContext", {}).get("authorizer", {}).get("principalId", ""),[0m
[30;1m210 | [0m[35m        "REQUEST_METHOD": event.get("httpMethod", {}),[0m
[30;1m211 | [0m[35m        "SCRIPT_NAME": script_name,[0m
[30;1m212 | [0m[35m        "SERVER_NAME": headers.get("Host", "lambda"),[0m

[31m--[ [0m[34mMatch #[0m[33m762[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m205 | [0m[35m        "CONTENT_TYPE": headers.get("Content-Type", ""),[0m
[30;1m206 | [0m[35m        "PATH_INFO": url_unquote(path_info),[0m
[30;1m207 | [0m[35m        "QUERY_STRING": encode_query_string(event),[0m
[30;1m208 | [0m[35m        "REMOTE_ADDR": event.get("requestContext", {}).get("identity", {}).get("sourceIp", ""),[0m
[30;1m209 | [0m[35m        "REMOTE_USER": event.get("requestContext", {}).get("authorizer", {}).get("principalId", ""),[0m
[30;1m210 | [0m[35m        "REQUEST_METHOD": event.get("httpMethod", {}),[0m
[30;1m211 | [0m[35m        "SCRIPT_NAME": script_name,[0m

[31m--[ [0m[34mMatch #[0m[33m763[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m205 | [0m[35m        "CONTENT_TYPE": headers.get("Content-Type", ""),[0m
[30;1m206 | [0m[35m        "PATH_INFO": url_unquote(path_info),[0m
[30;1m207 | [0m[35m        "QUERY_STRING": encode_query_string(event),[0m
[30;1m208 | [0m[35m        "REMOTE_ADDR": event.get("requestContext", {}).get("identity", {}).get("sourceIp", ""),[0m
[30;1m209 | [0m[35m        "REMOTE_USER": event.get("requestContext", {}).get("authorizer", {}).get("principalId", ""),[0m
[30;1m210 | [0m[35m        "REQUEST_METHOD": event.get("httpMethod", {}),[0m
[30;1m211 | [0m[35m        "SCRIPT_NAME": script_name,[0m

[31m--[ [0m[34mMatch #[0m[33m764[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m205 | [0m[35m        "CONTENT_TYPE": headers.get("Content-Type", ""),[0m
[30;1m206 | [0m[35m        "PATH_INFO": url_unquote(path_info),[0m
[30;1m207 | [0m[35m        "QUERY_STRING": encode_query_string(event),[0m
[30;1m208 | [0m[35m        "REMOTE_ADDR": event.get("requestContext", {}).get("identity", {}).get("sourceIp", ""),[0m
[30;1m209 | [0m[35m        "REMOTE_USER": event.get("requestContext", {}).get("authorizer", {}).get("principalId", ""),[0m
[30;1m210 | [0m[35m        "REQUEST_METHOD": event.get("httpMethod", {}),[0m
[30;1m211 | [0m[35m        "SCRIPT_NAME": script_name,[0m

[31m--[ [0m[34mMatch #[0m[33m765[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m    environ = {[0m
[30;1m204 | [0m[35m        "CONTENT_LENGTH": str(len(body)),[0m
[30;1m205 | [0m[35m        "CONTENT_TYPE": headers.get("Content-Type", ""),[0m
[30;1m206 | [0m[35m        "PATH_INFO": url_unquote(path_info),[0m
[30;1m207 | [0m[35m        "QUERY_STRING": encode_query_string(event),[0m
[30;1m208 | [0m[35m        "REMOTE_ADDR": event.get("requestContext", {}).get("identity", {}).get("sourceIp", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m766[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m190 | [0m[35m    # path in their URL. This allows us to strip it out via an optional[0m
[30;1m191 | [0m[35m    # environment variable.[0m
[30;1m192 | [0m[35m    path_info = event["path"][0m
[30;1m193 | [0m[35m    base_path = os.environ.get("API_GATEWAY_BASE_PATH")[0m
[30;1m194 | [0m[35m    if base_path:[0m
[30;1m195 | [0m[35m        script_name = "/" + base_path[0m
[30;1m196 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m767[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m    else:[0m
[30;1m185 | [0m[35m        headers = Headers(event["headers"])[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m    script_name = get_script_name(headers, event.get("requestContext", {}))[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m    # If a user is using a custom domain on API Gateway, they may have a base[0m
[30;1m190 | [0m[35m    # path in their URL. This allows us to strip it out via an optional[0m

[31m--[ [0m[34mMatch #[0m[33m768[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m172 | [0m[35m    if event.get("version") is None and event.get("isBase64Encoded") is None and not is_alb_event(ev[0m
[30;1m173 | [0m[35m        return handle_lambda_integration(app, event, context)[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m    if event.get("version") == "2.0":[0m
[30;1m176 | [0m[35m        return handle_payload_v2(app, event, context)[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m    return handle_payload_v1(app, event, context)[0m

[31m--[ [0m[34mMatch #[0m[33m769[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m        print("Lambda warming event received, skipping handler")[0m
[30;1m170 | [0m[35m        return {}[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m    if event.get("version") is None and event.get("isBase64Encoded") is None and not is_alb_event(ev[0m
[30;1m173 | [0m[35m        return handle_lambda_integration(app, event, context)[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m    if event.get("version") == "2.0":[0m

[31m--[ [0m[34mMatch #[0m[33m770[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m        print("Lambda warming event received, skipping handler")[0m
[30;1m170 | [0m[35m        return {}[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m    if event.get("version") is None and event.get("isBase64Encoded") is None and not is_alb_event(ev[0m
[30;1m173 | [0m[35m        return handle_lambda_integration(app, event, context)[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m    if event.get("version") == "2.0":[0m

[31m--[ [0m[34mMatch #[0m[33m771[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35mdef handle_request(app, event, context):[0m
[30;1m168 | [0m[35m    if event.get("source") in ["aws.events", "serverless-plugin-warmup"]:[0m
[30;1m169 | [0m[35m        print("Lambda warming event received, skipping handler")[0m
[30;1m170 | [0m[35m        return {}[0m
[30;1m171 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m772[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m    if response.data:[0m
[30;1m154 | [0m[35m        mimetype = response.mimetype or "text/plain"[0m
[30;1m155 | [0m[35m        if (mimetype.startswith("text/") or mimetype in TEXT_MIME_TYPES) and not response.headers.ge[0m
[30;1m156 | [0m[35m            "Content-Encoding", ""[0m
[30;1m157 | [0m[35m        ):[0m
[30;1m158 | [0m[35m            returndict["body"] = response.get_data(as_text=True)[0m

[31m--[ [0m[34mMatch #[0m[33m773[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35mdef get_body_bytes(event, body):[0m
[30;1m119 | [0m[35m    if event.get("isBase64Encoded", False):[0m
[30;1m120 | [0m[35m        body = base64.b64decode(body)[0m
[30;1m121 | [0m[35m    if isinstance(body, str):[0m
[30;1m122 | [0m[35m        body = body.encode("utf-8")[0m

[31m--[ [0m[34mMatch #[0m[33m774[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m    ][0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    if headers.get("Host", "").endswith(".amazonaws.com") and not strip_stage_path:[0m
[30;1m112 | [0m[35m        script_name = "/{}".format(request_context.get("stage", ""))[0m
[30;1m113 | [0m[35m    else:[0m
[30;1m114 | [0m[35m        script_name = ""[0m
[30;1m115 | [0m[35m    return script_name[0m

[31m--[ [0m[34mMatch #[0m[33m775[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m108 | [0m[35m        "1",[0m
[30;1m109 | [0m[35m    ][0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    if headers.get("Host", "").endswith(".amazonaws.com") and not strip_stage_path:[0m
[30;1m112 | [0m[35m        script_name = "/{}".format(request_context.get("stage", ""))[0m
[30;1m113 | [0m[35m    else:[0m
[30;1m114 | [0m[35m        script_name = ""[0m

[31m--[ [0m[34mMatch #[0m[33m776[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35mdef get_script_name(headers, request_context):[0m
[30;1m103 | [0m[35m    strip_stage_path = os.environ.get("STRIP_STAGE_PATH", "").lower().strip() in [[0m
[30;1m104 | [0m[35m        "yes",[0m
[30;1m105 | [0m[35m        "y",[0m
[30;1m106 | [0m[35m        "true",[0m

[31m--[ [0m[34mMatch #[0m[33m777[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m    if not params:[0m
[30;1m92 | [0m[35m        params = event.get("queryStringParameters")[0m
[30;1m93 | [0m[35m    if not params:[0m
[30;1m94 | [0m[35m        params = event.get("query")[0m
[30;1m95 | [0m[35m    if not params:[0m
[30;1m96 | [0m[35m        params = ""[0m
[30;1m97 | [0m[35m    if is_alb_event(event):[0m

[31m--[ [0m[34mMatch #[0m[33m778[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35mdef encode_query_string(event):[0m
[30;1m90 | [0m[35m    params = event.get("multiValueQueryStringParameters")[0m
[30;1m91 | [0m[35m    if not params:[0m
[30;1m92 | [0m[35m        params = event.get("queryStringParameters")[0m
[30;1m93 | [0m[35m    if not params:[0m
[30;1m94 | [0m[35m        params = event.get("query")[0m
[30;1m95 | [0m[35m    if not params:[0m

[31m--[ [0m[34mMatch #[0m[33m779[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35mdef encode_query_string(event):[0m
[30;1m90 | [0m[35m    params = event.get("multiValueQueryStringParameters")[0m
[30;1m91 | [0m[35m    if not params:[0m
[30;1m92 | [0m[35m        params = event.get("queryStringParameters")[0m
[30;1m93 | [0m[35m    if not params:[0m

[31m--[ [0m[34mMatch #[0m[33m780[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35mdef is_alb_event(event):[0m
[30;1m86 | [0m[35m    return event.get("requestContext", {}).get("elb")[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35mdef encode_query_string(event):[0m

[31m--[ [0m[34mMatch #[0m[33m781[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35mdef is_alb_event(event):[0m
[30;1m86 | [0m[35m    return event.get("requestContext", {}).get("elb")[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35mdef encode_query_string(event):[0m

[31m--[ [0m[34mMatch #[0m[33m782[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35mfrom werkzeug.urls import url_encode, url_unquote, url_unquote_plus[0m
[30;1m24 | [0m[35mfrom werkzeug.wrappers import Response[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m# List of MIME types that should not be base64 encoded. MIME types within `text/*`[0m
[30;1m27 | [0m[35m# are included by default.[0m
[30;1m28 | [0m[35mTEXT_MIME_TYPES = [[0m
[30;1m29 | [0m[35m    "application/json",[0m

[31m--[ [0m[34mMatch #[0m[33m783[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/awslambda/serverless_wsgi.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m#[0m
[30;1m13 | [0m[35m# The above copyright notice and this permission notice shall be included in all[0m
[30;1m14 | [0m[35m# copies or substantial portions of the Software.[0m
[30;1m15 | [0m[35mimport base64[0m
[30;1m16 | [0m[35mimport io[0m
[30;1m17 | [0m[35mimport json[0m
[30;1m18 | [0m[35mimport os[0m
[30;1m19 | [0m[35mimport sys[0m

[31m--[ [0m[34mMatch #[0m[33m784[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2013-2014 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m785[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/route53.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m    @Cache.cached[0m
[30;1m48 | [0m[35m    def is_hosted_zone_private(self, hosted_zone_id):[0m
[30;1m49 | [0m[35m        """Check if hosted zone is private or public."""[0m
[30;1m50 | [0m[35m        return self.get_hosted_zone(hosted_zone_id).get("HostedZone").get("Config").get("PrivateZone[0m

[31m--[ [0m[34mMatch #[0m[33m786[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/route53.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m    @Cache.cached[0m
[30;1m48 | [0m[35m    def is_hosted_zone_private(self, hosted_zone_id):[0m
[30;1m49 | [0m[35m        """Check if hosted zone is private or public."""[0m
[30;1m50 | [0m[35m        return self.get_hosted_zone(hosted_zone_id).get("HostedZone").get("Config").get("PrivateZone[0m

[31m--[ [0m[34mMatch #[0m[33m787[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/route53.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m    @Cache.cached[0m
[30;1m48 | [0m[35m    def is_hosted_zone_private(self, hosted_zone_id):[0m
[30;1m49 | [0m[35m        """Check if hosted zone is private or public."""[0m
[30;1m50 | [0m[35m        return self.get_hosted_zone(hosted_zone_id).get("HostedZone").get("Config").get("PrivateZone[0m

[31m--[ [0m[34mMatch #[0m[33m788[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/route53.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m    @Cache.cached[0m
[30;1m42 | [0m[35m    def get_hosted_zone_vpcs(self, hosted_zone_id):[0m
[30;1m43 | [0m[35m        """Return list of vpc ids related to the hosted zone."""[0m
[30;1m44 | [0m[35m        return [vpc.get("VPCId") for vpc in self.get_hosted_zone(hosted_zone_id).get("VPCs")][0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m47 | [0m[35m    @Cache.cached[0m

[31m--[ [0m[34mMatch #[0m[33m789[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/route53.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m    @Cache.cached[0m
[30;1m42 | [0m[35m    def get_hosted_zone_vpcs(self, hosted_zone_id):[0m
[30;1m43 | [0m[35m        """Return list of vpc ids related to the hosted zone."""[0m
[30;1m44 | [0m[35m        return [vpc.get("VPCId") for vpc in self.get_hosted_zone(hosted_zone_id).get("VPCs")][0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m47 | [0m[35m    @Cache.cached[0m

[31m--[ [0m[34mMatch #[0m[33m790[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/route53.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m    @Cache.cached[0m
[30;1m36 | [0m[35m    def get_hosted_zone_domain_name(self, hosted_zone_id):[0m
[30;1m37 | [0m[35m        """Return domain name given hosted zone id."""[0m
[30;1m38 | [0m[35m        return self.get_hosted_zone(hosted_zone_id).get("HostedZone").get("Name")[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m41 | [0m[35m    @Cache.cached[0m

[31m--[ [0m[34mMatch #[0m[33m791[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/route53.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m    @Cache.cached[0m
[30;1m36 | [0m[35m    def get_hosted_zone_domain_name(self, hosted_zone_id):[0m
[30;1m37 | [0m[35m        """Return domain name given hosted zone id."""[0m
[30;1m38 | [0m[35m        return self.get_hosted_zone(hosted_zone_id).get("HostedZone").get("Name")[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m41 | [0m[35m    @Cache.cached[0m

[31m--[ [0m[34mMatch #[0m[33m792[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/route53.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m793[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/ssm.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2023 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m794[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/lib/lib.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m                elif not isinstance(kwargs.get(param_name), str) and param["type"] == "file":[0m
[30;1m68 | [0m[35m                    kwargs[param_name] = yaml.dump(kwargs[param_name])[0m
[30;1m69 | [0m[35m                elif isinstance(kwargs.get(param_name), list) and all([0m
[30;1m70 | [0m[35m                    isinstance(item, str) for item in kwargs.get(param_name)[0m
[30;1m71 | [0m[35m                ):[0m
[30;1m72 | [0m[35m                    pass[0m
[30;1m73 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m795[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/lib/lib.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m                # Convert python data to strings for args of type "file"[0m
[30;1m67 | [0m[35m                elif not isinstance(kwargs.get(param_name), str) and param["type"] == "file":[0m
[30;1m68 | [0m[35m                    kwargs[param_name] = yaml.dump(kwargs[param_name])[0m
[30;1m69 | [0m[35m                elif isinstance(kwargs.get(param_name), list) and all([0m
[30;1m70 | [0m[35m                    isinstance(item, str) for item in kwargs.get(param_name)[0m
[30;1m71 | [0m[35m                ):[0m
[30;1m72 | [0m[35m                    pass[0m

[31m--[ [0m[34mMatch #[0m[33m796[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/lib/lib.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m                if param_name not in kwargs:[0m
[30;1m65 | [0m[35m                    kwargs[param_name] = None[0m
[30;1m66 | [0m[35m                # Convert python data to strings for args of type "file"[0m
[30;1m67 | [0m[35m                elif not isinstance(kwargs.get(param_name), str) and param["type"] == "file":[0m
[30;1m68 | [0m[35m                    kwargs[param_name] = yaml.dump(kwargs[param_name])[0m
[30;1m69 | [0m[35m                elif isinstance(kwargs.get(param_name), list) and all([0m
[30;1m70 | [0m[35m                    isinstance(item, str) for item in kwargs.get(param_name)[0m

[31m--[ [0m[34mMatch #[0m[33m797[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/lib/lib.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m34 | [0m[35m            self.__dict__ = args[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    # Much like the CLI, we add wait commands for these cluster options to[0m
[30;1m37 | [0m[35m    # allow the user to have these be synchronous. This is done at the argument[0m
[30;1m38 | [0m[35m    # parser level on the CLI side.[0m
[30;1m39 | [0m[35m    wait_ops = ["create-cluster", "delete-cluster", "update-cluster"][0m
[30;1m40 | [0m[35m    for op_name in filter(lambda x: x in model, wait_ops):[0m

[31m--[ [0m[34mMatch #[0m[33m798[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/lib/lib.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not[0m
[30;1m4 | [0m[35m# use this file except in compliance with the License. A copy of the License is[0m
[30;1m5 | [0m[35m# located at[0m
[30;1m6 | [0m[35m#[0m
[30;1m7 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m8 | [0m[35m#[0m
[30;1m9 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed[0m

[31m--[ [0m[34mMatch #[0m[33m799[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/common_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m152 | [0m[35m    @post_dump[0m
[30;1m153 | [0m[35m    def remove_none_values(self, data, **kwargs):[0m
[30;1m154 | [0m[35m        """Remove None values before creating the Yaml format."""[0m
[30;1m155 | [0m[35m        if self.context.get("delete_defaults_when_dump"):[0m
[30;1m156 | [0m[35m            return {key: value for key, value in data.items() if value not in (None, [], {})}[0m
[30;1m157 | [0m[35m        return data[0m
[30;1m158 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m800[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/common_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m131 | [0m[35m    def prepare_objects(self, data, **kwargs):[0m
[30;1m132 | [0m[35m        """Prepare objects to be ready for yaml conversion."""[0m
[30;1m133 | [0m[35m        adapted_data = copy.deepcopy(data)[0m
[30;1m134 | [0m[35m        if self.context.get("delete_defaults_when_dump"):[0m
[30;1m135 | [0m[35m            for key, value in vars(adapted_data).copy().items():[0m
[30;1m136 | [0m[35m                # Remove value implied by the code. i.e., only keep parameters that were specified i[0m
[30;1m137 | [0m[35m                if _is_implied(adapted_data, key, value):[0m

[31m--[ [0m[34mMatch #[0m[33m801[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/common_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m        if kwargs.get("partial"):[0m
[30;1m125 | [0m[35m            # If the schema is to be loaded partially, do not check existence constrain.[0m
[30;1m126 | [0m[35m            return False[0m
[30;1m127 | [0m[35m        num_of_fields = len([data.get(field_name) for field_name in field_list if data.get(field_nam[0m
[30;1m128 | [0m[35m        return num_of_fields != 1 if one_required else num_of_fields > 1[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m    @pre_dump[0m

[31m--[ [0m[34mMatch #[0m[33m802[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/common_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m        if kwargs.get("partial"):[0m
[30;1m125 | [0m[35m            # If the schema is to be loaded partially, do not check existence constrain.[0m
[30;1m126 | [0m[35m            return False[0m
[30;1m127 | [0m[35m        num_of_fields = len([data.get(field_name) for field_name in field_list if data.get(field_nam[0m
[30;1m128 | [0m[35m        return num_of_fields != 1 if one_required else num_of_fields > 1[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m    @pre_dump[0m

[31m--[ [0m[34mMatch #[0m[33m803[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/common_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m121 | [0m[35m        :param one_required: True if one of the fields is required to exist[0m
[30;1m122 | [0m[35m        :return: True if one and only one field is not None[0m
[30;1m123 | [0m[35m        """[0m
[30;1m124 | [0m[35m        if kwargs.get("partial"):[0m
[30;1m125 | [0m[35m            # If the schema is to be loaded partially, do not check existence constrain.[0m
[30;1m126 | [0m[35m            return False[0m
[30;1m127 | [0m[35m        num_of_fields = len([data.get(field_name) for field_name in field_list if data.get(field_nam[0m

[31m--[ [0m[34mMatch #[0m[33m804[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/common_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m74 | [0m[35m        if isinstance(tag, BaseTag):[0m
[30;1m75 | [0m[35m            tag_key = tag.key[0m
[30;1m76 | [0m[35m        else:[0m
[30;1m77 | [0m[35m            tag_key = tag.get("key", "")[0m
[30;1m78 | [0m[35m        if tag_key in all_tags:[0m
[30;1m79 | [0m[35m            raise ValidationError([0m
[30;1m80 | [0m[35m                f"Duplicate tag key ({tag_key}) detected. Tags keys should be unique within the Tags[0m

[31m--[ [0m[34mMatch #[0m[33m805[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/common_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m            if isinstance(tag, BaseTag):[0m
[30;1m63 | [0m[35m                tag_key = tag.key[0m
[30;1m64 | [0m[35m            else:[0m
[30;1m65 | [0m[35m                tag_key = tag.get("key", "")[0m
[30;1m66 | [0m[35m            if tag_key.startswith(PCLUSTER_PREFIX) and not tag_key == "parallelcluster:custom_resour[0m
[30;1m67 | [0m[35m                raise ValidationError(message=f"The tag key prefix '{PCLUSTER_PREFIX}' is reserved a[0m
[30;1m68 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m806[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/common_schema.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m284 | [0m[35m    """[0m
[30;1m285 | [0m[35m    Represent the Imds schema shared between cluster and build image files.[0m
[30;1m286 | [0m[35m[0m
[30;1m287 | [0m[35m    It represents the Imds element that can be either at top level in the cluster config file,[0m
[30;1m288 | [0m[35m    or in the Build section of the build image config file.[0m
[30;1m289 | [0m[35m    """[0m
[30;1m290 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m807[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/common_schema.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m114 | [0m[35m    @staticmethod[0m
[30;1m115 | [0m[35m    def fields_coexist(data, field_list, one_required=False, **kwargs):[0m
[30;1m116 | [0m[35m        """[0m
[30;1m117 | [0m[35m        Check if at least two fields in the field list co-exist in the schema.[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        :param data: data to be checked[0m
[30;1m120 | [0m[35m        :param field_list: list including the name of the fields to check[0m

[31m--[ [0m[34mMatch #[0m[33m808[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/common_schema.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m809[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/common_schema.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m284 | [0m[35m    """[0m
[30;1m285 | [0m[35m    Represent the Imds schema shared between cluster and build image files.[0m
[30;1m286 | [0m[35m[0m
[30;1m287 | [0m[35m    It represents the Imds element that can be either at top level in the cluster config file,[0m
[30;1m288 | [0m[35m    or in the Build section of the build image config file.[0m
[30;1m289 | [0m[35m    """[0m
[30;1m290 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m810[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ebs_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m277 | [0m[35m                # is_multi_attach_enabled = respond.get("MultiAttachEnabled", False)[0m
[30;1m278 | [0m[35m                if not is_available and not is_attached_to_head_node:[0m
[30;1m279 | [0m[35m                    self._add_failure([0m
[30;1m280 | [0m[35m                        "Volume {0} is in state '{1}' not 'available'.".format(volume_id, respond.ge[0m
[30;1m281 | [0m[35m                        FailureLevel.ERROR,[0m
[30;1m282 | [0m[35m                    )[0m
[30;1m283 | [0m[35m            except AWSClientError as e:[0m

[31m--[ [0m[34mMatch #[0m[33m811[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ebs_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m274 | [0m[35m                # TODO Mounting and EBS Volume with multi-attach is not officially supported.[0m
[30;1m275 | [0m[35m                # As long as it is not officially supported, we should emit the warning when mountin[0m
[30;1m276 | [0m[35m                # EBS volume with multi-attach.[0m
[30;1m277 | [0m[35m                # is_multi_attach_enabled = respond.get("MultiAttachEnabled", False)[0m
[30;1m278 | [0m[35m                if not is_available and not is_attached_to_head_node:[0m
[30;1m279 | [0m[35m                    self._add_failure([0m
[30;1m280 | [0m[35m                        "Volume {0} is in state '{1}' not 'available'.".format(volume_id, respond.ge[0m

[31m--[ [0m[34mMatch #[0m[33m812[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ebs_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m268 | [0m[35m                respond = AWSApi.instance().ec2.describe_volume(volume_id)[0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35m                state = respond.get("State")[0m
[30;1m271 | [0m[35m                attached_instances = [attachment.get("InstanceId") for attachment in respond.get("At[0m
[30;1m272 | [0m[35m                is_available = state == "available"[0m
[30;1m273 | [0m[35m                is_attached_to_head_node = head_node_instance_id and head_node_instance_id in attach[0m
[30;1m274 | [0m[35m                # TODO Mounting and EBS Volume with multi-attach is not officially supported.[0m

[31m--[ [0m[34mMatch #[0m[33m813[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ebs_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m268 | [0m[35m                respond = AWSApi.instance().ec2.describe_volume(volume_id)[0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35m                state = respond.get("State")[0m
[30;1m271 | [0m[35m                attached_instances = [attachment.get("InstanceId") for attachment in respond.get("At[0m
[30;1m272 | [0m[35m                is_available = state == "available"[0m
[30;1m273 | [0m[35m                is_attached_to_head_node = head_node_instance_id and head_node_instance_id in attach[0m
[30;1m274 | [0m[35m                # TODO Mounting and EBS Volume with multi-attach is not officially supported.[0m

[31m--[ [0m[34mMatch #[0m[33m814[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ebs_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m267 | [0m[35m            try:[0m
[30;1m268 | [0m[35m                respond = AWSApi.instance().ec2.describe_volume(volume_id)[0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35m                state = respond.get("State")[0m
[30;1m271 | [0m[35m                attached_instances = [attachment.get("InstanceId") for attachment in respond.get("At[0m
[30;1m272 | [0m[35m                is_available = state == "available"[0m
[30;1m273 | [0m[35m                is_attached_to_head_node = head_node_instance_id and head_node_instance_id in attach[0m

[31m--[ [0m[34mMatch #[0m[33m815[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ebs_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m                if snapshot_response_dict.get("State") != "completed":[0m
[30;1m165 | [0m[35m                    self._add_failure([0m
[30;1m166 | [0m[35m                        "Snapshot {0} is in state '{1}' not 'completed'.".format([0m
[30;1m167 | [0m[35m                            snapshot_id, snapshot_response_dict.get("State")[0m
[30;1m168 | [0m[35m                        ),[0m
[30;1m169 | [0m[35m                        FailureLevel.WARNING,[0m
[30;1m170 | [0m[35m                    )[0m

[31m--[ [0m[34mMatch #[0m[33m816[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ebs_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m161 | [0m[35m                    )[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m                # validate that the state of ebs snapshot[0m
[30;1m164 | [0m[35m                if snapshot_response_dict.get("State") != "completed":[0m
[30;1m165 | [0m[35m                    self._add_failure([0m
[30;1m166 | [0m[35m                        "Snapshot {0} is in state '{1}' not 'completed'.".format([0m
[30;1m167 | [0m[35m                            snapshot_id, snapshot_response_dict.get("State")[0m

[31m--[ [0m[34mMatch #[0m[33m817[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ebs_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m141 | [0m[35m                snapshot_response_dict = AWSApi.instance().ec2.get_ebs_snapshot_info(snapshot_id)[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m                # validate that the input volume size is larger than the volume size of the EBS snap[0m
[30;1m144 | [0m[35m                snapshot_volume_size = snapshot_response_dict.get("VolumeSize")[0m
[30;1m145 | [0m[35m                if snapshot_volume_size is None:[0m
[30;1m146 | [0m[35m                    self._add_failure(f"Unable to get volume size for snapshot {snapshot_id}.", Fail[0m
[30;1m147 | [0m[35m                elif volume_size < snapshot_volume_size:[0m

[31m--[ [0m[34mMatch #[0m[33m818[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ebs_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m    def _validate(self, volume_type, volume_size, volume_iops):[0m
[30;1m107 | [0m[35m        if volume_type in EBS_VOLUME_IOPS_BOUNDS:[0m
[30;1m108 | [0m[35m            min_iops, max_iops = EBS_VOLUME_IOPS_BOUNDS.get(volume_type)[0m
[30;1m109 | [0m[35m            if volume_iops and (volume_iops < min_iops or volume_iops > max_iops):[0m
[30;1m110 | [0m[35m                self._add_failure([0m
[30;1m111 | [0m[35m                    f"IOPS rate must be between {min_iops} and {max_iops}" f" when provisioning {vol[0m

[31m--[ [0m[34mMatch #[0m[33m819[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ebs_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    def _validate(self, volume_type: str, volume_size: int):[0m
[30;1m48 | [0m[35m        if volume_size is not None and volume_type in EBS_VOLUME_TYPE_TO_VOLUME_SIZE_BOUNDS:[0m
[30;1m49 | [0m[35m            min_size, max_size = EBS_VOLUME_TYPE_TO_VOLUME_SIZE_BOUNDS.get(volume_type)[0m
[30;1m50 | [0m[35m            if volume_size > max_size:[0m
[30;1m51 | [0m[35m                self._add_failure([0m
[30;1m52 | [0m[35m                    f"The size of {volume_type} volumes can not exceed {max_size} GiB.",[0m

[31m--[ [0m[34mMatch #[0m[33m820[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ebs_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m206 | [0m[35m                if ebs_az != head_node_az:[0m
[30;1m207 | [0m[35m                    self._add_failure([0m
[30;1m208 | [0m[35m                        "Your configuration includes an EBS volume '{0}' created in a different avai[0m
[30;1m209 | [0m[35m                        "the Head Node. The volume and instance must be in the same availability "[0m
[30;1m210 | [0m[35m                        "zone.".format(volume.name),[0m
[30;1m211 | [0m[35m                        FailureLevel.ERROR,[0m
[30;1m212 | [0m[35m                    )[0m

[31m--[ [0m[34mMatch #[0m[33m821[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ebs_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m54 | [0m[35m                )[0m
[30;1m55 | [0m[35m            elif volume_size < min_size:[0m
[30;1m56 | [0m[35m                self._add_failure([0m
[30;1m57 | [0m[35m                    f"The size of {volume_type} volumes must be at least {min_size} GiB.",[0m
[30;1m58 | [0m[35m                    FailureLevel.ERROR,[0m
[30;1m59 | [0m[35m                )[0m
[30;1m60 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m822[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ebs_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m823[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m824[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m193 | [0m[35m    @staticmethod[0m
[30;1m194 | [0m[35m    def instance():[0m
[30;1m195 | [0m[35m        """Return the singleton AWSApi instance."""[0m
[30;1m196 | [0m[35m        if not AWSApi._instance or AWSApi._instance.aws_region != os.environ.get("AWS_DEFAULT_REGION[0m
[30;1m197 | [0m[35m            AWSApi._instance = AWSApi()[0m
[30;1m198 | [0m[35m        return AWSApi._instance[0m
[30;1m199 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m825[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_api.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35m    _instance = None[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    def __init__(self):[0m
[30;1m45 | [0m[35m        self.aws_region = os.environ.get("AWS_DEFAULT_REGION")[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m        self._batch = None[0m
[30;1m48 | [0m[35m        self._cfn = None[0m

[31m--[ [0m[34mMatch #[0m[33m826[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_api.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m827[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m        self.is_external = any(key in self.storage_settings for key in EXTERNAL_STORAGE_KEYS)[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35m        # Storage Type[0m
[30;1m32 | [0m[35m        self.storage_type = storage_item.get("StorageType")[0m

[31m--[ [0m[34mMatch #[0m[33m828[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m        self.is_unmount = is_storage_list_change and old_value is not None and new_value is None[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m        self.storage_type = storage_item.get("StorageType")[0m
[30;1m26 | [0m[35m        self.storage_settings = storage_item.get(f"{self.storage_type}Settings", {})[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m        # Storage Ownership[0m
[30;1m29 | [0m[35m        self.is_external = any(key in self.storage_settings for key in EXTERNAL_STORAGE_KEYS)[0m

[31m--[ [0m[34mMatch #[0m[33m829[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy_utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m        self.is_mount = is_storage_list_change and old_value is None and new_value is not None[0m
[30;1m23 | [0m[35m        self.is_unmount = is_storage_list_change and old_value is not None and new_value is None[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m        self.storage_type = storage_item.get("StorageType")[0m
[30;1m26 | [0m[35m        self.storage_settings = storage_item.get(f"{self.storage_type}Settings", {})[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m        # Storage Ownership[0m

[31m--[ [0m[34mMatch #[0m[33m830[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy_utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m    Capture relevant information about a change to the shared storage.[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m    Relevant info are:[0m
[30;1m9 | [0m[35m      1. the requested action: mount or unmount.[0m
[30;1m10 | [0m[35m      2. the storage type: EFS, FSx.[0m
[30;1m11 | [0m[35m      3. the storage ownership (external or managed).[0m
[30;1m12 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m831[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/fsx.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m123 | [0m[35m            response = self._client.describe_file_caches(FileCacheIds=missed_file_cache_ids)["FileCa[0m
[30;1m124 | [0m[35m            for file_cache in response:[0m
[30;1m125 | [0m[35m                file_cache_info = FsxStorageInfo(file_cache)[0m
[30;1m126 | [0m[35m                self.fc_cache[file_cache.get("FileCacheId")] = file_cache_info[0m
[30;1m127 | [0m[35m                result.append(file_cache_info)[0m
[30;1m128 | [0m[35m        return result[0m

[31m--[ [0m[34mMatch #[0m[33m832[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/fsx.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m114 | [0m[35m        result = [][0m
[30;1m115 | [0m[35m        missed_file_cache_ids = [][0m
[30;1m116 | [0m[35m        for file_cache_id in file_cache_ids:[0m
[30;1m117 | [0m[35m            cached_data = self.fc_cache.get(file_cache_id)[0m
[30;1m118 | [0m[35m            if cached_data:[0m
[30;1m119 | [0m[35m                result.append(cached_data)[0m
[30;1m120 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m833[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/fsx.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m107 | [0m[35m    def describe_backup(self, backup_id):[0m
[30;1m108 | [0m[35m        """Describe backup."""[0m
[30;1m109 | [0m[35m        return self._client.describe_backups(BackupIds=[backup_id]).get("Backups")[0][0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m112 | [0m[35m    def describe_file_caches(self, file_cache_ids):[0m

[31m--[ [0m[34mMatch #[0m[33m834[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/fsx.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m99 | [0m[35m        if missed_dra_ids:[0m
[30;1m100 | [0m[35m            response = self._client.describe_data_repository_associations(AssociationIds=missed_dra_[0m
[30;1m101 | [0m[35m            for dra in response:[0m
[30;1m102 | [0m[35m                self.dra_cache[dra.get("AssociationId")] = dra[0m
[30;1m103 | [0m[35m                result.append(dra)[0m
[30;1m104 | [0m[35m        return result[0m
[30;1m105 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m835[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/fsx.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m        result = [][0m
[30;1m92 | [0m[35m        missed_dra_ids = [][0m
[30;1m93 | [0m[35m        for dra_id in dra_ids:[0m
[30;1m94 | [0m[35m            cached_data = self.dra_cache.get(dra_id)[0m
[30;1m95 | [0m[35m            if cached_data:[0m
[30;1m96 | [0m[35m                result.append(cached_data)[0m
[30;1m97 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m836[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/fsx.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m        if missed_volume_ids:[0m
[30;1m82 | [0m[35m            response = self._client.describe_volumes(VolumeIds=missed_volume_ids)["Volumes"][0m
[30;1m83 | [0m[35m            for volume in response:[0m
[30;1m84 | [0m[35m                self.volume_cache[volume.get("VolumeId")] = volume[0m
[30;1m85 | [0m[35m                result.append(volume)[0m
[30;1m86 | [0m[35m        return result[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m837[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/fsx.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m        result = [][0m
[30;1m74 | [0m[35m        missed_volume_ids = [][0m
[30;1m75 | [0m[35m        for volume_id in volume_ids:[0m
[30;1m76 | [0m[35m            cached_data = self.volume_cache.get(volume_id)[0m
[30;1m77 | [0m[35m            if cached_data:[0m
[30;1m78 | [0m[35m                result.append(cached_data)[0m
[30;1m79 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m838[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/fsx.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m                StorageVirtualMachineIds=missed_storage_virtual_machine_ids[0m
[30;1m64 | [0m[35m            )["StorageVirtualMachines"][0m
[30;1m65 | [0m[35m            for storage_virtual_machine in response:[0m
[30;1m66 | [0m[35m                self.svm_cache[storage_virtual_machine.get("StorageVirtualMachineId")] = storage_vir[0m
[30;1m67 | [0m[35m                result.append(storage_virtual_machine)[0m
[30;1m68 | [0m[35m        return result[0m
[30;1m69 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m839[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/fsx.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m        result = [][0m
[30;1m54 | [0m[35m        missed_storage_virtual_machine_ids = [][0m
[30;1m55 | [0m[35m        for storage_virtual_machine_id in storage_virtual_machine_ids:[0m
[30;1m56 | [0m[35m            cached_data = self.svm_cache.get(storage_virtual_machine_id)[0m
[30;1m57 | [0m[35m            if cached_data:[0m
[30;1m58 | [0m[35m                result.append(cached_data)[0m
[30;1m59 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m840[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/fsx.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m        result = [][0m
[30;1m35 | [0m[35m        missed_fsx_fs_ids = [][0m
[30;1m36 | [0m[35m        for file_system_id in fsx_fs_ids:[0m
[30;1m37 | [0m[35m            cached_data = self.cache.get(file_system_id)[0m
[30;1m38 | [0m[35m            if cached_data:[0m
[30;1m39 | [0m[35m                result.append(cached_data)[0m
[30;1m40 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m841[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/fsx.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m842[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/efs_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mclass EfsAccessPointOptionsValidator(Validator):[0m
[30;1m31 | [0m[35m    """[0m
[30;1m32 | [0m[35m    EFS Mount Options validator.[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    IAM Authorization requires Encryption in Transit.[0m
[30;1m35 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m843[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/efs_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mclass EfsMountOptionsValidator(Validator):[0m
[30;1m15 | [0m[35m    """[0m
[30;1m16 | [0m[35m    EFS Mount Options validator.[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m    IAM Authorization requires Encryption in Transit.[0m
[30;1m19 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m844[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/efs_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2022 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m845[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/directory_service_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m        elif domain_addr_scheme == "ldap":[0m
[30;1m46 | [0m[35m            warning_message = "The use of the ldaps protocol is strongly encouraged for security rea[0m
[30;1m47 | [0m[35m            tls_disabled = ([0m
[30;1m48 | [0m[35m                str(additional_sssd_configs.get("ldap_auth_disable_tls_never_use_in_production", "fa[0m
[30;1m49 | [0m[35m                == "true"[0m
[30;1m50 | [0m[35m            )[0m
[30;1m51 | [0m[35m            if not tls_disabled:[0m

[31m--[ [0m[34mMatch #[0m[33m846[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/directory_service_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m847[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/directory_service_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m            if service == "secretsmanager" and resource == "secret":[0m
[30;1m94 | [0m[35m                AWSApi.instance().secretsmanager.describe_secret(password_secret_arn)[0m
[30;1m95 | [0m[35m            elif ([0m
[30;1m96 | [0m[35m                service == "ssm"[0m
[30;1m97 | [0m[35m                and resource_type == "parameter"  # pylint: disable=E0606[0m
[30;1m98 | [0m[35m                and region == "us-isob-east-1"[0m
[30;1m99 | [0m[35m            ):[0m

[31m--[ [0m[34mMatch #[0m[33m848[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/directory_service_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m90 | [0m[35m            service, resource = get_arn_service_and_resource(password_secret_arn)[0m
[30;1m91 | [0m[35m            if service == "ssm":[0m
[30;1m92 | [0m[35m                resource_type = resource.split("/")[0][0m
[30;1m93 | [0m[35m            if service == "secretsmanager" and resource == "secret":[0m
[30;1m94 | [0m[35m                AWSApi.instance().secretsmanager.describe_secret(password_secret_arn)[0m
[30;1m95 | [0m[35m            elif ([0m
[30;1m96 | [0m[35m                service == "ssm"[0m

[31m--[ [0m[34mMatch #[0m[33m849[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/directory_service_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m        """[0m
[30;1m89 | [0m[35m        try:[0m
[30;1m90 | [0m[35m            service, resource = get_arn_service_and_resource(password_secret_arn)[0m
[30;1m91 | [0m[35m            if service == "ssm":[0m
[30;1m92 | [0m[35m                resource_type = resource.split("/")[0][0m
[30;1m93 | [0m[35m            if service == "secretsmanager" and resource == "secret":[0m
[30;1m94 | [0m[35m                AWSApi.instance().secretsmanager.describe_secret(password_secret_arn)[0m

[31m--[ [0m[34mMatch #[0m[33m850[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/aws_parallelcluster.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m67 | [0m[35mAWS ParallelCluster facilitates both quick start proof of concepts (POCs) and production deployments[0m
[30;1m68 | [0m[35mYou can build higher level workflows, such as a Genomics portal that automates the entire DNA sequen[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35mDocumentation can be found at https://docs.aws.amazon.com/parallelcluster/[0m

[31m--[ [0m[34mMatch #[0m[33m851[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/aws_parallelcluster.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35mBuilt on the Open Source CfnCluster project, AWS ParallelCluster enables you to quickly build an HPC[0m
[30;1m66 | [0m[35mIt automatically sets up the required compute resources and a shared filesystem and offers a variety[0m
[30;1m67 | [0m[35mAWS ParallelCluster facilitates both quick start proof of concepts (POCs) and production deployments[0m
[30;1m68 | [0m[35mYou can build higher level workflows, such as a Genomics portal that automates the entire DNA sequen[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35mDocumentation can be found at https://docs.aws.amazon.com/parallelcluster/[0m

[31m--[ [0m[34mMatch #[0m[33m852[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/kms.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m853[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_instances_controller.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m854[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_instances_controller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m68 | [0m[35m    :type region: str[0m
[30;1m69 | [0m[35m    :param next_token: Token to use for paginated requests.[0m
[30;1m70 | [0m[35m    :type next_token: str[0m
[30;1m71 | [0m[35m    :param node_type: Filter the instances by node type.[0m
[30;1m72 | [0m[35m    :type node_type: dict | bytes[0m
[30;1m73 | [0m[35m    :param queue_name: Filter the instances by queue name.[0m
[30;1m74 | [0m[35m    :type queue_name: str[0m

[31m--[ [0m[34mMatch #[0m[33m855[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m856[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cw_dashboard_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m796 | [0m[35m        if fields is None:[0m
[30;1m797 | [0m[35m            fields = ["@timestamp", "@message"][0m
[30;1m798 | [0m[35m        if sort is None:[0m
[30;1m799 | [0m[35m            sort = "@timestamp desc"[0m
[30;1m800 | [0m[35m        if limit is None:[0m
[30;1m801 | [0m[35m            limit = 100[0m
[30;1m802 | [0m[35m        return _CWLogWidget(title, conditions, fields, filters, sort, limit)[0m

[31m--[ [0m[34mMatch #[0m[33m857[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cw_dashboard_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m795 | [0m[35m    def _new_cw_log_widget(self, title=None, conditions=None, fields=None, filters=None, sort=None, [0m
[30;1m796 | [0m[35m        if fields is None:[0m
[30;1m797 | [0m[35m            fields = ["@timestamp", "@message"][0m
[30;1m798 | [0m[35m        if sort is None:[0m
[30;1m799 | [0m[35m            sort = "@timestamp desc"[0m
[30;1m800 | [0m[35m        if limit is None:[0m
[30;1m801 | [0m[35m            limit = 100[0m

[31m--[ [0m[34mMatch #[0m[33m858[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cw_dashboard_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m647 | [0m[35m[0m
[30;1m648 | [0m[35m    def _add_cw_log(self):[0m
[30;1m649 | [0m[35m        # Create a text widget for subtitle "Head Node Logs"[0m
[30;1m650 | [0m[35m        self._add_text_widget("# Head Node Logs")[0m
[30;1m651 | [0m[35m[0m
[30;1m652 | [0m[35m        dcv_enabled = self.config.is_dcv_enabled[0m
[30;1m653 | [0m[35m        scheduler = self.config.scheduling.scheduler[0m

[31m--[ [0m[34mMatch #[0m[33m859[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cw_dashboard_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m646 | [0m[35m        self._update_coord_after_section(self.graph_height)[0m
[30;1m647 | [0m[35m[0m
[30;1m648 | [0m[35m    def _add_cw_log(self):[0m
[30;1m649 | [0m[35m        # Create a text widget for subtitle "Head Node Logs"[0m
[30;1m650 | [0m[35m        self._add_text_widget("# Head Node Logs")[0m
[30;1m651 | [0m[35m[0m
[30;1m652 | [0m[35m        dcv_enabled = self.config.is_dcv_enabled[0m

[31m--[ [0m[34mMatch #[0m[33m860[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cw_dashboard_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m555 | [0m[35m            ),[0m
[30;1m556 | [0m[35m        ][0m
[30;1m557 | [0m[35m[0m
[30;1m558 | [0m[35m        # CW Agent metrics for graph for head node instance[0m
[30;1m559 | [0m[35m        cwagent_metrics = [[0m
[30;1m560 | [0m[35m            new_pcluster_metric([0m
[30;1m561 | [0m[35m                title="Disk Used Percent",[0m

[31m--[ [0m[34mMatch #[0m[33m861[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cw_dashboard_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m540 | [0m[35m        # Create a text widget for subtitle "Head Node Instance Metrics"[0m
[30;1m541 | [0m[35m        self._add_text_widget("## Head Node Instance Metrics")[0m
[30;1m542 | [0m[35m[0m
[30;1m543 | [0m[35m        # EC2 metrics for graph for head node instance[0m
[30;1m544 | [0m[35m        ec2_metrics = [[0m
[30;1m545 | [0m[35m            new_pcluster_metric(title="CPU Utilization", metrics=["CPUUtilization"], namespace="AWS/[0m
[30;1m546 | [0m[35m            new_pcluster_metric([0m

[31m--[ [0m[34mMatch #[0m[33m862[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cw_dashboard_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m538 | [0m[35m[0m
[30;1m539 | [0m[35m    def _add_head_node_instance_metrics_graphs(self):[0m
[30;1m540 | [0m[35m        # Create a text widget for subtitle "Head Node Instance Metrics"[0m
[30;1m541 | [0m[35m        self._add_text_widget("## Head Node Instance Metrics")[0m
[30;1m542 | [0m[35m[0m
[30;1m543 | [0m[35m        # EC2 metrics for graph for head node instance[0m
[30;1m544 | [0m[35m        ec2_metrics = [[0m

[31m--[ [0m[34mMatch #[0m[33m863[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cw_dashboard_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m537 | [0m[35m        self._update_coord_after_section(self.graph_height)[0m
[30;1m538 | [0m[35m[0m
[30;1m539 | [0m[35m    def _add_head_node_instance_metrics_graphs(self):[0m
[30;1m540 | [0m[35m        # Create a text widget for subtitle "Head Node Instance Metrics"[0m
[30;1m541 | [0m[35m        self._add_text_widget("## Head Node Instance Metrics")[0m
[30;1m542 | [0m[35m[0m
[30;1m543 | [0m[35m        # EC2 metrics for graph for head node instance[0m

[31m--[ [0m[34mMatch #[0m[33m864[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cw_dashboard_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m531 | [0m[35m        return widgets_list[0m
[30;1m532 | [0m[35m[0m
[30;1m533 | [0m[35m    def _add_cluster_alarms(self):[0m
[30;1m534 | [0m[35m        widgets_list = [self._generate_alarms_widget(title="Head Node Alarms", alarms_list=self.head[0m
[30;1m535 | [0m[35m[0m
[30;1m536 | [0m[35m        self.cloudwatch_dashboard.add_widgets(*widgets_list)[0m
[30;1m537 | [0m[35m        self._update_coord_after_section(self.graph_height)[0m

[31m--[ [0m[34mMatch #[0m[33m865[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cw_dashboard_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m444 | [0m[35m                    ),[0m
[30;1m445 | [0m[35m                    cloudwatch.HorizontalAnnotation([0m
[30;1m446 | [0m[35m                        value=self.config.scheduling.settings.scaledown_idletime * 60,[0m
[30;1m447 | [0m[35m                        label="Idle Time Scaledown",[0m
[30;1m448 | [0m[35m                        color=cloudwatch.Color.BLUE,[0m
[30;1m449 | [0m[35m                        fill=cloudwatch.Shading.ABOVE,[0m
[30;1m450 | [0m[35m                        visible=True,[0m

[31m--[ [0m[34mMatch #[0m[33m866[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cw_dashboard_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m156 | [0m[35m        if len(self.shared_storage_infos[SharedStorageType.FSX]) > 0:[0m
[30;1m157 | [0m[35m            self._add_fsx_metrics_graphs()[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m        # Head Node logs add custom metrics if cw_log and metrics are enabled[0m
[30;1m160 | [0m[35m        if self.config.is_cw_logging_enabled:[0m
[30;1m161 | [0m[35m            if self.config.scheduling.scheduler == "slurm" and is_feature_supported(Feature.CLUSTER_[0m
[30;1m162 | [0m[35m                self._add_custom_health_metrics()[0m

[31m--[ [0m[34mMatch #[0m[33m867[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cw_dashboard_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m113 | [0m[35m        # Create a text widget for title "Head Node EC2 metrics"[0m
[30;1m114 | [0m[35m        self._add_text_widget("# Head Node EC2 Metrics")[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m        # Add head node instance graphs[0m
[30;1m117 | [0m[35m        self._add_head_node_instance_metrics_graphs()[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m        ebs_metrics = [[0m

[31m--[ [0m[34mMatch #[0m[33m868[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cw_dashboard_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m            self._add_cluster_alarms()[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m        # Create a text widget for title "Head Node EC2 metrics"[0m
[30;1m114 | [0m[35m        self._add_text_widget("# Head Node EC2 Metrics")[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m        # Add head node instance graphs[0m
[30;1m117 | [0m[35m        self._add_head_node_instance_metrics_graphs()[0m

[31m--[ [0m[34mMatch #[0m[33m869[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cw_dashboard_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m110 | [0m[35m            self._add_text_widget("# Cluster Alarms")[0m
[30;1m111 | [0m[35m            self._add_cluster_alarms()[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m        # Create a text widget for title "Head Node EC2 metrics"[0m
[30;1m114 | [0m[35m        self._add_text_widget("# Head Node EC2 Metrics")[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m        # Add head node instance graphs[0m

[31m--[ [0m[34mMatch #[0m[33m870[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cw_dashboard_builder.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m638 | [0m[35m        self._add_text_widget("## FSx Metrics")[0m
[30;1m639 | [0m[35m        fsx_volumes_list = self.shared_storage_infos[SharedStorageType.FSX][0m
[30;1m640 | [0m[35m[0m
[30;1m641 | [0m[35m        # Add FSx metrics graphs and update coordinates[0m
[30;1m642 | [0m[35m        widgets_list = self._add_fsx_widgets([0m
[30;1m643 | [0m[35m            storages_list=fsx_volumes_list,[0m
[30;1m644 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m871[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cw_dashboard_builder.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m566 | [0m[35m            new_pcluster_metric(title="Memory Used Percent", metrics=["mem_used_percent"], namespace[0m
[30;1m567 | [0m[35m        ][0m
[30;1m568 | [0m[35m[0m
[30;1m569 | [0m[35m        # Create graphs for EC2 metrics and CW Agent metrics and update coordinates[0m
[30;1m570 | [0m[35m        widgets_list = [][0m
[30;1m571 | [0m[35m        for metrics_param in ec2_metrics + cwagent_metrics:[0m
[30;1m572 | [0m[35m            metrics_list = self._generate_metrics_list(metrics_param)[0m

[31m--[ [0m[34mMatch #[0m[33m872[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cw_dashboard_builder.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m211 | [0m[35m        return widget[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m    def _generate_graph_widget(self, title, metric_list, **widget_kwargs):[0m
[30;1m214 | [0m[35m        """Generate a graph widget and update the coordinates."""[0m
[30;1m215 | [0m[35m        widget = cloudwatch.GraphWidget([0m
[30;1m216 | [0m[35m            title=title,[0m
[30;1m217 | [0m[35m            left=metric_list,[0m

[31m--[ [0m[34mMatch #[0m[33m873[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cw_dashboard_builder.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m198 | [0m[35m        self._update_coord_after_section(d_y=1)[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m    def _generate_alarms_widget(self, title: str, alarms_list: List[IAlarm], **widget_kwargs):[0m
[30;1m201 | [0m[35m        """Generate an alarms widget and update the coordinates."""[0m
[30;1m202 | [0m[35m        widget = cloudwatch.AlarmStatusWidget([0m
[30;1m203 | [0m[35m            title=title,[0m
[30;1m204 | [0m[35m            alarms=alarms_list,[0m

[31m--[ [0m[34mMatch #[0m[33m874[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cw_dashboard_builder.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m191 | [0m[35m                return[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m    def _add_text_widget(self, markdown):[0m
[30;1m194 | [0m[35m        """Add the textwidget to the cloudwatch dashboard and update coordinates."""[0m
[30;1m195 | [0m[35m        text_widget = cloudwatch.TextWidget(markdown="\n" + markdown + "\n", height=1, width=MAX_WID[0m
[30;1m196 | [0m[35m        text_widget.position(x=self.coord.x_value, y=self.coord.y_value)[0m
[30;1m197 | [0m[35m        self.cloudwatch_dashboard.add_widgets(text_widget)[0m

[31m--[ [0m[34mMatch #[0m[33m875[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cw_dashboard_builder.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m876[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/networking_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35mclass ElasticIpValidator(Validator):[0m
[30;1m114 | [0m[35m    """Elastic Ip validator."""[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m    def _validate(self, elastic_ip: Union[str, bool]):[0m
[30;1m117 | [0m[35m        if isinstance(elastic_ip, str):[0m

[31m--[ [0m[34mMatch #[0m[33m877[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/networking_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m878[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/login_nodes_state.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m879[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/s3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35mdef _process_s3_bucket_error(client_error, bucket_name, expected_bucket_owner=None, object_name=None[0m
[30;1m141 | [0m[35m    error_message = client_error.response.get("Error").get("Message")[0m
[30;1m142 | [0m[35m    error_code = client_error.response["Error"]["Code"][0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m    if error_code == "NoSuchBucket":[0m

[31m--[ [0m[34mMatch #[0m[33m880[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/s3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35mdef _process_s3_bucket_error(client_error, bucket_name, expected_bucket_owner=None, object_name=None[0m
[30;1m141 | [0m[35m    error_message = client_error.response.get("Error").get("Message")[0m
[30;1m142 | [0m[35m    error_code = client_error.response["Error"]["Code"][0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m    if error_code == "NoSuchBucket":[0m

[31m--[ [0m[34mMatch #[0m[33m881[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/s3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m    def get_bucket_region(self, bucket_name):[0m
[30;1m74 | [0m[35m        """Return bucket region."""[0m
[30;1m75 | [0m[35m        try:[0m
[30;1m76 | [0m[35m            bucket_region = self._client.get_bucket_location(Bucket=bucket_name).get("LocationConstr[0m
[30;1m77 | [0m[35m            # Buckets in Region us-east-1 have a LocationConstraint of null[0m
[30;1m78 | [0m[35m            # Example output from get_bucket_location for us-east-1:[0m
[30;1m79 | [0m[35m            #   {'ResponseMetadata': {...}, 'LocationConstraint': None}[0m

[31m--[ [0m[34mMatch #[0m[33m882[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/s3.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m69 | [0m[35m    def get_bucket_versioning_status(self, bucket_name):[0m
[30;1m70 | [0m[35m        """Return true if bucket versioning is enabled."""[0m
[30;1m71 | [0m[35m        return self._client.get_bucket_versioning(Bucket=bucket_name).get("Status")[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    def get_bucket_region(self, bucket_name):[0m
[30;1m74 | [0m[35m        """Return bucket region."""[0m

[31m--[ [0m[34mMatch #[0m[33m883[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/s3.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m884[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m401 | [0m[35m                cluster_name=cluster_name,[0m
[30;1m402 | [0m[35m                cloudformation_stack_status=CloudFormationStackStatus.UPDATE_IN_PROGRESS,[0m
[30;1m403 | [0m[35m                cloudformation_stack_arn=cluster.stack.id,[0m
[30;1m404 | [0m[35m                region=os.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m405 | [0m[35m                version=cluster.stack.version,[0m
[30;1m406 | [0m[35m                cluster_status=cloud_formation_status_to_cluster_status(CloudFormationStackStatus.UP[0m
[30;1m407 | [0m[35m                scheduler=Scheduler(type=cluster.stack.scheduler),[0m

[31m--[ [0m[34mMatch #[0m[33m885[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m312 | [0m[35m                cluster_name=stack.cluster_name,[0m
[30;1m313 | [0m[35m                cloudformation_stack_status=stack.status,[0m
[30;1m314 | [0m[35m                cloudformation_stack_arn=stack.id,[0m
[30;1m315 | [0m[35m                region=os.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m316 | [0m[35m                version=stack.version,[0m
[30;1m317 | [0m[35m                cluster_status=current_cluster_status,[0m
[30;1m318 | [0m[35m                scheduler=Scheduler(type=stack.scheduler),[0m

[31m--[ [0m[34mMatch #[0m[33m886[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m236 | [0m[35m        compute_fleet_status=fleet_status.value,[0m
[30;1m237 | [0m[35m        cloudformation_stack_arn=cfn_stack.id,[0m
[30;1m238 | [0m[35m        last_updated_time=to_utc_datetime(cfn_stack.last_updated_time),[0m
[30;1m239 | [0m[35m        region=os.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m240 | [0m[35m        cluster_status=cluster_status,[0m
[30;1m241 | [0m[35m        scheduler=Scheduler(type=cluster.stack.scheduler),[0m
[30;1m242 | [0m[35m        failures=_get_creation_failures(cluster_status, cfn_stack),[0m

[31m--[ [0m[34mMatch #[0m[33m887[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m230 | [0m[35m        creation_time=to_utc_datetime(cfn_stack.creation_time),[0m
[30;1m231 | [0m[35m        version=cfn_stack.version,[0m
[30;1m232 | [0m[35m        cluster_configuration=ClusterConfigurationStructure(url=config_url),[0m
[30;1m233 | [0m[35m        tags=[Tag(value=tag.get("Value"), key=tag.get("Key")) for tag in cfn_stack.tags],[0m
[30;1m234 | [0m[35m        cloud_formation_stack_status=cfn_stack.status,[0m
[30;1m235 | [0m[35m        cluster_name=cluster_name,[0m
[30;1m236 | [0m[35m        compute_fleet_status=fleet_status.value,[0m

[31m--[ [0m[34mMatch #[0m[33m888[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m230 | [0m[35m        creation_time=to_utc_datetime(cfn_stack.creation_time),[0m
[30;1m231 | [0m[35m        version=cfn_stack.version,[0m
[30;1m232 | [0m[35m        cluster_configuration=ClusterConfigurationStructure(url=config_url),[0m
[30;1m233 | [0m[35m        tags=[Tag(value=tag.get("Value"), key=tag.get("Key")) for tag in cfn_stack.tags],[0m
[30;1m234 | [0m[35m        cloud_formation_stack_status=cfn_stack.status,[0m
[30;1m235 | [0m[35m        cluster_name=cluster_name,[0m
[30;1m236 | [0m[35m        compute_fleet_status=fleet_status.value,[0m

[31m--[ [0m[34mMatch #[0m[33m889[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m185 | [0m[35m                cluster_name=cluster_name,[0m
[30;1m186 | [0m[35m                cloudformation_stack_status=CloudFormationStackStatus.DELETE_IN_PROGRESS,[0m
[30;1m187 | [0m[35m                cloudformation_stack_arn=cluster.stack.id,[0m
[30;1m188 | [0m[35m                region=os.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m189 | [0m[35m                version=cluster.stack.version,[0m
[30;1m190 | [0m[35m                cluster_status=cloud_formation_status_to_cluster_status(CloudFormationStackStatus.DE[0m
[30;1m191 | [0m[35m                scheduler=Scheduler(type=cluster.stack.scheduler),[0m

[31m--[ [0m[34mMatch #[0m[33m890[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m139 | [0m[35m                cluster_name=create_cluster_request_content.cluster_name,[0m
[30;1m140 | [0m[35m                cloudformation_stack_status=CloudFormationStackStatus.CREATE_IN_PROGRESS,[0m
[30;1m141 | [0m[35m                cloudformation_stack_arn=stack_id,[0m
[30;1m142 | [0m[35m                region=os.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m143 | [0m[35m                version=get_installed_version(),[0m
[30;1m144 | [0m[35m                cluster_status=cloud_formation_status_to_cluster_status(CloudFormationStackStatus.CR[0m
[30;1m145 | [0m[35m                scheduler=Scheduler(type=cluster.config.scheduling.scheduler),[0m

[31m--[ [0m[34mMatch #[0m[33m891[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m256 | [0m[35m        if login_nodes:[0m
[30;1m257 | [0m[35m            response.login_nodes = login_nodes[0m
[30;1m258 | [0m[35m    except ClusterActionError as e:[0m
[30;1m259 | [0m[35m        # This should not be treated as a failure cause head node and login node might not be runnin[0m
[30;1m260 | [0m[35m        # e.g. when the cluster is in DELETE_IN_PROGRESS[0m
[30;1m261 | [0m[35m        LOGGER.info(e)[0m
[30;1m262 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m892[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m256 | [0m[35m        if login_nodes:[0m
[30;1m257 | [0m[35m            response.login_nodes = login_nodes[0m
[30;1m258 | [0m[35m    except ClusterActionError as e:[0m
[30;1m259 | [0m[35m        # This should not be treated as a failure cause head node and login node might not be runnin[0m
[30;1m260 | [0m[35m        # e.g. when the cluster is in DELETE_IN_PROGRESS[0m
[30;1m261 | [0m[35m        LOGGER.info(e)[0m
[30;1m262 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m893[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m373 | [0m[35m        cluster = Cluster(cluster_name)[0m
[30;1m374 | [0m[35m        if not check_cluster_version(cluster, exact_match=True):[0m
[30;1m375 | [0m[35m            raise BadRequestException([0m
[30;1m376 | [0m[35m                f"the update can be performed only with the same ParallelCluster version ({cluster.s[0m
[30;1m377 | [0m[35m                "used to create the cluster."[0m
[30;1m378 | [0m[35m            )[0m
[30;1m379 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m894[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m350 | [0m[35m    :param dryrun: Only perform request validation without creating any resource.[0m
[30;1m351 | [0m[35m    May be used to validate the cluster configuration and update requirements. Response code: 200[0m
[30;1m352 | [0m[35m    :type dryrun: bool[0m
[30;1m353 | [0m[35m    :param force_update: Force update by ignoring the update validation errors.[0m
[30;1m354 | [0m[35m    (Defaults to &#39;false&#39;.)[0m
[30;1m355 | [0m[35m    :type force_update: bool[0m
[30;1m356 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m895[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m350 | [0m[35m    :param dryrun: Only perform request validation without creating any resource.[0m
[30;1m351 | [0m[35m    May be used to validate the cluster configuration and update requirements. Response code: 200[0m
[30;1m352 | [0m[35m    :type dryrun: bool[0m
[30;1m353 | [0m[35m    :param force_update: Force update by ignoring the update validation errors.[0m
[30;1m354 | [0m[35m    (Defaults to &#39;false&#39;.)[0m
[30;1m355 | [0m[35m    :type force_update: bool[0m
[30;1m356 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m896[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m348 | [0m[35m    :param region: AWS Region that the operation corresponds to.[0m
[30;1m349 | [0m[35m    :type region: str[0m
[30;1m350 | [0m[35m    :param dryrun: Only perform request validation without creating any resource.[0m
[30;1m351 | [0m[35m    May be used to validate the cluster configuration and update requirements. Response code: 200[0m
[30;1m352 | [0m[35m    :type dryrun: bool[0m
[30;1m353 | [0m[35m    :param force_update: Force update by ignoring the update validation errors.[0m
[30;1m354 | [0m[35m    (Defaults to &#39;false&#39;.)[0m

[31m--[ [0m[34mMatch #[0m[33m897[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m342 | [0m[35m    :param suppress_validators: Identifies one or more config validators to suppress.[0m
[30;1m343 | [0m[35m    Format: (ALL|type:[A-Za-z0-9]+)[0m
[30;1m344 | [0m[35m    :type suppress_validators: List[str][0m
[30;1m345 | [0m[35m    :param validation_failure_level: Min validation level that will cause the update to fail.[0m
[30;1m346 | [0m[35m    (Defaults to &#39;error&#39;.)[0m
[30;1m347 | [0m[35m    :type validation_failure_level: dict | bytes[0m
[30;1m348 | [0m[35m    :param region: AWS Region that the operation corresponds to.[0m

[31m--[ [0m[34mMatch #[0m[33m898[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m334 | [0m[35m    force_update=None,[0m
[30;1m335 | [0m[35m):[0m
[30;1m336 | [0m[35m    """[0m
[30;1m337 | [0m[35m    Update a cluster managed in a given region.[0m
[30;1m338 | [0m[35m[0m
[30;1m339 | [0m[35m    :param update_cluster_request_content:[0m
[30;1m340 | [0m[35m    :param cluster_name: Name of the cluster[0m

[31m--[ [0m[34mMatch #[0m[33m899[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_operations_controller.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m900[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m901[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1571 | [0m[35m            for subnet in AWSApi.instance().ec2.describe_subnets([0m
[30;1m1572 | [0m[35m                {subnet_id for queue in multi_nic_queues for subnet_id in queue.networking.subnet_id[0m
[30;1m1573 | [0m[35m            )[0m
[30;1m1574 | [0m[35m            if subnet.get("MapPublicIpOnLaunch")[0m
[30;1m1575 | [0m[35m        }[0m
[30;1m1576 | [0m[35m[0m
[30;1m1577 | [0m[35m        for queue in multi_nic_queues:[0m

[31m--[ [0m[34mMatch #[0m[33m902[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1567 | [0m[35m        ][0m
[30;1m1568 | [0m[35m[0m
[30;1m1569 | [0m[35m        all_subnets_with_public_ips = {[0m
[30;1m1570 | [0m[35m            subnet.get("SubnetId")[0m
[30;1m1571 | [0m[35m            for subnet in AWSApi.instance().ec2.describe_subnets([0m
[30;1m1572 | [0m[35m                {subnet_id for queue in multi_nic_queues for subnet_id in queue.networking.subnet_id[0m
[30;1m1573 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m903[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m832 | [0m[35m    """[0m
[30;1m833 | [0m[35m[0m
[30;1m834 | [0m[35m    def _validate(self, compute_subnet_ids, new_storage_count):[0m
[30;1m835 | [0m[35m        if len(compute_subnet_ids) > 1 and new_storage_count.get("fsx") > 0:[0m
[30;1m836 | [0m[35m            self._add_failure([0m
[30;1m837 | [0m[35m                "Managed FSx storage created by ParallelCluster is not supported when specifying mul[0m
[30;1m838 | [0m[35m                "under the SubnetIds configuration of a queue. Please make sure to provide an existi[0m

[31m--[ [0m[34mMatch #[0m[33m904[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m775 | [0m[35m                    FailureLevel.ERROR,[0m
[30;1m776 | [0m[35m                )[0m
[30;1m777 | [0m[35m        for local_mount_dir, instance_types in local_mount_dir_instance_types_dict.items():[0m
[30;1m778 | [0m[35m            shared_storage_names = mount_dir_to_names.get(local_mount_dir)[0m
[30;1m779 | [0m[35m            if shared_storage_names:[0m
[30;1m780 | [0m[35m                self._add_failure([0m
[30;1m781 | [0m[35m                    f"The mount directory `{local_mount_dir}` used for shared storage {shared_storag[0m

[31m--[ [0m[34mMatch #[0m[33m905[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m723 | [0m[35m        elif os not in FSX_SUPPORTED_ARCHITECTURES_OSES.get(architecture):[0m
[30;1m724 | [0m[35m            self._add_failure([0m
[30;1m725 | [0m[35m                FSX_MESSAGES["errors"]["unsupported_os"].format([0m
[30;1m726 | [0m[35m                    architecture=architecture, supported_oses=FSX_SUPPORTED_ARCHITECTURES_OSES.get(a[0m
[30;1m727 | [0m[35m                ),[0m
[30;1m728 | [0m[35m                FailureLevel.ERROR,[0m
[30;1m729 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m906[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m720 | [0m[35m                ),[0m
[30;1m721 | [0m[35m                FailureLevel.ERROR,[0m
[30;1m722 | [0m[35m            )[0m
[30;1m723 | [0m[35m        elif os not in FSX_SUPPORTED_ARCHITECTURES_OSES.get(architecture):[0m
[30;1m724 | [0m[35m            self._add_failure([0m
[30;1m725 | [0m[35m                FSX_MESSAGES["errors"]["unsupported_os"].format([0m
[30;1m726 | [0m[35m                    architecture=architecture, supported_oses=FSX_SUPPORTED_ARCHITECTURES_OSES.get(a[0m

[31m--[ [0m[34mMatch #[0m[33m907[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m686 | [0m[35m            fs_access = False[0m
[30;1m687 | [0m[35m            for network_interface in network_interfaces:[0m
[30;1m688 | [0m[35m                # Get list of security group IDs[0m
[30;1m689 | [0m[35m                sg_ids = [sg.get("GroupId") for sg in network_interface.get("Groups")][0m
[30;1m690 | [0m[35m                check_outbound = True[0m
[30;1m691 | [0m[35m                if storage_type == "OPENZFS":[0m
[30;1m692 | [0m[35m                    check_outbound = False[0m

[31m--[ [0m[34mMatch #[0m[33m908[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m686 | [0m[35m            fs_access = False[0m
[30;1m687 | [0m[35m            for network_interface in network_interfaces:[0m
[30;1m688 | [0m[35m                # Get list of security group IDs[0m
[30;1m689 | [0m[35m                sg_ids = [sg.get("GroupId") for sg in network_interface.get("Groups")][0m
[30;1m690 | [0m[35m                check_outbound = True[0m
[30;1m691 | [0m[35m                if storage_type == "OPENZFS":[0m
[30;1m692 | [0m[35m                    check_outbound = False[0m

[31m--[ [0m[34mMatch #[0m[33m909[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m654 | [0m[35m                for network_interface_id in network_interface_ids:[0m
[30;1m655 | [0m[35m                    network_interface_responses.append(network_interfaces_data[network_interface_id][0m
[30;1m656 | [0m[35m[0m
[30;1m657 | [0m[35m                network_interfaces = [ni for ni in network_interface_responses if ni.get("VpcId") ==[0m
[30;1m658 | [0m[35m[0m
[30;1m659 | [0m[35m                for protocol, ports in FSX_PORTS[file_storage.file_storage_type].items():[0m
[30;1m660 | [0m[35m                    missing_ports = self._get_missing_ports([0m

[31m--[ [0m[34mMatch #[0m[33m910[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m557 | [0m[35m    """[0m
[30;1m558 | [0m[35m    from_port = rule.get("FromPort")[0m
[30;1m559 | [0m[35m    to_port = rule.get("ToPort")[0m
[30;1m560 | [0m[35m    ip_protocol = rule.get("IpProtocol")[0m
[30;1m561 | [0m[35m[0m
[30;1m562 | [0m[35m    # if ip_protocol is -1, all ports are allowed[0m
[30;1m563 | [0m[35m    if ip_protocol == "-1":[0m

[31m--[ [0m[34mMatch #[0m[33m911[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m556 | [0m[35m    :return: True if the rule accepts connection, False otherwise[0m
[30;1m557 | [0m[35m    """[0m
[30;1m558 | [0m[35m    from_port = rule.get("FromPort")[0m
[30;1m559 | [0m[35m    to_port = rule.get("ToPort")[0m
[30;1m560 | [0m[35m    ip_protocol = rule.get("IpProtocol")[0m
[30;1m561 | [0m[35m[0m
[30;1m562 | [0m[35m    # if ip_protocol is -1, all ports are allowed[0m

[31m--[ [0m[34mMatch #[0m[33m912[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m555 | [0m[35m    :param protocol: the IP protocol to be checked.[0m
[30;1m556 | [0m[35m    :return: True if the rule accepts connection, False otherwise[0m
[30;1m557 | [0m[35m    """[0m
[30;1m558 | [0m[35m    from_port = rule.get("FromPort")[0m
[30;1m559 | [0m[35m    to_port = rule.get("ToPort")[0m
[30;1m560 | [0m[35m    ip_protocol = rule.get("IpProtocol")[0m
[30;1m561 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m913[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m539 | [0m[35m        return False  # Ip Ranges have to be checked later. Return False because the rule allowance [0m
[30;1m540 | [0m[35m    elif rule.get("UserIdGroupPairs"):[0m
[30;1m541 | [0m[35m        allowed_security_groups.update([0m
[30;1m542 | [0m[35m            {user_id_group_pair.get("GroupId") for user_id_group_pair in rule.get("UserIdGroupPairs"[0m
[30;1m543 | [0m[35m        )[0m
[30;1m544 | [0m[35m        # Security groups have to be checked later. Return False because the rule allowance is not d[0m
[30;1m545 | [0m[35m        return False[0m

[31m--[ [0m[34mMatch #[0m[33m914[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m539 | [0m[35m        return False  # Ip Ranges have to be checked later. Return False because the rule allowance [0m
[30;1m540 | [0m[35m    elif rule.get("UserIdGroupPairs"):[0m
[30;1m541 | [0m[35m        allowed_security_groups.update([0m
[30;1m542 | [0m[35m            {user_id_group_pair.get("GroupId") for user_id_group_pair in rule.get("UserIdGroupPairs"[0m
[30;1m543 | [0m[35m        )[0m
[30;1m544 | [0m[35m        # Security groups have to be checked later. Return False because the rule allowance is not d[0m
[30;1m545 | [0m[35m        return False[0m

[31m--[ [0m[34mMatch #[0m[33m915[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m537 | [0m[35m    elif rule.get("IpRanges"):[0m
[30;1m538 | [0m[35m        ip_ranges.extend(rule.get("IpRanges"))[0m
[30;1m539 | [0m[35m        return False  # Ip Ranges have to be checked later. Return False because the rule allowance [0m
[30;1m540 | [0m[35m    elif rule.get("UserIdGroupPairs"):[0m
[30;1m541 | [0m[35m        allowed_security_groups.update([0m
[30;1m542 | [0m[35m            {user_id_group_pair.get("GroupId") for user_id_group_pair in rule.get("UserIdGroupPairs"[0m
[30;1m543 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m916[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m535 | [0m[35m    if rule.get("PrefixListIds"):[0m
[30;1m536 | [0m[35m        return True  # Always assume prefix list is properly set for code simplicity[0m
[30;1m537 | [0m[35m    elif rule.get("IpRanges"):[0m
[30;1m538 | [0m[35m        ip_ranges.extend(rule.get("IpRanges"))[0m
[30;1m539 | [0m[35m        return False  # Ip Ranges have to be checked later. Return False because the rule allowance [0m
[30;1m540 | [0m[35m    elif rule.get("UserIdGroupPairs"):[0m
[30;1m541 | [0m[35m        allowed_security_groups.update([0m

[31m--[ [0m[34mMatch #[0m[33m917[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m534 | [0m[35m    """[0m
[30;1m535 | [0m[35m    if rule.get("PrefixListIds"):[0m
[30;1m536 | [0m[35m        return True  # Always assume prefix list is properly set for code simplicity[0m
[30;1m537 | [0m[35m    elif rule.get("IpRanges"):[0m
[30;1m538 | [0m[35m        ip_ranges.extend(rule.get("IpRanges"))[0m
[30;1m539 | [0m[35m        return False  # Ip Ranges have to be checked later. Return False because the rule allowance [0m
[30;1m540 | [0m[35m    elif rule.get("UserIdGroupPairs"):[0m

[31m--[ [0m[34mMatch #[0m[33m918[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m532 | [0m[35m    :return: True if we can determine the current rule allows connection.[0m
[30;1m533 | [0m[35m    False if it does not allow connection or cannot be determined.[0m
[30;1m534 | [0m[35m    """[0m
[30;1m535 | [0m[35m    if rule.get("PrefixListIds"):[0m
[30;1m536 | [0m[35m        return True  # Always assume prefix list is properly set for code simplicity[0m
[30;1m537 | [0m[35m    elif rule.get("IpRanges"):[0m
[30;1m538 | [0m[35m        ip_ranges.extend(rule.get("IpRanges"))[0m

[31m--[ [0m[34mMatch #[0m[33m919[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m492 | [0m[35m                in_access = _populate_allowed_src_or_dst(rule, src_ip_ranges, src_security_groups)[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35m        # Check all outbound rules[0m
[30;1m495 | [0m[35m        for rule in sec_group.get("IpPermissionsEgress"):[0m
[30;1m496 | [0m[35m            if out_access:[0m
[30;1m497 | [0m[35m                break[0m
[30;1m498 | [0m[35m            if _is_port_allowed_by_sg_rule(rule, port, protocol):[0m

[31m--[ [0m[34mMatch #[0m[33m920[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m485 | [0m[35m[0m
[30;1m486 | [0m[35m    for sec_group in AWSApi.instance().ec2.describe_security_groups(security_groups_ids):[0m
[30;1m487 | [0m[35m        # Check all inbound rules[0m
[30;1m488 | [0m[35m        for rule in sec_group.get("IpPermissions"):[0m
[30;1m489 | [0m[35m            if in_access:[0m
[30;1m490 | [0m[35m                break[0m
[30;1m491 | [0m[35m            if _is_port_allowed_by_sg_rule(rule, port, protocol):[0m

[31m--[ [0m[34mMatch #[0m[33m921[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m435 | [0m[35m        for rule in security_group_permission:[0m
[30;1m436 | [0m[35m            if rule.get("IpProtocol") == "-1" and rule.get("UserIdGroupPairs"):[0m
[30;1m437 | [0m[35m                for group in rule.get("UserIdGroupPairs"):[0m
[30;1m438 | [0m[35m                    if group.get("GroupId") == security_group_id:[0m
[30;1m439 | [0m[35m                        return True[0m
[30;1m440 | [0m[35m        return False[0m
[30;1m441 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m922[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m434 | [0m[35m    def _all_traffic_allowed(self, security_group_id, security_group_permission):[0m
[30;1m435 | [0m[35m        for rule in security_group_permission:[0m
[30;1m436 | [0m[35m            if rule.get("IpProtocol") == "-1" and rule.get("UserIdGroupPairs"):[0m
[30;1m437 | [0m[35m                for group in rule.get("UserIdGroupPairs"):[0m
[30;1m438 | [0m[35m                    if group.get("GroupId") == security_group_id:[0m
[30;1m439 | [0m[35m                        return True[0m
[30;1m440 | [0m[35m        return False[0m

[31m--[ [0m[34mMatch #[0m[33m923[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m433 | [0m[35m[0m
[30;1m434 | [0m[35m    def _all_traffic_allowed(self, security_group_id, security_group_permission):[0m
[30;1m435 | [0m[35m        for rule in security_group_permission:[0m
[30;1m436 | [0m[35m            if rule.get("IpProtocol") == "-1" and rule.get("UserIdGroupPairs"):[0m
[30;1m437 | [0m[35m                for group in rule.get("UserIdGroupPairs"):[0m
[30;1m438 | [0m[35m                    if group.get("GroupId") == security_group_id:[0m
[30;1m439 | [0m[35m                        return True[0m

[31m--[ [0m[34mMatch #[0m[33m924[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m433 | [0m[35m[0m
[30;1m434 | [0m[35m    def _all_traffic_allowed(self, security_group_id, security_group_permission):[0m
[30;1m435 | [0m[35m        for rule in security_group_permission:[0m
[30;1m436 | [0m[35m            if rule.get("IpProtocol") == "-1" and rule.get("UserIdGroupPairs"):[0m
[30;1m437 | [0m[35m                for group in rule.get("UserIdGroupPairs"):[0m
[30;1m438 | [0m[35m                    if group.get("GroupId") == security_group_id:[0m
[30;1m439 | [0m[35m                        return True[0m

[31m--[ [0m[34mMatch #[0m[33m925[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m423 | [0m[35m                # check inbound rules[0m
[30;1m424 | [0m[35m                allowed_in = self._all_traffic_allowed(security_group, sec_group.get("IpPermissions"[0m
[30;1m425 | [0m[35m                # check outbound rules[0m
[30;1m426 | [0m[35m                allowed_out = self._all_traffic_allowed(security_group, sec_group.get("IpPermissions[0m
[30;1m427 | [0m[35m                if allowed_in and allowed_out:[0m
[30;1m428 | [0m[35m                    efa_sg_found = True[0m
[30;1m429 | [0m[35m                    break[0m

[31m--[ [0m[34mMatch #[0m[33m926[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m421 | [0m[35m            try:[0m
[30;1m422 | [0m[35m                sec_group = AWSApi.instance().ec2.describe_security_group(security_group)[0m
[30;1m423 | [0m[35m                # check inbound rules[0m
[30;1m424 | [0m[35m                allowed_in = self._all_traffic_allowed(security_group, sec_group.get("IpPermissions"[0m
[30;1m425 | [0m[35m                # check outbound rules[0m
[30;1m426 | [0m[35m                allowed_out = self._all_traffic_allowed(security_group, sec_group.get("IpPermissions[0m
[30;1m427 | [0m[35m                if allowed_in and allowed_out:[0m

[31m--[ [0m[34mMatch #[0m[33m927[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m237 | [0m[35m    """OS and architecture combination validator if EFA is enabled."""[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m    def _validate(self, efa_enabled: bool, os: str, architecture: str):[0m
[30;1m240 | [0m[35m        if efa_enabled and os in EFA_UNSUPPORTED_ARCHITECTURES_OSES.get(architecture):[0m
[30;1m241 | [0m[35m            self._add_failure([0m
[30;1m242 | [0m[35m                f"EFA is currently not supported on {os} for {architecture} architecture.", FailureL[0m
[30;1m243 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m928[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m.hostname[0m
[30;1m80 | [0m[35m}[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35mHOST_NAME_MAX_LENGTH = 64[0m
[30;1m83 | [0m[35m# Max fqdn size is 255 characters, the first 64 are used for the hostname (e.g. queuename-st|dy-comp[0m
[30;1m84 | [0m[35m# then we need to add an extra ., so we have 190 characters to be used for the clustername + domain-[0m
[30;1m85 | [0m[35mCLUSTER_NAME_AND_CUSTOM_DOMAIN_NAME_MAX_LENGTH = 255 - HOST_NAME_MAX_LENGTH - 1[0m
[30;1m86 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m929[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1550 | [0m[35m                self._add_failure([0m
[30;1m1551 | [0m[35m                    f"The Encryption parameter of the root volume of the queue {queue_name} is not c[0m
[30;1m1552 | [0m[35m                    f"with the value set for the queue {reference_queue_name}, and may cause a probl[0m
[30;1m1553 | [0m[35m                    f"of Service Control Policies (SCPs) enforcing encryption.",[0m
[30;1m1554 | [0m[35m                    FailureLevel.WARNING,[0m
[30;1m1555 | [0m[35m                )[0m
[30;1m1556 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m930[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1448 | [0m[35m[0m
[30;1m1449 | [0m[35m[0m
[30;1m1450 | [0m[35mclass HostedZoneValidator(Validator):[0m
[30;1m1451 | [0m[35m    """Validate custom private domain in the same VPC as head node."""[0m
[30;1m1452 | [0m[35m[0m
[30;1m1453 | [0m[35m    def _validate(self, hosted_zone_id, cluster_vpc, cluster_name):[0m
[30;1m1454 | [0m[35m        if AWSApi.instance().route53.is_hosted_zone_private(hosted_zone_id):[0m

[31m--[ [0m[34mMatch #[0m[33m931[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1340 | [0m[35m        if total_max_compute_nodes > 100:[0m
[30;1m1341 | [0m[35m            self._add_failure([0m
[30;1m1342 | [0m[35m                "EBS shared storage is mounted on the head node and shared to the compute nodes. "[0m
[30;1m1343 | [0m[35m                "Therefore, the head node network bandwidth is a network performance bottle neck "[0m
[30;1m1344 | [0m[35m                "if the compute nodes rely on this shared storage. "[0m
[30;1m1345 | [0m[35m                "Please use FSx and EFS for better performance.",[0m
[30;1m1346 | [0m[35m                FailureLevel.WARNING,[0m

[31m--[ [0m[34mMatch #[0m[33m932[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1339 | [0m[35m    def _validate(self, total_max_compute_nodes: int):[0m
[30;1m1340 | [0m[35m        if total_max_compute_nodes > 100:[0m
[30;1m1341 | [0m[35m            self._add_failure([0m
[30;1m1342 | [0m[35m                "EBS shared storage is mounted on the head node and shared to the compute nodes. "[0m
[30;1m1343 | [0m[35m                "Therefore, the head node network bandwidth is a network performance bottle neck "[0m
[30;1m1344 | [0m[35m                "if the compute nodes rely on this shared storage. "[0m
[30;1m1345 | [0m[35m                "Please use FSx and EFS for better performance.",[0m

[31m--[ [0m[34mMatch #[0m[33m933[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1327 | [0m[35m        if head_node_memory < required_memory:[0m
[30;1m1328 | [0m[35m            self._add_failure([0m
[30;1m1329 | [0m[35m                f"Head node instance type {head_node_instance_type} has {head_node_memory} GB of mem[0m
[30;1m1330 | [0m[35m                f"Please choose a head node instance type with at least {required_memory} GB of memo[0m
[30;1m1331 | [0m[35m                f" to manage {total_max_compute_nodes} compute nodes.",[0m
[30;1m1332 | [0m[35m                FailureLevel.ERROR,[0m
[30;1m1333 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m934[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1326 | [0m[35m        required_memory = min(total_max_compute_nodes / 25 + 0.6, 16)[0m
[30;1m1327 | [0m[35m        if head_node_memory < required_memory:[0m
[30;1m1328 | [0m[35m            self._add_failure([0m
[30;1m1329 | [0m[35m                f"Head node instance type {head_node_instance_type} has {head_node_memory} GB of mem[0m
[30;1m1330 | [0m[35m                f"Please choose a head node instance type with at least {required_memory} GB of memo[0m
[30;1m1331 | [0m[35m                f" to manage {total_max_compute_nodes} compute nodes.",[0m
[30;1m1332 | [0m[35m                FailureLevel.ERROR,[0m

[31m--[ [0m[34mMatch #[0m[33m935[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1315 | [0m[35m    """[0m
[30;1m1316 | [0m[35m    Head Node Memory Size Validator.[0m
[30;1m1317 | [0m[35m[0m
[30;1m1318 | [0m[35m    Verify if the Head Node has enough memory to manage compute nodes.[0m
[30;1m1319 | [0m[35m    """[0m
[30;1m1320 | [0m[35m[0m
[30;1m1321 | [0m[35m    def _validate(self, head_node_instance_type: str, total_max_compute_nodes: int):[0m

[31m--[ [0m[34mMatch #[0m[33m936[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1313 | [0m[35m[0m
[30;1m1314 | [0m[35mclass HeadNodeMemorySizeValidator(Validator):[0m
[30;1m1315 | [0m[35m    """[0m
[30;1m1316 | [0m[35m    Head Node Memory Size Validator.[0m
[30;1m1317 | [0m[35m[0m
[30;1m1318 | [0m[35m    Verify if the Head Node has enough memory to manage compute nodes.[0m
[30;1m1319 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m937[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1295 | [0m[35m    """[0m
[30;1m1296 | [0m[35m    Head Node IMDS configuration validator.[0m
[30;1m1297 | [0m[35m[0m
[30;1m1298 | [0m[35m    Verify if the Head Node IMDs configuration is compatible with other configurations.[0m
[30;1m1299 | [0m[35m    """[0m
[30;1m1300 | [0m[35m[0m
[30;1m1301 | [0m[35m    def _validate(self, imds_secured: bool, scheduler: str):[0m

[31m--[ [0m[34mMatch #[0m[33m938[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1293 | [0m[35m[0m
[30;1m1294 | [0m[35mclass HeadNodeImdsValidator(Validator):[0m
[30;1m1295 | [0m[35m    """[0m
[30;1m1296 | [0m[35m    Head Node IMDS configuration validator.[0m
[30;1m1297 | [0m[35m[0m
[30;1m1298 | [0m[35m    Verify if the Head Node IMDs configuration is compatible with other configurations.[0m
[30;1m1299 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m939[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1287 | [0m[35m            )[0m
[30;1m1288 | [0m[35m        except Exception as e:[0m
[30;1m1289 | [0m[35m            self._add_failure([0m
[30;1m1290 | [0m[35m                f"Unable to validate configuration parameters for the head node. {str(e)}", FailureL[0m
[30;1m1291 | [0m[35m            )[0m
[30;1m1292 | [0m[35m[0m
[30;1m1293 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m940[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1265 | [0m[35m                subnet=head_node.networking.subnet_id,[0m
[30;1m1266 | [0m[35m            )[0m
[30;1m1267 | [0m[35m[0m
[30;1m1268 | [0m[35m            # Test Head Node Instance Configuration[0m
[30;1m1269 | [0m[35m            self._ec2_run_instance([0m
[30;1m1270 | [0m[35m                availability_zone=head_node.networking.availability_zone,[0m
[30;1m1271 | [0m[35m                InstanceType=head_node.instance_type,[0m

[31m--[ [0m[34mMatch #[0m[33m941[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1260 | [0m[35m[0m
[30;1m1261 | [0m[35m            head_node_network_interfaces = self._build_launch_network_interfaces([0m
[30;1m1262 | [0m[35m                network_cards_list=head_node.network_cards_list,[0m
[30;1m1263 | [0m[35m                use_efa=False,  # EFA is not supported on head node[0m
[30;1m1264 | [0m[35m                security_group_ids=head_node_security_groups,[0m
[30;1m1265 | [0m[35m                subnet=head_node.networking.subnet_id,[0m
[30;1m1266 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m942[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1201 | [0m[35m                )[0m
[30;1m1202 | [0m[35m            elif code == "InsufficientFreeAddressesInSubnet":[0m
[30;1m1203 | [0m[35m                self._add_failure([0m
[30;1m1204 | [0m[35m                    "The specified subnet does not contain enough free private IP addresses "[0m
[30;1m1205 | [0m[35m                    f"to fulfill your request. {message}",[0m
[30;1m1206 | [0m[35m                    FailureLevel.ERROR,[0m
[30;1m1207 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m943[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1155 | [0m[35m[0m
[30;1m1156 | [0m[35m[0m
[30;1m1157 | [0m[35mclass _LaunchTemplateValidator(Validator):[0m
[30;1m1158 | [0m[35m    """Abstract class to contain utility functions used by head node and queue LaunchTemplate valida[0m
[30;1m1159 | [0m[35m[0m
[30;1m1160 | [0m[35m    def __init__(self):[0m
[30;1m1161 | [0m[35m        super().__init__()[0m

[31m--[ [0m[34mMatch #[0m[33m944[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1079 | [0m[35m        allowed_architectures = ["x86_64"][0m
[30;1m1080 | [0m[35m        if architecture not in allowed_architectures:[0m
[30;1m1081 | [0m[35m            self._add_failure([0m
[30;1m1082 | [0m[35m                "When enabling Intel software, it is required to use head node and compute instance [0m
[30;1m1083 | [0m[35m                f"types and an AMI that support these architectures: {allowed_architectures}.",[0m
[30;1m1084 | [0m[35m                FailureLevel.ERROR,[0m
[30;1m1085 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m945[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m997 | [0m[35m        if mount_dir in ("/home", "home"):[0m
[30;1m998 | [0m[35m            self._add_failure([0m
[30;1m999 | [0m[35m                ([0m
[30;1m1000 | [0m[35m                    f"Error: FileCache cannot be used to mount the shared storage directory '{mount_[0m
[30;1m1001 | [0m[35m                    f"select a supported filesystem."[0m
[30;1m1002 | [0m[35m                ),[0m
[30;1m1003 | [0m[35m                FailureLevel.ERROR,[0m

[31m--[ [0m[34mMatch #[0m[33m946[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m981 | [0m[35m            mount_dir = "/" + mount_dir[0m
[30;1m982 | [0m[35m        if mount_dir in reserved_directories:[0m
[30;1m983 | [0m[35m            self._add_failure([0m
[30;1m984 | [0m[35m                f"Error: The shared storage mount directory {mount_dir} is reserved. Please use anot[0m
[30;1m985 | [0m[35m                FailureLevel.ERROR,[0m
[30;1m986 | [0m[35m            )[0m
[30;1m987 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m947[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m945 | [0m[35m    """[0m
[30;1m946 | [0m[35m    Shared storage mount directory validator.[0m
[30;1m947 | [0m[35m[0m
[30;1m948 | [0m[35m    Make sure the mount directory is not the same as any reserved directory.[0m
[30;1m949 | [0m[35m    """[0m
[30;1m950 | [0m[35m[0m
[30;1m951 | [0m[35m    def _validate(self, mount_dir: str):[0m

[31m--[ [0m[34mMatch #[0m[33m948[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m943 | [0m[35m[0m
[30;1m944 | [0m[35mclass SharedStorageMountDirValidator(Validator):[0m
[30;1m945 | [0m[35m    """[0m
[30;1m946 | [0m[35m    Shared storage mount directory validator.[0m
[30;1m947 | [0m[35m[0m
[30;1m948 | [0m[35m    Make sure the mount directory is not the same as any reserved directory.[0m
[30;1m949 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m949[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m905 | [0m[35m        if avail_zones_missing_mount_target_for_efs_standard:[0m
[30;1m906 | [0m[35m            self._add_failure([0m
[30;1m907 | [0m[35m                "There is no existing Mount Target for EFS '{0}' in these Availability Zones: '{1}'.[0m
[30;1m908 | [0m[35m                "Please create an EFS Mount Target for those availability zones.".format([0m
[30;1m909 | [0m[35m                    efs_id, avail_zones_missing_mount_target_for_efs_standard[0m
[30;1m910 | [0m[35m                ),[0m
[30;1m911 | [0m[35m                FailureLevel.ERROR,[0m

[31m--[ [0m[34mMatch #[0m[33m950[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m904 | [0m[35m                    avail_zones_missing_mount_target_for_efs_standard.append(avail_zone)[0m
[30;1m905 | [0m[35m        if avail_zones_missing_mount_target_for_efs_standard:[0m
[30;1m906 | [0m[35m            self._add_failure([0m
[30;1m907 | [0m[35m                "There is no existing Mount Target for EFS '{0}' in these Availability Zones: '{1}'.[0m
[30;1m908 | [0m[35m                "Please create an EFS Mount Target for those availability zones.".format([0m
[30;1m909 | [0m[35m                    efs_id, avail_zones_missing_mount_target_for_efs_standard[0m
[30;1m910 | [0m[35m                ),[0m

[31m--[ [0m[34mMatch #[0m[33m951[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m894 | [0m[35m                    self._add_failure([0m
[30;1m895 | [0m[35m                        "There is an existing Mount Target {0} in the Availability Zone {1} for EFS [0m
[30;1m896 | [0m[35m                        "but it does not have a security group that allows inbound and outbound rule[0m
[30;1m897 | [0m[35m                        "Please modify the Mount Target's security group, to allow traffic on port 2[0m
[30;1m898 | [0m[35m                            head_node_target_id, avail_zone, efs_id[0m
[30;1m899 | [0m[35m                        ),[0m
[30;1m900 | [0m[35m                        FailureLevel.ERROR,[0m

[31m--[ [0m[34mMatch #[0m[33m952[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m892 | [0m[35m                    sg_ids, subnets, port=EFS_PORT, security_groups_by_nodes=security_groups_by_node[0m
[30;1m893 | [0m[35m                ):[0m
[30;1m894 | [0m[35m                    self._add_failure([0m
[30;1m895 | [0m[35m                        "There is an existing Mount Target {0} in the Availability Zone {1} for EFS [0m
[30;1m896 | [0m[35m                        "but it does not have a security group that allows inbound and outbound rule[0m
[30;1m897 | [0m[35m                        "Please modify the Mount Target's security group, to allow traffic on port 2[0m
[30;1m898 | [0m[35m                            head_node_target_id, avail_zone, efs_id[0m

[31m--[ [0m[34mMatch #[0m[33m953[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m886 | [0m[35m            head_node_target_id = AWSApi.instance().efs.get_efs_mount_target_id(efs_id, avail_zone)[0m
[30;1m887 | [0m[35m            # If there is an existing mt in the az, need to check the inbound and outbound rules of [0m
[30;1m888 | [0m[35m            if head_node_target_id:[0m
[30;1m889 | [0m[35m                # Get list of security group IDs of the mount target[0m
[30;1m890 | [0m[35m                sg_ids = AWSApi.instance().efs.get_efs_mount_target_security_groups(head_node_target[0m
[30;1m891 | [0m[35m                if not _is_access_allowed([0m
[30;1m892 | [0m[35m                    sg_ids, subnets, port=EFS_PORT, security_groups_by_nodes=security_groups_by_node[0m

[31m--[ [0m[34mMatch #[0m[33m954[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m868 | [0m[35m    """[0m
[30;1m869 | [0m[35m    EFS id validator.[0m
[30;1m870 | [0m[35m[0m
[30;1m871 | [0m[35m    Validate if there are existing mount target in the cluster (head and computes) availability zone[0m
[30;1m872 | [0m[35m    """[0m
[30;1m873 | [0m[35m[0m
[30;1m874 | [0m[35m    def _validate(self, efs_id, avail_zones_mapping: dict, security_groups_by_nodes):[0m

[31m--[ [0m[34mMatch #[0m[33m955[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m794 | [0m[35m    1. Shared storage directories can not overlap with each other.[0m
[30;1m795 | [0m[35m    2. Shared storage directories can not overlap with ephemeral storage directories.[0m
[30;1m796 | [0m[35m    3. Ephemeral storage directories can overlap with each other, because they are local to compute [0m
[30;1m797 | [0m[35m    Two mount dirs are overlapped if one is contained into the other.[0m
[30;1m798 | [0m[35m    """[0m
[30;1m799 | [0m[35m[0m
[30;1m800 | [0m[35m    def _validate(self, shared_mount_dir_list, local_mount_dir_list):[0m

[31m--[ [0m[34mMatch #[0m[33m956[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m790 | [0m[35m    """[0m
[30;1m791 | [0m[35m    Mount dir validator.[0m
[30;1m792 | [0m[35m[0m
[30;1m793 | [0m[35m    Verify if there are overlap mount dirs.[0m
[30;1m794 | [0m[35m    1. Shared storage directories can not overlap with each other.[0m
[30;1m795 | [0m[35m    2. Shared storage directories can not overlap with ephemeral storage directories.[0m
[30;1m796 | [0m[35m    3. Ephemeral storage directories can overlap with each other, because they are local to compute [0m

[31m--[ [0m[34mMatch #[0m[33m957[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m788 | [0m[35m[0m
[30;1m789 | [0m[35mclass OverlappingMountDirValidator(Validator):[0m
[30;1m790 | [0m[35m    """[0m
[30;1m791 | [0m[35m    Mount dir validator.[0m
[30;1m792 | [0m[35m[0m
[30;1m793 | [0m[35m    Verify if there are overlap mount dirs.[0m
[30;1m794 | [0m[35m    1. Shared storage directories can not overlap with each other.[0m

[31m--[ [0m[34mMatch #[0m[33m958[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m780 | [0m[35m                self._add_failure([0m
[30;1m781 | [0m[35m                    f"The mount directory `{local_mount_dir}` used for shared storage {shared_storag[0m
[30;1m782 | [0m[35m                    f"clashes with the one used for ephemeral volumes of the instances {list(instanc[0m
[30;1m783 | [0m[35m                    f"Please change the mount directory configuration of either the shared storage o[0m
[30;1m784 | [0m[35m                    f"volume of the impacted nodes.",[0m
[30;1m785 | [0m[35m                    FailureLevel.WARNING,[0m
[30;1m786 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m959[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m778 | [0m[35m            shared_storage_names = mount_dir_to_names.get(local_mount_dir)[0m
[30;1m779 | [0m[35m            if shared_storage_names:[0m
[30;1m780 | [0m[35m                self._add_failure([0m
[30;1m781 | [0m[35m                    f"The mount directory `{local_mount_dir}` used for shared storage {shared_storag[0m
[30;1m782 | [0m[35m                    f"clashes with the one used for ephemeral volumes of the instances {list(instanc[0m
[30;1m783 | [0m[35m                    f"Please change the mount directory configuration of either the shared storage o[0m
[30;1m784 | [0m[35m                    f"volume of the impacted nodes.",[0m

[31m--[ [0m[34mMatch #[0m[33m960[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m771 | [0m[35m                self._add_failure([0m
[30;1m772 | [0m[35m                    f"The mount directory `{mount_dir}` is used for multiple shared storage: {names}[0m
[30;1m773 | [0m[35m                    "Shared storage mount directories should be unique. "[0m
[30;1m774 | [0m[35m                    "Please change the mount directory configuration of the shared storage.",[0m
[30;1m775 | [0m[35m                    FailureLevel.ERROR,[0m
[30;1m776 | [0m[35m                )[0m
[30;1m777 | [0m[35m        for local_mount_dir, instance_types in local_mount_dir_instance_types_dict.items():[0m

[31m--[ [0m[34mMatch #[0m[33m961[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m770 | [0m[35m            if len(names) > 1:[0m
[30;1m771 | [0m[35m                self._add_failure([0m
[30;1m772 | [0m[35m                    f"The mount directory `{mount_dir}` is used for multiple shared storage: {names}[0m
[30;1m773 | [0m[35m                    "Shared storage mount directories should be unique. "[0m
[30;1m774 | [0m[35m                    "Please change the mount directory configuration of the shared storage.",[0m
[30;1m775 | [0m[35m                    FailureLevel.ERROR,[0m
[30;1m776 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m962[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m769 | [0m[35m        for mount_dir, names in mount_dir_to_names.items():[0m
[30;1m770 | [0m[35m            if len(names) > 1:[0m
[30;1m771 | [0m[35m                self._add_failure([0m
[30;1m772 | [0m[35m                    f"The mount directory `{mount_dir}` is used for multiple shared storage: {names}[0m
[30;1m773 | [0m[35m                    "Shared storage mount directories should be unique. "[0m
[30;1m774 | [0m[35m                    "Please change the mount directory configuration of the shared storage.",[0m
[30;1m775 | [0m[35m                    FailureLevel.ERROR,[0m

[31m--[ [0m[34mMatch #[0m[33m963[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m759 | [0m[35m    """[0m
[30;1m760 | [0m[35m    Mount dir validator.[0m
[30;1m761 | [0m[35m[0m
[30;1m762 | [0m[35m    Verify if there are duplicated mount dirs between shared storage and ephemeral volumes.[0m
[30;1m763 | [0m[35m    """[0m
[30;1m764 | [0m[35m[0m
[30;1m765 | [0m[35m    def _validate(self, shared_storage_name_mount_dir_tuple_list, local_mount_dir_instance_types_dic[0m

[31m--[ [0m[34mMatch #[0m[33m964[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m757 | [0m[35m[0m
[30;1m758 | [0m[35mclass DuplicateMountDirValidator(Validator):[0m
[30;1m759 | [0m[35m    """[0m
[30;1m760 | [0m[35m    Mount dir validator.[0m
[30;1m761 | [0m[35m[0m
[30;1m762 | [0m[35m    Verify if there are duplicated mount dirs between shared storage and ephemeral volumes.[0m
[30;1m763 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m965[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m598 | [0m[35m    """[0m
[30;1m599 | [0m[35m    FSx networking validator.[0m
[30;1m600 | [0m[35m[0m
[30;1m601 | [0m[35m    Validate file system mount point according to the head node subnet.[0m
[30;1m602 | [0m[35m    The reason to have this structure is to make boto3 calls as few as possible.[0m
[30;1m603 | [0m[35m    """[0m
[30;1m604 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m966[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m598 | [0m[35m    """[0m
[30;1m599 | [0m[35m    FSx networking validator.[0m
[30;1m600 | [0m[35m[0m
[30;1m601 | [0m[35m    Validate file system mount point according to the head node subnet.[0m
[30;1m602 | [0m[35m    The reason to have this structure is to make boto3 calls as few as possible.[0m
[30;1m603 | [0m[35m    """[0m
[30;1m604 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m967[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m579 | [0m[35m[0m
[30;1m580 | [0m[35mdef _are_subnets_covered_by_cidrs(ip_ranges, subnets):[0m
[30;1m581 | [0m[35m    """Verify given list of security groups to check if they allow in and out access on cluster subn[0m
[30;1m582 | [0m[35m    # Collapse ip ranges for better performance and correctness[0m
[30;1m583 | [0m[35m    collapsed_ip_ranges = list(collapse_addresses([ip_network(ip_range["CidrIp"]) for ip_range in ip[0m
[30;1m584 | [0m[35m[0m
[30;1m585 | [0m[35m    for subnet in subnets:[0m

[31m--[ [0m[34mMatch #[0m[33m968[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m552 | [0m[35m[0m
[30;1m553 | [0m[35m    :param rule: The rule to check[0m
[30;1m554 | [0m[35m    :param port_to_check: The port to check[0m
[30;1m555 | [0m[35m    :param protocol: the IP protocol to be checked.[0m
[30;1m556 | [0m[35m    :return: True if the rule accepts connection, False otherwise[0m
[30;1m557 | [0m[35m    """[0m
[30;1m558 | [0m[35m    from_port = rule.get("FromPort")[0m

[31m--[ [0m[34mMatch #[0m[33m969[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m536 | [0m[35m        return True  # Always assume prefix list is properly set for code simplicity[0m
[30;1m537 | [0m[35m    elif rule.get("IpRanges"):[0m
[30;1m538 | [0m[35m        ip_ranges.extend(rule.get("IpRanges"))[0m
[30;1m539 | [0m[35m        return False  # Ip Ranges have to be checked later. Return False because the rule allowance [0m
[30;1m540 | [0m[35m    elif rule.get("UserIdGroupPairs"):[0m
[30;1m541 | [0m[35m        allowed_security_groups.update([0m
[30;1m542 | [0m[35m            {user_id_group_pair.get("GroupId") for user_id_group_pair in rule.get("UserIdGroupPairs"[0m

[31m--[ [0m[34mMatch #[0m[33m970[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m527 | [0m[35m    Collect Ip ranges or security groups allowed by the rule.[0m
[30;1m528 | [0m[35m[0m
[30;1m529 | [0m[35m    :param rule: A rule of a security group[0m
[30;1m530 | [0m[35m    :param ip_ranges: A list of ip ranges.[0m
[30;1m531 | [0m[35m    :param allowed_security_groups: A list of allowed security group.[0m
[30;1m532 | [0m[35m    :return: True if we can determine the current rule allows connection.[0m
[30;1m533 | [0m[35m    False if it does not allow connection or cannot be determined.[0m

[31m--[ [0m[34mMatch #[0m[33m971[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m524 | [0m[35m[0m
[30;1m525 | [0m[35mdef _populate_allowed_src_or_dst(rule, ip_ranges, allowed_security_groups):[0m
[30;1m526 | [0m[35m    """[0m
[30;1m527 | [0m[35m    Collect Ip ranges or security groups allowed by the rule.[0m
[30;1m528 | [0m[35m[0m
[30;1m529 | [0m[35m    :param rule: A rule of a security group[0m
[30;1m530 | [0m[35m    :param ip_ranges: A list of ip ranges.[0m

[31m--[ [0m[34mMatch #[0m[33m972[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m503 | [0m[35m    # If in_access or out_access is still False, check allowed ip ranges and security groups.[0m
[30;1m504 | [0m[35m    # The in_access or out_access could only have been true, if previous logics had found prefix lis[0m
[30;1m505 | [0m[35m    # Rules of ip ranges have to be checked at the end because the union of all ip ranges may cover [0m
[30;1m506 | [0m[35m    # even when individual ip ranges do not cover the subnets. The same reason applies to allowed se[0m
[30;1m507 | [0m[35m    in_access = in_access or _are_ip_ranges_and_sg_accessible([0m
[30;1m508 | [0m[35m        security_groups_by_nodes, src_ip_ranges, src_security_groups, subnets[0m
[30;1m509 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m973[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m502 | [0m[35m            return True[0m
[30;1m503 | [0m[35m    # If in_access or out_access is still False, check allowed ip ranges and security groups.[0m
[30;1m504 | [0m[35m    # The in_access or out_access could only have been true, if previous logics had found prefix lis[0m
[30;1m505 | [0m[35m    # Rules of ip ranges have to be checked at the end because the union of all ip ranges may cover [0m
[30;1m506 | [0m[35m    # even when individual ip ranges do not cover the subnets. The same reason applies to allowed se[0m
[30;1m507 | [0m[35m    in_access = in_access or _are_ip_ranges_and_sg_accessible([0m
[30;1m508 | [0m[35m        security_groups_by_nodes, src_ip_ranges, src_security_groups, subnets[0m

[31m--[ [0m[34mMatch #[0m[33m974[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m502 | [0m[35m            return True[0m
[30;1m503 | [0m[35m    # If in_access or out_access is still False, check allowed ip ranges and security groups.[0m
[30;1m504 | [0m[35m    # The in_access or out_access could only have been true, if previous logics had found prefix lis[0m
[30;1m505 | [0m[35m    # Rules of ip ranges have to be checked at the end because the union of all ip ranges may cover [0m
[30;1m506 | [0m[35m    # even when individual ip ranges do not cover the subnets. The same reason applies to allowed se[0m
[30;1m507 | [0m[35m    in_access = in_access or _are_ip_ranges_and_sg_accessible([0m
[30;1m508 | [0m[35m        security_groups_by_nodes, src_ip_ranges, src_security_groups, subnets[0m

[31m--[ [0m[34mMatch #[0m[33m975[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m500 | [0m[35m[0m
[30;1m501 | [0m[35m        if in_access and out_access:[0m
[30;1m502 | [0m[35m            return True[0m
[30;1m503 | [0m[35m    # If in_access or out_access is still False, check allowed ip ranges and security groups.[0m
[30;1m504 | [0m[35m    # The in_access or out_access could only have been true, if previous logics had found prefix lis[0m
[30;1m505 | [0m[35m    # Rules of ip ranges have to be checked at the end because the union of all ip ranges may cover [0m
[30;1m506 | [0m[35m    # even when individual ip ranges do not cover the subnets. The same reason applies to allowed se[0m

[31m--[ [0m[34mMatch #[0m[33m976[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m472 | [0m[35m    :param port: port to verify[0m
[30;1m473 | [0m[35m    :param security_groups_by_nodes: all security groups from cluster. This is a set of frozen sets.[0m
[30;1m474 | [0m[35m    Each frozen set contains sg combination of a queue.[0m
[30;1m475 | [0m[35m    :param protocol: the IP protocol to be checked.[0m
[30;1m476 | [0m[35m    :return: True if both in and out access are allowed[0m
[30;1m477 | [0m[35m    :raise: ClientError if a given security group doesn't exist[0m
[30;1m478 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m977[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m391 | [0m[35m        elif efa_enabled and placement_group_key is None and not multi_az_enabled:[0m
[30;1m392 | [0m[35m            self._add_failure([0m
[30;1m393 | [0m[35m                "The placement group for EFA-enabled compute resources must be explicit. "[0m
[30;1m394 | [0m[35m                "You may see better performance using a placement group, but if you don't wish to us[0m
[30;1m395 | [0m[35m                "'Enabled: false' to the compute resource's configuration section.",[0m
[30;1m396 | [0m[35m                FailureLevel.ERROR,[0m
[30;1m397 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m978[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m303 | [0m[35m            if head_node_architecture not in instance_type_info.supported_architecture():[0m
[30;1m304 | [0m[35m                self._add_failure([0m
[30;1m305 | [0m[35m                    "The specified compute instance type ({0}) supports the architectures {1}, none [0m
[30;1m306 | [0m[35m                    "compatible with the architecture supported by the head node instance type ({2})[0m
[30;1m307 | [0m[35m                        instance_type_info.instance_type(), compute_architectures, head_node_archite[0m
[30;1m308 | [0m[35m                    ),[0m
[30;1m309 | [0m[35m                    FailureLevel.ERROR,[0m

[31m--[ [0m[34mMatch #[0m[33m979[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m292 | [0m[35m    """[0m
[30;1m293 | [0m[35m    Validate instance type and architecture combination.[0m
[30;1m294 | [0m[35m[0m
[30;1m295 | [0m[35m    Verify that head node and compute instance types imply compatible architectures.[0m
[30;1m296 | [0m[35m    """[0m
[30;1m297 | [0m[35m[0m
[30;1m298 | [0m[35m    def _validate(self, instance_type_info_list: List[InstanceTypeInfo], architecture: str):[0m

[31m--[ [0m[34mMatch #[0m[33m980[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35me of the following operating"[0m
[30;1m72 | [0m[35m        " systems: {supported_oses}. Please double check the os configuration.",[0m
[30;1m73 | [0m[35m        "unsupported_architecture": "FSx Lustre can be used only with instance types and AMIs that s[0m
[30;1m74 | [0m[35m        "architectures: {supported_architectures}. Please double check the head node instance type, [0m
[30;1m75 | [0m[35m        "compute instance type and/or custom AMI configurations.",[0m
[30;1m76 | [0m[35m        "unsupported_backup_param": "When restoring an FSx Lustre file system from backup, '{name}' [0m
[30;1m77 | [0m[35m        "cannot be specified.",[0m

[31m--[ [0m[34mMatch #[0m[33m981[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1550 | [0m[35m                self._add_failure([0m
[30;1m1551 | [0m[35m                    f"The Encryption parameter of the root volume of the queue {queue_name} is not c[0m
[30;1m1552 | [0m[35m                    f"with the value set for the queue {reference_queue_name}, and may cause a probl[0m
[30;1m1553 | [0m[35m                    f"of Service Control Policies (SCPs) enforcing encryption.",[0m
[30;1m1554 | [0m[35m                    FailureLevel.WARNING,[0m
[30;1m1555 | [0m[35m                )[0m
[30;1m1556 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m982[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1327 | [0m[35m        if head_node_memory < required_memory:[0m
[30;1m1328 | [0m[35m            self._add_failure([0m
[30;1m1329 | [0m[35m                f"Head node instance type {head_node_instance_type} has {head_node_memory} GB of mem[0m
[30;1m1330 | [0m[35m                f"Please choose a head node instance type with at least {required_memory} GB of memo[0m
[30;1m1331 | [0m[35m                f" to manage {total_max_compute_nodes} compute nodes.",[0m
[30;1m1332 | [0m[35m                FailureLevel.ERROR,[0m
[30;1m1333 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m983[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1047 | [0m[35m                self._add_failure([0m
[30;1m1048 | [0m[35m                    "The packages required for desktop virtualization in the selected instance type [0m
[30;1m1049 | [0m[35m                    "may cause instability of the instance. If you want to use Amazon DCV it is reco[0m
[30;1m1050 | [0m[35m                    "to use an instance type with at least 1.7 GB of memory.".format(instance_type),[0m
[30;1m1051 | [0m[35m                    FailureLevel.WARNING,[0m
[30;1m1052 | [0m[35m                )[0m
[30;1m1053 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m984[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1017 | [0m[35m        elif deletion_policy == RETAIN_POLICY:[0m
[30;1m1018 | [0m[35m            self._add_failure([0m
[30;1m1019 | [0m[35m                f"The DeletionPolicy is set to {RETAIN_POLICY}. The storage '{name}' will be retaine[0m
[30;1m1020 | [0m[35m                "it from the configuration when performing a cluster update or deleting the cluster.[0m
[30;1m1021 | [0m[35m                FailureLevel.INFO,[0m
[30;1m1022 | [0m[35m            )[0m
[30;1m1023 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m985[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1011 | [0m[35m        if deletion_policy == DELETE_POLICY:[0m
[30;1m1012 | [0m[35m            self._add_failure([0m
[30;1m1013 | [0m[35m                f"The DeletionPolicy is set to {DELETE_POLICY}. The storage '{name}' will be deleted[0m
[30;1m1014 | [0m[35m                "it from the configuration when performing a cluster update or deleting the cluster.[0m
[30;1m1015 | [0m[35m                FailureLevel.INFO,[0m
[30;1m1016 | [0m[35m            )[0m
[30;1m1017 | [0m[35m        elif deletion_policy == RETAIN_POLICY:[0m

[31m--[ [0m[34mMatch #[0m[33m986[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m933 | [0m[35m            )[0m
[30;1m934 | [0m[35m        if len(name) > SHARED_STORAGE_NAME_MAX_LENGTH:[0m
[30;1m935 | [0m[35m            self._add_failure([0m
[30;1m936 | [0m[35m                f"Invalid name '{name}'. Name can be at most {SHARED_STORAGE_NAME_MAX_LENGTH} chars [0m
[30;1m937 | [0m[35m                FailureLevel.ERROR,[0m
[30;1m938 | [0m[35m            )[0m
[30;1m939 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m987[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m516 | [0m[35m[0m
[30;1m517 | [0m[35m[0m
[30;1m518 | [0m[35mdef _are_ip_ranges_and_sg_accessible(security_groups_by_nodes, allowed_ip_ranges, allowed_security_g[0m
[30;1m519 | [0m[35m    # For all cluster nodes, at least one of the security groups attached need to be in the UserIdGr[0m
[30;1m520 | [0m[35m    return all([0m
[30;1m521 | [0m[35m        node_security_groups & allowed_security_groups for node_security_groups in security_groups_b[0m
[30;1m522 | [0m[35m    ) or _are_subnets_covered_by_cidrs(allowed_ip_ranges, subnets)[0m

[31m--[ [0m[34mMatch #[0m[33m988[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m502 | [0m[35m            return True[0m
[30;1m503 | [0m[35m    # If in_access or out_access is still False, check allowed ip ranges and security groups.[0m
[30;1m504 | [0m[35m    # The in_access or out_access could only have been true, if previous logics had found prefix lis[0m
[30;1m505 | [0m[35m    # Rules of ip ranges have to be checked at the end because the union of all ip ranges may cover [0m
[30;1m506 | [0m[35m    # even when individual ip ranges do not cover the subnets. The same reason applies to allowed se[0m
[30;1m507 | [0m[35m    in_access = in_access or _are_ip_ranges_and_sg_accessible([0m
[30;1m508 | [0m[35m        security_groups_by_nodes, src_ip_ranges, src_security_groups, subnets[0m

[31m--[ [0m[34mMatch #[0m[33m989[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m361 | [0m[35m            self._add_failure([0m
[30;1m362 | [0m[35m                f"The EC2 instance selected ({instance_type}) supports enhanced networking capabilit[0m
[30;1m363 | [0m[35m                "Elastic Fabric Adapter (EFA). EFA enables you to run applications requiring high le[0m
[30;1m364 | [0m[35m                "inter-node communications at scale on AWS at no additional charge. You can update t[0m
[30;1m365 | [0m[35m                "configuration to enable EFA (https://docs.aws.amazon.com/parallelcluster/latest/ug/[0m
[30;1m366 | [0m[35m                FailureLevel.WARNING,[0m
[30;1m367 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m990[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m361 | [0m[35m            self._add_failure([0m
[30;1m362 | [0m[35m                f"The EC2 instance selected ({instance_type}) supports enhanced networking capabilit[0m
[30;1m363 | [0m[35m                "Elastic Fabric Adapter (EFA). EFA enables you to run applications requiring high le[0m
[30;1m364 | [0m[35m                "inter-node communications at scale on AWS at no additional charge. You can update t[0m
[30;1m365 | [0m[35m                "configuration to enable EFA (https://docs.aws.amazon.com/parallelcluster/latest/ug/[0m
[30;1m366 | [0m[35m                FailureLevel.WARNING,[0m
[30;1m367 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m991[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m361 | [0m[35m            self._add_failure([0m
[30;1m362 | [0m[35m                f"The EC2 instance selected ({instance_type}) supports enhanced networking capabilit[0m
[30;1m363 | [0m[35m                "Elastic Fabric Adapter (EFA). EFA enables you to run applications requiring high le[0m
[30;1m364 | [0m[35m                "inter-node communications at scale on AWS at no additional charge. You can update t[0m
[30;1m365 | [0m[35m                "configuration to enable EFA (https://docs.aws.amazon.com/parallelcluster/latest/ug/[0m
[30;1m366 | [0m[35m                FailureLevel.WARNING,[0m
[30;1m367 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m992[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35m        if len(name) > NAME_MAX_LENGTH:[0m
[30;1m328 | [0m[35m            self._add_failure([0m
[30;1m329 | [0m[35m                f"Invalid name '{name}'. Name can be at most {NAME_MAX_LENGTH} chars long.", Failure[0m
[30;1m330 | [0m[35m            )[0m
[30;1m331 | [0m[35m[0m
[30;1m332 | [0m[35m        if re.match("^default$", name):[0m

[31m--[ [0m[34mMatch #[0m[33m993[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m249 | [0m[35m    def _validate(self, schedulable_memory, ec2memory, instance_type):[0m
[30;1m250 | [0m[35m        if schedulable_memory is not None:[0m
[30;1m251 | [0m[35m            if schedulable_memory < 1:[0m
[30;1m252 | [0m[35m                self._add_failure("SchedulableMemory must be at least 1 MiB.", FailureLevel.ERROR)[0m
[30;1m253 | [0m[35m            if ec2memory is None:[0m
[30;1m254 | [0m[35m                self._add_failure([0m
[30;1m255 | [0m[35m                    f"SchedulableMemory was set but EC2 memory is not available for selected instanc[0m

[31m--[ [0m[34mMatch #[0m[33m994[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/cluster_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m995[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m421 | [0m[35m[0m
[30;1m422 | [0m[35m    def _init_cluster_attributes(self, dev_settings):[0m
[30;1m423 | [0m[35m        if dev_settings and dev_settings.cookbook and dev_settings.cookbook.extra_chef_attributes:[0m
[30;1m424 | [0m[35m            self._cluster_attributes = json.loads(dev_settings.cookbook.extra_chef_attributes).get("[0m
[30;1m425 | [0m[35m[0m
[30;1m426 | [0m[35m    def _set_extra_attributes(self, dev_settings):[0m
[30;1m427 | [0m[35m        if dev_settings and dev_settings.cookbook and dev_settings.cookbook.extra_chef_attributes:[0m

[31m--[ [0m[34mMatch #[0m[33m996[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m167 | [0m[35m                value = value.value[0m
[30;1m168 | [0m[35m            else:[0m
[30;1m169 | [0m[35m                # If other type, check if it is backed by a param; if yes, sync the param[0m
[30;1m170 | [0m[35m                param = self.__params.get(key, None)[0m
[30;1m171 | [0m[35m                if param:[0m
[30;1m172 | [0m[35m                    param._Param__value = value[0m
[30;1m173 | [0m[35m                    param._Param__implied = False[0m

[31m--[ [0m[34mMatch #[0m[33m997[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/common.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m    def get_param(self, param_name):[0m
[30;1m147 | [0m[35m        """Get the information related to the specified parameter name."""[0m
[30;1m148 | [0m[35m        return self.__params.get(param_name, None)[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m    def is_implied(self, param_name):[0m
[30;1m151 | [0m[35m        """Tell if the value of an attribute is implied or not."""[0m

[31m--[ [0m[34mMatch #[0m[33m998[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m369 | [0m[35m    """[0m
[30;1m370 | [0m[35m    Represent the IMDS configuration shared between the ImageBuilder and Cluster.[0m
[30;1m371 | [0m[35m[0m
[30;1m372 | [0m[35m    It represents the Imds element that can be either at top level in the cluster config file,[0m
[30;1m373 | [0m[35m    or in the Build section of the build image config file.[0m
[30;1m374 | [0m[35m    """[0m
[30;1m375 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m999[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m228 | [0m[35m        """[0m
[30;1m229 | [0m[35m        Execute registered validators.[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m        The "nested" parameter is used only for internal recursive calls to distinguish those from t[0m
[30;1m232 | [0m[35m        one where the async validators results should be awaited for.[0m
[30;1m233 | [0m[35m        """[0m
[30;1m234 | [0m[35m        # this validation logic is a responsibility that could be completely separated from the reso[0m

[31m--[ [0m[34mMatch #[0m[33m1000[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m205 | [0m[35m    def _await_async_validators(self):[0m
[30;1m206 | [0m[35m        # here could be a good spot to add a cascading timeout for the async validators[0m
[30;1m207 | [0m[35m        # if they are taking too long to execute for a resource and its children since the use of[0m
[30;1m208 | [0m[35m        # get_async_timed_validator_type_for allows to decorate only on single validator at a time a[0m
[30;1m209 | [0m[35m        # does not cascade to child resources[0m
[30;1m210 | [0m[35m        return list([0m
[30;1m211 | [0m[35m            itertools.chain.from_iterable([0m

[31m--[ [0m[34mMatch #[0m[33m1001[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m203 | [0m[35m        return validator.execute_async(**validator_args)[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m    def _await_async_validators(self):[0m
[30;1m206 | [0m[35m        # here could be a good spot to add a cascading timeout for the async validators[0m
[30;1m207 | [0m[35m        # if they are taking too long to execute for a resource and its children since the use of[0m
[30;1m208 | [0m[35m        # get_async_timed_validator_type_for allows to decorate only on single validator at a time a[0m
[30;1m209 | [0m[35m        # does not cascade to child resources[0m

[31m--[ [0m[34mMatch #[0m[33m1002[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m156 | [0m[35m        Override the parent __set_attr__ method to manage parameters information related to Resource[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m        When an attribute is initialized through the `init_param` method, a Resource.Param instance [0m
[30;1m159 | [0m[35m        the attribute and then kept updated accordingly every time the attribute is updated.[0m
[30;1m160 | [0m[35m        """[0m
[30;1m161 | [0m[35m        if key != "_Resource__params":[0m
[30;1m162 | [0m[35m            if isinstance(value, Resource.Param):[0m

[31m--[ [0m[34mMatch #[0m[33m1003[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/common.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m369 | [0m[35m    """[0m
[30;1m370 | [0m[35m    Represent the IMDS configuration shared between the ImageBuilder and Cluster.[0m
[30;1m371 | [0m[35m[0m
[30;1m372 | [0m[35m    It represents the Imds element that can be either at top level in the cluster config file,[0m
[30;1m373 | [0m[35m    or in the Build section of the build image config file.[0m
[30;1m374 | [0m[35m    """[0m
[30;1m375 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1004[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/common.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m205 | [0m[35m    def _await_async_validators(self):[0m
[30;1m206 | [0m[35m        # here could be a good spot to add a cascading timeout for the async validators[0m
[30;1m207 | [0m[35m        # if they are taking too long to execute for a resource and its children since the use of[0m
[30;1m208 | [0m[35m        # get_async_timed_validator_type_for allows to decorate only on single validator at a time a[0m
[30;1m209 | [0m[35m        # does not cascade to child resources[0m
[30;1m210 | [0m[35m        return list([0m
[30;1m211 | [0m[35m            itertools.chain.from_iterable([0m

[31m--[ [0m[34mMatch #[0m[33m1005[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/common.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m        @property[0m
[30;1m126 | [0m[35m        def update_policy(self):[0m
[30;1m127 | [0m[35m            """Return the update policy."""[0m
[30;1m128 | [0m[35m            return self.__update_policy()[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m        def __repr__(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1006[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/common.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m85 | [0m[35m        Represent a Configuration-managed attribute of a Resource.[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        Other than the value of the attribute, it contains metadata information that allows to check[0m
[30;1m88 | [0m[35m        implied or not, get the update policy and the default value.[0m
[30;1m89 | [0m[35m        Instances of this class are not meant to be created directly, but only through the `init_par[0m
[30;1m90 | [0m[35m        of resource class.[0m
[30;1m91 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1007[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/common.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1008[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1009[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_artifacts_manager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2023 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1010[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/awsbatch_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m868 | [0m[35m        CfnOutput([0m
[30;1m869 | [0m[35m            self.stack_scope,[0m
[30;1m870 | [0m[35m            "CodeBuildDockerImageBuilderProject",[0m
[30;1m871 | [0m[35m            description="CodeBuild project used to bake docker images.",[0m
[30;1m872 | [0m[35m            value=self._code_build_image_builder_project.ref,[0m
[30;1m873 | [0m[35m        )[0m
[30;1m874 | [0m[35m        CfnOutput([0m

[31m--[ [0m[34mMatch #[0m[33m1011[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/awsbatch_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m862 | [0m[35m        CfnOutput([0m
[30;1m863 | [0m[35m            self.stack_scope,[0m
[30;1m864 | [0m[35m            "ECRRepoName",[0m
[30;1m865 | [0m[35m            description="Name of the ECR repository where docker images used by AWS Batch are locate[0m
[30;1m866 | [0m[35m            value=self._docker_images_repo.ref,[0m
[30;1m867 | [0m[35m        )[0m
[30;1m868 | [0m[35m        CfnOutput([0m

[31m--[ [0m[34mMatch #[0m[33m1012[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/awsbatch_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m139 | [0m[35m        self._docker_build_wait_condition_handle = self._add_docker_build_wait_condition_handle()[0m
[30;1m140 | [0m[35m        self._code_build_image_builder_project = self._add_code_build_docker_image_builder_project()[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m        # Docker image management[0m
[30;1m143 | [0m[35m        self._manage_docker_images_lambda = self._add_manage_docker_images_lambda()[0m
[30;1m144 | [0m[35m        self._manage_docker_images_custom_resource = self._add_manage_docker_images_custom_resource([0m
[30;1m145 | [0m[35m        self._docker_build_wait_condition = self._add_docker_build_wait_condition()[0m

[31m--[ [0m[34mMatch #[0m[33m1013[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/awsbatch_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m    # -- Resources ---------------------------------------------------------------------------------[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m    def _add_resources(self):[0m
[30;1m114 | [0m[35m        # Augment head node instance profile with Batch-specific policies, only add policies to Role[0m
[30;1m115 | [0m[35m        # ParallelCluster[0m
[30;1m116 | [0m[35m        if self.head_node_instance_role:[0m
[30;1m117 | [0m[35m            self._add_batch_head_node_policies_to_role()[0m

[31m--[ [0m[34mMatch #[0m[33m1014[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/awsbatch_builder.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1015[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/flask_app.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m169 | [0m[35m                LimitExceededException(str(exception))[0m
[30;1m170 | [0m[35m            )[0m
[30;1m171 | [0m[35m        return ParallelClusterFlaskApp._handle_parallel_cluster_api_exception([0m
[30;1m172 | [0m[35m            InternalServiceException(f"Failed when calling AWS service in {exception.function_name}:[0m
[30;1m173 | [0m[35m        )[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m    def start_local_server(self, port: int = 8080, debug: bool = False):[0m

[31m--[ [0m[34mMatch #[0m[33m1016[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/flask_app.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1017[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/imagebuilder_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m103 | [0m[35m    def validate_component_value(self, data, **kwargs):[0m
[30;1m104 | [0m[35m        """Validate component value format."""[0m
[30;1m105 | [0m[35m        type = data.get("type")[0m
[30;1m106 | [0m[35m        value = data.get("value")[0m
[30;1m107 | [0m[35m        if type == "arn" and not value.startswith("arn"):[0m
[30;1m108 | [0m[35m            raise ValidationError([0m
[30;1m109 | [0m[35m                message="The Type in Component is arn, the value '{0}' is invalid. "[0m

[31m--[ [0m[34mMatch #[0m[33m1018[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/imagebuilder_schema.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m    @validates_schema()[0m
[30;1m103 | [0m[35m    def validate_component_value(self, data, **kwargs):[0m
[30;1m104 | [0m[35m        """Validate component value format."""[0m
[30;1m105 | [0m[35m        type = data.get("type")[0m
[30;1m106 | [0m[35m        value = data.get("value")[0m
[30;1m107 | [0m[35m        if type == "arn" and not value.startswith("arn"):[0m
[30;1m108 | [0m[35m            raise ValidationError([0m

[31m--[ [0m[34mMatch #[0m[33m1019[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/schemas/imagebuilder_schema.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1020[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/launch_template_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m31 | [0m[35m        return instance_market_options[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    def get_capacity_reservation(self, queue, compute_resource):[0m
[30;1m34 | [0m[35m        """Return the capacity reservation if a target is defined at the queue or compute resource l[0m
[30;1m35 | [0m[35m        capacity_reservation = None[0m
[30;1m36 | [0m[35m        cr_target = compute_resource.capacity_reservation_target or queue.capacity_reservation_targe[0m
[30;1m37 | [0m[35m        if cr_target:[0m

[31m--[ [0m[34mMatch #[0m[33m1021[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/converters.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m        ApiNodeType.COMPUTENODE: NodeType.COMPUTE,[0m
[30;1m73 | [0m[35m        ApiNodeType.LOGINNODE: NodeType.LOGIN_NODE,[0m
[30;1m74 | [0m[35m    }[0m
[30;1m75 | [0m[35m    return mapping.get(node_type)[0m

[31m--[ [0m[34mMatch #[0m[33m1022[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/converters.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m        CloudFormationStackStatus.UPDATE_ROLLBACK_COMPLETE_CLEANUP_IN_PROGRESS: ImageBuildStatus.BUI[0m
[30;1m48 | [0m[35m        CloudFormationStackStatus.UPDATE_ROLLBACK_COMPLETE: ImageBuildStatus.BUILD_FAILED,[0m
[30;1m49 | [0m[35m    }[0m
[30;1m50 | [0m[35m    return mapping.get(cfn_status, cfn_status)[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35mdef validation_results_to_config_validation_errors([0m

[31m--[ [0m[34mMatch #[0m[33m1023[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/converters.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m25 | [0m[35m        CloudFormationStackStatus.UPDATE_ROLLBACK_COMPLETE_CLEANUP_IN_PROGRESS: ClusterStatus.UPDATE[0m
[30;1m26 | [0m[35m        CloudFormationStackStatus.UPDATE_ROLLBACK_COMPLETE: ClusterStatus.UPDATE_FAILED,[0m
[30;1m27 | [0m[35m    }[0m
[30;1m28 | [0m[35m    return mapping.get(cfn_status, cfn_status)[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m[0m
[30;1m31 | [0m[35mdef cloud_formation_status_to_image_status(cfn_status):[0m

[31m--[ [0m[34mMatch #[0m[33m1024[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/converters.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m#  Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m#  Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except [0m
[30;1m4 | [0m[35m#  with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m#  or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS[0m
[30;1m6 | [0m[35m#  OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governin[0m
[30;1m7 | [0m[35m#  limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1025[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m193 | [0m[35m    @property[0m
[30;1m194 | [0m[35m    def default_user(self) -> str:[0m
[30;1m195 | [0m[35m        """Get the default user for the instance."""[0m
[30;1m196 | [0m[35m        return OS_MAPPING.get(self.os, []).get("user", None)[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m    @property[0m
[30;1m199 | [0m[35m    def os(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1026[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m193 | [0m[35m    @property[0m
[30;1m194 | [0m[35m    def default_user(self) -> str:[0m
[30;1m195 | [0m[35m        """Get the default user for the instance."""[0m
[30;1m196 | [0m[35m        return OS_MAPPING.get(self.os, []).get("user", None)[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m    @property[0m
[30;1m199 | [0m[35m    def os(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1027[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m        stack_events = list(itertools.chain.from_iterable(get_all_stack_events(self.name)))[0m
[30;1m96 | [0m[35m        failure_event = next(filter(_is_failed_wait, stack_events), None)[0m
[30;1m97 | [0m[35m        return failure_event.get("ResourceStatusReason") if failure_event else None[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m    def get_cluster_creation_failure(self):[0m
[30;1m100 | [0m[35m        """Get error code and error reasons for cluster creation failure."""[0m

[31m--[ [0m[34mMatch #[0m[33m1028[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m        def _is_failed_wait(event):[0m
[30;1m88 | [0m[35m            if ([0m
[30;1m89 | [0m[35m                event.get("ResourceType") == "AWS::CloudFormation::WaitCondition"[0m
[30;1m90 | [0m[35m                and event.get("ResourceStatus") == "CREATE_FAILED"[0m
[30;1m91 | [0m[35m            ):[0m
[30;1m92 | [0m[35m                return True[0m
[30;1m93 | [0m[35m            return False[0m

[31m--[ [0m[34mMatch #[0m[33m1029[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        def _is_failed_wait(event):[0m
[30;1m88 | [0m[35m            if ([0m
[30;1m89 | [0m[35m                event.get("ResourceType") == "AWS::CloudFormation::WaitCondition"[0m
[30;1m90 | [0m[35m                and event.get("ResourceStatus") == "CREATE_FAILED"[0m
[30;1m91 | [0m[35m            ):[0m
[30;1m92 | [0m[35m                return True[0m

[31m--[ [0m[34mMatch #[0m[33m1030[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m288 | [0m[35m[0m
[30;1m289 | [0m[35m    @property[0m
[30;1m290 | [0m[35m    def end_time(self):[0m
[30;1m291 | [0m[35m        """Get end time parameter."""[0m
[30;1m292 | [0m[35m        return self.time_parser.end_time[0m
[30;1m293 | [0m[35m[0m
[30;1m294 | [0m[35m    def validate(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1031[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m    @property[0m
[30;1m285 | [0m[35m    def start_time(self):[0m
[30;1m286 | [0m[35m        """Get start time parameter."""[0m
[30;1m287 | [0m[35m        return self.time_parser.start_time[0m
[30;1m288 | [0m[35m[0m
[30;1m289 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1032[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m264 | [0m[35m            if self._node_type != "HeadNode":[0m
[30;1m265 | [0m[35m                raise FiltersParserError("The only accepted value for Node Type filter is 'HeadNode'[0m
[30;1m266 | [0m[35m            if self._private_dns_name:[0m
[30;1m267 | [0m[35m                raise FiltersParserError("Private DNS Name and Node Type filters cannot be set at th[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35mclass ExportClusterLogsFiltersParser(ClusterLogsFiltersParser):[0m

[31m--[ [0m[34mMatch #[0m[33m1033[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m262 | [0m[35m        """Check filters consistency."""[0m
[30;1m263 | [0m[35m        if self._node_type:[0m
[30;1m264 | [0m[35m            if self._node_type != "HeadNode":[0m
[30;1m265 | [0m[35m                raise FiltersParserError("The only accepted value for Node Type filter is 'HeadNode'[0m
[30;1m266 | [0m[35m            if self._private_dns_name:[0m
[30;1m267 | [0m[35m                raise FiltersParserError("Private DNS Name and Node Type filters cannot be set at th[0m
[30;1m268 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1034[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m255 | [0m[35m                if self._head_node:[0m
[30;1m256 | [0m[35m                    self._log_stream_prefix = self._head_node.private_dns_name_short[0m
[30;1m257 | [0m[35m                else:[0m
[30;1m258 | [0m[35m                    raise FiltersParserError("HeadNode instance not available. Node Type filter cann[0m
[30;1m259 | [0m[35m        return self._log_stream_prefix[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m    def validate(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1035[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m169 | [0m[35m            ClusterCreationFailure([0m
[30;1m170 | [0m[35m                "StaticNodeBootstrapFailure",[0m
[30;1m171 | [0m[35m                "Cluster has been set to PROTECTED mode due to failures detected in static node prov[0m
[30;1m172 | [0m[35m                "Cluster has been set to PROTECTED mode due to failures detected in static node prov[0m
[30;1m173 | [0m[35m            ),[0m
[30;1m174 | [0m[35m        ][0m
[30;1m175 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1036[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m168 | [0m[35m            ),[0m
[30;1m169 | [0m[35m            ClusterCreationFailure([0m
[30;1m170 | [0m[35m                "StaticNodeBootstrapFailure",[0m
[30;1m171 | [0m[35m                "Cluster has been set to PROTECTED mode due to failures detected in static node prov[0m
[30;1m172 | [0m[35m                "Cluster has been set to PROTECTED mode due to failures detected in static node prov[0m
[30;1m173 | [0m[35m            ),[0m
[30;1m174 | [0m[35m        ][0m

[31m--[ [0m[34mMatch #[0m[33m1037[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m160 | [0m[35m            ),[0m
[30;1m161 | [0m[35m            ClusterCreationFailure([0m
[30;1m162 | [0m[35m                "ResourceCreationFailure",[0m
[30;1m163 | [0m[35m                "Failed to create resources for head node bootstrap.",[0m
[30;1m164 | [0m[35m                "Resource creation cancelled",[0m
[30;1m165 | [0m[35m            ),[0m
[30;1m166 | [0m[35m            ClusterCreationFailure([0m

[31m--[ [0m[34mMatch #[0m[33m1038[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m156 | [0m[35m                "HeadNodeBootstrapFailure", "Failed to set up the head node.", "Failed to run chef r[0m
[30;1m157 | [0m[35m            ),[0m
[30;1m158 | [0m[35m            ClusterCreationFailure([0m
[30;1m159 | [0m[35m                "HeadNodeBootstrapFailure", "Failed to bootstrap the head node.", "Failed to bootstr[0m
[30;1m160 | [0m[35m            ),[0m
[30;1m161 | [0m[35m            ClusterCreationFailure([0m
[30;1m162 | [0m[35m                "ResourceCreationFailure",[0m

[31m--[ [0m[34mMatch #[0m[33m1039[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m156 | [0m[35m                "HeadNodeBootstrapFailure", "Failed to set up the head node.", "Failed to run chef r[0m
[30;1m157 | [0m[35m            ),[0m
[30;1m158 | [0m[35m            ClusterCreationFailure([0m
[30;1m159 | [0m[35m                "HeadNodeBootstrapFailure", "Failed to bootstrap the head node.", "Failed to bootstr[0m
[30;1m160 | [0m[35m            ),[0m
[30;1m161 | [0m[35m            ClusterCreationFailure([0m
[30;1m162 | [0m[35m                "ResourceCreationFailure",[0m

[31m--[ [0m[34mMatch #[0m[33m1040[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m153 | [0m[35m            ClusterCreationFailure("FsxMountFailure", "Failed to mount FSX.", "Failed to mount FSX")[0m
[30;1m154 | [0m[35m            ClusterCreationFailure("RaidMountFailure", "Failed to mount RAID array.", "Failed to mou[0m
[30;1m155 | [0m[35m            ClusterCreationFailure([0m
[30;1m156 | [0m[35m                "HeadNodeBootstrapFailure", "Failed to set up the head node.", "Failed to run chef r[0m
[30;1m157 | [0m[35m            ),[0m
[30;1m158 | [0m[35m            ClusterCreationFailure([0m
[30;1m159 | [0m[35m                "HeadNodeBootstrapFailure", "Failed to bootstrap the head node.", "Failed to bootstr[0m

[31m--[ [0m[34mMatch #[0m[33m1041[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m151 | [0m[35m            ClusterCreationFailure("EbsMountFailure", "Failed to mount EBS volume.", "Failed to moun[0m
[30;1m152 | [0m[35m            ClusterCreationFailure("EfsMountFailure", "Failed to mount EFS.", "Failed to mount EFS")[0m
[30;1m153 | [0m[35m            ClusterCreationFailure("FsxMountFailure", "Failed to mount FSX.", "Failed to mount FSX")[0m
[30;1m154 | [0m[35m            ClusterCreationFailure("RaidMountFailure", "Failed to mount RAID array.", "Failed to mou[0m
[30;1m155 | [0m[35m            ClusterCreationFailure([0m
[30;1m156 | [0m[35m                "HeadNodeBootstrapFailure", "Failed to set up the head node.", "Failed to run chef r[0m
[30;1m157 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m1042[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m151 | [0m[35m            ClusterCreationFailure("EbsMountFailure", "Failed to mount EBS volume.", "Failed to moun[0m
[30;1m152 | [0m[35m            ClusterCreationFailure("EfsMountFailure", "Failed to mount EFS.", "Failed to mount EFS")[0m
[30;1m153 | [0m[35m            ClusterCreationFailure("FsxMountFailure", "Failed to mount FSX.", "Failed to mount FSX")[0m
[30;1m154 | [0m[35m            ClusterCreationFailure("RaidMountFailure", "Failed to mount RAID array.", "Failed to mou[0m
[30;1m155 | [0m[35m            ClusterCreationFailure([0m
[30;1m156 | [0m[35m                "HeadNodeBootstrapFailure", "Failed to set up the head node.", "Failed to run chef r[0m
[30;1m157 | [0m[35m            ),[0m

[31m--[ [0m[34mMatch #[0m[33m1043[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m150 | [0m[35m            ),[0m
[30;1m151 | [0m[35m            ClusterCreationFailure("EbsMountFailure", "Failed to mount EBS volume.", "Failed to moun[0m
[30;1m152 | [0m[35m            ClusterCreationFailure("EfsMountFailure", "Failed to mount EFS.", "Failed to mount EFS")[0m
[30;1m153 | [0m[35m            ClusterCreationFailure("FsxMountFailure", "Failed to mount FSX.", "Failed to mount FSX")[0m
[30;1m154 | [0m[35m            ClusterCreationFailure("RaidMountFailure", "Failed to mount RAID array.", "Failed to mou[0m
[30;1m155 | [0m[35m            ClusterCreationFailure([0m
[30;1m156 | [0m[35m                "HeadNodeBootstrapFailure", "Failed to set up the head node.", "Failed to run chef r[0m

[31m--[ [0m[34mMatch #[0m[33m1044[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m150 | [0m[35m            ),[0m
[30;1m151 | [0m[35m            ClusterCreationFailure("EbsMountFailure", "Failed to mount EBS volume.", "Failed to moun[0m
[30;1m152 | [0m[35m            ClusterCreationFailure("EfsMountFailure", "Failed to mount EFS.", "Failed to mount EFS")[0m
[30;1m153 | [0m[35m            ClusterCreationFailure("FsxMountFailure", "Failed to mount FSX.", "Failed to mount FSX")[0m
[30;1m154 | [0m[35m            ClusterCreationFailure("RaidMountFailure", "Failed to mount RAID array.", "Failed to mou[0m
[30;1m155 | [0m[35m            ClusterCreationFailure([0m
[30;1m156 | [0m[35m                "HeadNodeBootstrapFailure", "Failed to set up the head node.", "Failed to run chef r[0m

[31m--[ [0m[34mMatch #[0m[33m1045[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m149 | [0m[35m                "OnNodeStartFailure", "Failed to run OnNodeStart script.", "Failed to run OnNodeStar[0m
[30;1m150 | [0m[35m            ),[0m
[30;1m151 | [0m[35m            ClusterCreationFailure("EbsMountFailure", "Failed to mount EBS volume.", "Failed to moun[0m
[30;1m152 | [0m[35m            ClusterCreationFailure("EfsMountFailure", "Failed to mount EFS.", "Failed to mount EFS")[0m
[30;1m153 | [0m[35m            ClusterCreationFailure("FsxMountFailure", "Failed to mount FSX.", "Failed to mount FSX")[0m
[30;1m154 | [0m[35m            ClusterCreationFailure("RaidMountFailure", "Failed to mount RAID array.", "Failed to mou[0m
[30;1m155 | [0m[35m            ClusterCreationFailure([0m

[31m--[ [0m[34mMatch #[0m[33m1046[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m149 | [0m[35m                "OnNodeStartFailure", "Failed to run OnNodeStart script.", "Failed to run OnNodeStar[0m
[30;1m150 | [0m[35m            ),[0m
[30;1m151 | [0m[35m            ClusterCreationFailure("EbsMountFailure", "Failed to mount EBS volume.", "Failed to moun[0m
[30;1m152 | [0m[35m            ClusterCreationFailure("EfsMountFailure", "Failed to mount EFS.", "Failed to mount EFS")[0m
[30;1m153 | [0m[35m            ClusterCreationFailure("FsxMountFailure", "Failed to mount FSX.", "Failed to mount FSX")[0m
[30;1m154 | [0m[35m            ClusterCreationFailure("RaidMountFailure", "Failed to mount RAID array.", "Failed to mou[0m
[30;1m155 | [0m[35m            ClusterCreationFailure([0m

[31m--[ [0m[34mMatch #[0m[33m1047[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m148 | [0m[35m            ClusterCreationFailure([0m
[30;1m149 | [0m[35m                "OnNodeStartFailure", "Failed to run OnNodeStart script.", "Failed to run OnNodeStar[0m
[30;1m150 | [0m[35m            ),[0m
[30;1m151 | [0m[35m            ClusterCreationFailure("EbsMountFailure", "Failed to mount EBS volume.", "Failed to moun[0m
[30;1m152 | [0m[35m            ClusterCreationFailure("EfsMountFailure", "Failed to mount EFS.", "Failed to mount EFS")[0m
[30;1m153 | [0m[35m            ClusterCreationFailure("FsxMountFailure", "Failed to mount FSX.", "Failed to mount FSX")[0m
[30;1m154 | [0m[35m            ClusterCreationFailure("RaidMountFailure", "Failed to mount RAID array.", "Failed to mou[0m

[31m--[ [0m[34mMatch #[0m[33m1048[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m148 | [0m[35m            ClusterCreationFailure([0m
[30;1m149 | [0m[35m                "OnNodeStartFailure", "Failed to run OnNodeStart script.", "Failed to run OnNodeStar[0m
[30;1m150 | [0m[35m            ),[0m
[30;1m151 | [0m[35m            ClusterCreationFailure("EbsMountFailure", "Failed to mount EBS volume.", "Failed to moun[0m
[30;1m152 | [0m[35m            ClusterCreationFailure("EfsMountFailure", "Failed to mount EFS.", "Failed to mount EFS")[0m
[30;1m153 | [0m[35m            ClusterCreationFailure("FsxMountFailure", "Failed to mount FSX.", "Failed to mount FSX")[0m
[30;1m154 | [0m[35m            ClusterCreationFailure("RaidMountFailure", "Failed to mount RAID array.", "Failed to mou[0m

[31m--[ [0m[34mMatch #[0m[33m1049[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m144 | [0m[35m                "OnNodeStartDownloadFailure",[0m
[30;1m145 | [0m[35m                "Failed to download OnNodeStart script.",[0m
[30;1m146 | [0m[35m                "Failed to download OnNodeStart script",[0m
[30;1m147 | [0m[35m            ),  # s3 and wget[0m
[30;1m148 | [0m[35m            ClusterCreationFailure([0m
[30;1m149 | [0m[35m                "OnNodeStartFailure", "Failed to run OnNodeStart script.", "Failed to run OnNodeStar[0m
[30;1m150 | [0m[35m            ),[0m
[30;1m151 | [0m[35m            ClusterCreationFailure("EbsMountFailure", "Failed to mount EBS volume.", "Failed to moun[0m

[31m--[ [0m[34mMatch #[0m[33m1050[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m                "OnNodeConfiguredDownloadFailure",[0m
[30;1m130 | [0m[35m                "Failed to download OnNodeConfigured script.",[0m
[30;1m131 | [0m[35m                "Failed to download OnNodeConfigured script",[0m
[30;1m132 | [0m[35m            ),  # s3 and wget[0m
[30;1m133 | [0m[35m            ClusterCreationFailure([0m
[30;1m134 | [0m[35m                "OnNodeConfiguredFailure",[0m
[30;1m135 | [0m[35m                "Failed to run OnNodeConfigured script.",[0m
[30;1m136 | [0m[35m                "Failed to run OnNodeConfigured script",[0m

[31m--[ [0m[34mMatch #[0m[33m1051[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m264 | [0m[35m            if self._node_type != "HeadNode":[0m
[30;1m265 | [0m[35m                raise FiltersParserError("The only accepted value for Node Type filter is 'HeadNode'[0m
[30;1m266 | [0m[35m            if self._private_dns_name:[0m
[30;1m267 | [0m[35m                raise FiltersParserError("Private DNS Name and Node Type filters cannot be set at th[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35mclass ExportClusterLogsFiltersParser(ClusterLogsFiltersParser):[0m

[31m--[ [0m[34mMatch #[0m[33m1052[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster_resources.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1053[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/cdk_builder.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1054[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m499 | [0m[35m            found_reservation_for_instance_type_in_group = False[0m
[30;1m500 | [0m[35m            for availability_zone in availability_zones:[0m
[30;1m501 | [0m[35m                found_reservation_for_instance_type_in_az = False[0m
[30;1m502 | [0m[35m                for capacity_reservation in capacity_reservations_per_az.get(availability_zone, []):[0m
[30;1m503 | [0m[35m                    if capacity_reservation_matches_instance(capacity_reservation, instance_type):[0m
[30;1m504 | [0m[35m                        found_reservation_for_instance_type_in_az = found_reservation_for_instance_t[0m
[30;1m505 | [0m[35m                        break[0m

[31m--[ [0m[34mMatch #[0m[33m1055[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m322 | [0m[35m        ReservationType is an attribute of capacity block that can be retrieved by describe-capacity[0m
[30;1m323 | [0m[35m        """[0m
[30;1m324 | [0m[35m        capacity_type_to_reservation_type_class_map = {"CAPACITY_BLOCK": "capacity-block"}[0m
[30;1m325 | [0m[35m        return capacity_type_to_reservation_type_class_map.get(capacity_type.value, capacity_type.va[0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35m    def _validate([0m
[30;1m328 | [0m[35m        self,[0m

[31m--[ [0m[34mMatch #[0m[33m1056[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m261 | [0m[35m        SupportedUsageClasses is an attribute of instance type that can be retrieved by describe-ins[0m
[30;1m262 | [0m[35m        """[0m
[30;1m263 | [0m[35m        capacity_type_to_supported_usage_class_map = {"CAPACITY_BLOCK": "capacity-block"}[0m
[30;1m264 | [0m[35m        return capacity_type_to_supported_usage_class_map.get(capacity_type.value, capacity_type.val[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m    def _validate(self, capacity_type: CapacityType, instance_type: str, capacity_reservation_id: Op[0m
[30;1m267 | [0m[35m        compute_type_value = self._get_supported_usage_class_from_capacity_type(capacity_type)[0m

[31m--[ [0m[34mMatch #[0m[33m1057[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m    """[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m    def _validate(self, instance_type: str, instance_type_data: dict):[0m
[30;1m127 | [0m[35m        size_in_mib = instance_type_data.get("MemoryInfo", {}).get("SizeInMiB")[0m
[30;1m128 | [0m[35m        if size_in_mib is None:[0m
[30;1m129 | [0m[35m            self._add_failure([0m
[30;1m130 | [0m[35m                f"EC2 does not provide memory information for instance type '{instance_type}'.",[0m

[31m--[ [0m[34mMatch #[0m[33m1058[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m    """[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m    def _validate(self, instance_type: str, instance_type_data: dict):[0m
[30;1m127 | [0m[35m        size_in_mib = instance_type_data.get("MemoryInfo", {}).get("SizeInMiB")[0m
[30;1m128 | [0m[35m        if size_in_mib is None:[0m
[30;1m129 | [0m[35m            self._add_failure([0m
[30;1m130 | [0m[35m                f"EC2 does not provide memory information for instance type '{instance_type}'.",[0m

[31m--[ [0m[34mMatch #[0m[33m1059[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m            inference_accelerator_manufacturers = list([0m
[30;1m82 | [0m[35m                {[0m
[30;1m83 | [0m[35m                    accelerator.get("Manufacturer", "")[0m
[30;1m84 | [0m[35m                    for accelerator in inference_accelerator_info.get("Accelerators", [])[0m
[30;1m85 | [0m[35m                }[0m
[30;1m86 | [0m[35m            )[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1060[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m        if inference_accelerator_info:[0m
[30;1m81 | [0m[35m            inference_accelerator_manufacturers = list([0m
[30;1m82 | [0m[35m                {[0m
[30;1m83 | [0m[35m                    accelerator.get("Manufacturer", "")[0m
[30;1m84 | [0m[35m                    for accelerator in inference_accelerator_info.get("Accelerators", [])[0m
[30;1m85 | [0m[35m                }[0m
[30;1m86 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1061[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m                    json.dumps(gpu_info),[0m
[30;1m77 | [0m[35m                )[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m        inference_accelerator_info = instance_type_data.get("InferenceAcceleratorInfo", {})[0m
[30;1m80 | [0m[35m        if inference_accelerator_info:[0m
[30;1m81 | [0m[35m            inference_accelerator_manufacturers = list([0m
[30;1m82 | [0m[35m                {[0m

[31m--[ [0m[34mMatch #[0m[33m1062[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m    def _validate(self, instance_type: str, instance_type_data: dict):[0m
[30;1m57 | [0m[35m        gpu_info = instance_type_data.get("GpuInfo", {})[0m
[30;1m58 | [0m[35m        if gpu_info:[0m
[30;1m59 | [0m[35m            gpu_manufacturers = list({gpu.get("Manufacturer", "") for gpu in gpu_info.get("Gpus", [][0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m            # Only one GPU manufacturer is associated with each Instance Type's GPU[0m
[30;1m62 | [0m[35m            manufacturer = gpu_manufacturers[0] if gpu_manufacturers else ""[0m

[31m--[ [0m[34mMatch #[0m[33m1063[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m    def _validate(self, instance_type: str, instance_type_data: dict):[0m
[30;1m57 | [0m[35m        gpu_info = instance_type_data.get("GpuInfo", {})[0m
[30;1m58 | [0m[35m        if gpu_info:[0m
[30;1m59 | [0m[35m            gpu_manufacturers = list({gpu.get("Manufacturer", "") for gpu in gpu_info.get("Gpus", [][0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m            # Only one GPU manufacturer is associated with each Instance Type's GPU[0m
[30;1m62 | [0m[35m            manufacturer = gpu_manufacturers[0] if gpu_manufacturers else ""[0m

[31m--[ [0m[34mMatch #[0m[33m1064[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m    """[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    def _validate(self, instance_type: str, instance_type_data: dict):[0m
[30;1m57 | [0m[35m        gpu_info = instance_type_data.get("GpuInfo", {})[0m
[30;1m58 | [0m[35m        if gpu_info:[0m
[30;1m59 | [0m[35m            gpu_manufacturers = list({gpu.get("Manufacturer", "") for gpu in gpu_info.get("Gpus", [][0m
[30;1m60 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1065[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    def _validate(self, instance_type: str, instance_type_data: dict, placement_group_enabled: bool)[0m
[30;1m37 | [0m[35m        if placement_group_enabled:[0m
[30;1m38 | [0m[35m            placement_group_supported_strategies = instance_type_data.get("PlacementGroupInfo", {}).[0m
[30;1m39 | [0m[35m                "SupportedStrategies", [][0m
[30;1m40 | [0m[35m            )[0m
[30;1m41 | [0m[35m            if "cluster" not in placement_group_supported_strategies:[0m

[31m--[ [0m[34mMatch #[0m[33m1066[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    def _validate(self, instance_type: str, instance_type_data: dict, placement_group_enabled: bool)[0m
[30;1m37 | [0m[35m        if placement_group_enabled:[0m
[30;1m38 | [0m[35m            placement_group_supported_strategies = instance_type_data.get("PlacementGroupInfo", {}).[0m
[30;1m39 | [0m[35m                "SupportedStrategies", [][0m
[30;1m40 | [0m[35m            )[0m
[30;1m41 | [0m[35m            if "cluster" not in placement_group_supported_strategies:[0m

[31m--[ [0m[34mMatch #[0m[33m1067[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m305 | [0m[35m                )[0m
[30;1m306 | [0m[35m        else:[0m
[30;1m307 | [0m[35m            self._add_failure([0m
[30;1m308 | [0m[35m                f"Could not check node AMI {image_id} OS and cluster OS {os} compatibility, please m[0m
[30;1m309 | [0m[35m                f"they are compatible before cluster creation and update operations.",[0m
[30;1m310 | [0m[35m                FailureLevel.WARNING,[0m
[30;1m311 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1068[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m300 | [0m[35m        if image_os:[0m
[30;1m301 | [0m[35m            if image_os != os:[0m
[30;1m302 | [0m[35m                self._add_failure([0m
[30;1m303 | [0m[35m                    f"The OS of node AMI {image_id} is {image_os}, it is not compatible with cluster[0m
[30;1m304 | [0m[35m                    FailureLevel.ERROR,[0m
[30;1m305 | [0m[35m                )[0m
[30;1m306 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m1069[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m289 | [0m[35m[0m
[30;1m290 | [0m[35mclass AmiOsCompatibleValidator(Validator):[0m
[30;1m291 | [0m[35m    """[0m
[30;1m292 | [0m[35m    node AMI and OS compatibility validator.[0m
[30;1m293 | [0m[35m[0m
[30;1m294 | [0m[35m    If image has tag of OS, compare AMI OS with cluster OS, else print out a warning message.[0m
[30;1m295 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1070[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m451 | [0m[35m    - When using multiple instance types:[0m
[30;1m452 | [0m[35m        - At least one capacity reservation in the resource group can be used with one of the instan[0m
[30;1m453 | [0m[35m    - When using multiple subnets[0m
[30;1m454 | [0m[35m        - At least one capacity reservation in the resource group can be used with one of the subnet[0m
[30;1m455 | [0m[35m    """[0m
[30;1m456 | [0m[35m[0m
[30;1m457 | [0m[35m    def _validate([0m

[31m--[ [0m[34mMatch #[0m[33m1071[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m449 | [0m[35m    """Validate capacity reservation group is can be used with existing instance types and subnets.[0m
[30;1m450 | [0m[35m[0m
[30;1m451 | [0m[35m    - When using multiple instance types:[0m
[30;1m452 | [0m[35m        - At least one capacity reservation in the resource group can be used with one of the instan[0m
[30;1m453 | [0m[35m    - When using multiple subnets[0m
[30;1m454 | [0m[35m        - At least one capacity reservation in the resource group can be used with one of the subnet[0m
[30;1m455 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1072[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m306 | [0m[35m        else:[0m
[30;1m307 | [0m[35m            self._add_failure([0m
[30;1m308 | [0m[35m                f"Could not check node AMI {image_id} OS and cluster OS {os} compatibility, please m[0m
[30;1m309 | [0m[35m                f"they are compatible before cluster creation and update operations.",[0m
[30;1m310 | [0m[35m                FailureLevel.WARNING,[0m
[30;1m311 | [0m[35m            )[0m
[30;1m312 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1073[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m190 | [0m[35m            if re.search(r"(micro)|(nano)", instance_type):[0m
[30;1m191 | [0m[35m                self._add_failure([0m
[30;1m192 | [0m[35m                    "It is not recommended to use instance type {0} with {1}. If you want to use "[0m
[30;1m193 | [0m[35m                    "{1} it is recommended to use an instance type with at least 1.7 GB of memory.".[0m
[30;1m194 | [0m[35m                        instance_type, os[0m
[30;1m195 | [0m[35m                    ),[0m
[30;1m196 | [0m[35m                    FailureLevel.WARNING,[0m

[31m--[ [0m[34mMatch #[0m[33m1074[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/ec2_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1075[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_logs_controller.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m138 | [0m[35m        return StackEvent.from_dict(event)[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m    events = [convert_event(event) for event in stack_events["StackEvents"]][0m
[30;1m141 | [0m[35m    return GetClusterStackEventsResponseContent(next_token=stack_events.get("NextToken"), events=eve[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m@configure_aws_region()[0m

[31m--[ [0m[34mMatch #[0m[33m1076[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_logs_controller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m73 | [0m[35m                       than this time are included.[0m
[30;1m74 | [0m[35m    :type start_time: str[0m
[30;1m75 | [0m[35m    :param end_time: The end of the time range, expressed in ISO 8601 format (e.g. &#39;2021-01-01T2[0m
[30;1m76 | [0m[35m                     Events with a timestamp equal to or later than this time are not included.[0m
[30;1m77 | [0m[35m    :type end_time: str[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35m    :rtype: GetClusterLogEventsResponseContent[0m

[31m--[ [0m[34mMatch #[0m[33m1077[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_logs_controller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m72 | [0m[35m                       (e.g. &#39;2021-01-01T20:00:00Z&#39;). Events with a timestamp equal to this [0m
[30;1m73 | [0m[35m                       than this time are included.[0m
[30;1m74 | [0m[35m    :type start_time: str[0m
[30;1m75 | [0m[35m    :param end_time: The end of the time range, expressed in ISO 8601 format (e.g. &#39;2021-01-01T2[0m
[30;1m76 | [0m[35m                     Events with a timestamp equal to or later than this time are not included.[0m
[30;1m77 | [0m[35m    :type end_time: str[0m
[30;1m78 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1078[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_logs_controller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m    :type limit:[0m
[30;1m71 | [0m[35m    :param start_time: The start of the time range, expressed in ISO 8601 format[0m
[30;1m72 | [0m[35m                       (e.g. &#39;2021-01-01T20:00:00Z&#39;). Events with a timestamp equal to this [0m
[30;1m73 | [0m[35m                       than this time are included.[0m
[30;1m74 | [0m[35m    :type start_time: str[0m
[30;1m75 | [0m[35m    :param end_time: The end of the time range, expressed in ISO 8601 format (e.g. &#39;2021-01-01T2[0m
[30;1m76 | [0m[35m                     Events with a timestamp equal to or later than this time are not included.[0m

[31m--[ [0m[34mMatch #[0m[33m1079[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_logs_controller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m69 | [0m[35m                  log events as can fit in a response size of 1 MB, up to 10,000 log events.[0m
[30;1m70 | [0m[35m    :type limit:[0m
[30;1m71 | [0m[35m    :param start_time: The start of the time range, expressed in ISO 8601 format[0m
[30;1m72 | [0m[35m                       (e.g. &#39;2021-01-01T20:00:00Z&#39;). Events with a timestamp equal to this [0m
[30;1m73 | [0m[35m                       than this time are included.[0m
[30;1m74 | [0m[35m    :type start_time: str[0m
[30;1m75 | [0m[35m    :param end_time: The end of the time range, expressed in ISO 8601 format (e.g. &#39;2021-01-01T2[0m

[31m--[ [0m[34mMatch #[0m[33m1080[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_logs_controller.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m68 | [0m[35m    :param limit: The maximum number of log events returned. If you don&#39;t specify a value, the m[0m
[30;1m69 | [0m[35m                  log events as can fit in a response size of 1 MB, up to 10,000 log events.[0m
[30;1m70 | [0m[35m    :type limit:[0m
[30;1m71 | [0m[35m    :param start_time: The start of the time range, expressed in ISO 8601 format[0m
[30;1m72 | [0m[35m                       (e.g. &#39;2021-01-01T20:00:00Z&#39;). Events with a timestamp equal to this [0m
[30;1m73 | [0m[35m                       than this time are included.[0m
[30;1m74 | [0m[35m    :type start_time: str[0m

[31m--[ [0m[34mMatch #[0m[33m1081[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_logs_controller.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1082[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/compute_fleet_stack.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2023 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1083[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/setup.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2013-2016 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1084[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/networking/vpc_factory.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2018-2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1085[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1098 | [0m[35m                    next_token=next_token,[0m
[30;1m1099 | [0m[35m                )[0m
[30;1m1100 | [0m[35m                log_streams.extend(log_stream_resp["logStreams"])[0m
[30;1m1101 | [0m[35m                next_token = log_stream_resp.get("nextToken")[0m
[30;1m1102 | [0m[35m            else:[0m
[30;1m1103 | [0m[35m                LOGGER.debug("CloudWatch logging is not enabled for cluster %s.", self.name)[0m
[30;1m1104 | [0m[35m                raise BadRequestClusterActionError(f"CloudWatch logging is not enabled for cluster {[0m

[31m--[ [0m[34mMatch #[0m[33m1086[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m944 | [0m[35m            AWSApi.instance().cfn.update_stack_from_url([0m
[30;1m945 | [0m[35m                stack_name=self.stack_name,[0m
[30;1m946 | [0m[35m                template_url=self.bucket.get_cfn_template_url([0m
[30;1m947 | [0m[35m                    template_name=PCLUSTER_S3_ARTIFACTS_DICT.get("template_name")[0m
[30;1m948 | [0m[35m                ),[0m
[30;1m949 | [0m[35m                tags=self._get_cfn_tags(),[0m
[30;1m950 | [0m[35m                parameters=[[0m

[31m--[ [0m[34mMatch #[0m[33m1087[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m652 | [0m[35m    def _get_updated_stack_status(self):[0m
[30;1m653 | [0m[35m        """Return updated status of the stack."""[0m
[30;1m654 | [0m[35m        try:[0m
[30;1m655 | [0m[35m            return AWSApi.instance().cfn.describe_stack(self.stack_name).get("StackStatus")[0m
[30;1m656 | [0m[35m        except AWSClientError as e:[0m
[30;1m657 | [0m[35m            raise _cluster_error_mapper(e, f"Unable to retrieve status of stack {self.stack_name}. {[0m
[30;1m658 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1088[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m644 | [0m[35m        try:[0m
[30;1m645 | [0m[35m            self.bucket.upload_cfn_template(template, PCLUSTER_S3_ARTIFACTS_DICT.get("template_name"[0m
[30;1m646 | [0m[35m            self._update_stack_template([0m
[30;1m647 | [0m[35m                self.bucket.get_cfn_template_url(PCLUSTER_S3_ARTIFACTS_DICT.get("template_name"))[0m
[30;1m648 | [0m[35m            )[0m
[30;1m649 | [0m[35m        except AWSClientError as e:[0m
[30;1m650 | [0m[35m            raise _cluster_error_mapper(e, f"Unable to persist logs on cluster deletion, failed with[0m

[31m--[ [0m[34mMatch #[0m[33m1089[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m642 | [0m[35m        for key in keys:[0m
[30;1m643 | [0m[35m            template["Resources"][key]["DeletionPolicy"] = "Retain"[0m
[30;1m644 | [0m[35m        try:[0m
[30;1m645 | [0m[35m            self.bucket.upload_cfn_template(template, PCLUSTER_S3_ARTIFACTS_DICT.get("template_name"[0m
[30;1m646 | [0m[35m            self._update_stack_template([0m
[30;1m647 | [0m[35m                self.bucket.get_cfn_template_url(PCLUSTER_S3_ARTIFACTS_DICT.get("template_name"))[0m
[30;1m648 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1090[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m632 | [0m[35m        """Return the keys to all CloudWatch log group resources in template if the resource is not [0m
[30;1m633 | [0m[35m        unretained_cw_log_group_keys = [][0m
[30;1m634 | [0m[35m        for key, resource in self._get_stack_template().get("Resources", {}).items():[0m
[30;1m635 | [0m[35m            if resource.get("Type") == "AWS::Logs::LogGroup" and resource.get("DeletionPolicy") != "[0m
[30;1m636 | [0m[35m                unretained_cw_log_group_keys.append(key)[0m
[30;1m637 | [0m[35m        return unretained_cw_log_group_keys[0m
[30;1m638 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1091[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m632 | [0m[35m        """Return the keys to all CloudWatch log group resources in template if the resource is not [0m
[30;1m633 | [0m[35m        unretained_cw_log_group_keys = [][0m
[30;1m634 | [0m[35m        for key, resource in self._get_stack_template().get("Resources", {}).items():[0m
[30;1m635 | [0m[35m            if resource.get("Type") == "AWS::Logs::LogGroup" and resource.get("DeletionPolicy") != "[0m
[30;1m636 | [0m[35m                unretained_cw_log_group_keys.append(key)[0m
[30;1m637 | [0m[35m        return unretained_cw_log_group_keys[0m
[30;1m638 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1092[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m631 | [0m[35m    def _get_unretained_cw_log_group_resource_keys(self):[0m
[30;1m632 | [0m[35m        """Return the keys to all CloudWatch log group resources in template if the resource is not [0m
[30;1m633 | [0m[35m        unretained_cw_log_group_keys = [][0m
[30;1m634 | [0m[35m        for key, resource in self._get_stack_template().get("Resources", {}).items():[0m
[30;1m635 | [0m[35m            if resource.get("Type") == "AWS::Logs::LogGroup" and resource.get("DeletionPolicy") != "[0m
[30;1m636 | [0m[35m                unretained_cw_log_group_keys.append(key)[0m
[30;1m637 | [0m[35m        return unretained_cw_log_group_keys[0m

[31m--[ [0m[34mMatch #[0m[33m1093[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m598 | [0m[35m[0m
[30;1m599 | [0m[35m            # Upload template[0m
[30;1m600 | [0m[35m            if self.template_body:[0m
[30;1m601 | [0m[35m                self.bucket.upload_cfn_template(self.template_body, PCLUSTER_S3_ARTIFACTS_DICT.get("[0m
[30;1m602 | [0m[35m[0m
[30;1m603 | [0m[35m            LOGGER.info("Cluster artifacts uploaded correctly.")[0m
[30;1m604 | [0m[35m        except BadRequestClusterActionError:[0m

[31m--[ [0m[34mMatch #[0m[33m1094[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m593 | [0m[35m            if self.config.scheduler_resources:[0m
[30;1m594 | [0m[35m                self.bucket.upload_resources([0m
[30;1m595 | [0m[35m                    resource_dir=self.config.scheduler_resources,[0m
[30;1m596 | [0m[35m                    custom_artifacts_name=PCLUSTER_S3_ARTIFACTS_DICT.get("scheduler_resources_name")[0m
[30;1m597 | [0m[35m                )[0m
[30;1m598 | [0m[35m[0m
[30;1m599 | [0m[35m            # Upload template[0m

[31m--[ [0m[34mMatch #[0m[33m1095[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m588 | [0m[35m        try:[0m
[30;1m589 | [0m[35m            resources = pkg_resources.resource_filename(__name__, "../resources/custom_resources")[0m
[30;1m590 | [0m[35m            self.bucket.upload_resources([0m
[30;1m591 | [0m[35m                resource_dir=resources, custom_artifacts_name=PCLUSTER_S3_ARTIFACTS_DICT.get("custom[0m
[30;1m592 | [0m[35m            )[0m
[30;1m593 | [0m[35m            if self.config.scheduler_resources:[0m
[30;1m594 | [0m[35m                self.bucket.upload_resources([0m

[31m--[ [0m[34mMatch #[0m[33m1096[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m564 | [0m[35m            try:[0m
[30;1m565 | [0m[35m                self.bucket.upload_config([0m
[30;1m566 | [0m[35m                    config=ConfigPatch.generate_json_change_set(changes),[0m
[30;1m567 | [0m[35m                    config_name=PCLUSTER_S3_ARTIFACTS_DICT.get("change_set_name"),[0m
[30;1m568 | [0m[35m                    format=S3FileFormat.JSON,[0m
[30;1m569 | [0m[35m                )[0m
[30;1m570 | [0m[35m            except Exception as e:[0m

[31m--[ [0m[34mMatch #[0m[33m1097[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m550 | [0m[35m                format=S3FileFormat.JSON,[0m
[30;1m551 | [0m[35m            )[0m
[30;1m552 | [0m[35m[0m
[30;1m553 | [0m[35m            self.config.instance_types_data_version = result.get("VersionId")[0m
[30;1m554 | [0m[35m[0m
[30;1m555 | [0m[35m        except Exception as e:[0m
[30;1m556 | [0m[35m            raise _cluster_error_mapper([0m

[31m--[ [0m[34mMatch #[0m[33m1098[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m546 | [0m[35m            # Upload instance types data[0m
[30;1m547 | [0m[35m            result = self.bucket.upload_config([0m
[30;1m548 | [0m[35m                self.config.get_instance_types_data(),[0m
[30;1m549 | [0m[35m                PCLUSTER_S3_ARTIFACTS_DICT.get("instance_types_data_name"),[0m
[30;1m550 | [0m[35m                format=S3FileFormat.JSON,[0m
[30;1m551 | [0m[35m            )[0m
[30;1m552 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1099[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m533 | [0m[35m                )[0m
[30;1m534 | [0m[35m[0m
[30;1m535 | [0m[35m                # original config version will be stored in CloudFormation Parameters[0m
[30;1m536 | [0m[35m                self.config.original_config_version = result.get("VersionId")[0m
[30;1m537 | [0m[35m        except Exception as e:[0m
[30;1m538 | [0m[35m            raise _cluster_error_mapper([0m
[30;1m539 | [0m[35m                e, f"Unable to upload cluster config to the S3 bucket {self.bucket.name} due to exce[0m

[31m--[ [0m[34mMatch #[0m[33m1100[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m528 | [0m[35m                # Upload original config[0m
[30;1m529 | [0m[35m                result = self.bucket.upload_config([0m
[30;1m530 | [0m[35m                    config=self.source_config_text,[0m
[30;1m531 | [0m[35m                    config_name=PCLUSTER_S3_ARTIFACTS_DICT.get("source_config_name"),[0m
[30;1m532 | [0m[35m                    format=S3FileFormat.TEXT,[0m
[30;1m533 | [0m[35m                )[0m
[30;1m534 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1101[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m523 | [0m[35m                    config_name=PCLUSTER_S3_ARTIFACTS_DICT.get("config_name"),[0m
[30;1m524 | [0m[35m                )[0m
[30;1m525 | [0m[35m[0m
[30;1m526 | [0m[35m                self.config.config_version = result.get("VersionId")[0m
[30;1m527 | [0m[35m[0m
[30;1m528 | [0m[35m                # Upload original config[0m
[30;1m529 | [0m[35m                result = self.bucket.upload_config([0m

[31m--[ [0m[34mMatch #[0m[33m1102[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m520 | [0m[35m            if self.config:[0m
[30;1m521 | [0m[35m                result = self.bucket.upload_config([0m
[30;1m522 | [0m[35m                    config=ClusterSchema(cluster_name=self.name).dump(deepcopy(self.config)),[0m
[30;1m523 | [0m[35m                    config_name=PCLUSTER_S3_ARTIFACTS_DICT.get("config_name"),[0m
[30;1m524 | [0m[35m                )[0m
[30;1m525 | [0m[35m[0m
[30;1m526 | [0m[35m                self.config.config_version = result.get("VersionId")[0m

[31m--[ [0m[34mMatch #[0m[33m1103[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m507 | [0m[35m    @staticmethod[0m
[30;1m508 | [0m[35m    def _load_additional_instance_type_data(cluster_config_dict):[0m
[30;1m509 | [0m[35m        if "DevSettings" in cluster_config_dict:[0m
[30;1m510 | [0m[35m            instance_types_data = cluster_config_dict["DevSettings"].get("InstanceTypesData")[0m
[30;1m511 | [0m[35m            if instance_types_data:[0m
[30;1m512 | [0m[35m                # Set additional instance types data in AWSApi. Schema load will use the information[0m
[30;1m513 | [0m[35m                AWSApi.instance().ec2.additional_instance_types_data = json.loads(instance_types_dat[0m

[31m--[ [0m[34mMatch #[0m[33m1104[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m404 | [0m[35m                ],[0m
[30;1m405 | [0m[35m            )[0m
[30;1m406 | [0m[35m[0m
[30;1m407 | [0m[35m            return creation_result.get("StackId"), suppressed_validation_failures[0m
[30;1m408 | [0m[35m[0m
[30;1m409 | [0m[35m        except ConfigValidationError as e:[0m
[30;1m410 | [0m[35m            raise e[0m

[31m--[ [0m[34mMatch #[0m[33m1105[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m392 | [0m[35m            creation_result = AWSApi.instance().cfn.create_stack_from_url([0m
[30;1m393 | [0m[35m                stack_name=self.stack_name,[0m
[30;1m394 | [0m[35m                template_url=self.bucket.get_cfn_template_url([0m
[30;1m395 | [0m[35m                    template_name=PCLUSTER_S3_ARTIFACTS_DICT.get("template_name")[0m
[30;1m396 | [0m[35m                ),[0m
[30;1m397 | [0m[35m                disable_rollback=disable_rollback,[0m
[30;1m398 | [0m[35m                tags=self._get_cfn_tags(),[0m

[31m--[ [0m[34mMatch #[0m[33m1106[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m272 | [0m[35m    def config_presigned_url(self) -> str:[0m
[30;1m273 | [0m[35m        """Return a pre-signed Url to download the config from the S3 bucket."""[0m
[30;1m274 | [0m[35m        return self.bucket.get_config_presigned_url([0m
[30;1m275 | [0m[35m            config_name=PCLUSTER_S3_ARTIFACTS_DICT.get("source_config_name"),[0m
[30;1m276 | [0m[35m            version_id=self.stack.original_config_version,[0m
[30;1m277 | [0m[35m        )[0m
[30;1m278 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1107[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m239 | [0m[35m        self._check_bucket_existence()[0m
[30;1m240 | [0m[35m        try:[0m
[30;1m241 | [0m[35m            return self.bucket.get_config([0m
[30;1m242 | [0m[35m                version_id=config_version, config_name=PCLUSTER_S3_ARTIFACTS_DICT.get("source_config[0m
[30;1m243 | [0m[35m            )[0m
[30;1m244 | [0m[35m        except Exception as e:[0m
[30;1m245 | [0m[35m            raise _cluster_error_mapper([0m

[31m--[ [0m[34mMatch #[0m[33m1108[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m228 | [0m[35m            [[0m
[30;1m229 | [0m[35m                PCLUSTER_S3_ARTIFACTS_DICT.get("root_directory"),[0m
[30;1m230 | [0m[35m                get_installed_version(),[0m
[30;1m231 | [0m[35m                PCLUSTER_S3_ARTIFACTS_DICT.get("root_cluster_directory"),[0m
[30;1m232 | [0m[35m                service_directory,[0m
[30;1m233 | [0m[35m            ][0m
[30;1m234 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1109[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m226 | [0m[35m        service_directory = generate_random_name_with_prefix(self.name)[0m
[30;1m227 | [0m[35m        self.__s3_artifact_dir = "/".join([0m
[30;1m228 | [0m[35m            [[0m
[30;1m229 | [0m[35m                PCLUSTER_S3_ARTIFACTS_DICT.get("root_directory"),[0m
[30;1m230 | [0m[35m                get_installed_version(),[0m
[30;1m231 | [0m[35m                PCLUSTER_S3_ARTIFACTS_DICT.get("root_cluster_directory"),[0m
[30;1m232 | [0m[35m                service_directory,[0m

[31m--[ [0m[34mMatch #[0m[33m1110[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m966 | [0m[35m            raise e[0m
[30;1m967 | [0m[35m        except Exception as e:[0m
[30;1m968 | [0m[35m            LOGGER.critical(e)[0m
[30;1m969 | [0m[35m            raise _cluster_error_mapper(e, f"Cluster update failed.\n{e}")[0m
[30;1m970 | [0m[35m[0m
[30;1m971 | [0m[35m    def _add_tags(self):[0m
[30;1m972 | [0m[35m        """Add tags PCLUSTER_CLUSTER_NAME_TAG and PCLUSTER_VERSION_TAG to the attribute config.tags.[0m

[31m--[ [0m[34mMatch #[0m[33m1111[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m909 | [0m[35m[0m
[30;1m910 | [0m[35m        raises ClusterActionError: in case of generic error[0m
[30;1m911 | [0m[35m        raises ConfigValidationError: if configuration is invalid[0m
[30;1m912 | [0m[35m        raises ClusterUpdateError: if update is not allowed[0m
[30;1m913 | [0m[35m        """[0m
[30;1m914 | [0m[35m        start_cdk_import()[0m
[30;1m915 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m1112[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m905 | [0m[35m        force: bool = False,[0m
[30;1m906 | [0m[35m    ):[0m
[30;1m907 | [0m[35m        """[0m
[30;1m908 | [0m[35m        Update cluster.[0m
[30;1m909 | [0m[35m[0m
[30;1m910 | [0m[35m        raises ClusterActionError: in case of generic error[0m
[30;1m911 | [0m[35m        raises ConfigValidationError: if configuration is invalid[0m

[31m--[ [0m[34mMatch #[0m[33m1113[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m891 | [0m[35m[0m
[30;1m892 | [0m[35m    def _validate_stack_status_not_in_progress(self):[0m
[30;1m893 | [0m[35m        if "IN_PROGRESS" in self.stack.status:[0m
[30;1m894 | [0m[35m            raise ConflictClusterActionError(f"Cannot execute update while stack is in {self.stack.s[0m
[30;1m895 | [0m[35m[0m
[30;1m896 | [0m[35m    def _validate_cluster_exists(self):[0m
[30;1m897 | [0m[35m        if not AWSApi.instance().cfn.stack_exists(self.stack_name):[0m

[31m--[ [0m[34mMatch #[0m[33m1114[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m864 | [0m[35m        validation_failure_level: FailureLevel = FailureLevel.ERROR,[0m
[30;1m865 | [0m[35m        force: bool = False,[0m
[30;1m866 | [0m[35m    ):[0m
[30;1m867 | [0m[35m        """Validate a cluster update request."""[0m
[30;1m868 | [0m[35m        self._validate_cluster_exists()[0m
[30;1m869 | [0m[35m        self._validate_stack_status_not_in_progress()[0m
[30;1m870 | [0m[35m        target_config, ignored_validation_failures = self._validate_and_parse_config([0m

[31m--[ [0m[34mMatch #[0m[33m1115[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m837 | [0m[35m                self.stop_compute_fleet()[0m
[30;1m838 | [0m[35m        except ComputeFleetStatusManager.ConditionalStatusUpdateFailed:[0m
[30;1m839 | [0m[35m            raise BadRequestClusterActionError([0m
[30;1m840 | [0m[35m                "Failed when stopping compute fleet due to a concurrent update of the status. "[0m
[30;1m841 | [0m[35m                "Please retry the operation."[0m
[30;1m842 | [0m[35m            )[0m
[30;1m843 | [0m[35m        except Exception as e:[0m

[31m--[ [0m[34mMatch #[0m[33m1116[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m795 | [0m[35m                self.start_compute_fleet()[0m
[30;1m796 | [0m[35m        except ComputeFleetStatusManager.ConditionalStatusUpdateFailed:[0m
[30;1m797 | [0m[35m            raise BadRequestClusterActionError([0m
[30;1m798 | [0m[35m                "Failed when starting compute fleet due to a concurrent update of the status. "[0m
[30;1m799 | [0m[35m                "Please retry the operation."[0m
[30;1m800 | [0m[35m            )[0m
[30;1m801 | [0m[35m        except Exception as e:[0m

[31m--[ [0m[34mMatch #[0m[33m1117[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m663 | [0m[35m            self._wait_for_stack_update()[0m
[30;1m664 | [0m[35m        except AWSClientError as e:[0m
[30;1m665 | [0m[35m            if "no updates are to be performed" in str(e).lower():[0m
[30;1m666 | [0m[35m                return  # If updated_template was the same as the stack's current one, consider the [0m
[30;1m667 | [0m[35m            raise e[0m
[30;1m668 | [0m[35m[0m
[30;1m669 | [0m[35m    def _wait_for_stack_update(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1118[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m330 | [0m[35m            # get custom_s3_bucket in create command[0m
[30;1m331 | [0m[35m            custom_bucket_name = self.config.custom_s3_bucket[0m
[30;1m332 | [0m[35m        else:[0m
[30;1m333 | [0m[35m            # get custom_s3_bucket in delete, update commands[0m
[30;1m334 | [0m[35m            custom_bucket_name = self.stack.s3_bucket_name[0m
[30;1m335 | [0m[35m            if custom_bucket_name == S3Bucket.get_bucket_name(AWSApi.instance().sts.get_account_id()[0m
[30;1m336 | [0m[35m                custom_bucket_name = None[0m

[31m--[ [0m[34mMatch #[0m[33m1119[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35mclass ClusterUpdateError(ClusterActionError, BadRequest):[0m
[30;1m109 | [0m[35m    """Represent an error during the update of the cluster."""[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    def __init__(self, message: str, update_changes: list):[0m
[30;1m112 | [0m[35m        super().__init__(message)[0m

[31m--[ [0m[34mMatch #[0m[33m1120[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1121[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1148 | [0m[35m[0m
[30;1m1149 | [0m[35m        :param log_stream_name: Log stream name[0m
[30;1m1150 | [0m[35m        :param start_time: Start time of interval of interest for log events. ISO 8601 format: YYYY-[0m
[30;1m1151 | [0m[35m        :param end_time: End time of interval of interest for log events. ISO 8601 format: YYYY-MM-D[0m
[30;1m1152 | [0m[35m        :param start_from_head: If the value is true, the earliest log events are returned first.[0m
[30;1m1153 | [0m[35m            If the value is false, the latest log events are returned first. The default value is fa[0m
[30;1m1154 | [0m[35m        :param limit: The maximum number of log events returned. If you don't specify a value,[0m

[31m--[ [0m[34mMatch #[0m[33m1122[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1147 | [0m[35m        Get the log stream events.[0m
[30;1m1148 | [0m[35m[0m
[30;1m1149 | [0m[35m        :param log_stream_name: Log stream name[0m
[30;1m1150 | [0m[35m        :param start_time: Start time of interval of interest for log events. ISO 8601 format: YYYY-[0m
[30;1m1151 | [0m[35m        :param end_time: End time of interval of interest for log events. ISO 8601 format: YYYY-MM-D[0m
[30;1m1152 | [0m[35m        :param start_from_head: If the value is true, the earliest log events are returned first.[0m
[30;1m1153 | [0m[35m            If the value is false, the latest log events are returned first. The default value is fa[0m

[31m--[ [0m[34mMatch #[0m[33m1123[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1006 | [0m[35m               also serves as top-level directory in resulting archive[0m
[30;1m1007 | [0m[35m        :param keep_s3_objects: Keep the exported objects exports to S3. The default behavior is to [0m
[30;1m1008 | [0m[35m        :param start_time: Start time of interval of interest for log events. ISO 8601 format: YYYY-[0m
[30;1m1009 | [0m[35m        :param end_time: End time of interval of interest for log events. ISO 8601 format: YYYY-MM-D[0m
[30;1m1010 | [0m[35m        :param filters: Filters in the format ["Name=name,Values=value1,value2"][0m
[30;1m1011 | [0m[35m               Accepted filters are: private_dns_name, node_type==HeadNode[0m
[30;1m1012 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1124[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1005 | [0m[35m bucket_prefix: Key path under which exported logs data will be stored in s3 bucket,[0m
[30;1m1006 | [0m[35m               also serves as top-level directory in resulting archive[0m
[30;1m1007 | [0m[35m        :param keep_s3_objects: Keep the exported objects exports to S3. The default behavior is to [0m
[30;1m1008 | [0m[35m        :param start_time: Start time of interval of interest for log events. ISO 8601 format: YYYY-[0m
[30;1m1009 | [0m[35m        :param end_time: End time of interval of interest for log events. ISO 8601 format: YYYY-MM-D[0m
[30;1m1010 | [0m[35m        :param filters: Filters in the format ["Name=name,Values=value1,value2"][0m

[31m--[ [0m[34mMatch #[0m[33m1125[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m735 | [0m[35m    def describe_instances([0m
[30;1m736 | [0m[35m        self, node_type: NodeType = None, next_token: str = None, queue_name: str = None[0m
[30;1m737 | [0m[35m    ) -> Tuple[List[ClusterInstance], str]:[0m
[30;1m738 | [0m[35m        """Return the cluster instances filtered by node type."""[0m
[30;1m739 | [0m[35m        try:[0m
[30;1m740 | [0m[35m            filters = self._get_instance_filters(node_type, queue_name)[0m
[30;1m741 | [0m[35m            instances, token = AWSApi.instance().ec2.describe_instances(filters, next_token)[0m

[31m--[ [0m[34mMatch #[0m[33m1126[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m719 | [0m[35m        if instances:[0m
[30;1m720 | [0m[35m            return instances[0m
[30;1m721 | [0m[35m        else:[0m
[30;1m722 | [0m[35m            raise ClusterActionError("Unable to retrieve login node information.")[0m
[30;1m723 | [0m[35m[0m
[30;1m724 | [0m[35m    def _get_instance_filters(self, node_type: NodeType, queue_name: str = None):[0m
[30;1m725 | [0m[35m        filters = [[0m

[31m--[ [0m[34mMatch #[0m[33m1127[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m714 | [0m[35m[0m
[30;1m715 | [0m[35m    @property[0m
[30;1m716 | [0m[35m    def login_node_instances(self) -> List[ClusterInstance]:[0m
[30;1m717 | [0m[35m        """Get login node instances."""[0m
[30;1m718 | [0m[35m        instances, _ = self.describe_instances(node_type=NodeType.LOGIN_NODE)[0m
[30;1m719 | [0m[35m        if instances:[0m
[30;1m720 | [0m[35m            return instances[0m

[31m--[ [0m[34mMatch #[0m[33m1128[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m710 | [0m[35m        if instances:[0m
[30;1m711 | [0m[35m            return instances[0][0m
[30;1m712 | [0m[35m        else:[0m
[30;1m713 | [0m[35m            raise ClusterActionError("Unable to retrieve head node information.")[0m
[30;1m714 | [0m[35m[0m
[30;1m715 | [0m[35m    @property[0m
[30;1m716 | [0m[35m    def login_node_instances(self) -> List[ClusterInstance]:[0m

[31m--[ [0m[34mMatch #[0m[33m1129[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m705 | [0m[35m[0m
[30;1m706 | [0m[35m    @property[0m
[30;1m707 | [0m[35m    def head_node_instance(self) -> ClusterInstance:[0m
[30;1m708 | [0m[35m        """Get head node instance."""[0m
[30;1m709 | [0m[35m        instances, _ = self.describe_instances(node_type=NodeType.HEAD_NODE)[0m
[30;1m710 | [0m[35m        if instances:[0m
[30;1m711 | [0m[35m            return instances[0][0m

[31m--[ [0m[34mMatch #[0m[33m1130[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m213 | [0m[35m        except AWSClientError as e:[0m
[30;1m214 | [0m[35m            LOGGER.error("No artifact dir found in cluster stack output.")[0m
[30;1m215 | [0m[35m            raise _cluster_error_mapper([0m
[30;1m216 | [0m[35m                e, f"Unable to find artifact dir in cluster stack {self.stack_name} output. {e}"[0m
[30;1m217 | [0m[35m            )[0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m    def _generate_artifact_dir(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1131[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35mclass NodeType(Enum):[0m
[30;1m83 | [0m[35m    """Enum that identifies the cluster node type."""[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    HEAD_NODE = "HeadNode"[0m
[30;1m86 | [0m[35m    COMPUTE = "Compute"[0m

[31m--[ [0m[34mMatch #[0m[33m1132[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/cluster.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35mimport logging[0m
[30;1m17 | [0m[35mimport os[0m
[30;1m18 | [0m[35mimport tempfile[0m
[30;1m19 | [0m[35mimport time[0m
[30;1m20 | [0m[35mfrom copy import deepcopy[0m
[30;1m21 | [0m[35mfrom datetime import datetime[0m
[30;1m22 | [0m[35mfrom enum import Enum[0m
[30;1m23 | [0m[35mfrom typing import List, Optional, Set, Tuple[0m

[31m--[ [0m[34mMatch #[0m[33m1133[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/import_cdk.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mfrom threading import Thread[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mLOGGER = logging.getLogger(__name__)[0m
[30;1m6 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1134[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/command.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2013-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the 'License'). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the 'LICENSE.txt' file accompanying this file. This file is distributed on an 'AS IS' BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1135[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/imagebuilder_config.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1136[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/delete_image_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m        # retrieve environment[0m
[30;1m60 | [0m[35m        stack_arn = os.environ.get("IMAGE_STACK_ARN")[0m
[30;1m61 | [0m[35m        aws_region = os.environ.get("AWS_REGION")[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        # convert the event message to json[0m
[30;1m64 | [0m[35m        message_json = json.loads(event_message)[0m

[31m--[ [0m[34mMatch #[0m[33m1137[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/delete_image_stack.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m        logger.info("Printing event message: %s", json.dumps(event_message))[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m        # retrieve environment[0m
[30;1m60 | [0m[35m        stack_arn = os.environ.get("IMAGE_STACK_ARN")[0m
[30;1m61 | [0m[35m        aws_region = os.environ.get("AWS_REGION")[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        # convert the event message to json[0m

[31m--[ [0m[34mMatch #[0m[33m1138[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/delete_image_stack.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m#  the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1139[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m        new_param = {"name": to_kebab_case(param_name), "body": True, "required": param_name in requ[0m
[30;1m79 | [0m[35m        copy_keys = {"description", "type", "enum", "pattern"}[0m
[30;1m80 | [0m[35m        new_param.update({k: v for k, v in param_data.items() if k in copy_keys})[0m
[30;1m81 | [0m[35m        if param_data.get("format", None) == "byte":[0m
[30;1m82 | [0m[35m            new_param["type"] = "byte"[0m
[30;1m83 | [0m[35m        new_param.update(_param_overrides(operation, param_name))[0m
[30;1m84 | [0m[35m        new_params.append(new_param)[0m

[31m--[ [0m[34mMatch #[0m[33m1140[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/model.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35mdef _resolve_body(spec, operation):[0m
[30;1m71 | [0m[35m    body_content = _resolve_ref(spec, operation["requestBody"]["content"]["application/json"]["schem[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    required = set(body_content.get("required", []))[0m
[30;1m74 | [0m[35m    new_params = [][0m
[30;1m75 | [0m[35m    for param_name, param_data in body_content["properties"].items():[0m
[30;1m76 | [0m[35m        _resolve_ref(spec, param_data)[0m

[31m--[ [0m[34mMatch #[0m[33m1141[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/model.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not[0m
[30;1m4 | [0m[35m# use this file except in compliance with the License. A copy of the License is[0m
[30;1m5 | [0m[35m# located at[0m
[30;1m6 | [0m[35m#[0m
[30;1m7 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m8 | [0m[35m#[0m
[30;1m9 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed[0m

[31m--[ [0m[34mMatch #[0m[33m1142[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/upload-docker-images.sh[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m#!/usr/bin/env bash[0m
[30;1m2 | [0m[35mset -eu[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mpush_docker_image() {[0m
[30;1m5 | [0m[35m    local image=$1[0m

[31m--[ [0m[34mMatch #[0m[33m1143[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/upload-docker-images.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mif [ -z "${IMAGE}" ]; then[0m
[30;1m20 | [0m[35m    find "$(pwd)" -type f -name Dockerfile -print0 | while read -d $'\0' file; do[0m
[30;1m21 | [0m[35m        IMAGE_TAG=$(dirname "${file}" | xargs basename)[0m
[30;1m22 | [0m[35m        push_docker_image "${IMAGE_TAG}"[0m
[30;1m23 | [0m[35m    done[0m
[30;1m24 | [0m[35melse[0m

[31m--[ [0m[34mMatch #[0m[33m1144[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/upload-docker-images.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35m}[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mif [ -z "${IMAGE}" ]; then[0m
[30;1m20 | [0m[35m    find "$(pwd)" -type f -name Dockerfile -print0 | while read -d $'\0' file; do[0m
[30;1m21 | [0m[35m        IMAGE_TAG=$(dirname "${file}" | xargs basename)[0m
[30;1m22 | [0m[35m        push_docker_image "${IMAGE_TAG}"[0m
[30;1m23 | [0m[35m    done[0m

[31m--[ [0m[34mMatch #[0m[33m1145[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/upload-docker-images.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m        aws_domain="sc2s.sgov.gov"[0m
[30;1m14 | [0m[35m    fi[0m
[30;1m15 | [0m[35m    docker tag "${IMAGE_REPO_NAME}:${image}" "${AWS_ACCOUNT_ID}.dkr.ecr.${AWS_REGION}.${aws_domain}/[0m
[30;1m16 | [0m[35m    docker push "${AWS_ACCOUNT_ID}.dkr.ecr.${AWS_REGION}.${aws_domain}/${IMAGE_REPO_NAME}:${image}"[0m
[30;1m17 | [0m[35m}[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mif [ -z "${IMAGE}" ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1146[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/upload-docker-images.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m    elif [[ ${AWS_REGION} == us-isob-* ]]; then[0m
[30;1m13 | [0m[35m        aws_domain="sc2s.sgov.gov"[0m
[30;1m14 | [0m[35m    fi[0m
[30;1m15 | [0m[35m    docker tag "${IMAGE_REPO_NAME}:${image}" "${AWS_ACCOUNT_ID}.dkr.ecr.${AWS_REGION}.${aws_domain}/[0m
[30;1m16 | [0m[35m    docker push "${AWS_ACCOUNT_ID}.dkr.ecr.${AWS_REGION}.${aws_domain}/${IMAGE_REPO_NAME}:${image}"[0m
[30;1m17 | [0m[35m}[0m
[30;1m18 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1147[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/upload-docker-images.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m#!/usr/bin/env bash[0m
[30;1m2 | [0m[35mset -eu[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mpush_docker_image() {[0m
[30;1m5 | [0m[35m    local image=$1[0m

[31m--[ [0m[34mMatch #[0m[33m1148[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_compute_fleet_controller.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m84 | [0m[35m            # False positive since it is not a SQL query.[0m
[30;1m85 | [0m[35m            # [B608:hardcoded_sql_expressions] Possible SQL injection vector through string-based qu[0m
[30;1m86 | [0m[35m            raise BadRequestException([0m
[30;1m87 | [0m[35m                "the update compute fleet status can only be set to"  # nosec B608[0m
[30;1m88 | [0m[35m                " `START_REQUESTED` or `STOP_REQUESTED` for %s scheduler clusters."[0m
[30;1m89 | [0m[35m                % cluster.stack.scheduler.capitalize()[0m
[30;1m90 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1149[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_compute_fleet_controller.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m71 | [0m[35m            cluster.stop()[0m
[30;1m72 | [0m[35m        else:[0m
[30;1m73 | [0m[35m            raise BadRequestException([0m
[30;1m74 | [0m[35m                "the update compute fleet status can only be set to"[0m
[30;1m75 | [0m[35m                " `ENABLED` or `DISABLED` for AWS Batch scheduler clusters."[0m
[30;1m76 | [0m[35m            )[0m
[30;1m77 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m1150[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_compute_fleet_controller.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m46 | [0m[35m@convert_errors()[0m
[30;1m47 | [0m[35mdef update_compute_fleet(update_compute_fleet_request_content, cluster_name, region=None):[0m
[30;1m48 | [0m[35m    """[0m
[30;1m49 | [0m[35m        Update the status of the cluster compute fleet.[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    request_content:[0m
[30;1m52 | [0m[35m        :type update_compute_fleet_request_content: dict | bytes[0m

[31m--[ [0m[34mMatch #[0m[33m1151[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/controllers/cluster_compute_fleet_controller.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1152[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/compute_fleet_status_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m255 | [0m[35m                raise Exception("COMPUTE_FLEET status not found in db table")[0m
[30;1m256 | [0m[35m            return ([0m
[30;1m257 | [0m[35m                ComputeFleetStatus(compute_fleet_status["Item"][self.COMPUTE_FLEET_STATUS_ATTRIBUTE][0m
[30;1m258 | [0m[35m                compute_fleet_status["Item"].get(self.LAST_UPDATED_TIME_ATTRIBUTE),[0m
[30;1m259 | [0m[35m            )[0m
[30;1m260 | [0m[35m        except Exception as e:[0m
[30;1m261 | [0m[35m            LOGGER.warning([0m

[31m--[ [0m[34mMatch #[0m[33m1153[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/compute_fleet_status_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m192 | [0m[35m                ComputeFleetStatus([0m
[30;1m193 | [0m[35m                    compute_fleet_item["Item"].get(self.DB_DATA).get(self.COMPUTE_FLEET_STATUS_ATTRI[0m
[30;1m194 | [0m[35m                ),[0m
[30;1m195 | [0m[35m                compute_fleet_item["Item"].get(self.DB_DATA).get(self.COMPUTE_FLEET_LAST_UPDATED_TIM[0m
[30;1m196 | [0m[35m            )[0m
[30;1m197 | [0m[35m        except Exception as e:[0m
[30;1m198 | [0m[35m            LOGGER.warning([0m

[31m--[ [0m[34mMatch #[0m[33m1154[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/compute_fleet_status_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m192 | [0m[35m                ComputeFleetStatus([0m
[30;1m193 | [0m[35m                    compute_fleet_item["Item"].get(self.DB_DATA).get(self.COMPUTE_FLEET_STATUS_ATTRI[0m
[30;1m194 | [0m[35m                ),[0m
[30;1m195 | [0m[35m                compute_fleet_item["Item"].get(self.DB_DATA).get(self.COMPUTE_FLEET_LAST_UPDATED_TIM[0m
[30;1m196 | [0m[35m            )[0m
[30;1m197 | [0m[35m        except Exception as e:[0m
[30;1m198 | [0m[35m            LOGGER.warning([0m

[31m--[ [0m[34mMatch #[0m[33m1155[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/compute_fleet_status_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m190 | [0m[35m                raise Exception("COMPUTE_FLEET data not found in db table")[0m
[30;1m191 | [0m[35m            return ([0m
[30;1m192 | [0m[35m                ComputeFleetStatus([0m
[30;1m193 | [0m[35m                    compute_fleet_item["Item"].get(self.DB_DATA).get(self.COMPUTE_FLEET_STATUS_ATTRI[0m
[30;1m194 | [0m[35m                ),[0m
[30;1m195 | [0m[35m                compute_fleet_item["Item"].get(self.DB_DATA).get(self.COMPUTE_FLEET_LAST_UPDATED_TIM[0m
[30;1m196 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1156[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/compute_fleet_status_manager.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m190 | [0m[35m                raise Exception("COMPUTE_FLEET data not found in db table")[0m
[30;1m191 | [0m[35m            return ([0m
[30;1m192 | [0m[35m                ComputeFleetStatus([0m
[30;1m193 | [0m[35m                    compute_fleet_item["Item"].get(self.DB_DATA).get(self.COMPUTE_FLEET_STATUS_ATTRI[0m
[30;1m194 | [0m[35m                ),[0m
[30;1m195 | [0m[35m                compute_fleet_item["Item"].get(self.DB_DATA).get(self.COMPUTE_FLEET_LAST_UPDATED_TIM[0m
[30;1m196 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1157[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/compute_fleet_status_manager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35mclass PlainTextComputeFleetStatusManager(ComputeFleetStatusManager):[0m
[30;1m233 | [0m[35m    """Implement functionalities to retrieve and update the compute fleet status for Slurm.[0m
[30;1m234 | [0m[35m[0m
[30;1m235 | [0m[35m    The value stored in the table is a plain text value, e.g.[0m
[30;1m236 | [0m[35m    STOPPING[0m

[31m--[ [0m[34mMatch #[0m[33m1158[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/compute_fleet_status_manager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35mclass JsonComputeFleetStatusManager(ComputeFleetStatusManager):[0m
[30;1m160 | [0m[35m    """[0m
[30;1m161 | [0m[35m    Implement functionalities to retrieve and update the compute fleet status.[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    The value stored in the table is a json in the following form[0m
[30;1m164 | [0m[35m    {[0m

[31m--[ [0m[34mMatch #[0m[33m1159[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/compute_fleet_status_manager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m        if compute_fleet_status != final_status:[0m
[30;1m127 | [0m[35m            raise Exception([0m
[30;1m128 | [0m[35m                "Unexpected final state {} probably due to a concurrent status update request.".form[0m
[30;1m129 | [0m[35m                    compute_fleet_status[0m
[30;1m130 | [0m[35m                )[0m
[30;1m131 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1160[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/compute_fleet_status_manager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m115 | [0m[35m            LOGGER.info("Please run 'pcluster status' if you need to check compute fleet status")[0m
[30;1m116 | [0m[35m            return[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m        LOGGER.info("Submitted compute fleet status transition request. Waiting for status update to[0m
[30;1m119 | [0m[35m        compute_fleet_status = self._wait_for_status_transition(wait_on_status=request_status, timeo[0m
[30;1m120 | [0m[35m        if compute_fleet_status == in_progress_status:[0m
[30;1m121 | [0m[35m            LOGGER.info([0m

[31m--[ [0m[34mMatch #[0m[33m1161[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/compute_fleet_status_manager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m    def update_status(self, request_status, in_progress_status, final_status, wait_transition=False)[0m
[30;1m95 | [0m[35m        """[0m
[30;1m96 | [0m[35m        Update the status of the compute fleet and wait for a status transition.[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m        It updates the status of the fleet to request_status and then waits for it to be updated to [0m
[30;1m99 | [0m[35m        by eventually transitioning through in_progress_status[0m

[31m--[ [0m[34mMatch #[0m[33m1162[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/compute_fleet_status_manager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35mclass ComputeFleetStatusManager(metaclass=ABCMeta):[0m
[30;1m67 | [0m[35m    """Implement functionalities to retrieve and update the compute fleet status."""[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m    class ConditionalStatusUpdateFailed(Exception):[0m
[30;1m70 | [0m[35m        """Raised when there is a failure in updating the status due to a change occurred after retr[0m

[31m--[ [0m[34mMatch #[0m[33m1163[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/compute_fleet_status_manager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2020 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1164[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/compute_fleet_status_manager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35m    @staticmethod[0m
[30;1m155 | [0m[35m    def _timeout_expired(start_time, timeout):[0m
[30;1m156 | [0m[35m        return (time.time() - start_time) > timeout[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35mclass JsonComputeFleetStatusManager(ComputeFleetStatusManager):[0m
[30;1m160 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1165[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/compute_fleet_status_manager.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m10 | [0m[35m# limitations under the License.[0m
[30;1m11 | [0m[35mimport logging[0m
[30;1m12 | [0m[35mimport time[0m
[30;1m13 | [0m[35mfrom abc import ABCMeta, abstractmethod[0m
[30;1m14 | [0m[35mfrom datetime import datetime, timezone[0m
[30;1m15 | [0m[35mfrom enum import Enum[0m
[30;1m16 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1166[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m191 | [0m[35mif [ "${Timeout}" == "NONE" ]; then[0m
[30;1m192 | [0m[35m  /tmp/bootstrap.sh[0m
[30;1m193 | [0m[35melse[0m
[30;1m194 | [0m[35m  timeout ${Timeout} /tmp/bootstrap.sh || error_exit[0m
[30;1m195 | [0m[35mfi[0m
[30;1m196 | [0m[35m--==BOUNDARY==[0m

[31m--[ [0m[34mMatch #[0m[33m1167[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m165 | [0m[35m      } || error_exit 'Failed to run bootstrap recipes. Please check /var/log/chef-client.log in the[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m      if [ ! -f /opt/parallelcluster/.bootstrapped ]; then[0m
[30;1m168 | [0m[35m        echo ${!cookbook_version} | tee /opt/parallelcluster/.bootstrapped[0m
[30;1m169 | [0m[35m      fi[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m      end=$(date +%s)[0m

[31m--[ [0m[34mMatch #[0m[33m1168[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m162 | [0m[35m        ${!FR_CMD} -postinstall &&[0m
[30;1m163 | [0m[35m        ${!CINC_CMD} aws-parallelcluster-entrypoints::finalize &&[0m
[30;1m164 | [0m[35m        popd[0m
[30;1m165 | [0m[35m      } || error_exit 'Failed to run bootstrap recipes. Please check /var/log/chef-client.log in the[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m      if [ ! -f /opt/parallelcluster/.bootstrapped ]; then[0m
[30;1m168 | [0m[35m        echo ${!cookbook_version} | tee /opt/parallelcluster/.bootstrapped[0m

[31m--[ [0m[34mMatch #[0m[33m1169[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m151 | [0m[35m      touch /etc/chef/ohai/hints/ec2.json[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m      start=$(date +%s)[0m
[30;1m154 | [0m[35m      jq -s ".[0] * .[1]" /tmp/dna.json /tmp/extra.json > /etc/chef/dna.json || ( echo "jq not insta[0m
[30;1m155 | [0m[35m      {[0m
[30;1m156 | [0m[35m        CINC_CMD="cinc-client --local-mode --config /etc/chef/client.rb --log_level info --logfile /[0m
[30;1m157 | [0m[35m        FR_CMD="/opt/parallelcluster/scripts/fetch_and_run"[0m

[31m--[ [0m[34mMatch #[0m[33m1170[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m143 | [0m[35m        error_exit "This AMI was not baked by ParallelCluster. Please use pcluster build-image comma[0m
[30;1m144 | [0m[35m      fi[0m
[30;1m145 | [0m[35m      if [ "${!custom_cookbook}" != "NONE" ]; then[0m
[30;1m146 | [0m[35m        curl --retry 3 -v -L -o /etc/chef/aws-parallelcluster-cookbook.tgz ${!cookbook_url}[0m
[30;1m147 | [0m[35m        vendor_cookbook[0m
[30;1m148 | [0m[35m      fi[0m
[30;1m149 | [0m[35m      cd /tmp[0m

[31m--[ [0m[34mMatch #[0m[33m1171[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m135 | [0m[35m ]; then[0m
[30;1m136 | [0m[35m        installed_version=$(cat /opt/parallelcluster/.bootstrapped)[0m
[30;1m137 | [0m[35m        if [ "${!cookbook_version}" != "${!installed_version}" ]; then[0m
[30;1m138 | [0m[35m          cookbook_version_number=$(echo ${!cookbook_version} | awk -F- '{print $NF}')[0m
[30;1m139 | [0m[35m          installed_version_number=$(echo ${!installed_version} | awk -F- '{print $NF}')[0m

[31m--[ [0m[34mMatch #[0m[33m1172[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m134 | [0m[35mrt berkshelf_version=${BerkshelfVersion}[0m
[30;1m135 | [0m[35m      if [ -f /opt/parallelcluster/.bootstrapped ]; then[0m
[30;1m136 | [0m[35m        installed_version=$(cat /opt/parallelcluster/.bootstrapped)[0m
[30;1m137 | [0m[35m        if [ "${!cookbook_version}" != "${!installed_version}" ]; then[0m
[30;1m138 | [0m[35m          cookbook_version_number=$(echo ${!cookbook_version} | awk -F- '{print $NF}')[0m
[30;1m139 | [0m[35m          installed_version_number=$(echo ${!installed_version} | awk -F- '{print $NF}')[0m

[31m--[ [0m[34mMatch #[0m[33m1173[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m      s3_url=${AWS::URLSuffix}[0m
[30;1m118 | [0m[35m      if [ "${!custom_cookbook}" != "NONE" ]; then[0m
[30;1m119 | [0m[35m        if [[ "${!custom_cookbook}" =~ ^s3://([^/]*)(.*) ]]; then[0m
[30;1m120 | [0m[35m          # Socket timeout = 15s; the actual timeout is 8*(cli-connect-timeout), so (15s*8)*3retries[0m
[30;1m121 | [0m[35m          S3API_RESULT=$(AWS_RETRY_MODE=standard aws s3api get-bucket-location --cli-connect-timeout[0m
[30;1m122 | [0m[35m          bucket_region=$(echo "${!S3API_RESULT}" | jq -r '.LocationConstraint')[0m
[30;1m123 | [0m[35m          if [[ "${!bucket_region}" == null ]]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1174[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m      s3_url=${AWS::URLSuffix}[0m
[30;1m118 | [0m[35m      if [ "${!custom_cookbook}" != "NONE" ]; then[0m
[30;1m119 | [0m[35m        if [[ "${!custom_cookbook}" =~ ^s3://([^/]*)(.*) ]]; then[0m
[30;1m120 | [0m[35m          # Socket timeout = 15s; the actual timeout is 8*(cli-connect-timeout), so (15s*8)*3retries[0m
[30;1m121 | [0m[35m          S3API_RESULT=$(AWS_RETRY_MODE=standard aws s3api get-bucket-location --cli-connect-timeout[0m
[30;1m122 | [0m[35m          bucket_region=$(echo "${!S3API_RESULT}" | jq -r '.LocationConstraint')[0m
[30;1m123 | [0m[35m          if [[ "${!bucket_region}" == null ]]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1175[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m94 | [0m[35m      {[0m
[30;1m95 | [0m[35m        start_time=$1[0m
[30;1m96 | [0m[35m        end_time=$2[0m
[30;1m97 | [0m[35m        # Only put the startup time data if the scheduler is slurm[0m
[30;1m98 | [0m[35m        slurm_node_path=/etc/parallelcluster/slurm_plugin/slurm_node_spec.json[0m
[30;1m99 | [0m[35m        if test -f "$slurm_node_path"; then[0m
[30;1m100 | [0m[35m            INSTANCE_ID=$(cat $slurm_node_path | jq -r .instance_id)[0m

[31m--[ [0m[34mMatch #[0m[33m1176[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m80 | [0m[35m      {[0m
[30;1m81 | [0m[35m        mkdir /tmp/cookbooks[0m
[30;1m82 | [0m[35m        cd /tmp/cookbooks[0m
[30;1m83 | [0m[35m        tar -xzf /etc/chef/aws-parallelcluster-cookbook.tgz[0m
[30;1m84 | [0m[35m        HOME_BAK="${!HOME}"[0m
[30;1m85 | [0m[35m        export HOME="/tmp"[0m
[30;1m86 | [0m[35m        for d in `ls /tmp/cookbooks`; do[0m

[31m--[ [0m[34mMatch #[0m[33m1177[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m49 | [0m[35mdatasource_list: [ Ec2, None ][0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35moutput:[0m
[30;1m52 | [0m[35m  all: "| tee -a /var/log/cloud-init-output.log | logger -t user-data -s 2>/dev/ttyS0"[0m
[30;1m53 | [0m[35mwrite_files:[0m
[30;1m54 | [0m[35m  - path: /tmp/dna.json[0m
[30;1m55 | [0m[35m    permissions: '0644'[0m

[31m--[ [0m[34mMatch #[0m[33m1178[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35mMIME-Version: 1.0[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35mbootcmd:[0m
[30;1m43 | [0m[35m  - if [ "${DisableMultiThreadingManually}" = "true" ]; then for cpunum in $(cat /sys/devices/system[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35mpackage_update: false[0m
[30;1m46 | [0m[35mpackage_upgrade: false[0m

[31m--[ [0m[34mMatch #[0m[33m1179[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35mMIME-Version: 1.0[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35mbootcmd:[0m
[30;1m43 | [0m[35m  - if [ "${DisableMultiThreadingManually}" = "true" ]; then for cpunum in $(cat /sys/devices/system[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35mpackage_update: false[0m
[30;1m46 | [0m[35mpackage_upgrade: false[0m

[31m--[ [0m[34mMatch #[0m[33m1180[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m  proxy_host=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f1)[0m
[30;1m26 | [0m[35m  proxy_port=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f2)[0m
[30;1m27 | [0m[35m  echo -e "[Boto]\nproxy = ${!proxy_host}\nproxy_port = ${!proxy_port}\n" >/etc/boto.cfg[0m
[30;1m28 | [0m[35m  cat >> /etc/profile.d/proxy.sh <<PROXY[0m
[30;1m29 | [0m[35mexport http_proxy="${!proxy}"[0m
[30;1m30 | [0m[35mexport https_proxy="${!proxy}"[0m
[30;1m31 | [0m[35mexport no_proxy="localhost,127.0.0.1,169.254.169.254"[0m

[31m--[ [0m[34mMatch #[0m[33m1181[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35mproxy=${ProxyServer}[0m
[30;1m24 | [0m[35mif [ "${!proxy}" != "NONE" ]; then[0m
[30;1m25 | [0m[35m  proxy_host=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f1)[0m
[30;1m26 | [0m[35m  proxy_port=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f2)[0m
[30;1m27 | [0m[35m  echo -e "[Boto]\nproxy = ${!proxy_host}\nproxy_port = ${!proxy_port}\n" >/etc/boto.cfg[0m
[30;1m28 | [0m[35m  cat >> /etc/profile.d/proxy.sh <<PROXY[0m
[30;1m29 | [0m[35mexport http_proxy="${!proxy}"[0m

[31m--[ [0m[34mMatch #[0m[33m1182[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35mproxy=${ProxyServer}[0m
[30;1m24 | [0m[35mif [ "${!proxy}" != "NONE" ]; then[0m
[30;1m25 | [0m[35m  proxy_host=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f1)[0m
[30;1m26 | [0m[35m  proxy_port=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f2)[0m
[30;1m27 | [0m[35m  echo -e "[Boto]\nproxy = ${!proxy_host}\nproxy_port = ${!proxy_port}\n" >/etc/boto.cfg[0m
[30;1m28 | [0m[35m  cat >> /etc/profile.d/proxy.sh <<PROXY[0m
[30;1m29 | [0m[35mexport http_proxy="${!proxy}"[0m

[31m--[ [0m[34mMatch #[0m[33m1183[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mproxy=${ProxyServer}[0m
[30;1m24 | [0m[35mif [ "${!proxy}" != "NONE" ]; then[0m
[30;1m25 | [0m[35m  proxy_host=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f1)[0m
[30;1m26 | [0m[35m  proxy_port=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f2)[0m
[30;1m27 | [0m[35m  echo -e "[Boto]\nproxy = ${!proxy_host}\nproxy_port = ${!proxy_port}\n" >/etc/boto.cfg[0m
[30;1m28 | [0m[35m  cat >> /etc/profile.d/proxy.sh <<PROXY[0m

[31m--[ [0m[34mMatch #[0m[33m1184[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mproxy=${ProxyServer}[0m
[30;1m24 | [0m[35mif [ "${!proxy}" != "NONE" ]; then[0m
[30;1m25 | [0m[35m  proxy_host=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f1)[0m
[30;1m26 | [0m[35m  proxy_port=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f2)[0m
[30;1m27 | [0m[35m  echo -e "[Boto]\nproxy = ${!proxy_host}\nproxy_port = ${!proxy_port}\n" >/etc/boto.cfg[0m
[30;1m28 | [0m[35m  cat >> /etc/profile.d/proxy.sh <<PROXY[0m

[31m--[ [0m[34mMatch #[0m[33m1185[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m  echo "Not yum system"[0m
[30;1m19 | [0m[35mfi[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mwhich apt-get && echo "Acquire::http::Proxy \"${AptProxy}\";" >> /etc/apt/apt.conf || echo "Not apt [0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mproxy=${ProxyServer}[0m
[30;1m24 | [0m[35mif [ "${!proxy}" != "NONE" ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1186[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m  echo "Not yum system"[0m
[30;1m19 | [0m[35mfi[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mwhich apt-get && echo "Acquire::http::Proxy \"${AptProxy}\";" >> /etc/apt/apt.conf || echo "Not apt [0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mproxy=${ProxyServer}[0m
[30;1m24 | [0m[35mif [ "${!proxy}" != "NONE" ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1187[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35melif [ "${!yum}" == "0" ]; then[0m
[30;1m16 | [0m[35m  echo "proxy=${YumProxy}" >> /etc/yum.conf[0m
[30;1m17 | [0m[35melse[0m
[30;1m18 | [0m[35m  echo "Not yum system"[0m
[30;1m19 | [0m[35mfi[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mwhich apt-get && echo "Acquire::http::Proxy \"${AptProxy}\";" >> /etc/apt/apt.conf || echo "Not apt [0m

[31m--[ [0m[34mMatch #[0m[33m1188[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35m#!/bin/bash -x[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mwhich dnf 2>/dev/null; dnf=$?[0m
[30;1m11 | [0m[35mwhich yum 2>/dev/null; yum=$?[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mif [ "${!dnf}" == "0" ]; then[0m
[30;1m14 | [0m[35m  echo "proxy=${DnfProxy}" >> /etc/dnf/dnf.conf[0m

[31m--[ [0m[34mMatch #[0m[33m1189[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/compute_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m#!/bin/bash -x[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mwhich dnf 2>/dev/null; dnf=$?[0m
[30;1m11 | [0m[35mwhich yum 2>/dev/null; yum=$?[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mif [ "${!dnf}" == "0" ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1190[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/monitoring_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2023 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1191[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m241 | [0m[35m                apt-get -y --only-upgrade install ca-certificates[0m
[30;1m242 | [0m[35m              fi[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m              curl --retry 3 -L {{ build.CincUrl.outputs.stdout }} | bash -s -- -v {{ ChefVersion }}[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m              if [[ -e ${!CA_CERTS_FILE} ]]; then[0m
[30;1m247 | [0m[35m                mkdir -p /opt/cinc/embedded/ssl/certs[0m

[31m--[ [0m[34mMatch #[0m[33m1192[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m220 | [0m[35m                fi[0m
[30;1m221 | [0m[35m                apt-cache search build-essential[0m
[30;1m222 | [0m[35m                apt-get clean[0m
[30;1m223 | [0m[35m                apt-get -y update[0m
[30;1m224 | [0m[35m                apt-get -y install build-essential curl wget jq[0m
[30;1m225 | [0m[35m              fi[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m      # Install Cinc[0m

[31m--[ [0m[34mMatch #[0m[33m1193[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m203 | [0m[35m                    yum clean all[0m
[30;1m204 | [0m[35m                  fi[0m
[30;1m205 | [0m[35m                fi[0m
[30;1m206 | [0m[35m                yum -y update krb5-libs[0m
[30;1m207 | [0m[35m                yum -y groupinstall development && sudo yum -y install curl wget jq[0m
[30;1m208 | [0m[35m              [0m
[30;1m209 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1194[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m299 | [0m[35m            - |[0m
[30;1m300 | [0m[35m              set -v[0m
[30;1m301 | [0m[35m              echo "Calling chef-client with /etc/parallelcluster/image_dna.json"[0m
[30;1m302 | [0m[35m              cat /etc/parallelcluster/image_dna.json[0m
[30;1m303 | [0m[35m              cinc-client --local-mode --config /etc/chef/client.rb --log_level info --force-formatt[0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m      - name: CreateBootstrapFile[0m

[31m--[ [0m[34mMatch #[0m[33m1195[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m              mkdir -p /tmp/cookbooks[0m
[30;1m270 | [0m[35m              cd /tmp/cookbooks[0m
[30;1m271 | [0m[35m              tar -xzf /etc/chef/aws-parallelcluster-cookbook.tgz[0m
[30;1m272 | [0m[35m[0m
[30;1m273 | [0m[35m              export HOME="/tmp"[0m
[30;1m274 | [0m[35m              for dir in $(ls /tmp/cookbooks); do[0m

[31m--[ [0m[34mMatch #[0m[33m1196[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m264 | [0m[35m              set -v[0m
[30;1m265 | [0m[35m              mkdir -p /etc/chef && sudo chown -R root:root /etc/chef[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35m              curl --retry 3 -L -o /etc/chef/aws-parallelcluster-cookbook.tgz "{{ build.CookbookUrl.[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m              mkdir -p /tmp/cookbooks[0m
[30;1m270 | [0m[35m              cd /tmp/cookbooks[0m

[31m--[ [0m[34mMatch #[0m[33m1197[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m262 | [0m[35m          commands:[0m
[30;1m263 | [0m[35m            - |[0m
[30;1m264 | [0m[35m              set -v[0m
[30;1m265 | [0m[35m              mkdir -p /etc/chef && sudo chown -R root:root /etc/chef[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35m              curl --retry 3 -L -o /etc/chef/aws-parallelcluster-cookbook.tgz "{{ build.CookbookUrl.[0m
[30;1m268 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1198[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m249 | [0m[35m              fi[0m
[30;1m250 | [0m[35m[0m
[30;1m251 | [0m[35m              curl --retry 3 -L -o gems.tgz https://${AWS::Region}-aws-parallelcluster.s3.${AWS::Reg[0m
[30;1m252 | [0m[35m              tar -xf gems.tgz[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m              cd vendor/cache[0m
[30;1m255 | [0m[35m              /opt/cinc/embedded/bin/gem install --no-document minitar:0.9[0m

[31m--[ [0m[34mMatch #[0m[33m1199[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m248 | [0m[35m                ln -sf ${!CA_CERTS_FILE} /opt/cinc/embedded/ssl/certs/cacert.pem[0m
[30;1m249 | [0m[35m              fi[0m
[30;1m250 | [0m[35m[0m
[30;1m251 | [0m[35m              curl --retry 3 -L -o gems.tgz https://${AWS::Region}-aws-parallelcluster.s3.${AWS::Reg[0m
[30;1m252 | [0m[35m              tar -xf gems.tgz[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m              cd vendor/cache[0m

[31m--[ [0m[34mMatch #[0m[33m1200[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m241 | [0m[35m                apt-get -y --only-upgrade install ca-certificates[0m
[30;1m242 | [0m[35m              fi[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m              curl --retry 3 -L {{ build.CincUrl.outputs.stdout }} | bash -s -- -v {{ ChefVersion }}[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m              if [[ -e ${!CA_CERTS_FILE} ]]; then[0m
[30;1m247 | [0m[35m                mkdir -p /opt/cinc/embedded/ssl/certs[0m

[31m--[ [0m[34mMatch #[0m[33m1201[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m241 | [0m[35m                apt-get -y --only-upgrade install ca-certificates[0m
[30;1m242 | [0m[35m              fi[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m              curl --retry 3 -L {{ build.CincUrl.outputs.stdout }} | bash -s -- -v {{ ChefVersion }}[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m              if [[ -e ${!CA_CERTS_FILE} ]]; then[0m
[30;1m247 | [0m[35m                mkdir -p /opt/cinc/embedded/ssl/certs[0m

[31m--[ [0m[34mMatch #[0m[33m1202[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m238 | [0m[35m                yum -y upgrade ca-certificates[0m
[30;1m239 | [0m[35m              elif [[ ${!PLATFORM} == DEBIAN ]]; then[0m
[30;1m240 | [0m[35m                CA_CERTS_FILE=/etc/ssl/certs/ca-certificates.crt[0m
[30;1m241 | [0m[35m                apt-get -y --only-upgrade install ca-certificates[0m
[30;1m242 | [0m[35m              fi[0m
[30;1m243 | [0m[35m[0m
[30;1m244 | [0m[35m              curl --retry 3 -L {{ build.CincUrl.outputs.stdout }} | bash -s -- -v {{ ChefVersion }}[0m

[31m--[ [0m[34mMatch #[0m[33m1203[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m235 | [0m[35m[0m
[30;1m236 | [0m[35m              if [[ ${!PLATFORM} == RHEL ]]; then[0m
[30;1m237 | [0m[35m                CA_CERTS_FILE=/etc/ssl/certs/ca-bundle.crt[0m
[30;1m238 | [0m[35m                yum -y upgrade ca-certificates[0m
[30;1m239 | [0m[35m              elif [[ ${!PLATFORM} == DEBIAN ]]; then[0m
[30;1m240 | [0m[35m                CA_CERTS_FILE=/etc/ssl/certs/ca-certificates.crt[0m
[30;1m241 | [0m[35m                apt-get -y --only-upgrade install ca-certificates[0m

[31m--[ [0m[34mMatch #[0m[33m1204[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m221 | [0m[35m                apt-cache search build-essential[0m
[30;1m222 | [0m[35m                apt-get clean[0m
[30;1m223 | [0m[35m                apt-get -y update[0m
[30;1m224 | [0m[35m                apt-get -y install build-essential curl wget jq[0m
[30;1m225 | [0m[35m              fi[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m      # Install Cinc[0m

[31m--[ [0m[34mMatch #[0m[33m1205[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m221 | [0m[35m                apt-cache search build-essential[0m
[30;1m222 | [0m[35m                apt-get clean[0m
[30;1m223 | [0m[35m                apt-get -y update[0m
[30;1m224 | [0m[35m                apt-get -y install build-essential curl wget jq[0m
[30;1m225 | [0m[35m              fi[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m      # Install Cinc[0m

[31m--[ [0m[34mMatch #[0m[33m1206[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m220 | [0m[35m                fi[0m
[30;1m221 | [0m[35m                apt-cache search build-essential[0m
[30;1m222 | [0m[35m                apt-get clean[0m
[30;1m223 | [0m[35m                apt-get -y update[0m
[30;1m224 | [0m[35m                apt-get -y install build-essential curl wget jq[0m
[30;1m225 | [0m[35m              fi[0m
[30;1m226 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1207[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m219 | [0m[35m                  sed "/Update-Package-Lists/s/\"1\"/\"0\"/; /Unattended-Upgrade/s/\"1\"/\"0\"/;" /e[0m
[30;1m220 | [0m[35m                fi[0m
[30;1m221 | [0m[35m                apt-cache search build-essential[0m
[30;1m222 | [0m[35m                apt-get clean[0m
[30;1m223 | [0m[35m                apt-get -y update[0m
[30;1m224 | [0m[35m                apt-get -y install build-essential curl wget jq[0m
[30;1m225 | [0m[35m              fi[0m

[31m--[ [0m[34mMatch #[0m[33m1208[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m216 | [0m[35m to avoid dpkg lock[0m
[30;1m217 | [0m[35m                  flock $(apt-config shell StateDir Dir::State/d | sed -r "s/.*'(.*)\/?'$/\1/")/dail[0m
[30;1m218 | [0m[35m                  # disable unattended upgrades[0m
[30;1m219 | [0m[35m                  sed "/Update-Package-Lists/s/\"1\"/\"0\"/; /Unattended-Upgrade/s/\"1\"/\"0\"/;" /e[0m
[30;1m220 | [0m[35m                fi[0m
[30;1m221 | [0m[35m                apt-cache search build-essential[0m
[30;1m222 | [0m[35m                apt-get clean[0m
[30;1m223 | [0m[35m                apt-get -y update[0m

[31m--[ [0m[34mMatch #[0m[33m1209[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m213 | [0m[35m fi[0m
[30;1m214 | [0m[35m              elif [[ ${!PLATFORM} == DEBIAN ]]; then[0m
[30;1m215 | [0m[35m                if [[ "${CfnParamUpdateOsAndReboot}" == "false" ]]; then[0m
[30;1m216 | [0m[35m                  # disable apt-daily.timer to avoid dpkg lock[0m
[30;1m217 | [0m[35m                  flock $(apt-config shell StateDir Dir::State/d | sed -r "s/.*'(.*)\/?'$/\1/")/dail[0m
[30;1m218 | [0m[35m                  # disable unattended upgrades[0m

[31m--[ [0m[34mMatch #[0m[33m1210[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m212 | [0m[35m -o /boot/grub2/grub.cfg[0m
[30;1m213 | [0m[35m                fi[0m
[30;1m214 | [0m[35m              elif [[ ${!PLATFORM} == DEBIAN ]]; then[0m
[30;1m215 | [0m[35m                if [[ "${CfnParamUpdateOsAndReboot}" == "false" ]]; then[0m
[30;1m216 | [0m[35m                  # disable apt-daily.timer to avoid dpkg lock[0m
[30;1m217 | [0m[35m                  flock $(apt-config shell StateDir Dir::State/d | sed -r "s/.*'(.*)\/?'$/\1/")/dail[0m
[30;1m218 | [0m[35m                  # disable unattended upgrades[0m

[31m--[ [0m[34mMatch #[0m[33m1211[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m211 | [0m[35mc/selinux/config[0m
[30;1m212 | [0m[35m                  grub2-mkconfig -o /boot/grub2/grub.cfg[0m
[30;1m213 | [0m[35m                fi[0m
[30;1m214 | [0m[35m              elif [[ ${!PLATFORM} == DEBIAN ]]; then[0m
[30;1m215 | [0m[35m                if [[ "${CfnParamUpdateOsAndReboot}" == "false" ]]; then[0m
[30;1m216 | [0m[35m                  # disable apt-daily.timer to avoid dpkg lock[0m
[30;1m217 | [0m[35m                  flock $(apt-config shell StateDir Dir::State/d | sed -r "s/.*'(.*)\/?'$/\1/")/dail[0m
[30;1m218 | [0m[35m                  # disable unattended upgrades[0m

[31m--[ [0m[34mMatch #[0m[33m1212[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m211 | [0m[35ming/SELINUX=permissive/' /etc/selinux/config[0m
[30;1m212 | [0m[35m                  grub2-mkconfig -o /boot/grub2/grub.cfg[0m
[30;1m213 | [0m[35m                fi[0m
[30;1m214 | [0m[35m              elif [[ ${!PLATFORM} == DEBIAN ]]; then[0m
[30;1m215 | [0m[35m                if [[ "${CfnParamUpdateOsAndReboot}" == "false" ]]; then[0m
[30;1m216 | [0m[35m                  # disable apt-daily.timer to avoid dpkg lock[0m
[30;1m217 | [0m[35m                  flock $(apt-config shell StateDir Dir::State/d | sed -r "s/.*'(.*)\/?'$/\1/")/dail[0m
[30;1m218 | [0m[35m                  # disable unattended upgrades[0m

[31m--[ [0m[34mMatch #[0m[33m1213[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m204 | [0m[35m                  fi[0m
[30;1m205 | [0m[35m                fi[0m
[30;1m206 | [0m[35m                yum -y update krb5-libs[0m
[30;1m207 | [0m[35m                yum -y groupinstall development && sudo yum -y install curl wget jq[0m
[30;1m208 | [0m[35m              [0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m                if [[ ${!OS} =~ ^centos ]]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1214[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m204 | [0m[35m                  fi[0m
[30;1m205 | [0m[35m                fi[0m
[30;1m206 | [0m[35m                yum -y update krb5-libs[0m
[30;1m207 | [0m[35m                yum -y groupinstall development && sudo yum -y install curl wget jq[0m
[30;1m208 | [0m[35m              [0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m                if [[ ${!OS} =~ ^centos ]]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1215[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m204 | [0m[35m                  fi[0m
[30;1m205 | [0m[35m                fi[0m
[30;1m206 | [0m[35m                yum -y update krb5-libs[0m
[30;1m207 | [0m[35m                yum -y groupinstall development && sudo yum -y install curl wget jq[0m
[30;1m208 | [0m[35m              [0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m                if [[ ${!OS} =~ ^centos ]]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1216[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m203 | [0m[35m                    yum clean all[0m
[30;1m204 | [0m[35m                  fi[0m
[30;1m205 | [0m[35m                fi[0m
[30;1m206 | [0m[35m                yum -y update krb5-libs[0m
[30;1m207 | [0m[35m                yum -y groupinstall development && sudo yum -y install curl wget jq[0m
[30;1m208 | [0m[35m              [0m
[30;1m209 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1217[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m200 | [0m[35m                  if [[ ! -f /etc/yum/vars/releasever ]]; then[0m
[30;1m201 | [0m[35m                    echo "yes" > /opt/parallelcluster/pin_releasesever[0m
[30;1m202 | [0m[35m                    echo ${!VERSION} > /etc/yum/vars/releasever[0m
[30;1m203 | [0m[35m                    yum clean all[0m
[30;1m204 | [0m[35m                  fi[0m
[30;1m205 | [0m[35m                fi[0m
[30;1m206 | [0m[35m                yum -y update krb5-libs[0m

[31m--[ [0m[34mMatch #[0m[33m1218[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m177 | [0m[35m                # This component only supports aarch64 CPUs on Amazon Linux 2, Ubuntu2004, Ubuntu220[0m
[30;1m178 | [0m[35m                ARCH=$(uname -m)[0m
[30;1m179 | [0m[35m                if [[ `echo ${!ARCH}` == 'aarch64' ]]; then[0m
[30;1m180 | [0m[35m                  if [ `echo "${!RELEASE}" | grep -Ev '^(amzn\.2|amzn\.2023|ubuntu\.20\.04|ubuntu\.2[0m
[30;1m181 | [0m[35m                    echo "This component does not support '${!RELEASE}' on ARM64 CPUs. Failing build[0m
[30;1m182 | [0m[35m                    exit {{ FailExitCode }}[0m
[30;1m183 | [0m[35m                  fi[0m

[31m--[ [0m[34mMatch #[0m[33m1219[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m169 | [0m[35m              set -v[0m
[30;1m170 | [0m[35m              if [ ${CfnParamUpdateOsAndReboot} == false ]; then[0m
[30;1m171 | [0m[35m                RELEASE='{{ build.OperatingSystemRelease.outputs.stdout }}'[0m
[30;1m172 | [0m[35m                if [ `echo "${!RELEASE}" | grep -Ev '^(amzn|centos|ubuntu|rhel|rocky)'` ]; then[0m
[30;1m173 | [0m[35m                  echo "This component does not support '${!RELEASE}'. Failing build."[0m
[30;1m174 | [0m[35m                  exit {{ FailExitCode }}[0m
[30;1m175 | [0m[35m                fi[0m

[31m--[ [0m[34mMatch #[0m[33m1220[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m               if [ `echo "${!OS}" | grep -E '^(alinux|centos|rhel|rocky)'` ]; then[0m
[30;1m135 | [0m[35m                 PLATFORM='RHEL'[0m
[30;1m136 | [0m[35m               elif [ `echo "${!OS}" | grep -E '^ubuntu'` ]; then[0m
[30;1m137 | [0m[35m                 PLATFORM='DEBIAN'[0m
[30;1m138 | [0m[35m               fi[0m
[30;1m139 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1221[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m131 | [0m[35m               set -v[0m
[30;1m132 | [0m[35m               OS='{{ build.OperatingSystemName.outputs.stdout }}'[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m               if [ `echo "${!OS}" | grep -E '^(alinux|centos|rhel|rocky)'` ]; then[0m
[30;1m135 | [0m[35m                 PLATFORM='RHEL'[0m
[30;1m136 | [0m[35m               elif [ `echo "${!OS}" | grep -E '^ubuntu'` ]; then[0m
[30;1m137 | [0m[35m                 PLATFORM='DEBIAN'[0m

[31m--[ [0m[34mMatch #[0m[33m1222[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m98 | [0m[35m                OS='rocky8'[0m
[30;1m99 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rhel\.9'` ]; then[0m
[30;1m100 | [0m[35m                OS='rhel9'[0m
[30;1m101 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rocky\.9'` ]; then[0m
[30;1m102 | [0m[35m                OS='rocky9'[0m
[30;1m103 | [0m[35m              else[0m
[30;1m104 | [0m[35m                echo "Operating System '${!RELEASE}' is not supported. Failing build."[0m

[31m--[ [0m[34mMatch #[0m[33m1223[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m96 | [0m[35m                OS='rhel8'[0m
[30;1m97 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rocky\.8'` ]; then[0m
[30;1m98 | [0m[35m                OS='rocky8'[0m
[30;1m99 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rhel\.9'` ]; then[0m
[30;1m100 | [0m[35m                OS='rhel9'[0m
[30;1m101 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rocky\.9'` ]; then[0m
[30;1m102 | [0m[35m                OS='rocky9'[0m

[31m--[ [0m[34mMatch #[0m[33m1224[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m94 | [0m[35m                OS='ubuntu2404'[0m
[30;1m95 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rhel\.8'` ]; then[0m
[30;1m96 | [0m[35m                OS='rhel8'[0m
[30;1m97 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rocky\.8'` ]; then[0m
[30;1m98 | [0m[35m                OS='rocky8'[0m
[30;1m99 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rhel\.9'` ]; then[0m
[30;1m100 | [0m[35m                OS='rhel9'[0m

[31m--[ [0m[34mMatch #[0m[33m1225[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m92 | [0m[35m                OS='ubuntu2204'[0m
[30;1m93 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^ubuntu\.24'` ]; then[0m
[30;1m94 | [0m[35m                OS='ubuntu2404'[0m
[30;1m95 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rhel\.8'` ]; then[0m
[30;1m96 | [0m[35m                OS='rhel8'[0m
[30;1m97 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rocky\.8'` ]; then[0m
[30;1m98 | [0m[35m                OS='rocky8'[0m

[31m--[ [0m[34mMatch #[0m[33m1226[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m90 | [0m[35m                OS='ubuntu2004'[0m
[30;1m91 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^ubuntu\.22'` ]; then[0m
[30;1m92 | [0m[35m                OS='ubuntu2204'[0m
[30;1m93 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^ubuntu\.24'` ]; then[0m
[30;1m94 | [0m[35m                OS='ubuntu2404'[0m
[30;1m95 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rhel\.8'` ]; then[0m
[30;1m96 | [0m[35m                OS='rhel8'[0m

[31m--[ [0m[34mMatch #[0m[33m1227[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m                OS='alinux2023'[0m
[30;1m89 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^ubuntu\.20'` ]; then[0m
[30;1m90 | [0m[35m                OS='ubuntu2004'[0m
[30;1m91 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^ubuntu\.22'` ]; then[0m
[30;1m92 | [0m[35m                OS='ubuntu2204'[0m
[30;1m93 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^ubuntu\.24'` ]; then[0m
[30;1m94 | [0m[35m                OS='ubuntu2404'[0m

[31m--[ [0m[34mMatch #[0m[33m1228[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m86 | [0m[35m                OS='alinux2'[0m
[30;1m87 | [0m[35m              elif [ `echo "${!RELEASE}" | grep -w '^amzn\.2023'` ]; then[0m
[30;1m88 | [0m[35m                OS='alinux2023'[0m
[30;1m89 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^ubuntu\.20'` ]; then[0m
[30;1m90 | [0m[35m                OS='ubuntu2004'[0m
[30;1m91 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^ubuntu\.22'` ]; then[0m
[30;1m92 | [0m[35m                OS='ubuntu2204'[0m

[31m--[ [0m[34mMatch #[0m[33m1229[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m              if [ `echo "${!RELEASE}" | grep -w '^amzn\.2'` ]; then[0m
[30;1m86 | [0m[35m                OS='alinux2'[0m
[30;1m87 | [0m[35m              elif [ `echo "${!RELEASE}" | grep -w '^amzn\.2023'` ]; then[0m
[30;1m88 | [0m[35m                OS='alinux2023'[0m
[30;1m89 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^ubuntu\.20'` ]; then[0m
[30;1m90 | [0m[35m                OS='ubuntu2004'[0m

[31m--[ [0m[34mMatch #[0m[33m1230[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m82 | [0m[35m              set -v[0m
[30;1m83 | [0m[35m              RELEASE='{{ build.OperatingSystemRelease.outputs.stdout }}'[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m              if [ `echo "${!RELEASE}" | grep -w '^amzn\.2'` ]; then[0m
[30;1m86 | [0m[35m                OS='alinux2'[0m
[30;1m87 | [0m[35m              elif [ `echo "${!RELEASE}" | grep -w '^amzn\.2023'` ]; then[0m
[30;1m88 | [0m[35m                OS='alinux2023'[0m

[31m--[ [0m[34mMatch #[0m[33m1231[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster3_config_converter/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1232[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1233[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/update_cluster_request_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1234[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/imagebuilder_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1235[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/manage_docker_images.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m75 | [0m[35m@helper.update[0m
[30;1m76 | [0m[35mdef update(event, _):[0m
[30;1m77 | [0m[35m    """[0m
[30;1m78 | [0m[35m    Place your code to handle Update events here.[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    To return a failure to CloudFormation simply raise an exception,[0m
[30;1m81 | [0m[35m    the exception message will be sent to CloudFormation Events.[0m

[31m--[ [0m[34mMatch #[0m[33m1236[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/manage_docker_images.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m#  the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1237[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/manage_docker_images.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m    """[0m
[30;1m49 | [0m[35m    Start the build to create Docker images.[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    :param codebuild_project: CodeBuild project that builds docker container images.[0m
[30;1m52 | [0m[35m    """[0m
[30;1m53 | [0m[35m    build_id = trigger_codebuild(codebuild_project)[0m
[30;1m54 | [0m[35m    logger.info("Docker images creation: STARTED")[0m

[31m--[ [0m[34mMatch #[0m[33m1238[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/manage_docker_images.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35mdef create_docker_images(codebuild_project):[0m
[30;1m48 | [0m[35m    """[0m
[30;1m49 | [0m[35m    Start the build to create Docker images.[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    :param codebuild_project: CodeBuild project that builds docker container images.[0m
[30;1m52 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1239[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/create_cluster_request_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1240[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/instances_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m266 | [0m[35m            self._add_failure([0m
[30;1m267 | [0m[35m                f'Enabling Memory-based scheduling when a Compute Resource ("{compute_resource_name}[0m
[30;1m268 | [0m[35m                " one instance type specified may lead to unused resources since only the minimum av[0m
[30;1m269 | [0m[35m                " across all instance-types can be specified in the Slurm node definition.",[0m
[30;1m270 | [0m[35m                FailureLevel.WARNING,[0m
[30;1m271 | [0m[35m            )[0m
[30;1m272 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1241[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/instances_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m167 | [0m[35mce {1} support enhanced "[0m
[30;1m168 | [0m[35m                        "networking capabilities using Elastic Fabric Adapter (EFA). EFA enables you[0m
[30;1m169 | [0m[35m                        "applications requiring high levels of inter-node communications at scale on[0m
[30;1m170 | [0m[35m                        "additional charge. You can update the cluster's configuration to enable EFA[0m
[30;1m171 | [0m[35m                        "https://docs.aws.amazon.com/parallelcluster/latest/ug/efa-v3.html).".format[0m
[30;1m172 | [0m[35m                            ",".join(sorted(instance_types_with_efa_support)),[0m
[30;1m173 | [0m[35m                            compute_resource_name,[0m

[31m--[ [0m[34mMatch #[0m[33m1242[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/instances_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m167 | [0m[35me EC2 instance type(s) selected ({0}) for the Compute Resource {1} support enhanced "[0m
[30;1m168 | [0m[35m                        "networking capabilities using Elastic Fabric Adapter (EFA). EFA enables you[0m
[30;1m169 | [0m[35m                        "applications requiring high levels of inter-node communications at scale on[0m
[30;1m170 | [0m[35m                        "additional charge. You can update the cluster's configuration to enable EFA[0m
[30;1m171 | [0m[35m                        "https://docs.aws.amazon.com/parallelcluster/latest/ug/efa-v3.html).".format[0m
[30;1m172 | [0m[35m                            ",".join(sorted(instance_types_with_efa_support)),[0m

[31m--[ [0m[34mMatch #[0m[33m1243[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/instances_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m167 | [0m[35m             "The EC2 instance type(s) selected ({0}) for the Compute Resource {1} support enhanced [0m
[30;1m168 | [0m[35m                        "networking capabilities using Elastic Fabric Adapter (EFA). EFA enables you[0m
[30;1m169 | [0m[35m                        "applications requiring high levels of inter-node communications at scale on[0m
[30;1m170 | [0m[35m                        "additional charge. You can update the cluster's configuration to enable EFA[0m
[30;1m171 | [0m[35m                        "https://docs.aws.amazon.com/parallelcluster/latest/ug/efa-v3.html).".format[0m

[31m--[ [0m[34mMatch #[0m[33m1244[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/instances_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m130 | [0m[35m    ):[0m
[30;1m131 | [0m[35m        """Check if EFA requirements are met.[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m        Validation Failure is expected if EFA is ENABLED and at least one instance type defined in t[0m
[30;1m134 | [0m[35m        DOES NOT support EFA.[0m
[30;1m135 | [0m[35m        """[0m
[30;1m136 | [0m[35m        if efa_enabled:[0m

[31m--[ [0m[34mMatch #[0m[33m1245[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/instances_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2022 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1246[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m96 | [0m[35m   if [[ "${!custom_cookbook}" =~ ^s3://([^/]*)(.*) ]]; then[0m
[30;1m97 | [0m[35m          # Set the socket connection timeout to 15s. Emperically, it seems like the actual[0m
[30;1m98 | [0m[35m          # timeout is 8x(cli-connect-timeout). i.e. if cli-connection-timeout is set to[0m
[30;1m99 | [0m[35m          # 60s, the call will timeout the connect attempt at 8m. Setting it to 15s, causes[0m
[30;1m100 | [0m[35m          # each attempt to take 240s, so 2m * 3 attempts will result in a failure after 6[0m
[30;1m101 | [0m[35m          # minutes.[0m

[31m--[ [0m[34mMatch #[0m[33m1247[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m162 | [0m[35mif [ "${Timeout}" == "NONE" ]; then[0m
[30;1m163 | [0m[35m  /tmp/bootstrap.sh[0m
[30;1m164 | [0m[35melse[0m
[30;1m165 | [0m[35m  timeout ${Timeout} /tmp/bootstrap.sh || error_exit[0m
[30;1m166 | [0m[35mfi[0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m# Notify the AutoScalingGroup about the successful bootstrap[0m

[31m--[ [0m[34mMatch #[0m[33m1248[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m142 | [0m[35m      } || error_exit 'Failed to run bootstrap recipes. Please check /var/log/chef-client.log in the[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m      if [ ! -f /opt/parallelcluster/.bootstrapped ]; then[0m
[30;1m145 | [0m[35m        echo ${!cookbook_version} | tee /opt/parallelcluster/.bootstrapped[0m
[30;1m146 | [0m[35m      fi[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m--==BOUNDARY==[0m

[31m--[ [0m[34mMatch #[0m[33m1249[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m139 | [0m[35m        /opt/parallelcluster/scripts/fetch_and_run -postinstall -c /opt/parallelcluster/shared_login[0m
[30;1m140 | [0m[35m        ${!CINC_CMD} --override-runlist aws-parallelcluster-entrypoints::finalize &&[0m
[30;1m141 | [0m[35m        popd[0m
[30;1m142 | [0m[35m      } || error_exit 'Failed to run bootstrap recipes. Please check /var/log/chef-client.log in the[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m      if [ ! -f /opt/parallelcluster/.bootstrapped ]; then[0m
[30;1m145 | [0m[35m        echo ${!cookbook_version} | tee /opt/parallelcluster/.bootstrapped[0m

[31m--[ [0m[34mMatch #[0m[33m1250[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35m        error_exit "This AMI was not baked by ParallelCluster. Please use pcluster build-image comma[0m
[30;1m126 | [0m[35m      fi[0m
[30;1m127 | [0m[35m      if [ "${!custom_cookbook}" != "NONE" ]; then[0m
[30;1m128 | [0m[35m        curl --retry 3 -v -L -o /etc/chef/aws-parallelcluster-cookbook.tgz ${!cookbook_url}[0m
[30;1m129 | [0m[35m        vendor_cookbook[0m
[30;1m130 | [0m[35m      fi[0m
[30;1m131 | [0m[35m      cd /tmp[0m

[31m--[ [0m[34mMatch #[0m[33m1251[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m ]; then[0m
[30;1m118 | [0m[35m        installed_version=$(cat /opt/parallelcluster/.bootstrapped)[0m
[30;1m119 | [0m[35m        if [ "${!cookbook_version}" != "${!installed_version}" ]; then[0m
[30;1m120 | [0m[35m          cookbook_version_number=$(echo ${!cookbook_version} | awk -F- '{print $NF}')[0m
[30;1m121 | [0m[35m          installed_version_number=$(echo ${!installed_version} | awk -F- '{print $NF}')[0m

[31m--[ [0m[34mMatch #[0m[33m1252[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m116 | [0m[35mrt berkshelf_version=${BerkshelfVersion}[0m
[30;1m117 | [0m[35m      if [ -f /opt/parallelcluster/.bootstrapped ]; then[0m
[30;1m118 | [0m[35m        installed_version=$(cat /opt/parallelcluster/.bootstrapped)[0m
[30;1m119 | [0m[35m        if [ "${!cookbook_version}" != "${!installed_version}" ]; then[0m
[30;1m120 | [0m[35m          cookbook_version_number=$(echo ${!cookbook_version} | awk -F- '{print $NF}')[0m
[30;1m121 | [0m[35m          installed_version_number=$(echo ${!installed_version} | awk -F- '{print $NF}')[0m

[31m--[ [0m[34mMatch #[0m[33m1253[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35mok}" != "NONE" ]; then[0m
[30;1m96 | [0m[35m        if [[ "${!custom_cookbook}" =~ ^s3://([^/]*)(.*) ]]; then[0m
[30;1m97 | [0m[35m          # Set the socket connection timeout to 15s. Emperically, it seems like the actual[0m
[30;1m98 | [0m[35m          # timeout is 8x(cli-connect-timeout). i.e. if cli-connection-timeout is set to[0m
[30;1m99 | [0m[35m          # 60s, the call will timeout the connect attempt at 8m. Setting it to 15s, causes[0m
[30;1m100 | [0m[35m          # each attempt to take 240s, so 2m * 3 attempts will result in a failure after 6[0m
[30;1m101 | [0m[35m          # minutes.[0m

[31m--[ [0m[34mMatch #[0m[33m1254[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m      if [ "${!custom_cookbook}" != "NONE" ]; then[0m
[30;1m96 | [0m[35m        if [[ "${!custom_cookbook}" =~ ^s3://([^/]*)(.*) ]]; then[0m
[30;1m97 | [0m[35m          # Set the socket connection timeout to 15s. Emperically, it seems like the actual[0m
[30;1m98 | [0m[35m          # timeout is 8x(cli-connect-timeout). i.e. if cli-connection-timeout is set to[0m
[30;1m99 | [0m[35m          # 60s, the call will timeout the connect attempt at 8m. Setting it to 15s, causes[0m
[30;1m100 | [0m[35m          # each attempt to take 240s, so 2m * 3 attempts will result in a failure after 6[0m
[30;1m101 | [0m[35m          # minutes.[0m

[31m--[ [0m[34mMatch #[0m[33m1255[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m94 | [0m[35m      s3_url=${AWS::URLSuffix}[0m
[30;1m95 | [0m[35m      if [ "${!custom_cookbook}" != "NONE" ]; then[0m
[30;1m96 | [0m[35m        if [[ "${!custom_cookbook}" =~ ^s3://([^/]*)(.*) ]]; then[0m
[30;1m97 | [0m[35m          # Set the socket connection timeout to 15s. Emperically, it seems like the actual[0m
[30;1m98 | [0m[35m          # timeout is 8x(cli-connect-timeout). i.e. if cli-connection-timeout is set to[0m
[30;1m99 | [0m[35m          # 60s, the call will timeout the connect attempt at 8m. Setting it to 15s, causes[0m
[30;1m100 | [0m[35m          # each attempt to take 240s, so 2m * 3 attempts will result in a failure after 6[0m

[31m--[ [0m[34mMatch #[0m[33m1256[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m84 | [0m[35m.d/proxy.sh[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m      $CFN_BOOTSTRAP_VIRTUALENV_PATH/cfn-init -s ${AWS::StackName} -v -c deployFiles -r ${LaunchTemp[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m      # Configure AWS CLI using the expected overrides, if any.[0m

[31m--[ [0m[34mMatch #[0m[33m1257[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m      {[0m
[30;1m68 | [0m[35m        mkdir /tmp/cookbooks[0m
[30;1m69 | [0m[35m        cd /tmp/cookbooks[0m
[30;1m70 | [0m[35m        tar -xzf /etc/chef/aws-parallelcluster-cookbook.tgz[0m
[30;1m71 | [0m[35m        HOME_BAK="${!HOME}"[0m
[30;1m72 | [0m[35m        export HOME="/tmp"[0m
[30;1m73 | [0m[35m        for d in `ls /tmp/cookbooks`; do[0m

[31m--[ [0m[34mMatch #[0m[33m1258[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35mdatasource_list: [ Ec2, None ][0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35moutput:[0m
[30;1m49 | [0m[35m  all: "| tee -a /var/log/cloud-init-output.log | logger -t user-data -s 2>/dev/ttyS0"[0m
[30;1m50 | [0m[35mwrite_files:[0m
[30;1m51 | [0m[35m  - path: /tmp/bootstrap.sh[0m
[30;1m52 | [0m[35m    permissions: '0744'[0m

[31m--[ [0m[34mMatch #[0m[33m1259[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m  proxy_host=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f1)[0m
[30;1m26 | [0m[35m  proxy_port=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f2)[0m
[30;1m27 | [0m[35m  echo -e "[Boto]\nproxy = ${!proxy_host}\nproxy_port = ${!proxy_port}\n" >/etc/boto.cfg[0m
[30;1m28 | [0m[35m  cat >> /etc/profile.d/proxy.sh <<PROXY[0m
[30;1m29 | [0m[35mexport http_proxy="${!proxy}"[0m
[30;1m30 | [0m[35mexport https_proxy="${!proxy}"[0m
[30;1m31 | [0m[35mexport no_proxy="localhost,127.0.0.1,169.254.169.254"[0m

[31m--[ [0m[34mMatch #[0m[33m1260[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35mproxy=${ProxyServer}[0m
[30;1m24 | [0m[35mif [ "${!proxy}" != "NONE" ]; then[0m
[30;1m25 | [0m[35m  proxy_host=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f1)[0m
[30;1m26 | [0m[35m  proxy_port=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f2)[0m
[30;1m27 | [0m[35m  echo -e "[Boto]\nproxy = ${!proxy_host}\nproxy_port = ${!proxy_port}\n" >/etc/boto.cfg[0m
[30;1m28 | [0m[35m  cat >> /etc/profile.d/proxy.sh <<PROXY[0m
[30;1m29 | [0m[35mexport http_proxy="${!proxy}"[0m

[31m--[ [0m[34mMatch #[0m[33m1261[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35mproxy=${ProxyServer}[0m
[30;1m24 | [0m[35mif [ "${!proxy}" != "NONE" ]; then[0m
[30;1m25 | [0m[35m  proxy_host=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f1)[0m
[30;1m26 | [0m[35m  proxy_port=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f2)[0m
[30;1m27 | [0m[35m  echo -e "[Boto]\nproxy = ${!proxy_host}\nproxy_port = ${!proxy_port}\n" >/etc/boto.cfg[0m
[30;1m28 | [0m[35m  cat >> /etc/profile.d/proxy.sh <<PROXY[0m
[30;1m29 | [0m[35mexport http_proxy="${!proxy}"[0m

[31m--[ [0m[34mMatch #[0m[33m1262[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mproxy=${ProxyServer}[0m
[30;1m24 | [0m[35mif [ "${!proxy}" != "NONE" ]; then[0m
[30;1m25 | [0m[35m  proxy_host=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f1)[0m
[30;1m26 | [0m[35m  proxy_port=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f2)[0m
[30;1m27 | [0m[35m  echo -e "[Boto]\nproxy = ${!proxy_host}\nproxy_port = ${!proxy_port}\n" >/etc/boto.cfg[0m
[30;1m28 | [0m[35m  cat >> /etc/profile.d/proxy.sh <<PROXY[0m

[31m--[ [0m[34mMatch #[0m[33m1263[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mproxy=${ProxyServer}[0m
[30;1m24 | [0m[35mif [ "${!proxy}" != "NONE" ]; then[0m
[30;1m25 | [0m[35m  proxy_host=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f1)[0m
[30;1m26 | [0m[35m  proxy_port=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f2)[0m
[30;1m27 | [0m[35m  echo -e "[Boto]\nproxy = ${!proxy_host}\nproxy_port = ${!proxy_port}\n" >/etc/boto.cfg[0m
[30;1m28 | [0m[35m  cat >> /etc/profile.d/proxy.sh <<PROXY[0m

[31m--[ [0m[34mMatch #[0m[33m1264[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m  echo "Not yum system"[0m
[30;1m19 | [0m[35mfi[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mwhich apt-get && echo "Acquire::http::Proxy \"${AptProxy}\";" >> /etc/apt/apt.conf || echo "Not apt [0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mproxy=${ProxyServer}[0m
[30;1m24 | [0m[35mif [ "${!proxy}" != "NONE" ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1265[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m  echo "Not yum system"[0m
[30;1m19 | [0m[35mfi[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mwhich apt-get && echo "Acquire::http::Proxy \"${AptProxy}\";" >> /etc/apt/apt.conf || echo "Not apt [0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mproxy=${ProxyServer}[0m
[30;1m24 | [0m[35mif [ "${!proxy}" != "NONE" ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1266[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35melif [ "${!yum}" == "0" ]; then[0m
[30;1m16 | [0m[35m  echo "proxy=${YumProxy}" >> /etc/yum.conf[0m
[30;1m17 | [0m[35melse[0m
[30;1m18 | [0m[35m  echo "Not yum system"[0m
[30;1m19 | [0m[35mfi[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mwhich apt-get && echo "Acquire::http::Proxy \"${AptProxy}\";" >> /etc/apt/apt.conf || echo "Not apt [0m

[31m--[ [0m[34mMatch #[0m[33m1267[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35m#!/bin/bash -x[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mwhich dnf 2>/dev/null; dnf=$?[0m
[30;1m11 | [0m[35mwhich yum 2>/dev/null; yum=$?[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mif [ "${!dnf}" == "0" ]; then[0m
[30;1m14 | [0m[35m  echo "proxy=${DnfProxy}" >> /etc/dnf/dnf.conf[0m

[31m--[ [0m[34mMatch #[0m[33m1268[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/login_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m#!/bin/bash -x[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mwhich dnf 2>/dev/null; dnf=$?[0m
[30;1m11 | [0m[35mwhich yum 2>/dev/null; yum=$?[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mif [ "${!dnf}" == "0" ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1269[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/README[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m5 | [0m[35mAWS ParallelCluster facilitates both quick start proof of concepts (POCs) and production deployments[0m
[30;1m6 | [0m[35mYou can build higher level workflows, such as a Genomics portal that automates the entire DNA sequen[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mDocumentation can be found at https://docs.aws.amazon.com/parallelcluster/[0m

[31m--[ [0m[34mMatch #[0m[33m1270[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/README[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mBuilt on the Open Source CfnCluster project, AWS ParallelCluster enables you to quickly build an HPC[0m
[30;1m4 | [0m[35mIt automatically sets up the required compute resources and a shared filesystem and offers a variety[0m
[30;1m5 | [0m[35mAWS ParallelCluster facilitates both quick start proof of concepts (POCs) and production deployments[0m
[30;1m6 | [0m[35mYou can build higher level workflows, such as a Genomics portal that automates the entire DNA sequen[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mDocumentation can be found at https://docs.aws.amazon.com/parallelcluster/[0m

[31m--[ [0m[34mMatch #[0m[33m1271[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m133 | [0m[35mk[0m
[30;1m134 | [0m[35mfi[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m# Call CloudFormation[0m
[30;1m137 | [0m[35m$CFN_BOOTSTRAP_VIRTUALENV_PATH/cfn-init -s ${AWS::StackName} -v -c default -r HeadNodeLaunchTemplate[0m

[31m--[ [0m[34mMatch #[0m[33m1272[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m132 | [0m[35m-L -o /etc/chef/aws-parallelcluster-cookbook.tgz ${!cookbook_url}[0m
[30;1m133 | [0m[35m  vendor_cookbook[0m
[30;1m134 | [0m[35mfi[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m# Call CloudFormation[0m
[30;1m137 | [0m[35m$CFN_BOOTSTRAP_VIRTUALENV_PATH/cfn-init -s ${AWS::StackName} -v -c default -r HeadNodeLaunchTemplate[0m

[31m--[ [0m[34mMatch #[0m[33m1273[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m  error_exit "This AMI was not baked by ParallelCluster. Please use pcluster build-image command to [0m
[30;1m130 | [0m[35mfi[0m
[30;1m131 | [0m[35mif [ "${!custom_cookbook}" != "NONE" ]; then[0m
[30;1m132 | [0m[35m  curl --retry 3 -v -L -o /etc/chef/aws-parallelcluster-cookbook.tgz ${!cookbook_url}[0m
[30;1m133 | [0m[35m  vendor_cookbook[0m
[30;1m134 | [0m[35mfi[0m
[30;1m135 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1274[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m122 | [0m[35m  installed_version=$(cat /opt/parallelcluster/.bootstrapped)[0m
[30;1m123 | [0m[35m  if [ "${!cookbook_version}" != "${!installed_version}" ]; then[0m
[30;1m124 | [0m[35m    cookbook_version_number=$(echo ${!cookbook_version} | awk -F- '{print $NF}')[0m
[30;1m125 | [0m[35m    installed_version_number=$(echo ${!installed_version} | awk -F- '{print $NF}')[0m
[30;1m126 | [0m[35m    error_exit "This AMI was created with ${!installed_version_number}, but is trying to be used wit[0m
[30;1m127 | [0m[35m  fi[0m
[30;1m128 | [0m[35melse[0m

[31m--[ [0m[34mMatch #[0m[33m1275[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m119 | [0m[35msion=${ChefVersion}[0m
[30;1m120 | [0m[35mexport berkshelf_version=${BerkshelfVersion}[0m
[30;1m121 | [0m[35mif [ -f /opt/parallelcluster/.bootstrapped ]; then[0m
[30;1m122 | [0m[35m  installed_version=$(cat /opt/parallelcluster/.bootstrapped)[0m
[30;1m123 | [0m[35m  if [ "${!cookbook_version}" != "${!installed_version}" ]; then[0m
[30;1m124 | [0m[35m    cookbook_version_number=$(echo ${!cookbook_version} | awk -F- '{print $NF}')[0m
[30;1m125 | [0m[35m    installed_version_number=$(echo ${!installed_version} | awk -F- '{print $NF}')[0m

[31m--[ [0m[34mMatch #[0m[33m1276[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m77 | [0m[35m{[0m
[30;1m78 | [0m[35m  mkdir /tmp/cookbooks[0m
[30;1m79 | [0m[35m  cd /tmp/cookbooks[0m
[30;1m80 | [0m[35m  tar -xzf /etc/chef/aws-parallelcluster-cookbook.tgz[0m
[30;1m81 | [0m[35m  HOME_BAK="${!HOME}"[0m
[30;1m82 | [0m[35m  export HOME="/tmp"[0m
[30;1m83 | [0m[35m  for d in `ls /tmp/cookbooks`; do[0m

[31m--[ [0m[34mMatch #[0m[33m1277[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m  #     | cut -s -d, -f2-  # split over comma (,) and take the right part[0m
[30;1m49 | [0m[35m  #     | tr ',' '\n'      # convert remaining comma (,) into new lines[0m
[30;1m50 | [0m[35m  #     | sort -un         # sort and unique[0m
[30;1m51 | [0m[35m  - if [ "${DisableMultiThreadingManually}" = "true" ]; then for cpunum in $(cat /sys/devices/system[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35mpackage_update: false[0m
[30;1m54 | [0m[35mpackage_upgrade: false[0m

[31m--[ [0m[34mMatch #[0m[33m1278[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m  #     | cut -s -d, -f2-  # split over comma (,) and take the right part[0m
[30;1m49 | [0m[35m  #     | tr ',' '\n'      # convert remaining comma (,) into new lines[0m
[30;1m50 | [0m[35m  #     | sort -un         # sort and unique[0m
[30;1m51 | [0m[35m  - if [ "${DisableMultiThreadingManually}" = "true" ]; then for cpunum in $(cat /sys/devices/system[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35mpackage_update: false[0m
[30;1m54 | [0m[35mpackage_upgrade: false[0m

[31m--[ [0m[34mMatch #[0m[33m1279[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m47 | [0m[35m'       # convert hyphen (-) to comma (,), to account that some kernels and CPU architectures use a [0m
[30;1m48 | [0m[35m  #     | cut -s -d, -f2-  # split over comma (,) and take the right part[0m
[30;1m49 | [0m[35m  #     | tr ',' '\n'      # convert remaining comma (,) into new lines[0m
[30;1m50 | [0m[35m  #     | sort -un         # sort and unique[0m
[30;1m51 | [0m[35m  - if [ "${DisableMultiThreadingManually}" = "true" ]; then for cpunum in $(cat /sys/devices/system[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35mpackage_update: false[0m

[31m--[ [0m[34mMatch #[0m[33m1280[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m47 | [0m[35m  #     | tr '-' ','       # convert hyphen (-) to comma (,), to account that some kernels and CPU a[0m
[30;1m48 | [0m[35m  #     | cut -s -d, -f2-  # split over comma (,) and take the right part[0m
[30;1m49 | [0m[35m  #     | tr ',' '\n'      # convert remaining comma (,) into new lines[0m
[30;1m50 | [0m[35m  #     | sort -un         # sort and unique[0m
[30;1m51 | [0m[35m  - if [ "${DisableMultiThreadingManually}" = "true" ]; then for cpunum in $(cat /sys/devices/system[0m
[30;1m52 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1281[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35md list of CPU hardware threads within the same core as cpu[0m
[30;1m45 | [0m[35m  # e.g. 0-1 or 0,1[0m
[30;1m46 | [0m[35m  # cat /sys/devices/system/cpu/cpu*/topology/thread_siblings_list[0m
[30;1m47 | [0m[35m  #     | tr '-' ','       # convert hyphen (-) to comma (,), to account that some kernels and CPU a[0m
[30;1m48 | [0m[35m  #     | cut -s -d, -f2-  # split over comma (,) and take the right part[0m
[30;1m49 | [0m[35m  #     | tr ',' '\n'      # convert remaining comma (,) into new lines[0m
[30;1m50 | [0m[35m  #     | sort -un         # sort and unique[0m

[31m--[ [0m[34mMatch #[0m[33m1282[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35mbootcmd:[0m
[30;1m43 | [0m[35m  # Disable multithreading using logic from https://aws.amazon.com/blogs/compute/disabling-intel-hyp[0m
[30;1m44 | [0m[35m  # thread_siblings_list contains a comma (,) or dash (-) separated list of CPU hardware threads wit[0m
[30;1m45 | [0m[35m  # e.g. 0-1 or 0,1[0m
[30;1m46 | [0m[35m  # cat /sys/devices/system/cpu/cpu*/topology/thread_siblings_list[0m
[30;1m47 | [0m[35m  #     | tr '-' ','       # convert hyphen (-) to comma (,), to account that some kernels and CPU a[0m
[30;1m48 | [0m[35m  #     | cut -s -d, -f2-  # split over comma (,) and take the right part[0m

[31m--[ [0m[34mMatch #[0m[33m1283[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35mbootcmd:[0m
[30;1m43 | [0m[35m  # Disable multithreading using logic from https://aws.amazon.com/blogs/compute/disabling-intel-hyp[0m
[30;1m44 | [0m[35m  # thread_siblings_list contains a comma (,) or dash (-) separated list of CPU hardware threads wit[0m
[30;1m45 | [0m[35m  # e.g. 0-1 or 0,1[0m
[30;1m46 | [0m[35m  # cat /sys/devices/system/cpu/cpu*/topology/thread_siblings_list[0m
[30;1m47 | [0m[35m  #     | tr '-' ','       # convert hyphen (-) to comma (,), to account that some kernels and CPU a[0m

[31m--[ [0m[34mMatch #[0m[33m1284[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m  proxy_host=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f1)[0m
[30;1m26 | [0m[35m  proxy_port=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f2)[0m
[30;1m27 | [0m[35m  echo -e "[Boto]\nproxy = ${!proxy_host}\nproxy_port = ${!proxy_port}\n" >/etc/boto.cfg[0m
[30;1m28 | [0m[35m  cat >> /etc/profile.d/proxy.sh <<PROXY[0m
[30;1m29 | [0m[35mexport http_proxy="${!proxy}"[0m
[30;1m30 | [0m[35mexport https_proxy="${!proxy}"[0m
[30;1m31 | [0m[35mexport no_proxy="localhost,127.0.0.1,169.254.169.254"[0m

[31m--[ [0m[34mMatch #[0m[33m1285[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35mproxy=${ProxyServer}[0m
[30;1m24 | [0m[35mif [ "${!proxy}" != "NONE" ]; then[0m
[30;1m25 | [0m[35m  proxy_host=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f1)[0m
[30;1m26 | [0m[35m  proxy_port=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f2)[0m
[30;1m27 | [0m[35m  echo -e "[Boto]\nproxy = ${!proxy_host}\nproxy_port = ${!proxy_port}\n" >/etc/boto.cfg[0m
[30;1m28 | [0m[35m  cat >> /etc/profile.d/proxy.sh <<PROXY[0m
[30;1m29 | [0m[35mexport http_proxy="${!proxy}"[0m

[31m--[ [0m[34mMatch #[0m[33m1286[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35mproxy=${ProxyServer}[0m
[30;1m24 | [0m[35mif [ "${!proxy}" != "NONE" ]; then[0m
[30;1m25 | [0m[35m  proxy_host=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f1)[0m
[30;1m26 | [0m[35m  proxy_port=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f2)[0m
[30;1m27 | [0m[35m  echo -e "[Boto]\nproxy = ${!proxy_host}\nproxy_port = ${!proxy_port}\n" >/etc/boto.cfg[0m
[30;1m28 | [0m[35m  cat >> /etc/profile.d/proxy.sh <<PROXY[0m
[30;1m29 | [0m[35mexport http_proxy="${!proxy}"[0m

[31m--[ [0m[34mMatch #[0m[33m1287[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mproxy=${ProxyServer}[0m
[30;1m24 | [0m[35mif [ "${!proxy}" != "NONE" ]; then[0m
[30;1m25 | [0m[35m  proxy_host=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f1)[0m
[30;1m26 | [0m[35m  proxy_port=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f2)[0m
[30;1m27 | [0m[35m  echo -e "[Boto]\nproxy = ${!proxy_host}\nproxy_port = ${!proxy_port}\n" >/etc/boto.cfg[0m
[30;1m28 | [0m[35m  cat >> /etc/profile.d/proxy.sh <<PROXY[0m

[31m--[ [0m[34mMatch #[0m[33m1288[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mproxy=${ProxyServer}[0m
[30;1m24 | [0m[35mif [ "${!proxy}" != "NONE" ]; then[0m
[30;1m25 | [0m[35m  proxy_host=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f1)[0m
[30;1m26 | [0m[35m  proxy_port=$(echo "${!proxy}" | awk -F/ '{print $3}' | cut -d: -f2)[0m
[30;1m27 | [0m[35m  echo -e "[Boto]\nproxy = ${!proxy_host}\nproxy_port = ${!proxy_port}\n" >/etc/boto.cfg[0m
[30;1m28 | [0m[35m  cat >> /etc/profile.d/proxy.sh <<PROXY[0m

[31m--[ [0m[34mMatch #[0m[33m1289[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m  echo "Not yum system"[0m
[30;1m19 | [0m[35mfi[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mwhich apt-get && echo "Acquire::http::Proxy \"${AptProxy}\";" >> /etc/apt/apt.conf || echo "Not apt [0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mproxy=${ProxyServer}[0m
[30;1m24 | [0m[35mif [ "${!proxy}" != "NONE" ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1290[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m  echo "Not yum system"[0m
[30;1m19 | [0m[35mfi[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mwhich apt-get && echo "Acquire::http::Proxy \"${AptProxy}\";" >> /etc/apt/apt.conf || echo "Not apt [0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mproxy=${ProxyServer}[0m
[30;1m24 | [0m[35mif [ "${!proxy}" != "NONE" ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1291[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35melif [ "${!yum}" == "0" ]; then[0m
[30;1m16 | [0m[35m  echo "proxy=${YumProxy}" >> /etc/yum.conf[0m
[30;1m17 | [0m[35melse[0m
[30;1m18 | [0m[35m  echo "Not yum system"[0m
[30;1m19 | [0m[35mfi[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mwhich apt-get && echo "Acquire::http::Proxy \"${AptProxy}\";" >> /etc/apt/apt.conf || echo "Not apt [0m

[31m--[ [0m[34mMatch #[0m[33m1292[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35m#!/bin/bash -x[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mwhich dnf 2>/dev/null; dnf=$?[0m
[30;1m11 | [0m[35mwhich yum 2>/dev/null; yum=$?[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mif [ "${!dnf}" == "0" ]; then[0m
[30;1m14 | [0m[35m  echo "proxy=${DnfProxy}" >> /etc/dnf/dnf.conf[0m

[31m--[ [0m[34mMatch #[0m[33m1293[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/head_node/user_data.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35m#!/bin/bash -x[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35mwhich dnf 2>/dev/null; dnf=$?[0m
[30;1m11 | [0m[35mwhich yum 2>/dev/null; yum=$?[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mif [ "${!dnf}" == "0" ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1294[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/image_status_filtering_option.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m#  Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m#  Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except [0m
[30;1m4 | [0m[35m#  with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m#  or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS[0m
[30;1m6 | [0m[35m#  OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governin[0m
[30;1m7 | [0m[35m#  limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1295[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1296[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/image_logs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m84 | [0m[35m        # retrieve imagebuilder config and generate model[0m
[30;1m85 | [0m[35m        imagebuilder = ImageBuilder(image_id=args.image_id)[0m
[30;1m86 | [0m[35m        url = imagebuilder.export_logs([0m
[30;1m87 | [0m[35m            # imagebuilder.bucket will handle the bucket init including policy update[0m
[30;1m88 | [0m[35m            bucket=args.bucket if args.bucket else imagebuilder.bucket.name,[0m
[30;1m89 | [0m[35m            bucket_prefix=args.bucket_prefix,[0m
[30;1m90 | [0m[35m            keep_s3_objects=args.keep_s3_objects,[0m
[30;1m91 | [0m[35m            start_time=args.start_time,[0m

[31m--[ [0m[34mMatch #[0m[33m1297[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/image_logs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m#  Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m#  Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except [0m
[30;1m4 | [0m[35m#  with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m#  or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS[0m
[30;1m6 | [0m[35m#  OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governin[0m
[30;1m7 | [0m[35m#  limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1298[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/image_logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m        parser.add_argument([0m
[30;1m54 | [0m[35m            "--bucket-prefix",[0m
[30;1m55 | [0m[35m            help="Keypath under which exported logs data will be stored in s3 bucket. Defaults to "[0m
[30;1m56 | [0m[35m            "<image_id>-logs-<current time in the format of yyyyMMddHHmm>. If not specified `--bucke[0m
[30;1m57 | [0m[35m            f"cannot export logs to {PCLUSTER_BUCKET_PROTECTED_PREFIX} as it is a protected folder."[0m
[30;1m58 | [0m[35m        )[0m
[30;1m59 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1299[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/metadata.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2022 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1300[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/networking/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2018-2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1301[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/cluster_logs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m90 | [0m[35m        LOGGER.debug("Beginning export of logs for the cluster: %s", args.cluster_name)[0m
[30;1m91 | [0m[35m        cluster = Cluster(args.cluster_name)[0m
[30;1m92 | [0m[35m        url = cluster.export_logs([0m
[30;1m93 | [0m[35m            # cluster.bucket will handle the bucket init including policy update[0m
[30;1m94 | [0m[35m            bucket=args.bucket if args.bucket else cluster.bucket.name,[0m
[30;1m95 | [0m[35m            bucket_prefix=args.bucket_prefix,[0m
[30;1m96 | [0m[35m            keep_s3_objects=args.keep_s3_objects,[0m
[30;1m97 | [0m[35m            start_time=args.start_time,[0m

[31m--[ [0m[34mMatch #[0m[33m1302[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/cluster_logs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m#  Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m#  Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except [0m
[30;1m4 | [0m[35m#  with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m#  or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS[0m
[30;1m6 | [0m[35m#  OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governin[0m
[30;1m7 | [0m[35m#  limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1303[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/cluster_logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m62 | [0m[35m            help=([0m
[30;1m63 | [0m[35m                "Filter the logs. Format: 'Name=a,Values=1 Name=b,Values=2,3'.\nAccepted filters are[0m
[30;1m64 | [0m[35m                "private-dns-name - The short form of the private DNS name of the instance (e.g. ip-[0m
[30;1m65 | [0m[35m                "node-type - The node type, the only accepted value for this filter is HeadNode."[0m
[30;1m66 | [0m[35m            ),[0m
[30;1m67 | [0m[35m        )[0m
[30;1m68 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1304[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/cluster_logs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m49 | [0m[35m        parser.add_argument([0m
[30;1m50 | [0m[35m            "--bucket-prefix",[0m
[30;1m51 | [0m[35m            help="Keypath under which exported logs data will be stored in s3 bucket. Defaults to "[0m
[30;1m52 | [0m[35m            "<cluster_name>-logs-<current time in the format of yyyyMMddHHmm>. If not specified `--b[0m
[30;1m53 | [0m[35m            f"cannot export logs to {PCLUSTER_BUCKET_PROTECTED_PREFIX} as it is a protected folder."[0m
[30;1m54 | [0m[35m        )[0m
[30;1m55 | [0m[35m        super()._register_common_command_args(parser)[0m

[31m--[ [0m[34mMatch #[0m[33m1305[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/log_stream.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m192 | [0m[35m    def last_event_timestamp(self, last_event_timestamp):[0m
[30;1m193 | [0m[35m        """Sets the last_event_timestamp of this LogStream.[0m
[30;1m194 | [0m[35m[0m
[30;1m195 | [0m[35m        The time of the last event of the stream. The lastEventTime value updates on an eventual con[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m        :param last_event_timestamp: The last_event_timestamp of this LogStream.[0m
[30;1m198 | [0m[35m        :type last_event_timestamp: datetime[0m

[31m--[ [0m[34mMatch #[0m[33m1306[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/log_stream.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m181 | [0m[35m    def last_event_timestamp(self):[0m
[30;1m182 | [0m[35m        """Gets the last_event_timestamp of this LogStream.[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m        The time of the last event of the stream. The lastEventTime value updates on an eventual con[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m        :return: The last_event_timestamp of this LogStream.[0m
[30;1m187 | [0m[35m        :rtype: datetime[0m

[31m--[ [0m[34mMatch #[0m[33m1307[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/log_stream.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m169 | [0m[35m    def first_event_timestamp(self, first_event_timestamp):[0m
[30;1m170 | [0m[35m        """Sets the first_event_timestamp of this LogStream.[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m        The time of the first event of the stream.  # noqa: E501[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m        :param first_event_timestamp: The first_event_timestamp of this LogStream.[0m
[30;1m175 | [0m[35m        :type first_event_timestamp: datetime[0m

[31m--[ [0m[34mMatch #[0m[33m1308[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/log_stream.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m158 | [0m[35m    def first_event_timestamp(self):[0m
[30;1m159 | [0m[35m        """Gets the first_event_timestamp of this LogStream.[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35m        The time of the first event of the stream.  # noqa: E501[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m        :return: The first_event_timestamp of this LogStream.[0m
[30;1m164 | [0m[35m        :rtype: datetime[0m

[31m--[ [0m[34mMatch #[0m[33m1309[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/log_stream.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m119 | [0m[35m    def creation_time(self, creation_time):[0m
[30;1m120 | [0m[35m        """Sets the creation_time of this LogStream.[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m        The creation time of the stream.  # noqa: E501[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m        :param creation_time: The creation_time of this LogStream.[0m
[30;1m125 | [0m[35m        :type creation_time: datetime[0m

[31m--[ [0m[34mMatch #[0m[33m1310[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/log_stream.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m108 | [0m[35m    def creation_time(self):[0m
[30;1m109 | [0m[35m        """Gets the creation_time of this LogStream.[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m        The creation time of the stream.  # noqa: E501[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m        :return: The creation_time of this LogStream.[0m
[30;1m114 | [0m[35m        :rtype: datetime[0m

[31m--[ [0m[34mMatch #[0m[33m1311[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/kms_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1312[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_test.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m108 | [0m[35m          commands:[0m
[30;1m109 | [0m[35m            - |[0m
[30;1m110 | [0m[35m              set -vx[0m
[30;1m111 | [0m[35m              /opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent-ctl -a status | grep stat[0m
[30;1m112 | [0m[35m              [[ $? -ne 0 ]] && echo "amazon-cloudwatch-agent is not stopped" && exit 1[0m
[30;1m113 | [0m[35m              echo "CloudWatch test passed"[0m
[30;1m114 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1313[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_test.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m108 | [0m[35m          commands:[0m
[30;1m109 | [0m[35m            - |[0m
[30;1m110 | [0m[35m              set -vx[0m
[30;1m111 | [0m[35m              /opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent-ctl -a status | grep stat[0m
[30;1m112 | [0m[35m              [[ $? -ne 0 ]] && echo "amazon-cloudwatch-agent is not stopped" && exit 1[0m
[30;1m113 | [0m[35m              echo "CloudWatch test passed"[0m
[30;1m114 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1314[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_test.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m99 | [0m[35m                echo "test fabric-manager daemon"[0m
[30;1m100 | [0m[35m                systemctl show -p SubState nvidia-fabricmanager | grep -i running[0m
[30;1m101 | [0m[35m                [[ $? -ne 0 ]] && echo "fabric-manager daemon test failed" && exit 1[0m
[30;1m102 | [0m[35m                echo "NVIDIA Fabric Manager service correctly started"[0m
[30;1m103 | [0m[35m              fi[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m      - name: CloudWatch[0m

[31m--[ [0m[34mMatch #[0m[33m1315[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_test.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m97 | [0m[35m              set -vx[0m
[30;1m98 | [0m[35m              if [ {{ test.NvSwitches.outputs.stdout }} -gt 1 ]; then[0m
[30;1m99 | [0m[35m                echo "test fabric-manager daemon"[0m
[30;1m100 | [0m[35m                systemctl show -p SubState nvidia-fabricmanager | grep -i running[0m
[30;1m101 | [0m[35m                [[ $? -ne 0 ]] && echo "fabric-manager daemon test failed" && exit 1[0m
[30;1m102 | [0m[35m                echo "NVIDIA Fabric Manager service correctly started"[0m
[30;1m103 | [0m[35m              fi[0m

[31m--[ [0m[34mMatch #[0m[33m1316[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_test.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m97 | [0m[35m              set -vx[0m
[30;1m98 | [0m[35m              if [ {{ test.NvSwitches.outputs.stdout }} -gt 1 ]; then[0m
[30;1m99 | [0m[35m                echo "test fabric-manager daemon"[0m
[30;1m100 | [0m[35m                systemctl show -p SubState nvidia-fabricmanager | grep -i running[0m
[30;1m101 | [0m[35m                [[ $? -ne 0 ]] && echo "fabric-manager daemon test failed" && exit 1[0m
[30;1m102 | [0m[35m                echo "NVIDIA Fabric Manager service correctly started"[0m
[30;1m103 | [0m[35m              fi[0m

[31m--[ [0m[34mMatch #[0m[33m1317[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_test.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m86 | [0m[35m            - |[0m
[30;1m87 | [0m[35m              set -v[0m
[30;1m88 | [0m[35m              PATTERN=$(jq '.default.cluster.reserved_base_uid' {{ CookbookDefaultFile }})[0m
[30;1m89 | [0m[35m              RESERVED_BASE_UID=$(echo ${PATTERN} | tr -d '\n' | cut -d = -f 2 | xargs)[0m
[30;1m90 | [0m[35m              echo "${RESERVED_BASE_UID}"[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m      - name: FabricManager[0m

[31m--[ [0m[34mMatch #[0m[33m1318[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_test.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m            - |[0m
[30;1m67 | [0m[35m              set -v[0m
[30;1m68 | [0m[35m              PATTERN=$(jq '.default.cluster."python-version"' {{ CookbookDefaultFile }})[0m
[30;1m69 | [0m[35m              VERSION=$(echo ${PATTERN} | tr -d '\n' | cut -d = -f 2 | xargs)[0m
[30;1m70 | [0m[35m              echo ${VERSION}[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m      ### utils ###[0m

[31m--[ [0m[34mMatch #[0m[33m1319[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_test.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m                OS='rocky8'[0m
[30;1m51 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rhel\.9'` ]; then[0m
[30;1m52 | [0m[35m                OS='rhel9'[0m
[30;1m53 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rocky\.9'` ]; then[0m
[30;1m54 | [0m[35m                OS='rocky9'[0m
[30;1m55 | [0m[35m              else[0m
[30;1m56 | [0m[35m                echo "Operating System '${RELEASE}' is not supported. Failing build." && exit 1[0m

[31m--[ [0m[34mMatch #[0m[33m1320[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_test.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m                OS='rhel8'[0m
[30;1m49 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rocky\.8'` ]; then[0m
[30;1m50 | [0m[35m                OS='rocky8'[0m
[30;1m51 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rhel\.9'` ]; then[0m
[30;1m52 | [0m[35m                OS='rhel9'[0m
[30;1m53 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rocky\.9'` ]; then[0m
[30;1m54 | [0m[35m                OS='rocky9'[0m

[31m--[ [0m[34mMatch #[0m[33m1321[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_test.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m                OS='ubuntu2404'[0m
[30;1m47 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rhel\.8'` ]; then[0m
[30;1m48 | [0m[35m                OS='rhel8'[0m
[30;1m49 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rocky\.8'` ]; then[0m
[30;1m50 | [0m[35m                OS='rocky8'[0m
[30;1m51 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rhel\.9'` ]; then[0m
[30;1m52 | [0m[35m                OS='rhel9'[0m

[31m--[ [0m[34mMatch #[0m[33m1322[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_test.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m                OS='ubuntu2204'[0m
[30;1m45 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^ubuntu\.24'` ]; then[0m
[30;1m46 | [0m[35m                OS='ubuntu2404'[0m
[30;1m47 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rhel\.8'` ]; then[0m
[30;1m48 | [0m[35m                OS='rhel8'[0m
[30;1m49 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rocky\.8'` ]; then[0m
[30;1m50 | [0m[35m                OS='rocky8'[0m

[31m--[ [0m[34mMatch #[0m[33m1323[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_test.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35m                OS='ubuntu2004'[0m
[30;1m43 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^ubuntu\.22'` ]; then[0m
[30;1m44 | [0m[35m                OS='ubuntu2204'[0m
[30;1m45 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^ubuntu\.24'` ]; then[0m
[30;1m46 | [0m[35m                OS='ubuntu2404'[0m
[30;1m47 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^rhel\.8'` ]; then[0m
[30;1m48 | [0m[35m                OS='rhel8'[0m

[31m--[ [0m[34mMatch #[0m[33m1324[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_test.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m                OS='alinux2023'[0m
[30;1m41 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^ubuntu\.20'` ]; then[0m
[30;1m42 | [0m[35m                OS='ubuntu2004'[0m
[30;1m43 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^ubuntu\.22'` ]; then[0m
[30;1m44 | [0m[35m                OS='ubuntu2204'[0m
[30;1m45 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^ubuntu\.24'` ]; then[0m
[30;1m46 | [0m[35m                OS='ubuntu2404'[0m

[31m--[ [0m[34mMatch #[0m[33m1325[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_test.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m                OS='alinux2'[0m
[30;1m39 | [0m[35m              elif [ `echo "${RELEASE}" | grep -w '^amzn\.2023'` ]; then[0m
[30;1m40 | [0m[35m                OS='alinux2023'[0m
[30;1m41 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^ubuntu\.20'` ]; then[0m
[30;1m42 | [0m[35m                OS='ubuntu2004'[0m
[30;1m43 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^ubuntu\.22'` ]; then[0m
[30;1m44 | [0m[35m                OS='ubuntu2204'[0m

[31m--[ [0m[34mMatch #[0m[33m1326[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_test.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m              if [ `echo "${RELEASE}" | grep -w '^amzn\.2'` ]; then[0m
[30;1m38 | [0m[35m                OS='alinux2'[0m
[30;1m39 | [0m[35m              elif [ `echo "${RELEASE}" | grep -w '^amzn\.2023'` ]; then[0m
[30;1m40 | [0m[35m                OS='alinux2023'[0m
[30;1m41 | [0m[35m              elif [ `echo "${RELEASE}" | grep '^ubuntu\.20'` ]; then[0m
[30;1m42 | [0m[35m                OS='ubuntu2004'[0m

[31m--[ [0m[34mMatch #[0m[33m1327[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_test.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m              set -v[0m
[30;1m35 | [0m[35m              RELEASE='{{ test.OperatingSystemRelease.outputs.stdout }}'[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m              if [ `echo "${RELEASE}" | grep -w '^amzn\.2'` ]; then[0m
[30;1m38 | [0m[35m                OS='alinux2'[0m
[30;1m39 | [0m[35m              elif [ `echo "${RELEASE}" | grep -w '^amzn\.2023'` ]; then[0m
[30;1m40 | [0m[35m                OS='alinux2023'[0m

[31m--[ [0m[34mMatch #[0m[33m1328[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/cluster_status.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1329[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/config_validation_message.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1330[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/mount_efs.sh[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m4 | [0m[35m#[0m
[30;1m5 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You[0m
[30;1m6 | [0m[35m# may not use this file except in compliance with the License. A copy[0m
[30;1m7 | [0m[35m# of the License is located at[0m
[30;1m8 | [0m[35m#[0m
[30;1m9 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m10 | [0m[35m#[0m
[30;1m11 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is[0m

[31m--[ [0m[34mMatch #[0m[33m1331[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/mount_efs.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m69 | [0m[35m    fi[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    # Check that the filesystem is mounted as appropriate[0m
[30;1m72 | [0m[35m    mount_line=$(mount | grep "${efs_dir}")[0m
[30;1m73 | [0m[35m    if [[ -z "${mount_line}" ]]; then[0m
[30;1m74 | [0m[35m        error_exit "mount succeeded but nfs volume from ${efs_dir} was not mounted as expected"[0m
[30;1m75 | [0m[35m    fi[0m

[31m--[ [0m[34mMatch #[0m[33m1332[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/mount_efs.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35m    mkdir -p ${shared_dir}[0m
[30;1m66 | [0m[35m    error_message=$(mount -t nfs4 -o nfsvers=4.1,rsize=1048576,wsize=1048576,hard,timeo=600,retrans=[0m
[30;1m67 | [0m[35m    if [[ $? -ne 0 ]]; then[0m
[30;1m68 | [0m[35m        error_exit "Failed to mount nfs volume from ${efs_dir} with error_message: ${error_message}"[0m
[30;1m69 | [0m[35m    fi[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    # Check that the filesystem is mounted as appropriate[0m

[31m--[ [0m[34mMatch #[0m[33m1333[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/mount_efs.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m    fi[0m
[30;1m55 | [0m[35m}[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m# mount nfs[0m
[30;1m58 | [0m[35mmount_nfs() {[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m    error_message=$(rpcinfo &> /dev/null || rpcbind 2>&1)[0m

[31m--[ [0m[34mMatch #[0m[33m1334[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/mount_efs.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35musage() {[0m
[30;1m30 | [0m[35m    cat <<ENDUSAGE[0m
[30;1m31 | [0m[35m    This script mounts EFS filesystem on shared dir on the nodes in the batch job.[0m
[30;1m32 | [0m[35m    The shared directory will be created if it does not exist.[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    USAGE:[0m

[31m--[ [0m[34mMatch #[0m[33m1335[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/mount_efs.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m}[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35musage() {[0m
[30;1m30 | [0m[35m    cat <<ENDUSAGE[0m
[30;1m31 | [0m[35m    This script mounts EFS filesystem on shared dir on the nodes in the batch job.[0m
[30;1m32 | [0m[35m    The shared directory will be created if it does not exist.[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1336[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/modify_yum_vars.sh[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m4 | [0m[35m#[0m
[30;1m5 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You[0m
[30;1m6 | [0m[35m# may not use this file except in compliance with the License. A copy[0m
[30;1m7 | [0m[35m# of the License is located at[0m
[30;1m8 | [0m[35m#[0m
[30;1m9 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m10 | [0m[35m#[0m
[30;1m11 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is[0m

[31m--[ [0m[34mMatch #[0m[33m1337[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/modify_yum_vars.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m56 | [0m[35m        echo "https" > /etc/yum/vars/awsproto[0m
[30;1m57 | [0m[35m        echo "${REGION}" > /etc/yum/vars/awsregion[0m
[30;1m58 | [0m[35m    else[0m
[30;1m59 | [0m[35m        echo "Not running in China or Isolated region. Skipping modification of yum variables."[0m
[30;1m60 | [0m[35m    fi[0m
[30;1m61 | [0m[35m}[0m
[30;1m62 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1338[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/modify_yum_vars.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m        error_exit_usage "Wrong number of arguments provided"[0m
[30;1m41 | [0m[35m    fi[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    # Modify yum repo variables if cluster is running in a region with non default AWS domain.[0m
[30;1m44 | [0m[35m    local REGION="${1}"[0m
[30;1m45 | [0m[35m    local AWS_DOMAIN="amazonaws.com"[0m
[30;1m46 | [0m[35m    if [[ ${REGION} == cn-* ]]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1339[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/modify_yum_vars.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35musage() {[0m
[30;1m20 | [0m[35m    cat <<ENDUSAGE[0m
[30;1m21 | [0m[35mThis script modifies yum repo variables so that the Amazon Linux 2 repo points to the region-specifi[0m
[30;1m22 | [0m[35mThe modification is only made if the cluster is running in a China or Isolated region.[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35mUSAGE:[0m

[31m--[ [0m[34mMatch #[0m[33m1340[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/modify_yum_vars.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35musage() {[0m
[30;1m20 | [0m[35m    cat <<ENDUSAGE[0m
[30;1m21 | [0m[35mThis script modifies yum repo variables so that the Amazon Linux 2 repo points to the region-specifi[0m
[30;1m22 | [0m[35mThe modification is only made if the cluster is running in a China or Isolated region.[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35mUSAGE:[0m

[31m--[ [0m[34mMatch #[0m[33m1341[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/modify_yum_vars.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35m#   modify_china_yum_vars.sh <region>[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35musage() {[0m
[30;1m20 | [0m[35m    cat <<ENDUSAGE[0m
[30;1m21 | [0m[35mThis script modifies yum repo variables so that the Amazon Linux 2 repo points to the region-specifi[0m
[30;1m22 | [0m[35mThe modification is only made if the cluster is running in a China or Isolated region.[0m
[30;1m23 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1342[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/ec2_ami_info.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1343[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/tag.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1344[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/slurm_builder.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m    def register_policies_with_role(self, scope, managed_compute_instance_roles: Dict[str, iam.CfnRo[0m
[30;1m110 | [0m[35m        """[0m
[30;1m111 | [0m[35m        Associate the Slurm Policies to the compute node roles.[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m        The Slurm Policies specify permissions for accessing Route53 and DynamoDB resources.[0m
[30;1m114 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1345[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/templates/slurm_builder.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1346[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m200 | [0m[35m              # ARM - No version file[0m
[30;1m201 | [0m[35m              if [ -z "${CUDA_VERSION}" ] && [ -d /usr/local/cuda ]; then[0m
[30;1m202 | [0m[35m                # Get cuda version from chef attributes[0m
[30;1m203 | [0m[35m                CUDA_VERSION=$(jq '.default.cluster.nvidia.cuda_version' {{ CookbookDefaultFile }} |[0m
[30;1m204 | [0m[35m              fi[0m
[30;1m205 | [0m[35m              add_tag "parallelcluster:cuda_version" "${CUDA_VERSION}"[0m
[30;1m206 | [0m[35m              append_description "cuda" "${CUDA_VERSION}"[0m

[31m--[ [0m[34mMatch #[0m[33m1347[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m195 | [0m[35m              CUDA_VERSION="$(cat /usr/local/cuda/version.json | jq -r '.cuda.version')"[0m
[30;1m196 | [0m[35m              # version 11.0, version.txt (11.1 does not seem to have a version file)[0m
[30;1m197 | [0m[35m              if [ -z "${CUDA_VERSION}" ]; then[0m
[30;1m198 | [0m[35m                CUDA_VERSION="$(cat /usr/local/cuda/version.txt | cut -d' ' -f3)"[0m
[30;1m199 | [0m[35m              fi[0m
[30;1m200 | [0m[35m              # ARM - No version file[0m
[30;1m201 | [0m[35m              if [ -z "${CUDA_VERSION}" ] && [ -d /usr/local/cuda ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1348[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m132 | [0m[35m              get_modinfo () {[0m
[30;1m133 | [0m[35m                set -o pipefail[0m
[30;1m134 | [0m[35m                MODULE_NAME="$1"[0m
[30;1m135 | [0m[35m                VERSION=$(modinfo "${MODULE_NAME}" 2> /dev/null | grep -i "^version:" | tr -s ' ' | [0m
[30;1m136 | [0m[35m                echo "${VERSION}"[0m
[30;1m137 | [0m[35m                set +o pipefail[0m
[30;1m138 | [0m[35m              }[0m

[31m--[ [0m[34mMatch #[0m[33m1349[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m132 | [0m[35m              get_modinfo () {[0m
[30;1m133 | [0m[35m                set -o pipefail[0m
[30;1m134 | [0m[35m                MODULE_NAME="$1"[0m
[30;1m135 | [0m[35m                VERSION=$(modinfo "${MODULE_NAME}" 2> /dev/null | grep -i "^version:" | tr -s ' ' | [0m
[30;1m136 | [0m[35m                echo "${VERSION}"[0m
[30;1m137 | [0m[35m                set +o pipefail[0m
[30;1m138 | [0m[35m              }[0m

[31m--[ [0m[34mMatch #[0m[33m1350[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m122 | [0m[35m                if [ $(which apt 2> /dev/null) ]; then[0m
[30;1m123 | [0m[35m                  VERSION=$(dpkg -s "${PACKAGE_NAME}" 2> /dev/null | grep -i "^version:" | tr -s ' '[0m
[30;1m124 | [0m[35m                  echo "${VERSION}"[0m
[30;1m125 | [0m[35m                elif [ $(which yum 2> /dev/null) ]; then[0m
[30;1m126 | [0m[35m                  VERSION=$(rpm -q "${PACKAGE_NAME}" 2> /dev/null || echo "NOT_INSTALLED")[0m
[30;1m127 | [0m[35m                  echo "${VERSION#${PACKAGE_NAME}-}"[0m
[30;1m128 | [0m[35m                fi[0m

[31m--[ [0m[34mMatch #[0m[33m1351[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m120 | [0m[35m                set -o pipefail[0m
[30;1m121 | [0m[35m                PACKAGE_NAME="$1"[0m
[30;1m122 | [0m[35m                if [ $(which apt 2> /dev/null) ]; then[0m
[30;1m123 | [0m[35m                  VERSION=$(dpkg -s "${PACKAGE_NAME}" 2> /dev/null | grep -i "^version:" | tr -s ' '[0m
[30;1m124 | [0m[35m                  echo "${VERSION}"[0m
[30;1m125 | [0m[35m                elif [ $(which yum 2> /dev/null) ]; then[0m
[30;1m126 | [0m[35m                  VERSION=$(rpm -q "${PACKAGE_NAME}" 2> /dev/null || echo "NOT_INSTALLED")[0m

[31m--[ [0m[34mMatch #[0m[33m1352[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m120 | [0m[35m                set -o pipefail[0m
[30;1m121 | [0m[35m                PACKAGE_NAME="$1"[0m
[30;1m122 | [0m[35m                if [ $(which apt 2> /dev/null) ]; then[0m
[30;1m123 | [0m[35m                  VERSION=$(dpkg -s "${PACKAGE_NAME}" 2> /dev/null | grep -i "^version:" | tr -s ' '[0m
[30;1m124 | [0m[35m                  echo "${VERSION}"[0m
[30;1m125 | [0m[35m                elif [ $(which yum 2> /dev/null) ]; then[0m
[30;1m126 | [0m[35m                  VERSION=$(rpm -q "${PACKAGE_NAME}" 2> /dev/null || echo "NOT_INSTALLED")[0m

[31m--[ [0m[34mMatch #[0m[33m1353[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m119 | [0m[35m              get_package_version () {[0m
[30;1m120 | [0m[35m                set -o pipefail[0m
[30;1m121 | [0m[35m                PACKAGE_NAME="$1"[0m
[30;1m122 | [0m[35m                if [ $(which apt 2> /dev/null) ]; then[0m
[30;1m123 | [0m[35m                  VERSION=$(dpkg -s "${PACKAGE_NAME}" 2> /dev/null | grep -i "^version:" | tr -s ' '[0m
[30;1m124 | [0m[35m                  echo "${VERSION}"[0m
[30;1m125 | [0m[35m                elif [ $(which yum 2> /dev/null) ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1354[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m110 | [0m[35m                VALUE="$2"[0m
[30;1m111 | [0m[35m                if [[ -n "${VALUE}" ]] && [[ ! "${VALUE}" =~ NOT_INSTALLED ]]; then[0m
[30;1m112 | [0m[35m                  KEY="$(echo ${KEY} | cut -c -128)"[0m
[30;1m113 | [0m[35m                  VALUE="$(echo ${VALUE} | cut -c -256)"[0m
[30;1m114 | [0m[35m                  echo "Adding Tag Key=${KEY},Value=${VALUE}"[0m
[30;1m115 | [0m[35m                  aws ec2 create-tags --region {{ test.AWSRegion.outputs.stdout }} --resource {{ tes[0m
[30;1m116 | [0m[35m                fi[0m

[31m--[ [0m[34mMatch #[0m[33m1355[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m109 | [0m[35m                KEY="$1"[0m
[30;1m110 | [0m[35m                VALUE="$2"[0m
[30;1m111 | [0m[35m                if [[ -n "${VALUE}" ]] && [[ ! "${VALUE}" =~ NOT_INSTALLED ]]; then[0m
[30;1m112 | [0m[35m                  KEY="$(echo ${KEY} | cut -c -128)"[0m
[30;1m113 | [0m[35m                  VALUE="$(echo ${VALUE} | cut -c -256)"[0m
[30;1m114 | [0m[35m                  echo "Adding Tag Key=${KEY},Value=${VALUE}"[0m
[30;1m115 | [0m[35m                  aws ec2 create-tags --region {{ test.AWSRegion.outputs.stdout }} --resource {{ tes[0m

[31m--[ [0m[34mMatch #[0m[33m1356[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m100 | [0m[35m              }[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m              add_description () {[0m
[30;1m103 | [0m[35m                DESCRIPTION="$(echo ${DESCRIPTION} | cut -c -1024)"[0m
[30;1m104 | [0m[35m                echo "Setting decription to ${DESCRIPTION}"[0m
[30;1m105 | [0m[35m                aws ec2 modify-image-attribute --region {{ test.AWSRegion.outputs.stdout }} --image-[0m
[30;1m106 | [0m[35m              }[0m

[31m--[ [0m[34mMatch #[0m[33m1357[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m84 | [0m[35m                  apt-get -y install unzip[0m
[30;1m85 | [0m[35m                fi[0m
[30;1m86 | [0m[35m                echo "Installing AWS CLI"[0m
[30;1m87 | [0m[35m                curl --retry 3 -L -o /tmp/awscliv2.zip "https://awscli.amazonaws.com/awscli-exe-linu[0m
[30;1m88 | [0m[35m                cd /tmp/ && unzip awscliv2.zip[0m
[30;1m89 | [0m[35m                ./aws/install[0m
[30;1m90 | [0m[35m              fi[0m

[31m--[ [0m[34mMatch #[0m[33m1358[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m                if [[ "{{ test.OperatingSystemName.outputs.stdout }}" =~ ^(alinux|rhel|rocky) ]]; th[0m
[30;1m82 | [0m[35m                  yum -y install unzip[0m
[30;1m83 | [0m[35m                elif [[ "{{ test.OperatingSystemName.outputs.stdout }}" =~ ^ubuntu ]]; then[0m
[30;1m84 | [0m[35m                  apt-get -y install unzip[0m
[30;1m85 | [0m[35m                fi[0m
[30;1m86 | [0m[35m                echo "Installing AWS CLI"[0m
[30;1m87 | [0m[35m                curl --retry 3 -L -o /tmp/awscliv2.zip "https://awscli.amazonaws.com/awscli-exe-linu[0m

[31m--[ [0m[34mMatch #[0m[33m1359[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m              if [[ $? -ne 0 ]]; then[0m
[30;1m80 | [0m[35m                echo "Installing unzip"[0m
[30;1m81 | [0m[35m                if [[ "{{ test.OperatingSystemName.outputs.stdout }}" =~ ^(alinux|rhel|rocky) ]]; th[0m
[30;1m82 | [0m[35m                  yum -y install unzip[0m
[30;1m83 | [0m[35m                elif [[ "{{ test.OperatingSystemName.outputs.stdout }}" =~ ^ubuntu ]]; then[0m
[30;1m84 | [0m[35m                  apt-get -y install unzip[0m
[30;1m85 | [0m[35m                fi[0m

[31m--[ [0m[34mMatch #[0m[33m1360[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35m                OS='rocky8'[0m
[30;1m62 | [0m[35m              elif [ $(echo "${RELEASE}" | grep '^rhel\.9') ]; then[0m
[30;1m63 | [0m[35m                OS='rhel9'[0m
[30;1m64 | [0m[35m              elif [ $(echo "${RELEASE}" | grep '^rocky\.9') ]; then[0m
[30;1m65 | [0m[35m                OS='rocky9'[0m
[30;1m66 | [0m[35m              fi[0m
[30;1m67 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1361[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m                OS='rhel8'[0m
[30;1m60 | [0m[35m              elif [ $(echo "${RELEASE}" | grep '^rocky\.8') ]; then[0m
[30;1m61 | [0m[35m                OS='rocky8'[0m
[30;1m62 | [0m[35m              elif [ $(echo "${RELEASE}" | grep '^rhel\.9') ]; then[0m
[30;1m63 | [0m[35m                OS='rhel9'[0m
[30;1m64 | [0m[35m              elif [ $(echo "${RELEASE}" | grep '^rocky\.9') ]; then[0m
[30;1m65 | [0m[35m                OS='rocky9'[0m

[31m--[ [0m[34mMatch #[0m[33m1362[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m                OS='ubuntu2404'[0m
[30;1m58 | [0m[35m              elif [ $(echo "${RELEASE}" | grep '^rhel\.8') ]; then[0m
[30;1m59 | [0m[35m                OS='rhel8'[0m
[30;1m60 | [0m[35m              elif [ $(echo "${RELEASE}" | grep '^rocky\.8') ]; then[0m
[30;1m61 | [0m[35m                OS='rocky8'[0m
[30;1m62 | [0m[35m              elif [ $(echo "${RELEASE}" | grep '^rhel\.9') ]; then[0m
[30;1m63 | [0m[35m                OS='rhel9'[0m

[31m--[ [0m[34mMatch #[0m[33m1363[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m                OS='ubuntu2204'[0m
[30;1m56 | [0m[35m              elif [ $(echo "${RELEASE}" | grep '^ubuntu\.24') ]; then[0m
[30;1m57 | [0m[35m                OS='ubuntu2404'[0m
[30;1m58 | [0m[35m              elif [ $(echo "${RELEASE}" | grep '^rhel\.8') ]; then[0m
[30;1m59 | [0m[35m                OS='rhel8'[0m
[30;1m60 | [0m[35m              elif [ $(echo "${RELEASE}" | grep '^rocky\.8') ]; then[0m
[30;1m61 | [0m[35m                OS='rocky8'[0m

[31m--[ [0m[34mMatch #[0m[33m1364[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m                OS='ubuntu2004'[0m
[30;1m54 | [0m[35m              elif [ $(echo "${RELEASE}" | grep '^ubuntu\.22') ]; then[0m
[30;1m55 | [0m[35m                OS='ubuntu2204'[0m
[30;1m56 | [0m[35m              elif [ $(echo "${RELEASE}" | grep '^ubuntu\.24') ]; then[0m
[30;1m57 | [0m[35m                OS='ubuntu2404'[0m
[30;1m58 | [0m[35m              elif [ $(echo "${RELEASE}" | grep '^rhel\.8') ]; then[0m
[30;1m59 | [0m[35m                OS='rhel8'[0m

[31m--[ [0m[34mMatch #[0m[33m1365[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m                OS='alinux2023'[0m
[30;1m52 | [0m[35m              elif [ $(echo "${RELEASE}" | grep '^ubuntu\.20') ]; then[0m
[30;1m53 | [0m[35m                OS='ubuntu2004'[0m
[30;1m54 | [0m[35m              elif [ $(echo "${RELEASE}" | grep '^ubuntu\.22') ]; then[0m
[30;1m55 | [0m[35m                OS='ubuntu2204'[0m
[30;1m56 | [0m[35m              elif [ $(echo "${RELEASE}" | grep '^ubuntu\.24') ]; then[0m
[30;1m57 | [0m[35m                OS='ubuntu2404'[0m

[31m--[ [0m[34mMatch #[0m[33m1366[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m49 | [0m[35m                OS='alinux2'[0m
[30;1m50 | [0m[35m              elif [ $(echo "${RELEASE}" | grep -w '^amzn\.2023') ]; then[0m
[30;1m51 | [0m[35m                OS='alinux2023'[0m
[30;1m52 | [0m[35m              elif [ $(echo "${RELEASE}" | grep '^ubuntu\.20') ]; then[0m
[30;1m53 | [0m[35m                OS='ubuntu2004'[0m
[30;1m54 | [0m[35m              elif [ $(echo "${RELEASE}" | grep '^ubuntu\.22') ]; then[0m
[30;1m55 | [0m[35m                OS='ubuntu2204'[0m

[31m--[ [0m[34mMatch #[0m[33m1367[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m              if [ $(echo "${RELEASE}" | grep -w '^amzn\.2') ]; then[0m
[30;1m49 | [0m[35m                OS='alinux2'[0m
[30;1m50 | [0m[35m              elif [ $(echo "${RELEASE}" | grep -w '^amzn\.2023') ]; then[0m
[30;1m51 | [0m[35m                OS='alinux2023'[0m
[30;1m52 | [0m[35m              elif [ $(echo "${RELEASE}" | grep '^ubuntu\.20') ]; then[0m
[30;1m53 | [0m[35m                OS='ubuntu2004'[0m

[31m--[ [0m[34mMatch #[0m[33m1368[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/parallelcluster_tag.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m                RELEASE="${ID}${VERSION_ID:+.${VERSION_ID}}"[0m
[30;1m46 | [0m[35m              fi[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m              if [ $(echo "${RELEASE}" | grep -w '^amzn\.2') ]; then[0m
[30;1m49 | [0m[35m                OS='alinux2'[0m
[30;1m50 | [0m[35m              elif [ $(echo "${RELEASE}" | grep -w '^amzn\.2023') ]; then[0m
[30;1m51 | [0m[35m                OS='alinux2023'[0m

[31m--[ [0m[34mMatch #[0m[33m1369[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/ec2_ami_state.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1370[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/tags_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2023 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1371[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/version.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m#  Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m#  Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except [0m
[30;1m4 | [0m[35m#  with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m#  or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS[0m
[30;1m6 | [0m[35m#  OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governin[0m
[30;1m7 | [0m[35m#  limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1372[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/commands.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1373[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/cluster_status_filtering_option.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m#  Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m#  Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except [0m
[30;1m4 | [0m[35m#  with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m#  or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS[0m
[30;1m6 | [0m[35m#  OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governin[0m
[30;1m7 | [0m[35m#  limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1374[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/update_error.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1375[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/cluster_info_summary.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1376[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/subnet_computation.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m70 | [0m[35m    subnets_limits = [_get_cidr_limits_as_decimal(subnet) for subnet in occupied_cidrs][0m
[30;1m71 | [0m[35m    subnets_limits.sort(key=lambda x: x[upper_limit_index])[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m    #  Looking at space between occupied cidrs[0m
[30;1m74 | [0m[35m    resulting_cidr = None[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35m    subnets_limits.append((vpc_end_address_decimal, vpc_end_address_decimal))[0m

[31m--[ [0m[34mMatch #[0m[33m1377[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/subnet_computation.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1378[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/subnet_computation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35mdef _ip_to_decimal(ip_addr):[0m
[30;1m132 | [0m[35m    """Transform an ip into its decimal representation."""[0m
[30;1m133 | [0m[35m    return int(ip_address(unicode(ip_addr)))[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1379[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/subnet_computation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35mdef _get_cidr_limits_as_decimal(cidr):[0m
[30;1m119 | [0m[35m    """[0m
[30;1m120 | [0m[35m    Given a cidr, return the begin ip and the end ip as decimal.[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m    For example, given the cidr 10.0.0.0/24, it will return 167772160, which is 10.0.0.0 and 1677724[0m
[30;1m123 | [0m[35m    which is 10.0.1.0[0m

[31m--[ [0m[34mMatch #[0m[33m1380[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/subnet_computation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35mdef _get_cidr_limits_as_decimal(cidr):[0m
[30;1m119 | [0m[35m    """[0m
[30;1m120 | [0m[35m    Given a cidr, return the begin ip and the end ip as decimal.[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m    For example, given the cidr 10.0.0.0/24, it will return 167772160, which is 10.0.0.0 and 1677724[0m
[30;1m123 | [0m[35m    which is 10.0.1.0[0m

[31m--[ [0m[34mMatch #[0m[33m1381[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/subnet_computation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35mdef _decimal_ip_limits_to_cidr(begin, end):[0m
[30;1m114 | [0m[35m    """Given begin and end ip (as decimals number), return the CIDR that begins with begin ip and en[0m
[30;1m115 | [0m[35m    return str(next(summarize_address_range(ip_address(begin), ip_address(end))))[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1382[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/subnet_computation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35mdef _decimal_ip_limits_to_cidr(begin, end):[0m
[30;1m114 | [0m[35m    """Given begin and end ip (as decimals number), return the CIDR that begins with begin ip and en[0m
[30;1m115 | [0m[35m    return str(next(summarize_address_range(ip_address(begin), ip_address(end))))[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1383[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/subnet_computation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m    bigger or equal to the one we are targeting. In order to do that, if a subnet is smaller than ta[0m
[30;1m45 | [0m[35m    find the bigger one to which she is part of.[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    After that, we will sort the subnet by cidr and than look for space between the end of one subne[0m
[30;1m48 | [0m[35m    of the other, not forgetting to also look for space in the begin and end.[0m
[30;1m49 | [0m[35m    :param vpc_cidr: the vpc_cidr in which the suitable subnet should be[0m
[30;1m50 | [0m[35m    :param occupied_cidrs: a list of cidr of the already occupied subnets in the vpc[0m

[31m--[ [0m[34mMatch #[0m[33m1384[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/subnet_computation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    In order to find a space in between all the subnets we have, we first start by making all the oc[0m
[30;1m44 | [0m[35m    bigger or equal to the one we are targeting. In order to do that, if a subnet is smaller than ta[0m
[30;1m45 | [0m[35m    find the bigger one to which she is part of.[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    After that, we will sort the subnet by cidr and than look for space between the end of one subne[0m
[30;1m48 | [0m[35m    of the other, not forgetting to also look for space in the begin and end.[0m

[31m--[ [0m[34mMatch #[0m[33m1385[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/subnet_computation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m40 | [0m[35m    """[0m
[30;1m41 | [0m[35m    Decide the first smallest suitable CIDR for a subnet with size >= target_size.[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    In order to find a space in between all the subnets we have, we first start by making all the oc[0m
[30;1m44 | [0m[35m    bigger or equal to the one we are targeting. In order to do that, if a subnet is smaller than ta[0m
[30;1m45 | [0m[35m    find the bigger one to which she is part of.[0m
[30;1m46 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1386[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35mdef get_resource_tag(resource, tag_name):[0m
[30;1m234 | [0m[35m    tags = resource.get("Tags", [])[0m
[30;1m235 | [0m[35m    return next((item.get("Value") for item in tags if item.get("Key") == tag_name), None)[0m

[31m--[ [0m[34mMatch #[0m[33m1387[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35mdef get_resource_tag(resource, tag_name):[0m
[30;1m234 | [0m[35m    tags = resource.get("Tags", [])[0m
[30;1m235 | [0m[35m    return next((item.get("Value") for item in tags if item.get("Key") == tag_name), None)[0m

[31m--[ [0m[34mMatch #[0m[33m1388[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35mdef get_resource_tag(resource, tag_name):[0m
[30;1m234 | [0m[35m    tags = resource.get("Tags", [])[0m
[30;1m235 | [0m[35m    return next((item.get("Value") for item in tags if item.get("Key") == tag_name), None)[0m

[31m--[ [0m[34mMatch #[0m[33m1389[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m    ec2 = boto3.client("ec2")[0m
[30;1m203 | [0m[35m    regions = ec2.describe_regions().get("Regions")[0m
[30;1m204 | [0m[35m    regions = [[0m
[30;1m205 | [0m[35m        region.get("RegionName") for region in regions if region.get("RegionName") in retrieve_suppo[0m
[30;1m206 | [0m[35m    ][0m
[30;1m207 | [0m[35m    regions.sort()[0m
[30;1m208 | [0m[35m    return regions[0m

[31m--[ [0m[34mMatch #[0m[33m1390[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m202 | [0m[35m    ec2 = boto3.client("ec2")[0m
[30;1m203 | [0m[35m    regions = ec2.describe_regions().get("Regions")[0m
[30;1m204 | [0m[35m    regions = [[0m
[30;1m205 | [0m[35m        region.get("RegionName") for region in regions if region.get("RegionName") in retrieve_suppo[0m
[30;1m206 | [0m[35m    ][0m
[30;1m207 | [0m[35m    regions.sort()[0m
[30;1m208 | [0m[35m    return regions[0m

[31m--[ [0m[34mMatch #[0m[33m1391[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m200 | [0m[35m@handle_client_exception[0m
[30;1m201 | [0m[35mdef get_regions():[0m
[30;1m202 | [0m[35m    ec2 = boto3.client("ec2")[0m
[30;1m203 | [0m[35m    regions = ec2.describe_regions().get("Regions")[0m
[30;1m204 | [0m[35m    regions = [[0m
[30;1m205 | [0m[35m        region.get("RegionName") for region in regions if region.get("RegionName") in retrieve_suppo[0m
[30;1m206 | [0m[35m    ][0m

[31m--[ [0m[34mMatch #[0m[33m1392[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m    opinionated_suggestions = {"Scheduler": "slurm", "Operating System": "alinux2"}[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    if parameter in opinionated_suggestions:[0m
[30;1m52 | [0m[35m        default = opinionated_suggestions.get(parameter)[0m
[30;1m53 | [0m[35m    elif isinstance(options, (list, tuple)):[0m
[30;1m54 | [0m[35m        default = options[0]["id"] if isinstance(options[0], dict) else options[0][0m
[30;1m55 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m1393[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2013-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the 'License'). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the 'LICENSE.txt' file accompanying this file. This file is distributed on an 'AS IS' BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1394[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/not_found_exception_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1395[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/describe_compute_fleet_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m86 | [0m[35m    def last_status_updated_time(self, last_status_updated_time):[0m
[30;1m87 | [0m[35m        """Sets the last_status_updated_time of this DescribeComputeFleetResponseContent.[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m        Timestamp representing the last status update time.  # noqa: E501[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m        :param last_status_updated_time: The last_status_updated_time of this DescribeComputeFleetRe[0m
[30;1m92 | [0m[35m        :type last_status_updated_time: datetime[0m

[31m--[ [0m[34mMatch #[0m[33m1396[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/describe_compute_fleet_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m75 | [0m[35m    def last_status_updated_time(self):[0m
[30;1m76 | [0m[35m        """Gets the last_status_updated_time of this DescribeComputeFleetResponseContent.[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m        Timestamp representing the last status update time.  # noqa: E501[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m        :return: The last_status_updated_time of this DescribeComputeFleetResponseContent.[0m
[30;1m81 | [0m[35m        :rtype: datetime[0m

[31m--[ [0m[34mMatch #[0m[33m1397[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/describe_compute_fleet_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1398[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/efs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m        :return: true if EFS storage class is Standard[0m
[30;1m67 | [0m[35m        """[0m
[30;1m68 | [0m[35m        availability_zone_name = ([0m
[30;1m69 | [0m[35m            self.describe_file_system(efs_fs_id).get("FileSystems")[0].get("AvailabilityZoneName", N[0m
[30;1m70 | [0m[35m        )[0m
[30;1m71 | [0m[35m        return availability_zone_name is None[0m
[30;1m72 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1399[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/efs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m        :return: true if EFS storage class is Standard[0m
[30;1m67 | [0m[35m        """[0m
[30;1m68 | [0m[35m        availability_zone_name = ([0m
[30;1m69 | [0m[35m            self.describe_file_system(efs_fs_id).get("FileSystems")[0].get("AvailabilityZoneName", N[0m
[30;1m70 | [0m[35m        )[0m
[30;1m71 | [0m[35m        return availability_zone_name is None[0m
[30;1m72 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1400[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/efs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m55 | [0m[35m    def get_efs_mount_target_security_groups(self, target_id):[0m
[30;1m56 | [0m[35m        """Return list of security groups associated to the given target id."""[0m
[30;1m57 | [0m[35m        return self._client.describe_mount_target_security_groups(MountTargetId=target_id).get("Secu[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m60 | [0m[35m    @Cache.cached[0m

[31m--[ [0m[34mMatch #[0m[33m1401[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/efs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m36 | [0m[35m                # Check to see if there is an existing mt in the az of the stack[0m
[30;1m37 | [0m[35m                mount_target_subnet = mount_target.get("SubnetId")[0m
[30;1m38 | [0m[35m                if avail_zone == self._ec2_client.get_subnet_avail_zone(mount_target_subnet):[0m
[30;1m39 | [0m[35m                    mount_target_id = mount_target.get("MountTargetId")[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m        return mount_target_id[0m
[30;1m42 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1402[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/efs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m            for mount_target in mount_targets.get("MountTargets"):[0m
[30;1m36 | [0m[35m                # Check to see if there is an existing mt in the az of the stack[0m
[30;1m37 | [0m[35m                mount_target_subnet = mount_target.get("SubnetId")[0m
[30;1m38 | [0m[35m                if avail_zone == self._ec2_client.get_subnet_avail_zone(mount_target_subnet):[0m
[30;1m39 | [0m[35m                    mount_target_id = mount_target.get("MountTargetId")[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1403[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/efs.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m32 | [0m[35m        if efs_fs_id:[0m
[30;1m33 | [0m[35m            mount_targets = self.describe_mount_targets(efs_fs_id)[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m            for mount_target in mount_targets.get("MountTargets"):[0m
[30;1m36 | [0m[35m                # Check to see if there is an existing mt in the az of the stack[0m
[30;1m37 | [0m[35m                mount_target_subnet = mount_target.get("SubnetId")[0m
[30;1m38 | [0m[35m                if avail_zone == self._ec2_client.get_subnet_avail_zone(mount_target_subnet):[0m

[31m--[ [0m[34mMatch #[0m[33m1404[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/efs.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1405[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/efs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m    @Cache.cached[0m
[30;1m45 | [0m[35m    def describe_mount_targets(self, efs_fs_id):[0m
[30;1m46 | [0m[35m        """[0m
[30;1m47 | [0m[35m        Search for Mount Targets information for the given EFS file system id.[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m        :param efs_fs_id: EFS file system Id[0m
[30;1m50 | [0m[35m        :return: the mount_target_ids[0m

[31m--[ [0m[34mMatch #[0m[33m1406[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/efs.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m23 | [0m[35m    def get_efs_mount_target_id(self, efs_fs_id, avail_zone):[0m
[30;1m24 | [0m[35m        """[0m
[30;1m25 | [0m[35m        Search for a Mount Target Id in given availability zone for the given EFS file system id.[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m        :param efs_fs_id: EFS file system Id[0m
[30;1m28 | [0m[35m        :param avail_zone: Availability zone to verify[0m

[31m--[ [0m[34mMatch #[0m[33m1407[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/generate_hostfile.sh[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m4 | [0m[35m#[0m
[30;1m5 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You[0m
[30;1m6 | [0m[35m# may not use this file except in compliance with the License. A copy[0m
[30;1m7 | [0m[35m# of the License is located at[0m
[30;1m8 | [0m[35m#[0m
[30;1m9 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m10 | [0m[35m#[0m
[30;1m11 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is[0m

[31m--[ [0m[34mMatch #[0m[33m1408[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/generate_hostfile.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m151 | [0m[35m    mkdir -p "${shared_dir_temp}"[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m    write_node_info[0m
[30;1m154 | [0m[35m    # If it is the head inspect the shared directory for the hostfile list[0m
[30;1m155 | [0m[35m    if [[ "${AWS_BATCH_JOB_NODE_INDEX}" -eq  "${AWS_BATCH_JOB_MAIN_NODE_INDEX}" ]]; then[0m
[30;1m156 | [0m[35m        read_compute_address[0m
[30;1m157 | [0m[35m    fi[0m

[31m--[ [0m[34mMatch #[0m[33m1409[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/generate_hostfile.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m135 | [0m[35m        error_exit_usage "Wrong number of arguments provided"[0m
[30;1m136 | [0m[35m    fi[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m    # This is the shared directory on which compute and head instances have agreed upon for reading [0m
[30;1m139 | [0m[35m    shared_dir="${1}"[0m
[30;1m140 | [0m[35m    if [[ "${shared_dir:0:1}" != '/' ]]; then[0m
[30;1m141 | [0m[35m      shared_dir="/${shared_dir}"[0m

[31m--[ [0m[34mMatch #[0m[33m1410[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/generate_hostfile.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m135 | [0m[35m        error_exit_usage "Wrong number of arguments provided"[0m
[30;1m136 | [0m[35m    fi[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m    # This is the shared directory on which compute and head instances have agreed upon for reading [0m
[30;1m139 | [0m[35m    shared_dir="${1}"[0m
[30;1m140 | [0m[35m    if [[ "${shared_dir:0:1}" != '/' ]]; then[0m
[30;1m141 | [0m[35m      shared_dir="/${shared_dir}"[0m

[31m--[ [0m[34mMatch #[0m[33m1411[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/generate_hostfile.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m122 | [0m[35mwrite_node_info() {[0m
[30;1m123 | [0m[35m  ip_address=$(/sbin/ip -o -4 addr list eth0 | awk '{print $4}' | cut -d/ -f1)[0m
[30;1m124 | [0m[35m  if ! [[ ${ip_address} =~ ^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$ ]]; then[0m
[30;1m125 | [0m[35m    error_exit "Matched IP Address not in expected format on compute node: ${ip_address}"[0m
[30;1m126 | [0m[35m  fi[0m
[30;1m127 | [0m[35m  available_cores=$(nproc --all)[0m
[30;1m128 | [0m[35m  echo "${ip_address} slots=${available_cores}" > "${shared_dir_temp}/${ip_address}"[0m

[31m--[ [0m[34mMatch #[0m[33m1412[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/generate_hostfile.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m# Write a file in the shared dir with container ip address and available cores.[0m
[30;1m122 | [0m[35mwrite_node_info() {[0m
[30;1m123 | [0m[35m  ip_address=$(/sbin/ip -o -4 addr list eth0 | awk '{print $4}' | cut -d/ -f1)[0m
[30;1m124 | [0m[35m  if ! [[ ${ip_address} =~ ^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$ ]]; then[0m
[30;1m125 | [0m[35m    error_exit "Matched IP Address not in expected format on compute node: ${ip_address}"[0m
[30;1m126 | [0m[35m  fi[0m

[31m--[ [0m[34mMatch #[0m[33m1413[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/generate_hostfile.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m# Write a file in the shared dir with container ip address and available cores.[0m
[30;1m122 | [0m[35mwrite_node_info() {[0m
[30;1m123 | [0m[35m  ip_address=$(/sbin/ip -o -4 addr list eth0 | awk '{print $4}' | cut -d/ -f1)[0m
[30;1m124 | [0m[35m  if ! [[ ${ip_address} =~ ^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$ ]]; then[0m
[30;1m125 | [0m[35m    error_exit "Matched IP Address not in expected format on compute node: ${ip_address}"[0m
[30;1m126 | [0m[35m  fi[0m

[31m--[ [0m[34mMatch #[0m[33m1414[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/generate_hostfile.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m118 | [0m[35m    fi[0m
[30;1m119 | [0m[35m}[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m# Write a file in the shared dir with container ip address and available cores.[0m
[30;1m122 | [0m[35mwrite_node_info() {[0m
[30;1m123 | [0m[35m  ip_address=$(/sbin/ip -o -4 addr list eth0 | awk '{print $4}' | cut -d/ -f1)[0m
[30;1m124 | [0m[35m  if ! [[ ${ip_address} =~ ^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$ ]]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1415[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/generate_hostfile.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m110 | [0m[35m    done[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m    if [[ "$(ls -A "${shared_dir_temp}")" ]]; then[0m
[30;1m113 | [0m[35m        error_exit "head node failed to read some of the ip addresses while generating the hostfile.[0m
[30;1m114 | [0m[35m    elif [[ $(wc -l < "${destination_dir}/hostfile") -ne ${AWS_BATCH_JOB_NUM_NODES} ]]; then[0m
[30;1m115 | [0m[35m        error_exit "The number of entries in hostfile is not equal to the AWS_BATCH_JOB_NUM_NODES"[0m
[30;1m116 | [0m[35m    else[0m

[31m--[ [0m[34mMatch #[0m[33m1416[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/generate_hostfile.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m110 | [0m[35m    done[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m    if [[ "$(ls -A "${shared_dir_temp}")" ]]; then[0m
[30;1m113 | [0m[35m        error_exit "head node failed to read some of the ip addresses while generating the hostfile.[0m
[30;1m114 | [0m[35m    elif [[ $(wc -l < "${destination_dir}/hostfile") -ne ${AWS_BATCH_JOB_NUM_NODES} ]]; then[0m
[30;1m115 | [0m[35m        error_exit "The number of entries in hostfile is not equal to the AWS_BATCH_JOB_NUM_NODES"[0m
[30;1m116 | [0m[35m    else[0m

[31m--[ [0m[34mMatch #[0m[33m1417[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/generate_hostfile.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m                error_exit "Matched filename not in expected format on head node: ${file}"[0m
[30;1m102 | [0m[35m            fi[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m            cat "${fullfile}" >> "${destination_dir}/hostfile"[0m
[30;1m105 | [0m[35m            rm -rf "${fullfile}"[0m
[30;1m106 | [0m[35m            (( compute_nodes_read += 1 ))[0m
[30;1m107 | [0m[35m        done[0m

[31m--[ [0m[34mMatch #[0m[33m1418[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/generate_hostfile.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m98 | [0m[35m            fi[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m            if ! [[ ${file} =~ ^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$ ]]; then[0m
[30;1m101 | [0m[35m                error_exit "Matched filename not in expected format on head node: ${file}"[0m
[30;1m102 | [0m[35m            fi[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m            cat "${fullfile}" >> "${destination_dir}/hostfile"[0m

[31m--[ [0m[34mMatch #[0m[33m1419[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/generate_hostfile.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m    fi[0m
[30;1m82 | [0m[35m}[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m# On the head node populate the hostfile with the ip addresses and available cores of the compute no[0m
[30;1m85 | [0m[35mread_compute_address() {[0m
[30;1m86 | [0m[35m    if [[ ! -f "${destination_dir}/hostfile" ]]; then[0m
[30;1m87 | [0m[35m        touch "${destination_dir}/hostfile"[0m

[31m--[ [0m[34mMatch #[0m[33m1420[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/generate_hostfile.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m    fi[0m
[30;1m82 | [0m[35m}[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m# On the head node populate the hostfile with the ip addresses and available cores of the compute no[0m
[30;1m85 | [0m[35mread_compute_address() {[0m
[30;1m86 | [0m[35m    if [[ ! -f "${destination_dir}/hostfile" ]]; then[0m
[30;1m87 | [0m[35m        touch "${destination_dir}/hostfile"[0m

[31m--[ [0m[34mMatch #[0m[33m1421[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/generate_hostfile.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mUSAGE:[0m
[30;1m24 | [0m[35mgenerate_hostfile <shared_dir> <destination_dir>[0m
[30;1m25 | [0m[35mshared_dir: Shared directory on which compute and head instances have agreed upon for reading and wr[0m
[30;1m26 | [0m[35mdestination_dir: Directory where hostfile should reside. Directory needs to exist[0m
[30;1m27 | [0m[35mENDUSAGE[0m
[30;1m28 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1422[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/generate_hostfile.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mUSAGE:[0m
[30;1m24 | [0m[35mgenerate_hostfile <shared_dir> <destination_dir>[0m
[30;1m25 | [0m[35mshared_dir: Shared directory on which compute and head instances have agreed upon for reading and wr[0m
[30;1m26 | [0m[35mdestination_dir: Directory where hostfile should reside. Directory needs to exist[0m
[30;1m27 | [0m[35mENDUSAGE[0m
[30;1m28 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1423[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/generate_hostfile.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35musage() {[0m
[30;1m20 | [0m[35m    cat <<ENDUSAGE[0m
[30;1m21 | [0m[35mThis script generates a hostfile which contains the ip addresses of the compute nodes[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mUSAGE:[0m
[30;1m24 | [0m[35mgenerate_hostfile <shared_dir> <destination_dir>[0m

[31m--[ [0m[34mMatch #[0m[33m1424[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/generate_hostfile.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35musage() {[0m
[30;1m20 | [0m[35m    cat <<ENDUSAGE[0m
[30;1m21 | [0m[35mThis script generates a hostfile which contains the ip addresses of the compute nodes[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mUSAGE:[0m
[30;1m24 | [0m[35mgenerate_hostfile <shared_dir> <destination_dir>[0m

[31m--[ [0m[34mMatch #[0m[33m1425[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/generate_hostfile.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35m#   generate_hostfile.sh <shared_dir> <destination_dir>[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35musage() {[0m
[30;1m20 | [0m[35m    cat <<ENDUSAGE[0m
[30;1m21 | [0m[35mThis script generates a hostfile which contains the ip addresses of the compute nodes[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mUSAGE:[0m

[31m--[ [0m[34mMatch #[0m[33m1426[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/networking.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m168 | [0m[35m            print("Could not create the network configuration.")[0m
[30;1m169 | [0m[35m            sys.exit(0)[0m
[30;1m170 | [0m[35m        print("\nThe stack has been created.")[0m
[30;1m171 | [0m[35m        return AWSApi.instance().cfn.describe_stack(stack_name).get("Outputs")[0m
[30;1m172 | [0m[35m    except KeyboardInterrupt:[0m
[30;1m173 | [0m[35m        print([0m
[30;1m174 | [0m[35m            "\nUnable to update the configuration file with the selected network configuration. "[0m

[31m--[ [0m[34mMatch #[0m[33m1427[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/networking.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m161 | [0m[35m        stack = cfn_client.create_stack([0m
[30;1m162 | [0m[35m            StackName=stack_name, TemplateURL=template_url, Parameters=parameters, Capabilities=["CA[0m
[30;1m163 | [0m[35m        )[0m
[30;1m164 | [0m[35m        print(f"Stack Name: {stack_name} (id: {stack.get('StackId')})")[0m
[30;1m165 | [0m[35m        if not verify_stack_status([0m
[30;1m166 | [0m[35m            stack_name, waiting_states=["CREATE_IN_PROGRESS"], successful_states=["CREATE_COMPLETE"][0m
[30;1m167 | [0m[35m        ):[0m

[31m--[ [0m[34mMatch #[0m[33m1428[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/networking.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m171 | [0m[35m        return AWSApi.instance().cfn.describe_stack(stack_name).get("Outputs")[0m
[30;1m172 | [0m[35m    except KeyboardInterrupt:[0m
[30;1m173 | [0m[35m        print([0m
[30;1m174 | [0m[35m            "\nUnable to update the configuration file with the selected network configuration. "[0m
[30;1m175 | [0m[35m            f"Please manually check the status of the CloudFormation stack: {stack_name}"[0m
[30;1m176 | [0m[35m        )[0m
[30;1m177 | [0m[35m        sys.exit(0)[0m

[31m--[ [0m[34mMatch #[0m[33m1429[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/networking.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2013-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the 'License'). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the 'LICENSE.txt' file accompanying this file. This file is distributed on an 'AS IS' BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1430[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/networking.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m    def __init__(self, availability_zone=""):[0m
[30;1m115 | [0m[35m        super().__init__([0m
[30;1m116 | [0m[35m            config_type="Head node in a public subnet and compute fleet in a private subnet",[0m
[30;1m117 | [0m[35m            template_name="public-private",[0m
[30;1m118 | [0m[35m            stack_name_prefix="pubpriv",[0m
[30;1m119 | [0m[35m            availability_zone=availability_zone,[0m

[31m--[ [0m[34mMatch #[0m[33m1431[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/networking.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35mclass PublicPrivateNetworkConfig(BaseNetworkConfig):[0m
[30;1m112 | [0m[35m    """The public private config that creates one public subnet for head node and one private subnet[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m    def __init__(self, availability_zone=""):[0m
[30;1m115 | [0m[35m        super().__init__([0m

[31m--[ [0m[34mMatch #[0m[33m1432[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/networking.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m    def __init__(self, availability_zone=None):[0m
[30;1m85 | [0m[35m        super().__init__([0m
[30;1m86 | [0m[35m            config_type="Head node and compute fleet in the same public subnet",[0m
[30;1m87 | [0m[35m            template_name="public",[0m
[30;1m88 | [0m[35m            stack_name_prefix="pub",[0m
[30;1m89 | [0m[35m            availability_zone=availability_zone,[0m

[31m--[ [0m[34mMatch #[0m[33m1433[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/networking.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m[0m
[30;1m81 | [0m[35mclass PublicNetworkConfig(BaseNetworkConfig):[0m
[30;1m82 | [0m[35m    """The public configuration that creates one public subnet with head node and compute fleet."""[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m    def __init__(self, availability_zone=None):[0m
[30;1m85 | [0m[35m        super().__init__([0m

[31m--[ [0m[34mMatch #[0m[33m1434[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/build_image_bad_request_exception_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1435[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/describe_cluster_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m405 | [0m[35m    def last_updated_time(self, last_updated_time):[0m
[30;1m406 | [0m[35m        """Sets the last_updated_time of this DescribeClusterResponseContent.[0m
[30;1m407 | [0m[35m[0m
[30;1m408 | [0m[35m        Timestamp representing the last cluster update time[0m
[30;1m409 | [0m[35m[0m
[30;1m410 | [0m[35m        :param last_updated_time: The last_updated_time of this DescribeClusterResponseContent.[0m
[30;1m411 | [0m[35m        :type last_updated_time: datetime[0m

[31m--[ [0m[34mMatch #[0m[33m1436[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/describe_cluster_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m394 | [0m[35m    def last_updated_time(self):[0m
[30;1m395 | [0m[35m        """Gets the last_updated_time of this DescribeClusterResponseContent.[0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m        Timestamp representing the last cluster update time[0m
[30;1m398 | [0m[35m[0m
[30;1m399 | [0m[35m        :return: The last_updated_time of this DescribeClusterResponseContent.[0m
[30;1m400 | [0m[35m        :rtype: datetime[0m

[31m--[ [0m[34mMatch #[0m[33m1437[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/describe_cluster_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1438[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/describe_cluster_response_content.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m405 | [0m[35m    def last_updated_time(self, last_updated_time):[0m
[30;1m406 | [0m[35m        """Sets the last_updated_time of this DescribeClusterResponseContent.[0m
[30;1m407 | [0m[35m[0m
[30;1m408 | [0m[35m        Timestamp representing the last cluster update time[0m
[30;1m409 | [0m[35m[0m
[30;1m410 | [0m[35m        :param last_updated_time: The last_updated_time of this DescribeClusterResponseContent.[0m
[30;1m411 | [0m[35m        :type last_updated_time: datetime[0m
[30;1m412 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1439[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/describe_cluster_response_content.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m394 | [0m[35m    def last_updated_time(self):[0m
[30;1m395 | [0m[35m        """Gets the last_updated_time of this DescribeClusterResponseContent.[0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m        Timestamp representing the last cluster update time[0m
[30;1m398 | [0m[35m[0m
[30;1m399 | [0m[35m        :return: The last_updated_time of this DescribeClusterResponseContent.[0m
[30;1m400 | [0m[35m        :rtype: datetime[0m
[30;1m401 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1440[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/describe_cluster_response_content.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m161 | [0m[35m    def creation_time(self, creation_time):[0m
[30;1m162 | [0m[35m        """Sets the creation_time of this DescribeClusterResponseContent.[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m        Timestamp representing the cluster creation time[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m        :param creation_time: The creation_time of this DescribeClusterResponseContent.[0m
[30;1m167 | [0m[35m        :type creation_time: datetime[0m
[30;1m168 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1441[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/describe_cluster_response_content.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m150 | [0m[35m    def creation_time(self):[0m
[30;1m151 | [0m[35m        """Gets the creation_time of this DescribeClusterResponseContent.[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m        Timestamp representing the cluster creation time[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m        :return: The creation_time of this DescribeClusterResponseContent.[0m
[30;1m156 | [0m[35m        :rtype: datetime[0m
[30;1m157 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1442[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35mdef create_cluster(func, body, kwargs):[0m
[30;1m92 | [0m[35m    wait = kwargs.pop("wait", False)[0m
[30;1m93 | [0m[35m    ret = func(**kwargs)[0m
[30;1m94 | [0m[35m    if wait and not kwargs.get("dryrun"):[0m
[30;1m95 | [0m[35m        cloud_formation = boto3.client("cloudformation")[0m
[30;1m96 | [0m[35m        waiter = cloud_formation.get_waiter("stack_create_complete")[0m
[30;1m97 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m1443[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/middleware.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35mdef update_cluster(func, _body, kwargs):[0m
[30;1m76 | [0m[35m    wait = kwargs.pop("wait", False)[0m
[30;1m77 | [0m[35m    ret = func(**kwargs)[0m
[30;1m78 | [0m[35m    if wait and not kwargs.get("dryrun"):[0m
[30;1m79 | [0m[35m        cloud_formation = boto3.client("cloudformation")[0m
[30;1m80 | [0m[35m        waiter = cloud_formation.get_waiter("stack_update_complete")[0m
[30;1m81 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m1444[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/middleware.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m81 | [0m[35m        try:[0m
[30;1m82 | [0m[35m            waiter.wait(StackName=kwargs["cluster_name"])[0m
[30;1m83 | [0m[35m        except WaiterError as e:[0m
[30;1m84 | [0m[35m            LOGGER.error("Failed when waiting for cluster update with error: %s", e)[0m
[30;1m85 | [0m[35m            raise APIOperationException(_cluster_status(kwargs["cluster_name"]))[0m
[30;1m86 | [0m[35m        ret = _cluster_status(kwargs["cluster_name"])[0m
[30;1m87 | [0m[35m    return ret[0m

[31m--[ [0m[34mMatch #[0m[33m1445[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/middleware.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not[0m
[30;1m4 | [0m[35m# use this file except in compliance with the License. A copy of the License is[0m
[30;1m5 | [0m[35m# located at[0m
[30;1m6 | [0m[35m#[0m
[30;1m7 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m8 | [0m[35m#[0m
[30;1m9 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed[0m

[31m--[ [0m[34mMatch #[0m[33m1446[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m299 | [0m[35m        scheduler_prefix = scheduler.capitalize()[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35m    result = {[0m
[30;1m302 | [0m[35m        "Region": os.environ.get("AWS_DEFAULT_REGION"),[0m
[30;1m303 | [0m[35m        "Image": {"Os": base_os},[0m
[30;1m304 | [0m[35m        "HeadNode": head_node_config,[0m
[30;1m305 | [0m[35m        "Scheduling": {"Scheduler": scheduler, f"{scheduler_prefix}Queues": queues},[0m

[31m--[ [0m[34mMatch #[0m[33m1447[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m    # Here is the end of prompt. Code below assembles config and write to file[0m
[30;1m285 | [0m[35m    for queue in queues:[0m
[30;1m286 | [0m[35m        networking = queue.get("Networking", {})[0m
[30;1m287 | [0m[35m        networking["SubnetIds"] = [vpc_parameters["compute_subnet_id"]][0m
[30;1m288 | [0m[35m        queue["Networking"] = networking[0m
[30;1m289 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1448[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m273 | [0m[35m            if placement_group_name:[0m
[30;1m274 | [0m[35m                placement_group["Id"] = placement_group_name[0m
[30;1m275 | [0m[35m[0m
[30;1m276 | [0m[35m            networking = queue.get("Networking", {})[0m
[30;1m277 | [0m[35m            networking["PlacementGroup"] = placement_group[0m
[30;1m278 | [0m[35m            queue["Networking"] = networking[0m
[30;1m279 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1449[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m113 | [0m[35m                    ("id", subnet.get("SubnetId")),[0m
[30;1m114 | [0m[35m                    ("name", get_resource_tag(subnet, tag_name="Name")),[0m
[30;1m115 | [0m[35m                    ("size", _extract_subnet_size(subnet.get("CidrBlock"))),[0m
[30;1m116 | [0m[35m                    ("availability_zone", subnet.get("AvailabilityZone")),[0m
[30;1m117 | [0m[35m                ][0m
[30;1m118 | [0m[35m            )[0m
[30;1m119 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1450[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m                [[0m
[30;1m113 | [0m[35m                    ("id", subnet.get("SubnetId")),[0m
[30;1m114 | [0m[35m                    ("name", get_resource_tag(subnet, tag_name="Name")),[0m
[30;1m115 | [0m[35m                    ("size", _extract_subnet_size(subnet.get("CidrBlock"))),[0m
[30;1m116 | [0m[35m                    ("availability_zone", subnet.get("AvailabilityZone")),[0m
[30;1m117 | [0m[35m                ][0m
[30;1m118 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m1451[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m        subnet_options.append([0m
[30;1m111 | [0m[35m            OrderedDict([0m
[30;1m112 | [0m[35m                [[0m
[30;1m113 | [0m[35m                    ("id", subnet.get("SubnetId")),[0m
[30;1m114 | [0m[35m                    ("name", get_resource_tag(subnet, tag_name="Name")),[0m
[30;1m115 | [0m[35m                    ("size", _extract_subnet_size(subnet.get("CidrBlock"))),[0m
[30;1m116 | [0m[35m                    ("availability_zone", subnet.get("AvailabilityZone")),[0m

[31m--[ [0m[34mMatch #[0m[33m1452[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m    # applying the filter ipv6-native=false would make the DescribeSubnets call to always return an [0m
[30;1m106 | [0m[35m    if not conn.meta.region_name.startswith("us-iso"):[0m
[30;1m107 | [0m[35m        subnet_filters.append({"Name": "ipv6-native", "Values": ["false"]})[0m
[30;1m108 | [0m[35m    subnet_list = conn.describe_subnets(Filters=subnet_filters).get("Subnets")[0m
[30;1m109 | [0m[35m    for subnet in subnet_list:[0m
[30;1m110 | [0m[35m        subnet_options.append([0m
[30;1m111 | [0m[35m            OrderedDict([0m

[31m--[ [0m[34mMatch #[0m[33m1453[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m    vpc_subnets = {}[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m    for vpc in vpcs.get("Vpcs"):[0m
[30;1m91 | [0m[35m        vpc_id = vpc.get("VpcId")[0m
[30;1m92 | [0m[35m        subnets = _get_subnets(ec2_client, vpc_id)[0m
[30;1m93 | [0m[35m        vpc_name = get_resource_tag(vpc, tag_name="Name")[0m
[30;1m94 | [0m[35m        vpc_subnets[vpc_id] = subnets[0m

[31m--[ [0m[34mMatch #[0m[33m1454[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m87 | [0m[35m    vpc_options = [][0m
[30;1m88 | [0m[35m    vpc_subnets = {}[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m    for vpc in vpcs.get("Vpcs"):[0m
[30;1m91 | [0m[35m        vpc_id = vpc.get("VpcId")[0m
[30;1m92 | [0m[35m        subnets = _get_subnets(ec2_client, vpc_id)[0m
[30;1m93 | [0m[35m        vpc_name = get_resource_tag(vpc, tag_name="Name")[0m

[31m--[ [0m[34mMatch #[0m[33m1455[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m    keypairs = boto3.client("ec2").describe_key_pairs()[0m
[30;1m56 | [0m[35m    key_options = [][0m
[30;1m57 | [0m[35m    for key in keypairs.get("KeyPairs"):[0m
[30;1m58 | [0m[35m        key_name = key.get("KeyName")[0m
[30;1m59 | [0m[35m        key_options.append(key_name)[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m    if not key_options:[0m

[31m--[ [0m[34mMatch #[0m[33m1456[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m54 | [0m[35m    """Return a list of keys."""[0m
[30;1m55 | [0m[35m    keypairs = boto3.client("ec2").describe_key_pairs()[0m
[30;1m56 | [0m[35m    key_options = [][0m
[30;1m57 | [0m[35m    for key in keypairs.get("KeyPairs"):[0m
[30;1m58 | [0m[35m        key_name = key.get("KeyName")[0m
[30;1m59 | [0m[35m        key_options.append(key_name)[0m
[30;1m60 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1457[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m449 | [0m[35mdef _prompt_for_efa(instance_type):[0m
[30;1m450 | [0m[35m    print([0m
[30;1m451 | [0m[35m        "The EC2 instance selected supports enhanced networking capabilities using Elastic Fabric Ad[0m
[30;1m452 | [0m[35m        "EFA enables you to run applications requiring high levels of inter-node communications at s[0m
[30;1m453 | [0m[35m        "additional charge (https://docs.aws.amazon.com/parallelcluster/latest/ug/efa-v3.html)."[0m
[30;1m454 | [0m[35m    )[0m
[30;1m455 | [0m[35m    enable_efa = prompt(f"Enable EFA on {instance_type} (y/n)", validator=lambda x: x in ("y", "n"),[0m

[31m--[ [0m[34mMatch #[0m[33m1458[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m449 | [0m[35mdef _prompt_for_efa(instance_type):[0m
[30;1m450 | [0m[35m    print([0m
[30;1m451 | [0m[35m        "The EC2 instance selected supports enhanced networking capabilities using Elastic Fabric Ad[0m
[30;1m452 | [0m[35m        "EFA enables you to run applications requiring high levels of inter-node communications at s[0m
[30;1m453 | [0m[35m        "additional charge (https://docs.aws.amazon.com/parallelcluster/latest/ug/efa-v3.html)."[0m
[30;1m454 | [0m[35m    )[0m
[30;1m455 | [0m[35m    enable_efa = prompt(f"Enable EFA on {instance_type} (y/n)", validator=lambda x: x in ("y", "n"),[0m

[31m--[ [0m[34mMatch #[0m[33m1459[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m124 | [0m[35m    config_file_path = args.config[0m
[30;1m125 | [0m[35m    # Check for invalid path (eg. a directory)[0m
[30;1m126 | [0m[35m    if os.path.exists(config_file_path):[0m
[30;1m127 | [0m[35m        error(f"A file/folder exists at {config_file_path}. Please specify a different file path")[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m    print(f"INFO: Configuration file {config_file_path} will be written.")[0m
[30;1m130 | [0m[35m    print("Press CTRL-C to interrupt the procedure.\n\n")[0m

[31m--[ [0m[34mMatch #[0m[33m1460[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2013-2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the 'License'). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the 'LICENSE.txt' file accompanying this file. This file is distributed on an 'AS IS' BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1461[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m415 | [0m[35m        # But user can bypass it by using manual subnets creation during configure or modify the con[0m
[30;1m416 | [0m[35m        print([0m
[30;1m417 | [0m[35m            "Error: There is no single availability zone offering head node and compute in current r[0m
[30;1m418 | [0m[35m            f"To create your cluster, make sure you have a subnet for head node in {azs_for_head_nod[0m
[30;1m419 | [0m[35m            f"and a subnet for compute nodes in {azs_for_compute_types}. "[0m
[30;1m420 | [0m[35m            "Then run pcluster configure again and avoid using Automate VPC/Subnet creation."[0m
[30;1m421 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1462[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m414 | [0m[35m        # Automate subnet creation only allows subnets to reside in a single az.[0m
[30;1m415 | [0m[35m        # But user can bypass it by using manual subnets creation during configure or modify the con[0m
[30;1m416 | [0m[35m        print([0m
[30;1m417 | [0m[35m            "Error: There is no single availability zone offering head node and compute in current r[0m
[30;1m418 | [0m[35m            f"To create your cluster, make sure you have a subnet for head node in {azs_for_head_nod[0m
[30;1m419 | [0m[35m            f"and a subnet for compute nodes in {azs_for_compute_types}. "[0m
[30;1m420 | [0m[35m            "Then run pcluster configure again and avoid using Automate VPC/Subnet creation."[0m

[31m--[ [0m[34mMatch #[0m[33m1463[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m393 | [0m[35m[0m
[30;1m394 | [0m[35m[0m
[30;1m395 | [0m[35mdef _ask_for_subnets(subnet_list, qualified_head_node_subnets, qualified_compute_subnets):[0m
[30;1m396 | [0m[35m    head_node_subnet_id = _prompt_for_subnet(subnet_list, qualified_head_node_subnets, "head node su[0m
[30;1m397 | [0m[35m    compute_subnet_id = _prompt_for_subnet([0m
[30;1m398 | [0m[35m        subnet_list, qualified_compute_subnets, "compute subnet ID", default_subnet=head_node_subnet[0m
[30;1m399 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1464[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/configure/easyconfig.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35m    default_instance_type = AWSApi.instance().ec2.get_default_instance_type()[0m
[30;1m155 | [0m[35m    head_node_instance_type = prompt([0m
[30;1m156 | [0m[35m        "Head node instance type",[0m
[30;1m157 | [0m[35m        lambda x: x in AWSApi.instance().ec2.list_instance_types(),[0m
[30;1m158 | [0m[35m        default_value=default_instance_type,[0m
[30;1m159 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1465[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/ec2_ami_info_summary.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1466[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/list_images_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1467[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/limit_exceeded_exception_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1468[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m596 | [0m[35m    def get_tag(self, tag_key: str):[0m
[30;1m597 | [0m[35m        """Get stack tag by tag key."""[0m
[30;1m598 | [0m[35m        return next([0m
[30;1m599 | [0m[35m            iter([tag["Value"] for tag in self.capacity_reservation_data.get("Tags", []) if tag["Key[0m
[30;1m600 | [0m[35m            None,[0m
[30;1m601 | [0m[35m        )[0m
[30;1m602 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1469[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m591 | [0m[35m[0m
[30;1m592 | [0m[35m    def total_instance_count(self):[0m
[30;1m593 | [0m[35m        """Return the total instance count, if present, 0 otherwise."""[0m
[30;1m594 | [0m[35m        return self.capacity_reservation_data.get("TotalInstanceCount", 0)[0m
[30;1m595 | [0m[35m[0m
[30;1m596 | [0m[35m    def get_tag(self, tag_key: str):[0m
[30;1m597 | [0m[35m        """Get stack tag by tag key."""[0m

[31m--[ [0m[34mMatch #[0m[33m1470[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m585 | [0m[35m[0m
[30;1m586 | [0m[35m        Return the value of the tag CAPACITY_BLOCK_RESERVATION_TYPE_TAG_KEY, if ReservationType tag [0m
[30;1m587 | [0m[35m        """[0m
[30;1m588 | [0m[35m        return self.capacity_reservation_data.get([0m
[30;1m589 | [0m[35m            "ReservationType", self.get_tag(CAPACITY_BLOCK_RESERVATION_TYPE_TAG_KEY)[0m
[30;1m590 | [0m[35m        )[0m
[30;1m591 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1471[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m577 | [0m[35m[0m
[30;1m578 | [0m[35m    def placement_group_arn(self):[0m
[30;1m579 | [0m[35m        """Return the placement group arn of the Capacity Reservation."""[0m
[30;1m580 | [0m[35m        return self.capacity_reservation_data.get("PlacementGroupArn")[0m
[30;1m581 | [0m[35m[0m
[30;1m582 | [0m[35m    def reservation_type(self):[0m
[30;1m583 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1472[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m573 | [0m[35m[0m
[30;1m574 | [0m[35m    def availability_zone(self):[0m
[30;1m575 | [0m[35m        """Return the availability zone associated to the Capacity Reservation."""[0m
[30;1m576 | [0m[35m        return self.capacity_reservation_data.get("AvailabilityZone")[0m
[30;1m577 | [0m[35m[0m
[30;1m578 | [0m[35m    def placement_group_arn(self):[0m
[30;1m579 | [0m[35m        """Return the placement group arn of the Capacity Reservation."""[0m

[31m--[ [0m[34mMatch #[0m[33m1473[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m569 | [0m[35m[0m
[30;1m570 | [0m[35m    def instance_type(self):[0m
[30;1m571 | [0m[35m        """Return the instance type associated to the Capacity Reservation."""[0m
[30;1m572 | [0m[35m        return self.capacity_reservation_data.get("InstanceType")[0m
[30;1m573 | [0m[35m[0m
[30;1m574 | [0m[35m    def availability_zone(self):[0m
[30;1m575 | [0m[35m        """Return the availability zone associated to the Capacity Reservation."""[0m

[31m--[ [0m[34mMatch #[0m[33m1474[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m565 | [0m[35m[0m
[30;1m566 | [0m[35m    def state(self):[0m
[30;1m567 | [0m[35m        """Return the state of the Capacity Reservation."""[0m
[30;1m568 | [0m[35m        return self.capacity_reservation_data.get("State")[0m
[30;1m569 | [0m[35m[0m
[30;1m570 | [0m[35m    def instance_type(self):[0m
[30;1m571 | [0m[35m        """Return the instance type associated to the Capacity Reservation."""[0m

[31m--[ [0m[34mMatch #[0m[33m1475[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m561 | [0m[35m[0m
[30;1m562 | [0m[35m    def capacity_reservation_id(self):[0m
[30;1m563 | [0m[35m        """Return the id of the Capacity Reservation."""[0m
[30;1m564 | [0m[35m        return self.capacity_reservation_data.get("CapacityReservationId")[0m
[30;1m565 | [0m[35m[0m
[30;1m566 | [0m[35m    def state(self):[0m
[30;1m567 | [0m[35m        """Return the state of the Capacity Reservation."""[0m

[31m--[ [0m[34mMatch #[0m[33m1476[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m557 | [0m[35m[0m
[30;1m558 | [0m[35m    def capacity_reservation_arn(self):[0m
[30;1m559 | [0m[35m        """Return the arn of the Capacity Reservation."""[0m
[30;1m560 | [0m[35m        return self.capacity_reservation_data.get("CapacityReservationArn")[0m
[30;1m561 | [0m[35m[0m
[30;1m562 | [0m[35m    def capacity_reservation_id(self):[0m
[30;1m563 | [0m[35m        """Return the id of the Capacity Reservation."""[0m

[31m--[ [0m[34mMatch #[0m[33m1477[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m464 | [0m[35m    @property[0m
[30;1m465 | [0m[35m    def creation_date(self) -> str:[0m
[30;1m466 | [0m[35m        """Return image creation date."""[0m
[30;1m467 | [0m[35m        return self._image_data.get("CreationDate")[0m
[30;1m468 | [0m[35m[0m
[30;1m469 | [0m[35m    @property[0m
[30;1m470 | [0m[35m    def build_log(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1478[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m444 | [0m[35m    @property[0m
[30;1m445 | [0m[35m    def device_name(self) -> str:[0m
[30;1m446 | [0m[35m        """Return root volume device name."""[0m
[30;1m447 | [0m[35m        return self.block_device_mappings[0].get("DeviceName")[0m
[30;1m448 | [0m[35m[0m
[30;1m449 | [0m[35m    @property[0m
[30;1m450 | [0m[35m    def image_os(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1479[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m439 | [0m[35m    @property[0m
[30;1m440 | [0m[35m    def volume_size(self) -> int:[0m
[30;1m441 | [0m[35m        """Return root volume size."""[0m
[30;1m442 | [0m[35m        return self.block_device_mappings[0].get("Ebs").get("VolumeSize")[0m
[30;1m443 | [0m[35m[0m
[30;1m444 | [0m[35m    @property[0m
[30;1m445 | [0m[35m    def device_name(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1480[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m439 | [0m[35m    @property[0m
[30;1m440 | [0m[35m    def volume_size(self) -> int:[0m
[30;1m441 | [0m[35m        """Return root volume size."""[0m
[30;1m442 | [0m[35m        return self.block_device_mappings[0].get("Ebs").get("VolumeSize")[0m
[30;1m443 | [0m[35m[0m
[30;1m444 | [0m[35m    @property[0m
[30;1m445 | [0m[35m    def device_name(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1481[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m433 | [0m[35m        snapshot_ids = [][0m
[30;1m434 | [0m[35m        for block_device_mapping in self.block_device_mappings:[0m
[30;1m435 | [0m[35m            if block_device_mapping.get("Ebs"):[0m
[30;1m436 | [0m[35m                snapshot_ids.append(block_device_mapping.get("Ebs").get("SnapshotId"))[0m
[30;1m437 | [0m[35m        return snapshot_ids[0m
[30;1m438 | [0m[35m[0m
[30;1m439 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1482[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m433 | [0m[35m        snapshot_ids = [][0m
[30;1m434 | [0m[35m        for block_device_mapping in self.block_device_mappings:[0m
[30;1m435 | [0m[35m            if block_device_mapping.get("Ebs"):[0m
[30;1m436 | [0m[35m                snapshot_ids.append(block_device_mapping.get("Ebs").get("SnapshotId"))[0m
[30;1m437 | [0m[35m        return snapshot_ids[0m
[30;1m438 | [0m[35m[0m
[30;1m439 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1483[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m432 | [0m[35m        """Return snapshot ids."""[0m
[30;1m433 | [0m[35m        snapshot_ids = [][0m
[30;1m434 | [0m[35m        for block_device_mapping in self.block_device_mappings:[0m
[30;1m435 | [0m[35m            if block_device_mapping.get("Ebs"):[0m
[30;1m436 | [0m[35m                snapshot_ids.append(block_device_mapping.get("Ebs").get("SnapshotId"))[0m
[30;1m437 | [0m[35m        return snapshot_ids[0m
[30;1m438 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1484[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m425 | [0m[35m    @property[0m
[30;1m426 | [0m[35m    def block_device_mappings(self) -> list:[0m
[30;1m427 | [0m[35m        """Return device block mappings."""[0m
[30;1m428 | [0m[35m        return self._image_data.get("BlockDeviceMappings")[0m
[30;1m429 | [0m[35m[0m
[30;1m430 | [0m[35m    @property[0m
[30;1m431 | [0m[35m    def snapshot_ids(self) -> list:[0m

[31m--[ [0m[34mMatch #[0m[33m1485[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m420 | [0m[35m    @property[0m
[30;1m421 | [0m[35m    def tags(self) -> list:[0m
[30;1m422 | [0m[35m        """Return image tags."""[0m
[30;1m423 | [0m[35m        return self._image_data.get("Tags", [])[0m
[30;1m424 | [0m[35m[0m
[30;1m425 | [0m[35m    @property[0m
[30;1m426 | [0m[35m    def block_device_mappings(self) -> list:[0m

[31m--[ [0m[34mMatch #[0m[33m1486[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m415 | [0m[35m    @property[0m
[30;1m416 | [0m[35m    def architecture(self) -> str:[0m
[30;1m417 | [0m[35m        """Return image supports architecture."""[0m
[30;1m418 | [0m[35m        return self._image_data.get("Architecture")[0m
[30;1m419 | [0m[35m[0m
[30;1m420 | [0m[35m    @property[0m
[30;1m421 | [0m[35m    def tags(self) -> list:[0m

[31m--[ [0m[34mMatch #[0m[33m1487[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m410 | [0m[35m    @property[0m
[30;1m411 | [0m[35m    def state(self) -> str:[0m
[30;1m412 | [0m[35m        """Return image state."""[0m
[30;1m413 | [0m[35m        return self._image_data.get("State")[0m
[30;1m414 | [0m[35m[0m
[30;1m415 | [0m[35m    @property[0m
[30;1m416 | [0m[35m    def architecture(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1488[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m405 | [0m[35m    @property[0m
[30;1m406 | [0m[35m    def description(self) -> str:[0m
[30;1m407 | [0m[35m        """Return image description."""[0m
[30;1m408 | [0m[35m        return self._image_data.get("Description")[0m
[30;1m409 | [0m[35m[0m
[30;1m410 | [0m[35m    @property[0m
[30;1m411 | [0m[35m    def state(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1489[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m400 | [0m[35m    @property[0m
[30;1m401 | [0m[35m    def id(self) -> str:[0m
[30;1m402 | [0m[35m        """Return image id."""[0m
[30;1m403 | [0m[35m        return self._image_data.get("ImageId")[0m
[30;1m404 | [0m[35m[0m
[30;1m405 | [0m[35m    @property[0m
[30;1m406 | [0m[35m    def description(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1490[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m390 | [0m[35m    @property[0m
[30;1m391 | [0m[35m    def name(self) -> str:[0m
[30;1m392 | [0m[35m        """Return image name."""[0m
[30;1m393 | [0m[35m        return self._image_data.get("Name")[0m
[30;1m394 | [0m[35m[0m
[30;1m395 | [0m[35m    @property[0m
[30;1m396 | [0m[35m    def pcluster_image_id(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1491[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m378 | [0m[35m    @property[0m
[30;1m379 | [0m[35m    def subnet_ids(self):[0m
[30;1m380 | [0m[35m        """Return subnet ids of the file system."""[0m
[30;1m381 | [0m[35m        return self.file_storage_info.get("SubnetIds")[0m
[30;1m382 | [0m[35m[0m
[30;1m383 | [0m[35m[0m
[30;1m384 | [0m[35mclass ImageInfo:[0m

[31m--[ [0m[34mMatch #[0m[33m1492[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m373 | [0m[35m    @property[0m
[30;1m374 | [0m[35m    def network_interface_ids(self):[0m
[30;1m375 | [0m[35m        """Return network interface ids of the file system."""[0m
[30;1m376 | [0m[35m        return self.file_storage_info.get("NetworkInterfaceIds")[0m
[30;1m377 | [0m[35m[0m
[30;1m378 | [0m[35m    @property[0m
[30;1m379 | [0m[35m    def subnet_ids(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1493[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m368 | [0m[35m    @property[0m
[30;1m369 | [0m[35m    def vpc_id(self):[0m
[30;1m370 | [0m[35m        """Return VPC id of the file system."""[0m
[30;1m371 | [0m[35m        return self.file_storage_info.get("VpcId")[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m    @property[0m
[30;1m374 | [0m[35m    def network_interface_ids(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1494[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m363 | [0m[35m    @property[0m
[30;1m364 | [0m[35m    def file_cache_id(self):[0m
[30;1m365 | [0m[35m        """Return id of the file caches."""[0m
[30;1m366 | [0m[35m        return self.file_storage_info.get("FileCacheId")[0m
[30;1m367 | [0m[35m[0m
[30;1m368 | [0m[35m    @property[0m
[30;1m369 | [0m[35m    def vpc_id(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1495[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m358 | [0m[35m    @property[0m
[30;1m359 | [0m[35m    def file_system_id(self):[0m
[30;1m360 | [0m[35m        """Return id of the file system."""[0m
[30;1m361 | [0m[35m        return self.file_storage_info.get("FileSystemId")[0m
[30;1m362 | [0m[35m[0m
[30;1m363 | [0m[35m    @property[0m
[30;1m364 | [0m[35m    def file_cache_id(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1496[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m353 | [0m[35m[0m
[30;1m354 | [0m[35m        Lustre, OpenZFS have DNS name on file systems. Ontap has DNS name on storage virtual machine[0m
[30;1m355 | [0m[35m        """[0m
[30;1m356 | [0m[35m        return self.file_storage_info.get("DNSName") if self.file_storage_type in [LUSTRE, OPENZFS] [0m
[30;1m357 | [0m[35m[0m
[30;1m358 | [0m[35m    @property[0m
[30;1m359 | [0m[35m    def file_system_id(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1497[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m341 | [0m[35m    def mount_name(self):[0m
[30;1m342 | [0m[35m        """Return MountName of the FSx Lustre file system."""[0m
[30;1m343 | [0m[35m        return ([0m
[30;1m344 | [0m[35m            self.file_storage_info.get("LustreConfiguration").get("MountName")[0m
[30;1m345 | [0m[35m            if self.file_storage_type == LUSTRE[0m
[30;1m346 | [0m[35m            else ""[0m
[30;1m347 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1498[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m341 | [0m[35m    def mount_name(self):[0m
[30;1m342 | [0m[35m        """Return MountName of the FSx Lustre file system."""[0m
[30;1m343 | [0m[35m        return ([0m
[30;1m344 | [0m[35m            self.file_storage_info.get("LustreConfiguration").get("MountName")[0m
[30;1m345 | [0m[35m            if self.file_storage_type == LUSTRE[0m
[30;1m346 | [0m[35m            else ""[0m
[30;1m347 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1499[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m334 | [0m[35m        return ([0m
[30;1m335 | [0m[35m            self.file_storage_info.get("FileSystemType")[0m
[30;1m336 | [0m[35m            if self.file_storage_info.get("FileSystemType")[0m
[30;1m337 | [0m[35m            else self.file_storage_info.get("FileCacheType")[0m
[30;1m338 | [0m[35m        )[0m
[30;1m339 | [0m[35m[0m
[30;1m340 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1500[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m333 | [0m[35m        """Return the type of FSx file system (LUSTRE, WINDOWS, ONTAP, or OPENZFS). WINDOWS is not s[0m
[30;1m334 | [0m[35m        return ([0m
[30;1m335 | [0m[35m            self.file_storage_info.get("FileSystemType")[0m
[30;1m336 | [0m[35m            if self.file_storage_info.get("FileSystemType")[0m
[30;1m337 | [0m[35m            else self.file_storage_info.get("FileCacheType")[0m
[30;1m338 | [0m[35m        )[0m
[30;1m339 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1501[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m332 | [0m[35m    def file_storage_type(self):[0m
[30;1m333 | [0m[35m        """Return the type of FSx file system (LUSTRE, WINDOWS, ONTAP, or OPENZFS). WINDOWS is not s[0m
[30;1m334 | [0m[35m        return ([0m
[30;1m335 | [0m[35m            self.file_storage_info.get("FileSystemType")[0m
[30;1m336 | [0m[35m            if self.file_storage_info.get("FileSystemType")[0m
[30;1m337 | [0m[35m            else self.file_storage_info.get("FileCacheType")[0m
[30;1m338 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1502[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m    def ec2memory_size_in_mib(self):[0m
[30;1m321 | [0m[35m        """Return the amount of memory in MiB."""[0m
[30;1m322 | [0m[35m        return self.instance_type_data.get("MemoryInfo", {}).get("SizeInMiB")[0m
[30;1m323 | [0m[35m[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35mclass FsxStorageInfo:[0m

[31m--[ [0m[34mMatch #[0m[33m1503[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m319 | [0m[35m[0m
[30;1m320 | [0m[35m    def ec2memory_size_in_mib(self):[0m
[30;1m321 | [0m[35m        """Return the amount of memory in MiB."""[0m
[30;1m322 | [0m[35m        return self.instance_type_data.get("MemoryInfo", {}).get("SizeInMiB")[0m
[30;1m323 | [0m[35m[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35mclass FsxStorageInfo:[0m

[31m--[ [0m[34mMatch #[0m[33m1504[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m310 | [0m[35m[0m
[30;1m311 | [0m[35m    def supported_usage_classes(self):[0m
[30;1m312 | [0m[35m        """Return the list supported usage classes."""[0m
[30;1m313 | [0m[35m        supported_classes = self.instance_type_data.get("SupportedUsageClasses", [])[0m
[30;1m314 | [0m[35m        if "on-demand" in supported_classes:[0m
[30;1m315 | [0m[35m            # Replace official AWS with internal naming convention[0m
[30;1m316 | [0m[35m            supported_classes.remove("on-demand")[0m

[31m--[ [0m[34mMatch #[0m[33m1505[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m305 | [0m[35m[0m
[30;1m306 | [0m[35m        Defaults to `unsupported` if EbsInfo is not available for the instance type.[0m
[30;1m307 | [0m[35m        """[0m
[30;1m308 | [0m[35m        support_level = self.instance_type_data.get("EbsInfo", {}).get("EbsOptimizedSupport", "unsup[0m
[30;1m309 | [0m[35m        return support_level != "unsupported"[0m
[30;1m310 | [0m[35m[0m
[30;1m311 | [0m[35m    def supported_usage_classes(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1506[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m305 | [0m[35m[0m
[30;1m306 | [0m[35m        Defaults to `unsupported` if EbsInfo is not available for the instance type.[0m
[30;1m307 | [0m[35m        """[0m
[30;1m308 | [0m[35m        support_level = self.instance_type_data.get("EbsInfo", {}).get("EbsOptimizedSupport", "unsup[0m
[30;1m309 | [0m[35m        return support_level != "unsupported"[0m
[30;1m310 | [0m[35m[0m
[30;1m311 | [0m[35m    def supported_usage_classes(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1507[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m297 | [0m[35m[0m
[30;1m298 | [0m[35m    def instance_type(self):[0m
[30;1m299 | [0m[35m        """Get the instance type."""[0m
[30;1m300 | [0m[35m        return self.instance_type_data.get("InstanceType")[0m
[30;1m301 | [0m[35m[0m
[30;1m302 | [0m[35m    def is_ebs_optimized(self):[0m
[30;1m303 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m1508[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m293 | [0m[35m[0m
[30;1m294 | [0m[35m    def is_efa_supported(self):[0m
[30;1m295 | [0m[35m        """Check whether EFA is supported."""[0m
[30;1m296 | [0m[35m        return self.instance_type_data.get("NetworkInfo", {}).get("EfaSupported", False)[0m
[30;1m297 | [0m[35m[0m
[30;1m298 | [0m[35m    def instance_type(self):[0m
[30;1m299 | [0m[35m        """Get the instance type."""[0m

[31m--[ [0m[34mMatch #[0m[33m1509[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m293 | [0m[35m[0m
[30;1m294 | [0m[35m    def is_efa_supported(self):[0m
[30;1m295 | [0m[35m        """Check whether EFA is supported."""[0m
[30;1m296 | [0m[35m        return self.instance_type_data.get("NetworkInfo", {}).get("EfaSupported", False)[0m
[30;1m297 | [0m[35m[0m
[30;1m298 | [0m[35m    def instance_type(self):[0m
[30;1m299 | [0m[35m        """Get the instance type."""[0m

[31m--[ [0m[34mMatch #[0m[33m1510[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35m    def supported_architecture(self):[0m
[30;1m289 | [0m[35m        """Return the list of supported architectures."""[0m
[30;1m290 | [0m[35m        supported_architectures = self.instance_type_data.get("ProcessorInfo").get("SupportedArchite[0m
[30;1m291 | [0m[35m        # Some instance types support multiple architectures (x86_64 and i386). Filter unsupported o[0m
[30;1m292 | [0m[35m        return list(set(supported_architectures) & set(SUPPORTED_ARCHITECTURES))[0m
[30;1m293 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1511[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35m    def supported_architecture(self):[0m
[30;1m289 | [0m[35m        """Return the list of supported architectures."""[0m
[30;1m290 | [0m[35m        supported_architectures = self.instance_type_data.get("ProcessorInfo").get("SupportedArchite[0m
[30;1m291 | [0m[35m        # Some instance types support multiple architectures (x86_64 and i386). Filter unsupported o[0m
[30;1m292 | [0m[35m        return list(set(supported_architectures) & set(SUPPORTED_ARCHITECTURES))[0m
[30;1m293 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1512[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m    def instance_storage_supported(self) -> bool:[0m
[30;1m285 | [0m[35m        """Indicate whether instance storage is supported."""[0m
[30;1m286 | [0m[35m        return self.instance_type_data.get("InstanceStorageSupported")[0m
[30;1m287 | [0m[35m[0m
[30;1m288 | [0m[35m    def supported_architecture(self):[0m
[30;1m289 | [0m[35m        """Return the list of supported architectures."""[0m

[31m--[ [0m[34mMatch #[0m[33m1513[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m275 | [0m[35m        """Get number of vcpus for the given instance type."""[0m
[30;1m276 | [0m[35m        try:[0m
[30;1m277 | [0m[35m            vcpus_info = self.instance_type_data.get("VCpuInfo")[0m
[30;1m278 | [0m[35m            vcpus = vcpus_info.get("DefaultVCpus")[0m
[30;1m279 | [0m[35m        except KeyError:[0m
[30;1m280 | [0m[35m            vcpus = -1[0m
[30;1m281 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1514[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m274 | [0m[35m    def vcpus_count(self) -> int:[0m
[30;1m275 | [0m[35m        """Get number of vcpus for the given instance type."""[0m
[30;1m276 | [0m[35m        try:[0m
[30;1m277 | [0m[35m            vcpus_info = self.instance_type_data.get("VCpuInfo")[0m
[30;1m278 | [0m[35m            vcpus = vcpus_info.get("DefaultVCpus")[0m
[30;1m279 | [0m[35m        except KeyError:[0m
[30;1m280 | [0m[35m            vcpus = -1[0m

[31m--[ [0m[34mMatch #[0m[33m1515[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35m    def default_threads_per_core(self):[0m
[30;1m271 | [0m[35m        """Return the default threads per core for the given instance type."""[0m
[30;1m272 | [0m[35m        return self.instance_type_data.get("VCpuInfo", {}).get("DefaultThreadsPerCore")[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35m    def vcpus_count(self) -> int:[0m
[30;1m275 | [0m[35m        """Get number of vcpus for the given instance type."""[0m

[31m--[ [0m[34mMatch #[0m[33m1516[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35m    def default_threads_per_core(self):[0m
[30;1m271 | [0m[35m        """Return the default threads per core for the given instance type."""[0m
[30;1m272 | [0m[35m        return self.instance_type_data.get("VCpuInfo", {}).get("DefaultThreadsPerCore")[0m
[30;1m273 | [0m[35m[0m
[30;1m274 | [0m[35m    def vcpus_count(self) -> int:[0m
[30;1m275 | [0m[35m        """Get number of vcpus for the given instance type."""[0m

[31m--[ [0m[34mMatch #[0m[33m1517[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m264 | [0m[35m        return [[0m
[30;1m265 | [0m[35m            NetworkCardInfo(nic)[0m
[30;1m266 | [0m[35m            for nic in self.instance_type_data.get("NetworkInfo", {}).get("NetworkCards")[0m
[30;1m267 | [0m[35m            if nic.get("NetworkCardIndex") is not None[0m
[30;1m268 | [0m[35m        ][0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35m    def default_threads_per_core(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1518[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m263 | [0m[35m        """List of NICs for the instance."""[0m
[30;1m264 | [0m[35m        return [[0m
[30;1m265 | [0m[35m            NetworkCardInfo(nic)[0m
[30;1m266 | [0m[35m            for nic in self.instance_type_data.get("NetworkInfo", {}).get("NetworkCards")[0m
[30;1m267 | [0m[35m            if nic.get("NetworkCardIndex") is not None[0m
[30;1m268 | [0m[35m        ][0m
[30;1m269 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1519[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m263 | [0m[35m        """List of NICs for the instance."""[0m
[30;1m264 | [0m[35m        return [[0m
[30;1m265 | [0m[35m            NetworkCardInfo(nic)[0m
[30;1m266 | [0m[35m            for nic in self.instance_type_data.get("NetworkInfo", {}).get("NetworkCards")[0m
[30;1m267 | [0m[35m            if nic.get("NetworkCardIndex") is not None[0m
[30;1m268 | [0m[35m        ][0m
[30;1m269 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1520[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m    def max_network_cards(self) -> int:[0m
[30;1m259 | [0m[35m        """Max number of NICs for the instance."""[0m
[30;1m260 | [0m[35m        return len(self.instance_type_data.get("NetworkInfo", {}).get("NetworkCards"))[0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35m    def network_cards_list(self) -> list:[0m
[30;1m263 | [0m[35m        """List of NICs for the instance."""[0m

[31m--[ [0m[34mMatch #[0m[33m1521[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m    def max_network_cards(self) -> int:[0m
[30;1m259 | [0m[35m        """Max number of NICs for the instance."""[0m
[30;1m260 | [0m[35m        return len(self.instance_type_data.get("NetworkInfo", {}).get("NetworkCards"))[0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35m    def network_cards_list(self) -> list:[0m
[30;1m263 | [0m[35m        """List of NICs for the instance."""[0m

[31m--[ [0m[34mMatch #[0m[33m1522[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m249 | [0m[35m        """Get number of cores for the given instance type."""[0m
[30;1m250 | [0m[35m        try:[0m
[30;1m251 | [0m[35m            vcpus_info = self.instance_type_data.get("VCpuInfo")[0m
[30;1m252 | [0m[35m            cores = vcpus_info.get("DefaultCores")[0m
[30;1m253 | [0m[35m        except KeyError:[0m
[30;1m254 | [0m[35m            cores = -1[0m
[30;1m255 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1523[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m248 | [0m[35m    def cores_count(self) -> int:[0m
[30;1m249 | [0m[35m        """Get number of cores for the given instance type."""[0m
[30;1m250 | [0m[35m        try:[0m
[30;1m251 | [0m[35m            vcpus_info = self.instance_type_data.get("VCpuInfo")[0m
[30;1m252 | [0m[35m            cores = vcpus_info.get("DefaultCores")[0m
[30;1m253 | [0m[35m        except KeyError:[0m
[30;1m254 | [0m[35m            cores = -1[0m

[31m--[ [0m[34mMatch #[0m[33m1524[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m242 | [0m[35m        accelerator_count = 0[0m
[30;1m243 | [0m[35m        for accelerator in inference_accelerator_info.get("Accelerators", []):[0m
[30;1m244 | [0m[35m            if accelerator.get("Manufacturer", "").upper() == "AWS":[0m
[30;1m245 | [0m[35m                accelerator_count += accelerator.get("Count", 0)[0m
[30;1m246 | [0m[35m        return accelerator_count[0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35m    def cores_count(self) -> int:[0m

[31m--[ [0m[34mMatch #[0m[33m1525[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35m        accelerator_count = 0[0m
[30;1m243 | [0m[35m        for accelerator in inference_accelerator_info.get("Accelerators", []):[0m
[30;1m244 | [0m[35m            if accelerator.get("Manufacturer", "").upper() == "AWS":[0m
[30;1m245 | [0m[35m                accelerator_count += accelerator.get("Count", 0)[0m
[30;1m246 | [0m[35m        return accelerator_count[0m
[30;1m247 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1526[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m240 | [0m[35m        inference_accelerator_info = self.instance_type_data.get("InferenceAcceleratorInfo", {})[0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35m        accelerator_count = 0[0m
[30;1m243 | [0m[35m        for accelerator in inference_accelerator_info.get("Accelerators", []):[0m
[30;1m244 | [0m[35m            if accelerator.get("Manufacturer", "").upper() == "AWS":[0m
[30;1m245 | [0m[35m                accelerator_count += accelerator.get("Count", 0)[0m
[30;1m246 | [0m[35m        return accelerator_count[0m

[31m--[ [0m[34mMatch #[0m[33m1527[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m    def inference_accelerator_count(self):[0m
[30;1m239 | [0m[35m        """Return the total number of Inference Accelerators associated with this instance type."""[0m
[30;1m240 | [0m[35m        inference_accelerator_info = self.instance_type_data.get("InferenceAcceleratorInfo", {})[0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35m        accelerator_count = 0[0m
[30;1m243 | [0m[35m        for accelerator in inference_accelerator_info.get("Accelerators", []):[0m

[31m--[ [0m[34mMatch #[0m[33m1528[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m229 | [0m[35m        inference_accelerator_info = self.instance_type_data.get("InferenceAcceleratorInfo", {})[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m        inference_accelerator_manufacturers = list([0m
[30;1m232 | [0m[35m            {accelerator.get("Manufacturer", "") for accelerator in inference_accelerator_info.get("[0m
[30;1m233 | [0m[35m        )[0m
[30;1m234 | [0m[35m[0m
[30;1m235 | [0m[35m        # Only one accelerator manufacturer is associated with each Instance Type's accelerator[0m

[31m--[ [0m[34mMatch #[0m[33m1529[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m229 | [0m[35m        inference_accelerator_info = self.instance_type_data.get("InferenceAcceleratorInfo", {})[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m        inference_accelerator_manufacturers = list([0m
[30;1m232 | [0m[35m            {accelerator.get("Manufacturer", "") for accelerator in inference_accelerator_info.get("[0m
[30;1m233 | [0m[35m        )[0m
[30;1m234 | [0m[35m[0m
[30;1m235 | [0m[35m        # Only one accelerator manufacturer is associated with each Instance Type's accelerator[0m

[31m--[ [0m[34mMatch #[0m[33m1530[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m    def inference_accelerator_manufacturer(self) -> str:[0m
[30;1m228 | [0m[35m        """Return the Inference Accelerator Manufacturer supported by this instance type."""[0m
[30;1m229 | [0m[35m        inference_accelerator_info = self.instance_type_data.get("InferenceAcceleratorInfo", {})[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m        inference_accelerator_manufacturers = list([0m
[30;1m232 | [0m[35m            {accelerator.get("Manufacturer", "") for accelerator in inference_accelerator_info.get("[0m

[31m--[ [0m[34mMatch #[0m[33m1531[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m219 | [0m[35m        """Return the GPU manufacturer supported by this instance type."""[0m
[30;1m220 | [0m[35m        gpu_info = self.instance_type_data.get("GpuInfo", {})[0m
[30;1m221 | [0m[35m[0m
[30;1m222 | [0m[35m        gpu_manufacturers = list({gpu.get("Manufacturer", "") for gpu in gpu_info.get("Gpus", [])})[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m        # Only one GPU manufacturer is associated with each Instance Type's GPU[0m
[30;1m225 | [0m[35m        return gpu_manufacturers[0] if gpu_manufacturers else ""[0m

[31m--[ [0m[34mMatch #[0m[33m1532[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m219 | [0m[35m        """Return the GPU manufacturer supported by this instance type."""[0m
[30;1m220 | [0m[35m        gpu_info = self.instance_type_data.get("GpuInfo", {})[0m
[30;1m221 | [0m[35m[0m
[30;1m222 | [0m[35m        gpu_manufacturers = list({gpu.get("Manufacturer", "") for gpu in gpu_info.get("Gpus", [])})[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m        # Only one GPU manufacturer is associated with each Instance Type's GPU[0m
[30;1m225 | [0m[35m        return gpu_manufacturers[0] if gpu_manufacturers else ""[0m

[31m--[ [0m[34mMatch #[0m[33m1533[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m    def gpu_manufacturer(self) -> str:[0m
[30;1m219 | [0m[35m        """Return the GPU manufacturer supported by this instance type."""[0m
[30;1m220 | [0m[35m        gpu_info = self.instance_type_data.get("GpuInfo", {})[0m
[30;1m221 | [0m[35m[0m
[30;1m222 | [0m[35m        gpu_manufacturers = list({gpu.get("Manufacturer", "") for gpu in gpu_info.get("Gpus", [])})[0m
[30;1m223 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1534[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m211 | [0m[35m            for gpu in gpu_info.get("Gpus", []):[0m
[30;1m212 | [0m[35m                manufacturer = gpu.get("Manufacturer", "")[0m
[30;1m213 | [0m[35m                if manufacturer.upper() == "NVIDIA":[0m
[30;1m214 | [0m[35m                    gpu_count += gpu.get("Count", 0)[0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m        return gpu_count[0m
[30;1m217 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1535[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m        gpu_count = 0[0m
[30;1m210 | [0m[35m        if gpu_info:[0m
[30;1m211 | [0m[35m            for gpu in gpu_info.get("Gpus", []):[0m
[30;1m212 | [0m[35m                manufacturer = gpu.get("Manufacturer", "")[0m
[30;1m213 | [0m[35m                if manufacturer.upper() == "NVIDIA":[0m
[30;1m214 | [0m[35m                    gpu_count += gpu.get("Count", 0)[0m
[30;1m215 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1536[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m        gpu_count = 0[0m
[30;1m210 | [0m[35m        if gpu_info:[0m
[30;1m211 | [0m[35m            for gpu in gpu_info.get("Gpus", []):[0m
[30;1m212 | [0m[35m                manufacturer = gpu.get("Manufacturer", "")[0m
[30;1m213 | [0m[35m                if manufacturer.upper() == "NVIDIA":[0m
[30;1m214 | [0m[35m                    gpu_count += gpu.get("Count", 0)[0m

[31m--[ [0m[34mMatch #[0m[33m1537[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m    def gpu_count(self):[0m
[30;1m206 | [0m[35m        """Return the number of GPUs for the instance."""[0m
[30;1m207 | [0m[35m        gpu_info = self.instance_type_data.get("GpuInfo", None)[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m        gpu_count = 0[0m
[30;1m210 | [0m[35m        if gpu_info:[0m

[31m--[ [0m[34mMatch #[0m[33m1538[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m    def maximum_network_interfaces(self) -> int:[0m
[30;1m194 | [0m[35m        """Return maximum network interfaces."""[0m
[30;1m195 | [0m[35m        result = self.network_card_data.get("MaximumNetworkInterfaces")[0m
[30;1m196 | [0m[35m        return None if result is None else int(result)[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1539[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m    def network_card_index(self) -> int:[0m
[30;1m189 | [0m[35m        """Return the network card index."""[0m
[30;1m190 | [0m[35m        result = self.network_card_data.get("NetworkCardIndex")[0m
[30;1m191 | [0m[35m        return None if result is None else int(result)[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m    def maximum_network_interfaces(self) -> int:[0m

[31m--[ [0m[34mMatch #[0m[33m1540[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m158 | [0m[35m    @property[0m
[30;1m159 | [0m[35m    def launch_time(self):[0m
[30;1m160 | [0m[35m        """Return launch time of the instance."""[0m
[30;1m161 | [0m[35m        return self._instance_data.get("LaunchTime")[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    @property[0m
[30;1m164 | [0m[35m    def node_type(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1541[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m153 | [0m[35m    @property[0m
[30;1m154 | [0m[35m    def instance_type(self) -> str:[0m
[30;1m155 | [0m[35m        """Return instance type."""[0m
[30;1m156 | [0m[35m        return self._instance_data.get("InstanceType")[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m    @property[0m
[30;1m159 | [0m[35m    def launch_time(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1542[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m143 | [0m[35m    @property[0m
[30;1m144 | [0m[35m    def private_dns_name(self) -> str:[0m
[30;1m145 | [0m[35m        """Return Private DNS name of the instance (e.g. "ip-10-0-0-157.us-east-2.compute.internal")[0m
[30;1m146 | [0m[35m        return self._instance_data.get("PrivateDnsName")[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m    @property[0m
[30;1m149 | [0m[35m    def private_dns_name_short(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1543[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m138 | [0m[35m    @property[0m
[30;1m139 | [0m[35m    def private_ip(self) -> str:[0m
[30;1m140 | [0m[35m        """Return Private Ip of the instance."""[0m
[30;1m141 | [0m[35m        return self._instance_data.get("PrivateIpAddress")[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m    @property[0m
[30;1m144 | [0m[35m    def private_dns_name(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1544[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m    @property[0m
[30;1m134 | [0m[35m    def public_ip(self) -> str:[0m
[30;1m135 | [0m[35m        """Return Public Ip of the instance or None if not present."""[0m
[30;1m136 | [0m[35m        return self._instance_data.get("PublicIpAddress", None)[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m    @property[0m
[30;1m139 | [0m[35m    def private_ip(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1545[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m    @property[0m
[30;1m129 | [0m[35m    def state(self) -> str:[0m
[30;1m130 | [0m[35m        """Return instance state."""[0m
[30;1m131 | [0m[35m        return self._instance_data.get("State").get("Name")[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m    @property[0m
[30;1m134 | [0m[35m    def public_ip(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1546[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m    @property[0m
[30;1m129 | [0m[35m    def state(self) -> str:[0m
[30;1m130 | [0m[35m        """Return instance state."""[0m
[30;1m131 | [0m[35m        return self._instance_data.get("State").get("Name")[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m    @property[0m
[30;1m134 | [0m[35m    def public_ip(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1547[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m123 | [0m[35m    @property[0m
[30;1m124 | [0m[35m    def id(self) -> str:[0m
[30;1m125 | [0m[35m        """Return instance id."""[0m
[30;1m126 | [0m[35m        return self._instance_data.get("InstanceId")[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m    @property[0m
[30;1m129 | [0m[35m    def state(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1548[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m    def __init__(self, instance_data: dict):[0m
[30;1m120 | [0m[35m        self._instance_data = instance_data[0m
[30;1m121 | [0m[35m        self._tags = self._instance_data.get("Tags", [])[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    @property[0m
[30;1m124 | [0m[35m    def id(self) -> str:[0m

[31m--[ [0m[34mMatch #[0m[33m1549[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m    def get_resource_physical_id(self, resource_logical_id: str):[0m
[30;1m108 | [0m[35m        """Return the resource information."""[0m
[30;1m109 | [0m[35m        resource = self.resources.get(resource_logical_id)[0m
[30;1m110 | [0m[35m        if resource:[0m
[30;1m111 | [0m[35m            return resource["PhysicalResourceId"][0m
[30;1m112 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m1550[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m80 | [0m[35m    @property[0m
[30;1m81 | [0m[35m    def last_updated_time(self):[0m
[30;1m82 | [0m[35m        """Return last updated time of the stack."""[0m
[30;1m83 | [0m[35m        return str(self._stack_data.get("LastUpdatedTime", self.creation_time))[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    @property[0m
[30;1m86 | [0m[35m    def is_working_status(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1551[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m    @property[0m
[30;1m76 | [0m[35m    def creation_time(self):[0m
[30;1m77 | [0m[35m        """Return creation time of the stack."""[0m
[30;1m78 | [0m[35m        return str(self._stack_data.get("CreationTime"))[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    @property[0m
[30;1m81 | [0m[35m    def last_updated_time(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1552[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m    @property[0m
[30;1m71 | [0m[35m    def status_reason(self):[0m
[30;1m72 | [0m[35m        """Return the reason the stack is in its current status."""[0m
[30;1m73 | [0m[35m        return self._stack_data.get("StackStatusReason", None)[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    @property[0m
[30;1m76 | [0m[35m    def creation_time(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1553[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m    @property[0m
[30;1m66 | [0m[35m    def status(self):[0m
[30;1m67 | [0m[35m        """Return the status of the stack."""[0m
[30;1m68 | [0m[35m        return self._stack_data.get("StackStatus")[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    @property[0m
[30;1m71 | [0m[35m    def status_reason(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1554[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m51 | [0m[35m    @property[0m
[30;1m52 | [0m[35m    def name(self):[0m
[30;1m53 | [0m[35m        """Return the name of the stack."""[0m
[30;1m54 | [0m[35m        return self._stack_data.get("StackName")[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    @property[0m
[30;1m57 | [0m[35m    def resources(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1555[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m    @property[0m
[30;1m47 | [0m[35m    def id(self):[0m
[30;1m48 | [0m[35m        """Return the id/arn of the stack."""[0m
[30;1m49 | [0m[35m        return self._stack_data.get("StackId")[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    @property[0m
[30;1m52 | [0m[35m    def name(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1556[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35m        self._stack_data = stack_data[0m
[30;1m41 | [0m[35m        self._params = self._stack_data.get("Parameters", [])[0m
[30;1m42 | [0m[35m        self.tags = self._stack_data.get("Tags", [])[0m
[30;1m43 | [0m[35m        self.outputs = self._stack_data.get("Outputs", [])[0m
[30;1m44 | [0m[35m        self.__resources = None[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1557[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35m        """[0m
[30;1m40 | [0m[35m        self._stack_data = stack_data[0m
[30;1m41 | [0m[35m        self._params = self._stack_data.get("Parameters", [])[0m
[30;1m42 | [0m[35m        self.tags = self._stack_data.get("Tags", [])[0m
[30;1m43 | [0m[35m        self.outputs = self._stack_data.get("Outputs", [])[0m
[30;1m44 | [0m[35m        self.__resources = None[0m
[30;1m45 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1558[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m38 | [0m[35m        If the stack doesn't exist it raises an exception.[0m
[30;1m39 | [0m[35m        """[0m
[30;1m40 | [0m[35m        self._stack_data = stack_data[0m
[30;1m41 | [0m[35m        self._params = self._stack_data.get("Parameters", [])[0m
[30;1m42 | [0m[35m        self.tags = self._stack_data.get("Tags", [])[0m
[30;1m43 | [0m[35m        self.outputs = self._stack_data.get("Outputs", [])[0m
[30;1m44 | [0m[35m        self.__resources = None[0m

[31m--[ [0m[34mMatch #[0m[33m1559[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    @property[0m
[30;1m164 | [0m[35m    def node_type(self) -> str:[0m
[30;1m165 | [0m[35m        """Return node type of the instance."""[0m
[30;1m166 | [0m[35m        return self._get_tag(PCLUSTER_NODE_TYPE_TAG)[0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1560[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m157 | [0m[35m[0m
[30;1m158 | [0m[35m    @property[0m
[30;1m159 | [0m[35m    def launch_time(self):[0m
[30;1m160 | [0m[35m        """Return launch time of the instance."""[0m
[30;1m161 | [0m[35m        return self._instance_data.get("LaunchTime")[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1561[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m    @property[0m
[30;1m139 | [0m[35m    def private_ip(self) -> str:[0m
[30;1m140 | [0m[35m        """Return Private Ip of the instance."""[0m
[30;1m141 | [0m[35m        return self._instance_data.get("PrivateIpAddress")[0m
[30;1m142 | [0m[35m[0m
[30;1m143 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1562[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m    @property[0m
[30;1m134 | [0m[35m    def public_ip(self) -> str:[0m
[30;1m135 | [0m[35m        """Return Public Ip of the instance or None if not present."""[0m
[30;1m136 | [0m[35m        return self._instance_data.get("PublicIpAddress", None)[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1563[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    @property[0m
[30;1m81 | [0m[35m    def last_updated_time(self):[0m
[30;1m82 | [0m[35m        """Return last updated time of the stack."""[0m
[30;1m83 | [0m[35m        return str(self._stack_data.get("LastUpdatedTime", self.creation_time))[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1564[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m    @property[0m
[30;1m76 | [0m[35m    def creation_time(self):[0m
[30;1m77 | [0m[35m        """Return creation time of the stack."""[0m
[30;1m78 | [0m[35m        return str(self._stack_data.get("CreationTime"))[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    @property[0m

[31m--[ [0m[34mMatch #[0m[33m1565[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/aws_resources.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1566[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/login_nodes_pool.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1567[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/build_image_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1568[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/cluster_instance.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1569[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/delete_image_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1570[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/update_compute_fleet_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m80 | [0m[35m    def last_status_updated_time(self, last_status_updated_time):[0m
[30;1m81 | [0m[35m        """Sets the last_status_updated_time of this UpdateComputeFleetResponseContent.[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m        Timestamp representing the last status update time.[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m        :param last_status_updated_time: The last_status_updated_time of this UpdateComputeFleetResp[0m
[30;1m86 | [0m[35m        :type last_status_updated_time: datetime[0m

[31m--[ [0m[34mMatch #[0m[33m1571[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/update_compute_fleet_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m69 | [0m[35m    def last_status_updated_time(self):[0m
[30;1m70 | [0m[35m        """Gets the last_status_updated_time of this UpdateComputeFleetResponseContent.[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m        Timestamp representing the last status update time.[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m        :return: The last_status_updated_time of this UpdateComputeFleetResponseContent.[0m
[30;1m75 | [0m[35m        :rtype: datetime[0m

[31m--[ [0m[34mMatch #[0m[33m1572[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/cfn.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m183 | [0m[35m        for stack in result.get("Stacks", []):[0m
[30;1m184 | [0m[35m            if stack.get("ParentId") is None and StackInfo(stack).get_tag(tag):[0m
[30;1m185 | [0m[35m                stack_list.append(stack)[0m
[30;1m186 | [0m[35m        return stack_list, result.get("NextToken")[0m

[31m--[ [0m[34mMatch #[0m[33m1573[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/cfn.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m        result = self._client.describe_stacks(**describe_stacks_kwargs)[0m
[30;1m182 | [0m[35m        stack_list = [][0m
[30;1m183 | [0m[35m        for stack in result.get("Stacks", []):[0m
[30;1m184 | [0m[35m            if stack.get("ParentId") is None and StackInfo(stack).get_tag(tag):[0m
[30;1m185 | [0m[35m                stack_list.append(stack)[0m
[30;1m186 | [0m[35m        return stack_list, result.get("NextToken")[0m

[31m--[ [0m[34mMatch #[0m[33m1574[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/cfn.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m        result = self._client.describe_stacks(**describe_stacks_kwargs)[0m
[30;1m182 | [0m[35m        stack_list = [][0m
[30;1m183 | [0m[35m        for stack in result.get("Stacks", []):[0m
[30;1m184 | [0m[35m            if stack.get("ParentId") is None and StackInfo(stack).get_tag(tag):[0m
[30;1m185 | [0m[35m                stack_list.append(stack)[0m
[30;1m186 | [0m[35m        return stack_list, result.get("NextToken")[0m

[31m--[ [0m[34mMatch #[0m[33m1575[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/cfn.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m165 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m166 | [0m[35m    def describe_stack_resources(self, stack_name: str):[0m
[30;1m167 | [0m[35m        """Get stack resources information."""[0m
[30;1m168 | [0m[35m        response = self._client.describe_stack_resources(StackName=stack_name).get("StackResources")[0m
[30;1m169 | [0m[35m        return {resource["LogicalResourceId"]: resource for resource in response}  # Build dictionar[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m

[31m--[ [0m[34mMatch #[0m[33m1576[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/cfn.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m145 | [0m[35m    def get_stack_template(self, stack_name: str):[0m
[30;1m146 | [0m[35m        """Get stack template."""[0m
[30;1m147 | [0m[35m        return self._client.get_template(StackName=stack_name).get("TemplateBody")[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    @AWSExceptionHandler.handle_client_exception[0m
[30;1m150 | [0m[35m    def list_pcluster_stacks(self, next_token=None):[0m

[31m--[ [0m[34mMatch #[0m[33m1577[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/cfn.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m            event.get("ResourceStatus"),[0m
[30;1m131 | [0m[35m            event.get("ResourceType"),[0m
[30;1m132 | [0m[35m            event.get("LogicalResourceId"),[0m
[30;1m133 | [0m[35m            event.get("ResourceStatusReason", ""),[0m
[30;1m134 | [0m[35m        )[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m    def stack_exists(self, stack_name: str):[0m

[31m--[ [0m[34mMatch #[0m[33m1578[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/cfn.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m129 | [0m[35m            event.get("Timestamp").isoformat(timespec="seconds"),[0m
[30;1m130 | [0m[35m            event.get("ResourceStatus"),[0m
[30;1m131 | [0m[35m            event.get("ResourceType"),[0m
[30;1m132 | [0m[35m            event.get("LogicalResourceId"),[0m
[30;1m133 | [0m[35m            event.get("ResourceStatusReason", ""),[0m
[30;1m134 | [0m[35m        )[0m
[30;1m135 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1579[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/cfn.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m        return "{} {} {} {} {}".format([0m
[30;1m129 | [0m[35m            event.get("Timestamp").isoformat(timespec="seconds"),[0m
[30;1m130 | [0m[35m            event.get("ResourceStatus"),[0m
[30;1m131 | [0m[35m            event.get("ResourceType"),[0m
[30;1m132 | [0m[35m            event.get("LogicalResourceId"),[0m
[30;1m133 | [0m[35m            event.get("ResourceStatusReason", ""),[0m
[30;1m134 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1580[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/cfn.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m        """Format CFN Stack event."""[0m
[30;1m128 | [0m[35m        return "{} {} {} {} {}".format([0m
[30;1m129 | [0m[35m            event.get("Timestamp").isoformat(timespec="seconds"),[0m
[30;1m130 | [0m[35m            event.get("ResourceStatus"),[0m
[30;1m131 | [0m[35m            event.get("ResourceType"),[0m
[30;1m132 | [0m[35m            event.get("LogicalResourceId"),[0m
[30;1m133 | [0m[35m            event.get("ResourceStatusReason", ""),[0m

[31m--[ [0m[34mMatch #[0m[33m1581[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/cfn.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m126 | [0m[35m    def format_event(event):[0m
[30;1m127 | [0m[35m        """Format CFN Stack event."""[0m
[30;1m128 | [0m[35m        return "{} {} {} {} {}".format([0m
[30;1m129 | [0m[35m            event.get("Timestamp").isoformat(timespec="seconds"),[0m
[30;1m130 | [0m[35m            event.get("ResourceStatus"),[0m
[30;1m131 | [0m[35m            event.get("ResourceType"),[0m
[30;1m132 | [0m[35m            event.get("LogicalResourceId"),[0m

[31m--[ [0m[34mMatch #[0m[33m1582[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/cfn.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m    def describe_stack(self, stack_name: str):[0m
[30;1m107 | [0m[35m        """Get information for the given stack."""[0m
[30;1m108 | [0m[35m        try:[0m
[30;1m109 | [0m[35m            return self._client.describe_stacks(StackName=stack_name).get("Stacks")[0][0m
[30;1m110 | [0m[35m        except ClientError as e:[0m
[30;1m111 | [0m[35m            if e.response["Error"]["Code"] == AWSClientError.ErrorCode.VALIDATION_ERROR.value:[0m
[30;1m112 | [0m[35m                LOGGER.info("Could not describe CloudFormation stack %s: %s", stack_name, e)[0m

[31m--[ [0m[34mMatch #[0m[33m1583[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/cfn.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1584[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/aws/cfn.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m80 | [0m[35m        """Update CFN stack."""[0m
[30;1m81 | [0m[35m        return self._client.update_stack([0m
[30;1m82 | [0m[35m            StackName=stack_name,[0m
[30;1m83 | [0m[35m            TemplateBody=json.dumps(updated_template, indent=2),  # Indent so it looks nice in the c[0m
[30;1m84 | [0m[35m            Parameters=params,[0m
[30;1m85 | [0m[35m            Capabilities=["CAPABILITY_IAM", "CAPABILITY_NAMED_IAM"],[0m
[30;1m86 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1585[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/image_info_summary.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1586[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/ami_info.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1587[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/image_configuration_structure.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1588[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/node_type.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1589[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/stack_event.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m369 | [0m[35m    def timestamp(self, timestamp):[0m
[30;1m370 | [0m[35m        """Sets the timestamp of this StackEvent.[0m
[30;1m371 | [0m[35m[0m
[30;1m372 | [0m[35m        Time the status was updated.[0m
[30;1m373 | [0m[35m[0m
[30;1m374 | [0m[35m        :param timestamp: The timestamp of this StackEvent.[0m
[30;1m375 | [0m[35m        :type timestamp: datetime[0m

[31m--[ [0m[34mMatch #[0m[33m1590[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/stack_event.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m358 | [0m[35m    def timestamp(self):[0m
[30;1m359 | [0m[35m        """Gets the timestamp of this StackEvent.[0m
[30;1m360 | [0m[35m[0m
[30;1m361 | [0m[35m        Time the status was updated.[0m
[30;1m362 | [0m[35m[0m
[30;1m363 | [0m[35m        :return: The timestamp of this StackEvent.[0m
[30;1m364 | [0m[35m        :rtype: datetime[0m

[31m--[ [0m[34mMatch #[0m[33m1591[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/typing_utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1592[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/crhelper/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m            # ParallelCluster only supports python >= 3.4.3[0m
[30;1m32 | [0m[35m            # [B309:blacklist] Use of HTTPSConnection on older versions of Python prior to 2.7.9 and[0m
[30;1m33 | [0m[35m            connection = HTTPSConnection(host)  # nosec B309 nosemgrep[0m
[30;1m34 | [0m[35m            connection.request(method="PUT", url=url, body=json_response_body, headers=headers)[0m
[30;1m35 | [0m[35m            response = connection.getresponse()[0m
[30;1m36 | [0m[35m            logger.info("CloudFormation returned status code: %s", response.reason)[0m
[30;1m37 | [0m[35m            break[0m

[31m--[ [0m[34mMatch #[0m[33m1593[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/crhelper/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport json[0m
[30;1m6 | [0m[35mimport logging[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom http.client import HTTPSConnection[0m
[30;1m9 | [0m[35mfrom urllib.parse import urlsplit, urlunsplit[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mlogger = logging.getLogger(__name__)[0m

[31m--[ [0m[34mMatch #[0m[33m1594[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/crhelper/resource_helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m209 | [0m[35m            self.Status = FAILED[0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m    def _timeout(self):[0m
[30;1m212 | [0m[35m        logger.error("Execution is about to time out, sending failure message")[0m
[30;1m213 | [0m[35m        self._send(FAILED, "Execution timed out")[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m    def _set_timeout(self):[0m

[31m--[ [0m[34mMatch #[0m[33m1595[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/crhelper/resource_helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m17 | [0m[35mimport random[0m
[30;1m18 | [0m[35mimport string[0m
[30;1m19 | [0m[35mimport threading[0m
[30;1m20 | [0m[35mfrom time import sleep[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mimport boto3[0m
[30;1m23 | [0m[35mfrom crhelper import log_helper[0m

[31m--[ [0m[34mMatch #[0m[33m1596[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/crhelper/resource_helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m# -*- coding: utf-8 -*-[0m
[30;1m4 | [0m[35m"""[0m
[30;1m5 | [0m[35mTODO:[0m
[30;1m6 | [0m[35m* Async mode – take a wait condition handle as an input, increases max timeout to 12 hours[0m
[30;1m7 | [0m[35m* Idempotency – If a duplicate request comes in (say there was a network error in signaling back to [0m
[30;1m8 | [0m[35m  request should return the already created response, will need a persistent store of some kind...[0m
[30;1m9 | [0m[35m* Functional tests[0m

[31m--[ [0m[34mMatch #[0m[33m1597[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/mount_nfs.sh[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m4 | [0m[35m#[0m
[30;1m5 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You[0m
[30;1m6 | [0m[35m# may not use this file except in compliance with the License. A copy[0m
[30;1m7 | [0m[35m# of the License is located at[0m
[30;1m8 | [0m[35m#[0m
[30;1m9 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m10 | [0m[35m#[0m
[30;1m11 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is[0m

[31m--[ [0m[34mMatch #[0m[33m1598[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/mount_nfs.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m    fi[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    # Check that the filesystem is mounted as appropriate[0m
[30;1m67 | [0m[35m    mount_line=$(mount | grep "${head_node_ip}:${shared_dir}")[0m
[30;1m68 | [0m[35m    if [[ -z "${mount_line}" ]]; then[0m
[30;1m69 | [0m[35m        error_exit "mount succeeded but nfs volume from ${head_node_ip}:${shared_dir} was not mounte[0m
[30;1m70 | [0m[35m    fi[0m

[31m--[ [0m[34mMatch #[0m[33m1599[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/mount_nfs.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35m    mkdir -p ${shared_dir}[0m
[30;1m61 | [0m[35m    error_message=$(mount -t nfs -o hard,intr,noatime,_netdev "${head_node_ip}":"${shared_dir}" "${s[0m
[30;1m62 | [0m[35m    if [[ $? -ne 0 ]]; then[0m
[30;1m63 | [0m[35m        error_exit "Failed to mount nfs volume from ${head_node_ip}:${shared_dir} with error_message[0m
[30;1m64 | [0m[35m    fi[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    # Check that the filesystem is mounted as appropriate[0m

[31m--[ [0m[34mMatch #[0m[33m1600[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/mount_nfs.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m49 | [0m[35m    fi[0m
[30;1m50 | [0m[35m}[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m# mount nfs[0m
[30;1m53 | [0m[35mmount_nfs() {[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    error_message=$(rpcinfo &> /dev/null || rpcbind 2>&1)[0m

[31m--[ [0m[34mMatch #[0m[33m1601[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/mount_nfs.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m# Check that the arguments are valid[0m
[30;1m42 | [0m[35mcheck_arguments_valid(){[0m
[30;1m43 | [0m[35m    if [ -z "${head_node_ip}" ]; then[0m
[30;1m44 | [0m[35m        error_exit_usage "Head Node IP is a required argument"[0m
[30;1m45 | [0m[35m    fi[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m    if [ -z "${shared_dir}" ]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1602[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/mount_nfs.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35mUSAGE:[0m
[30;1m35 | [0m[35mmount_nfs <head_node_ip> <shared_dir>[0m
[30;1m36 | [0m[35mhead_node_ip: ip address of the main node[0m
[30;1m37 | [0m[35mshared_dir: directory from head node to be shared. If directory doesn't exist on compute, will be cr[0m
[30;1m38 | [0m[35mENDUSAGE[0m
[30;1m39 | [0m[35m}[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1603[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/mount_nfs.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35mUSAGE:[0m
[30;1m35 | [0m[35mmount_nfs <head_node_ip> <shared_dir>[0m
[30;1m36 | [0m[35mhead_node_ip: ip address of the main node[0m
[30;1m37 | [0m[35mshared_dir: directory from head node to be shared. If directory doesn't exist on compute, will be cr[0m
[30;1m38 | [0m[35mENDUSAGE[0m
[30;1m39 | [0m[35m}[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1604[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/mount_nfs.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35mUSAGE:[0m
[30;1m35 | [0m[35mmount_nfs <head_node_ip> <shared_dir>[0m
[30;1m36 | [0m[35mhead_node_ip: ip address of the main node[0m
[30;1m37 | [0m[35mshared_dir: directory from head node to be shared. If directory doesn't exist on compute, will be cr[0m
[30;1m38 | [0m[35mENDUSAGE[0m
[30;1m39 | [0m[35m}[0m

[31m--[ [0m[34mMatch #[0m[33m1605[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/mount_nfs.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35musage() {[0m
[30;1m30 | [0m[35m    cat <<ENDUSAGE[0m
[30;1m31 | [0m[35mThis script mounts the shared dir from head node instance on the nodes in the batch job.[0m
[30;1m32 | [0m[35mThe shared directory will be created if it does not exist.[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35mUSAGE:[0m

[31m--[ [0m[34mMatch #[0m[33m1606[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/mount_nfs.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35musage() {[0m
[30;1m30 | [0m[35m    cat <<ENDUSAGE[0m
[30;1m31 | [0m[35mThis script mounts the shared dir from head node instance on the nodes in the batch job.[0m
[30;1m32 | [0m[35mThe shared directory will be created if it does not exist.[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35mUSAGE:[0m

[31m--[ [0m[34mMatch #[0m[33m1607[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/mount_nfs.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m}[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35musage() {[0m
[30;1m30 | [0m[35m    cat <<ENDUSAGE[0m
[30;1m31 | [0m[35mThis script mounts the shared dir from head node instance on the nodes in the batch job.[0m
[30;1m32 | [0m[35mThe shared directory will be created if it does not exist.[0m
[30;1m33 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1608[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/entrypoint.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m  /parallelcluster/bin/generate_hostfile.sh "${PCLUSTER_HIDDEN_FOLDER}" "${HOME}"[0m
[30;1m49 | [0m[35mfi[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m# run the user's script[0m
[30;1m52 | [0m[35mecho "Starting the job..."[0m
[30;1m53 | [0m[35mexec "$@"[0m

[31m--[ [0m[34mMatch #[0m[33m1609[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/entrypoint.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m  /parallelcluster/bin/mount_efs.sh "${efs_ids[i]}" "${PCLUSTER_AWS_REGION}" "${efs_shared_dirs[i]}"[0m
[30;1m39 | [0m[35mdone[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m# mount RAID via nfs[0m
[30;1m42 | [0m[35mif [[ ${PCLUSTER_RAID_SHARED_DIR} != "NONE" ]]; then[0m
[30;1m43 | [0m[35m  /parallelcluster/bin/mount_nfs.sh "${PCLUSTER_HEAD_NODE_IP}" "${PCLUSTER_RAID_SHARED_DIR}"[0m
[30;1m44 | [0m[35mfi[0m

[31m--[ [0m[34mMatch #[0m[33m1610[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/entrypoint.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m  fi[0m
[30;1m32 | [0m[35mdone[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m# mount EFS via nfs[0m
[30;1m35 | [0m[35mIFS=',' read -r -a efs_ids <<< "${PCLUSTER_EFS_FS_IDS}"[0m
[30;1m36 | [0m[35mIFS=',' read -r -a efs_shared_dirs <<< "${PCLUSTER_EFS_SHARED_DIRS}"[0m
[30;1m37 | [0m[35mfor i in "${!efs_ids[@]}"; do[0m

[31m--[ [0m[34mMatch #[0m[33m1611[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/entrypoint.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35mfor ebs_shared_dir in ${ebs_shared_dirs}[0m
[30;1m27 | [0m[35mdo[0m
[30;1m28 | [0m[35m  if [[ ${ebs_shared_dir} != "NONE" ]]; then[0m
[30;1m29 | [0m[35m    # mount nfs[0m
[30;1m30 | [0m[35m    /parallelcluster/bin/mount_nfs.sh "${PCLUSTER_HEAD_NODE_IP}" "${ebs_shared_dir}"[0m
[30;1m31 | [0m[35m  fi[0m
[30;1m32 | [0m[35mdone[0m

[31m--[ [0m[34mMatch #[0m[33m1612[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/entrypoint.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35meval "$(ssh-agent -s)" && ssh-add ${SSHDIR}/id_rsa[0m
[30;1m10 | [0m[35m/usr/sbin/sshd -f /root/.ssh/sshd_config -h /root/.ssh/ssh_host_rsa_key[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m# mount nfs[0m
[30;1m13 | [0m[35mecho "Mounting /home..."[0m
[30;1m14 | [0m[35m/parallelcluster/bin/mount_nfs.sh "${PCLUSTER_HEAD_NODE_IP}" "/home"[0m
[30;1m15 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1613[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/entrypoint.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mecho "Initializing the environment..."[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m# Starting ssh agents[0m
[30;1m8 | [0m[35mecho "Starting ssh agents..."[0m
[30;1m9 | [0m[35meval "$(ssh-agent -s)" && ssh-add ${SSHDIR}/id_rsa[0m
[30;1m10 | [0m[35m/usr/sbin/sshd -f /root/.ssh/sshd_config -h /root/.ssh/ssh_host_rsa_key[0m
[30;1m11 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1614[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/scripts/entrypoint.sh[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mecho "Job id: ${AWS_BATCH_JOB_ID}"[0m
[30;1m5 | [0m[35mecho "Initializing the environment..."[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m# Starting ssh agents[0m
[30;1m8 | [0m[35mecho "Starting ssh agents..."[0m
[30;1m9 | [0m[35meval "$(ssh-agent -s)" && ssh-add ${SSHDIR}/id_rsa[0m
[30;1m10 | [0m[35m/usr/sbin/sshd -f /root/.ssh/sshd_config -h /root/.ssh/ssh_host_rsa_key[0m

[31m--[ [0m[34mMatch #[0m[33m1615[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/create_cluster_bad_request_exception_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1616[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/ec2_instance.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1617[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/list_clusters_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1618[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1619[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/image_builder_image_status.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1620[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/list_official_images_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1621[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/common.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m#  Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m#  Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except [0m
[30;1m4 | [0m[35m#  with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m#  or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS[0m
[30;1m6 | [0m[35m#  OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governin[0m
[30;1m7 | [0m[35m#  limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1622[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m126 | [0m[35m            type=Iso8601Arg(),[0m
[30;1m127 | [0m[35m            help=([0m
[30;1m128 | [0m[35m                "End time of interval of interest for log events. ISO 8601 format: YYYY-MM-DDThh:mm:[0m
[30;1m129 | [0m[35m                "(e.g. 1984-09-15T19:20:30Z), time elements might be omitted. Defaults to current ti[0m
[30;1m130 | [0m[35m            ),[0m
[30;1m131 | [0m[35m        )[0m
[30;1m132 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1623[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35m            "--end-time",[0m
[30;1m126 | [0m[35m            type=Iso8601Arg(),[0m
[30;1m127 | [0m[35m            help=([0m
[30;1m128 | [0m[35m                "End time of interval of interest for log events. ISO 8601 format: YYYY-MM-DDThh:mm:[0m
[30;1m129 | [0m[35m                "(e.g. 1984-09-15T19:20:30Z), time elements might be omitted. Defaults to current ti[0m
[30;1m130 | [0m[35m            ),[0m
[30;1m131 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1624[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m118 | [0m[35m            type=Iso8601Arg(),[0m
[30;1m119 | [0m[35m            help=([0m
[30;1m120 | [0m[35m                "Start time of interval of interest for log events. ISO 8601 format: YYYY-MM-DDThh:m[0m
[30;1m121 | [0m[35m                "(e.g. 1984-09-15T19:20:30Z), time elements might be omitted. Defaults to creation t[0m
[30;1m122 | [0m[35m            ),[0m
[30;1m123 | [0m[35m        )[0m
[30;1m124 | [0m[35m        parser.add_argument([0m

[31m--[ [0m[34mMatch #[0m[33m1625[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m            "--start-time",[0m
[30;1m118 | [0m[35m            type=Iso8601Arg(),[0m
[30;1m119 | [0m[35m            help=([0m
[30;1m120 | [0m[35m                "Start time of interval of interest for log events. ISO 8601 format: YYYY-MM-DDThh:m[0m
[30;1m121 | [0m[35m                "(e.g. 1984-09-15T19:20:30Z), time elements might be omitted. Defaults to creation t[0m
[30;1m122 | [0m[35m            ),[0m
[30;1m123 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m1626[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m            return to_utc_datetime(value)[0m
[30;1m89 | [0m[35m        except Exception as e:[0m
[30;1m90 | [0m[35m            raise ArgumentTypeError([0m
[30;1m91 | [0m[35m                "Start time and end time filters must be in the ISO 8601 UTC format: YYYY-MM-DDThh:m[0m
[30;1m92 | [0m[35m                f"(e.g. 1984-09-15T19:20:30Z or 1984-09-15). {e}"[0m
[30;1m93 | [0m[35m            )[0m
[30;1m94 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1627[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m88 | [0m[35m            return to_utc_datetime(value)[0m
[30;1m89 | [0m[35m        except Exception as e:[0m
[30;1m90 | [0m[35m            raise ArgumentTypeError([0m
[30;1m91 | [0m[35m                "Start time and end time filters must be in the ISO 8601 UTC format: YYYY-MM-DDThh:m[0m
[30;1m92 | [0m[35m                f"(e.g. 1984-09-15T19:20:30Z or 1984-09-15). {e}"[0m
[30;1m93 | [0m[35m            )[0m
[30;1m94 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1628[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/ssh.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m62 | [0m[35m            # This check is disabled for the following reasons:[0m
[30;1m63 | [0m[35m            # - The args passed to the remote command are sanitized.[0m
[30;1m64 | [0m[35m            # - The default command to which these args is known.[0m
[30;1m65 | [0m[35m            # - Users have full control over any customization of the command to which args are pass[0m
[30;1m66 | [0m[35m            os.system(cmd)  # nosec B605 nosemgrep[0m
[30;1m67 | [0m[35m        else:[0m
[30;1m68 | [0m[35m            print(json.dumps({"command": cmd}, indent=2))[0m

[31m--[ [0m[34mMatch #[0m[33m1629[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/ssh.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m49 | [0m[35m        utils.error(f"Unable to connect to the cluster {args.cluster_name}.\n{e}")[0m
[30;1m50 | [0m[35m    else:[0m
[30;1m51 | [0m[35m        # build command[0m
[30;1m52 | [0m[35m        cmd = "ssh {CFN_USER}@{HEAD_NODE_IP} {ARGS}".format([0m
[30;1m53 | [0m[35m            CFN_USER=head_node.default_user,[0m
[30;1m54 | [0m[35m            HEAD_NODE_IP=head_node.public_ip or head_node.private_ip,[0m
[30;1m55 | [0m[35m            ARGS=" ".join(cmd_quote(str(arg)) for arg in extra_args),[0m

[31m--[ [0m[34mMatch #[0m[33m1630[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/ssh.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2013-2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1631[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35mReturns an ssh command with the cluster username and IP address pre-populated:[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m  ssh ec2-user@1.1.1.1 -i ~/.ssh/id_rsa"""[0m
[30;1m89 | [0m[35m    )[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    def __init__(self, subparsers):[0m

[31m--[ [0m[34mMatch #[0m[33m1632[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m  pcluster ssh --cluster-name mycluster -i ~/.ssh/id_rsa[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35mReturns an ssh command with the cluster username and IP address pre-populated:[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m  ssh ec2-user@1.1.1.1 -i ~/.ssh/id_rsa"""[0m
[30;1m89 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1633[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m  pcluster ssh --cluster-name mycluster -i ~/.ssh/id_rsa[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35mReturns an ssh command with the cluster username and IP address pre-populated:[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m  ssh ec2-user@1.1.1.1 -i ~/.ssh/id_rsa"""[0m
[30;1m89 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1634[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m    epilog = textwrap.dedent([0m
[30;1m82 | [0m[35m        """Example:[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m  pcluster ssh --cluster-name mycluster -i ~/.ssh/id_rsa[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35mReturns an ssh command with the cluster username and IP address pre-populated:[0m
[30;1m87 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1635[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m76 | [0m[35m    help = "Connects to the head node instance using SSH."[0m
[30;1m77 | [0m[35m    description = ([0m
[30;1m78 | [0m[35m        "Run ssh command with the cluster username and IP address pre-populated. "[0m
[30;1m79 | [0m[35m        "Arbitrary arguments are appended to the end of the ssh command."[0m
[30;1m80 | [0m[35m    )[0m
[30;1m81 | [0m[35m    epilog = textwrap.dedent([0m
[30;1m82 | [0m[35m        """Example:[0m

[31m--[ [0m[34mMatch #[0m[33m1636[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m75 | [0m[35m    name = "ssh"[0m
[30;1m76 | [0m[35m    help = "Connects to the head node instance using SSH."[0m
[30;1m77 | [0m[35m    description = ([0m
[30;1m78 | [0m[35m        "Run ssh command with the cluster username and IP address pre-populated. "[0m
[30;1m79 | [0m[35m        "Arbitrary arguments are appended to the end of the ssh command."[0m
[30;1m80 | [0m[35m    )[0m
[30;1m81 | [0m[35m    epilog = textwrap.dedent([0m

[31m--[ [0m[34mMatch #[0m[33m1637[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m75 | [0m[35m    name = "ssh"[0m
[30;1m76 | [0m[35m    help = "Connects to the head node instance using SSH."[0m
[30;1m77 | [0m[35m    description = ([0m
[30;1m78 | [0m[35m        "Run ssh command with the cluster username and IP address pre-populated. "[0m
[30;1m79 | [0m[35m        "Arbitrary arguments are appended to the end of the ssh command."[0m
[30;1m80 | [0m[35m    )[0m
[30;1m81 | [0m[35m    epilog = textwrap.dedent([0m

[31m--[ [0m[34mMatch #[0m[33m1638[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m    # CLI[0m
[30;1m75 | [0m[35m    name = "ssh"[0m
[30;1m76 | [0m[35m    help = "Connects to the head node instance using SSH."[0m
[30;1m77 | [0m[35m    description = ([0m
[30;1m78 | [0m[35m        "Run ssh command with the cluster username and IP address pre-populated. "[0m
[30;1m79 | [0m[35m        "Arbitrary arguments are appended to the end of the ssh command."[0m

[31m--[ [0m[34mMatch #[0m[33m1639[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35mclass SshCommand(CliCommand):[0m
[30;1m72 | [0m[35m    """Implement pcluster ssh command."""[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m    # CLI[0m
[30;1m75 | [0m[35m    name = "ssh"[0m

[31m--[ [0m[34mMatch #[0m[33m1640[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35mdef _ssh(args, extra_args):[0m
[30;1m34 | [0m[35m    # pylint: disable=import-outside-toplevel[0m
[30;1m35 | [0m[35m    """[0m
[30;1m36 | [0m[35m    Execute an SSH command to the head node instance, according to the [aliases] section if there.[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    :param args: pcluster CLI args[0m
[30;1m39 | [0m[35m    :param extra_args: pcluster CLI extra_args[0m

[31m--[ [0m[34mMatch #[0m[33m1641[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/ssh.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35mdef _ssh(args, extra_args):[0m
[30;1m34 | [0m[35m    # pylint: disable=import-outside-toplevel[0m
[30;1m35 | [0m[35m    """[0m
[30;1m36 | [0m[35m    Execute an SSH command to the head node instance, according to the [aliases] section if there.[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    :param args: pcluster CLI args[0m
[30;1m39 | [0m[35m    :param extra_args: pcluster CLI extra_args[0m

[31m--[ [0m[34mMatch #[0m[33m1642[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/update_compute_fleet_request_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1643[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/update_cluster_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m123 | [0m[35m    def change_set(self, change_set):[0m
[30;1m124 | [0m[35m        """Sets the change_set of this UpdateClusterResponseContent.[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m        List of configuration changes requested by the update operation.[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m        :param change_set: The change_set of this UpdateClusterResponseContent.[0m
[30;1m129 | [0m[35m        :type change_set: List[Change][0m

[31m--[ [0m[34mMatch #[0m[33m1644[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/update_cluster_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m112 | [0m[35m    def change_set(self):[0m
[30;1m113 | [0m[35m        """Gets the change_set of this UpdateClusterResponseContent.[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m        List of configuration changes requested by the update operation.[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m        :return: The change_set of this UpdateClusterResponseContent.[0m
[30;1m118 | [0m[35m        :rtype: List[Change][0m

[31m--[ [0m[34mMatch #[0m[33m1645[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/update_cluster_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1646[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/create_cluster_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1647[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/delete_cluster_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1648[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/scheduler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2022 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1649[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/internal_service_exception_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1650[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/util.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1651[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m215 | [0m[35m        else:[0m
[30;1m216 | [0m[35m            message = ([0m
[30;1m217 | [0m[35m                f"Unable to invoke Node.js for the installed version {node_version_string}. This ver[0m
[30;1m218 | [0m[35m                " compatible with this platform. Please use the Node Version Manager (nvm) to instal[0m
[30;1m219 | [0m[35m                " compatible version of Node.js compatible with this platform."[0m
[30;1m220 | [0m[35m            )[0m
[30;1m221 | [0m[35m        LOGGER.critical(message)[0m

[31m--[ [0m[34mMatch #[0m[33m1652[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m209 | [0m[35m        # `nvm current` will return `none` if no versions of Node.js are currently installed.[0m
[30;1m210 | [0m[35m        if node_version_string == "none":[0m
[30;1m211 | [0m[35m            message = ([0m
[30;1m212 | [0m[35m                "Node.js does not appear to be installed. Please use the Node Version Manager (nvm) [0m
[30;1m213 | [0m[35m                " version of Node.js compatible with this platform."[0m
[30;1m214 | [0m[35m            )[0m
[30;1m215 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m1653[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m195 | [0m[35med to the following line in order to disable the B607 and B603 checks.[0m
[30;1m196 | [0m[35m            # It is a false positive since the PATH search is wanted and the input of the check_outp[0m
[30;1m197 | [0m[35m            # [B607:start_process_with_partial_path] Is suppressed because location of executable is[0m
[30;1m198 | [0m[35m            #   PATH[0m
[30;1m199 | [0m[35m            # [B603:subprocess_without_shell_equals_true] Is suppressed because input of check_outpu[0m
[30;1m200 | [0m[35m            #   untrusted source[0m
[30;1m201 | [0m[35m            node_version_string = subprocess.check_output(  # nosec B607 B603[0m

[31m--[ [0m[34mMatch #[0m[33m1654[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m181 | [0m[35m    try:[0m
[30;1m182 | [0m[35m        # A nosec comment is appended to the following line in order to disable the B607 and B603 ch[0m
[30;1m183 | [0m[35m        # It is a false positive since the PATH search is wanted and the input of the check_output i[0m
[30;1m184 | [0m[35m        # [B607:start_process_with_partial_path] Is suppressed because location of executable is ret[0m
[30;1m185 | [0m[35m        #   PATH[0m
[30;1m186 | [0m[35m        # [B603:subprocess_without_shell_equals_true] Is suppressed because input of check_output is[0m
[30;1m187 | [0m[35m        #   untrusted source[0m
[30;1m188 | [0m[35m        node_version_string = subprocess.check_output(  # nosec B607 B603[0m

[31m--[ [0m[34mMatch #[0m[33m1655[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/util.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m170 | [0m[35m    LOGGER.debug("Found Node.js executable in %s", node_exe)[0m
[30;1m171 | [0m[35m    if not node_exe:[0m
[30;1m172 | [0m[35m        message = ([0m
[30;1m173 | [0m[35m            "Unable to find node executable. Node.js is required by the AWS CDK library used by Para[0m
[30;1m174 | [0m[35m            "see installation instructions here: https://docs.aws.amazon.com/parallelcluster/latest/[0m
[30;1m175 | [0m[35m        )[0m
[30;1m176 | [0m[35m        LOGGER.critical(message)[0m

[31m--[ [0m[34mMatch #[0m[33m1656[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/custom_resources/custom_resources_code/__init__.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1657[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/buildspec.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35m  post_build:[0m
[30;1m15 | [0m[35m    commands:[0m
[30;1m16 | [0m[35m      - if [ $CODEBUILD_BUILD_SUCCEEDING = 0 ]; then echo Build failed; exit 1; fi[0m
[30;1m17 | [0m[35m      - echo Pushing the Docker images...[0m
[30;1m18 | [0m[35m      - sh ./upload-docker-images.sh[0m

[31m--[ [0m[34mMatch #[0m[33m1658[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/buildspec.yml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35m  build:[0m
[30;1m9 | [0m[35m    commands:[0m
[30;1m10 | [0m[35m      - echo Build started on `date`[0m
[30;1m11 | [0m[35m      - echo Building the Docker images...[0m
[30;1m12 | [0m[35m      - sh ./build-docker-images.sh[0m
[30;1m13 | [0m[35m      - echo Build completed on `date`[0m
[30;1m14 | [0m[35m  post_build:[0m

[31m--[ [0m[34mMatch #[0m[33m1659[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/base_model_.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1660[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/update_cluster_bad_request_exception_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1661[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/instance_state.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1662[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/models/imagebuilder_resources.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1663[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m.hostname[0m
[30;1m25 | [0m[35m    python3 \[0m
[30;1m26 | [0m[35m    python3-pip \[0m
[30;1m27 | [0m[35m    which  \[0m
[30;1m28 | [0m[35m    hostname \[0m
[30;1m29 | [0m[35m    && yum clean all \[0m
[30;1m30 | [0m[35m    && rm -rf /var/cache/yum \[0m
[30;1m31 | [0m[35m    && mkdir /var/run/sshd \[0m

[31m--[ [0m[34mMatch #[0m[33m1664[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m11 | [0m[35m# Modify Amazon Linux yum repo configuration[0m
[30;1m12 | [0m[35mRUN /parallelcluster/bin/modify_yum_vars.sh "${AWS_REGION}"[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mRUN yum update -y \[0m
[30;1m15 | [0m[35m    && yum -y install \[0m
[30;1m16 | [0m[35m    aws-cli \[0m
[30;1m17 | [0m[35m    binutils \[0m

[31m--[ [0m[34mMatch #[0m[33m1665[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m# We can ignore this rule because we expect the entrypoint to be executed as root.[0m
[30;1m61 | [0m[35m# Furthermore, specifying USER root in front of ENTRYPOINT throws the below error:[0m
[30;1m62 | [0m[35m# "unable to find user root ENTRYPOINT [/parallelcluster/bin/entrypoint.sh]: no matching entries in [0m
[30;1m63 | [0m[35m# nosemgrep: dockerfile.security.missing-user-entrypoint.missing-user-entrypoint[0m
[30;1m64 | [0m[35mENTRYPOINT ["/parallelcluster/bin/entrypoint.sh"][0m

[31m--[ [0m[34mMatch #[0m[33m1666[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m# expose ssh port[0m
[30;1m58 | [0m[35mEXPOSE 22[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m# We can ignore this rule because we expect the entrypoint to be executed as root.[0m
[30;1m61 | [0m[35m# Furthermore, specifying USER root in front of ENTRYPOINT throws the below error:[0m
[30;1m62 | [0m[35m# "unable to find user root ENTRYPOINT [/parallelcluster/bin/entrypoint.sh]: no matching entries in [0m
[30;1m63 | [0m[35m# nosemgrep: dockerfile.security.missing-user-entrypoint.missing-user-entrypoint[0m

[31m--[ [0m[34mMatch #[0m[33m1667[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m# setup path[0m
[30;1m55 | [0m[35mENV PATH "/bin:/usr/bin:/sbin:/usr/sbin:/usr/local/bin:/usr/local/sbin:/usr/lib64/openmpi/bin/"[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m# expose ssh port[0m
[30;1m58 | [0m[35mEXPOSE 22[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m# We can ignore this rule because we expect the entrypoint to be executed as root.[0m

[31m--[ [0m[34mMatch #[0m[33m1668[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m    && chmod -R 600 ${SSHDIR}/*  \[0m
[30;1m52 | [0m[35m    && chown -R ${USER}:${USER} ${SSHDIR}/[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m# setup path[0m
[30;1m55 | [0m[35mENV PATH "/bin:/usr/bin:/sbin:/usr/sbin:/usr/local/bin:/usr/local/sbin:/usr/lib64/openmpi/bin/"[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m# expose ssh port[0m
[30;1m58 | [0m[35mEXPOSE 22[0m

[31m--[ [0m[34mMatch #[0m[33m1669[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m49 | [0m[35m    && echo "    IdentityFile ${SSHDIR}/id_rsa" >> /etc/ssh/ssh_config \[0m
[30;1m50 | [0m[35m    && echo "Host *" >> /etc/ssh/ssh_config && echo "    StrictHostKeyChecking no" >> /etc/ssh/ssh_c[0m
[30;1m51 | [0m[35m    && chmod -R 600 ${SSHDIR}/*  \[0m
[30;1m52 | [0m[35m    && chown -R ${USER}:${USER} ${SSHDIR}/[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m# setup path[0m
[30;1m55 | [0m[35mENV PATH "/bin:/usr/bin:/sbin:/usr/sbin:/usr/local/bin:/usr/local/sbin:/usr/lib64/openmpi/bin/"[0m

[31m--[ [0m[34mMatch #[0m[33m1670[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m    && cp ${SSHDIR}/ssh_host_rsa_key ${SSHDIR}/id_rsa \[0m
[30;1m49 | [0m[35m    && echo "    IdentityFile ${SSHDIR}/id_rsa" >> /etc/ssh/ssh_config \[0m
[30;1m50 | [0m[35m    && echo "Host *" >> /etc/ssh/ssh_config && echo "    StrictHostKeyChecking no" >> /etc/ssh/ssh_c[0m
[30;1m51 | [0m[35m    && chmod -R 600 ${SSHDIR}/*  \[0m
[30;1m52 | [0m[35m    && chown -R ${USER}:${USER} ${SSHDIR}/[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m# setup path[0m

[31m--[ [0m[34mMatch #[0m[33m1671[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m    && touch ${SSHDIR}/sshd_config \[0m
[30;1m46 | [0m[35m    && ssh-keygen -t rsa -f ${SSHDIR}/ssh_host_rsa_key -N '' \[0m
[30;1m47 | [0m[35m    && cp ${SSHDIR}/ssh_host_rsa_key.pub ${SSHDIR}/authorized_keys \[0m
[30;1m48 | [0m[35m    && cp ${SSHDIR}/ssh_host_rsa_key ${SSHDIR}/id_rsa \[0m
[30;1m49 | [0m[35m    && echo "    IdentityFile ${SSHDIR}/id_rsa" >> /etc/ssh/ssh_config \[0m
[30;1m50 | [0m[35m    && echo "Host *" >> /etc/ssh/ssh_config && echo "    StrictHostKeyChecking no" >> /etc/ssh/ssh_c[0m
[30;1m51 | [0m[35m    && chmod -R 600 ${SSHDIR}/*  \[0m

[31m--[ [0m[34mMatch #[0m[33m1672[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m    && mkdir -p ${SSHDIR} \[0m
[30;1m45 | [0m[35m    && touch ${SSHDIR}/sshd_config \[0m
[30;1m46 | [0m[35m    && ssh-keygen -t rsa -f ${SSHDIR}/ssh_host_rsa_key -N '' \[0m
[30;1m47 | [0m[35m    && cp ${SSHDIR}/ssh_host_rsa_key.pub ${SSHDIR}/authorized_keys \[0m
[30;1m48 | [0m[35m    && cp ${SSHDIR}/ssh_host_rsa_key ${SSHDIR}/id_rsa \[0m
[30;1m49 | [0m[35m    && echo "    IdentityFile ${SSHDIR}/id_rsa" >> /etc/ssh/ssh_config \[0m
[30;1m50 | [0m[35m    && echo "Host *" >> /etc/ssh/ssh_config && echo "    StrictHostKeyChecking no" >> /etc/ssh/ssh_c[0m

[31m--[ [0m[34mMatch #[0m[33m1673[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m    && sed 's@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d[0m
[30;1m39 | [0m[35m    && echo "export VISIBLE=now" >> /etc/profile[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m# create ssh keys[0m
[30;1m42 | [0m[35mENV SSHDIR /root/.ssh[0m
[30;1m43 | [0m[35mRUN echo "${USER} ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers \[0m
[30;1m44 | [0m[35m    && mkdir -p ${SSHDIR} \[0m
[30;1m45 | [0m[35m    && touch ${SSHDIR}/sshd_config \[0m

[31m--[ [0m[34mMatch #[0m[33m1674[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m    && sed 's@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d[0m
[30;1m39 | [0m[35m    && echo "export VISIBLE=now" >> /etc/profile[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m# create ssh keys[0m
[30;1m42 | [0m[35mENV SSHDIR /root/.ssh[0m
[30;1m43 | [0m[35mRUN echo "${USER} ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers \[0m
[30;1m44 | [0m[35m    && mkdir -p ${SSHDIR} \[0m

[31m--[ [0m[34mMatch #[0m[33m1675[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m# Setup passwordless ssh[0m
[30;1m36 | [0m[35mENV NOTVISIBLE "in users profile"[0m
[30;1m37 | [0m[35mRUN sed -i 's/PermitRootLogin without-password/PermitRootLogin yes/' /etc/ssh/sshd_config \[0m
[30;1m38 | [0m[35m    && sed 's@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d[0m
[30;1m39 | [0m[35m    && echo "export VISIBLE=now" >> /etc/profile[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m# create ssh keys[0m

[31m--[ [0m[34mMatch #[0m[33m1676[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m# Setup passwordless ssh[0m
[30;1m36 | [0m[35mENV NOTVISIBLE "in users profile"[0m
[30;1m37 | [0m[35mRUN sed -i 's/PermitRootLogin without-password/PermitRootLogin yes/' /etc/ssh/sshd_config \[0m
[30;1m38 | [0m[35m    && sed 's@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d[0m
[30;1m39 | [0m[35m    && echo "export VISIBLE=now" >> /etc/profile[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1677[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35m    && mkdir -p /parallelcluster/bin \[0m
[30;1m33 | [0m[35m    && export DEBIAN_FRONTEND=noninteractive[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m# Setup passwordless ssh[0m
[30;1m36 | [0m[35mENV NOTVISIBLE "in users profile"[0m
[30;1m37 | [0m[35mRUN sed -i 's/PermitRootLogin without-password/PermitRootLogin yes/' /etc/ssh/sshd_config \[0m
[30;1m38 | [0m[35m    && sed 's@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d[0m
[30;1m39 | [0m[35m    && echo "export VISIBLE=now" >> /etc/profile[0m

[31m--[ [0m[34mMatch #[0m[33m1678[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35m    python3-pip \[0m
[30;1m27 | [0m[35m    which  \[0m
[30;1m28 | [0m[35m    hostname \[0m
[30;1m29 | [0m[35m    && yum clean all \[0m
[30;1m30 | [0m[35m    && rm -rf /var/cache/yum \[0m
[30;1m31 | [0m[35m    && mkdir /var/run/sshd \[0m
[30;1m32 | [0m[35m    && mkdir -p /parallelcluster/bin \[0m

[31m--[ [0m[34mMatch #[0m[33m1679[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35mRUN /parallelcluster/bin/modify_yum_vars.sh "${AWS_REGION}"[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mRUN yum update -y \[0m
[30;1m15 | [0m[35m    && yum -y install \[0m
[30;1m16 | [0m[35m    aws-cli \[0m
[30;1m17 | [0m[35m    binutils \[0m
[30;1m18 | [0m[35m    gcc \[0m

[31m--[ [0m[34mMatch #[0m[33m1680[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m# Modify Amazon Linux yum repo configuration[0m
[30;1m12 | [0m[35mRUN /parallelcluster/bin/modify_yum_vars.sh "${AWS_REGION}"[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mRUN yum update -y \[0m
[30;1m15 | [0m[35m    && yum -y install \[0m
[30;1m16 | [0m[35m    aws-cli \[0m
[30;1m17 | [0m[35m    binutils \[0m

[31m--[ [0m[34mMatch #[0m[33m1681[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mCOPY scripts/ /parallelcluster/bin/[0m
[30;1m9 | [0m[35mRUN chmod +x /parallelcluster/bin/*[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m# Modify Amazon Linux yum repo configuration[0m
[30;1m12 | [0m[35mRUN /parallelcluster/bin/modify_yum_vars.sh "${AWS_REGION}"[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mRUN yum update -y \[0m

[31m--[ [0m[34mMatch #[0m[33m1682[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m# Copy entrypoint and scripts[0m
[30;1m8 | [0m[35mCOPY scripts/ /parallelcluster/bin/[0m
[30;1m9 | [0m[35mRUN chmod +x /parallelcluster/bin/*[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m# Modify Amazon Linux yum repo configuration[0m
[30;1m12 | [0m[35mRUN /parallelcluster/bin/modify_yum_vars.sh "${AWS_REGION}"[0m

[31m--[ [0m[34mMatch #[0m[33m1683[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mFROM public.ecr.aws/amazonlinux/amazonlinux:2[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mENV USER root[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mARG AWS_REGION[0m
[30;1m6 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1684[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m.hostname[0m
[30;1m25 | [0m[35m    python3 \[0m
[30;1m26 | [0m[35m    python3-pip \[0m
[30;1m27 | [0m[35m    which  \[0m
[30;1m28 | [0m[35m    hostname \[0m
[30;1m29 | [0m[35m    && yum clean all \[0m
[30;1m30 | [0m[35m    && rm -rf /var/cache/yum \[0m
[30;1m31 | [0m[35m    && mkdir /var/run/sshd \[0m

[31m--[ [0m[34mMatch #[0m[33m1685[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m11 | [0m[35m# Modify Amazon Linux yum repo configuration[0m
[30;1m12 | [0m[35mRUN /parallelcluster/bin/modify_yum_vars.sh "${AWS_REGION}"[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mRUN yum update -y \[0m
[30;1m15 | [0m[35m    && yum -y install \[0m
[30;1m16 | [0m[35m    aws-cli \[0m
[30;1m17 | [0m[35m    binutils \[0m

[31m--[ [0m[34mMatch #[0m[33m1686[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m# We can ignore this rule because we expect the entrypoint to be executed as root.[0m
[30;1m61 | [0m[35m# Furthermore, specifying USER root in front of ENTRYPOINT throws the below error:[0m
[30;1m62 | [0m[35m# "unable to find user root ENTRYPOINT [/parallelcluster/bin/entrypoint.sh]: no matching entries in [0m
[30;1m63 | [0m[35m# nosemgrep: dockerfile.security.missing-user-entrypoint.missing-user-entrypoint[0m
[30;1m64 | [0m[35mENTRYPOINT ["/parallelcluster/bin/entrypoint.sh"][0m

[31m--[ [0m[34mMatch #[0m[33m1687[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m57 | [0m[35m# expose ssh port[0m
[30;1m58 | [0m[35mEXPOSE 22[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m# We can ignore this rule because we expect the entrypoint to be executed as root.[0m
[30;1m61 | [0m[35m# Furthermore, specifying USER root in front of ENTRYPOINT throws the below error:[0m
[30;1m62 | [0m[35m# "unable to find user root ENTRYPOINT [/parallelcluster/bin/entrypoint.sh]: no matching entries in [0m
[30;1m63 | [0m[35m# nosemgrep: dockerfile.security.missing-user-entrypoint.missing-user-entrypoint[0m

[31m--[ [0m[34mMatch #[0m[33m1688[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m# setup path[0m
[30;1m55 | [0m[35mENV PATH "/bin:/usr/bin:/sbin:/usr/sbin:/usr/local/bin:/usr/local/sbin:/usr/lib64/openmpi/bin/"[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m# expose ssh port[0m
[30;1m58 | [0m[35mEXPOSE 22[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m# We can ignore this rule because we expect the entrypoint to be executed as root.[0m

[31m--[ [0m[34mMatch #[0m[33m1689[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m    && chmod -R 600 ${SSHDIR}/*  \[0m
[30;1m52 | [0m[35m    && chown -R ${USER}:${USER} ${SSHDIR}/[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m# setup path[0m
[30;1m55 | [0m[35mENV PATH "/bin:/usr/bin:/sbin:/usr/sbin:/usr/local/bin:/usr/local/sbin:/usr/lib64/openmpi/bin/"[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m# expose ssh port[0m
[30;1m58 | [0m[35mEXPOSE 22[0m

[31m--[ [0m[34mMatch #[0m[33m1690[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m49 | [0m[35m    && echo "    IdentityFile ${SSHDIR}/id_rsa" >> /etc/ssh/ssh_config \[0m
[30;1m50 | [0m[35m    && echo "Host *" >> /etc/ssh/ssh_config && echo "    StrictHostKeyChecking no" >> /etc/ssh/ssh_c[0m
[30;1m51 | [0m[35m    && chmod -R 600 ${SSHDIR}/*  \[0m
[30;1m52 | [0m[35m    && chown -R ${USER}:${USER} ${SSHDIR}/[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m# setup path[0m
[30;1m55 | [0m[35mENV PATH "/bin:/usr/bin:/sbin:/usr/sbin:/usr/local/bin:/usr/local/sbin:/usr/lib64/openmpi/bin/"[0m

[31m--[ [0m[34mMatch #[0m[33m1691[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m    && cp ${SSHDIR}/ssh_host_rsa_key ${SSHDIR}/id_rsa \[0m
[30;1m49 | [0m[35m    && echo "    IdentityFile ${SSHDIR}/id_rsa" >> /etc/ssh/ssh_config \[0m
[30;1m50 | [0m[35m    && echo "Host *" >> /etc/ssh/ssh_config && echo "    StrictHostKeyChecking no" >> /etc/ssh/ssh_c[0m
[30;1m51 | [0m[35m    && chmod -R 600 ${SSHDIR}/*  \[0m
[30;1m52 | [0m[35m    && chown -R ${USER}:${USER} ${SSHDIR}/[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m# setup path[0m

[31m--[ [0m[34mMatch #[0m[33m1692[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m    && touch ${SSHDIR}/sshd_config \[0m
[30;1m46 | [0m[35m    && ssh-keygen -t rsa -f ${SSHDIR}/ssh_host_rsa_key -N '' \[0m
[30;1m47 | [0m[35m    && cp ${SSHDIR}/ssh_host_rsa_key.pub ${SSHDIR}/authorized_keys \[0m
[30;1m48 | [0m[35m    && cp ${SSHDIR}/ssh_host_rsa_key ${SSHDIR}/id_rsa \[0m
[30;1m49 | [0m[35m    && echo "    IdentityFile ${SSHDIR}/id_rsa" >> /etc/ssh/ssh_config \[0m
[30;1m50 | [0m[35m    && echo "Host *" >> /etc/ssh/ssh_config && echo "    StrictHostKeyChecking no" >> /etc/ssh/ssh_c[0m
[30;1m51 | [0m[35m    && chmod -R 600 ${SSHDIR}/*  \[0m

[31m--[ [0m[34mMatch #[0m[33m1693[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m    && mkdir -p ${SSHDIR} \[0m
[30;1m45 | [0m[35m    && touch ${SSHDIR}/sshd_config \[0m
[30;1m46 | [0m[35m    && ssh-keygen -t rsa -f ${SSHDIR}/ssh_host_rsa_key -N '' \[0m
[30;1m47 | [0m[35m    && cp ${SSHDIR}/ssh_host_rsa_key.pub ${SSHDIR}/authorized_keys \[0m
[30;1m48 | [0m[35m    && cp ${SSHDIR}/ssh_host_rsa_key ${SSHDIR}/id_rsa \[0m
[30;1m49 | [0m[35m    && echo "    IdentityFile ${SSHDIR}/id_rsa" >> /etc/ssh/ssh_config \[0m
[30;1m50 | [0m[35m    && echo "Host *" >> /etc/ssh/ssh_config && echo "    StrictHostKeyChecking no" >> /etc/ssh/ssh_c[0m

[31m--[ [0m[34mMatch #[0m[33m1694[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m    && sed 's@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d[0m
[30;1m39 | [0m[35m    && echo "export VISIBLE=now" >> /etc/profile[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m# create ssh keys[0m
[30;1m42 | [0m[35mENV SSHDIR /root/.ssh[0m
[30;1m43 | [0m[35mRUN echo "${USER} ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers \[0m
[30;1m44 | [0m[35m    && mkdir -p ${SSHDIR} \[0m
[30;1m45 | [0m[35m    && touch ${SSHDIR}/sshd_config \[0m

[31m--[ [0m[34mMatch #[0m[33m1695[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m    && sed 's@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d[0m
[30;1m39 | [0m[35m    && echo "export VISIBLE=now" >> /etc/profile[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m# create ssh keys[0m
[30;1m42 | [0m[35mENV SSHDIR /root/.ssh[0m
[30;1m43 | [0m[35mRUN echo "${USER} ALL=(ALL) NOPASSWD:ALL" >> /etc/sudoers \[0m
[30;1m44 | [0m[35m    && mkdir -p ${SSHDIR} \[0m

[31m--[ [0m[34mMatch #[0m[33m1696[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m# Setup passwordless ssh[0m
[30;1m36 | [0m[35mENV NOTVISIBLE "in users profile"[0m
[30;1m37 | [0m[35mRUN sed -i 's/PermitRootLogin without-password/PermitRootLogin yes/' /etc/ssh/sshd_config \[0m
[30;1m38 | [0m[35m    && sed 's@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d[0m
[30;1m39 | [0m[35m    && echo "export VISIBLE=now" >> /etc/profile[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m# create ssh keys[0m

[31m--[ [0m[34mMatch #[0m[33m1697[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m# Setup passwordless ssh[0m
[30;1m36 | [0m[35mENV NOTVISIBLE "in users profile"[0m
[30;1m37 | [0m[35mRUN sed -i 's/PermitRootLogin without-password/PermitRootLogin yes/' /etc/ssh/sshd_config \[0m
[30;1m38 | [0m[35m    && sed 's@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d[0m
[30;1m39 | [0m[35m    && echo "export VISIBLE=now" >> /etc/profile[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1698[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35m    && mkdir -p /parallelcluster/bin \[0m
[30;1m33 | [0m[35m    && export DEBIAN_FRONTEND=noninteractive[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m# Setup passwordless ssh[0m
[30;1m36 | [0m[35mENV NOTVISIBLE "in users profile"[0m
[30;1m37 | [0m[35mRUN sed -i 's/PermitRootLogin without-password/PermitRootLogin yes/' /etc/ssh/sshd_config \[0m
[30;1m38 | [0m[35m    && sed 's@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d[0m
[30;1m39 | [0m[35m    && echo "export VISIBLE=now" >> /etc/profile[0m

[31m--[ [0m[34mMatch #[0m[33m1699[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35m    python3-pip \[0m
[30;1m27 | [0m[35m    which  \[0m
[30;1m28 | [0m[35m    hostname \[0m
[30;1m29 | [0m[35m    && yum clean all \[0m
[30;1m30 | [0m[35m    && rm -rf /var/cache/yum \[0m
[30;1m31 | [0m[35m    && mkdir /var/run/sshd \[0m
[30;1m32 | [0m[35m    && mkdir -p /parallelcluster/bin \[0m

[31m--[ [0m[34mMatch #[0m[33m1700[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35mRUN /parallelcluster/bin/modify_yum_vars.sh "${AWS_REGION}"[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mRUN yum update -y \[0m
[30;1m15 | [0m[35m    && yum -y install \[0m
[30;1m16 | [0m[35m    aws-cli \[0m
[30;1m17 | [0m[35m    binutils \[0m
[30;1m18 | [0m[35m    gcc \[0m

[31m--[ [0m[34mMatch #[0m[33m1701[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m# Modify Amazon Linux yum repo configuration[0m
[30;1m12 | [0m[35mRUN /parallelcluster/bin/modify_yum_vars.sh "${AWS_REGION}"[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mRUN yum update -y \[0m
[30;1m15 | [0m[35m    && yum -y install \[0m
[30;1m16 | [0m[35m    aws-cli \[0m
[30;1m17 | [0m[35m    binutils \[0m

[31m--[ [0m[34mMatch #[0m[33m1702[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mCOPY scripts/ /parallelcluster/bin/[0m
[30;1m9 | [0m[35mRUN chmod +x /parallelcluster/bin/*[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m# Modify Amazon Linux yum repo configuration[0m
[30;1m12 | [0m[35mRUN /parallelcluster/bin/modify_yum_vars.sh "${AWS_REGION}"[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mRUN yum update -y \[0m

[31m--[ [0m[34mMatch #[0m[33m1703[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m# Copy entrypoint and scripts[0m
[30;1m8 | [0m[35mCOPY scripts/ /parallelcluster/bin/[0m
[30;1m9 | [0m[35mRUN chmod +x /parallelcluster/bin/*[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35m# Modify Amazon Linux yum repo configuration[0m
[30;1m12 | [0m[35mRUN /parallelcluster/bin/modify_yum_vars.sh "${AWS_REGION}"[0m

[31m--[ [0m[34mMatch #[0m[33m1704[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/batch/docker/alinux2023/Dockerfile[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mFROM public.ecr.aws/amazonlinux/amazonlinux:2023[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mENV USER root[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mARG AWS_REGION[0m
[30;1m6 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1705[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/image_build_status.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1706[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/describe_image_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1707[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/unauthorized_client_error_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1708[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/validation_level.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1709[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m338 | [0m[35m    update_strategy = ([0m
[30;1m339 | [0m[35m        patch.target_config.get("Scheduling")[0m
[30;1m340 | [0m[35m        .get("SlurmSettings", {})[0m
[30;1m341 | [0m[35m        .get("QueueUpdateStrategy", QueueUpdateStrategy.COMPUTE_FLEET_STOP.value)[0m
[30;1m342 | [0m[35m    )[0m
[30;1m343 | [0m[35m    return update_strategy == QueueUpdateStrategy.TERMINATE.value[0m
[30;1m344 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1710[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m337 | [0m[35m    # Return true if the update strategy is set to TERMINATE[0m
[30;1m338 | [0m[35m    update_strategy = ([0m
[30;1m339 | [0m[35m        patch.target_config.get("Scheduling")[0m
[30;1m340 | [0m[35m        .get("SlurmSettings", {})[0m
[30;1m341 | [0m[35m        .get("QueueUpdateStrategy", QueueUpdateStrategy.COMPUTE_FLEET_STOP.value)[0m
[30;1m342 | [0m[35m    )[0m
[30;1m343 | [0m[35m    return update_strategy == QueueUpdateStrategy.TERMINATE.value[0m

[31m--[ [0m[34mMatch #[0m[33m1711[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m336 | [0m[35mdef is_resize_update_strategy_terminate(patch):[0m
[30;1m337 | [0m[35m    # Return true if the update strategy is set to TERMINATE[0m
[30;1m338 | [0m[35m    update_strategy = ([0m
[30;1m339 | [0m[35m        patch.target_config.get("Scheduling")[0m
[30;1m340 | [0m[35m        .get("SlurmSettings", {})[0m
[30;1m341 | [0m[35m        .get("QueueUpdateStrategy", QueueUpdateStrategy.COMPUTE_FLEET_STOP.value)[0m
[30;1m342 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1712[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m328 | [0m[35m    return ([0m
[30;1m329 | [0m[35m        patch.target_config.get("Scheduling")[0m
[30;1m330 | [0m[35m        .get("SlurmSettings", {})[0m
[30;1m331 | [0m[35m        .get("QueueUpdateStrategy", QueueUpdateStrategy.COMPUTE_FLEET_STOP.value)[0m
[30;1m332 | [0m[35m        != QueueUpdateStrategy.COMPUTE_FLEET_STOP.value[0m
[30;1m333 | [0m[35m    )[0m
[30;1m334 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1713[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m327 | [0m[35mdef is_queue_update_strategy_set(patch):[0m
[30;1m328 | [0m[35m    return ([0m
[30;1m329 | [0m[35m        patch.target_config.get("Scheduling")[0m
[30;1m330 | [0m[35m        .get("SlurmSettings", {})[0m
[30;1m331 | [0m[35m        .get("QueueUpdateStrategy", QueueUpdateStrategy.COMPUTE_FLEET_STOP.value)[0m
[30;1m332 | [0m[35m        != QueueUpdateStrategy.COMPUTE_FLEET_STOP.value[0m
[30;1m333 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m1714[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35mdef is_queue_update_strategy_set(patch):[0m
[30;1m328 | [0m[35m    return ([0m
[30;1m329 | [0m[35m        patch.target_config.get("Scheduling")[0m
[30;1m330 | [0m[35m        .get("SlurmSettings", {})[0m
[30;1m331 | [0m[35m        .get("QueueUpdateStrategy", QueueUpdateStrategy.COMPUTE_FLEET_STOP.value)[0m
[30;1m332 | [0m[35m        != QueueUpdateStrategy.COMPUTE_FLEET_STOP.value[0m

[31m--[ [0m[34mMatch #[0m[33m1715[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m270 | [0m[35mdef is_home_change(change):[0m
[30;1m271 | [0m[35m    if change.key == "SharedStorage":[0m
[30;1m272 | [0m[35m        if (change.old_value and change.old_value.get("MountDir") in ["home", "/home"]) or ([0m
[30;1m273 | [0m[35m            change.new_value and change.new_value.get("MountDir") in ["home", "/home"][0m
[30;1m274 | [0m[35m        ):[0m
[30;1m275 | [0m[35m            return True[0m
[30;1m276 | [0m[35m    return False[0m

[31m--[ [0m[34mMatch #[0m[33m1716[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m269 | [0m[35m[0m
[30;1m270 | [0m[35mdef is_home_change(change):[0m
[30;1m271 | [0m[35m    if change.key == "SharedStorage":[0m
[30;1m272 | [0m[35m        if (change.old_value and change.old_value.get("MountDir") in ["home", "/home"]) or ([0m
[30;1m273 | [0m[35m            change.new_value and change.new_value.get("MountDir") in ["home", "/home"][0m
[30;1m274 | [0m[35m        ):[0m
[30;1m275 | [0m[35m            return True[0m

[31m--[ [0m[34mMatch #[0m[33m1717[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m215 | [0m[35mdef unchanged_managed_fsx_lustre_names(_, patch):[0m
[30;1m216 | [0m[35m    """Get list of managed Fsx for Lustre Shared Storage that hasn't changed between cluster configu[0m
[30;1m217 | [0m[35m    managed_fsx_names_before_update = {fsx.get("Name") for fsx in get_managed_fsx_from_config(patch.[0m
[30;1m218 | [0m[35m    managed_fsx_names_after_update = {fsx.get("Name") for fsx in get_managed_fsx_from_config(patch.t[0m
[30;1m219 | [0m[35m    return managed_fsx_names_before_update.intersection(managed_fsx_names_after_update)[0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1718[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35mdef unchanged_managed_fsx_lustre_names(_, patch):[0m
[30;1m216 | [0m[35m    """Get list of managed Fsx for Lustre Shared Storage that hasn't changed between cluster configu[0m
[30;1m217 | [0m[35m    managed_fsx_names_before_update = {fsx.get("Name") for fsx in get_managed_fsx_from_config(patch.[0m
[30;1m218 | [0m[35m    managed_fsx_names_after_update = {fsx.get("Name") for fsx in get_managed_fsx_from_config(patch.t[0m
[30;1m219 | [0m[35m    return managed_fsx_names_before_update.intersection(managed_fsx_names_after_update)[0m
[30;1m220 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1719[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m    managed_fsx_storage = [[0m
[30;1m208 | [0m[35m        storage[0m
[30;1m209 | [0m[35m        for storage in config.get("SharedStorage", [])[0m
[30;1m210 | [0m[35m        if storage.get("StorageType") == "FsxLustre" and "FileSystemId" not in storage.get("FsxLustr[0m
[30;1m211 | [0m[35m    ][0m
[30;1m212 | [0m[35m    return managed_fsx_storage[0m
[30;1m213 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1720[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m207 | [0m[35m    managed_fsx_storage = [[0m
[30;1m208 | [0m[35m        storage[0m
[30;1m209 | [0m[35m        for storage in config.get("SharedStorage", [])[0m
[30;1m210 | [0m[35m        if storage.get("StorageType") == "FsxLustre" and "FileSystemId" not in storage.get("FsxLustr[0m
[30;1m211 | [0m[35m    ][0m
[30;1m212 | [0m[35m    return managed_fsx_storage[0m
[30;1m213 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1721[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m206 | [0m[35m    """Extract managed Fsx for Lustre shared storage entries in a cluster configuration."""[0m
[30;1m207 | [0m[35m    managed_fsx_storage = [[0m
[30;1m208 | [0m[35m        storage[0m
[30;1m209 | [0m[35m        for storage in config.get("SharedStorage", [])[0m
[30;1m210 | [0m[35m        if storage.get("StorageType") == "FsxLustre" and "FileSystemId" not in storage.get("FsxLustr[0m
[30;1m211 | [0m[35m    ][0m
[30;1m212 | [0m[35m    return managed_fsx_storage[0m

[31m--[ [0m[34mMatch #[0m[33m1722[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m196 | [0m[35m    base_q_networking = get_q_from_config(change, patch.base_config).get("Networking", {})[0m
[30;1m197 | [0m[35m    base_cr_networking = get_cr_from_config(change, patch.base_config).get("Networking", {})[0m
[30;1m198 | [0m[35m    target_q_networking = get_q_from_config(change, patch.target_config).get("Networking", {})[0m
[30;1m199 | [0m[35m    target_cr_networking = get_cr_from_config(change, patch.target_config).get("Networking", {})[0m
[30;1m200 | [0m[35m    return is_placement_group_managed_for_compute_resource([0m
[30;1m201 | [0m[35m        base_q_networking, base_cr_networking[0m
[30;1m202 | [0m[35m    ) and not is_placement_group_managed_for_compute_resource(target_q_networking, target_cr_network[0m

[31m--[ [0m[34mMatch #[0m[33m1723[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m195 | [0m[35mdef is_managed_placement_group_deletion(change, patch):[0m
[30;1m196 | [0m[35m    base_q_networking = get_q_from_config(change, patch.base_config).get("Networking", {})[0m
[30;1m197 | [0m[35m    base_cr_networking = get_cr_from_config(change, patch.base_config).get("Networking", {})[0m
[30;1m198 | [0m[35m    target_q_networking = get_q_from_config(change, patch.target_config).get("Networking", {})[0m
[30;1m199 | [0m[35m    target_cr_networking = get_cr_from_config(change, patch.target_config).get("Networking", {})[0m
[30;1m200 | [0m[35m    return is_placement_group_managed_for_compute_resource([0m
[30;1m201 | [0m[35m        base_q_networking, base_cr_networking[0m

[31m--[ [0m[34mMatch #[0m[33m1724[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m194 | [0m[35m[0m
[30;1m195 | [0m[35mdef is_managed_placement_group_deletion(change, patch):[0m
[30;1m196 | [0m[35m    base_q_networking = get_q_from_config(change, patch.base_config).get("Networking", {})[0m
[30;1m197 | [0m[35m    base_cr_networking = get_cr_from_config(change, patch.base_config).get("Networking", {})[0m
[30;1m198 | [0m[35m    target_q_networking = get_q_from_config(change, patch.target_config).get("Networking", {})[0m
[30;1m199 | [0m[35m    target_cr_networking = get_cr_from_config(change, patch.target_config).get("Networking", {})[0m
[30;1m200 | [0m[35m    return is_placement_group_managed_for_compute_resource([0m

[31m--[ [0m[34mMatch #[0m[33m1725[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m[0m
[30;1m195 | [0m[35mdef is_managed_placement_group_deletion(change, patch):[0m
[30;1m196 | [0m[35m    base_q_networking = get_q_from_config(change, patch.base_config).get("Networking", {})[0m
[30;1m197 | [0m[35m    base_cr_networking = get_cr_from_config(change, patch.base_config).get("Networking", {})[0m
[30;1m198 | [0m[35m    target_q_networking = get_q_from_config(change, patch.target_config).get("Networking", {})[0m
[30;1m199 | [0m[35m    target_cr_networking = get_cr_from_config(change, patch.target_config).get("Networking", {})[0m

[31m--[ [0m[34mMatch #[0m[33m1726[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35mdef is_placement_group_managed_for_compute_resource(queue_networking, compute_resource_networking):[0m
[30;1m189 | [0m[35m    chosen_pg = compute_resource_networking.get("PlacementGroup") or queue_networking.get("Placement[0m
[30;1m190 | [0m[35m    if chosen_pg and chosen_pg.get("Enabled") and not (chosen_pg.get("Name") or chosen_pg.get("Id"))[0m
[30;1m191 | [0m[35m        return True[0m
[30;1m192 | [0m[35m    return False[0m
[30;1m193 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1727[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35mdef is_placement_group_managed_for_compute_resource(queue_networking, compute_resource_networking):[0m
[30;1m189 | [0m[35m    chosen_pg = compute_resource_networking.get("PlacementGroup") or queue_networking.get("Placement[0m
[30;1m190 | [0m[35m    if chosen_pg and chosen_pg.get("Enabled") and not (chosen_pg.get("Name") or chosen_pg.get("Id"))[0m
[30;1m191 | [0m[35m        return True[0m
[30;1m192 | [0m[35m    return False[0m
[30;1m193 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1728[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35mdef is_placement_group_managed_for_compute_resource(queue_networking, compute_resource_networking):[0m
[30;1m189 | [0m[35m    chosen_pg = compute_resource_networking.get("PlacementGroup") or queue_networking.get("Placement[0m
[30;1m190 | [0m[35m    if chosen_pg and chosen_pg.get("Enabled") and not (chosen_pg.get("Name") or chosen_pg.get("Id"))[0m
[30;1m191 | [0m[35m        return True[0m
[30;1m192 | [0m[35m    return False[0m
[30;1m193 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1729[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35mdef is_placement_group_managed_for_compute_resource(queue_networking, compute_resource_networking):[0m
[30;1m189 | [0m[35m    chosen_pg = compute_resource_networking.get("PlacementGroup") or queue_networking.get("Placement[0m
[30;1m190 | [0m[35m    if chosen_pg and chosen_pg.get("Enabled") and not (chosen_pg.get("Name") or chosen_pg.get("Id"))[0m
[30;1m191 | [0m[35m        return True[0m
[30;1m192 | [0m[35m    return False[0m

[31m--[ [0m[34mMatch #[0m[33m1730[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35mdef is_placement_group_managed_for_compute_resource(queue_networking, compute_resource_networking):[0m
[30;1m189 | [0m[35m    chosen_pg = compute_resource_networking.get("PlacementGroup") or queue_networking.get("Placement[0m
[30;1m190 | [0m[35m    if chosen_pg and chosen_pg.get("Enabled") and not (chosen_pg.get("Name") or chosen_pg.get("Id"))[0m
[30;1m191 | [0m[35m        return True[0m
[30;1m192 | [0m[35m    return False[0m

[31m--[ [0m[34mMatch #[0m[33m1731[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m180 | [0m[35m    if cr_type and cr_name:[0m
[30;1m181 | [0m[35m        queue = get_q_from_config(change, config)[0m
[30;1m182 | [0m[35m        for compute_resource in queue.get(cr_type, {}):[0m
[30;1m183 | [0m[35m            if compute_resource.get("Name", None) == cr_name:[0m
[30;1m184 | [0m[35m                return compute_resource[0m
[30;1m185 | [0m[35m    return {}[0m
[30;1m186 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1732[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m179 | [0m[35m            cr_type, cr_name = extract_type_and_name_from_path(path)[0m
[30;1m180 | [0m[35m    if cr_type and cr_name:[0m
[30;1m181 | [0m[35m        queue = get_q_from_config(change, config)[0m
[30;1m182 | [0m[35m        for compute_resource in queue.get(cr_type, {}):[0m
[30;1m183 | [0m[35m            if compute_resource.get("Name", None) == cr_name:[0m
[30;1m184 | [0m[35m                return compute_resource[0m
[30;1m185 | [0m[35m    return {}[0m

[31m--[ [0m[34mMatch #[0m[33m1733[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m165 | [0m[35m            q_type, q_name = extract_type_and_name_from_path(path)[0m
[30;1m166 | [0m[35m    if q_type and q_name:[0m
[30;1m167 | [0m[35m        for queue in config.get("Scheduling", {}).get(q_type, {}):[0m
[30;1m168 | [0m[35m            if queue.get("Name", None) == q_name:[0m
[30;1m169 | [0m[35m                return queue[0m
[30;1m170 | [0m[35m    return {}[0m
[30;1m171 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1734[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m        if re.search("Queues\\[", path):[0m
[30;1m165 | [0m[35m            q_type, q_name = extract_type_and_name_from_path(path)[0m
[30;1m166 | [0m[35m    if q_type and q_name:[0m
[30;1m167 | [0m[35m        for queue in config.get("Scheduling", {}).get(q_type, {}):[0m
[30;1m168 | [0m[35m            if queue.get("Name", None) == q_name:[0m
[30;1m169 | [0m[35m                return queue[0m
[30;1m170 | [0m[35m    return {}[0m

[31m--[ [0m[34mMatch #[0m[33m1735[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m        if re.search("Queues\\[", path):[0m
[30;1m165 | [0m[35m            q_type, q_name = extract_type_and_name_from_path(path)[0m
[30;1m166 | [0m[35m    if q_type and q_name:[0m
[30;1m167 | [0m[35m        for queue in config.get("Scheduling", {}).get(q_type, {}):[0m
[30;1m168 | [0m[35m            if queue.get("Name", None) == q_name:[0m
[30;1m169 | [0m[35m                return queue[0m
[30;1m170 | [0m[35m    return {}[0m

[31m--[ [0m[34mMatch #[0m[33m1736[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m718 | [0m[35m    action_needed=UpdatePolicy.ACTIONS_NEEDED["login_nodes_stop"],[0m
[30;1m719 | [0m[35m)[0m
[30;1m720 | [0m[35m[0m
[30;1m721 | [0m[35m# Update supported only with all computre and login nodes down[0m
[30;1m722 | [0m[35mUpdatePolicy.COMPUTE_AND_LOGIN_NODES_STOP = UpdatePolicy([0m
[30;1m723 | [0m[35m    name="COMPUTE_AND_LOGIN_NODES_STOP",[0m
[30;1m724 | [0m[35m    level=10,[0m

[31m--[ [0m[34mMatch #[0m[33m1737[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m709 | [0m[35m    action_needed=UpdatePolicy.ACTIONS_NEEDED["login_nodes_stop"],[0m
[30;1m710 | [0m[35m)[0m
[30;1m711 | [0m[35m[0m
[30;1m712 | [0m[35m# Update supported only with all login nodes in the pool down[0m
[30;1m713 | [0m[35mUpdatePolicy.LOGIN_NODES_POOL_STOP = UpdatePolicy([0m
[30;1m714 | [0m[35m    name="LOGIN_NODES_POOL_STOP",[0m
[30;1m715 | [0m[35m    level=10,[0m

[31m--[ [0m[34mMatch #[0m[33m1738[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m700 | [0m[35m    action_needed=UpdatePolicy.ACTIONS_NEEDED["login_nodes_stop"],[0m
[30;1m701 | [0m[35m)[0m
[30;1m702 | [0m[35m[0m
[30;1m703 | [0m[35m# Update supported only with all login nodes in the cluster down[0m
[30;1m704 | [0m[35mUpdatePolicy.LOGIN_NODES_STOP = UpdatePolicy([0m
[30;1m705 | [0m[35m    name="LOGIN_NODES_STOP",[0m
[30;1m706 | [0m[35m    level=10,[0m

[31m--[ [0m[34mMatch #[0m[33m1739[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m691 | [0m[35m    condition_checker=condition_checker_managed_fsx,[0m
[30;1m692 | [0m[35m)[0m
[30;1m693 | [0m[35m[0m
[30;1m694 | [0m[35m# Update policy for adding or removing a login node pool[0m
[30;1m695 | [0m[35mUpdatePolicy.LOGIN_NODES_POOLS = UpdatePolicy([0m
[30;1m696 | [0m[35m    name="LOGIN_NODES_POOLS_UPDATE_POLICY",[0m
[30;1m697 | [0m[35m    level=6,[0m

[31m--[ [0m[34mMatch #[0m[33m1740[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m682 | [0m[35m    + ". If you need this change, please consider creating a new cluster instead of updating the exi[0m
[30;1m683 | [0m[35m)[0m
[30;1m684 | [0m[35m[0m
[30;1m685 | [0m[35m# Block update if cluster has a managed Fsx for Lustre FileSystem, otherwise fallback to QueueUpdate[0m
[30;1m686 | [0m[35mUpdatePolicy.MANAGED_FSX = UpdatePolicy([0m
[30;1m687 | [0m[35m    name="MANAGED_FSX",[0m
[30;1m688 | [0m[35m    level=6,[0m

[31m--[ [0m[34mMatch #[0m[33m1741[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m669 | [0m[35m    action_needed="Restore the previous parameter value for the unsupported changes.",[0m
[30;1m670 | [0m[35m)[0m
[30;1m671 | [0m[35m[0m
[30;1m672 | [0m[35m# Update not supported[0m
[30;1m673 | [0m[35mUpdatePolicy.UNSUPPORTED = UpdatePolicy([0m
[30;1m674 | [0m[35m    name="UNSUPPORTED",[0m
[30;1m675 | [0m[35m    level=1000,[0m

[31m--[ [0m[34mMatch #[0m[33m1742[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m660 | [0m[35m[0m
[30;1m661 | [0m[35m# Update effects are unknown.[0m
[30;1m662 | [0m[35m# WARNING: This is the default value for all new configuration parameters. All parameters must be li[0m
[30;1m663 | [0m[35m# update policy instead of UNKNOWN to pass unit tests.[0m
[30;1m664 | [0m[35m#[0m
[30;1m665 | [0m[35mUpdatePolicy.UNKNOWN = UpdatePolicy([0m
[30;1m666 | [0m[35m    name="UNKNOWN",[0m

[31m--[ [0m[34mMatch #[0m[33m1743[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m658 | [0m[35m    print_succeeded=False,[0m
[30;1m659 | [0m[35m)[0m
[30;1m660 | [0m[35m[0m
[30;1m661 | [0m[35m# Update effects are unknown.[0m
[30;1m662 | [0m[35m# WARNING: This is the default value for all new configuration parameters. All parameters must be li[0m
[30;1m663 | [0m[35m# update policy instead of UNKNOWN to pass unit tests.[0m
[30;1m664 | [0m[35m#[0m

[31m--[ [0m[34mMatch #[0m[33m1744[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m643 | [0m[35m)[0m
[30;1m644 | [0m[35m[0m
[30;1m645 | [0m[35m# Expected Behavior:[0m
[30;1m646 | [0m[35m# No bucket specified when create, no bucket specified when update: Display no diff, proceed with up[0m
[30;1m647 | [0m[35m# For all other cases: Display diff and block, value will not be updated even if forced[0m
[30;1m648 | [0m[35mUpdatePolicy.READ_ONLY_RESOURCE_BUCKET = UpdatePolicy([0m
[30;1m649 | [0m[35m    name="READ_ONLY_RESOURCE_BUCKET",[0m
[30;1m650 | [0m[35m    level=30,[0m

[31m--[ [0m[34mMatch #[0m[33m1745[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m637 | [0m[35mUpdatePolicy.HEAD_NODE_STOP = UpdatePolicy([0m
[30;1m638 | [0m[35m    name="HEAD_NODE_STOP",[0m
[30;1m639 | [0m[35m    level=20,[0m
[30;1m640 | [0m[35m    fail_reason="To perform this update action, the head node must be in a stopped state",[0m
[30;1m641 | [0m[35m    action_needed=UpdatePolicy.ACTIONS_NEEDED["pcluster_stop"],[0m
[30;1m642 | [0m[35m    condition_checker=lambda change, patch: patch.cluster.head_node_instance.state == "stopped",[0m
[30;1m643 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m1746[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m633 | [0m[35m    condition_checker=lambda change, patch: not patch.cluster.has_running_capacity(),[0m
[30;1m634 | [0m[35m)[0m
[30;1m635 | [0m[35m[0m
[30;1m636 | [0m[35m# Update supported only with head node down[0m
[30;1m637 | [0m[35mUpdatePolicy.HEAD_NODE_STOP = UpdatePolicy([0m
[30;1m638 | [0m[35m    name="HEAD_NODE_STOP",[0m
[30;1m639 | [0m[35m    level=20,[0m

[31m--[ [0m[34mMatch #[0m[33m1747[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m624 | [0m[35m    condition_checker=condition_checker_compute_fleet_stop_on_remove,[0m
[30;1m625 | [0m[35m)[0m
[30;1m626 | [0m[35m[0m
[30;1m627 | [0m[35m# Update supported only with all compute nodes down[0m
[30;1m628 | [0m[35mUpdatePolicy.COMPUTE_FLEET_STOP = UpdatePolicy([0m
[30;1m629 | [0m[35m    name="COMPUTE_FLEET_STOP",[0m
[30;1m630 | [0m[35m    level=10,[0m

[31m--[ [0m[34mMatch #[0m[33m1748[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m615 | [0m[35m    condition_checker=condition_checker_shared_storage_update_policy,[0m
[30;1m616 | [0m[35m)[0m
[30;1m617 | [0m[35m[0m
[30;1m618 | [0m[35m# Update supported on new addition or on removal only with all compute nodes down[0m
[30;1m619 | [0m[35mUpdatePolicy.COMPUTE_FLEET_STOP_ON_REMOVE = UpdatePolicy([0m
[30;1m620 | [0m[35m    name="COMPUTE_FLEET_STOP_ON_REMOVE",[0m
[30;1m621 | [0m[35m    level=7,[0m

[31m--[ [0m[34mMatch #[0m[33m1749[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m606 | [0m[35m    condition_checker=condition_checker_managed_placement_group,[0m
[30;1m607 | [0m[35m)[0m
[30;1m608 | [0m[35m[0m
[30;1m609 | [0m[35m# Update policy for updating SharedStorage[0m
[30;1m610 | [0m[35mUpdatePolicy.SHARED_STORAGE_UPDATE_POLICY = UpdatePolicy([0m
[30;1m611 | [0m[35m    name="SHARED_STORAGE_UPDATE_POLICY",[0m
[30;1m612 | [0m[35m    level=6 if not is_awsbatch_scheduler else 1000,[0m

[31m--[ [0m[34mMatch #[0m[33m1750[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m588 | [0m[35m    condition_checker=condition_checker_queue_update_strategy,[0m
[30;1m589 | [0m[35m)[0m
[30;1m590 | [0m[35m[0m
[30;1m591 | [0m[35m# Update supported with fleet stopped or with replacement policy set to TERMINATE[0m
[30;1m592 | [0m[35mUpdatePolicy.RESIZE_UPDATE_STRATEGY_ON_REMOVE = UpdatePolicy([0m
[30;1m593 | [0m[35m    name="RESIZE_UPDATE_STRATEGY_ON_REMOVE",[0m
[30;1m594 | [0m[35m    level=5,[0m

[31m--[ [0m[34mMatch #[0m[33m1751[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m579 | [0m[35m    <= patch.target_config["Scheduling"]["AwsBatchQueues"][0]["ComputeResources"][0]["MaxvCpus"],[0m
[30;1m580 | [0m[35m)[0m
[30;1m581 | [0m[35m[0m
[30;1m582 | [0m[35m# Update supported only with all compute nodes down or with replacement policy set different from CO[0m
[30;1m583 | [0m[35mUpdatePolicy.QUEUE_UPDATE_STRATEGY = UpdatePolicy([0m
[30;1m584 | [0m[35m    name="QUEUE_UPDATE_STRATEGY",[0m
[30;1m585 | [0m[35m    level=5,[0m

[31m--[ [0m[34mMatch #[0m[33m1752[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m562 | [0m[35m    print_succeeded=False,[0m
[30;1m563 | [0m[35m)[0m
[30;1m564 | [0m[35m[0m
[30;1m565 | [0m[35m# Update supported[0m
[30;1m566 | [0m[35mUpdatePolicy.SUPPORTED = UpdatePolicy([0m
[30;1m567 | [0m[35m    name="SUPPORTED", level=0, fail_reason="-", condition_checker=(lambda change, patch: True)[0m
[30;1m568 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m1753[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m552 | [0m[35m[0m
[30;1m553 | [0m[35m# Base policies[0m
[30;1m554 | [0m[35m[0m
[30;1m555 | [0m[35m# Update is ignored[0m
[30;1m556 | [0m[35mUpdatePolicy.IGNORED = UpdatePolicy([0m
[30;1m557 | [0m[35m    name="IGNORED",[0m
[30;1m558 | [0m[35m    level=-10,[0m

[31m--[ [0m[34mMatch #[0m[33m1754[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m546 | [0m[35m    ),[0m
[30;1m547 | [0m[35m    "login_nodes_stop": lambda change, patch: ([0m
[30;1m548 | [0m[35m        "Stop the login nodes by setting Count parameter to 0 "[0m
[30;1m549 | [0m[35m        "and update the cluster with the pcluster update-cluster command"[0m
[30;1m550 | [0m[35m    ),[0m
[30;1m551 | [0m[35m}[0m
[30;1m552 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1755[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m530 | [0m[35m[0m
[30;1m531 | [0m[35m# Common action_needed messages[0m
[30;1m532 | [0m[35mUpdatePolicy.ACTIONS_NEEDED = {[0m
[30;1m533 | [0m[35m    "ebs_volume_update": "Follow the instructions at {0}#{1} to modify your volume from AWS Console.[0m
[30;1m534 | [0m[35m        "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/requesting-ebs-volume-modifications.htm[0m
[30;1m535 | [0m[35m        "modify-ebs-volume",[0m
[30;1m536 | [0m[35m    ),[0m

[31m--[ [0m[34mMatch #[0m[33m1756[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m524 | [0m[35m        f"The update is not supported when login nodes in {get_pool_name_from_change_paths(change)} [0m
[30;1m525 | [0m[35m    ),[0m
[30;1m526 | [0m[35m    "compute_or_login_nodes_running": lambda change, patch: ([0m
[30;1m527 | [0m[35m        "The update is not supported when compute or login nodes are running"[0m
[30;1m528 | [0m[35m    ),[0m
[30;1m529 | [0m[35m}[0m
[30;1m530 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1757[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m521 | [0m[35m    ),[0m
[30;1m522 | [0m[35m    "login_nodes_running": lambda change, patch: "The update is not supported when login nodes are r[0m
[30;1m523 | [0m[35m    "login_nodes_pool_running": lambda change, patch: ([0m
[30;1m524 | [0m[35m        f"The update is not supported when login nodes in {get_pool_name_from_change_paths(change)} [0m
[30;1m525 | [0m[35m    ),[0m
[30;1m526 | [0m[35m    "compute_or_login_nodes_running": lambda change, patch: ([0m
[30;1m527 | [0m[35m        "The update is not supported when compute or login nodes are running"[0m

[31m--[ [0m[34mMatch #[0m[33m1758[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m519 | [0m[35m        "applies updates to compute nodes. If you still want to proceed, first stop the compute flee[0m
[30;1m520 | [0m[35m        "pcluster update-compute-fleet command and then run an update with the --force-update flag"[0m
[30;1m521 | [0m[35m    ),[0m
[30;1m522 | [0m[35m    "login_nodes_running": lambda change, patch: "The update is not supported when login nodes are r[0m
[30;1m523 | [0m[35m    "login_nodes_pool_running": lambda change, patch: ([0m
[30;1m524 | [0m[35m        f"The update is not supported when login nodes in {get_pool_name_from_change_paths(change)} [0m
[30;1m525 | [0m[35m    ),[0m

[31m--[ [0m[34mMatch #[0m[33m1759[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m517 | [0m[35m    "cookbook_update": lambda change, patch: ([0m
[30;1m518 | [0m[35m        "Updating cookbook related parameter is not supported because it only "[0m
[30;1m519 | [0m[35m        "applies updates to compute nodes. If you still want to proceed, first stop the compute flee[0m
[30;1m520 | [0m[35m        "pcluster update-compute-fleet command and then run an update with the --force-update flag"[0m
[30;1m521 | [0m[35m    ),[0m
[30;1m522 | [0m[35m    "login_nodes_running": lambda change, patch: "The update is not supported when login nodes are r[0m
[30;1m523 | [0m[35m    "login_nodes_pool_running": lambda change, patch: ([0m

[31m--[ [0m[34mMatch #[0m[33m1760[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m499 | [0m[35m[0m
[30;1m500 | [0m[35mdef get_pool_name_from_change_paths(change):[0m
[30;1m501 | [0m[35m    """[0m
[30;1m502 | [0m[35m    Return the name of the pool in which update was requested.[0m
[30;1m503 | [0m[35m[0m
[30;1m504 | [0m[35m    Example path=['LoginNodes', 'Pools[pool2]', 'Ssh'].[0m
[30;1m505 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1761[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m492 | [0m[35m[0m
[30;1m493 | [0m[35m[0m
[30;1m494 | [0m[35mdef condition_checker_login_nodes_pool_stop_policy(change, patch):[0m
[30;1m495 | [0m[35m    """Check if login nodes are running in the pool in which update was requested."""[0m
[30;1m496 | [0m[35m    pool_name = get_pool_name_from_change_paths(change)[0m
[30;1m497 | [0m[35m    return not patch.cluster.has_running_login_nodes(pool_name=pool_name)[0m
[30;1m498 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1762[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m459 | [0m[35m    Check different requirements for different schedulers.[0m
[30;1m460 | [0m[35m[0m
[30;1m461 | [0m[35m    Compute and login fleet stop is required for plugin scheduler.[0m
[30;1m462 | [0m[35m    Update for awsbatch scheduler is not supported.[0m
[30;1m463 | [0m[35m    QueueUpdateStrategy can override UpdatePolicy of parameters under SlurmQueues for slurm schedule[0m
[30;1m464 | [0m[35m    """[0m
[30;1m465 | [0m[35m    if is_home_change(change):[0m

[31m--[ [0m[34mMatch #[0m[33m1763[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m396 | [0m[35m    result = not patch.cluster.has_running_capacity()[0m
[30;1m397 | [0m[35m    # Update of list element value is possible if one of the following is verified:[0m
[30;1m398 | [0m[35m    # - fleet is stopped[0m
[30;1m399 | [0m[35m    # - queue update strategy is set (different from default)[0m
[30;1m400 | [0m[35m    # - new list element is added[0m
[30;1m401 | [0m[35m    if is_slurm_queues_change(change):[0m
[30;1m402 | [0m[35m        result = ([0m

[31m--[ [0m[34mMatch #[0m[33m1764[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m394 | [0m[35m[0m
[30;1m395 | [0m[35mdef condition_checker_queue_update_strategy_on_remove(change, patch):[0m
[30;1m396 | [0m[35m    result = not patch.cluster.has_running_capacity()[0m
[30;1m397 | [0m[35m    # Update of list element value is possible if one of the following is verified:[0m
[30;1m398 | [0m[35m    # - fleet is stopped[0m
[30;1m399 | [0m[35m    # - queue update strategy is set (different from default)[0m
[30;1m400 | [0m[35m    # - new list element is added[0m

[31m--[ [0m[34mMatch #[0m[33m1765[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m371 | [0m[35m            change.old_value, DEFAULT_MAX_COUNT[0m
[30;1m372 | [0m[35m        )[0m
[30;1m373 | [0m[35m[0m
[30;1m374 | [0m[35m    # Check if MinCount is increased and MaxCount is increased of at least the same amount[0m
[30;1m375 | [0m[35m    if not result and change.key == "MinCount":[0m
[30;1m376 | [0m[35m        path = change.path[0m
[30;1m377 | [0m[35m        for other_change in patch.changes:[0m

[31m--[ [0m[34mMatch #[0m[33m1766[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m334 | [0m[35m[0m
[30;1m335 | [0m[35m[0m
[30;1m336 | [0m[35mdef is_resize_update_strategy_terminate(patch):[0m
[30;1m337 | [0m[35m    # Return true if the update strategy is set to TERMINATE[0m
[30;1m338 | [0m[35m    update_strategy = ([0m
[30;1m339 | [0m[35m        patch.target_config.get("Scheduling")[0m
[30;1m340 | [0m[35m        .get("SlurmSettings", {})[0m

[31m--[ [0m[34mMatch #[0m[33m1767[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m317 | [0m[35m    if managed_fsx_lustre_names:[0m
[30;1m318 | [0m[35m        reason = ([0m
[30;1m319 | [0m[35m            f"{change.key} configuration cannot be updated when a managed FSx for Lustre file system[0m
[30;1m320 | [0m[35m            "Forcing an update would trigger a deletion of the existing file system and result in po[0m
[30;1m321 | [0m[35m        )[0m
[30;1m322 | [0m[35m    else:[0m
[30;1m323 | [0m[35m        reason = fail_reason_queue_update_strategy(change, patch)[0m

[31m--[ [0m[34mMatch #[0m[33m1768[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m258 | [0m[35m    Check if the live update of the running compute fleet is supported for the given change to Share[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m    We are referring here to a live update, that does not require the replacement of compute nodes.[0m
[30;1m261 | [0m[35m    In particular, the live update is supported only in the following cases:[0m
[30;1m262 | [0m[35m      1. mount/unmount of external EFS[0m
[30;1m263 | [0m[35m      1. mount/unmount of external FSx[0m
[30;1m264 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1769[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35mdef is_compute_fleet_update_supported_for_shared_storage(change):[0m
[30;1m257 | [0m[35m    """[0m
[30;1m258 | [0m[35m    Check if the live update of the running compute fleet is supported for the given change to Share[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m    We are referring here to a live update, that does not require the replacement of compute nodes.[0m
[30;1m261 | [0m[35m    In particular, the live update is supported only in the following cases:[0m

[31m--[ [0m[34mMatch #[0m[33m1770[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m244 | [0m[35m    Check if the live update of the running login fleet is supported for the given change to SharedS[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m    We are referring here to a live update, that does not require the replacement of login nodes.[0m
[30;1m247 | [0m[35m    In particular, the live update is supported only in the following cases:[0m
[30;1m248 | [0m[35m      1. mount/unmount of external EFS[0m
[30;1m249 | [0m[35m      1. mount/unmount of external FSx[0m
[30;1m250 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m1771[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35mdef is_login_fleet_update_supported_for_shared_storage(change):[0m
[30;1m243 | [0m[35m    """[0m
[30;1m244 | [0m[35m    Check if the live update of the running login fleet is supported for the given change to SharedS[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m    We are referring here to a live update, that does not require the replacement of login nodes.[0m
[30;1m247 | [0m[35m    In particular, the live update is supported only in the following cases:[0m

[31m--[ [0m[34mMatch #[0m[33m1772[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m    def check(self, change, patch):[0m
[30;1m71 | [0m[35m        """[0m
[30;1m72 | [0m[35m        Check if the update can be safely performed.[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m        Based on the policy condition checker, the result can be FAILED, SUCCEEDED or ACTION_NEEDED.[0m
[30;1m75 | [0m[35m        :param change: The change to check[0m

[31m--[ [0m[34mMatch #[0m[33m1773[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mclass UpdatePolicy:[0m
[30;1m26 | [0m[35m    """Describes the policy that rules the update of a configuration parameter."""[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    class CheckResult(str, Enum):[0m
[30;1m29 | [0m[35m        """Valid results for change checks."""[0m

[31m--[ [0m[34mMatch #[0m[33m1774[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1775[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m691 | [0m[35m    condition_checker=condition_checker_managed_fsx,[0m
[30;1m692 | [0m[35m)[0m
[30;1m693 | [0m[35m[0m
[30;1m694 | [0m[35m# Update policy for adding or removing a login node pool[0m
[30;1m695 | [0m[35mUpdatePolicy.LOGIN_NODES_POOLS = UpdatePolicy([0m
[30;1m696 | [0m[35m    name="LOGIN_NODES_POOLS_UPDATE_POLICY",[0m
[30;1m697 | [0m[35m    level=6,[0m

[31m--[ [0m[34mMatch #[0m[33m1776[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m644 | [0m[35m[0m
[30;1m645 | [0m[35m# Expected Behavior:[0m
[30;1m646 | [0m[35m# No bucket specified when create, no bucket specified when update: Display no diff, proceed with up[0m
[30;1m647 | [0m[35m# For all other cases: Display diff and block, value will not be updated even if forced[0m
[30;1m648 | [0m[35mUpdatePolicy.READ_ONLY_RESOURCE_BUCKET = UpdatePolicy([0m
[30;1m649 | [0m[35m    name="READ_ONLY_RESOURCE_BUCKET",[0m
[30;1m650 | [0m[35m    level=30,[0m

[31m--[ [0m[34mMatch #[0m[33m1777[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m637 | [0m[35mUpdatePolicy.HEAD_NODE_STOP = UpdatePolicy([0m
[30;1m638 | [0m[35m    name="HEAD_NODE_STOP",[0m
[30;1m639 | [0m[35m    level=20,[0m
[30;1m640 | [0m[35m    fail_reason="To perform this update action, the head node must be in a stopped state",[0m
[30;1m641 | [0m[35m    action_needed=UpdatePolicy.ACTIONS_NEEDED["pcluster_stop"],[0m
[30;1m642 | [0m[35m    condition_checker=lambda change, patch: patch.cluster.head_node_instance.state == "stopped",[0m
[30;1m643 | [0m[35m)[0m

[31m--[ [0m[34mMatch #[0m[33m1778[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/config/update_policy.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m633 | [0m[35m    condition_checker=lambda change, patch: not patch.cluster.has_running_capacity(),[0m
[30;1m634 | [0m[35m)[0m
[30;1m635 | [0m[35m[0m
[30;1m636 | [0m[35m# Update supported only with head node down[0m
[30;1m637 | [0m[35mUpdatePolicy.HEAD_NODE_STOP = UpdatePolicy([0m
[30;1m638 | [0m[35m    name="HEAD_NODE_STOP",[0m
[30;1m639 | [0m[35m    level=20,[0m

[31m--[ [0m[34mMatch #[0m[33m1779[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_util.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m18 | [0m[35m        "x86_64": [os for os in SUPPORTED_OSES if os not in UNSUPPORTED_OSES_FOR_DCV],[0m
[30;1m19 | [0m[35m        "arm64": [os for os in SUPPORTED_OSES if os not in UNSUPPORTED_OSES_FOR_DCV + UNSUPPORTED_AR[0m
[30;1m20 | [0m[35m    }[0m
[30;1m21 | [0m[35m    return architectures_dict.get(architecture, [])[0m

[31m--[ [0m[34mMatch #[0m[33m1780[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_util.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1781[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m117 | [0m[35m    try:[0m
[30;1m118 | [0m[35m        LOGGER.debug("SSH command: %s", ssh_cmd)[0m
[30;1m119 | [0m[35m        output = _check_command_output(ssh_cmd)[0m
[30;1m120 | [0m[35m        # At first ssh connection, the ssh command alerts it is adding the host to the known hosts l[0m
[30;1m121 | [0m[35m        if re.search("Permanently added .* to the list of known hosts.", output):[0m
[30;1m122 | [0m[35m            output = _check_command_output(ssh_cmd)[0m
[30;1m123 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1782[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m83 | [0m[35m    else:[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m        # Prepare ssh command to execute in the node instance[0m
[30;1m86 | [0m[35m        cmd = 'ssh {CFN_USER}@{NODE_IP} {KEY} "{REMOTE_COMMAND} /home/{CFN_USER}"'.format([0m
[30;1m87 | [0m[35m            CFN_USER=default_user,[0m
[30;1m88 | [0m[35m            NODE_IP=node_ip,[0m
[30;1m89 | [0m[35m            KEY="-i {0}".format(args.key_path) if args.key_path else "",[0m

[31m--[ [0m[34mMatch #[0m[33m1783[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2019 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1784[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m190 | [0m[35m        parser.add_argument("-n", "--cluster-name", help="Name of the cluster to connect to", requir[0m
[30;1m191 | [0m[35m        parser.add_argument("--key-path", dest="key_path", help="Key path of the SSH key to use for [0m
[30;1m192 | [0m[35m        parser.add_argument("--show-url", action="store_true", default=False, help="Print URL and ex[0m
[30;1m193 | [0m[35m        parser.add_argument("--login-node-ip", dest="login_node_ip", help="IP address of a login nod[0m
[30;1m194 | [0m[35m[0m
[30;1m195 | [0m[35m    def execute(self, args: Namespace, extra_args: List[str]) -> None:  # noqa: D102  #pylint: disab[0m
[30;1m196 | [0m[35m        _dcv_connect(args)[0m

[31m--[ [0m[34mMatch #[0m[33m1785[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m    def register_command_args(self, parser: ArgumentParser) -> None:  # noqa: D102[0m
[30;1m190 | [0m[35m        parser.add_argument("-n", "--cluster-name", help="Name of the cluster to connect to", requir[0m
[30;1m191 | [0m[35m        parser.add_argument("--key-path", dest="key_path", help="Key path of the SSH key to use for [0m
[30;1m192 | [0m[35m        parser.add_argument("--show-url", action="store_true", default=False, help="Print URL and ex[0m
[30;1m193 | [0m[35m        parser.add_argument("--login-node-ip", dest="login_node_ip", help="IP address of a login nod[0m
[30;1m194 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1786[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35m    # CLI[0m
[30;1m182 | [0m[35m    name = "dcv-connect"[0m
[30;1m183 | [0m[35m    help = "Permits connection to the head or login nodes through an interactive session by using Am[0m
[30;1m184 | [0m[35m    description = help[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m    def __init__(self, subparsers):[0m

[31m--[ [0m[34mMatch #[0m[33m1787[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m132 | [0m[35m            error([0m
[30;1m133 | [0m[35m                "Something went wrong during DCV connection. Please manually execute the command:\n{[0m
[30;1m134 | [0m[35m                "If the problem persists, please check the logs in the /var/log/parallelcluster/ fol[0m
[30;1m135 | [0m[35m                "of the node and submit an issue {1}".format(ssh_cmd, PCLUSTER_ISSUES_LINK)[0m
[30;1m136 | [0m[35m            )[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m    except sub.CalledProcessError as e:[0m

[31m--[ [0m[34mMatch #[0m[33m1788[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m    try:[0m
[30;1m118 | [0m[35m        LOGGER.debug("SSH command: %s", ssh_cmd)[0m
[30;1m119 | [0m[35m        output = _check_command_output(ssh_cmd)[0m
[30;1m120 | [0m[35m        # At first ssh connection, the ssh command alerts it is adding the host to the known hosts l[0m
[30;1m121 | [0m[35m        if re.search("Permanently added .* to the list of known hosts.", output):[0m
[30;1m122 | [0m[35m            output = _check_command_output(ssh_cmd)[0m
[30;1m123 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1789[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m    try:[0m
[30;1m118 | [0m[35m        LOGGER.debug("SSH command: %s", ssh_cmd)[0m
[30;1m119 | [0m[35m        output = _check_command_output(ssh_cmd)[0m
[30;1m120 | [0m[35m        # At first ssh connection, the ssh command alerts it is adding the host to the known hosts l[0m
[30;1m121 | [0m[35m        if re.search("Permanently added .* to the list of known hosts.", output):[0m
[30;1m122 | [0m[35m            output = _check_command_output(ssh_cmd)[0m
[30;1m123 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1790[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35mdef _retrieve_dcv_session_url(ssh_cmd, cluster_name, node_ip):[0m
[30;1m116 | [0m[35m    """Connect by ssh to the head or login node instance, prepare DCV session and return the DCV ses[0m
[30;1m117 | [0m[35m    try:[0m
[30;1m118 | [0m[35m        LOGGER.debug("SSH command: %s", ssh_cmd)[0m
[30;1m119 | [0m[35m        output = _check_command_output(ssh_cmd)[0m

[31m--[ [0m[34mMatch #[0m[33m1791[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35mdef _retrieve_dcv_session_url(ssh_cmd, cluster_name, node_ip):[0m
[30;1m116 | [0m[35m    """Connect by ssh to the head or login node instance, prepare DCV session and return the DCV ses[0m
[30;1m117 | [0m[35m    try:[0m
[30;1m118 | [0m[35m        LOGGER.debug("SSH command: %s", ssh_cmd)[0m
[30;1m119 | [0m[35m        output = _check_command_output(ssh_cmd)[0m

[31m--[ [0m[34mMatch #[0m[33m1792[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35mdef _retrieve_dcv_session_url(ssh_cmd, cluster_name, node_ip):[0m
[30;1m116 | [0m[35m    """Connect by ssh to the head or login node instance, prepare DCV session and return the DCV ses[0m
[30;1m117 | [0m[35m    try:[0m
[30;1m118 | [0m[35m        LOGGER.debug("SSH command: %s", ssh_cmd)[0m
[30;1m119 | [0m[35m        output = _check_command_output(ssh_cmd)[0m

[31m--[ [0m[34mMatch #[0m[33m1793[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m108 | [0m[35m            error([0m
[30;1m109 | [0m[35m                "Something went wrong during DCV connection.\n{0}"[0m
[30;1m110 | [0m[35m                "Please check the logs in the /var/log/parallelcluster/ folder "[0m
[30;1m111 | [0m[35m                "of the node and submit an issue {1}\n".format(e, PCLUSTER_ISSUES_LINK)[0m
[30;1m112 | [0m[35m            )[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1794[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m82 | [0m[35m        error(f"Unable to connect to the cluster.\n{e}")[0m
[30;1m83 | [0m[35m    else:[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m        # Prepare ssh command to execute in the node instance[0m
[30;1m86 | [0m[35m        cmd = 'ssh {CFN_USER}@{NODE_IP} {KEY} "{REMOTE_COMMAND} /home/{CFN_USER}"'.format([0m
[30;1m87 | [0m[35m            CFN_USER=default_user,[0m
[30;1m88 | [0m[35m            NODE_IP=node_ip,[0m

[31m--[ [0m[34mMatch #[0m[33m1795[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m82 | [0m[35m        error(f"Unable to connect to the cluster.\n{e}")[0m
[30;1m83 | [0m[35m    else:[0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m        # Prepare ssh command to execute in the node instance[0m
[30;1m86 | [0m[35m        cmd = 'ssh {CFN_USER}@{NODE_IP} {KEY} "{REMOTE_COMMAND} /home/{CFN_USER}"'.format([0m
[30;1m87 | [0m[35m            CFN_USER=default_user,[0m
[30;1m88 | [0m[35m            NODE_IP=node_ip,[0m

[31m--[ [0m[34mMatch #[0m[33m1796[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m        login_node_ips.update([node.public_ip, node.private_ip])[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    if ip not in login_node_ips:[0m
[30;1m57 | [0m[35m        error(f"{ip} is not an IP address of a login node.")[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35mdef _dcv_connect(args):[0m

[31m--[ [0m[34mMatch #[0m[33m1797[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m53 | [0m[35m    for node in login_nodes:[0m
[30;1m54 | [0m[35m        login_node_ips.update([node.public_ip, node.private_ip])[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    if ip not in login_node_ips:[0m
[30;1m57 | [0m[35m        error(f"{ip} is not an IP address of a login node.")[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1798[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    login_node_ips = set()[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m    for node in login_nodes:[0m
[30;1m54 | [0m[35m        login_node_ips.update([node.public_ip, node.private_ip])[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m    if ip not in login_node_ips:[0m

[31m--[ [0m[34mMatch #[0m[33m1799[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35mdef _validate_login_node_ip_arg(ip, login_nodes):[0m
[30;1m47 | [0m[35m    """Check if ip is a valid IPv4 address and belongs to a login node."""[0m
[30;1m48 | [0m[35m    if not re.match(IPV4_REGEX, ip):[0m
[30;1m49 | [0m[35m        error(f"{ip} is not a valid IPv4 address.")[0m
[30;1m50 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1800[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/cli/commands/dcv_connect.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m14 | [0m[35m# A nosec comment is appended to the following line in order to disable the B404 check.[0m
[30;1m15 | [0m[35m# In this file the input of the module subprocess is trusted.[0m
[30;1m16 | [0m[35mimport subprocess as sub  # nosec B404[0m
[30;1m17 | [0m[35mimport time[0m
[30;1m18 | [0m[35mimport webbrowser[0m
[30;1m19 | [0m[35mfrom typing import List[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mfrom argparse import ArgumentParser, Namespace[0m

[31m--[ [0m[34mMatch #[0m[33m1801[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/describe_cluster_instances_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1802[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/change.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1803[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/conflict_exception_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1804[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/build_image_request_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1805[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/bad_request_exception_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1806[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/common.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1807[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35mdef get_arn_service_and_resource(arn: str):[0m
[30;1m157 | [0m[35m    arn_components = get_arn_components(arn)[0m
[30;1m158 | [0m[35m    service = arn_components[2][0m
[30;1m159 | [0m[35m    resource = arn_components[5][0m
[30;1m160 | [0m[35m    return service, resource[0m
[30;1m161 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1808[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m121 | [0m[35m        def _async_timed_validate(original_method):[0m
[30;1m122 | [0m[35m            @functools.wraps(original_method)[0m
[30;1m123 | [0m[35m            async def _validate_async(self: AsyncValidator, *args, **kwargs):[0m
[30;1m124 | [0m[35m                timeout = kwargs.pop("timeout", ASYNC_TIMED_VALIDATORS_DEFAULT_TIMEOUT_SEC)[0m
[30;1m125 | [0m[35m                try:[0m
[30;1m126 | [0m[35m                    await asyncio.wait_for(original_method(self, *args, **kwargs), timeout=timeout)[0m
[30;1m127 | [0m[35m                except asyncio.TimeoutError:[0m

[31m--[ [0m[34mMatch #[0m[33m1809[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m110 | [0m[35m    If not provided will default to ASYNC_TIMED_VALIDATORS_DEFAULT_TIMEOUT_SEC.[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m    Since validators async execution is coroutine based with preemptive multitasking,[0m
[30;1m113 | [0m[35m    the effective time to fail the validator for timeout may exceed the requested one.[0m
[30;1m114 | [0m[35m    """[0m
[30;1m115 | [0m[35m    class_name = f"AsyncTimed{validator_type.__name__}"[0m
[30;1m116 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1810[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m110 | [0m[35m    If not provided will default to ASYNC_TIMED_VALIDATORS_DEFAULT_TIMEOUT_SEC.[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m    Since validators async execution is coroutine based with preemptive multitasking,[0m
[30;1m113 | [0m[35m    the effective time to fail the validator for timeout may exceed the requested one.[0m
[30;1m114 | [0m[35m    """[0m
[30;1m115 | [0m[35m    class_name = f"AsyncTimed{validator_type.__name__}"[0m
[30;1m116 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1811[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m106 | [0m[35m    """[0m
[30;1m107 | [0m[35m    Return the type decorating the given validator with timeout support.[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m    The enriched _validate_async will accept an additional timeout parameter.[0m
[30;1m110 | [0m[35m    If not provided will default to ASYNC_TIMED_VALIDATORS_DEFAULT_TIMEOUT_SEC.[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m    Since validators async execution is coroutine based with preemptive multitasking,[0m

[31m--[ [0m[34mMatch #[0m[33m1812[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/common.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35mdef get_async_timed_validator_type_for(validator_type: type) -> AsyncValidator:[0m
[30;1m106 | [0m[35m    """[0m
[30;1m107 | [0m[35m    Return the type decorating the given validator with timeout support.[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m    The enriched _validate_async will accept an additional timeout parameter.[0m
[30;1m110 | [0m[35m    If not provided will default to ASYNC_TIMED_VALIDATORS_DEFAULT_TIMEOUT_SEC.[0m

[31m--[ [0m[34mMatch #[0m[33m1813[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/custom_script.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m58 | [0m[35m              if {{ build.TempScript.outputs.stdout }} ; then[0m
[30;1m59 | [0m[35m                echo 'Script executed successfully' [0m
[30;1m60 | [0m[35m              else[0m
[30;1m61 | [0m[35m                echo 'ERROR - Script execution failure. Exit code != 0'[0m
[30;1m62 | [0m[35m                exit {{ build.Fail.outputs.stdout }}[0m
[30;1m63 | [0m[35m              fi[0m

[31m--[ [0m[34mMatch #[0m[33m1814[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/custom_script.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m              set -v[0m
[30;1m49 | [0m[35m              chmod +x {{ build.TempScript.outputs.stdout }} || (echo 'Unable to set script executab[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m      # Execute script[0m
[30;1m52 | [0m[35m      - name: Execute[0m
[30;1m53 | [0m[35m        action: ExecuteBash[0m
[30;1m54 | [0m[35m        inputs:[0m
[30;1m55 | [0m[35m          commands:[0m

[31m--[ [0m[34mMatch #[0m[33m1815[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/custom_script.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m          commands:[0m
[30;1m47 | [0m[35m            - |[0m
[30;1m48 | [0m[35m              set -v[0m
[30;1m49 | [0m[35m              chmod +x {{ build.TempScript.outputs.stdout }} || (echo 'Unable to set script executab[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m      # Execute script[0m
[30;1m52 | [0m[35m      - name: Execute[0m

[31m--[ [0m[34mMatch #[0m[33m1816[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/custom_script.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m          commands:[0m
[30;1m47 | [0m[35m            - |[0m
[30;1m48 | [0m[35m              set -v[0m
[30;1m49 | [0m[35m              chmod +x {{ build.TempScript.outputs.stdout }} || (echo 'Unable to set script executab[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m      # Execute script[0m
[30;1m52 | [0m[35m      - name: Execute[0m

[31m--[ [0m[34mMatch #[0m[33m1817[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/custom_script.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m                exit {{ build.Fail.outputs.stdout }}[0m
[30;1m40 | [0m[35m              fi[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m      # Make script executable[0m
[30;1m43 | [0m[35m      - name: Executable[0m
[30;1m44 | [0m[35m        action: ExecuteBash[0m
[30;1m45 | [0m[35m        inputs:[0m

[31m--[ [0m[34mMatch #[0m[33m1818[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/custom_script.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m              elif [[ {{ build.ScriptUrlScheme.outputs.stdout }} == "s3" ]]; then[0m
[30;1m36 | [0m[35m                aws s3 cp {{ build.ScriptUrl.outputs.stdout }} {{ build.TempScript.outputs.stdout }}[0m
[30;1m37 | [0m[35m              else[0m
[30;1m38 | [0m[35m                echo "Invalid script url"[0m
[30;1m39 | [0m[35m                exit {{ build.Fail.outputs.stdout }}[0m
[30;1m40 | [0m[35m              fi[0m
[30;1m41 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1819[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/custom_script.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35m              if [[ {{ build.ScriptUrlScheme.outputs.stdout }} == "https" ]]; then[0m
[30;1m34 | [0m[35m                curl --retry 3 -L -o {{ build.TempScript.outputs.stdout }} {{ build.ScriptUrl.output[0m
[30;1m35 | [0m[35m              elif [[ {{ build.ScriptUrlScheme.outputs.stdout }} == "s3" ]]; then[0m
[30;1m36 | [0m[35m                aws s3 cp {{ build.ScriptUrl.outputs.stdout }} {{ build.TempScript.outputs.stdout }}[0m
[30;1m37 | [0m[35m              else[0m
[30;1m38 | [0m[35m                echo "Invalid script url"[0m
[30;1m39 | [0m[35m                exit {{ build.Fail.outputs.stdout }}[0m

[31m--[ [0m[34mMatch #[0m[33m1820[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/custom_script.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m            - |[0m
[30;1m32 | [0m[35m              set -v[0m
[30;1m33 | [0m[35m              if [[ {{ build.ScriptUrlScheme.outputs.stdout }} == "https" ]]; then[0m
[30;1m34 | [0m[35m                curl --retry 3 -L -o {{ build.TempScript.outputs.stdout }} {{ build.ScriptUrl.output[0m
[30;1m35 | [0m[35m              elif [[ {{ build.ScriptUrlScheme.outputs.stdout }} == "s3" ]]; then[0m
[30;1m36 | [0m[35m                aws s3 cp {{ build.ScriptUrl.outputs.stdout }} {{ build.TempScript.outputs.stdout }}[0m
[30;1m37 | [0m[35m              else[0m

[31m--[ [0m[34mMatch #[0m[33m1821[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/custom_script.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m              temp_file=$(mktemp -p /tmp/parallelcluster/)[0m
[30;1m24 | [0m[35m              echo "$temp_file"[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m      # Download script[0m
[30;1m27 | [0m[35m      - name: Download[0m
[30;1m28 | [0m[35m        action: ExecuteBash[0m
[30;1m29 | [0m[35m        inputs:[0m
[30;1m30 | [0m[35m          commands:[0m

[31m--[ [0m[34mMatch #[0m[33m1822[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m273 | [0m[35m                  yum install -y ${!PACKAGE} --releasever ${!RELEASE_VERSION}[0m
[30;1m274 | [0m[35m                  if [ $? -ne 0 ]; then[0m
[30;1m275 | [0m[35m                    yum install -y wget[0m
[30;1m276 | [0m[35m                    # Previous releases are moved into a vault area once a new minor release version[0m
[30;1m277 | [0m[35m                    # https://wiki.rockylinux.org/rocky/repo/#notes-on-devel[0m
[30;1m278 | [0m[35m                    wget https://dl.rockylinux.org/vault/rocky/${!RELEASE_VERSION}/BaseOS/$(uname -m[0m
[30;1m279 | [0m[35m                    yum install -y ./${!PACKAGE}.rpm[0m

[31m--[ [0m[34mMatch #[0m[33m1823[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m238 | [0m[35m                fi[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m              elif [[ ${!PLATFORM} == DEBIAN ]]; then[0m
[30;1m241 | [0m[35m                DEBIAN_FRONTEND=noninteractive apt-get -y update[0m
[30;1m242 | [0m[35m                if [[ ${!DISABLE_KERNEL_UPDATE} == true ]]; then[0m
[30;1m243 | [0m[35m                  DEBIAN_FRONTEND=noninteractive apt-get -y -o Dpkg::Options::="--force-confdef" -o [0m
[30;1m244 | [0m[35m                else[0m
[30;1m245 | [0m[35m                  DEBIAN_FRONTEND=noninteractive apt-get -y -o Dpkg::Options::="--force-confdef" -o [0m

[31m--[ [0m[34mMatch #[0m[33m1824[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m228 | [0m[35m              DISABLE_KERNEL_UPDATE='{{ build.DisableKernelUpdate.outputs.stdout }}'[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m              if [[ ${!PLATFORM} == RHEL ]]; then[0m
[30;1m231 | [0m[35m                yum -y update[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m                if [[ ${!OS} == "rhel8" ]] || [[ ${!OS} == "rocky8" ]] || [[ ${!OS} == "rhel9" ]] ||[0m
[30;1m234 | [0m[35m                  # package-cleanup has changed in RHEL8 and it works differently https://access.red[0m
[30;1m235 | [0m[35m                  yum remove -y $(yum repoquery --installonly --latest-limit=-2 -q)[0m

[31m--[ [0m[34mMatch #[0m[33m1825[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m129 | [0m[35m                # disable unattended upgrades[0m
[30;1m130 | [0m[35m                sed "/Update-Package-Lists/s/\"1\"/\"0\"/; /Unattended-Upgrade/s/\"1\"/\"0\"/;" /etc[0m
[30;1m131 | [0m[35m                # update package index[0m
[30;1m132 | [0m[35m                DEBIAN_FRONTEND=noninteractive apt-get -y update[0m
[30;1m133 | [0m[35m              fi[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m      - name: InstallEfiBootManager[0m
[30;1m136 | [0m[35m        action: ExecuteBash[0m

[31m--[ [0m[34mMatch #[0m[33m1826[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m128 | [0m[35m                flock $(apt-config shell StateDir Dir::State/d | sed -r "s/.*'(.*)\/?'$/\1/")/daily_[0m
[30;1m129 | [0m[35m                # disable unattended upgrades[0m
[30;1m130 | [0m[35m                sed "/Update-Package-Lists/s/\"1\"/\"0\"/; /Unattended-Upgrade/s/\"1\"/\"0\"/;" /etc[0m
[30;1m131 | [0m[35m                # update package index[0m
[30;1m132 | [0m[35m                DEBIAN_FRONTEND=noninteractive apt-get -y update[0m
[30;1m133 | [0m[35m              fi[0m
[30;1m134 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1827[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35mname: UpdateAndReboot[0m
[30;1m2 | [0m[35mdescription: Update OS and Reboot[0m
[30;1m3 | [0m[35mschemaVersion: 1.0[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mconstants:[0m

[31m--[ [0m[34mMatch #[0m[33m1828[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m311 | [0m[35m                if [[ ${!OS} == "rocky8" ]] || [[ ${!OS} == "rocky9" ]] ; then[0m
[30;1m312 | [0m[35m                  yum versionlock delete rocky-release[0m
[30;1m313 | [0m[35m                elif [[ ${!OS} == "rhel8" ]] || [[ ${!OS} == "rhel9" ]] ; then[0m
[30;1m314 | [0m[35m                  yum versionlock delete redhat-release[0m
[30;1m315 | [0m[35m                fi[0m
[30;1m316 | [0m[35m                echo "Kernel version unlocked"[0m
[30;1m317 | [0m[35m              fi[0m

[31m--[ [0m[34mMatch #[0m[33m1829[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m309 | [0m[35m                fi[0m
[30;1m310 | [0m[35m[0m
[30;1m311 | [0m[35m                if [[ ${!OS} == "rocky8" ]] || [[ ${!OS} == "rocky9" ]] ; then[0m
[30;1m312 | [0m[35m                  yum versionlock delete rocky-release[0m
[30;1m313 | [0m[35m                elif [[ ${!OS} == "rhel8" ]] || [[ ${!OS} == "rhel9" ]] ; then[0m
[30;1m314 | [0m[35m                  yum versionlock delete redhat-release[0m
[30;1m315 | [0m[35m                fi[0m

[31m--[ [0m[34mMatch #[0m[33m1830[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m305 | [0m[35m                if [[ ${!OS} == "alinux2" ]] || [[ ${!OS} == "alinux2023" ]] ; then[0m
[30;1m306 | [0m[35m                  yum versionlock delete kernel-abi-whitelists[0m
[30;1m307 | [0m[35m                else[0m
[30;1m308 | [0m[35m                  yum versionlock delete kernel-abi-stablelists[0m
[30;1m309 | [0m[35m                fi[0m
[30;1m310 | [0m[35m[0m
[30;1m311 | [0m[35m                if [[ ${!OS} == "rocky8" ]] || [[ ${!OS} == "rocky9" ]] ; then[0m

[31m--[ [0m[34mMatch #[0m[33m1831[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m303 | [0m[35m                yum versionlock delete kernel kernel-core kernel-modules[0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m                if [[ ${!OS} == "alinux2" ]] || [[ ${!OS} == "alinux2023" ]] ; then[0m
[30;1m306 | [0m[35m                  yum versionlock delete kernel-abi-whitelists[0m
[30;1m307 | [0m[35m                else[0m
[30;1m308 | [0m[35m                  yum versionlock delete kernel-abi-stablelists[0m
[30;1m309 | [0m[35m                fi[0m

[31m--[ [0m[34mMatch #[0m[33m1832[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m300 | [0m[35m[0m
[30;1m301 | [0m[35m              # Remove kernel version lock[0m
[30;1m302 | [0m[35m              if [[ ${!DISABLE_KERNEL_UPDATE} == true ]] && [[ ${!PLATFORM} == RHEL ]]; then[0m
[30;1m303 | [0m[35m                yum versionlock delete kernel kernel-core kernel-modules[0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m                if [[ ${!OS} == "alinux2" ]] || [[ ${!OS} == "alinux2023" ]] ; then[0m
[30;1m306 | [0m[35m                  yum versionlock delete kernel-abi-whitelists[0m

[31m--[ [0m[34mMatch #[0m[33m1833[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m284 | [0m[35m[0m
[30;1m285 | [0m[35m              elif [[ ${!PLATFORM} == DEBIAN ]]; then[0m
[30;1m286 | [0m[35m                if [[ ${!DISABLE_KERNEL_UPDATE} != true ]]; then[0m
[30;1m287 | [0m[35m                   apt-get -y install linux-aws linux-headers-aws linux-image-aws[0m
[30;1m288 | [0m[35m                fi[0m
[30;1m289 | [0m[35m              fi[0m
[30;1m290 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1834[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m279 | [0m[35m                    yum install -y ./${!PACKAGE}.rpm[0m
[30;1m280 | [0m[35m                  fi[0m
[30;1m281 | [0m[35m                else[0m
[30;1m282 | [0m[35m                  yum -y install kernel-devel[0m
[30;1m283 | [0m[35m                fi[0m
[30;1m284 | [0m[35m[0m
[30;1m285 | [0m[35m              elif [[ ${!PLATFORM} == DEBIAN ]]; then[0m

[31m--[ [0m[34mMatch #[0m[33m1835[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m276 | [0m[35m                    # Previous releases are moved into a vault area once a new minor release version[0m
[30;1m277 | [0m[35m                    # https://wiki.rockylinux.org/rocky/repo/#notes-on-devel[0m
[30;1m278 | [0m[35m                    wget https://dl.rockylinux.org/vault/rocky/${!RELEASE_VERSION}/BaseOS/$(uname -m[0m
[30;1m279 | [0m[35m                    yum install -y ./${!PACKAGE}.rpm[0m
[30;1m280 | [0m[35m                  fi[0m
[30;1m281 | [0m[35m                else[0m
[30;1m282 | [0m[35m                  yum -y install kernel-devel[0m

[31m--[ [0m[34mMatch #[0m[33m1836[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m275 | [0m[35m                    yum install -y wget[0m
[30;1m276 | [0m[35m                    # Previous releases are moved into a vault area once a new minor release version[0m
[30;1m277 | [0m[35m                    # https://wiki.rockylinux.org/rocky/repo/#notes-on-devel[0m
[30;1m278 | [0m[35m                    wget https://dl.rockylinux.org/vault/rocky/${!RELEASE_VERSION}/BaseOS/$(uname -m[0m
[30;1m279 | [0m[35m                    yum install -y ./${!PACKAGE}.rpm[0m
[30;1m280 | [0m[35m                  fi[0m
[30;1m281 | [0m[35m                else[0m

[31m--[ [0m[34mMatch #[0m[33m1837[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m270 | [0m[35m  RELEASE_VERSION=$(source /etc/os-release && echo ${!VERSION_ID})[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m                  # try to install kernel source for a specific release version[0m
[30;1m273 | [0m[35m                  yum install -y ${!PACKAGE} --releasever ${!RELEASE_VERSION}[0m
[30;1m274 | [0m[35m                  if [ $? -ne 0 ]; then[0m
[30;1m275 | [0m[35m                    yum install -y wget[0m
[30;1m276 | [0m[35m                    # Previous releases are moved into a vault area once a new minor release version[0m
[30;1m277 | [0m[35m                    # https://wiki.rockylinux.org/rocky/repo/#notes-on-devel[0m

[31m--[ [0m[34mMatch #[0m[33m1838[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m272 | [0m[35m                  # try to install kernel source for a specific release version[0m
[30;1m273 | [0m[35m                  yum install -y ${!PACKAGE} --releasever ${!RELEASE_VERSION}[0m
[30;1m274 | [0m[35m                  if [ $? -ne 0 ]; then[0m
[30;1m275 | [0m[35m                    yum install -y wget[0m
[30;1m276 | [0m[35m                    # Previous releases are moved into a vault area once a new minor release version[0m
[30;1m277 | [0m[35m                    # https://wiki.rockylinux.org/rocky/repo/#notes-on-devel[0m
[30;1m278 | [0m[35m                    wget https://dl.rockylinux.org/vault/rocky/${!RELEASE_VERSION}/BaseOS/$(uname -m[0m

[31m--[ [0m[34mMatch #[0m[33m1839[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m270 | [0m[35m                  RELEASE_VERSION=$(source /etc/os-release && echo ${!VERSION_ID})[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m                  # try to install kernel source for a specific release version[0m
[30;1m273 | [0m[35m                  yum install -y ${!PACKAGE} --releasever ${!RELEASE_VERSION}[0m
[30;1m274 | [0m[35m                  if [ $? -ne 0 ]; then[0m
[30;1m275 | [0m[35m                    yum install -y wget[0m
[30;1m276 | [0m[35m                    # Previous releases are moved into a vault area once a new minor release version[0m

[31m--[ [0m[34mMatch #[0m[33m1840[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m244 | [0m[35m                else[0m
[30;1m245 | [0m[35m                  DEBIAN_FRONTEND=noninteractive apt-get -y -o Dpkg::Options::="--force-confdef" -o [0m
[30;1m246 | [0m[35m                fi[0m
[30;1m247 | [0m[35m                apt-get --purge autoremove -y[0m
[30;1m248 | [0m[35m              fi[0m
[30;1m249 | [0m[35m      - name: RebootStep[0m
[30;1m250 | [0m[35m        action: Reboot[0m

[31m--[ [0m[34mMatch #[0m[33m1841[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m242 | [0m[35m                if [[ ${!DISABLE_KERNEL_UPDATE} == true ]]; then[0m
[30;1m243 | [0m[35m                  DEBIAN_FRONTEND=noninteractive apt-get -y -o Dpkg::Options::="--force-confdef" -o [0m
[30;1m244 | [0m[35m                else[0m
[30;1m245 | [0m[35m                  DEBIAN_FRONTEND=noninteractive apt-get -y -o Dpkg::Options::="--force-confdef" -o [0m
[30;1m246 | [0m[35m                fi[0m
[30;1m247 | [0m[35m                apt-get --purge autoremove -y[0m
[30;1m248 | [0m[35m              fi[0m

[31m--[ [0m[34mMatch #[0m[33m1842[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m240 | [0m[35m              elif [[ ${!PLATFORM} == DEBIAN ]]; then[0m
[30;1m241 | [0m[35m                DEBIAN_FRONTEND=noninteractive apt-get -y update[0m
[30;1m242 | [0m[35m                if [[ ${!DISABLE_KERNEL_UPDATE} == true ]]; then[0m
[30;1m243 | [0m[35m                  DEBIAN_FRONTEND=noninteractive apt-get -y -o Dpkg::Options::="--force-confdef" -o [0m
[30;1m244 | [0m[35m                else[0m
[30;1m245 | [0m[35m                  DEBIAN_FRONTEND=noninteractive apt-get -y -o Dpkg::Options::="--force-confdef" -o [0m
[30;1m246 | [0m[35m                fi[0m

[31m--[ [0m[34mMatch #[0m[33m1843[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m238 | [0m[35m                fi[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35m              elif [[ ${!PLATFORM} == DEBIAN ]]; then[0m
[30;1m241 | [0m[35m                DEBIAN_FRONTEND=noninteractive apt-get -y update[0m
[30;1m242 | [0m[35m                if [[ ${!DISABLE_KERNEL_UPDATE} == true ]]; then[0m
[30;1m243 | [0m[35m                  DEBIAN_FRONTEND=noninteractive apt-get -y -o Dpkg::Options::="--force-confdef" -o [0m
[30;1m244 | [0m[35m                else[0m

[31m--[ [0m[34mMatch #[0m[33m1844[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m                if [[ ${!OS} == "rhel8" ]] || [[ ${!OS} == "rocky8" ]] || [[ ${!OS} == "rhel9" ]] ||[0m
[30;1m234 | [0m[35m                  # package-cleanup has changed in RHEL8 and it works differently https://access.red[0m
[30;1m235 | [0m[35m                  yum remove -y $(yum repoquery --installonly --latest-limit=-2 -q)[0m
[30;1m236 | [0m[35m                else[0m
[30;1m237 | [0m[35m                  package-cleanup -y --oldkernels --count=1[0m
[30;1m238 | [0m[35m                fi[0m

[31m--[ [0m[34mMatch #[0m[33m1845[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m228 | [0m[35m              DISABLE_KERNEL_UPDATE='{{ build.DisableKernelUpdate.outputs.stdout }}'[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m              if [[ ${!PLATFORM} == RHEL ]]; then[0m
[30;1m231 | [0m[35m                yum -y update[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m                if [[ ${!OS} == "rhel8" ]] || [[ ${!OS} == "rocky8" ]] || [[ ${!OS} == "rhel9" ]] ||[0m
[30;1m234 | [0m[35m                  # package-cleanup has changed in RHEL8 and it works differently https://access.red[0m

[31m--[ [0m[34mMatch #[0m[33m1846[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m211 | [0m[35m                  if [[ ${!OS} == "rocky8" ]] || [[ ${!OS} == "rocky9" ]] ; then[0m
[30;1m212 | [0m[35m                    yum versionlock rocky-release rocky-repos[0m
[30;1m213 | [0m[35m                  elif [[ ${!OS} == "rhel8" ]] || [[ ${!OS} == "rhel9" ]] ; then[0m
[30;1m214 | [0m[35m                    yum versionlock redhat-release[0m
[30;1m215 | [0m[35m                  fi[0m
[30;1m216 | [0m[35m                  echo "Kernel version locked"[0m
[30;1m217 | [0m[35m                fi[0m

[31m--[ [0m[34mMatch #[0m[33m1847[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m209 | [0m[35m                  fi[0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m                  if [[ ${!OS} == "rocky8" ]] || [[ ${!OS} == "rocky9" ]] ; then[0m
[30;1m212 | [0m[35m                    yum versionlock rocky-release rocky-repos[0m
[30;1m213 | [0m[35m                  elif [[ ${!OS} == "rhel8" ]] || [[ ${!OS} == "rhel9" ]] ; then[0m
[30;1m214 | [0m[35m                    yum versionlock redhat-release[0m
[30;1m215 | [0m[35m                  fi[0m

[31m--[ [0m[34mMatch #[0m[33m1848[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m205 | [0m[35m                  if [[ ${!OS} == "alinux2" ]] || [[ ${!OS} == "alinux2023" ]] ; then[0m
[30;1m206 | [0m[35m                    yum versionlock kernel-abi-whitelists[0m
[30;1m207 | [0m[35m                  else[0m
[30;1m208 | [0m[35m                    yum versionlock kernel-abi-stablelists[0m
[30;1m209 | [0m[35m                  fi[0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m                  if [[ ${!OS} == "rocky8" ]] || [[ ${!OS} == "rocky9" ]] ; then[0m

[31m--[ [0m[34mMatch #[0m[33m1849[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m203 | [0m[35m                  yum versionlock kernel kernel-core kernel-modules[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m                  if [[ ${!OS} == "alinux2" ]] || [[ ${!OS} == "alinux2023" ]] ; then[0m
[30;1m206 | [0m[35m                    yum versionlock kernel-abi-whitelists[0m
[30;1m207 | [0m[35m                  else[0m
[30;1m208 | [0m[35m                    yum versionlock kernel-abi-stablelists[0m
[30;1m209 | [0m[35m                  fi[0m

[31m--[ [0m[34mMatch #[0m[33m1850[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m200 | [0m[35m                if [[ ${!PLATFORM} == RHEL ]]; then[0m
[30;1m201 | [0m[35m                  yum install -y yum-plugin-versionlock[0m
[30;1m202 | [0m[35m                  # listing all the packages because wildcard does not work as expected[0m
[30;1m203 | [0m[35m                  yum versionlock kernel kernel-core kernel-modules[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m                  if [[ ${!OS} == "alinux2" ]] || [[ ${!OS} == "alinux2023" ]] ; then[0m
[30;1m206 | [0m[35m                    yum versionlock kernel-abi-whitelists[0m

[31m--[ [0m[34mMatch #[0m[33m1851[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35m              if [[ ${!DISABLE_KERNEL_UPDATE} == true ]]; then[0m
[30;1m200 | [0m[35m                if [[ ${!PLATFORM} == RHEL ]]; then[0m
[30;1m201 | [0m[35m                  yum install -y yum-plugin-versionlock[0m
[30;1m202 | [0m[35m                  # listing all the packages because wildcard does not work as expected[0m
[30;1m203 | [0m[35m                  yum versionlock kernel kernel-core kernel-modules[0m
[30;1m204 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1852[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m157 | [0m[35m              if [[ ${!PLATFORM} == RHEL ]]; then[0m
[30;1m158 | [0m[35m                yum -y install jq[0m
[30;1m159 | [0m[35m              elif [[ ${!PLATFORM} == DEBIAN ]]; then[0m
[30;1m160 | [0m[35m                apt-get -y install jq[0m
[30;1m161 | [0m[35m              fi[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m      # Get AWS Region[0m

[31m--[ [0m[34mMatch #[0m[33m1853[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m155 | [0m[35m              PLATFORM='{{ build.PlatformName.outputs.stdout }}'[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m              if [[ ${!PLATFORM} == RHEL ]]; then[0m
[30;1m158 | [0m[35m                yum -y install jq[0m
[30;1m159 | [0m[35m              elif [[ ${!PLATFORM} == DEBIAN ]]; then[0m
[30;1m160 | [0m[35m                apt-get -y install jq[0m
[30;1m161 | [0m[35m              fi[0m

[31m--[ [0m[34mMatch #[0m[33m1854[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m142 | [0m[35m              ARCH=$(uname -m)[0m
[30;1m143 | [0m[35m              if [[ `echo ${!ARCH}` == 'aarch64' ]] && [[ ${!PLATFORM} == DEBIAN ]]; then[0m
[30;1m144 | [0m[35m                # temporary workaround to solve https://bugs.launchpad.net/ubuntu/+source/grub2-sign[0m
[30;1m145 | [0m[35m                apt-get -y install efibootmgr[0m
[30;1m146 | [0m[35m              fi[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m      - name: InstallPrerequisites[0m

[31m--[ [0m[34mMatch #[0m[33m1855[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m                # disable unattended upgrades[0m
[30;1m130 | [0m[35m                sed "/Update-Package-Lists/s/\"1\"/\"0\"/; /Unattended-Upgrade/s/\"1\"/\"0\"/;" /etc[0m
[30;1m131 | [0m[35m                # update package index[0m
[30;1m132 | [0m[35m                DEBIAN_FRONTEND=noninteractive apt-get -y update[0m
[30;1m133 | [0m[35m              fi[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m      - name: InstallEfiBootManager[0m

[31m--[ [0m[34mMatch #[0m[33m1856[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m127 | [0m[35m.timer to avoid dpkg lock[0m
[30;1m128 | [0m[35m                flock $(apt-config shell StateDir Dir::State/d | sed -r "s/.*'(.*)\/?'$/\1/")/daily_[0m
[30;1m129 | [0m[35m                # disable unattended upgrades[0m
[30;1m130 | [0m[35m                sed "/Update-Package-Lists/s/\"1\"/\"0\"/; /Unattended-Upgrade/s/\"1\"/\"0\"/;" /etc[0m
[30;1m131 | [0m[35m                # update package index[0m
[30;1m132 | [0m[35m                DEBIAN_FRONTEND=noninteractive apt-get -y update[0m
[30;1m133 | [0m[35m              fi[0m
[30;1m134 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1857[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35mby cloud-init[0m
[30;1m126 | [0m[35m                while [ ! -f /var/lib/cloud/instance/boot-finished ]; do echo 'Waiting for cloud-ini[0m
[30;1m127 | [0m[35m                # disable apt-daily.timer to avoid dpkg lock[0m
[30;1m128 | [0m[35m                flock $(apt-config shell StateDir Dir::State/d | sed -r "s/.*'(.*)\/?'$/\1/")/daily_[0m
[30;1m129 | [0m[35m                # disable unattended upgrades[0m

[31m--[ [0m[34mMatch #[0m[33m1858[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35m for completion of os updates performed by cloud-init[0m
[30;1m126 | [0m[35m                while [ ! -f /var/lib/cloud/instance/boot-finished ]; do echo 'Waiting for cloud-ini[0m
[30;1m127 | [0m[35m                # disable apt-daily.timer to avoid dpkg lock[0m
[30;1m128 | [0m[35m                flock $(apt-config shell StateDir Dir::State/d | sed -r "s/.*'(.*)\/?'$/\1/")/daily_[0m
[30;1m129 | [0m[35m                # disable unattended upgrades[0m

[31m--[ [0m[34mMatch #[0m[33m1859[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m124 | [0m[35mATFORM} == DEBIAN ]]; then[0m
[30;1m125 | [0m[35m                # wait for completion of os updates performed by cloud-init[0m
[30;1m126 | [0m[35m                while [ ! -f /var/lib/cloud/instance/boot-finished ]; do echo 'Waiting for cloud-ini[0m
[30;1m127 | [0m[35m                # disable apt-daily.timer to avoid dpkg lock[0m
[30;1m128 | [0m[35m                flock $(apt-config shell StateDir Dir::State/d | sed -r "s/.*'(.*)\/?'$/\1/")/daily_[0m
[30;1m129 | [0m[35m                # disable unattended upgrades[0m

[31m--[ [0m[34mMatch #[0m[33m1860[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m              if [[ ${!PLATFORM} == DEBIAN ]]; then[0m
[30;1m125 | [0m[35m                # wait for completion of os updates performed by cloud-init[0m
[30;1m126 | [0m[35m                while [ ! -f /var/lib/cloud/instance/boot-finished ]; do echo 'Waiting for cloud-ini[0m
[30;1m127 | [0m[35m                # disable apt-daily.timer to avoid dpkg lock[0m
[30;1m128 | [0m[35m                flock $(apt-config shell StateDir Dir::State/d | sed -r "s/.*'(.*)\/?'$/\1/")/daily_[0m
[30;1m129 | [0m[35m                # disable unattended upgrades[0m

[31m--[ [0m[34mMatch #[0m[33m1861[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m              # This component only supports aarch64 CPUs on Amazon Linux 2, Ubuntu2004, Ubuntu2204,[0m
[30;1m94 | [0m[35m              ARCH=$(uname -m)[0m
[30;1m95 | [0m[35m              if [[ `echo ${!ARCH}` == 'aarch64' ]]; then[0m
[30;1m96 | [0m[35m                if [ `echo "${!RELEASE}" | grep -Ev '^(amzn\.2|ubuntu\.20\.04|ubuntu\.22\.04|ubuntu\[0m
[30;1m97 | [0m[35m                  echo "This component does not support '${!RELEASE}' on ARM64 CPUs. Failing build."[0m
[30;1m98 | [0m[35m                  exit {{ FailExitCode }}[0m
[30;1m99 | [0m[35m                fi[0m

[31m--[ [0m[34mMatch #[0m[33m1862[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m85 | [0m[35m            - |[0m
[30;1m86 | [0m[35m              set -v[0m
[30;1m87 | [0m[35m              RELEASE='{{ build.OperatingSystemRelease.outputs.stdout }}'[0m
[30;1m88 | [0m[35m              if [ `echo "${!RELEASE}" | grep -Ev '^(amzn|centos|ubuntu|rhel|rocky)'` ]; then[0m
[30;1m89 | [0m[35m                echo "This component does not support '${!RELEASE}'. Failing build."[0m
[30;1m90 | [0m[35m                exit {{ FailExitCode }}[0m
[30;1m91 | [0m[35m              fi[0m

[31m--[ [0m[34mMatch #[0m[33m1863[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m               if [ `echo "${!OS}" | grep -E '^(alinux|centos|rhel|rocky)'` ]; then[0m
[30;1m73 | [0m[35m                 PLATFORM='RHEL'[0m
[30;1m74 | [0m[35m               elif [ `echo "${!OS}" | grep -E '^ubuntu'` ]; then[0m
[30;1m75 | [0m[35m                 PLATFORM='DEBIAN'[0m
[30;1m76 | [0m[35m               fi[0m
[30;1m77 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1864[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m69 | [0m[35m               set -v[0m
[30;1m70 | [0m[35m               OS='{{ build.OperatingSystemName.outputs.stdout }}'[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m               if [ `echo "${!OS}" | grep -E '^(alinux|centos|rhel|rocky)'` ]; then[0m
[30;1m73 | [0m[35m                 PLATFORM='RHEL'[0m
[30;1m74 | [0m[35m               elif [ `echo "${!OS}" | grep -E '^ubuntu'` ]; then[0m
[30;1m75 | [0m[35m                 PLATFORM='DEBIAN'[0m

[31m--[ [0m[34mMatch #[0m[33m1865[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m51 | [0m[35m                OS='rocky8'[0m
[30;1m52 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rhel\.9'` ]; then[0m
[30;1m53 | [0m[35m                OS='rhel9'[0m
[30;1m54 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rocky\.9'` ]; then[0m
[30;1m55 | [0m[35m                OS='rocky9'[0m
[30;1m56 | [0m[35m              else[0m
[30;1m57 | [0m[35m                echo "Operating System '${!RELEASE}' is not supported. Failing build."[0m

[31m--[ [0m[34mMatch #[0m[33m1866[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m49 | [0m[35m                OS='rhel8'[0m
[30;1m50 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rocky\.8'` ]; then[0m
[30;1m51 | [0m[35m                OS='rocky8'[0m
[30;1m52 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rhel\.9'` ]; then[0m
[30;1m53 | [0m[35m                OS='rhel9'[0m
[30;1m54 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rocky\.9'` ]; then[0m
[30;1m55 | [0m[35m                OS='rocky9'[0m

[31m--[ [0m[34mMatch #[0m[33m1867[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m47 | [0m[35m                OS='ubuntu2404'[0m
[30;1m48 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rhel\.8'` ]; then[0m
[30;1m49 | [0m[35m                OS='rhel8'[0m
[30;1m50 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rocky\.8'` ]; then[0m
[30;1m51 | [0m[35m                OS='rocky8'[0m
[30;1m52 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rhel\.9'` ]; then[0m
[30;1m53 | [0m[35m                OS='rhel9'[0m

[31m--[ [0m[34mMatch #[0m[33m1868[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m                OS='ubuntu2204'[0m
[30;1m46 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^ubuntu\.24'` ]; then[0m
[30;1m47 | [0m[35m                OS='ubuntu2404'[0m
[30;1m48 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rhel\.8'` ]; then[0m
[30;1m49 | [0m[35m                OS='rhel8'[0m
[30;1m50 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rocky\.8'` ]; then[0m
[30;1m51 | [0m[35m                OS='rocky8'[0m

[31m--[ [0m[34mMatch #[0m[33m1869[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m43 | [0m[35m                OS='ubuntu2004'[0m
[30;1m44 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^ubuntu\.22'` ]; then[0m
[30;1m45 | [0m[35m                OS='ubuntu2204'[0m
[30;1m46 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^ubuntu\.24'` ]; then[0m
[30;1m47 | [0m[35m                OS='ubuntu2404'[0m
[30;1m48 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^rhel\.8'` ]; then[0m
[30;1m49 | [0m[35m                OS='rhel8'[0m

[31m--[ [0m[34mMatch #[0m[33m1870[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m                OS='alinux2023'[0m
[30;1m42 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^ubuntu\.20'` ]; then[0m
[30;1m43 | [0m[35m                OS='ubuntu2004'[0m
[30;1m44 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^ubuntu\.22'` ]; then[0m
[30;1m45 | [0m[35m                OS='ubuntu2204'[0m
[30;1m46 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^ubuntu\.24'` ]; then[0m
[30;1m47 | [0m[35m                OS='ubuntu2404'[0m

[31m--[ [0m[34mMatch #[0m[33m1871[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m                OS='alinux2'[0m
[30;1m40 | [0m[35m              elif [ `echo "${!RELEASE}" | grep -w '^amzn\.2023'` ]; then[0m
[30;1m41 | [0m[35m                OS='alinux2023'[0m
[30;1m42 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^ubuntu\.20'` ]; then[0m
[30;1m43 | [0m[35m                OS='ubuntu2004'[0m
[30;1m44 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^ubuntu\.22'` ]; then[0m
[30;1m45 | [0m[35m                OS='ubuntu2204'[0m

[31m--[ [0m[34mMatch #[0m[33m1872[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m              if [ `echo "${!RELEASE}" | grep -w '^amzn\.2'` ]; then[0m
[30;1m39 | [0m[35m                OS='alinux2'[0m
[30;1m40 | [0m[35m              elif [ `echo "${!RELEASE}" | grep -w '^amzn\.2023'` ]; then[0m
[30;1m41 | [0m[35m                OS='alinux2023'[0m
[30;1m42 | [0m[35m              elif [ `echo "${!RELEASE}" | grep '^ubuntu\.20'` ]; then[0m
[30;1m43 | [0m[35m                OS='ubuntu2004'[0m

[31m--[ [0m[34mMatch #[0m[33m1873[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/resources/imagebuilder/update_and_reboot.yaml[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m35 | [0m[35m              set -v[0m
[30;1m36 | [0m[35m              RELEASE='{{ build.OperatingSystemRelease.outputs.stdout }}'[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m              if [ `echo "${!RELEASE}" | grep -w '^amzn\.2'` ]; then[0m
[30;1m39 | [0m[35m                OS='alinux2'[0m
[30;1m40 | [0m[35m              elif [ `echo "${!RELEASE}" | grep -w '^amzn\.2023'` ]; then[0m
[30;1m41 | [0m[35m                OS='alinux2023'[0m

[31m--[ [0m[34mMatch #[0m[33m1874[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/compute_fleet_status.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1875[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/dryrun_operation_exception_response_content.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1876[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/cluster_configuration_structure.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1877[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/api/models/requested_compute_fleet_status.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/[0m
[30;1m5 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m
[30;1m6 | [0m[35m# OR CONDITIONS OF ANY KIND, express or implied. See the License for the specific language governing[0m
[30;1m7 | [0m[35m# limitations under the License.[0m

[31m--[ [0m[34mMatch #[0m[33m1878[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/awsbatch_validators.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m# Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.[0m
[30;1m2 | [0m[35m#[0m
[30;1m3 | [0m[35m# Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except i[0m
[30;1m4 | [0m[35m# with the License. A copy of the License is located at[0m
[30;1m5 | [0m[35m#[0m
[30;1m6 | [0m[35m# http://aws.amazon.com/apache2.0/[0m
[30;1m7 | [0m[35m#[0m
[30;1m8 | [0m[35m# or in the "LICENSE.txt" file accompanying this file. This file is distributed on an "AS IS" BASIS,[0m

[31m--[ [0m[34mMatch #[0m[33m1879[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/awsbatch_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m163 | [0m[35m                self._add_failure([0m
[30;1m164 | [0m[35m                    f"The specified compute instance type ({instance_type}) supports"[0m
[30;1m165 | [0m[35m                    f" the architectures {compute_architectures}, none of which is "[0m
[30;1m166 | [0m[35m                    f"compatible with the architecture ({architecture}) supported by the head node i[0m
[30;1m167 | [0m[35m                    FailureLevel.ERROR,[0m
[30;1m168 | [0m[35m                )[0m
[30;1m169 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1880[0m[34m of [0m[33m1880[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/aws_parallelcluster-3.13.0/src/pcluster/validators/awsbatch_validators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m142 | [0m[35m    """[0m
[30;1m143 | [0m[35m    Validate instance type and architecture combination.[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m    Verify that head node and compute instance types imply compatible architectures.[0m
[30;1m146 | [0m[35m    With AWS Batch, compute instance type can contain a CSV list.[0m
[30;1m147 | [0m[35m    """[0m
[30;1m148 | [0m[35m[0m

1880 matches found.
