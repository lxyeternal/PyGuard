[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m631 | [0m[35m                auth = update_data['auth'] or {}[0m
[30;1m632 | [0m[35m                if auth:[0m
[30;1m633 | [0m[35m                    docker_config.update(dict(registry_username=auth.get('username'),[0m
[30;1m634 | [0m[35m                                              registry_password=auth.get('password')))[0m
[30;1m635 | [0m[35m[0m
[30;1m636 | [0m[35m                # Apply any container configuration changes specifically for jobs[0m
[30;1m637 | [0m[35m                docker_config.update(self.job_dockerconfig)[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m631 | [0m[35m                auth = update_data['auth'] or {}[0m
[30;1m632 | [0m[35m                if auth:[0m
[30;1m633 | [0m[35m                    docker_config.update(dict(registry_username=auth.get('username'),[0m
[30;1m634 | [0m[35m                                              registry_password=auth.get('password')))[0m
[30;1m635 | [0m[35m[0m
[30;1m636 | [0m[35m                # Apply any container configuration changes specifically for jobs[0m
[30;1m637 | [0m[35m                docker_config.update(self.job_dockerconfig)[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m533 | [0m[35m                    docker_config = dict(image=f"{image_name}:{tag_name}")[0m
[30;1m534 | [0m[35m                    if auth:[0m
[30;1m535 | [0m[35m                        docker_config.update(dict(registry_username=auth['username'],[0m
[30;1m536 | [0m[35m                                                  registry_password=auth['password']))[0m
[30;1m537 | [0m[35m[0m
[30;1m538 | [0m[35m                    # Apply any container configuration changes specifically for jobs[0m
[30;1m539 | [0m[35m                    docker_config.update(self.job_dockerconfig)[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m533 | [0m[35m                    docker_config = dict(image=f"{image_name}:{tag_name}")[0m
[30;1m534 | [0m[35m                    if auth:[0m
[30;1m535 | [0m[35m                        docker_config.update(dict(registry_username=auth['username'],[0m
[30;1m536 | [0m[35m                                                  registry_password=auth['password']))[0m
[30;1m537 | [0m[35m[0m
[30;1m538 | [0m[35m                    # Apply any container configuration changes specifically for jobs[0m
[30;1m539 | [0m[35m                    docker_config.update(self.job_dockerconfig)[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m243 | [0m[35m                self.api.create_namespaced_secret(namespace=self.namespace, body=new_pull_secret,[0m
[30;1m244 | [0m[35m                                                  _request_timeout=API_TIMEOUT)[0m
[30;1m245 | [0m[35m        elif current_pull_secret:[0m
[30;1m246 | [0m[35m            # If there is a password set in kubernetes, but not in our configuration clear it out[0m
[30;1m247 | [0m[35m            self.api.delete_namespaced_secret(pull_secret_name, self.namespace, _request_timeout=API[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m230 | [0m[35m                    '.dockerconfigjson': create_docker_auth_config([0m
[30;1m231 | [0m[35m                        image=docker_config.image,[0m
[30;1m232 | [0m[35m                        username=docker_config.registry_username,[0m
[30;1m233 | [0m[35m                        password=docker_config.registry_password,[0m
[30;1m234 | [0m[35m                    )[0m
[30;1m235 | [0m[35m                }[0m
[30;1m236 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m230 | [0m[35m                    '.dockerconfigjson': create_docker_auth_config([0m
[30;1m231 | [0m[35m                        image=docker_config.image,[0m
[30;1m232 | [0m[35m                        username=docker_config.registry_username,[0m
[30;1m233 | [0m[35m                        password=docker_config.registry_password,[0m
[30;1m234 | [0m[35m                    )[0m
[30;1m235 | [0m[35m                }[0m
[30;1m236 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m220 | [0m[35m                raise[0m
[30;1m221 | [0m[35m            current_pull_secret = None[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m        if docker_config.registry_username or docker_config.registry_password:[0m
[30;1m224 | [0m[35m            use_pull_secret = True[0m
[30;1m225 | [0m[35m            # Build the secret we want to make[0m
[30;1m226 | [0m[35m            new_pull_secret = V1Secret([0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m212 | [0m[35m        pull_secret_name = f'{name}-job-pull-secret'[0m
[30;1m213 | [0m[35m        use_pull_secret = False[0m
[30;1m214 | [0m[35m        try:[0m
[30;1m215 | [0m[35m            # Check if there is already a username/password defined for this job[0m
[30;1m216 | [0m[35m            current_pull_secret = self.api.read_namespaced_secret(pull_secret_name, self.namespace,[0m
[30;1m217 | [0m[35m                                                                  _request_timeout=API_TIMEOUT)[0m
[30;1m218 | [0m[35m        except ApiException as error:[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m        # If we have been given a username or password for the registry, we have to[0m
[30;1m210 | [0m[35m        # update it, if we haven't been, make sure its been cleaned up in the system[0m
[30;1m211 | [0m[35m        # so we don't leave passwords lying around[0m
[30;1m212 | [0m[35m        pull_secret_name = f'{name}-job-pull-secret'[0m
[30;1m213 | [0m[35m        use_pull_secret = False[0m
[30;1m214 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m206 | [0m[35m    def launch(self, name, docker_config: DockerConfig, mounts: List[Mount], env, blocking: bool = T[0m
[30;1m207 | [0m[35m        name = (self.prefix + 'update-' + name.lower()).replace('_', '-')[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m        # If we have been given a username or password for the registry, we have to[0m
[30;1m210 | [0m[35m        # update it, if we haven't been, make sure its been cleaned up in the system[0m
[30;1m211 | [0m[35m        # so we don't leave passwords lying around[0m
[30;1m212 | [0m[35m        pull_secret_name = f'{name}-job-pull-secret'[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m107 | [0m[35m        if docker_config.registry_username or docker_config.registry_password:[0m
[30;1m108 | [0m[35m            auth_config = {[0m
[30;1m109 | [0m[35m                'username': docker_config.registry_username,[0m
[30;1m110 | [0m[35m                'password': docker_config.registry_password[0m
[30;1m111 | [0m[35m            }[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m        self.client.images.pull(repository, tag, auth_config=auth_config)[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m107 | [0m[35m        if docker_config.registry_username or docker_config.registry_password:[0m
[30;1m108 | [0m[35m            auth_config = {[0m
[30;1m109 | [0m[35m                'username': docker_config.registry_username,[0m
[30;1m110 | [0m[35m                'password': docker_config.registry_password[0m
[30;1m111 | [0m[35m            }[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m        self.client.images.pull(repository, tag, auth_config=auth_config)[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m        # Add auth info if we have it[0m
[30;1m106 | [0m[35m        auth_config = None[0m
[30;1m107 | [0m[35m        if docker_config.registry_username or docker_config.registry_password:[0m
[30;1m108 | [0m[35m            auth_config = {[0m
[30;1m109 | [0m[35m                'username': docker_config.registry_username,[0m
[30;1m110 | [0m[35m                'password': docker_config.registry_password[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35mCONFIGURATION_HOST_PATH = os.getenv('CONFIGURATION_HOST_PATH', 'service_config')[0m
[30;1m46 | [0m[35mCONFIGURATION_CONFIGMAP = os.getenv('KUBERNETES_AL_CONFIG', None)[0m
[30;1m47 | [0m[35mAL_CORE_NETWORK = os.environ.get("AL_CORE_NETWORK", 'core')[0m
[30;1m48 | [0m[35mRESTRICTED_POD_SECUTITY_CONTEXT = V1SecurityContext([0m
[30;1m49 | [0m[35m    run_as_user=1000,[0m
[30;1m50 | [0m[35m    run_as_group=1000,[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m511 | [0m[35m                    password_strings = [][0m
[30;1m512 | [0m[35m[0m
[30;1m513 | [0m[35m                if password_strings:[0m
[30;1m514 | [0m[35m                    init_data = json.dumps(dict(passwords=password_strings))[0m
[30;1m515 | [0m[35m                    s_params['initial_data'] = init_data[0m
[30;1m516 | [0m[35m[0m
[30;1m517 | [0m[35m                # Set description if it does not exists[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m511 | [0m[35m                    password_strings = [][0m
[30;1m512 | [0m[35m[0m
[30;1m513 | [0m[35m                if password_strings:[0m
[30;1m514 | [0m[35m                    init_data = json.dumps(dict(passwords=password_strings))[0m
[30;1m515 | [0m[35m                    s_params['initial_data'] = init_data[0m
[30;1m516 | [0m[35m[0m
[30;1m517 | [0m[35m                # Set description if it does not exists[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m510 | [0m[35m                    logger.warning("Unsupported password list format: %s", password_strings)[0m
[30;1m511 | [0m[35m                    password_strings = [][0m
[30;1m512 | [0m[35m[0m
[30;1m513 | [0m[35m                if password_strings:[0m
[30;1m514 | [0m[35m                    init_data = json.dumps(dict(passwords=password_strings))[0m
[30;1m515 | [0m[35m                    s_params['initial_data'] = init_data[0m
[30;1m516 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m508 | [0m[35m                password_strings = metadata.pop("email_strings", [])[0m
[30;1m509 | [0m[35m                if not isinstance(password_strings, list):[0m
[30;1m510 | [0m[35m                    logger.warning("Unsupported password list format: %s", password_strings)[0m
[30;1m511 | [0m[35m                    password_strings = [][0m
[30;1m512 | [0m[35m[0m
[30;1m513 | [0m[35m                if password_strings:[0m
[30;1m514 | [0m[35m                    init_data = json.dumps(dict(passwords=password_strings))[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m507 | [0m[35m                # Extract email body strings or similar password settings[0m
[30;1m508 | [0m[35m                password_strings = metadata.pop("email_strings", [])[0m
[30;1m509 | [0m[35m                if not isinstance(password_strings, list):[0m
[30;1m510 | [0m[35m                    logger.warning("Unsupported password list format: %s", password_strings)[0m
[30;1m511 | [0m[35m                    password_strings = [][0m
[30;1m512 | [0m[35m[0m
[30;1m513 | [0m[35m                if password_strings:[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m507 | [0m[35m                # Extract email body strings or similar password settings[0m
[30;1m508 | [0m[35m                password_strings = metadata.pop("email_strings", [])[0m
[30;1m509 | [0m[35m                if not isinstance(password_strings, list):[0m
[30;1m510 | [0m[35m                    logger.warning("Unsupported password list format: %s", password_strings)[0m
[30;1m511 | [0m[35m                    password_strings = [][0m
[30;1m512 | [0m[35m[0m
[30;1m513 | [0m[35m                if password_strings:[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m506 | [0m[35m[0m
[30;1m507 | [0m[35m                # Extract email body strings or similar password settings[0m
[30;1m508 | [0m[35m                password_strings = metadata.pop("email_strings", [])[0m
[30;1m509 | [0m[35m                if not isinstance(password_strings, list):[0m
[30;1m510 | [0m[35m                    logger.warning("Unsupported password list format: %s", password_strings)[0m
[30;1m511 | [0m[35m                    password_strings = [][0m
[30;1m512 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m505 | [0m[35m                s_params['type'] = self.config.core.vacuum.ingest_type[0m
[30;1m506 | [0m[35m[0m
[30;1m507 | [0m[35m                # Extract email body strings or similar password settings[0m
[30;1m508 | [0m[35m                password_strings = metadata.pop("email_strings", [])[0m
[30;1m509 | [0m[35m                if not isinstance(password_strings, list):[0m
[30;1m510 | [0m[35m                    logger.warning("Unsupported password list format: %s", password_strings)[0m
[30;1m511 | [0m[35m                    password_strings = [][0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m504 | [0m[35m                # Set ingest type[0m
[30;1m505 | [0m[35m                s_params['type'] = self.config.core.vacuum.ingest_type[0m
[30;1m506 | [0m[35m[0m
[30;1m507 | [0m[35m                # Extract email body strings or similar password settings[0m
[30;1m508 | [0m[35m                password_strings = metadata.pop("email_strings", [])[0m
[30;1m509 | [0m[35m                if not isinstance(password_strings, list):[0m
[30;1m510 | [0m[35m                    logger.warning("Unsupported password list format: %s", password_strings)[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m279 | [0m[35m        settings.pop('default_external_sources', None)[0m
[30;1m280 | [0m[35m[0m
[30;1m281 | [0m[35m        # Remove UI specific params[0m
[30;1m282 | [0m[35m        settings.pop('default_zip_password', None)[0m
[30;1m283 | [0m[35m        settings.pop('download_encoding', None)[0m
[30;1m284 | [0m[35m        settings.pop('executive_summary', None)[0m
[30;1m285 | [0m[35m        settings.pop('expand_min_score', None)[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m201 | [0m[35m                    "agrees_with_tos": "NOW",[0m
[30;1m202 | [0m[35m                    "classification": "RESTRICTED",[0m
[30;1m203 | [0m[35m                    "name": "Vacuum Account",[0m
[30;1m204 | [0m[35m                    "password": '000',  # Invalid[0m
[30;1m205 | [0m[35m                    "uname": username,[0m
[30;1m206 | [0m[35m                    "type": []})[0m
[30;1m207 | [0m[35m                self.datastore.user.save(username, user_data)[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m701 | [0m[35m        elasticapm.instrument()[0m
[30;1m702 | [0m[35m        apm_client = get_apm_client("vacuum_worker")[0m
[30;1m703 | [0m[35m[0m
[30;1m704 | [0m[35m    container_id = os.environ.get("HOSTNAME", 'vacuum-worker') + '-'[0m
[30;1m705 | [0m[35m    FileProcessor.total_rounds = threading.Semaphore(value=vacuum_config.worker_rollover*vacuum_conf[0m
[30;1m706 | [0m[35m[0m
[30;1m707 | [0m[35m    department_map, stream_map = None, None[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m243 | [0m[35m                    }[0m
[30;1m244 | [0m[35m                    self.datastore.apikey.save(key_id, new_apikey)[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m                user['apikeys'] = {}[0m
[30;1m247 | [0m[35m                self.datastore.user.save(uname, user)[0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m234 | [0m[35m                        roles = [r for r in load_roles_form_acls(old_apikey['acl'], roles)[0m
[30;1m235 | [0m[35m                                if r in load_roles(user['type'], user['roles'])][0m
[30;1m236 | [0m[35m                    new_apikey = {[0m
[30;1m237 | [0m[35m                        "password": old_apikey['password'],[0m
[30;1m238 | [0m[35m                        "acl": old_apikey['acl'],[0m
[30;1m239 | [0m[35m                        "uname": uname,[0m
[30;1m240 | [0m[35m                        "key_name": key,[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m234 | [0m[35m                        roles = [r for r in load_roles_form_acls(old_apikey['acl'], roles)[0m
[30;1m235 | [0m[35m                                if r in load_roles(user['type'], user['roles'])][0m
[30;1m236 | [0m[35m                    new_apikey = {[0m
[30;1m237 | [0m[35m                        "password": old_apikey['password'],[0m
[30;1m238 | [0m[35m                        "acl": old_apikey['acl'],[0m
[30;1m239 | [0m[35m                        "uname": uname,[0m
[30;1m240 | [0m[35m                        "key_name": key,[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m221 | [0m[35m                apikeys = user.apikeys[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m                for key in apikeys:[0m
[30;1m224 | [0m[35m                    old_apikey = apikeys[key][0m
[30;1m225 | [0m[35m                    key_id = get_apikey_id(key, uname)[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m                    roles = None[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m220 | [0m[35m                user = self.datastore.user.get(uname)[0m
[30;1m221 | [0m[35m                apikeys = user.apikeys[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m                for key in apikeys:[0m
[30;1m224 | [0m[35m                    old_apikey = apikeys[key][0m
[30;1m225 | [0m[35m                    key_id = get_apikey_id(key, uname)[0m
[30;1m226 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m218 | [0m[35m            for u in users:[0m
[30;1m219 | [0m[35m                uname = u['uname'][0m
[30;1m220 | [0m[35m                user = self.datastore.user.get(uname)[0m
[30;1m221 | [0m[35m                apikeys = user.apikeys[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m                for key in apikeys:[0m
[30;1m224 | [0m[35m                    old_apikey = apikeys[key][0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m218 | [0m[35m            for u in users:[0m
[30;1m219 | [0m[35m                uname = u['uname'][0m
[30;1m220 | [0m[35m                user = self.datastore.user.get(uname)[0m
[30;1m221 | [0m[35m                apikeys = user.apikeys[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m                for key in apikeys:[0m
[30;1m224 | [0m[35m                    old_apikey = apikeys[key][0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m59 | [0m[35mAL_SHUTDOWN_QUIT = 60[0m
[30;1m60 | [0m[35mFINALIZING_WINDOW = max(AL_SHUTDOWN_GRACE - AL_SHUTDOWN_QUIT, 0)[0m
[30;1m61 | [0m[35mRESULT_BATCH_SIZE = int(os.environ.get('DISPATCHER_RESULT_BATCH_SIZE', '50'))[0m
[30;1m62 | [0m[35mERROR_BATCH_SIZE = int(os.environ.get('DISPATCHER_ERROR_BATCH_SIZE', '50'))[0m
[30;1m63 | [0m[35mDAY_IN_SECONDS = 24 * 60 * 60[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m# TODO: DYNAMIC_ANALYSIS_CATEGORY can be removed after assemblyline version 4.6+[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m58 | [0m[35mAL_SHUTDOWN_GRACE = int(os.environ.get('AL_SHUTDOWN_GRACE', '60'))[0m
[30;1m59 | [0m[35mAL_SHUTDOWN_QUIT = 60[0m
[30;1m60 | [0m[35mFINALIZING_WINDOW = max(AL_SHUTDOWN_GRACE - AL_SHUTDOWN_QUIT, 0)[0m
[30;1m61 | [0m[35mRESULT_BATCH_SIZE = int(os.environ.get('DISPATCHER_RESULT_BATCH_SIZE', '50'))[0m
[30;1m62 | [0m[35mERROR_BATCH_SIZE = int(os.environ.get('DISPATCHER_ERROR_BATCH_SIZE', '50'))[0m
[30;1m63 | [0m[35mDAY_IN_SECONDS = 24 * 60 * 60[0m
[30;1m64 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35mAPM_SPAN_TYPE = 'handle_message'[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35mAL_SHUTDOWN_GRACE = int(os.environ.get('AL_SHUTDOWN_GRACE', '60'))[0m
[30;1m59 | [0m[35mAL_SHUTDOWN_QUIT = 60[0m
[30;1m60 | [0m[35mFINALIZING_WINDOW = max(AL_SHUTDOWN_GRACE - AL_SHUTDOWN_QUIT, 0)[0m
[30;1m61 | [0m[35mRESULT_BATCH_SIZE = int(os.environ.get('DISPATCHER_RESULT_BATCH_SIZE', '50'))[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m9 | [0m[35mfrom assemblyline.odm.models.config import Config as SystemConfig, ServiceRegistry[0m
[30;1m10 | [0m[35mfrom assemblyline.odm.models.service import Service as ServiceConfig, DockerConfig[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mfrom base64 import b64encode[0m
[30;1m13 | [0m[35mfrom collections import defaultdict[0m
[30;1m14 | [0m[35mfrom logging import Logger[0m
[30;1m15 | [0m[35mfrom typing import Dict, List[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m229 | [0m[35m        auth = f"Basic {b64encode(upass.encode()).decode()}"[0m
[30;1m230 | [0m[35m    elif auth_config['password']:[0m
[30;1m231 | [0m[35m        # We're assuming that if only a password is given, then this is a token[0m
[30;1m232 | [0m[35m        auth = f"Bearer {auth_config['password']}"[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m    if server.endswith(".azurecr.io"):[0m
[30;1m235 | [0m[35m        if auth_config.get('use_fic', False):[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m228 | [0m[35m        upass = f"{auth_config['username']}:{auth_config['password']}"[0m
[30;1m229 | [0m[35m        auth = f"Basic {b64encode(upass.encode()).decode()}"[0m
[30;1m230 | [0m[35m    elif auth_config['password']:[0m
[30;1m231 | [0m[35m        # We're assuming that if only a password is given, then this is a token[0m
[30;1m232 | [0m[35m        auth = f"Bearer {auth_config['password']}"[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m    if server.endswith(".azurecr.io"):[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m227 | [0m[35m    if auth_config['username'] and auth_config['password']:[0m
[30;1m228 | [0m[35m        upass = f"{auth_config['username']}:{auth_config['password']}"[0m
[30;1m229 | [0m[35m        auth = f"Basic {b64encode(upass.encode()).decode()}"[0m
[30;1m230 | [0m[35m    elif auth_config['password']:[0m
[30;1m231 | [0m[35m        # We're assuming that if only a password is given, then this is a token[0m
[30;1m232 | [0m[35m        auth = f"Bearer {auth_config['password']}"[0m
[30;1m233 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m225 | [0m[35m    auth_config = get_registry_config(service_config.docker_config, system_config)[0m
[30;1m226 | [0m[35m    registry_type = auth_config.pop('type')[0m
[30;1m227 | [0m[35m    if auth_config['username'] and auth_config['password']:[0m
[30;1m228 | [0m[35m        upass = f"{auth_config['username']}:{auth_config['password']}"[0m
[30;1m229 | [0m[35m        auth = f"Basic {b64encode(upass.encode()).decode()}"[0m
[30;1m230 | [0m[35m    elif auth_config['password']:[0m
[30;1m231 | [0m[35m        # We're assuming that if only a password is given, then this is a token[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m224 | [0m[35m    # Generate 'Authenication' header value for pulling tag list from registry[0m
[30;1m225 | [0m[35m    auth_config = get_registry_config(service_config.docker_config, system_config)[0m
[30;1m226 | [0m[35m    registry_type = auth_config.pop('type')[0m
[30;1m227 | [0m[35m    if auth_config['username'] and auth_config['password']:[0m
[30;1m228 | [0m[35m        upass = f"{auth_config['username']}:{auth_config['password']}"[0m
[30;1m229 | [0m[35m        auth = f"Basic {b64encode(upass.encode()).decode()}"[0m
[30;1m230 | [0m[35m    elif auth_config['password']:[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m154 | [0m[35m                        use_fic=registry.use_fic)[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m    # Otherwise return what's configured for the service[0m
[30;1m157 | [0m[35m    return dict(username=docker_config.registry_username, password=docker_config.registry_password,[0m
[30;1m158 | [0m[35m                type=docker_config.registry_type)[0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35mdef get_latest_tag_for_service(service_config: ServiceConfig, system_config: SystemConfig, logger: L[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m154 | [0m[35m                        use_fic=registry.use_fic)[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m    # Otherwise return what's configured for the service[0m
[30;1m157 | [0m[35m    return dict(username=docker_config.registry_username, password=docker_config.registry_password,[0m
[30;1m158 | [0m[35m                type=docker_config.registry_type)[0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35mdef get_latest_tag_for_service(service_config: ServiceConfig, system_config: SystemConfig, logger: L[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m150 | [0m[35m    for registry in registries:[0m
[30;1m151 | [0m[35m        if server.startswith(registry.name):[0m
[30;1m152 | [0m[35m            # Return authentication credentials and the type of registry[0m
[30;1m153 | [0m[35m            return dict(username=registry.username, password=registry.password, type=registry.type,[0m
[30;1m154 | [0m[35m                        use_fic=registry.use_fic)[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m    # Otherwise return what's configured for the service[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m150 | [0m[35m    for registry in registries:[0m
[30;1m151 | [0m[35m        if server.startswith(registry.name):[0m
[30;1m152 | [0m[35m            # Return authentication credentials and the type of registry[0m
[30;1m153 | [0m[35m            return dict(username=registry.username, password=registry.password, type=registry.type,[0m
[30;1m154 | [0m[35m                        use_fic=registry.use_fic)[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m    # Otherwise return what's configured for the service[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35m    # The docker auth string is the base64'd username and password with a : to separate them[0m
[30;1m208 | [0m[35m    bin_u_pass = f"{username}:{password}".encode()[0m
[30;1m209 | [0m[35m    auth_string = base64.b64encode(bin_u_pass).decode()[0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m    # Return a string form that matches docker's config.json format[0m
[30;1m212 | [0m[35m    return json.dumps({[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m204 | [0m[35m    else:[0m
[30;1m205 | [0m[35m        server_name = 'https://index.docker.io/v1/'[0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35m    # The docker auth string is the base64'd username and password with a : to separate them[0m
[30;1m208 | [0m[35m    bin_u_pass = f"{username}:{password}".encode()[0m
[30;1m209 | [0m[35m    auth_string = base64.b64encode(bin_u_pass).decode()[0m
[30;1m210 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m8 | [0m[35mimport weakref[0m
[30;1m9 | [0m[35mimport urllib3[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mfrom base64 import b64encode[0m
[30;1m12 | [0m[35mfrom cryptography import x509[0m
[30;1m13 | [0m[35mfrom cryptography.hazmat.primitives.asymmetric import rsa[0m
[30;1m14 | [0m[35mfrom cryptography.hazmat.primitives import serialization, hashes[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mfrom __future__ import annotations[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport functools[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35mimport uuid[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1055 | [0m[35m                with open(AL_ROOT_CA_PK, 'rb') as root_ca_pk:[0m
[30;1m1056 | [0m[35m                    rootca_pk = serialization.load_pem_private_key(root_ca_pk.read(), None)[0m
[30;1m1057 | [0m[35m[0m
[30;1m1058 | [0m[35m                cert_key = rsa.generate_private_key(65537, 2048)[0m
[30;1m1059 | [0m[35m                cert = x509.CertificateBuilder([0m
[30;1m1060 | [0m[35m                    issuer_name=rootca_cert.issuer,[0m
[30;1m1061 | [0m[35m                    subject_name=x509.Name([x509.NameAttribute(x509.OID_COMMON_NAME, deployment_name[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1053 | [0m[35m                with open(AL_ROOT_CA, 'rb') as root_ca:[0m
[30;1m1054 | [0m[35m                    rootca_cert = x509.load_pem_x509_certificate(root_ca.read())[0m
[30;1m1055 | [0m[35m                with open(AL_ROOT_CA_PK, 'rb') as root_ca_pk:[0m
[30;1m1056 | [0m[35m                    rootca_pk = serialization.load_pem_private_key(root_ca_pk.read(), None)[0m
[30;1m1057 | [0m[35m[0m
[30;1m1058 | [0m[35m                cert_key = rsa.generate_private_key(65537, 2048)[0m
[30;1m1059 | [0m[35m                cert = x509.CertificateBuilder([0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m797 | [0m[35m                    '.dockerconfigjson': create_docker_auth_config([0m
[30;1m798 | [0m[35m                        image=docker_config.image,[0m
[30;1m799 | [0m[35m                        username=docker_config.registry_username,[0m
[30;1m800 | [0m[35m                        password=docker_config.registry_password,[0m
[30;1m801 | [0m[35m                    )[0m
[30;1m802 | [0m[35m                }[0m
[30;1m803 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m797 | [0m[35m                    '.dockerconfigjson': create_docker_auth_config([0m
[30;1m798 | [0m[35m                        image=docker_config.image,[0m
[30;1m799 | [0m[35m                        username=docker_config.registry_username,[0m
[30;1m800 | [0m[35m                        password=docker_config.registry_password,[0m
[30;1m801 | [0m[35m                    )[0m
[30;1m802 | [0m[35m                }[0m
[30;1m803 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m787 | [0m[35m                raise[0m
[30;1m788 | [0m[35m            current_pull_secret = None[0m
[30;1m789 | [0m[35m[0m
[30;1m790 | [0m[35m        if docker_config.registry_username or docker_config.registry_password:[0m
[30;1m791 | [0m[35m            use_pull_secret = True[0m
[30;1m792 | [0m[35m            # Build the secret we want to make[0m
[30;1m793 | [0m[35m            new_pull_secret = V1Secret([0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m776 | [0m[35m[0m
[30;1m777 | [0m[35m        # If we have been given a username or password for the registry, we have to[0m
[30;1m778 | [0m[35m        # update it, if we haven't been, make sure its been cleaned up in the system[0m
[30;1m779 | [0m[35m        # so we don't leave passwords lying around[0m
[30;1m780 | [0m[35m        pull_secret_name = f'{deployment_name}-container-pull-secret'[0m
[30;1m781 | [0m[35m        use_pull_secret = False[0m
[30;1m782 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m774 | [0m[35m            if error.status != 404:[0m
[30;1m775 | [0m[35m                raise[0m
[30;1m776 | [0m[35m[0m
[30;1m777 | [0m[35m        # If we have been given a username or password for the registry, we have to[0m
[30;1m778 | [0m[35m        # update it, if we haven't been, make sure its been cleaned up in the system[0m
[30;1m779 | [0m[35m        # so we don't leave passwords lying around[0m
[30;1m780 | [0m[35m        pull_secret_name = f'{deployment_name}-container-pull-secret'[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m205 | [0m[35m        server_name = 'https://index.docker.io/v1/'[0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35m    # The docker auth string is the base64'd username and password with a : to separate them[0m
[30;1m208 | [0m[35m    bin_u_pass = f"{username}:{password}".encode()[0m
[30;1m209 | [0m[35m    auth_string = base64.b64encode(bin_u_pass).decode()[0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35m    # Return a string form that matches docker's config.json format[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m204 | [0m[35m    else:[0m
[30;1m205 | [0m[35m        server_name = 'https://index.docker.io/v1/'[0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35m    # The docker auth string is the base64'd username and password with a : to separate them[0m
[30;1m208 | [0m[35m    bin_u_pass = f"{username}:{password}".encode()[0m
[30;1m209 | [0m[35m    auth_string = base64.b64encode(bin_u_pass).decode()[0m
[30;1m210 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m195 | [0m[35m    return cpu_value, memory_value[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35mdef create_docker_auth_config(image: str, username: str, password: str) -> str:[0m
[30;1m199 | [0m[35m    # Take the registry part of the image if set, use the default registry if no registry component [0m
[30;1m200 | [0m[35m    if '/' in image:[0m
[30;1m201 | [0m[35m        server_name = image.rpartition('/')[0][0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1174 | [0m[35m[0m
[30;1m1175 | [0m[35m        # Add entries to the environment variable list to point to this container[0m
[30;1m1176 | [0m[35m        self._service_limited_env[service_name][f'{container_name}_host'] = deployment_name[0m
[30;1m1177 | [0m[35m        self._service_limited_env[service_name][f'{container_name}_key'] = instance_key[0m
[30;1m1178 | [0m[35m        if spec.container.ports:[0m
[30;1m1179 | [0m[35m            self._service_limited_env[service_name][f'{container_name}_port'] = spec.container.ports[0m
[30;1m1180 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1146 | [0m[35m[0m
[30;1m1147 | [0m[35m        # Setup the deployment itself[0m
[30;1m1148 | [0m[35m        labels['container'] = container_name[0m
[30;1m1149 | [0m[35m        spec.container.environment.append({'name': 'AL_INSTANCE_KEY', 'value': instance_key})[0m
[30;1m1150 | [0m[35m        self._create_deployment(service_name, deployment_name, spec.container,[0m
[30;1m1151 | [0m[35m                                30, 1, labels, volumes=volumes, mounts=mounts, high_priority=True,[0m
[30;1m1152 | [0m[35m                                core_mounts=spec.run_as_core, change_key=change_key,[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1137 | [0m[35m            old_deployment = self.apps_api.read_namespaced_deployment(deployment_name, self.namespac[0m
[30;1m1138 | [0m[35m            for container in old_deployment.spec.template.spec.containers:[0m
[30;1m1139 | [0m[35m                for env in container.env:[0m
[30;1m1140 | [0m[35m                    if env.name == 'AL_INSTANCE_KEY':[0m
[30;1m1141 | [0m[35m                        instance_key = env.value[0m
[30;1m1142 | [0m[35m                        break[0m
[30;1m1143 | [0m[35m        except ApiException as error:[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1022 | [0m[35m        labels += sorted([(_v.name, _v.value) for _v in spec.container.labels])[0m
[30;1m1023 | [0m[35m        temp_spec = DependencyConfig(spec.as_primitives())[0m
[30;1m1024 | [0m[35m        volumes, mounts, _ = self._get_volumes_mounts_strategy(deployment_name, container_name, temp[0m
[30;1m1025 | [0m[35m        temp_spec.container.environment.append(dict(name='AL_INSTANCE_KEY', value=container_key))[0m
[30;1m1026 | [0m[35m        change_key = str(f"n={deployment_name}{change_key}dc={temp_spec.container}ss={30}"[0m
[30;1m1027 | [0m[35m                         f"l={labels}v={volumes}m={mounts}cm={True}senv={senv}")[0m
[30;1m1028 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m1001 | [0m[35m            old_deployment: V1Deployment = self.apps_api.read_namespaced_deployment(deployment_name,[0m
[30;1m1002 | [0m[35m            for container in old_deployment.spec.template.spec.containers:[0m
[30;1m1003 | [0m[35m                for env in container.env:[0m
[30;1m1004 | [0m[35m                    if env.name == 'AL_INSTANCE_KEY':[0m
[30;1m1005 | [0m[35m                        self._service_limited_env[service_name][f'{container_name}_host'] = deployme[0m
[30;1m1006 | [0m[35m                        self._service_limited_env[service_name][f'{container_name}_key'] = env.value[0m
[30;1m1007 | [0m[35m                        if spec.container.ports:[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m56 | [0m[35m)[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35mAL_ROOT_CA = os.environ.get('AL_ROOT_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m59 | [0m[35mAL_ROOT_CA_PK = os.environ.get('AL_ROOT_CA_PK', '/etc/assemblyline/ssl/al_root-ca.key')[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m_exponents = {[0m
[30;1m62 | [0m[35m    'ki': 2**10,[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m55 | [0m[35m    seccomp_profile=V1SeccompProfile(type="RuntimeDefault")[0m
[30;1m56 | [0m[35m)[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35mAL_ROOT_CA = os.environ.get('AL_ROOT_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m59 | [0m[35mAL_ROOT_CA_PK = os.environ.get('AL_ROOT_CA_PK', '/etc/assemblyline/ssl/al_root-ca.key')[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m_exponents = {[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m45 | [0m[35mSERVICE_LIVENESS_TIMEOUT = int(os.environ.get('SERVICE_LIVENESS_TIMEOUT', 60))[0m
[30;1m46 | [0m[35mUNPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('UNPRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m
[30;1m47 | [0m[35mPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('PRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m
[30;1m48 | [0m[35mCERTIFICATE_VALIDITY_PERIOD = int(os.environ.get('CERTIFICATE_VALIDITY_PERIOD', '36500'))[0m
[30;1m49 | [0m[35mRESTRICTED_POD_SECURITY_CONTEXT = V1SecurityContext([0m
[30;1m50 | [0m[35m    run_as_user=1000,[0m
[30;1m51 | [0m[35m    run_as_group=1000,[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m44 | [0m[35mSERVICE_LIVENESS_PERIOD = int(os.environ.get('SERVICE_LIVENESS_PERIOD', 300))[0m
[30;1m45 | [0m[35mSERVICE_LIVENESS_TIMEOUT = int(os.environ.get('SERVICE_LIVENESS_TIMEOUT', 60))[0m
[30;1m46 | [0m[35mUNPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('UNPRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m
[30;1m47 | [0m[35mPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('PRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m
[30;1m48 | [0m[35mCERTIFICATE_VALIDITY_PERIOD = int(os.environ.get('CERTIFICATE_VALIDITY_PERIOD', '36500'))[0m
[30;1m49 | [0m[35mRESTRICTED_POD_SECURITY_CONTEXT = V1SecurityContext([0m
[30;1m50 | [0m[35m    run_as_user=1000,[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m43 | [0m[35mCONTAINER_RESTART_THRESHOLD = int(os.environ.get('CONTAINER_RESTART_THRESHOLD', 1))[0m
[30;1m44 | [0m[35mSERVICE_LIVENESS_PERIOD = int(os.environ.get('SERVICE_LIVENESS_PERIOD', 300))[0m
[30;1m45 | [0m[35mSERVICE_LIVENESS_TIMEOUT = int(os.environ.get('SERVICE_LIVENESS_TIMEOUT', 60))[0m
[30;1m46 | [0m[35mUNPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('UNPRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m
[30;1m47 | [0m[35mPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('PRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m
[30;1m48 | [0m[35mCERTIFICATE_VALIDITY_PERIOD = int(os.environ.get('CERTIFICATE_VALIDITY_PERIOD', '36500'))[0m
[30;1m49 | [0m[35mRESTRICTED_POD_SECURITY_CONTEXT = V1SecurityContext([0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m42 | [0m[35mDEV_MODE = os.environ.get('DEV_MODE', 'false').lower() == 'true'[0m
[30;1m43 | [0m[35mCONTAINER_RESTART_THRESHOLD = int(os.environ.get('CONTAINER_RESTART_THRESHOLD', 1))[0m
[30;1m44 | [0m[35mSERVICE_LIVENESS_PERIOD = int(os.environ.get('SERVICE_LIVENESS_PERIOD', 300))[0m
[30;1m45 | [0m[35mSERVICE_LIVENESS_TIMEOUT = int(os.environ.get('SERVICE_LIVENESS_TIMEOUT', 60))[0m
[30;1m46 | [0m[35mUNPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('UNPRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m
[30;1m47 | [0m[35mPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('PRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m
[30;1m48 | [0m[35mCERTIFICATE_VALIDITY_PERIOD = int(os.environ.get('CERTIFICATE_VALIDITY_PERIOD', '36500'))[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m41 | [0m[35mCHANGE_KEY_NAME = 'al_change_key'[0m
[30;1m42 | [0m[35mDEV_MODE = os.environ.get('DEV_MODE', 'false').lower() == 'true'[0m
[30;1m43 | [0m[35mCONTAINER_RESTART_THRESHOLD = int(os.environ.get('CONTAINER_RESTART_THRESHOLD', 1))[0m
[30;1m44 | [0m[35mSERVICE_LIVENESS_PERIOD = int(os.environ.get('SERVICE_LIVENESS_PERIOD', 300))[0m
[30;1m45 | [0m[35mSERVICE_LIVENESS_TIMEOUT = int(os.environ.get('SERVICE_LIVENESS_TIMEOUT', 60))[0m
[30;1m46 | [0m[35mUNPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('UNPRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m
[30;1m47 | [0m[35mPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('PRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m40 | [0m[35mWATCH_API_TIMEOUT = WATCH_TIMEOUT + 10[0m
[30;1m41 | [0m[35mCHANGE_KEY_NAME = 'al_change_key'[0m
[30;1m42 | [0m[35mDEV_MODE = os.environ.get('DEV_MODE', 'false').lower() == 'true'[0m
[30;1m43 | [0m[35mCONTAINER_RESTART_THRESHOLD = int(os.environ.get('CONTAINER_RESTART_THRESHOLD', 1))[0m
[30;1m44 | [0m[35mSERVICE_LIVENESS_PERIOD = int(os.environ.get('SERVICE_LIVENESS_PERIOD', 300))[0m
[30;1m45 | [0m[35mSERVICE_LIVENESS_TIMEOUT = int(os.environ.get('SERVICE_LIVENESS_TIMEOUT', 60))[0m
[30;1m46 | [0m[35mUNPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('UNPRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m39 | [0m[35mWATCH_TIMEOUT = 10 * 60[0m
[30;1m40 | [0m[35mWATCH_API_TIMEOUT = WATCH_TIMEOUT + 10[0m
[30;1m41 | [0m[35mCHANGE_KEY_NAME = 'al_change_key'[0m
[30;1m42 | [0m[35mDEV_MODE = os.environ.get('DEV_MODE', 'false').lower() == 'true'[0m
[30;1m43 | [0m[35mCONTAINER_RESTART_THRESHOLD = int(os.environ.get('CONTAINER_RESTART_THRESHOLD', 1))[0m
[30;1m44 | [0m[35mSERVICE_LIVENESS_PERIOD = int(os.environ.get('SERVICE_LIVENESS_PERIOD', 300))[0m
[30;1m45 | [0m[35mSERVICE_LIVENESS_TIMEOUT = int(os.environ.get('SERVICE_LIVENESS_TIMEOUT', 60))[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35mfrom assemblyline_core.scaler.controllers.interface import ControllerInterface[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m# RESERVE_MEMORY_PER_NODE = os.environ.get('RESERVE_MEMORY_PER_NODE')[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35mAPI_TIMEOUT = 90[0m
[30;1m39 | [0m[35mWATCH_TIMEOUT = 10 * 60[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/replay/replay.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m10 | [0m[35mfrom assemblyline.odm.models.replay import ReplayConfig[0m
[30;1m11 | [0m[35mfrom assemblyline_core.server_base import ServerBase[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mCONFIG_PATH = os.environ.get('REPLAY_CONFIG_PATH', '/etc/assemblyline/replay.yml')[0m
[30;1m14 | [0m[35mINPUT_TYPES = ['alert', 'badlist', 'safelist', 'signature', 'submission', 'workflow'][0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m567 | [0m[35m        if service.container_config.registry_username or service.container_config.registry_password:[0m
[30;1m568 | [0m[35m            auth_config = {[0m
[30;1m569 | [0m[35m                'username': service.container_config.registry_username,[0m
[30;1m570 | [0m[35m                'password': service.container_config.registry_password[0m
[30;1m571 | [0m[35m            }[0m
[30;1m572 | [0m[35m[0m
[30;1m573 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m567 | [0m[35m        if service.container_config.registry_username or service.container_config.registry_password:[0m
[30;1m568 | [0m[35m            auth_config = {[0m
[30;1m569 | [0m[35m                'username': service.container_config.registry_username,[0m
[30;1m570 | [0m[35m                'password': service.container_config.registry_password[0m
[30;1m571 | [0m[35m            }[0m
[30;1m572 | [0m[35m[0m
[30;1m573 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m564 | [0m[35m[0m
[30;1m565 | [0m[35m        # Add auth info if we have it[0m
[30;1m566 | [0m[35m        auth_config = None[0m
[30;1m567 | [0m[35m        if service.container_config.registry_username or service.container_config.registry_password:[0m
[30;1m568 | [0m[35m            auth_config = {[0m
[30;1m569 | [0m[35m                'username': service.container_config.registry_username,[0m
[30;1m570 | [0m[35m                'password': service.container_config.registry_password[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m512 | [0m[35m        spec.container.environment.append({'name': 'AL_INSTANCE_KEY', 'value': instance_key})[0m
[30;1m513 | [0m[35m[0m
[30;1m514 | [0m[35m        self._service_limited_env[service_name][f'{container_name}_host'] = deployment_name[0m
[30;1m515 | [0m[35m        self._service_limited_env[service_name][f'{container_name}_key'] = instance_key[0m
[30;1m516 | [0m[35m        if spec.container.ports:[0m
[30;1m517 | [0m[35m            self._service_limited_env[service_name][f'{container_name}_port'] = spec.container.ports[0m
[30;1m518 | [0m[35m        self._start_container(service_name=service_name, name=deployment_name, labels=all_labels,[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m509 | [0m[35m        })[0m
[30;1m510 | [0m[35m        all_labels.update(labels)[0m
[30;1m511 | [0m[35m[0m
[30;1m512 | [0m[35m        spec.container.environment.append({'name': 'AL_INSTANCE_KEY', 'value': instance_key})[0m
[30;1m513 | [0m[35m[0m
[30;1m514 | [0m[35m        self._service_limited_env[service_name][f'{container_name}_host'] = deployment_name[0m
[30;1m515 | [0m[35m        self._service_limited_env[service_name][f'{container_name}_key'] = instance_key[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m477 | [0m[35m                    and old_container.labels.get(CHANGE_KEY_NAME) == change_check \[0m
[30;1m478 | [0m[35m                    and old_container.status == 'running':[0m
[30;1m479 | [0m[35m                self._service_limited_env[service_name][f'{container_name}_host'] = deployment_name[0m
[30;1m480 | [0m[35m                self._service_limited_env[service_name][f'{container_name}_key'] = instance_key[0m
[30;1m481 | [0m[35m                if spec.container.ports:[0m
[30;1m482 | [0m[35m                    self._service_limited_env[service_name][f'{container_name}_port'] = spec.contain[0m
[30;1m483 | [0m[35m                return[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m469 | [0m[35m            old_container = self.client.containers.get(deployment_name)[0m
[30;1m470 | [0m[35m[0m
[30;1m471 | [0m[35m            for env in old_container.attrs["Config"]["Env"]:[0m
[30;1m472 | [0m[35m                if env.startswith("AL_INSTANCE_KEY="):[0m
[30;1m473 | [0m[35m                    instance_key = env.split("=")[1][0m
[30;1m474 | [0m[35m                    break[0m
[30;1m475 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m448 | [0m[35m                    and old_container.labels.get(CHANGE_KEY_NAME) == change_check \[0m
[30;1m449 | [0m[35m                    and old_container.status == 'running':[0m
[30;1m450 | [0m[35m                self._service_limited_env[service_name][f'{container_name}_host'] = deployment_name[0m
[30;1m451 | [0m[35m                self._service_limited_env[service_name][f'{container_name}_key'] = instance_key[0m
[30;1m452 | [0m[35m                if spec.container.ports:[0m
[30;1m453 | [0m[35m                    self._service_limited_env[service_name][f'{container_name}_port'] = spec.contain[0m
[30;1m454 | [0m[35m                return instance_key[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m440 | [0m[35m            old_container = self.client.containers.get(deployment_name)[0m
[30;1m441 | [0m[35m[0m
[30;1m442 | [0m[35m            for env in old_container.attrs["Config"]["Env"]:[0m
[30;1m443 | [0m[35m                if env.startswith("AL_INSTANCE_KEY="):[0m
[30;1m444 | [0m[35m                    instance_key = env.split("=")[1][0m
[30;1m445 | [0m[35m                    break[0m
[30;1m446 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m27 | [0m[35m][0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mSERVICE_LIVENESS_PERIOD = int(os.environ.get('SERVICE_LIVENESS_PERIOD', 300)) * 1000000000[0m
[30;1m30 | [0m[35mSERVICE_LIVENESS_TIMEOUT = int(os.environ.get('SERVICE_LIVENESS_TIMEOUT', 60)) * 1000000000[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35mclass DockerController(ControllerInterface):[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m26 | [0m[35m    "com.docker.compose.project.version",[0m
[30;1m27 | [0m[35m][0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mSERVICE_LIVENESS_PERIOD = int(os.environ.get('SERVICE_LIVENESS_PERIOD', 300)) * 1000000000[0m
[30;1m30 | [0m[35mSERVICE_LIVENESS_TIMEOUT = int(os.environ.get('SERVICE_LIVENESS_TIMEOUT', 60)) * 1000000000[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m17 | [0m[35mNETWORK_REFRESH_INTERVAL = 60 * 3[0m
[30;1m18 | [0m[35mCHANGE_KEY_NAME = 'al_change_key'[0m
[30;1m19 | [0m[35mAL_CORE_NETWORK = os.environ.get("AL_CORE_NETWORK", 'al_core')[0m
[30;1m20 | [0m[35mCOMPOSE_PROJECT = os.environ.get('COMPOSE_PROJECT_NAME', None)[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mCOPY_LABELS = [[0m
[30;1m23 | [0m[35m    "com.docker.compose.config-hash",[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m16 | [0m[35m# Every this many seconds, check that the services can actually reach the service server.[0m
[30;1m17 | [0m[35mNETWORK_REFRESH_INTERVAL = 60 * 3[0m
[30;1m18 | [0m[35mCHANGE_KEY_NAME = 'al_change_key'[0m
[30;1m19 | [0m[35mAL_CORE_NETWORK = os.environ.get("AL_CORE_NETWORK", 'al_core')[0m
[30;1m20 | [0m[35mCOMPOSE_PROJECT = os.environ.get('COMPOSE_PROJECT_NAME', None)[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mCOPY_LABELS = [[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1399 | [0m[35m            }[0m
[30;1m1400 | [0m[35m        },[0m
[30;1m1401 | [0m[35m        'core-a': {'lock': 60},[0m
[30;1m1402 | [0m[35m        'finish': {'temporary_data': {'passwords': ['test_temp_data_monitoring']}},[0m
[30;1m1403 | [0m[35m    })[0m
[30;1m1404 | [0m[35m[0m
[30;1m1405 | [0m[35m    core.ingest_queue.push(SubmissionInput(dict([0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1384 | [0m[35m    dispatcher.TIMEOUT_EXTRA_TIME = 100[0m
[30;1m1385 | [0m[35m[0m
[30;1m1386 | [0m[35m    child_sha, _ = ready_body(core, {[0m
[30;1m1387 | [0m[35m        'pre': {'partial': {'passwords': 'test_temp_data_monitoring'}},[0m
[30;1m1388 | [0m[35m    })[0m
[30;1m1389 | [0m[35m[0m
[30;1m1390 | [0m[35m    sha, size = ready_body(core, {[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1380 | [0m[35m    # stages to this processing when everything goes well[0m
[30;1m1381 | [0m[35m    # 1. extract a file that will process to produce a partial result[0m
[30;1m1382 | [0m[35m    # 2. hold a few seconds on the second stage of the root file to let child start[0m
[30;1m1383 | [0m[35m    # 3. on the last stage of the root file produce the password[0m
[30;1m1384 | [0m[35m    dispatcher.TIMEOUT_EXTRA_TIME = 100[0m
[30;1m1385 | [0m[35m[0m
[30;1m1386 | [0m[35m    child_sha, _ = ready_body(core, {[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1298 | [0m[35m    # c) core-b finishes and should trigger a rerun with the data to produce a full result[0m
[30;1m1299 | [0m[35m    sha, size = ready_body(core, {[0m
[30;1m1300 | [0m[35m        'core-a': {'local_lock': 10, 'temporary_data': {'passwords': ['test_temp_data_monitoring']}}[0m
[30;1m1301 | [0m[35m        'core-b': {'local_lock': 10, 'partial': {'passwords': 'test_temp_data_monitoring'}},[0m
[30;1m1302 | [0m[35m    })[0m
[30;1m1303 | [0m[35m[0m
[30;1m1304 | [0m[35m    core_a = [s for s in core.services if s.service_name == 'core-a'][0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1297 | [0m[35m    # b) core-a finishes before core-b adding the temporary data to the dispatcher[0m
[30;1m1298 | [0m[35m    # c) core-b finishes and should trigger a rerun with the data to produce a full result[0m
[30;1m1299 | [0m[35m    sha, size = ready_body(core, {[0m
[30;1m1300 | [0m[35m        'core-a': {'local_lock': 10, 'temporary_data': {'passwords': ['test_temp_data_monitoring']}}[0m
[30;1m1301 | [0m[35m        'core-b': {'local_lock': 10, 'partial': {'passwords': 'test_temp_data_monitoring'}},[0m
[30;1m1302 | [0m[35m    })[0m
[30;1m1303 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1238 | [0m[35m    sha, size = ready_body(core, {[0m
[30;1m1239 | [0m[35m        'pre': {'partial': {'passwords': 'test_temp_data_monitoring'}},[0m
[30;1m1240 | [0m[35m        'core-a': {'temporary_data': {'passwords': ['test_temp_data_monitoring']}},[0m
[30;1m1241 | [0m[35m        'final': {'temporary_data': {'passwords': ['some other password']}},[0m
[30;1m1242 | [0m[35m    })[0m
[30;1m1243 | [0m[35m[0m
[30;1m1244 | [0m[35m    core.ingest_queue.push(SubmissionInput(dict([0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1238 | [0m[35m    sha, size = ready_body(core, {[0m
[30;1m1239 | [0m[35m        'pre': {'partial': {'passwords': 'test_temp_data_monitoring'}},[0m
[30;1m1240 | [0m[35m        'core-a': {'temporary_data': {'passwords': ['test_temp_data_monitoring']}},[0m
[30;1m1241 | [0m[35m        'final': {'temporary_data': {'passwords': ['some other password']}},[0m
[30;1m1242 | [0m[35m    })[0m
[30;1m1243 | [0m[35m[0m
[30;1m1244 | [0m[35m    core.ingest_queue.push(SubmissionInput(dict([0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1237 | [0m[35m    # Have pre produce a partial result, then have core-a update a monitored key[0m
[30;1m1238 | [0m[35m    sha, size = ready_body(core, {[0m
[30;1m1239 | [0m[35m        'pre': {'partial': {'passwords': 'test_temp_data_monitoring'}},[0m
[30;1m1240 | [0m[35m        'core-a': {'temporary_data': {'passwords': ['test_temp_data_monitoring']}},[0m
[30;1m1241 | [0m[35m        'final': {'temporary_data': {'passwords': ['some other password']}},[0m
[30;1m1242 | [0m[35m    })[0m
[30;1m1243 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1236 | [0m[35mdef test_temp_data_monitoring(core: CoreSession, metrics):[0m
[30;1m1237 | [0m[35m    # Have pre produce a partial result, then have core-a update a monitored key[0m
[30;1m1238 | [0m[35m    sha, size = ready_body(core, {[0m
[30;1m1239 | [0m[35m        'pre': {'partial': {'passwords': 'test_temp_data_monitoring'}},[0m
[30;1m1240 | [0m[35m        'core-a': {'temporary_data': {'passwords': ['test_temp_data_monitoring']}},[0m
[30;1m1241 | [0m[35m        'final': {'temporary_data': {'passwords': ['some other password']}},[0m
[30;1m1242 | [0m[35m    })[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m1186 | [0m[35mdef test_partial(core: CoreSession, metrics):[0m
[30;1m1187 | [0m[35m    # Have pre produce a partial result, then have core-a update a monitored key[0m
[30;1m1188 | [0m[35m    sha, size = ready_body(core, {[0m
[30;1m1189 | [0m[35m        'pre': {'partial': {'passwords': 'test_temp_data_monitoring'}},[0m
[30;1m1190 | [0m[35m    })[0m
[30;1m1191 | [0m[35m[0m
[30;1m1192 | [0m[35m    core.ingest_queue.push(SubmissionInput(dict([0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m263 | [0m[35m    service_config: list[tuple[str, int, str, dict]] = [[0m
[30;1m264 | [0m[35m        ('pre', 1, 'EXTRACT', {'extra_data': True, 'monitored_keys': ['passwords']}),[0m
[30;1m265 | [0m[35m        ('core-a', 2, 'CORE', {}),[0m
[30;1m266 | [0m[35m        ('core-b', 1, 'CORE', {'extra_data': True, 'monitored_keys': ['passwords']}),[0m
[30;1m267 | [0m[35m        ('finish', 1, 'POST', {'extra_data': True})[0m
[30;1m268 | [0m[35m    ][0m
[30;1m269 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m261 | [0m[35m    stages = get_service_stage_hash(redis)[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m    service_config: list[tuple[str, int, str, dict]] = [[0m
[30;1m264 | [0m[35m        ('pre', 1, 'EXTRACT', {'extra_data': True, 'monitored_keys': ['passwords']}),[0m
[30;1m265 | [0m[35m        ('core-a', 2, 'CORE', {}),[0m
[30;1m266 | [0m[35m        ('core-b', 1, 'CORE', {'extra_data': True, 'monitored_keys': ['passwords']}),[0m
[30;1m267 | [0m[35m        ('finish', 1, 'POST', {'extra_data': True})[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m27 | [0m[35mNON_AGGREGATED_COUNTERS = {'dispatcher': {'save_queue', 'error_queue'}}[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mMETRICSTORE_ROOT_CA_PATH = environ.get('METRICSTORE_ROOT_CA_PATH', '/etc/assemblyline/ssl/al_root-ca[0m
[30;1m30 | [0m[35mMETRICSTORE_VERIFY_CERTS = environ.get('METRICSTORE_VERIFY_CERTS', 'true').lower() == "true"[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35mdef cleanup_metrics(input_dict):[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m26 | [0m[35mNON_AGGREGATED = ['scaler', 'scaler_status'][0m
[30;1m27 | [0m[35mNON_AGGREGATED_COUNTERS = {'dispatcher': {'save_queue', 'error_queue'}}[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mMETRICSTORE_ROOT_CA_PATH = environ.get('METRICSTORE_ROOT_CA_PATH', '/etc/assemblyline/ssl/al_root-ca[0m
[30;1m30 | [0m[35mMETRICSTORE_VERIFY_CERTS = environ.get('METRICSTORE_VERIFY_CERTS', 'true').lower() == "true"[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/replay/creator/run_worker.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m9 | [0m[35mfrom assemblyline_core.replay.client import APIClient, DirectClient[0m
[30;1m10 | [0m[35mfrom assemblyline_core.replay.replay import ReplayBase, INPUT_TYPES[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mREPLAY_BATCH_SIZE = int(os.environ.get("REPLAY_BATCH_SIZE", "1000"))[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mclass ReplayCreatorWorker(ReplayBase):[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/es_metrics.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mMETRICSTORE_ROOT_CA_PATH = environ.get('METRICSTORE_ROOT_CA_PATH', '/etc/assemblyline/ssl/al_root-ca[0m
[30;1m20 | [0m[35mMETRICSTORE_VERIFY_CERTS = environ.get('METRICSTORE_VERIFY_CERTS', 'true').lower() == "true"[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mclass ESMetricsServer(ServerBase):[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/es_metrics.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m16 | [0m[35mfrom assemblyline_core.server_base import ServerBase[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mMETRICSTORE_ROOT_CA_PATH = environ.get('METRICSTORE_ROOT_CA_PATH', '/etc/assemblyline/ssl/al_root-ca[0m
[30;1m20 | [0m[35mMETRICSTORE_VERIFY_CERTS = environ.get('METRICSTORE_VERIFY_CERTS', 'true').lower() == "true"[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m58 | [0m[35mHOUR_IN_SECONDS = 60 * 60[0m
[30;1m59 | [0m[35mCOMPLETE_THREADS = int(environ.get('INGESTER_COMPLETE_THREADS', 4))[0m
[30;1m60 | [0m[35mINGEST_THREADS = int(environ.get('INGESTER_INGEST_THREADS', 1))[0m
[30;1m61 | [0m[35mSUBMIT_THREADS = int(environ.get('INGESTER_SUBMIT_THREADS', 4))[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35mdef must_drop(length: int, maximum: int) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m57 | [0m[35m_max_time = 2 * 24 * 60 * 60  # Wait 2 days for responses.[0m
[30;1m58 | [0m[35mHOUR_IN_SECONDS = 60 * 60[0m
[30;1m59 | [0m[35mCOMPLETE_THREADS = int(environ.get('INGESTER_COMPLETE_THREADS', 4))[0m
[30;1m60 | [0m[35mINGEST_THREADS = int(environ.get('INGESTER_INGEST_THREADS', 1))[0m
[30;1m61 | [0m[35mSUBMIT_THREADS = int(environ.get('INGESTER_SUBMIT_THREADS', 4))[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m56 | [0m[35m_retry_delay = 60 * 4  # Wait 4 minutes to retry[0m
[30;1m57 | [0m[35m_max_time = 2 * 24 * 60 * 60  # Wait 2 days for responses.[0m
[30;1m58 | [0m[35mHOUR_IN_SECONDS = 60 * 60[0m
[30;1m59 | [0m[35mCOMPLETE_THREADS = int(environ.get('INGESTER_COMPLETE_THREADS', 4))[0m
[30;1m60 | [0m[35mINGEST_THREADS = int(environ.get('INGESTER_INGEST_THREADS', 1))[0m
[30;1m61 | [0m[35mSUBMIT_THREADS = int(environ.get('INGESTER_SUBMIT_THREADS', 4))[0m
[30;1m62 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/archiver/run_archiver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m120 | [0m[35m                    attributions = {x['value'] for x in tags if x['type'].startswith('attribution.')[0m
[30;1m121 | [0m[35m                    techniques = {x['type'].rsplit('.', 1)[1] for x in tags if x['type'].startswith([0m
[30;1m122 | [0m[35m                    infos = {'ioc' for x in tags if x['type'] in self.config.submission.tag_types.io[0m
[30;1m123 | [0m[35m                    infos = infos.union({'password' for x in tags if x['type'] == 'info.password'})[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m                    # Create the archive file[0m
[30;1m126 | [0m[35m                    self.datastore.file.archive(sha256, delete_after=delete_after,[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/archiver/run_archiver.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m120 | [0m[35m                    attributions = {x['value'] for x in tags if x['type'].startswith('attribution.')[0m
[30;1m121 | [0m[35m                    techniques = {x['type'].rsplit('.', 1)[1] for x in tags if x['type'].startswith([0m
[30;1m122 | [0m[35m                    infos = {'ioc' for x in tags if x['type'] in self.config.submission.tag_types.io[0m
[30;1m123 | [0m[35m                    infos = infos.union({'password' for x in tags if x['type'] == 'info.password'})[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m                    # Create the archive file[0m
[30;1m126 | [0m[35m                    self.datastore.file.archive(sha256, delete_after=delete_after,[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m80 | [0m[35m    'Corrupted executable file',[0m
[30;1m81 | [0m[35m    'Encrypted container deleted',[0m
[30;1m82 | [0m[35m    'Encrypted container deleted;',[0m
[30;1m83 | [0m[35m    'Password-protected',[0m
[30;1m84 | [0m[35m    'Malformed container violation',[0m
[30;1m85 | [0m[35m)[0m
[30;1m86 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m538 | [0m[35m            # Set authentication to registry to pull the image[0m
[30;1m539 | [0m[35m            auth_config = get_registry_config(docker_config, self.config)[0m
[30;1m540 | [0m[35m            docker_config.registry_username = auth_config['username'][0m
[30;1m541 | [0m[35m            docker_config.registry_password = auth_config['password'][0m
[30;1m542 | [0m[35m[0m
[30;1m543 | [0m[35m            return docker_config[0m
[30;1m544 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m538 | [0m[35m            # Set authentication to registry to pull the image[0m
[30;1m539 | [0m[35m            auth_config = get_registry_config(docker_config, self.config)[0m
[30;1m540 | [0m[35m            docker_config.registry_username = auth_config['username'][0m
[30;1m541 | [0m[35m            docker_config.registry_password = auth_config['password'][0m
[30;1m542 | [0m[35m[0m
[30;1m543 | [0m[35m            return docker_config[0m
[30;1m544 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m# An environment variable that should be set when we are started with kubernetes, tells us how to at[0m
[30;1m61 | [0m[35m# the global Assemblyline config to new things that we launch.[0m
[30;1m62 | [0m[35mKUBERNETES_AL_CONFIG = os.environ.get('KUBERNETES_AL_CONFIG')[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35mHOSTNAME = os.getenv('HOSTNAME', platform.node())[0m
[30;1m65 | [0m[35mRELEASE_NAME = os.getenv('RELEASE_NAME', 'assemblyline')[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m# If you are doing development and you want the system to route jobs ignoring the service setup/tear[0m
[30;1m17 | [0m[35m# set an environment variable SKIP_SERVICE_SETUP to true for all dispatcher containers[0m
[30;1m18 | [0m[35mSKIP_SERVICE_SETUP = os.environ.get('SKIP_SERVICE_SETUP', 'false').lower() in ['true', '1'][0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mClassification = get_classification()[0m
[30;1m21 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/helper.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m68 | [0m[35m            # Get the shard/replica configuration for metric-based indices from the environment[0m
[30;1m69 | [0m[35m            # Otherwise default to values for a single-node Elastic cluster[0m
[30;1m70 | [0m[35m            replicas = environ.get(f"ELASTIC_{index_type.upper()}_METRICS_REPLICAS", environ.get('EL[0m
[30;1m71 | [0m[35m            shards = environ.get(f"ELASTIC_{index_type.upper()}_METRICS_SHARDS", environ.get('ELASTI[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m            index = f"al_metrics_{index_type}_ds" if datastream_enabled else f"al_metrics_{index_typ[0m
[30;1m74 | [0m[35m            policy = f"{index}_policy"[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/helper.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m68 | [0m[35m            # Get the shard/replica configuration for metric-based indices from the environment[0m
[30;1m69 | [0m[35m            # Otherwise default to values for a single-node Elastic cluster[0m
[30;1m70 | [0m[35m            replicas = environ.get(f"ELASTIC_{index_type.upper()}_METRICS_REPLICAS", environ.get('EL[0m
[30;1m71 | [0m[35m            shards = environ.get(f"ELASTIC_{index_type.upper()}_METRICS_SHARDS", environ.get('ELASTI[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m            index = f"al_metrics_{index_type}_ds" if datastream_enabled else f"al_metrics_{index_typ[0m
[30;1m74 | [0m[35m            policy = f"{index}_policy"[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/helper.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m67 | [0m[35m        try:[0m
[30;1m68 | [0m[35m            # Get the shard/replica configuration for metric-based indices from the environment[0m
[30;1m69 | [0m[35m            # Otherwise default to values for a single-node Elastic cluster[0m
[30;1m70 | [0m[35m            replicas = environ.get(f"ELASTIC_{index_type.upper()}_METRICS_REPLICAS", environ.get('EL[0m
[30;1m71 | [0m[35m            shards = environ.get(f"ELASTIC_{index_type.upper()}_METRICS_SHARDS", environ.get('ELASTI[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m            index = f"al_metrics_{index_type}_ds" if datastream_enabled else f"al_metrics_{index_typ[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/helper.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m67 | [0m[35m        try:[0m
[30;1m68 | [0m[35m            # Get the shard/replica configuration for metric-based indices from the environment[0m
[30;1m69 | [0m[35m            # Otherwise default to values for a single-node Elastic cluster[0m
[30;1m70 | [0m[35m            replicas = environ.get(f"ELASTIC_{index_type.upper()}_METRICS_REPLICAS", environ.get('EL[0m
[30;1m71 | [0m[35m            shards = environ.get(f"ELASTIC_{index_type.upper()}_METRICS_SHARDS", environ.get('ELASTI[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m            index = f"al_metrics_{index_type}_ds" if datastream_enabled else f"al_metrics_{index_typ[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/replay/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m12 | [0m[35mfrom assemblyline_core.safelist_client import SafelistClient[0m
[30;1m13 | [0m[35mfrom assemblyline_core.signature_client import SignatureClient[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mEMPTY_WAIT_TIME = int(os.environ.get('EMPTY_WAIT_TIME', '30'))[0m
[30;1m16 | [0m[35mREPLAY_REQUESTED = 'requested'[0m
[30;1m17 | [0m[35mREPLAY_PENDING = 'pending'[0m
[30;1m18 | [0m[35mREPLAY_DONE = 'done'[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000804[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m["'][a-z0-9]{40,}["'][0m
[30;1m364 | [0m[35m                pass[0m
[30;1m365 | [0m[35m[0m
[30;1m366 | [0m[35m            # This is the hash of a file that is SUPPOSED to be empty, just ignore this one silently[0m
[30;1m367 | [0m[35m            if sha256 == 'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855':[0m
[30;1m368 | [0m[35m                return True[0m
[30;1m369 | [0m[35m[0m
[30;1m370 | [0m[35m        with self.timed('copy'):[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/safelist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m264 | [0m[35m                    old['classification'], src.get('classification', None))[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m            # Set the expiry[0m
[30;1m267 | [0m[35m            old['expiry_ts'] = new.get('expiry_ts', None)[0m
[30;1m268 | [0m[35m            return old[0m
[30;1m269 | [0m[35m        except Exception as e:[0m
[30;1m270 | [0m[35m            raise InvalidSafehash(f"Invalid data provided: {str(e)}")[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/safelist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m261 | [0m[35m            # Calculate the new classification[0m
[30;1m262 | [0m[35m            for src in old['sources']:[0m
[30;1m263 | [0m[35m                old['classification'] = CLASSIFICATION.max_classification([0m
[30;1m264 | [0m[35m                    old['classification'], src.get('classification', None))[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m            # Set the expiry[0m
[30;1m267 | [0m[35m            old['expiry_ts'] = new.get('expiry_ts', None)[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/safelist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m255 | [0m[35m                    for reason in src['reason']:[0m
[30;1m256 | [0m[35m                        if reason not in old_src['reason']:[0m
[30;1m257 | [0m[35m                            old_src['reason'].append(reason)[0m
[30;1m258 | [0m[35m                    old_src['classification'] = src.get('classification', old_src['classification'])[0m
[30;1m259 | [0m[35m            old['sources'] = list(old_src_map.values())[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m            # Calculate the new classification[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/safelist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m234 | [0m[35m                            old['file']['name'].append(name)[0m
[30;1m235 | [0m[35m                elif new_names:[0m
[30;1m236 | [0m[35m                    old['file']['name'] = new_names[0m
[30;1m237 | [0m[35m                old['file'].update({k: v for k, v in new.get('file', {}).items() if v})[0m
[30;1m238 | [0m[35m            elif old['type'] == 'tag':[0m
[30;1m239 | [0m[35m                old['tag'] = new['tag'][0m
[30;1m240 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/safelist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m227 | [0m[35m            # Update type specific info[0m
[30;1m228 | [0m[35m            if old['type'] == 'file':[0m
[30;1m229 | [0m[35m                old.setdefault('file', {})[0m
[30;1m230 | [0m[35m                new_names = new.get('file', {}).pop('name', [])[0m
[30;1m231 | [0m[35m                if 'name' in old['file']:[0m
[30;1m232 | [0m[35m                    for name in new_names:[0m
[30;1m233 | [0m[35m                        if name not in old['file']['name']:[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/safelist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m219 | [0m[35m            old['classification'] = new['classification'][0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m            # Update updated time[0m
[30;1m222 | [0m[35m            old['updated'] = new.get('updated', now_as_iso())[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m            # Update hashes[0m
[30;1m225 | [0m[35m            old['hashes'].update({k: v for k, v in new['hashes'].items() if v})[0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/safelist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m175 | [0m[35m            output = {[0m
[30;1m176 | [0m[35m                'match': {k: v for k, v in tag_safelist_data.get('match', {}).items()[0m
[30;1m177 | [0m[35m                          if k in tag_types or tag_types == []},[0m
[30;1m178 | [0m[35m                'regex': {k: v for k, v in tag_safelist_data.get('regex', {}).items()[0m
[30;1m179 | [0m[35m                          if k in tag_types or tag_types == []},[0m
[30;1m180 | [0m[35m            }[0m
[30;1m181 | [0m[35m            for tag in tag_types:[0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/safelist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m        if tag_types:[0m
[30;1m175 | [0m[35m            output = {[0m
[30;1m176 | [0m[35m                'match': {k: v for k, v in tag_safelist_data.get('match', {}).items()[0m
[30;1m177 | [0m[35m                          if k in tag_types or tag_types == []},[0m
[30;1m178 | [0m[35m                'regex': {k: v for k, v in tag_safelist_data.get('regex', {}).items()[0m
[30;1m179 | [0m[35m                          if k in tag_types or tag_types == []},[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/safelist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m165 | [0m[35m            tag_types = tag_types.split(',')[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m        with forge.get_cachestore('system', config=self.config, datastore=self.datastore) as cache:[0m
[30;1m168 | [0m[35m            tag_safelist_yml = cache.get('tag_safelist_yml')[0m
[30;1m169 | [0m[35m            if tag_safelist_yml:[0m
[30;1m170 | [0m[35m                tag_safelist_data = yaml.safe_load(tag_safelist_yml)[0m
[30;1m171 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/safelist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m144 | [0m[35m        plan = self.datastore.safelist.get_bulk_plan()[0m
[30;1m145 | [0m[35m        for key, val in new_data.items():[0m
[30;1m146 | [0m[35m            # Use maximum classification[0m
[30;1m147 | [0m[35m            old_val = old_data.get(key, {'classification': CLASSIFICATION.UNRESTRICTED,[0m
[30;1m148 | [0m[35m                                         'hashes': {}, 'sources': [], 'type': val['type']})[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m            # Add upsert operation[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/safelist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m            # Find the highest classification of all sources[0m
[30;1m111 | [0m[35m            safelist_object['classification'] = CLASSIFICATION.max_classification([0m
[30;1m112 | [0m[35m                safelist_object['classification'], src.get('classification', None))[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m            src_map[src['name']] = src[0m
[30;1m115 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/safelist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m        # Find the best hash to use for the key[0m
[30;1m85 | [0m[35m        for hash_key in ['sha256', 'sha1', 'md5', 'tlsh', 'ssdeep']:[0m
[30;1m86 | [0m[35m            qhash = data['hashes'].get(hash_key, None)[0m
[30;1m87 | [0m[35m            if qhash:[0m
[30;1m88 | [0m[35m                break[0m
[30;1m89 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/safelist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m            data.pop('hashes', None)[0m
[30;1m60 | [0m[35m            data.pop('tag', None)[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m            sig_data = data.get('signature', None)[0m
[30;1m63 | [0m[35m            if sig_data is None or 'name' not in sig_data:[0m
[30;1m64 | [0m[35m                raise ValueError("Signature data not found")[0m
[30;1m65 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/safelist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m            data.pop('hashes', None)[0m
[30;1m42 | [0m[35m            data.pop('signature', None)[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m            tag_data = data.get('tag', None)[0m
[30;1m45 | [0m[35m            if tag_data is None or 'type' not in tag_data or 'value' not in tag_data:[0m
[30;1m46 | [0m[35m                raise ValueError("Tag data not found")[0m
[30;1m47 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/safelist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    def _preprocess_object(self, data: dict):[0m
[30;1m30 | [0m[35m        # Remove any null classification that might already be set[0m
[30;1m31 | [0m[35m        if 'classification' in data and not data.get('classification'):[0m
[30;1m32 | [0m[35m            data.pop('classification')[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m        # Set defaults[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/safelist_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m224 | [0m[35m            # Update hashes[0m
[30;1m225 | [0m[35m            old['hashes'].update({k: v for k, v in new['hashes'].items() if v})[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m            # Update type specific info[0m
[30;1m228 | [0m[35m            if old['type'] == 'file':[0m
[30;1m229 | [0m[35m                old.setdefault('file', {})[0m
[30;1m230 | [0m[35m                new_names = new.get('file', {}).pop('name', [])[0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/safelist_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m221 | [0m[35m            # Update updated time[0m
[30;1m222 | [0m[35m            old['updated'] = new.get('updated', now_as_iso())[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m            # Update hashes[0m
[30;1m225 | [0m[35m            old['hashes'].update({k: v for k, v in new['hashes'].items() if v})[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m            # Update type specific info[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/safelist_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m218 | [0m[35m            # Use the new classification but we will recompute it later anyway[0m
[30;1m219 | [0m[35m            old['classification'] = new['classification'][0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m            # Update updated time[0m
[30;1m222 | [0m[35m            old['updated'] = new.get('updated', now_as_iso())[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m            # Update hashes[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/safelist_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m218 | [0m[35m            # Use the new classification but we will recompute it later anyway[0m
[30;1m219 | [0m[35m            old['classification'] = new['classification'][0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m            # Update updated time[0m
[30;1m222 | [0m[35m            old['updated'] = new.get('updated', now_as_iso())[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m            # Update hashes[0m
[30;1m225 | [0m[35m            old['hashes'].update({k: v for k, v in new['hashes'].items() if v})[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/safelist_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m107 | [0m[35m                    if ROLES.signature_import not in user['roles']:[0m
[30;1m108 | [0m[35m                        raise PermissionError("You do not have sufficient priviledges to add an exte[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m            # Find the highest classification of all sources[0m
[30;1m111 | [0m[35m            safelist_object['classification'] = CLASSIFICATION.max_classification([0m
[30;1m112 | [0m[35m                safelist_object['classification'], src.get('classification', None))[0m
[30;1m113 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/safelist_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m        # Set last updated[0m
[30;1m82 | [0m[35m        data['added'] = data['updated'] = now_as_iso()[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m        # Find the best hash to use for the key[0m
[30;1m85 | [0m[35m        for hash_key in ['sha256', 'sha1', 'md5', 'tlsh', 'ssdeep']:[0m
[30;1m86 | [0m[35m            qhash = data['hashes'].get(hash_key, None)[0m
[30;1m87 | [0m[35m            if qhash:[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/submission_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m231 | [0m[35m            # eg. files that are packaged, and the contained file (not the package[0m
[30;1m232 | [0m[35m            # that local_path points to) should be passed into the system.[0m
[30;1m233 | [0m[35m            extracted_path, fileinfo, al_meta = decode_file(local_path, fileinfo, self.identify)[0m
[30;1m234 | [0m[35m            al_meta['classification'] = al_meta.get('classification', classification)[0m
[30;1m235 | [0m[35m            if not Classification.is_valid(al_meta['classification']):[0m
[30;1m236 | [0m[35m                raise SubmissionException(f"{al_meta['classification']} is not a valid classificatio[0m
[30;1m237 | [0m[35m                                          ", submission is cancelled...")[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/submission_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m""" File Submission Interfaces.[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mTODO update this[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mThe Submission service encapsulates the core functionality of accepting,[0m
[30;1m6 | [0m[35mtriaging and forwarding a submission to the dispatcher.[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/submission_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m        submission['times'].pop('completed')[0m
[30;1m94 | [0m[35m        submission['state'] = 'submitted'[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m        # Set the list of service to rescan[0m
[30;1m97 | [0m[35m        submission['params']['services']['rescan'] = rescan_services[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m        # Create the submission object[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/submission_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m12 | [0m[35m  existing (submit a file that is already in the file cache/SAN)[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mIn two-phase mode, submission is a presubmit followed by a submit.[0m
[30;1m15 | [0m[35mA 'presubmit' is sent to the submission service first. If the server already[0m
[30;1m16 | [0m[35mhas a copy of the sample it indicates as such to the client which saves the[0m
[30;1m17 | [0m[35mclient from copying the file again. Once the client has copied the file[0m
[30;1m18 | [0m[35m(if required) it then issues a final 'submit'.[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/submission_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mTODO update this[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mThe Submission service encapsulates the core functionality of accepting,[0m
[30;1m6 | [0m[35mtriaging and forwarding a submission to the dispatcher.[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mThere are three primary modes of submission:[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/expiry/run_expiry.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m241 | [0m[35m            for item in collection.stream_search([0m
[30;1m242 | [0m[35m                    delete_query, fl='id,from_archive', as_obj=False, index_type=self.index_type):[0m
[30;1m243 | [0m[35m                self.heartbeat()[0m
[30;1m244 | [0m[35m                delete_objects.append((item['id'], item.get('from_archive', False)))[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m            # Filter archived documents if archive filestore is the same as the filestore[0m
[30;1m247 | [0m[35m            expire_only: list[tuple[str, bool]] = [][0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/expiry/run_expiry.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m325 | [0m[35m        return epoch_to_iso(final_date)[0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35m    def _get_next_chunk(self, collection: ESCollection, start, final_date):[0m
[30;1m328 | [0m[35m        """Find date of item at chunk size and the number of items that[0m
[30;1m329 | [0m[35m           will be affected in between start date and the date found"""[0m
[30;1m330 | [0m[35m        rows = collection.search(f"expiry_ts: {{{start} TO {final_date}]", rows=1,[0m
[30;1m331 | [0m[35m                                 offset=self.expiry_size - 1, sort='expiry_ts asc',[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/expiry/run_expiry.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m210 | [0m[35m        self.log.info(f"[{collection.name}] Deleted {number_to_delete} items from the datastore...")[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m    def _cleanup_canceled_submission(self, sid):[0m
[30;1m213 | [0m[35m        # Allowing us at minimum 5 minutes to cleanup the submission[0m
[30;1m214 | [0m[35m        self.heartbeat(int(time.time() + 5 * 60))[0m
[30;1m215 | [0m[35m        if self.apm_client:[0m
[30;1m216 | [0m[35m            self.apm_client.begin_transaction("Delete canceled submissions")[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/expiry/run_expiry.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport concurrent.futures[0m
[30;1m5 | [0m[35mimport threading[0m
[30;1m6 | [0m[35mimport functools[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom concurrent.futures import ThreadPoolExecutor, ProcessPoolExecutor, Future, as_completed[0m
[30;1m9 | [0m[35mfrom concurrent.futures.process import BrokenProcessPool[0m
[30;1m10 | [0m[35mfrom typing import Callable, Optional, TYPE_CHECKING[0m
[30;1m11 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/replay/loader/run_worker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m48 | [0m[35m                except OSError as e:[0m
[30;1m49 | [0m[35m                    # Critical exception occurred[0m
[30;1m50 | [0m[35m                    if 'Stale file handle' in str(e):[0m
[30;1m51 | [0m[35m                        # Terminate on stale file handle from NFS mount[0m
[30;1m52 | [0m[35m                        self.log.warning("Stale file handle detected. Terminating..")[0m
[30;1m53 | [0m[35m                        self.stop()[0m
[30;1m54 | [0m[35m                    elif 'Invalid cross-device link' in str(e):[0m
[30;1m55 | [0m[35m                        # Terminate on NFS-related error[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/department_map.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m            try:[0m
[30;1m54 | [0m[35m                if self.url:[0m
[30;1m55 | [0m[35m                    res = requests.get(self.url, verify=False)[0m
[30;1m56 | [0m[35m                    res.raise_for_status()[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m                    for row in res.json():[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/department_map.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport functools[0m
[30;1m2 | [0m[35mimport json[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport threading[0m
[30;1m6 | [0m[35mfrom typing import Optional[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m631 | [0m[35m                auth = update_data['auth'] or {}[0m
[30;1m632 | [0m[35m                if auth:[0m
[30;1m633 | [0m[35m                    docker_config.update(dict(registry_username=auth.get('username'),[0m
[30;1m634 | [0m[35m                                              registry_password=auth.get('password')))[0m
[30;1m635 | [0m[35m[0m
[30;1m636 | [0m[35m                # Apply any container configuration changes specifically for jobs[0m
[30;1m637 | [0m[35m                docker_config.update(self.job_dockerconfig)[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m630 | [0m[35m                # Load authentication params[0m
[30;1m631 | [0m[35m                auth = update_data['auth'] or {}[0m
[30;1m632 | [0m[35m                if auth:[0m
[30;1m633 | [0m[35m                    docker_config.update(dict(registry_username=auth.get('username'),[0m
[30;1m634 | [0m[35m                                              registry_password=auth.get('password')))[0m
[30;1m635 | [0m[35m[0m
[30;1m636 | [0m[35m                # Apply any container configuration changes specifically for jobs[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m518 | [0m[35m                        {'name': service_name,[0m
[30;1m519 | [0m[35m                         'update_channel': self.config.services.preferred_update_channel,[0m
[30;1m520 | [0m[35m                         'version': tag,[0m
[30;1m521 | [0m[35m                         'docker_config': {'image': install_data.get('image')}})[0m
[30;1m522 | [0m[35m[0m
[30;1m523 | [0m[35m                    image_name, tag_name, auth, _ = get_latest_tag_for_service([0m
[30;1m524 | [0m[35m                        service,  self.config, self.log, prefix="[CI] ")[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m        time_mark = isotime.now_as_iso(-60*5)[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m        for container in self.client.containers.list(all=True, ignore_removed=True, filters=filters)[0m
[30;1m150 | [0m[35m            if container.attrs['State'].get('FinishedAt', '9999') < time_mark:[0m
[30;1m151 | [0m[35m                container.remove()[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m    def restart(self, service_name):[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m113 | [0m[35m        self.client.images.pull(repository, tag, auth_config=auth_config)[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m        docker_mounts.update({os.path.join(row['volume'], row['source_path']): {'bind': row['dest_pa[0m
[30;1m116 | [0m[35m                                                                                'mode': row.get('mod[0m
[30;1m117 | [0m[35m                              for row in mounts})[0m
[30;1m118 | [0m[35m        # Launch container[0m
[30;1m119 | [0m[35m        container = self.client.containers.run([0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35mCONFIGURATION_HOST_PATH = os.getenv('CONFIGURATION_HOST_PATH', 'service_config')[0m
[30;1m46 | [0m[35mCONFIGURATION_CONFIGMAP = os.getenv('KUBERNETES_AL_CONFIG', None)[0m
[30;1m47 | [0m[35mAL_CORE_NETWORK = os.environ.get("AL_CORE_NETWORK", 'core')[0m
[30;1m48 | [0m[35mRESTRICTED_POD_SECUTITY_CONTEXT = V1SecurityContext([0m
[30;1m49 | [0m[35m    run_as_user=1000,[0m
[30;1m50 | [0m[35m    run_as_group=1000,[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m737 | [0m[35m[0m
[30;1m738 | [0m[35m                    # If the service is not already updating, and there is an update available, mark[0m
[30;1m739 | [0m[35m                    if srv_update_available and not updating:[0m
[30;1m740 | [0m[35m                        self.log.info(f"[CV] Requesting update for service {service.name}...")[0m
[30;1m741 | [0m[35m                        self.container_update.set(service.name, {[0m
[30;1m742 | [0m[35m                            "auth": auth,[0m
[30;1m743 | [0m[35m                            "image": f"{image_name}:{tag_name}",[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m735 | [0m[35m                    srv_update_available = tag_name is not None and tag_name.replace('stable', '') ![0m
[30;1m736 | [0m[35m                    updating = self.container_update.exists(service.name)[0m
[30;1m737 | [0m[35m[0m
[30;1m738 | [0m[35m                    # If the service is not already updating, and there is an update available, mark[0m
[30;1m739 | [0m[35m                    if srv_update_available and not updating:[0m
[30;1m740 | [0m[35m                        self.log.info(f"[CV] Requesting update for service {service.name}...")[0m
[30;1m741 | [0m[35m                        self.container_update.set(service.name, {[0m
[30;1m742 | [0m[35m                            "auth": auth,[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m735 | [0m[35m                    srv_update_available = tag_name is not None and tag_name.replace('stable', '') ![0m
[30;1m736 | [0m[35m                    updating = self.container_update.exists(service.name)[0m
[30;1m737 | [0m[35m[0m
[30;1m738 | [0m[35m                    # If the service is not already updating, and there is an update available, mark[0m
[30;1m739 | [0m[35m                    if srv_update_available and not updating:[0m
[30;1m740 | [0m[35m                        self.log.info(f"[CV] Requesting update for service {service.name}...")[0m
[30;1m741 | [0m[35m                        self.container_update.set(service.name, {[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m706 | [0m[35m                                           f"service key ({service_key}) does not exist. Update proc[0m
[30;1m707 | [0m[35m                        self.container_update.pop(service_name)[0m
[30;1m708 | [0m[35m[0m
[30;1m709 | [0m[35m                # Update with still pending and loop until all are completed/failed[0m
[30;1m710 | [0m[35m                update_threads = pending_threads[0m
[30;1m711 | [0m[35m[0m
[30;1m712 | [0m[35m            # Clear out any old dead containers[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m703 | [0m[35m                                    f"{latest_tag} as the new version. Update procedure cancelled...[0m
[30;1m704 | [0m[35m                        else:[0m
[30;1m705 | [0m[35m                            self.log.error(f"[CU] Service {service_name} has failed to update becaus[0m
[30;1m706 | [0m[35m                                           f"service key ({service_key}) does not exist. Update proc[0m
[30;1m707 | [0m[35m                        self.container_update.pop(service_name)[0m
[30;1m708 | [0m[35m[0m
[30;1m709 | [0m[35m                # Update with still pending and loop until all are completed/failed[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m702 | [0m[35m                                    f"[CU] Service {service_name} has failed to update because it ca[0m
[30;1m703 | [0m[35m                                    f"{latest_tag} as the new version. Update procedure cancelled...[0m
[30;1m704 | [0m[35m                        else:[0m
[30;1m705 | [0m[35m                            self.log.error(f"[CU] Service {service_name} has failed to update becaus[0m
[30;1m706 | [0m[35m                                           f"service key ({service_key}) does not exist. Update proc[0m
[30;1m707 | [0m[35m                        self.container_update.pop(service_name)[0m
[30;1m708 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m700 | [0m[35m                            else:[0m
[30;1m701 | [0m[35m                                self.log.error([0m
[30;1m702 | [0m[35m                                    f"[CU] Service {service_name} has failed to update because it ca[0m
[30;1m703 | [0m[35m                                    f"{latest_tag} as the new version. Update procedure cancelled...[0m
[30;1m704 | [0m[35m                        else:[0m
[30;1m705 | [0m[35m                            self.log.error(f"[CU] Service {service_name} has failed to update becaus[0m
[30;1m706 | [0m[35m                                           f"service key ({service_key}) does not exist. Update proc[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m699 | [0m[35m                                self.log.info(f"[CU] Service {service_name} update successful!")[0m
[30;1m700 | [0m[35m                            else:[0m
[30;1m701 | [0m[35m                                self.log.error([0m
[30;1m702 | [0m[35m                                    f"[CU] Service {service_name} has failed to update because it ca[0m
[30;1m703 | [0m[35m                                    f"{latest_tag} as the new version. Update procedure cancelled...[0m
[30;1m704 | [0m[35m                        else:[0m
[30;1m705 | [0m[35m                            self.log.error(f"[CU] Service {service_name} has failed to update becaus[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m696 | [0m[35m                                    'operation': Operation.Modified,[0m
[30;1m697 | [0m[35m                                    'name': service_name[0m
[30;1m698 | [0m[35m                                })[0m
[30;1m699 | [0m[35m                                self.log.info(f"[CU] Service {service_name} update successful!")[0m
[30;1m700 | [0m[35m                            else:[0m
[30;1m701 | [0m[35m                                self.log.error([0m
[30;1m702 | [0m[35m                                    f"[CU] Service {service_name} has failed to update because it ca[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m691 | [0m[35m                                operations.append((self.datastore.service_delta.UPDATE_SET, 'enabled[0m
[30;1m692 | [0m[35m[0m
[30;1m693 | [0m[35m                            if self.datastore.service_delta.update(service_name, operations):[0m
[30;1m694 | [0m[35m                                # Update completed, cleanup[0m
[30;1m695 | [0m[35m                                self.service_events.send(service_name, {[0m
[30;1m696 | [0m[35m                                    'operation': Operation.Modified,[0m
[30;1m697 | [0m[35m                                    'name': service_name[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m678 | [0m[35m                        # Add thead to the list of still pending jobs[0m
[30;1m679 | [0m[35m                        pending_threads.append(thread)[0m
[30;1m680 | [0m[35m                    else:[0m
[30;1m681 | [0m[35m                        # Update the version of the service[0m
[30;1m682 | [0m[35m                        service_key = thread.result()[0m
[30;1m683 | [0m[35m                        service_name, latest_tag = service_key.split("_")[0m
[30;1m684 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m659 | [0m[35m                    )[0m
[30;1m660 | [0m[35m                except Exception as e:[0m
[30;1m661 | [0m[35m                    self.log.error([0m
[30;1m662 | [0m[35m                        f"[CU] Service {service_name} has failed to update. Update procedure cancell[0m
[30;1m663 | [0m[35m                return service_key[0m
[30;1m664 | [0m[35m[0m
[30;1m665 | [0m[35m            # Start up updates for services in parallel[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m646 | [0m[35m                    "PRIVILEGED": 'true',[0m
[30;1m647 | [0m[35m                }[0m
[30;1m648 | [0m[35m[0m
[30;1m649 | [0m[35m                # Update environment with service defaults[0m
[30;1m650 | [0m[35m                env.update(self.default_service_env)[0m
[30;1m651 | [0m[35m[0m
[30;1m652 | [0m[35m                try:[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m621 | [0m[35m        while self.running:[0m
[30;1m622 | [0m[35m            self.log.info("[CU] Updating all services marked for update...")[0m
[30;1m623 | [0m[35m[0m
[30;1m624 | [0m[35m            # Update function for services[0m
[30;1m625 | [0m[35m            def update_service(service_name: str, update_data: dict) -> str:[0m
[30;1m626 | [0m[35m                self.log.info(f"[CU] Service {service_name} is being updated to version {update_data[0m
[30;1m627 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m607 | [0m[35m                                f"service key ({service_key}) does not exist. Install procedure canc[0m
[30;1m608 | [0m[35m                        self.container_install.pop(service_name)[0m
[30;1m609 | [0m[35m[0m
[30;1m610 | [0m[35m                # Update with still pending and loop until all are completed/failed[0m
[30;1m611 | [0m[35m                install_threads = pending_threads[0m
[30;1m612 | [0m[35m[0m
[30;1m613 | [0m[35m            # Clear out any old dead containers[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m591 | [0m[35m                                operations.append((self.datastore.service_delta.UPDATE_SET, 'enabled[0m
[30;1m592 | [0m[35m[0m
[30;1m593 | [0m[35m                            if self.datastore.service_delta.update(service_name, operations):[0m
[30;1m594 | [0m[35m                                # Update completed, cleanup[0m
[30;1m595 | [0m[35m                                self.service_events.send(service_name, {[0m
[30;1m596 | [0m[35m                                    'operation': Operation.Added,[0m
[30;1m597 | [0m[35m                                    'name': service_name[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m547 | [0m[35m                        "PRIVILEGED": 'true',[0m
[30;1m548 | [0m[35m                    }[0m
[30;1m549 | [0m[35m[0m
[30;1m550 | [0m[35m                    # Update environment with service defaults[0m
[30;1m551 | [0m[35m                    env.update(self.default_service_env)[0m
[30;1m552 | [0m[35m[0m
[30;1m553 | [0m[35m                    self.controller.launch([0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m439 | [0m[35m                if error.status == 404:[0m
[30;1m440 | [0m[35m                    return[0m
[30;1m441 | [0m[35m                # Conflict means two different servers were trying to replace the[0m
[30;1m442 | [0m[35m                # deployment at the same time, we should retry[0m
[30;1m443 | [0m[35m                if error.reason == 'Conflict':[0m
[30;1m444 | [0m[35m                    continue[0m
[30;1m445 | [0m[35m                raise[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m409 | [0m[35m[0m
[30;1m410 | [0m[35m    def cleanup_stale(self):[0m
[30;1m411 | [0m[35m        # Clear up any finished jobs.[0m
[30;1m412 | [0m[35m        # This can happen when the updater was restarted while an update was running.[0m
[30;1m413 | [0m[35m        labels = 'app=assemblyline,component=update-script'[0m
[30;1m414 | [0m[35m        jobs = self.batch_api.list_namespaced_job(namespace=self.namespace, _request_timeout=API_TIM[0m
[30;1m415 | [0m[35m                                                  label_selector=labels)[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m207 | [0m[35m        name = (self.prefix + 'update-' + name.lower()).replace('_', '-')[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m        # If we have been given a username or password for the registry, we have to[0m
[30;1m210 | [0m[35m        # update it, if we haven't been, make sure its been cleaned up in the system[0m
[30;1m211 | [0m[35m        # so we don't leave passwords lying around[0m
[30;1m212 | [0m[35m        pull_secret_name = f'{name}-job-pull-secret'[0m
[30;1m213 | [0m[35m        use_pull_secret = False[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m142 | [0m[35m    def cleanup_stale(self):[0m
[30;1m143 | [0m[35m        # We want containers that are updater managed, already finished, and exited five minutes ago[0m
[30;1m144 | [0m[35m        # The reason for the delay is in development systems people may want to check the output[0m
[30;1m145 | [0m[35m        # of failed update containers they are working on launching with the updater.[0m
[30;1m146 | [0m[35m        filters = {'label': 'updater_launched=true', 'status': 'exited'}[0m
[30;1m147 | [0m[35m        time_mark = isotime.now_as_iso(-60*5)[0m
[30;1m148 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35mclass DockerUpdateInterface:[0m
[30;1m62 | [0m[35m    """Wrap docker interface for the commands used in the update process."""[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    def __init__(self, logger, log_level="INFO"):[0m
[30;1m65 | [0m[35m        self.client = docker.from_env()[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mA process that manages tracking and running update commands for the AL services.[0m
[30;1m3 | [0m[35m"""[0m
[30;1m4 | [0m[35mfrom __future__ import annotations[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m751 | [0m[35m[0m
[30;1m752 | [0m[35m            # Remove services we have locally or in redis that have been deleted from the database[0m
[30;1m753 | [0m[35m            for stray_service in existing_services - set(discovered_services):[0m
[30;1m754 | [0m[35m                self.log.info(f"[CV] Service updates disabled for {stray_service}")[0m
[30;1m755 | [0m[35m                self._service_stage_hash.pop(stray_service)[0m
[30;1m756 | [0m[35m                self.container_update.pop(stray_service)[0m
[30;1m757 | [0m[35m                self.latest_service_tags.pop(stray_service)[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m737 | [0m[35m[0m
[30;1m738 | [0m[35m                    # If the service is not already updating, and there is an update available, mark[0m
[30;1m739 | [0m[35m                    if srv_update_available and not updating:[0m
[30;1m740 | [0m[35m                        self.log.info(f"[CV] Requesting update for service {service.name}...")[0m
[30;1m741 | [0m[35m                        self.container_update.set(service.name, {[0m
[30;1m742 | [0m[35m                            "auth": auth,[0m
[30;1m743 | [0m[35m                            "image": f"{image_name}:{tag_name}",[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m735 | [0m[35m                    srv_update_available = tag_name is not None and tag_name.replace('stable', '') ![0m
[30;1m736 | [0m[35m                    updating = self.container_update.exists(service.name)[0m
[30;1m737 | [0m[35m[0m
[30;1m738 | [0m[35m                    # If the service is not already updating, and there is an update available, mark[0m
[30;1m739 | [0m[35m                    if srv_update_available and not updating:[0m
[30;1m740 | [0m[35m                        self.log.info(f"[CV] Requesting update for service {service.name}...")[0m
[30;1m741 | [0m[35m                        self.container_update.set(service.name, {[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m729 | [0m[35m                self.latest_service_tags.set(service.name,[0m
[30;1m730 | [0m[35m                                             {'auth': auth, 'image': image_name, service.update_chan[0m
[30;1m731 | [0m[35m[0m
[30;1m732 | [0m[35m                # Check if the service is marked for auto-update and we found a version for it[0m
[30;1m733 | [0m[35m                if auto_update and tag_name:[0m
[30;1m734 | [0m[35m                    self.log.info(f"[CV] {service.name} auto-update is enabled...")[0m
[30;1m735 | [0m[35m                    srv_update_available = tag_name is not None and tag_name.replace('stable', '') ![0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m722 | [0m[35m            existing_services = set(self.container_update.keys()) | set(self.latest_service_tags.key[0m
[30;1m723 | [0m[35m            discovered_services: list[str] = [][0m
[30;1m724 | [0m[35m[0m
[30;1m725 | [0m[35m            for service in self.datastore.list_all_services(full=True):[0m
[30;1m726 | [0m[35m                discovered_services.append(service.name)[0m
[30;1m727 | [0m[35m                image_name, tag_name, auth, auto_update = get_latest_tag_for_service([0m
[30;1m728 | [0m[35m                    service, self.config, self.log, prefix="[CV] ")[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m718 | [0m[35m    def container_versions(self):[0m
[30;1m719 | [0m[35m        """Go through the list of services and check what are the latest tags for it"""[0m
[30;1m720 | [0m[35m        while self.running:[0m
[30;1m721 | [0m[35m            self.log.info("[CV] Checking for new versions of all service containers...")[0m
[30;1m722 | [0m[35m            existing_services = set(self.container_update.keys()) | set(self.latest_service_tags.key[0m
[30;1m723 | [0m[35m            discovered_services: list[str] = [][0m
[30;1m724 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m702 | [0m[35m                                    f"[CU] Service {service_name} has failed to update because it ca[0m
[30;1m703 | [0m[35m                                    f"{latest_tag} as the new version. Update procedure cancelled...[0m
[30;1m704 | [0m[35m                        else:[0m
[30;1m705 | [0m[35m                            self.log.error(f"[CU] Service {service_name} has failed to update becaus[0m
[30;1m706 | [0m[35m                                           f"service key ({service_key}) does not exist. Update proc[0m
[30;1m707 | [0m[35m                        self.container_update.pop(service_name)[0m
[30;1m708 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m699 | [0m[35m                                self.log.info(f"[CU] Service {service_name} update successful!")[0m
[30;1m700 | [0m[35m                            else:[0m
[30;1m701 | [0m[35m                                self.log.error([0m
[30;1m702 | [0m[35m                                    f"[CU] Service {service_name} has failed to update because it ca[0m
[30;1m703 | [0m[35m                                    f"{latest_tag} as the new version. Update procedure cancelled...[0m
[30;1m704 | [0m[35m                        else:[0m
[30;1m705 | [0m[35m                            self.log.error(f"[CU] Service {service_name} has failed to update becaus[0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m696 | [0m[35m                                    'operation': Operation.Modified,[0m
[30;1m697 | [0m[35m                                    'name': service_name[0m
[30;1m698 | [0m[35m                                })[0m
[30;1m699 | [0m[35m                                self.log.info(f"[CU] Service {service_name} update successful!")[0m
[30;1m700 | [0m[35m                            else:[0m
[30;1m701 | [0m[35m                                self.log.error([0m
[30;1m702 | [0m[35m                                    f"[CU] Service {service_name} has failed to update because it ca[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m685 | [0m[35m                        if self.datastore.service.get_if_exists(service_key):[0m
[30;1m686 | [0m[35m                            operations = [(self.datastore.service_delta.UPDATE_SET, 'version', lates[0m
[30;1m687 | [0m[35m[0m
[30;1m688 | [0m[35m                            # Check if a service waas previously disabled and re-enable it[0m
[30;1m689 | [0m[35m                            if service_name in self.incompatible_services:[0m
[30;1m690 | [0m[35m                                self.incompatible_services.remove(service_name)[0m
[30;1m691 | [0m[35m                                operations.append((self.datastore.service_delta.UPDATE_SET, 'enabled[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m678 | [0m[35m                        # Add thead to the list of still pending jobs[0m
[30;1m679 | [0m[35m                        pending_threads.append(thread)[0m
[30;1m680 | [0m[35m                    else:[0m
[30;1m681 | [0m[35m                        # Update the version of the service[0m
[30;1m682 | [0m[35m                        service_key = thread.result()[0m
[30;1m683 | [0m[35m                        service_name, latest_tag = service_key.split("_")[0m
[30;1m684 | [0m[35m[0m
[30;1m685 | [0m[35m                        if self.datastore.service.get_if_exists(service_key):[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m670 | [0m[35m[0m
[30;1m671 | [0m[35m            # Check the status of the container updates[0m
[30;1m672 | [0m[35m            while update_threads:[0m
[30;1m673 | [0m[35m                # Delay each check by 5 seconds to give the container adequate time to perform versi[0m
[30;1m674 | [0m[35m                time.sleep(5)[0m
[30;1m675 | [0m[35m                pending_threads = [][0m
[30;1m676 | [0m[35m                for thread in update_threads:[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m659 | [0m[35m                    )[0m
[30;1m660 | [0m[35m                except Exception as e:[0m
[30;1m661 | [0m[35m                    self.log.error([0m
[30;1m662 | [0m[35m                        f"[CU] Service {service_name} has failed to update. Update procedure cancell[0m
[30;1m663 | [0m[35m                return service_key[0m
[30;1m664 | [0m[35m[0m
[30;1m665 | [0m[35m            # Start up updates for services in parallel[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m646 | [0m[35m                    "PRIVILEGED": 'true',[0m
[30;1m647 | [0m[35m                }[0m
[30;1m648 | [0m[35m[0m
[30;1m649 | [0m[35m                # Update environment with service defaults[0m
[30;1m650 | [0m[35m                env.update(self.default_service_env)[0m
[30;1m651 | [0m[35m[0m
[30;1m652 | [0m[35m                try:[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m640 | [0m[35m                service_key = f"{service_name}_{latest_tag}"[0m
[30;1m641 | [0m[35m[0m
[30;1m642 | [0m[35m                # Service updates will run in privileged mode[0m
[30;1m643 | [0m[35m                env = {[0m
[30;1m644 | [0m[35m                    "SERVICE_TAG": update_data['latest_tag'],[0m
[30;1m645 | [0m[35m                    "REGISTER_ONLY": 'true',[0m
[30;1m646 | [0m[35m                    "PRIVILEGED": 'true',[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m639 | [0m[35m                latest_tag = update_data['latest_tag'].replace('stable', '')[0m
[30;1m640 | [0m[35m                service_key = f"{service_name}_{latest_tag}"[0m
[30;1m641 | [0m[35m[0m
[30;1m642 | [0m[35m                # Service updates will run in privileged mode[0m
[30;1m643 | [0m[35m                env = {[0m
[30;1m644 | [0m[35m                    "SERVICE_TAG": update_data['latest_tag'],[0m
[30;1m645 | [0m[35m                    "REGISTER_ONLY": 'true',[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m623 | [0m[35m[0m
[30;1m624 | [0m[35m            # Update function for services[0m
[30;1m625 | [0m[35m            def update_service(service_name: str, update_data: dict) -> str:[0m
[30;1m626 | [0m[35m                self.log.info(f"[CU] Service {service_name} is being updated to version {update_data[0m
[30;1m627 | [0m[35m[0m
[30;1m628 | [0m[35m                docker_config = dict(image=update_data['image'])[0m
[30;1m629 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m603 | [0m[35m                                    f"{latest_tag} as the new version. Install procedure cancelled..[0m
[30;1m604 | [0m[35m                        else:[0m
[30;1m605 | [0m[35m                            self.log.error([0m
[30;1m606 | [0m[35m                                f"[CI] Service {service_name} has failed to install because resultin[0m
[30;1m607 | [0m[35m                                f"service key ({service_key}) does not exist. Install procedure canc[0m
[30;1m608 | [0m[35m                        self.container_install.pop(service_name)[0m
[30;1m609 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m599 | [0m[35m                                self.log.info(f"[CI] Service {service_name}_{latest_tag} install suc[0m
[30;1m600 | [0m[35m                            else:[0m
[30;1m601 | [0m[35m                                self.log.error([0m
[30;1m602 | [0m[35m                                    f"[CI] Service {service_name} has failed to install because it c[0m
[30;1m603 | [0m[35m                                    f"{latest_tag} as the new version. Install procedure cancelled..[0m
[30;1m604 | [0m[35m                        else:[0m
[30;1m605 | [0m[35m                            self.log.error([0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m596 | [0m[35m                                    'operation': Operation.Added,[0m
[30;1m597 | [0m[35m                                    'name': service_name[0m
[30;1m598 | [0m[35m                                })[0m
[30;1m599 | [0m[35m                                self.log.info(f"[CI] Service {service_name}_{latest_tag} install suc[0m
[30;1m600 | [0m[35m                            else:[0m
[30;1m601 | [0m[35m                                self.log.error([0m
[30;1m602 | [0m[35m                                    f"[CI] Service {service_name} has failed to install because it c[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m585 | [0m[35m                        if self.datastore.service.get_if_exists(service_key):[0m
[30;1m586 | [0m[35m                            operations = [(self.datastore.service_delta.UPDATE_SET, 'version', lates[0m
[30;1m587 | [0m[35m[0m
[30;1m588 | [0m[35m                            # Check if a service was previously disabled and re-enable it[0m
[30;1m589 | [0m[35m                            if service_name in self.incompatible_services:[0m
[30;1m590 | [0m[35m                                self.incompatible_services.remove(service_name)[0m
[30;1m591 | [0m[35m                                operations.append((self.datastore.service_delta.UPDATE_SET, 'enabled[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m571 | [0m[35m[0m
[30;1m572 | [0m[35m            # Check the status of the container installs[0m
[30;1m573 | [0m[35m            while install_threads:[0m
[30;1m574 | [0m[35m                # Delay each check by 5 seconds to give the container adequate time to perform versi[0m
[30;1m575 | [0m[35m                time.sleep(5)[0m
[30;1m576 | [0m[35m                pending_threads = [][0m
[30;1m577 | [0m[35m                for thread in install_threads:[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m560 | [0m[35m[0m
[30;1m561 | [0m[35m                except Exception as e:[0m
[30;1m562 | [0m[35m                    self.log.error([0m
[30;1m563 | [0m[35m                        f"[CI] Service {service_name} has failed to install. Install procedure cance[0m
[30;1m564 | [0m[35m                return f"{service_name}_{str(tag_name).replace('stable', '')}"[0m
[30;1m565 | [0m[35m[0m
[30;1m566 | [0m[35m            # Start up installs for services in parallel[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m547 | [0m[35m                        "PRIVILEGED": 'true',[0m
[30;1m548 | [0m[35m                    }[0m
[30;1m549 | [0m[35m[0m
[30;1m550 | [0m[35m                    # Update environment with service defaults[0m
[30;1m551 | [0m[35m                    env.update(self.default_service_env)[0m
[30;1m552 | [0m[35m[0m
[30;1m553 | [0m[35m                    self.controller.launch([0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m541 | [0m[35m                    self.log.info(f"[CI] Service {service_name} is being installed to version {tag_n[0m
[30;1m542 | [0m[35m[0m
[30;1m543 | [0m[35m                    # Service installation will run in privileged mode[0m
[30;1m544 | [0m[35m                    env = {[0m
[30;1m545 | [0m[35m                        "SERVICE_TAG": tag_name,[0m
[30;1m546 | [0m[35m                        "REGISTER_ONLY": 'true',[0m
[30;1m547 | [0m[35m                        "PRIVILEGED": 'true',[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m540 | [0m[35m[0m
[30;1m541 | [0m[35m                    self.log.info(f"[CI] Service {service_name} is being installed to version {tag_n[0m
[30;1m542 | [0m[35m[0m
[30;1m543 | [0m[35m                    # Service installation will run in privileged mode[0m
[30;1m544 | [0m[35m                    env = {[0m
[30;1m545 | [0m[35m                        "SERVICE_TAG": tag_name,[0m
[30;1m546 | [0m[35m                        "REGISTER_ONLY": 'true',[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m538 | [0m[35m                    # Apply any container configuration changes specifically for jobs[0m
[30;1m539 | [0m[35m                    docker_config.update(self.job_dockerconfig)[0m
[30;1m540 | [0m[35m[0m
[30;1m541 | [0m[35m                    self.log.info(f"[CI] Service {service_name} is being installed to version {tag_n[0m
[30;1m542 | [0m[35m[0m
[30;1m543 | [0m[35m                    # Service installation will run in privileged mode[0m
[30;1m544 | [0m[35m                    env = {[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m525 | [0m[35m[0m
[30;1m526 | [0m[35m                    if not tag_name:[0m
[30;1m527 | [0m[35m                        # Fallback to tag alias if we can't find a suitable versioned tag[0m
[30;1m528 | [0m[35m                        self.log.warning("Unable to find a versioned tag for "[0m
[30;1m529 | [0m[35m                                         f"{self.config.services.preferred_update_channel} channel. [0m
[30;1m530 | [0m[35m                                         f"Defaulting to '{tag}' tag...")[0m
[30;1m531 | [0m[35m                        tag_name = tag[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m524 | [0m[35m                        service,  self.config, self.log, prefix="[CI] ")[0m
[30;1m525 | [0m[35m[0m
[30;1m526 | [0m[35m                    if not tag_name:[0m
[30;1m527 | [0m[35m                        # Fallback to tag alias if we can't find a suitable versioned tag[0m
[30;1m528 | [0m[35m                        self.log.warning("Unable to find a versioned tag for "[0m
[30;1m529 | [0m[35m                                         f"{self.config.services.preferred_update_channel} channel. [0m
[30;1m530 | [0m[35m                                         f"Defaulting to '{tag}' tag...")[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m514 | [0m[35m                    tag = 'latest'[0m
[30;1m515 | [0m[35m                service_key = None[0m
[30;1m516 | [0m[35m                try:[0m
[30;1m517 | [0m[35m                    service = Service([0m
[30;1m518 | [0m[35m                        {'name': service_name,[0m
[30;1m519 | [0m[35m                         'update_channel': self.config.services.preferred_update_channel,[0m
[30;1m520 | [0m[35m                         'version': tag,[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m259 | [0m[35m        volumes = [][0m
[30;1m260 | [0m[35m        volume_mounts = [][0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35m        for mount in mounts:[0m
[30;1m263 | [0m[35m            # Initialize with required set of params[0m
[30;1m264 | [0m[35m            vol_kwargs = dict(name=mount.name)[0m
[30;1m265 | [0m[35m            vol_mount_kwargs = dict([0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35m    def external_network(self):[0m
[30;1m72 | [0m[35m        """Lazy load the external network information from docker.[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m        In testing environments it may not exists, and we may not have docker socket anyway.[0m
[30;1m75 | [0m[35m        """[0m
[30;1m76 | [0m[35m        if not self._external_network:[0m
[30;1m77 | [0m[35m            for network in self.client.networks.list(names=['external']):[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35mclass DockerUpdateInterface:[0m
[30;1m62 | [0m[35m    """Wrap docker interface for the commands used in the update process."""[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m    def __init__(self, logger, log_level="INFO"):[0m
[30;1m65 | [0m[35m        self.client = docker.from_env()[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m# How many seconds per check for outstanding updates[0m
[30;1m34 | [0m[35mUPDATE_CHECK_INTERVAL = int(os.getenv("UPDATE_CHECK_INTERVAL", "60"))[0m
[30;1m35 | [0m[35m# How many seconds to wait for checking for new service versions[0m
[30;1m36 | [0m[35mCONTAINER_CHECK_INTERVAL = int(os.getenv("CONTAINER_CHECK_INTERVAL", "300"))[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35mAPI_TIMEOUT = 90[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35mfrom assemblyline.common import isotime[0m
[30;1m24 | [0m[35mfrom assemblyline.odm.messages.changes import Operation, ServiceChange[0m
[30;1m25 | [0m[35mfrom assemblyline.odm.models.config import Mount, Selector[0m
[30;1m26 | [0m[35mfrom assemblyline.odm.models.service import DockerConfig, Service[0m
[30;1m27 | [0m[35mfrom assemblyline.remote.datatypes.events import EventSender, EventWatcher[0m
[30;1m28 | [0m[35mfrom assemblyline.remote.datatypes.hash import Hash[0m
[30;1m29 | [0m[35mfrom assemblyline_core.scaler.controllers.kubernetes_ctl import create_docker_auth_config, selector_[0m
[30;1m30 | [0m[35mfrom assemblyline_core.server_base import ThreadedCoreBase[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35mfrom concurrent.futures import ThreadPoolExecutor[0m
[30;1m12 | [0m[35mfrom typing import Any, List, Optional[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mimport docker[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35mfrom kubernetes.client import V1Job, V1ObjectMeta, V1JobSpec, V1PodTemplateSpec, V1PodSpec, V1Volume[0m
[30;1m17 | [0m[35m    V1VolumeMount, V1EnvVar, V1Container, V1ResourceRequirements, \[0m
[30;1m18 | [0m[35m    V1ConfigMapVolumeSource, V1Secret, V1SecretVolumeSource, V1LocalObjectReference, V1Toleration, V[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/run_updater.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mimport os[0m
[30;1m7 | [0m[35mimport re[0m
[30;1m8 | [0m[35mimport time[0m
[30;1m9 | [0m[35mimport uuid[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mfrom concurrent.futures import ThreadPoolExecutor[0m
[30;1m12 | [0m[35mfrom typing import Any, List, Optional[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m701 | [0m[35m        elasticapm.instrument()[0m
[30;1m702 | [0m[35m        apm_client = get_apm_client("vacuum_worker")[0m
[30;1m703 | [0m[35m[0m
[30;1m704 | [0m[35m    container_id = os.environ.get("HOSTNAME", 'vacuum-worker') + '-'[0m
[30;1m705 | [0m[35m    FileProcessor.total_rounds = threading.Semaphore(value=vacuum_config.worker_rollover*vacuum_conf[0m
[30;1m706 | [0m[35m[0m
[30;1m707 | [0m[35m    department_map, stream_map = None, None[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m603 | [0m[35m            if self.stream_map:[0m
[30;1m604 | [0m[35m                with self.timed('client_info'):[0m
[30;1m605 | [0m[35m                    dept, zone, stream_name, description, stream_classification = \[0m
[30;1m606 | [0m[35m                        self.client_info(msg['metadata'].get('stream'))[0m
[30;1m607 | [0m[35m                    if 'department' not in msg['metadata']:[0m
[30;1m608 | [0m[35m                        msg['metadata']['department'] = dept[0m
[30;1m609 | [0m[35m                    if 'zone' not in msg['metadata']:[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m532 | [0m[35m                    submission_obj = Submission({[0m
[30;1m533 | [0m[35m                        "sid": ingest_id,[0m
[30;1m534 | [0m[35m                        "files": [{[0m
[30;1m535 | [0m[35m                            'name': metadata.get('filename', file_sha256),[0m
[30;1m536 | [0m[35m                            'sha256': file_sha256,[0m
[30;1m537 | [0m[35m                            'size': fileinfo['size'][0m
[30;1m538 | [0m[35m                        }],[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m499 | [0m[35m                if 'ts' not in metadata:[0m
[30;1m500 | [0m[35m                    metadata['ts'] = now_as_iso()[0m
[30;1m501 | [0m[35m                else:[0m
[30;1m502 | [0m[35m                    metadata['ts'] = arrow.get(metadata['ts']).isoformat()[0m
[30;1m503 | [0m[35m[0m
[30;1m504 | [0m[35m                # Set ingest type[0m
[30;1m505 | [0m[35m                s_params['type'] = self.config.core.vacuum.ingest_type[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m483 | [0m[35m[0m
[30;1m484 | [0m[35m            # Freshen file object[0m
[30;1m485 | [0m[35m            with self.timed('freshen'):[0m
[30;1m486 | [0m[35m                expiry = now_as_iso(s_params['ttl'] * 24 * 60 * 60) if s_params.get('ttl', None) els[0m
[30;1m487 | [0m[35m                self.datastore.save_or_freshen_file(file_sha256, fileinfo, expiry, s_params['classif[0m
[30;1m488 | [0m[35m[0m
[30;1m489 | [0m[35m            with self.timed('create'):[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m457 | [0m[35m                with self.timed('identify'):[0m
[30;1m458 | [0m[35m                    fileinfo = self.identify.fileinfo(working_file)[0m
[30;1m459 | [0m[35m[0m
[30;1m460 | [0m[35m                    if msg['metadata'].get('truncated'):[0m
[30;1m461 | [0m[35m                        # File is malformed therefore don't send to certain services[0m
[30;1m462 | [0m[35m                        s_params.update({[0m
[30;1m463 | [0m[35m                            "services": {[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m416 | [0m[35m                })[0m
[30;1m417 | [0m[35m[0m
[30;1m418 | [0m[35m                # Apply provided params[0m
[30;1m419 | [0m[35m                active_cc = msg.get('overrides', {}).get('classification', self.minimum_classificati[0m
[30;1m420 | [0m[35m                active_cc = self.engine.max_classification(active_cc, self.minimum_classification)[0m
[30;1m421 | [0m[35m                active_cc = self.engine.max_classification(active_cc, stream_classification)[0m
[30;1m422 | [0m[35m                s_params.update({[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m416 | [0m[35m                })[0m
[30;1m417 | [0m[35m[0m
[30;1m418 | [0m[35m                # Apply provided params[0m
[30;1m419 | [0m[35m                active_cc = msg.get('overrides', {}).get('classification', self.minimum_classificati[0m
[30;1m420 | [0m[35m                active_cc = self.engine.max_classification(active_cc, self.minimum_classification)[0m
[30;1m421 | [0m[35m                active_cc = self.engine.max_classification(active_cc, stream_classification)[0m
[30;1m422 | [0m[35m                s_params.update({[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m348 | [0m[35m[0m
[30;1m349 | [0m[35m        # export metrics[0m
[30;1m350 | [0m[35m        self.counter.increment('ingested')[0m
[30;1m351 | [0m[35m        # protocol = msg.get('metadata', msg).get('protocol', None)[0m
[30;1m352 | [0m[35m        # if protocol:[0m
[30;1m353 | [0m[35m        #     self.counter.increment(f'protocol.{protocol}')[0m
[30;1m354 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m348 | [0m[35m[0m
[30;1m349 | [0m[35m        # export metrics[0m
[30;1m350 | [0m[35m        self.counter.increment('ingested')[0m
[30;1m351 | [0m[35m        # protocol = msg.get('metadata', msg).get('protocol', None)[0m
[30;1m352 | [0m[35m        # if protocol:[0m
[30;1m353 | [0m[35m        #     self.counter.increment(f'protocol.{protocol}')[0m
[30;1m354 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m273 | [0m[35m        if "services" in settings and isinstance(settings['services'], list):[0m
[30;1m274 | [0m[35m            settings['services'] = {'selected': simplify_services(settings["services"])}[0m
[30;1m275 | [0m[35m[0m
[30;1m276 | [0m[35m        settings['ttl'] = int(settings.get('ttl', self.config.submission.dtl))[0m
[30;1m277 | [0m[35m[0m
[30;1m278 | [0m[35m        # Ignore external sources[0m
[30;1m279 | [0m[35m        settings.pop('default_external_sources', None)[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m        if not def_srv_list:[0m
[30;1m261 | [0m[35m            def_srv_list = DEFAULT_SRV_SEL[0m
[30;1m262 | [0m[35m[0m
[30;1m263 | [0m[35m        settings['service_spec'] = get_default_service_spec(srv_list, settings.get('service_spec', {[0m
[30;1m264 | [0m[35m        settings['services'] = get_default_service_list(srv_list, def_srv_list)[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m        # Simplify services params[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m255 | [0m[35m                if key not in default_settings:[0m
[30;1m256 | [0m[35m                    del settings[key][0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m            def_srv_list = settings.get('services', {}).get('selected', None)[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m        if not def_srv_list:[0m
[30;1m261 | [0m[35m            def_srv_list = DEFAULT_SRV_SEL[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m255 | [0m[35m                if key not in default_settings:[0m
[30;1m256 | [0m[35m                    del settings[key][0m
[30;1m257 | [0m[35m[0m
[30;1m258 | [0m[35m            def_srv_list = settings.get('services', {}).get('selected', None)[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m        if not def_srv_list:[0m
[30;1m261 | [0m[35m            def_srv_list = DEFAULT_SRV_SEL[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m218 | [0m[35m            if self.user_profile and time.time() - self.profile_check < PROFILE_CACHE_TIME:[0m
[30;1m219 | [0m[35m                return self.user_profile[0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m            self.user_profile = self.datastore.user.get(self.config.core.vacuum.assemblyline_user, a[0m
[30;1m222 | [0m[35m            self.profile_check = time.time()[0m
[30;1m223 | [0m[35m            return self.user_profile[0m
[30;1m224 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m        # Merge the default metadata required for ingestion with those that are required from vacuum[0m
[30;1m172 | [0m[35m        validation_scheme = config.submission.metadata.ingest.get('_default', {})[0m
[30;1m173 | [0m[35m        validation_scheme.update(config.submission.metadata.ingest.get(self.config.core.vacuum.inges[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m        self.metadata_check_kwargs = {[0m
[30;1m176 | [0m[35m            'validation_scheme': validation_scheme,[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m169 | [0m[35m        self.metadata_check = MetadataValidator(datastore, Hash("metadata_suggestions", persistent_r[0m
[30;1m170 | [0m[35m[0m
[30;1m171 | [0m[35m        # Merge the default metadata required for ingestion with those that are required from vacuum[0m
[30;1m172 | [0m[35m        validation_scheme = config.submission.metadata.ingest.get('_default', {})[0m
[30;1m173 | [0m[35m        validation_scheme.update(config.submission.metadata.ingest.get(self.config.core.vacuum.inges[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35m        self.metadata_check_kwargs = {[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m            param_object = {'name': x['name'], "params": []}[0m
[30;1m111 | [0m[35m            for param in x.get('submission_params'):[0m
[30;1m112 | [0m[35m                new_param = deepcopy(param)[0m
[30;1m113 | [0m[35m                new_param['value'] = user_default_values.get(x['name'], {}).get(param['name'], param[0m
[30;1m114 | [0m[35m                param_object["params"].append(new_param)[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m            out.append(param_object)[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m            param_object = {'name': x['name'], "params": []}[0m
[30;1m111 | [0m[35m            for param in x.get('submission_params'):[0m
[30;1m112 | [0m[35m                new_param = deepcopy(param)[0m
[30;1m113 | [0m[35m                new_param['value'] = user_default_values.get(x['name'], {}).get(param['name'], param[0m
[30;1m114 | [0m[35m                param_object["params"].append(new_param)[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m            out.append(param_object)[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m108 | [0m[35m    for x in srv_list:[0m
[30;1m109 | [0m[35m        if x["submission_params"]:[0m
[30;1m110 | [0m[35m            param_object = {'name': x['name'], "params": []}[0m
[30;1m111 | [0m[35m            for param in x.get('submission_params'):[0m
[30;1m112 | [0m[35m                new_param = deepcopy(param)[0m
[30;1m113 | [0m[35m                new_param['value'] = user_default_values.get(x['name'], {}).get(param['name'], param[0m
[30;1m114 | [0m[35m                param_object["params"].append(new_param)[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m        service = spec['name'][0m
[30;1m97 | [0m[35m        for param in spec['params']:[0m
[30;1m98 | [0m[35m            if param['value'] != param['default']:[0m
[30;1m99 | [0m[35m                params[service] = params.get(service, {})[0m
[30;1m100 | [0m[35m                params[service][param['name']] = param['value'][0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m    return params[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m303 | [0m[35m    def client_info(self, stream_id: Optional[str]) -> tuple[str, int, str, str, str]:[0m
[30;1m304 | [0m[35m        stream = self.get_stream(stream_id)[0m
[30;1m305 | [0m[35m[0m
[30;1m306 | [0m[35m        # stream not in cache, update cache and try again[0m
[30;1m307 | [0m[35m        if not stream:[0m
[30;1m308 | [0m[35m            # log and return bogus data[0m
[30;1m309 | [0m[35m            logger.error('Could not find info on stream %s' % stream_id)[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m306 | [0m[35m        # stream not in cache, update cache and try again[0m
[30;1m307 | [0m[35m        if not stream:[0m
[30;1m308 | [0m[35m            # log and return bogus data[0m
[30;1m309 | [0m[35m            logger.error('Could not find info on stream %s' % stream_id)[0m
[30;1m310 | [0m[35m            return 'UNK', 10, 'UNK_STREAM', "Unknown stream ID", self.minimum_classification[0m
[30;1m311 | [0m[35m[0m
[30;1m312 | [0m[35m        description = stream.description or "Unknown stream ID"[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m269 | [0m[35m        else:[0m
[30;1m270 | [0m[35m            settings['service_spec'] = {}[0m
[30;1m271 | [0m[35m[0m
[30;1m272 | [0m[35m        # Simplify service selection[0m
[30;1m273 | [0m[35m        if "services" in settings and isinstance(settings['services'], list):[0m
[30;1m274 | [0m[35m            settings['services'] = {'selected': simplify_services(settings["services"])}[0m
[30;1m275 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35mdef simplify_service_spec(service_spec):[0m
[30;1m94 | [0m[35m    params = {}[0m
[30;1m95 | [0m[35m    for spec in service_spec:[0m
[30;1m96 | [0m[35m        service = spec['name'][0m
[30;1m97 | [0m[35m        for param in spec['params']:[0m
[30;1m98 | [0m[35m            if param['value'] != param['default']:[0m
[30;1m99 | [0m[35m                params[service] = params.get(service, {})[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/worker.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport tempfile[0m
[30;1m5 | [0m[35mimport logging[0m
[30;1m6 | [0m[35mimport os[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mimport signal[0m
[30;1m9 | [0m[35mimport shutil[0m
[30;1m10 | [0m[35mfrom copy import deepcopy[0m
[30;1m11 | [0m[35mfrom typing import Optional, Any[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m            for u in users:[0m
[30;1m219 | [0m[35m                uname = u['uname'][0m
[30;1m220 | [0m[35m                user = self.datastore.user.get(uname)[0m
[30;1m221 | [0m[35m                apikeys = user.apikeys[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m                for key in apikeys:[0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m            cur_total = cur_total + (result.get("count", total))[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m            # check for API keys in total[0m
[30;1m216 | [0m[35m            users = result.get('items', [])[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m            for u in users:[0m
[30;1m219 | [0m[35m                uname = u['uname'][0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m210 | [0m[35m        while cur_total < total:[0m
[30;1m211 | [0m[35m            result = self.datastore.user.search(query, offset=offset, rows=rows)[0m
[30;1m212 | [0m[35m            total = result.get('total', 0)[0m
[30;1m213 | [0m[35m            cur_total = cur_total + (result.get("count", total))[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m            # check for API keys in total[0m
[30;1m216 | [0m[35m            users = result.get('items', [])[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m        while cur_total < total:[0m
[30;1m211 | [0m[35m            result = self.datastore.user.search(query, offset=offset, rows=rows)[0m
[30;1m212 | [0m[35m            total = result.get('total', 0)[0m
[30;1m213 | [0m[35m            cur_total = cur_total + (result.get("count", total))[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m            # check for API keys in total[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m                    if task_time is None or task_time <= current_time:[0m
[30;1m143 | [0m[35m                        self.log.warning([0m
[30;1m144 | [0m[35m                            f"Messages on queue {k} by "[0m
[30;1m145 | [0m[35m                            f"{msg.get('submission', {}).get('params', {}).get('submitter', 'unknown[0m
[30;1m146 | [0m[35m                            f" are older then the maximum queue age ({task_time}), removing queue")[0m
[30;1m147 | [0m[35m                        q.delete()[0m
[30;1m148 | [0m[35m                    else:[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m                    if task_time is None or task_time <= current_time:[0m
[30;1m143 | [0m[35m                        self.log.warning([0m
[30;1m144 | [0m[35m                            f"Messages on queue {k} by "[0m
[30;1m145 | [0m[35m                            f"{msg.get('submission', {}).get('params', {}).get('submitter', 'unknown[0m
[30;1m146 | [0m[35m                            f" are older then the maximum queue age ({task_time}), removing queue")[0m
[30;1m147 | [0m[35m                        q.delete()[0m
[30;1m148 | [0m[35m                    else:[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m142 | [0m[35m                    if task_time is None or task_time <= current_time:[0m
[30;1m143 | [0m[35m                        self.log.warning([0m
[30;1m144 | [0m[35m                            f"Messages on queue {k} by "[0m
[30;1m145 | [0m[35m                            f"{msg.get('submission', {}).get('params', {}).get('submitter', 'unknown[0m
[30;1m146 | [0m[35m                            f" are older then the maximum queue age ({task_time}), removing queue")[0m
[30;1m147 | [0m[35m                        q.delete()[0m
[30;1m148 | [0m[35m                    else:[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m                msg = q.peek_next()[0m
[30;1m137 | [0m[35m                if msg:[0m
[30;1m138 | [0m[35m                    current_time = now_as_iso(-1 * self.config.core.plumber.notification_queue_max_a[0m
[30;1m139 | [0m[35m                    task_time = msg.get('notify_time', None) or msg.get('ingest_time', None)[0m
[30;1m140 | [0m[35m[0m
[30;1m141 | [0m[35m                    # If the message too old, cleanup[0m
[30;1m142 | [0m[35m                    if task_time is None or task_time <= current_time:[0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m                msg = q.peek_next()[0m
[30;1m137 | [0m[35m                if msg:[0m
[30;1m138 | [0m[35m                    current_time = now_as_iso(-1 * self.config.core.plumber.notification_queue_max_a[0m
[30;1m139 | [0m[35m                    task_time = msg.get('notify_time', None) or msg.get('ingest_time', None)[0m
[30;1m140 | [0m[35m[0m
[30;1m141 | [0m[35m                    # If the message too old, cleanup[0m
[30;1m142 | [0m[35m                    if task_time is None or task_time <= current_time:[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m                        self.flush_threads.pop(service_name)[0m
[30;1m111 | [0m[35m                elif service and service.enabled and service.max_queue_length > 0:[0m
[30;1m112 | [0m[35m                    self.service_limit[service_name] = service.max_queue_length[0m
[30;1m113 | [0m[35m                    thread = self.flush_threads.get(service_name)[0m
[30;1m114 | [0m[35m                    if not thread or not thread.is_alive():[0m
[30;1m115 | [0m[35m                        self.stop_signals[service_name] = threading.Event()[0m
[30;1m116 | [0m[35m                        thread = threading.Thread([0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m70 | [0m[35m            # Reset the status of the service queues[0m
[30;1m71 | [0m[35m            service_queues = {service_name: None for service_name in service_queues}[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m            # Update the service queue status based on current list of services[0m
[30;1m74 | [0m[35m            for service in self.datastore.list_all_services(full=True):[0m
[30;1m75 | [0m[35m                service_queues[service.name] = service[0m
[30;1m76 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m191 | [0m[35m                error_key = error.build_key(task=task)[0m
[30;1m192 | [0m[35m                self.dispatch_client.service_failed(task.sid, error_key, error)[0m
[30;1m193 | [0m[35m            self.sleep(2)[0m
[30;1m194 | [0m[35m        self.log.info(f"Done watching {service_name} service queue")[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m165 | [0m[35m        self.log.info("Done cleaning up task index")[0m
[30;1m166 | [0m[35m[0m
[30;1m167 | [0m[35m    def watch_service(self, service_name):[0m
[30;1m168 | [0m[35m        self.log.info(f"Watching {service_name} service queue...")[0m
[30;1m169 | [0m[35m        service_queue = get_service_queue(service_name, self.redis)[0m
[30;1m170 | [0m[35m        while self.running and not self.stop_signals[service_name].is_set():[0m
[30;1m171 | [0m[35m            while service_queue.length() > self.service_limit[service_name]:[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m108 | [0m[35m                        self.stop_signals[service_name].set()[0m
[30;1m109 | [0m[35m                        self.service_limit.pop(service_name)[0m
[30;1m110 | [0m[35m                        self.flush_threads.pop(service_name)[0m
[30;1m111 | [0m[35m                elif service and service.enabled and service.max_queue_length > 0:[0m
[30;1m112 | [0m[35m                    self.service_limit[service_name] = service.max_queue_length[0m
[30;1m113 | [0m[35m                    thread = self.flush_threads.get(service_name)[0m
[30;1m114 | [0m[35m                    if not thread or not thread.is_alive():[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m103 | [0m[35m                        self.heartbeat()[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m                # For services that are enabled but limited[0m
[30;1m106 | [0m[35m                if not service or not service.enabled or service.max_queue_length == 0:[0m
[30;1m107 | [0m[35m                    if service_name in self.stop_signals:[0m
[30;1m108 | [0m[35m                        self.stop_signals[service_name].set()[0m
[30;1m109 | [0m[35m                        self.service_limit.pop(service_name)[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m89 | [0m[35m                            created='NOW',[0m
[30;1m90 | [0m[35m                            expiry_ts=now_as_iso(task.ttl * DAY) if task.ttl else None,[0m
[30;1m91 | [0m[35m                            response=dict([0m
[30;1m92 | [0m[35m                                message='The service was disabled while processing this task.',[0m
[30;1m93 | [0m[35m                                service_name=task.service_name,[0m
[30;1m94 | [0m[35m                                service_version='0',[0m
[30;1m95 | [0m[35m                                status='FAIL_NONRECOVERABLE',[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m77 | [0m[35m            for service_name, service in service_queues.items():[0m
[30;1m78 | [0m[35m                # For disabled or othewise unavailable services purge the queue[0m
[30;1m79 | [0m[35m                current_stage = self.get_service_stage(service_name, ServiceStage.Running)[0m
[30;1m80 | [0m[35m                if not service or not service.enabled or current_stage != ServiceStage.Running:[0m
[30;1m81 | [0m[35m                    while True:[0m
[30;1m82 | [0m[35m                        task = self.dispatch_client.request_work('plumber', service_name=service_nam[0m
[30;1m83 | [0m[35m                                                                 service_version='0', blocking=False[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m74 | [0m[35m            for service in self.datastore.list_all_services(full=True):[0m
[30;1m75 | [0m[35m                service_queues[service.name] = service[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m            for service_name, service in service_queues.items():[0m
[30;1m78 | [0m[35m                # For disabled or othewise unavailable services purge the queue[0m
[30;1m79 | [0m[35m                current_stage = self.get_service_stage(service_name, ServiceStage.Running)[0m
[30;1m80 | [0m[35m                if not service or not service.enabled or current_stage != ServiceStage.Running:[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m            # Update the service queue status based on current list of services[0m
[30;1m74 | [0m[35m            for service in self.datastore.list_all_services(full=True):[0m
[30;1m75 | [0m[35m                service_queues[service.name] = service[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m            for service_name, service in service_queues.items():[0m
[30;1m78 | [0m[35m                # For disabled or othewise unavailable services purge the queue[0m
[30;1m79 | [0m[35m                current_stage = self.get_service_stage(service_name, ServiceStage.Running)[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35m            service_queues = {service_name: None for service_name in service_queues}[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m            # Update the service queue status based on current list of services[0m
[30;1m74 | [0m[35m            for service in self.datastore.list_all_services(full=True):[0m
[30;1m75 | [0m[35m                service_queues[service.name] = service[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m            for service_name, service in service_queues.items():[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m            # Reset the status of the service queues[0m
[30;1m71 | [0m[35m            service_queues = {service_name: None for service_name in service_queues}[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m            # Update the service queue status based on current list of services[0m
[30;1m74 | [0m[35m            for service in self.datastore.list_all_services(full=True):[0m
[30;1m75 | [0m[35m                service_queues[service.name] = service[0m
[30;1m76 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m                          for queue in self.redis.keys(service_queue_name('*'))}[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m        while self.running:[0m
[30;1m70 | [0m[35m            # Reset the status of the service queues[0m
[30;1m71 | [0m[35m            service_queues = {service_name: None for service_name in service_queues}[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m            # Update the service queue status based on current list of services[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35m        self.service_queue_plumbing()[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    def service_queue_plumbing(self):[0m
[30;1m64 | [0m[35m        # Get an initial list of all the service queues[0m
[30;1m65 | [0m[35m        service_queues: dict[str, Optional[Service]][0m
[30;1m66 | [0m[35m        service_queues = {queue.decode('utf-8').lstrip('service-queue-'): None[0m
[30;1m67 | [0m[35m                          for queue in self.redis.keys(service_queue_name('*'))}[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m15 | [0m[35mfrom assemblyline.common.isotime import DAY_IN_SECONDS, now_as_iso[0m
[30;1m16 | [0m[35mfrom assemblyline.odm.models.apikey import get_apikey_id[0m
[30;1m17 | [0m[35mfrom assemblyline.odm.models.error import Error[0m
[30;1m18 | [0m[35mfrom assemblyline.odm.models.service import Service[0m
[30;1m19 | [0m[35mfrom assemblyline.odm.models.user import load_roles, load_roles_form_acls[0m
[30;1m20 | [0m[35mfrom assemblyline.remote.datatypes import retry_call[0m
[30;1m21 | [0m[35mfrom assemblyline.remote.datatypes.queues.named import NamedQueue[0m
[30;1m22 | [0m[35mfrom assemblyline_core.dispatching.client import DispatchClient[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mWhen a service is turned off by the orchestrator or deleted by the user, the service task queue need[0m
[30;1m5 | [0m[35memptied. The status of all the services will be periodically checked and any service that is found t[0m
[30;1m6 | [0m[35mdisabled or deleted for which a service queue exists, the dispatcher will be informed that the task([0m
[30;1m7 | [0m[35mhad an error.[0m
[30;1m8 | [0m[35m"""[0m
[30;1m9 | [0m[35mimport threading[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mA daemon that cleans up tasks from the service queues when a service is disabled/deleted.[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mWhen a service is turned off by the orchestrator or deleted by the user, the service task queue need[0m
[30;1m5 | [0m[35memptied. The status of all the services will be periodically checked and any service that is found t[0m
[30;1m6 | [0m[35mdisabled or deleted for which a service queue exists, the dispatcher will be informed that the task([0m
[30;1m7 | [0m[35mhad an error.[0m
[30;1m8 | [0m[35m"""[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mA daemon that cleans up tasks from the service queues when a service is disabled/deleted.[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mWhen a service is turned off by the orchestrator or deleted by the user, the service task queue need[0m
[30;1m5 | [0m[35memptied. The status of all the services will be periodically checked and any service that is found t[0m
[30;1m6 | [0m[35mdisabled or deleted for which a service queue exists, the dispatcher will be informed that the task([0m
[30;1m7 | [0m[35mhad an error.[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mA daemon that cleans up tasks from the service queues when a service is disabled/deleted.[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mWhen a service is turned off by the orchestrator or deleted by the user, the service task queue need[0m
[30;1m5 | [0m[35memptied. The status of all the services will be periodically checked and any service that is found t[0m
[30;1m6 | [0m[35mdisabled or deleted for which a service queue exists, the dispatcher will be informed that the task([0m
[30;1m7 | [0m[35mhad an error.[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mA daemon that cleans up tasks from the service queues when a service is disabled/deleted.[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mWhen a service is turned off by the orchestrator or deleted by the user, the service task queue need[0m
[30;1m5 | [0m[35memptied. The status of all the services will be periodically checked and any service that is found t[0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/plumber/run_plumber.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mA daemon that cleans up tasks from the service queues when a service is disabled/deleted.[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mWhen a service is turned off by the orchestrator or deleted by the user, the service task queue need[0m
[30;1m5 | [0m[35memptied. The status of all the services will be periodically checked and any service that is found t[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1862 | [0m[35m    def list_outstanding(self, sid: str, queue_name: str):[0m
[30;1m1863 | [0m[35m        response_queue: NamedQueue[dict] = NamedQueue(queue_name, host=self.redis)[0m
[30;1m1864 | [0m[35m        outstanding: defaultdict[str, int] = defaultdict(int)[0m
[30;1m1865 | [0m[35m        task = self.tasks.get(sid)[0m
[30;1m1866 | [0m[35m        if task:[0m
[30;1m1867 | [0m[35m            for _sha, service_name in list(task.queue_keys.keys()):[0m
[30;1m1868 | [0m[35m                outstanding[service_name] += 1[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1843 | [0m[35m        watch_queue.push(WatchQueueMessage({'status': 'START'}).as_primitives())[0m
[30;1m1844 | [0m[35m[0m
[30;1m1845 | [0m[35m        #[0m
[30;1m1846 | [0m[35m        task = self.tasks.get(sid)[0m
[30;1m1847 | [0m[35m        if not task:[0m
[30;1m1848 | [0m[35m            watch_queue.push(WatchQueueMessage({"status": "STOP"}).as_primitives())[0m
[30;1m1849 | [0m[35m            return[0m

[31m--[ [0m[34mMatch #[0m[33m281[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1626 | [0m[35m    @elasticapm.capture_span(span_type='dispatcher')[0m
[30;1m1627 | [0m[35m    def set_timeout(self, task: SubmissionTask, sha256, service_name, worker_id):[0m
[30;1m1628 | [0m[35m        sid = task.submission.sid[0m
[30;1m1629 | [0m[35m        service = self.scheduler.services.get(service_name)[0m
[30;1m1630 | [0m[35m        if not service:[0m
[30;1m1631 | [0m[35m            return[0m
[30;1m1632 | [0m[35m        self._service_timeouts.set((sid, sha256, service_name), service.timeout + TIMEOUT_EXTRA_TIME[0m

[31m--[ [0m[34mMatch #[0m[33m282[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1494 | [0m[35m        new_depth = task.file_depth[sha256] + 1[0m
[30;1m1495 | [0m[35m        for extracted_sha256, _ in summary.children:[0m
[30;1m1496 | [0m[35m            task.file_depth.setdefault(extracted_sha256, new_depth)[0m
[30;1m1497 | [0m[35m            extracted_name = extracted_names.get(extracted_sha256)[0m
[30;1m1498 | [0m[35m            if extracted_name and extracted_sha256 not in task.file_names:[0m
[30;1m1499 | [0m[35m                task.file_names[extracted_sha256] = extracted_name[0m
[30;1m1500 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m283[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1415 | [0m[35m            tags = data['tags'][0m
[30;1m1416 | [0m[35m            temporary_data = data['temporary_data'] or {}[0m
[30;1m1417 | [0m[35m            extracted_names = data['extracted_names'][0m
[30;1m1418 | [0m[35m            dynamic_recursion_bypass = data.get('dynamic_recursion_bypass', [])[0m
[30;1m1419 | [0m[35m[0m
[30;1m1420 | [0m[35m        except KeyError as missing:[0m
[30;1m1421 | [0m[35m            self.log.exception(f"Malformed result message, missing key: {missing}")[0m

[31m--[ [0m[34mMatch #[0m[33m284[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1386 | [0m[35m                    self.dispatch_file(task, message.sha)[0m
[30;1m1387 | [0m[35m[0m
[30;1m1388 | [0m[35m            elif kind == Action.bad_sid:[0m
[30;1m1389 | [0m[35m                task = self.tasks.get(message.sid)[0m
[30;1m1390 | [0m[35m                if task:[0m
[30;1m1391 | [0m[35m                    task.submission.to_be_deleted = True[0m
[30;1m1392 | [0m[35m                    self.active_submissions.add(message.sid, {[0m

[31m--[ [0m[34mMatch #[0m[33m285[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1381 | [0m[35m                    self.timeout_service(task, message.sha, message.service_name, message.worker_id)[0m
[30;1m1382 | [0m[35m[0m
[30;1m1383 | [0m[35m            elif kind == Action.dispatch_file:[0m
[30;1m1384 | [0m[35m                task = self.tasks.get(message.sid)[0m
[30;1m1385 | [0m[35m                if task:[0m
[30;1m1386 | [0m[35m                    self.dispatch_file(task, message.sha)[0m
[30;1m1387 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m286[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1369 | [0m[35m                            self._submission_timeouts.set(message.sid, SUBMISSION_TOTAL_TIMEOUT, Non[0m
[30;1m1370 | [0m[35m[0m
[30;1m1371 | [0m[35m            elif kind == Action.service_timeout:[0m
[30;1m1372 | [0m[35m                task = self.tasks.get(message.sid)[0m
[30;1m1373 | [0m[35m[0m
[30;1m1374 | [0m[35m                if not message.sha or not message.service_name:[0m
[30;1m1375 | [0m[35m                    self.log.warning(f'[{message.sid}] Service timeout missing data.')[0m

[31m--[ [0m[34mMatch #[0m[33m287[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1359 | [0m[35m[0m
[30;1m1360 | [0m[35m            elif kind == Action.check_submission:[0m
[30;1m1361 | [0m[35m                with apm_span(self.apm_client, "check_submission_message"):[0m
[30;1m1362 | [0m[35m                    task = self.tasks.get(message.sid)[0m
[30;1m1363 | [0m[35m                    if task:[0m
[30;1m1364 | [0m[35m                        self.log.info(f'[{message.sid}] submission timeout, checking dispatch status[0m
[30;1m1365 | [0m[35m                        self.check_submission(task)[0m

[31m--[ [0m[34mMatch #[0m[33m288[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1346 | [0m[35m            elif kind == Action.result:[0m
[30;1m1347 | [0m[35m                self.queue_ready_signals[self.process_queue_index(message.sid)].release()[0m
[30;1m1348 | [0m[35m                with apm_span(self.apm_client, "dispatcher_results"):[0m
[30;1m1349 | [0m[35m                    task = self.tasks.get(message.sid)[0m
[30;1m1350 | [0m[35m                    if not task:[0m
[30;1m1351 | [0m[35m                        self.log.warning(f'[{message.sid}] Result returned for finished task.')[0m
[30;1m1352 | [0m[35m                        continue[0m

[31m--[ [0m[34mMatch #[0m[33m289[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1324 | [0m[35m[0m
[30;1m1325 | [0m[35m            if kind == Action.start:[0m
[30;1m1326 | [0m[35m                with apm_span(self.apm_client, 'service_start_message'):[0m
[30;1m1327 | [0m[35m                    task = self.tasks.get(message.sid)[0m
[30;1m1328 | [0m[35m                    if not task:[0m
[30;1m1329 | [0m[35m                        self.log.warning(f'[{message.sid}] Service started for finished task.')[0m
[30;1m1330 | [0m[35m                        continue[0m

[31m--[ [0m[34mMatch #[0m[33m290[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1311 | [0m[35m            self.counter.increment_execution_time('busy_seconds', time.time() - time_mark)[0m
[30;1m1312 | [0m[35m[0m
[30;1m1313 | [0m[35m            try:[0m
[30;1m1314 | [0m[35m                message = work_queue.get(timeout=1)[0m
[30;1m1315 | [0m[35m            except Empty:[0m
[30;1m1316 | [0m[35m                cpu_mark = time.process_time()[0m
[30;1m1317 | [0m[35m                time_mark = time.time()[0m

[31m--[ [0m[34mMatch #[0m[33m291[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1139 | [0m[35m            self.counter.set('error_queue', self.error_queue.qsize())[0m
[30;1m1140 | [0m[35m[0m
[30;1m1141 | [0m[35m            try:[0m
[30;1m1142 | [0m[35m                errors = [self.error_queue.get(block=True, timeout=3)][0m
[30;1m1143 | [0m[35m            except Empty:[0m
[30;1m1144 | [0m[35m                continue[0m
[30;1m1145 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m292[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1129 | [0m[35m        while self.running:[0m
[30;1m1130 | [0m[35m            self.counter.set('save_queue', self.finalize_queue.qsize())[0m
[30;1m1131 | [0m[35m            try:[0m
[30;1m1132 | [0m[35m                task, max_score, checked = self.finalize_queue.get(block=True, timeout=3)[0m
[30;1m1133 | [0m[35m                self.finalize_submission(task, max_score, checked)[0m
[30;1m1134 | [0m[35m            except Empty:[0m
[30;1m1135 | [0m[35m                pass[0m

[31m--[ [0m[34mMatch #[0m[33m293[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1061 | [0m[35m                            schedule.clear()[0m
[30;1m1062 | [0m[35m[0m
[30;1m1063 | [0m[35m                        # Collect information about the result[0m
[30;1m1064 | [0m[35m                        file_scores[sha256] = file_scores.get(sha256, 0) + result.score[0m
[30;1m1065 | [0m[35m                        unchecked.update(set([c for c, _ in result.children]) - checked)[0m
[30;1m1066 | [0m[35m                        continue[0m
[30;1m1067 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m294[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1055 | [0m[35m                        continue[0m
[30;1m1056 | [0m[35m[0m
[30;1m1057 | [0m[35m                    # if there is a result, then the service finished already[0m
[30;1m1058 | [0m[35m                    result = task.service_results.get(key)[0m
[30;1m1059 | [0m[35m                    if result:[0m
[30;1m1060 | [0m[35m                        if not task.submission.params.ignore_filtering and result.drop:[0m
[30;1m1061 | [0m[35m                            schedule.clear()[0m

[31m--[ [0m[34mMatch #[0m[33m295[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1045 | [0m[35m[0m
[30;1m1046 | [0m[35m                    # Only active services should be in this dict, so if a service that was placed i[0m
[30;1m1047 | [0m[35m                    # schedule is now missing it has been disabled or taken offline.[0m
[30;1m1048 | [0m[35m                    service = self.scheduler.services.get(service_name)[0m
[30;1m1049 | [0m[35m                    if not service:[0m
[30;1m1050 | [0m[35m                        continue[0m
[30;1m1051 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m296[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m956 | [0m[35m                        service_name=service_name,[0m
[30;1m957 | [0m[35m                        service_config=config,[0m
[30;1m958 | [0m[35m                        fileinfo=file_info,[0m
[30;1m959 | [0m[35m                        filename=task.file_names.get(sha256, sha256),[0m
[30;1m960 | [0m[35m                        depth=file_depth,[0m
[30;1m961 | [0m[35m                        max_files=task.submission.params.max_extracted,[0m
[30;1m962 | [0m[35m                        ttl=submission.params.ttl,[0m

[31m--[ [0m[34mMatch #[0m[33m297[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m925 | [0m[35m                    if service.uses_temp_submission_data:[0m
[30;1m926 | [0m[35m                        temp_data = task.temporary_data[sha256].read()[0m
[30;1m927 | [0m[35m                        if service.monitored_keys:[0m
[30;1m928 | [0m[35m                            values = {key: temp_data.get(key) for key in service.monitored_keys}[0m
[30;1m929 | [0m[35m                            task.set_monitoring_entry(sha256, service.name, values)[0m
[30;1m930 | [0m[35m[0m
[30;1m931 | [0m[35m                    # Load the metadata we will pass[0m

[31m--[ [0m[34mMatch #[0m[33m298[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m918 | [0m[35m                    # Load the list of tags we will pass[0m
[30;1m919 | [0m[35m                    tags = [][0m
[30;1m920 | [0m[35m                    if service.uses_tags or service.uses_tag_scores:[0m
[30;1m921 | [0m[35m                        tags = list(task.file_tags.get(sha256, {}).values())[0m
[30;1m922 | [0m[35m[0m
[30;1m923 | [0m[35m                    # Load the temp submission data we will pass[0m
[30;1m924 | [0m[35m                    temp_data: dict[str, str] = {}[0m

[31m--[ [0m[34mMatch #[0m[33m299[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m899 | [0m[35m[0m
[30;1m900 | [0m[35m                    # Check if this task is already sitting in queue[0m
[30;1m901 | [0m[35m                    with elasticapm.capture_span('check_queue'):[0m
[30;1m902 | [0m[35m                        dispatch_key = task.queue_keys.get(key, None)[0m
[30;1m903 | [0m[35m                        if dispatch_key is not None and service_queue.rank(dispatch_key) is not None[0m
[30;1m904 | [0m[35m                            enqueued.append(service_name)[0m
[30;1m905 | [0m[35m                            continue[0m

[31m--[ [0m[34mMatch #[0m[33m300[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m872 | [0m[35m                        continue[0m
[30;1m873 | [0m[35m[0m
[30;1m874 | [0m[35m                    # If we have no error, and no result, its not finished[0m
[30;1m875 | [0m[35m                    result = task.service_results.get(key)[0m
[30;1m876 | [0m[35m                    if not result:[0m
[30;1m877 | [0m[35m                        outstanding[service_name] = service[0m
[30;1m878 | [0m[35m                        continue[0m

[31m--[ [0m[34mMatch #[0m[33m301[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m861 | [0m[35m                started_stages.append(stage)[0m
[30;1m862 | [0m[35m[0m
[30;1m863 | [0m[35m                for service_name in stage:[0m
[30;1m864 | [0m[35m                    service = self.scheduler.services.get(service_name)[0m
[30;1m865 | [0m[35m                    if not service:[0m
[30;1m866 | [0m[35m                        continue[0m
[30;1m867 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m302[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m773 | [0m[35m            return file_info[0m
[30;1m774 | [0m[35m[0m
[30;1m775 | [0m[35m        # get the info from datastore[0m
[30;1m776 | [0m[35m        filestore_info: Optional[File] = self.datastore.file.get(sha256)[0m
[30;1m777 | [0m[35m[0m
[30;1m778 | [0m[35m        if filestore_info is None:[0m
[30;1m779 | [0m[35m            # Store an error and mark this file as unprocessable[0m

[31m--[ [0m[34mMatch #[0m[33m303[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m768 | [0m[35m    def get_fileinfo(self, task: SubmissionTask, sha256: str) -> Optional[FileInfo]:[0m
[30;1m769 | [0m[35m        """Read information about a file from the database, caching it locally."""[0m
[30;1m770 | [0m[35m        # First try to get the info from local cache[0m
[30;1m771 | [0m[35m        file_info = task.file_info.get(sha256, None)[0m
[30;1m772 | [0m[35m        if file_info:[0m
[30;1m773 | [0m[35m            return file_info[0m
[30;1m774 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m304[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m401 | [0m[35m[0m
[30;1m402 | [0m[35m    def redispatch_service(self, sha256, service_name):[0m
[30;1m403 | [0m[35m        # Clear the result if its partial or an error[0m
[30;1m404 | [0m[35m        result = self.service_results.get((sha256, service_name))[0m
[30;1m405 | [0m[35m        if result and not result.partial:[0m
[30;1m406 | [0m[35m            return[0m
[30;1m407 | [0m[35m        self.service_results.pop((sha256, service_name), None)[0m

[31m--[ [0m[34mMatch #[0m[33m305[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m385 | [0m[35m            dispatched_value = entry.values.get(key)[0m
[30;1m386 | [0m[35m[0m
[30;1m387 | [0m[35m            if type(value) is not type(dispatched_value) or value != dispatched_value:[0m
[30;1m388 | [0m[35m                result = self.service_results.get((sha256, service))[0m
[30;1m389 | [0m[35m                if not result:[0m
[30;1m390 | [0m[35m                    # If the value has changed since the last dispatch but results haven't come in y[0m
[30;1m391 | [0m[35m                    # mark this service to be disptached later. This will only happen if the service[0m

[31m--[ [0m[34mMatch #[0m[33m306[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m382 | [0m[35m[0m
[30;1m383 | [0m[35m            # Get whatever values (if any) were provided on the previous dispatch of this service[0m
[30;1m384 | [0m[35m            value = self.temporary_data[sha256].read_key(key)[0m
[30;1m385 | [0m[35m            dispatched_value = entry.values.get(key)[0m
[30;1m386 | [0m[35m[0m
[30;1m387 | [0m[35m            if type(value) is not type(dispatched_value) or value != dispatched_value:[0m
[30;1m388 | [0m[35m                result = self.service_results.get((sha256, service))[0m

[31m--[ [0m[34mMatch #[0m[33m307[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m368 | [0m[35m        # We have an incoming non-partial result, flush out any partial monitoring[0m
[30;1m369 | [0m[35m        self.monitoring.pop((sha256, service_name), None)[0m
[30;1m370 | [0m[35m        # If there is a partial result for this service flush that as well so we accept this new res[0m
[30;1m371 | [0m[35m        result = self.service_results.get((sha256, service_name))[0m
[30;1m372 | [0m[35m        if result and result.partial:[0m
[30;1m373 | [0m[35m            self.service_results.pop((sha256, service_name), None)[0m
[30;1m374 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m308[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m339 | [0m[35m        circumstances like replay.[0m
[30;1m340 | [0m[35m        """[0m
[30;1m341 | [0m[35m        return list(set().union(*[[0m
[30;1m342 | [0m[35m            self._forbidden_services.get(parent, set())[0m
[30;1m343 | [0m[35m            for parent in self.all_ancestors(sha256)[0m
[30;1m344 | [0m[35m        ]))[0m
[30;1m345 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m309[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m324 | [0m[35m        to_visit = [sha256][0m
[30;1m325 | [0m[35m        while len(to_visit) > 0:[0m
[30;1m326 | [0m[35m            current = to_visit.pop()[0m
[30;1m327 | [0m[35m            for parent in self._parent_map.get(current, []):[0m
[30;1m328 | [0m[35m                if parent not in visited:[0m
[30;1m329 | [0m[35m                    visited.add(parent)[0m
[30;1m330 | [0m[35m                    to_visit.append(parent)[0m

[31m--[ [0m[34mMatch #[0m[33m310[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m276 | [0m[35m                    children_detail: list[tuple[str, str]] = [(r['sha256'], r['parent_relation']) fo[0m
[30;1m277 | [0m[35m                    self.service_results[(sha256, service)] = ResultSummary([0m
[30;1m278 | [0m[35m                        key=k, drop=result['drop_file'], score=result['result']['score'],[0m
[30;1m279 | [0m[35m                        children=children_detail, partial=result.get('partial', False))[0m
[30;1m280 | [0m[35m[0m
[30;1m281 | [0m[35m                tags = Result(result).scored_tag_dict()[0m
[30;1m282 | [0m[35m                for key, tag in tags.items():[0m

[31m--[ [0m[34mMatch #[0m[33m311[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m253 | [0m[35m            # Replay the process of routing files for dispatcher internal state.[0m
[30;1m254 | [0m[35m            for k, result in results.items():[0m
[30;1m255 | [0m[35m                sha256, service, _ = k.split('.', 2)[0m
[30;1m256 | [0m[35m                service = scheduler.services.get(service)[0m
[30;1m257 | [0m[35m                if not service:[0m
[30;1m258 | [0m[35m                    continue[0m
[30;1m259 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m312[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m168 | [0m[35m            return self._union_shared_value(key, value)[0m
[30;1m169 | [0m[35m        [0m
[30;1m170 | [0m[35m        if self.config.get(key) == KeyType.OVERWRITE.value:[0m
[30;1m171 | [0m[35m            change = self.shared_values.get(key) != value[0m
[30;1m172 | [0m[35m            self.shared_values[key] = value[0m
[30;1m173 | [0m[35m            return change[0m
[30;1m174 | [0m[35m        [0m

[31m--[ [0m[34mMatch #[0m[33m313[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m167 | [0m[35m        if self.config.get(key) == KeyType.UNION.value:[0m
[30;1m168 | [0m[35m            return self._union_shared_value(key, value)[0m
[30;1m169 | [0m[35m        [0m
[30;1m170 | [0m[35m        if self.config.get(key) == KeyType.OVERWRITE.value:[0m
[30;1m171 | [0m[35m            change = self.shared_values.get(key) != value[0m
[30;1m172 | [0m[35m            self.shared_values[key] = value[0m
[30;1m173 | [0m[35m            return change[0m

[31m--[ [0m[34mMatch #[0m[33m314[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m164 | [0m[35m        [0m
[30;1m165 | [0m[35m        Return true if this change could mean partial results should be reevaluated.[0m
[30;1m166 | [0m[35m        """[0m
[30;1m167 | [0m[35m        if self.config.get(key) == KeyType.UNION.value:[0m
[30;1m168 | [0m[35m            return self._union_shared_value(key, value)[0m
[30;1m169 | [0m[35m        [0m
[30;1m170 | [0m[35m        if self.config.get(key) == KeyType.OVERWRITE.value:[0m

[31m--[ [0m[34mMatch #[0m[33m315[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m157 | [0m[35m        try:[0m
[30;1m158 | [0m[35m            return self.shared_values[key][0m
[30;1m159 | [0m[35m        except KeyError:[0m
[30;1m160 | [0m[35m            return self.local_values.get(key)[0m
[30;1m161 | [0m[35m[0m
[30;1m162 | [0m[35m    def set_value(self, key: str, value: Any) -> bool:[0m
[30;1m163 | [0m[35m        """Set the value of a temporary data key using the appropriate method for the key.[0m

[31m--[ [0m[34mMatch #[0m[33m316[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35mAL_SHUTDOWN_QUIT = 60[0m
[30;1m60 | [0m[35mFINALIZING_WINDOW = max(AL_SHUTDOWN_GRACE - AL_SHUTDOWN_QUIT, 0)[0m
[30;1m61 | [0m[35mRESULT_BATCH_SIZE = int(os.environ.get('DISPATCHER_RESULT_BATCH_SIZE', '50'))[0m
[30;1m62 | [0m[35mERROR_BATCH_SIZE = int(os.environ.get('DISPATCHER_ERROR_BATCH_SIZE', '50'))[0m
[30;1m63 | [0m[35mDAY_IN_SECONDS = 24 * 60 * 60[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m# TODO: DYNAMIC_ANALYSIS_CATEGORY can be removed after assemblyline version 4.6+[0m

[31m--[ [0m[34mMatch #[0m[33m317[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35mAL_SHUTDOWN_GRACE = int(os.environ.get('AL_SHUTDOWN_GRACE', '60'))[0m
[30;1m59 | [0m[35mAL_SHUTDOWN_QUIT = 60[0m
[30;1m60 | [0m[35mFINALIZING_WINDOW = max(AL_SHUTDOWN_GRACE - AL_SHUTDOWN_QUIT, 0)[0m
[30;1m61 | [0m[35mRESULT_BATCH_SIZE = int(os.environ.get('DISPATCHER_RESULT_BATCH_SIZE', '50'))[0m
[30;1m62 | [0m[35mERROR_BATCH_SIZE = int(os.environ.get('DISPATCHER_ERROR_BATCH_SIZE', '50'))[0m
[30;1m63 | [0m[35mDAY_IN_SECONDS = 24 * 60 * 60[0m
[30;1m64 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m318[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35mAPM_SPAN_TYPE = 'handle_message'[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35mAL_SHUTDOWN_GRACE = int(os.environ.get('AL_SHUTDOWN_GRACE', '60'))[0m
[30;1m59 | [0m[35mAL_SHUTDOWN_QUIT = 60[0m
[30;1m60 | [0m[35mFINALIZING_WINDOW = max(AL_SHUTDOWN_GRACE - AL_SHUTDOWN_QUIT, 0)[0m
[30;1m61 | [0m[35mRESULT_BATCH_SIZE = int(os.environ.get('DISPATCHER_RESULT_BATCH_SIZE', '50'))[0m

[31m--[ [0m[34mMatch #[0m[33m319[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1930 | [0m[35m[0m
[30;1m1931 | [0m[35m            # Look for instances that are in the assignment table, but the instance its assigned to [0m
[30;1m1932 | [0m[35m            # We try to remove the instance from the table to prevent multiple dispatcher instances [0m
[30;1m1933 | [0m[35m            # recovering it at the same time[0m
[30;1m1934 | [0m[35m            with apm_span(self.apm_client, 'orphan_submission_check'):[0m
[30;1m1935 | [0m[35m                # Get the submissions belonging to an dispatcher we don't know about[0m
[30;1m1936 | [0m[35m                assignments = self.submissions_assignments.items()[0m

[31m--[ [0m[34mMatch #[0m[33m320[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1540 | [0m[35m                    current_ancestry_node = dict(type=file_type, parent_relation=parent_relation,[0m
[30;1m1541 | [0m[35m                                                 sha256=extracted_sha256)[0m
[30;1m1542 | [0m[35m[0m
[30;1m1543 | [0m[35m                    # Update ancestory data[0m
[30;1m1544 | [0m[35m                    parent_ancestry = parent_data.read_key('ancestry') or [][0m
[30;1m1545 | [0m[35m                    existing_ancestry = task.temporary_data[extracted_sha256].local_values.setdefaul[0m
[30;1m1546 | [0m[35m                    for ancestry in parent_ancestry:[0m

[31m--[ [0m[34mMatch #[0m[33m321[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1483 | [0m[35m            task.service_results[(sha256, service_name)] = summary[0m
[30;1m1484 | [0m[35m        task.register_children(sha256, [c for c, _ in summary.children])[0m
[30;1m1485 | [0m[35m[0m
[30;1m1486 | [0m[35m        # Update the temporary data table for this file[0m
[30;1m1487 | [0m[35m        for key, value in (temporary_data or {}).items():[0m
[30;1m1488 | [0m[35m            if len(str(value)) <= self.config.submission.max_temp_data_length:[0m
[30;1m1489 | [0m[35m                if task.temporary_data[sha256].set_value(key, value):[0m

[31m--[ [0m[34mMatch #[0m[33m322[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1473 | [0m[35m            else:[0m
[30;1m1474 | [0m[35m                task.file_tags[sha256][key] = value[0m
[30;1m1475 | [0m[35m[0m
[30;1m1476 | [0m[35m        # Update children to include parent_relation, likely EXTRACTED[0m
[30;1m1477 | [0m[35m        if summary.children and isinstance(summary.children[0], str):[0m
[30;1m1478 | [0m[35m            old_children = typing.cast(list[str], summary.children)[0m
[30;1m1479 | [0m[35m            summary.children = [(c, 'EXTRACTED') for c in old_children][0m

[31m--[ [0m[34mMatch #[0m[33m323[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1466 | [0m[35m                alt_tags[key] = t[0m
[30;1m1467 | [0m[35m            tags = alt_tags[0m
[30;1m1468 | [0m[35m[0m
[30;1m1469 | [0m[35m        # Update score of tag as it moves through different services[0m
[30;1m1470 | [0m[35m        for key, value in tags.items():[0m
[30;1m1471 | [0m[35m            if key in task.file_tags[sha256].keys():[0m
[30;1m1472 | [0m[35m                task.file_tags[sha256][key]['score'] += value['score'][0m

[31m--[ [0m[34mMatch #[0m[33m324[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1377 | [0m[35m[0m
[30;1m1378 | [0m[35m                if task:[0m
[30;1m1379 | [0m[35m                    task.service_logs[(message.sha, message.service_name)].append([0m
[30;1m1380 | [0m[35m                        f'Service timeout at {now_as_iso()} on worker {message.worker_id}')[0m
[30;1m1381 | [0m[35m                    self.timeout_service(task, message.sha, message.service_name, message.worker_id)[0m
[30;1m1382 | [0m[35m[0m
[30;1m1383 | [0m[35m            elif kind == Action.dispatch_file:[0m

[31m--[ [0m[34mMatch #[0m[33m325[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1341 | [0m[35m                            continue[0m
[30;1m1342 | [0m[35m                        self.set_timeout(task, message.sha, message.service_name, message.worker_id)[0m
[30;1m1343 | [0m[35m                        task.service_logs[(message.sha, message.service_name)].append([0m
[30;1m1344 | [0m[35m                            f'Popped from queue and running at {now_as_iso()} on worker {message.wor[0m
[30;1m1345 | [0m[35m[0m
[30;1m1346 | [0m[35m            elif kind == Action.result:[0m
[30;1m1347 | [0m[35m                self.queue_ready_signals[self.process_queue_index(message.sid)].release()[0m

[31m--[ [0m[34mMatch #[0m[33m326[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1159 | [0m[35m    def finalize_submission(self, task: SubmissionTask, max_score, file_list):[0m
[30;1m1160 | [0m[35m        """All of the services for all of the files in this submission have finished or failed.[0m
[30;1m1161 | [0m[35m[0m
[30;1m1162 | [0m[35m        Update the records in the datastore, and flush the working data from redis.[0m
[30;1m1163 | [0m[35m        """[0m
[30;1m1164 | [0m[35m        submission = task.submission[0m
[30;1m1165 | [0m[35m        sid = submission.sid[0m

[31m--[ [0m[34mMatch #[0m[33m327[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1092 | [0m[35m        depth_limit = self.config.submission.max_extraction_depth[0m
[30;1m1093 | [0m[35m        pending_files = [sha for sha in pending_files if task.file_depth[sha] < depth_limit][0m
[30;1m1094 | [0m[35m[0m
[30;1m1095 | [0m[35m        # If there are pending files, then at least one service, on at least one[0m
[30;1m1096 | [0m[35m        # file isn't done yet, and hasn't been filtered by any of the previous few steps[0m
[30;1m1097 | [0m[35m        # poke those files.[0m
[30;1m1098 | [0m[35m        if pending_files:[0m

[31m--[ [0m[34mMatch #[0m[33m328[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1092 | [0m[35m        depth_limit = self.config.submission.max_extraction_depth[0m
[30;1m1093 | [0m[35m        pending_files = [sha for sha in pending_files if task.file_depth[sha] < depth_limit][0m
[30;1m1094 | [0m[35m[0m
[30;1m1095 | [0m[35m        # If there are pending files, then at least one service, on at least one[0m
[30;1m1096 | [0m[35m        # file isn't done yet, and hasn't been filtered by any of the previous few steps[0m
[30;1m1097 | [0m[35m        # poke those files.[0m
[30;1m1098 | [0m[35m        if pending_files:[0m

[31m--[ [0m[34mMatch #[0m[33m329[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1020 | [0m[35m[0m
[30;1m1021 | [0m[35m        # Categorize files as pending/processing (can be both) all others are finished[0m
[30;1m1022 | [0m[35m        pending_files = []  # Files where we are missing a service and it is not being processed[0m
[30;1m1023 | [0m[35m        processing_files = []  # Files where at least one service is in progress/queued[0m
[30;1m1024 | [0m[35m[0m
[30;1m1025 | [0m[35m        # Track information about the results as we hit them[0m
[30;1m1026 | [0m[35m        file_scores: dict[str, int] = {}[0m

[31m--[ [0m[34mMatch #[0m[33m330[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1014 | [0m[35m        :param task: Task object for the submission in question.[0m
[30;1m1015 | [0m[35m        :return: true if submission has been finished.[0m
[30;1m1016 | [0m[35m        """[0m
[30;1m1017 | [0m[35m        # Track which files we have looked at already[0m
[30;1m1018 | [0m[35m        checked: set[str] = set()[0m
[30;1m1019 | [0m[35m        unchecked: set[str] = set(list(task.file_depth.keys()))[0m
[30;1m1020 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m331[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m978 | [0m[35m                    queue_key = service_queue.push(service_task.priority, service_task.as_primitives[0m
[30;1m979 | [0m[35m                    task.queue_keys[key] = queue_key[0m
[30;1m980 | [0m[35m                    sent.append(service_name)[0m
[30;1m981 | [0m[35m                    task.service_logs[key].append(f'Submitted to queue at {now_as_iso()}')[0m
[30;1m982 | [0m[35m[0m
[30;1m983 | [0m[35m            if sent or enqueued or running:[0m
[30;1m984 | [0m[35m                # If we have confirmed that we are waiting, or have taken an action, log that.[0m

[31m--[ [0m[34mMatch #[0m[33m332[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m655 | [0m[35m                self.counter.increment_execution_time('cpu_seconds', time.process_time() - cpu_mark)[0m
[30;1m656 | [0m[35m                self.counter.increment_execution_time('busy_seconds', time.time() - time_mark)[0m
[30;1m657 | [0m[35m[0m
[30;1m658 | [0m[35m                # Check if we are at the submission limit globally[0m
[30;1m659 | [0m[35m                if self.submissions_assignments.length() >= self.config.core.dispatcher.max_inflight[0m
[30;1m660 | [0m[35m                    self.sleep(1)[0m
[30;1m661 | [0m[35m                    cpu_mark = time.process_time()[0m

[31m--[ [0m[34mMatch #[0m[33m333[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m620 | [0m[35m[0m
[30;1m621 | [0m[35m        for ii in range(RESULT_THREADS):[0m
[30;1m622 | [0m[35m            # Process results[0m
[30;1m623 | [0m[35m            threads[f'Service Update Worker #{ii}'] = self.service_worker_factory(ii)[0m
[30;1m624 | [0m[35m[0m
[30;1m625 | [0m[35m        self.maintain_threads(threads)[0m
[30;1m626 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m334[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m529 | [0m[35m        self.postprocess_worker = ActionWorker(cache=False, config=self.config, datastore=self.datas[0m
[30;1m530 | [0m[35m                                               redis_persist=self.redis_persist)[0m
[30;1m531 | [0m[35m[0m
[30;1m532 | [0m[35m        # Update bad sid list[0m
[30;1m533 | [0m[35m        self.redis_bad_sids = Set(BAD_SID_HASH, host=self.redis_persist)[0m
[30;1m534 | [0m[35m        self.bad_sids: set[str] = set(self.redis_bad_sids.members())[0m
[30;1m535 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m335[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m185 | [0m[35m        if not isinstance(values, (list, tuple)):[0m
[30;1m186 | [0m[35m            return False[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m        # Add each value one at a time testing for new values[0m
[30;1m189 | [0m[35m        # This is slower than using set intersection, but isn't type sensitive[0m
[30;1m190 | [0m[35m        changed = False[0m
[30;1m191 | [0m[35m        for new_item in values:[0m

[31m--[ [0m[34mMatch #[0m[33m336[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1930 | [0m[35m[0m
[30;1m1931 | [0m[35m            # Look for instances that are in the assignment table, but the instance its assigned to [0m
[30;1m1932 | [0m[35m            # We try to remove the instance from the table to prevent multiple dispatcher instances [0m
[30;1m1933 | [0m[35m            # recovering it at the same time[0m
[30;1m1934 | [0m[35m            with apm_span(self.apm_client, 'orphan_submission_check'):[0m
[30;1m1935 | [0m[35m                # Get the submissions belonging to an dispatcher we don't know about[0m
[30;1m1936 | [0m[35m                assignments = self.submissions_assignments.items()[0m
[30;1m1937 | [0m[35m                dispatcher_instances = set(Dispatcher.all_instances(persistent_redis=self.redis_pers[0m

[31m--[ [0m[34mMatch #[0m[33m337[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1911 | [0m[35m                        'container': task.metadata['worker__'][0m
[30;1m1912 | [0m[35m                    })[0m
[30;1m1913 | [0m[35m[0m
[30;1m1914 | [0m[35m                    # Report to the metrics system that a recoverable error has occurred for that se[0m
[30;1m1915 | [0m[35m                    export_metrics_once(task.service_name, ServiceMetrics, dict(fail_recoverable=1),[0m
[30;1m1916 | [0m[35m                                        host=task.metadata['worker__'], counter_type='service', redi[0m
[30;1m1917 | [0m[35m[0m
[30;1m1918 | [0m[35m            # Look for unassigned submissions in the datastore if we don't have a[0m

[31m--[ [0m[34mMatch #[0m[33m338[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1693 | [0m[35m                'container': worker_id[0m
[30;1m1694 | [0m[35m            })[0m
[30;1m1695 | [0m[35m[0m
[30;1m1696 | [0m[35m            # Report to the metrics system that a recoverable error has occurred for that service[0m
[30;1m1697 | [0m[35m            export_metrics_once(service_name, ServiceMetrics, dict(fail_recoverable=1),[0m
[30;1m1698 | [0m[35m                                host=worker_id, counter_type='service', redis=self.redis)[0m
[30;1m1699 | [0m[35m        return True[0m
[30;1m1700 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m339[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1685 | [0m[35m        self.dispatch_file(task, sha256)[0m
[30;1m1686 | [0m[35m[0m
[30;1m1687 | [0m[35m        # We push the task of killing the container off on the scaler, which already has root access[0m
[30;1m1688 | [0m[35m        # the scaler can also double check that the service name and container id match, to be sure[0m
[30;1m1689 | [0m[35m        # we aren't accidentally killing the wrong container[0m
[30;1m1690 | [0m[35m        if worker_id is not None:[0m
[30;1m1691 | [0m[35m            self.scaler_timeout_queue.push({[0m

[31m--[ [0m[34mMatch #[0m[33m340[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1680 | [0m[35m[0m
[30;1m1681 | [0m[35m        # We can confirm that the task is ours now, even if the worker finished, the result will be [0m
[30;1m1682 | [0m[35m        task.running_services.discard((sha256, service_name))[0m
[30;1m1683 | [0m[35m        self.log.info(f"[{sid}] Service {service_name} "[0m
[30;1m1684 | [0m[35m                      f"running on {worker_id} timed out on {sha256}.")[0m
[30;1m1685 | [0m[35m        self.dispatch_file(task, sha256)[0m
[30;1m1686 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m341[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1674 | [0m[35m        task_key = ServiceTask.make_key(sid=sid, service_name=service_name, sha=sha256)[0m
[30;1m1675 | [0m[35m        service_task = self.running_tasks.pop(task_key)[0m
[30;1m1676 | [0m[35m        if not service_task and (sha256, service_name) not in task.running_services:[0m
[30;1m1677 | [0m[35m            self.log.debug(f"[{sid}] Service {service_name} "[0m
[30;1m1678 | [0m[35m                           f"timed out on {sha256} but task isn't running.")[0m
[30;1m1679 | [0m[35m            return False[0m
[30;1m1680 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m342[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1668 | [0m[35m    @elasticapm.capture_span(span_type='dispatcher')[0m
[30;1m1669 | [0m[35m    def timeout_service(self, task: SubmissionTask, sha256, service_name, worker_id):[0m
[30;1m1670 | [0m[35m        # We believe a service task has timed out, try and read it from running tasks[0m
[30;1m1671 | [0m[35m        # If we can't find the task in running tasks, it finished JUST before timing out, let it go[0m
[30;1m1672 | [0m[35m        sid = task.submission.sid[0m
[30;1m1673 | [0m[35m        task.queue_keys.pop((sha256, service_name), None)[0m
[30;1m1674 | [0m[35m        task_key = ServiceTask.make_key(sid=sid, service_name=service_name, sha=sha256)[0m

[31m--[ [0m[34mMatch #[0m[33m343[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1667 | [0m[35m[0m
[30;1m1668 | [0m[35m    @elasticapm.capture_span(span_type='dispatcher')[0m
[30;1m1669 | [0m[35m    def timeout_service(self, task: SubmissionTask, sha256, service_name, worker_id):[0m
[30;1m1670 | [0m[35m        # We believe a service task has timed out, try and read it from running tasks[0m
[30;1m1671 | [0m[35m        # If we can't find the task in running tasks, it finished JUST before timing out, let it go[0m
[30;1m1672 | [0m[35m        sid = task.submission.sid[0m
[30;1m1673 | [0m[35m        task.queue_keys.pop((sha256, service_name), None)[0m

[31m--[ [0m[34mMatch #[0m[33m344[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1654 | [0m[35m                # Check for service timeouts[0m
[30;1m1655 | [0m[35m                service_timeouts = self._service_timeouts.timeouts()[0m
[30;1m1656 | [0m[35m                for (sid, sha, service_name), worker_id in service_timeouts.items():[0m
[30;1m1657 | [0m[35m                    # Put our timeouts into special timeout queue so they are delayed[0m
[30;1m1658 | [0m[35m                    # until redis results are processed[0m
[30;1m1659 | [0m[35m                    self.timeout_queue.put([0m
[30;1m1660 | [0m[35m                        DispatchAction(kind=Action.service_timeout, sid=sid, sha=sha,[0m

[31m--[ [0m[34mMatch #[0m[33m345[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1651 | [0m[35m                    _q = self.find_process_queue(sid)[0m
[30;1m1652 | [0m[35m                    _q.put(DispatchAction(kind=Action.check_submission, sid=sid))[0m
[30;1m1653 | [0m[35m[0m
[30;1m1654 | [0m[35m                # Check for service timeouts[0m
[30;1m1655 | [0m[35m                service_timeouts = self._service_timeouts.timeouts()[0m
[30;1m1656 | [0m[35m                for (sid, sha, service_name), worker_id in service_timeouts.items():[0m
[30;1m1657 | [0m[35m                    # Put our timeouts into special timeout queue so they are delayed[0m

[31m--[ [0m[34mMatch #[0m[33m346[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1626 | [0m[35m    @elasticapm.capture_span(span_type='dispatcher')[0m
[30;1m1627 | [0m[35m    def set_timeout(self, task: SubmissionTask, sha256, service_name, worker_id):[0m
[30;1m1628 | [0m[35m        sid = task.submission.sid[0m
[30;1m1629 | [0m[35m        service = self.scheduler.services.get(service_name)[0m
[30;1m1630 | [0m[35m        if not service:[0m
[30;1m1631 | [0m[35m            return[0m
[30;1m1632 | [0m[35m        self._service_timeouts.set((sid, sha256, service_name), service.timeout + TIMEOUT_EXTRA_TIME[0m

[31m--[ [0m[34mMatch #[0m[33m347[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1590 | [0m[35m[0m
[30;1m1591 | [0m[35m    @elasticapm.capture_span(span_type='dispatcher')[0m
[30;1m1592 | [0m[35m    def process_service_error(self, task: SubmissionTask, error_key, error: Error):[0m
[30;1m1593 | [0m[35m        self.log.info(f'[{task.submission.sid}] Error from service {error.response.service_name} on [0m
[30;1m1594 | [0m[35m        self.clear_timeout(task, error.sha256, error.response.service_name)[0m
[30;1m1595 | [0m[35m        key = (error.sha256, error.response.service_name)[0m
[30;1m1596 | [0m[35m        if error.response.status == "FAIL_NONRECOVERABLE":[0m

[31m--[ [0m[34mMatch #[0m[33m348[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1568 | [0m[35m                    }))[0m
[30;1m1569 | [0m[35m[0m
[30;1m1570 | [0m[35m        # Check if its worth trying to run the next stage[0m
[30;1m1571 | [0m[35m        # Not worth running if we know we are waiting for another service[0m
[30;1m1572 | [0m[35m        if not any(_s == sha256 for _s, _ in task.running_services):[0m
[30;1m1573 | [0m[35m            force_redispatch.add(sha256)[0m
[30;1m1574 | [0m[35m        # Not worth running if we know we have services in queue[0m
[30;1m1575 | [0m[35m        if not any(_s == sha256 for _s, _ in task.queue_keys.keys()):[0m

[31m--[ [0m[34mMatch #[0m[33m349[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1424 | [0m[35m        # Add SHA256s of files that allowed to run regardless of Dynamic Recursion Prevention[0m
[30;1m1425 | [0m[35m        task.dynamic_recursion_bypass = task.dynamic_recursion_bypass.union(set(dynamic_recursion_by[0m
[30;1m1426 | [0m[35m[0m
[30;1m1427 | [0m[35m        # Immediately remove timeout so we don't cancel now[0m
[30;1m1428 | [0m[35m        self.clear_timeout(task, sha256, service_name)[0m
[30;1m1429 | [0m[35m        task.service_logs.pop((sha256, service_name), None)[0m
[30;1m1430 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m350[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1377 | [0m[35m[0m
[30;1m1378 | [0m[35m                if task:[0m
[30;1m1379 | [0m[35m                    task.service_logs[(message.sha, message.service_name)].append([0m
[30;1m1380 | [0m[35m                        f'Service timeout at {now_as_iso()} on worker {message.worker_id}')[0m
[30;1m1381 | [0m[35m                    self.timeout_service(task, message.sha, message.service_name, message.worker_id)[0m
[30;1m1382 | [0m[35m[0m
[30;1m1383 | [0m[35m            elif kind == Action.dispatch_file:[0m

[31m--[ [0m[34mMatch #[0m[33m351[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1372 | [0m[35m                task = self.tasks.get(message.sid)[0m
[30;1m1373 | [0m[35m[0m
[30;1m1374 | [0m[35m                if not message.sha or not message.service_name:[0m
[30;1m1375 | [0m[35m                    self.log.warning(f'[{message.sid}] Service timeout missing data.')[0m
[30;1m1376 | [0m[35m                    continue[0m
[30;1m1377 | [0m[35m[0m
[30;1m1378 | [0m[35m                if task:[0m

[31m--[ [0m[34mMatch #[0m[33m352[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1336 | [0m[35m                    key = (message.sha, message.service_name)[0m
[30;1m1337 | [0m[35m                    if task.queue_keys.pop(key, None) is not None:[0m
[30;1m1338 | [0m[35m                        # If this task is already finished (result message processed before start[0m
[30;1m1339 | [0m[35m                        # message) we can skip setting a timeout[0m
[30;1m1340 | [0m[35m                        if key in task.service_errors or key in task.service_results:[0m
[30;1m1341 | [0m[35m                            continue[0m
[30;1m1342 | [0m[35m                        self.set_timeout(task, message.sha, message.service_name, message.worker_id)[0m
[30;1m1343 | [0m[35m                        task.service_logs[(message.sha, message.service_name)].append([0m

[31m--[ [0m[34mMatch #[0m[33m353[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1330 | [0m[35m                        continue[0m
[30;1m1331 | [0m[35m[0m
[30;1m1332 | [0m[35m                    if not message.sha or not message.service_name:[0m
[30;1m1333 | [0m[35m                        self.log.warning(f'[{message.sid}] Service started missing data.')[0m
[30;1m1334 | [0m[35m                        continue[0m
[30;1m1335 | [0m[35m[0m
[30;1m1336 | [0m[35m                    key = (message.sha, message.service_name)[0m

[31m--[ [0m[34mMatch #[0m[33m354[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1326 | [0m[35m                with apm_span(self.apm_client, 'service_start_message'):[0m
[30;1m1327 | [0m[35m                    task = self.tasks.get(message.sid)[0m
[30;1m1328 | [0m[35m                    if not task:[0m
[30;1m1329 | [0m[35m                        self.log.warning(f'[{message.sid}] Service started for finished task.')[0m
[30;1m1330 | [0m[35m                        continue[0m
[30;1m1331 | [0m[35m[0m
[30;1m1332 | [0m[35m                    if not message.sha or not message.service_name:[0m

[31m--[ [0m[34mMatch #[0m[33m355[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1301 | [0m[35m                        break[0m
[30;1m1302 | [0m[35m[0m
[30;1m1303 | [0m[35m    def service_worker(self, index: int):[0m
[30;1m1304 | [0m[35m        self.log.info(f"Start service worker {index}")[0m
[30;1m1305 | [0m[35m        work_queue = self.process_queues[index][0m
[30;1m1306 | [0m[35m        cpu_mark = time.process_time()[0m
[30;1m1307 | [0m[35m        time_mark = time.time()[0m

[31m--[ [0m[34mMatch #[0m[33m356[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1224 | [0m[35m                'sender': 'dispatcher',[0m
[30;1m1225 | [0m[35m            }).as_primitives())[0m
[30;1m1226 | [0m[35m[0m
[30;1m1227 | [0m[35m        # Clear the timeout watcher[0m
[30;1m1228 | [0m[35m        watcher_list.delete()[0m
[30;1m1229 | [0m[35m        self.active_submissions.pop(sid)[0m
[30;1m1230 | [0m[35m        self.submissions_assignments.pop(sid)[0m

[31m--[ [0m[34mMatch #[0m[33m357[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1190 | [0m[35m        submission = task.submission[0m
[30;1m1191 | [0m[35m        sid = submission.sid[0m
[30;1m1192 | [0m[35m[0m
[30;1m1193 | [0m[35m        # Now that a submission is finished, we can remove it from the timeout list[0m
[30;1m1194 | [0m[35m        self._submission_timeouts.clear(task.sid)[0m
[30;1m1195 | [0m[35m[0m
[30;1m1196 | [0m[35m        if submission.params.quota_item and submission.params.submitter:[0m

[31m--[ [0m[34mMatch #[0m[33m358[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1117 | [0m[35m[0m
[30;1m1118 | [0m[35m        v3 names: get_service_params get_config_data[0m
[30;1m1119 | [0m[35m        """[0m
[30;1m1120 | [0m[35m        # Load the default service config[0m
[30;1m1121 | [0m[35m        params = {x.name: x.default for x in service.submission_params}[0m
[30;1m1122 | [0m[35m[0m
[30;1m1123 | [0m[35m        # Over write it with values from the submission[0m

[31m--[ [0m[34mMatch #[0m[33m359[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1113 | [0m[35m[0m
[30;1m1114 | [0m[35m    @classmethod[0m
[30;1m1115 | [0m[35m    def build_service_config(cls, service: Service, submission: Submission) -> dict[str, str]:[0m
[30;1m1116 | [0m[35m        """Prepare the service config that will be used downstream.[0m
[30;1m1117 | [0m[35m[0m
[30;1m1118 | [0m[35m        v3 names: get_service_params get_config_data[0m
[30;1m1119 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m360[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1084 | [0m[35m                    if task.submission.to_be_deleted:[0m
[30;1m1085 | [0m[35m                        break[0m
[30;1m1086 | [0m[35m[0m
[30;1m1087 | [0m[35m                    # Since the service is not finished or in progress, it must still need to start[0m
[30;1m1088 | [0m[35m                    pending_files.append(sha256)[0m
[30;1m1089 | [0m[35m                    break[0m
[30;1m1090 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m361[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1072 | [0m[35m                        # another service may require us to dispatch it though so continue rather th[0m
[30;1m1073 | [0m[35m                        continue[0m
[30;1m1074 | [0m[35m[0m
[30;1m1075 | [0m[35m                    # Check if the service is in queue, and handle it the same as being in progress.[0m
[30;1m1076 | [0m[35m                    # Check this one last, since it can require a remote call to redis rather than c[0m
[30;1m1077 | [0m[35m                    service_queue = get_service_queue(service_name, self.redis)[0m
[30;1m1078 | [0m[35m                    if key in task.queue_keys and service_queue.rank(task.queue_keys[key]) is not No[0m

[31m--[ [0m[34mMatch #[0m[33m362[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1069 | [0m[35m                    # with the submission.[0m
[30;1m1070 | [0m[35m                    if key in task.running_services:[0m
[30;1m1071 | [0m[35m                        processing_files.append(sha256)[0m
[30;1m1072 | [0m[35m                        # another service may require us to dispatch it though so continue rather th[0m
[30;1m1073 | [0m[35m                        continue[0m
[30;1m1074 | [0m[35m[0m
[30;1m1075 | [0m[35m                    # Check if the service is in queue, and handle it the same as being in progress.[0m

[31m--[ [0m[34mMatch #[0m[33m363[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1054 | [0m[35m                    if key in task.service_errors:[0m
[30;1m1055 | [0m[35m                        continue[0m
[30;1m1056 | [0m[35m[0m
[30;1m1057 | [0m[35m                    # if there is a result, then the service finished already[0m
[30;1m1058 | [0m[35m                    result = task.service_results.get(key)[0m
[30;1m1059 | [0m[35m                    if result:[0m
[30;1m1060 | [0m[35m                        if not task.submission.params.ignore_filtering and result.drop:[0m

[31m--[ [0m[34mMatch #[0m[33m364[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1049 | [0m[35m                    if not service:[0m
[30;1m1050 | [0m[35m                        continue[0m
[30;1m1051 | [0m[35m[0m
[30;1m1052 | [0m[35m                    # If there is an error we are finished with this service[0m
[30;1m1053 | [0m[35m                    key = sha256, service_name[0m
[30;1m1054 | [0m[35m                    if key in task.service_errors:[0m
[30;1m1055 | [0m[35m                        continue[0m
[30;1m1056 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m365[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1045 | [0m[35m[0m
[30;1m1046 | [0m[35m                    # Only active services should be in this dict, so if a service that was placed i[0m
[30;1m1047 | [0m[35m                    # schedule is now missing it has been disabled or taken offline.[0m
[30;1m1048 | [0m[35m                    service = self.scheduler.services.get(service_name)[0m
[30;1m1049 | [0m[35m                    if not service:[0m
[30;1m1050 | [0m[35m                        continue[0m
[30;1m1051 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m366[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1043 | [0m[35m                stage = schedule.pop(0)[0m
[30;1m1044 | [0m[35m                for service_name in stage:[0m
[30;1m1045 | [0m[35m[0m
[30;1m1046 | [0m[35m                    # Only active services should be in this dict, so if a service that was placed i[0m
[30;1m1047 | [0m[35m                    # schedule is now missing it has been disabled or taken offline.[0m
[30;1m1048 | [0m[35m                    service = self.scheduler.services.get(service_name)[0m
[30;1m1049 | [0m[35m                    if not service:[0m

[31m--[ [0m[34mMatch #[0m[33m367[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1020 | [0m[35m[0m
[30;1m1021 | [0m[35m        # Categorize files as pending/processing (can be both) all others are finished[0m
[30;1m1022 | [0m[35m        pending_files = []  # Files where we are missing a service and it is not being processed[0m
[30;1m1023 | [0m[35m        processing_files = []  # Files where at least one service is in progress/queued[0m
[30;1m1024 | [0m[35m[0m
[30;1m1025 | [0m[35m        # Track information about the results as we hit them[0m
[30;1m1026 | [0m[35m        file_scores: dict[str, int] = {}[0m

[31m--[ [0m[34mMatch #[0m[33m368[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1019 | [0m[35m        unchecked: set[str] = set(list(task.file_depth.keys()))[0m
[30;1m1020 | [0m[35m[0m
[30;1m1021 | [0m[35m        # Categorize files as pending/processing (can be both) all others are finished[0m
[30;1m1022 | [0m[35m        pending_files = []  # Files where we are missing a service and it is not being processed[0m
[30;1m1023 | [0m[35m        processing_files = []  # Files where at least one service is in progress/queued[0m
[30;1m1024 | [0m[35m[0m
[30;1m1025 | [0m[35m        # Track information about the results as we hit them[0m

[31m--[ [0m[34mMatch #[0m[33m369[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m993 | [0m[35m                pass[0m
[30;1m994 | [0m[35m            else:[0m
[30;1m995 | [0m[35m                # If we are not waiting, and have not taken an action, we must have hit the[0m
[30;1m996 | [0m[35m                # retry limit on the only service running. In that case, we can move directly[0m
[30;1m997 | [0m[35m                # onto the next stage of services, so recurse to trigger them.[0m
[30;1m998 | [0m[35m                return self.dispatch_file(task, sha256)[0m
[30;1m999 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m370[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m974 | [0m[35m                    ))[0m
[30;1m975 | [0m[35m                    service_task.metadata['dispatcher__'] = self.instance_id[0m
[30;1m976 | [0m[35m[0m
[30;1m977 | [0m[35m                    # Its a new task, send it to the service[0m
[30;1m978 | [0m[35m                    queue_key = service_queue.push(service_task.priority, service_task.as_primitives[0m
[30;1m979 | [0m[35m                    task.queue_keys[key] = queue_key[0m
[30;1m980 | [0m[35m                    sent.append(service_name)[0m
[30;1m981 | [0m[35m                    task.service_logs[key].append(f'Submitted to queue at {now_as_iso()}')[0m

[31m--[ [0m[34mMatch #[0m[33m371[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m947 | [0m[35m                    for service_name in prevented_services:[0m
[30;1m948 | [0m[35m                        task.forbid_for_children(sha256, service_name)[0m
[30;1m949 | [0m[35m[0m
[30;1m950 | [0m[35m                    # Build the actual service dispatch message[0m
[30;1m951 | [0m[35m                    config = self.build_service_config(service, submission)[0m
[30;1m952 | [0m[35m                    service_task = ServiceTask(dict([0m
[30;1m953 | [0m[35m                        sid=sid,[0m

[31m--[ [0m[34mMatch #[0m[33m372[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m887 | [0m[35m        if outstanding:[0m
[30;1m888 | [0m[35m            sent, enqueued, running, skipped = [], [], [], [][0m
[30;1m889 | [0m[35m[0m
[30;1m890 | [0m[35m            for service_name, service in outstanding.items():[0m
[30;1m891 | [0m[35m                with elasticapm.capture_span('dispatch_task', labels={'service': service_name}):[0m
[30;1m892 | [0m[35m                    service_queue = get_service_queue(service_name, self.redis)[0m
[30;1m893 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m373[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m877 | [0m[35m                        outstanding[service_name] = service[0m
[30;1m878 | [0m[35m                        continue[0m
[30;1m879 | [0m[35m[0m
[30;1m880 | [0m[35m                    # if the service finished, count the score, and check if the file has been dropp[0m
[30;1m881 | [0m[35m                    if not ignore_filtering and result.drop:[0m
[30;1m882 | [0m[35m                        # Clear out anything in the schedule after this stage[0m
[30;1m883 | [0m[35m                        task.file_schedules[sha256] = started_stages[0m

[31m--[ [0m[34mMatch #[0m[33m374[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m874 | [0m[35m                    # If we have no error, and no result, its not finished[0m
[30;1m875 | [0m[35m                    result = task.service_results.get(key)[0m
[30;1m876 | [0m[35m                    if not result:[0m
[30;1m877 | [0m[35m                        outstanding[service_name] = service[0m
[30;1m878 | [0m[35m                        continue[0m
[30;1m879 | [0m[35m[0m
[30;1m880 | [0m[35m                    # if the service finished, count the score, and check if the file has been dropp[0m
[30;1m881 | [0m[35m                    if not ignore_filtering and result.drop:[0m

[31m--[ [0m[34mMatch #[0m[33m375[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m867 | [0m[35m[0m
[30;1m868 | [0m[35m                    key = (sha256, service_name)[0m
[30;1m869 | [0m[35m[0m
[30;1m870 | [0m[35m                    # If the service terminated in an error, count the error and continue[0m
[30;1m871 | [0m[35m                    if key in task.service_errors:[0m
[30;1m872 | [0m[35m                        continue[0m
[30;1m873 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m376[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m861 | [0m[35m                started_stages.append(stage)[0m
[30;1m862 | [0m[35m[0m
[30;1m863 | [0m[35m                for service_name in stage:[0m
[30;1m864 | [0m[35m                    service = self.scheduler.services.get(service_name)[0m
[30;1m865 | [0m[35m                    if not service:[0m
[30;1m866 | [0m[35m                        continue[0m
[30;1m867 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m377[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m852 | [0m[35m        deep_scan, ignore_filtering = submission.params.deep_scan, submission.params.ignore_filterin[0m
[30;1m853 | [0m[35m[0m
[30;1m854 | [0m[35m        # Go through each round of the schedule removing complete/failed services[0m
[30;1m855 | [0m[35m        # Break when we find a stage that still needs processing[0m
[30;1m856 | [0m[35m        outstanding: dict[str, Service] = {}[0m
[30;1m857 | [0m[35m        started_stages = [][0m
[30;1m858 | [0m[35m        with elasticapm.capture_span('check_result_table'):[0m

[31m--[ [0m[34mMatch #[0m[33m378[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m837 | [0m[35m            forbidden_services = None[0m
[30;1m838 | [0m[35m[0m
[30;1m839 | [0m[35m            # If Dynamic Recursion Prevention is in effect and the file is not part of the bypass li[0m
[30;1m840 | [0m[35m            # Find the list of services this file is forbidden from being sent to.[0m
[30;1m841 | [0m[35m            # TODO: remove "or submission.params.ignore_dynamic_recursion_prevention" after assembly[0m
[30;1m842 | [0m[35m            ignore_drp = submission.params.ignore_recursion_prevention or submission.params.ignore_d[0m
[30;1m843 | [0m[35m            if not ignore_drp and sha256 not in task.dynamic_recursion_bypass:[0m

[31m--[ [0m[34mMatch #[0m[33m379[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m827 | [0m[35m            elasticapm.label(sid=sid, sha256=sha256)[0m
[30;1m828 | [0m[35m[0m
[30;1m829 | [0m[35m        file_depth: int = task.file_depth[sha256][0m
[30;1m830 | [0m[35m        # If its the first time we've seen this file, we won't have a schedule for it[0m
[30;1m831 | [0m[35m        if sha256 not in task.file_schedules:[0m
[30;1m832 | [0m[35m            # We are processing this file, load the file info, and build the schedule[0m
[30;1m833 | [0m[35m            file_info = self.get_fileinfo(task, sha256)[0m

[31m--[ [0m[34mMatch #[0m[33m380[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m818 | [0m[35m[0m
[30;1m819 | [0m[35m        :param task: Submission task object.[0m
[30;1m820 | [0m[35m        :param sha256: hash of the file to check.[0m
[30;1m821 | [0m[35m        :param timed_out_host: Name of the host that timed out after maximum service attempts.[0m
[30;1m822 | [0m[35m        :return: true if submission is finished.[0m
[30;1m823 | [0m[35m        """[0m
[30;1m824 | [0m[35m        submission = task.submission[0m

[31m--[ [0m[34mMatch #[0m[33m381[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m782 | [0m[35m                'archive_ts': None,[0m
[30;1m783 | [0m[35m                'expiry_ts': task.submission.expiry_ts,[0m
[30;1m784 | [0m[35m                'response': {[0m
[30;1m785 | [0m[35m                    'message': f"Couldn't find file info for {sha256} in submission {task.sid}",[0m
[30;1m786 | [0m[35m                    'service_name': 'Dispatcher',[0m
[30;1m787 | [0m[35m                    'service_tool_version': '4.0',[0m
[30;1m788 | [0m[35m                    'service_version': '4.0',[0m

[31m--[ [0m[34mMatch #[0m[33m382[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m694 | [0m[35m    @elasticapm.capture_span(span_type='dispatcher')[0m
[30;1m695 | [0m[35m    def dispatch_submission(self, task: SubmissionTask):[0m
[30;1m696 | [0m[35m        """[0m
[30;1m697 | [0m[35m        Find any files associated with a submission and dispatch them if they are[0m
[30;1m698 | [0m[35m        not marked as in progress. If all files are finished, finalize the submission.[0m
[30;1m699 | [0m[35m[0m
[30;1m700 | [0m[35m        This version of dispatch submission doesn't verify each result, but assumes that[0m

[31m--[ [0m[34mMatch #[0m[33m383[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m624 | [0m[35m[0m
[30;1m625 | [0m[35m        self.maintain_threads(threads)[0m
[30;1m626 | [0m[35m[0m
[30;1m627 | [0m[35m        # If the dispatcher is exiting cleanly remove as many tasks from the service queues as we ca[0m
[30;1m628 | [0m[35m        service_queues = {}[0m
[30;1m629 | [0m[35m        for task in self.tasks.values():[0m
[30;1m630 | [0m[35m            for (_sha256, service_name), dispatch_key in task.queue_keys.items():[0m

[31m--[ [0m[34mMatch #[0m[33m384[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m611 | [0m[35m            # Handle RPC commands[0m
[30;1m612 | [0m[35m            'Commands': self.handle_commands,[0m
[30;1m613 | [0m[35m            # Process to protect against old dead tasks timing out[0m
[30;1m614 | [0m[35m            'Global Timeout Backstop': self.timeout_backstop,[0m
[30;1m615 | [0m[35m        }[0m
[30;1m616 | [0m[35m[0m
[30;1m617 | [0m[35m        for ii in range(FINALIZE_THREADS):[0m

[31m--[ [0m[34mMatch #[0m[33m385[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m600 | [0m[35m            # pull start messages[0m
[30;1m601 | [0m[35m            'Pull Service Start': self.pull_service_starts,[0m
[30;1m602 | [0m[35m            # pull result messages[0m
[30;1m603 | [0m[35m            'Pull Service Result': self.pull_service_results,[0m
[30;1m604 | [0m[35m            # Save errors to DB[0m
[30;1m605 | [0m[35m            'Save Errors': self.save_errors,[0m
[30;1m606 | [0m[35m            # Handle timeouts[0m

[31m--[ [0m[34mMatch #[0m[33m386[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m598 | [0m[35m            # Pull in new submissions[0m
[30;1m599 | [0m[35m            'Pull Submissions': self.pull_submissions,[0m
[30;1m600 | [0m[35m            # pull start messages[0m
[30;1m601 | [0m[35m            'Pull Service Start': self.pull_service_starts,[0m
[30;1m602 | [0m[35m            # pull result messages[0m
[30;1m603 | [0m[35m            'Pull Service Result': self.pull_service_results,[0m
[30;1m604 | [0m[35m            # Save errors to DB[0m

[31m--[ [0m[34mMatch #[0m[33m387[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m576 | [0m[35m                    # Classification group is allowed to use this service[0m
[30;1m577 | [0m[35m                    service_set.add(service.name)[0m
[30;1m578 | [0m[35m                else:[0m
[30;1m579 | [0m[35m                    # Classification group isn't allowed to use this service[0m
[30;1m580 | [0m[35m                    if service.name in service_set:[0m
[30;1m581 | [0m[35m                        service_set.remove(service.name)[0m
[30;1m582 | [0m[35m[0m
[30;1m583 | [0m[35m    def process_queue_index(self, key: str) -> int:[0m

[31m--[ [0m[34mMatch #[0m[33m388[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m573 | [0m[35m            service: Service = self.datastore.get_service_with_delta(data.name)[0m
[30;1m574 | [0m[35m            for c12n, service_set in self.scheduler.c12n_services.items():[0m
[30;1m575 | [0m[35m                if self.classification_engine.is_accessible(c12n, service.classification):[0m
[30;1m576 | [0m[35m                    # Classification group is allowed to use this service[0m
[30;1m577 | [0m[35m                    service_set.add(service.name)[0m
[30;1m578 | [0m[35m                else:[0m
[30;1m579 | [0m[35m                    # Classification group isn't allowed to use this service[0m
[30;1m580 | [0m[35m                    if service.name in service_set:[0m

[31m--[ [0m[34mMatch #[0m[33m389[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m570 | [0m[35m                    service_set.remove(data.name)[0m
[30;1m571 | [0m[35m        else:[0m
[30;1m572 | [0m[35m            # If Added/Modifed, pull the service information and modify cache[0m
[30;1m573 | [0m[35m            service: Service = self.datastore.get_service_with_delta(data.name)[0m
[30;1m574 | [0m[35m            for c12n, service_set in self.scheduler.c12n_services.items():[0m
[30;1m575 | [0m[35m                if self.classification_engine.is_accessible(c12n, service.classification):[0m
[30;1m576 | [0m[35m                    # Classification group is allowed to use this service[0m

[31m--[ [0m[34mMatch #[0m[33m390[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m569 | [0m[35m                if data.name in service_set:[0m
[30;1m570 | [0m[35m                    service_set.remove(data.name)[0m
[30;1m571 | [0m[35m        else:[0m
[30;1m572 | [0m[35m            # If Added/Modifed, pull the service information and modify cache[0m
[30;1m573 | [0m[35m            service: Service = self.datastore.get_service_with_delta(data.name)[0m
[30;1m574 | [0m[35m            for c12n, service_set in self.scheduler.c12n_services.items():[0m
[30;1m575 | [0m[35m                if self.classification_engine.is_accessible(c12n, service.classification):[0m

[31m--[ [0m[34mMatch #[0m[33m391[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m564 | [0m[35m            self.scheduler.c12n_services.clear()[0m
[30;1m565 | [0m[35m            return[0m
[30;1m566 | [0m[35m        if data.operation == Operation.Removed:[0m
[30;1m567 | [0m[35m            # Remove all current instances of service from scheduler cache[0m
[30;1m568 | [0m[35m            for service_set in self.scheduler.c12n_services.values():[0m
[30;1m569 | [0m[35m                if data.name in service_set:[0m
[30;1m570 | [0m[35m                    service_set.remove(data.name)[0m

[31m--[ [0m[34mMatch #[0m[33m392[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m520 | [0m[35m        self.finalize_queue = Queue()[0m
[30;1m521 | [0m[35m        self.error_queue: Queue[tuple[str, Error]] = Queue()[0m
[30;1m522 | [0m[35m[0m
[30;1m523 | [0m[35m        # Queue to hold of service timeouts that need to be processed[0m
[30;1m524 | [0m[35m        # They will be held in this queue until results in redis are[0m
[30;1m525 | [0m[35m        # already processed[0m
[30;1m526 | [0m[35m        self.timeout_queue: Queue[DispatchAction] = Queue()[0m

[31m--[ [0m[34mMatch #[0m[33m393[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m421 | [0m[35mDISPATCH_DIRECTORY_FINALIZE = 'dispatchers-directory-finalizing'[0m
[30;1m422 | [0m[35mBAD_SID_HASH = 'bad-sid-hash'[0m
[30;1m423 | [0m[35mQUEUE_EXPIRY = 60*60[0m
[30;1m424 | [0m[35mSERVICE_VERSION_EXPIRY_TIME = 30 * 60  # How old service version info can be before we ignore it[0m
[30;1m425 | [0m[35mGUARD_TIMEOUT = 60*2[0m
[30;1m426 | [0m[35mGLOBAL_TASK_CHECK_INTERVAL = 60*10[0m
[30;1m427 | [0m[35mTIMEOUT_EXTRA_TIME = 5[0m

[31m--[ [0m[34mMatch #[0m[33m394[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m408 | [0m[35m        self.service_errors.pop((sha256, service_name), None)[0m
[30;1m409 | [0m[35m        self.service_attempts[(sha256, service_name)] = 1[0m
[30;1m410 | [0m[35m[0m
[30;1m411 | [0m[35m        # Try to get the service to run again by reseting the schedule for that service[0m
[30;1m412 | [0m[35m        self.file_schedules.pop(sha256, None)[0m
[30;1m413 | [0m[35m[0m
[30;1m414 | [0m[35m[0m
[30;1m415 | [0m[35mDISPATCH_TASK_ASSIGNMENT = 'dispatcher-tasks-assigned-to-'[0m

[31m--[ [0m[34mMatch #[0m[33m395[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m408 | [0m[35m        self.service_errors.pop((sha256, service_name), None)[0m
[30;1m409 | [0m[35m        self.service_attempts[(sha256, service_name)] = 1[0m
[30;1m410 | [0m[35m[0m
[30;1m411 | [0m[35m        # Try to get the service to run again by reseting the schedule for that service[0m
[30;1m412 | [0m[35m        self.file_schedules.pop(sha256, None)[0m
[30;1m413 | [0m[35m[0m
[30;1m414 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m396[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m388 | [0m[35m                result = self.service_results.get((sha256, service))[0m
[30;1m389 | [0m[35m                if not result:[0m
[30;1m390 | [0m[35m                    # If the value has changed since the last dispatch but results haven't come in y[0m
[30;1m391 | [0m[35m                    # mark this service to be disptached later. This will only happen if the service[0m
[30;1m392 | [0m[35m                    # returns partial results, if there are full results the entry will be cleared i[0m
[30;1m393 | [0m[35m                    entry.dispatch_needed = True[0m
[30;1m394 | [0m[35m                else:[0m
[30;1m395 | [0m[35m                    # If there are results and there is a monitoring entry, the result was partial[0m

[31m--[ [0m[34mMatch #[0m[33m397[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m388 | [0m[35m                result = self.service_results.get((sha256, service))[0m
[30;1m389 | [0m[35m                if not result:[0m
[30;1m390 | [0m[35m                    # If the value has changed since the last dispatch but results haven't come in y[0m
[30;1m391 | [0m[35m                    # mark this service to be disptached later. This will only happen if the service[0m
[30;1m392 | [0m[35m                    # returns partial results, if there are full results the entry will be cleared i[0m
[30;1m393 | [0m[35m                    entry.dispatch_needed = True[0m
[30;1m394 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m398[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m380 | [0m[35m            if key not in entry.values:[0m
[30;1m381 | [0m[35m                continue[0m
[30;1m382 | [0m[35m[0m
[30;1m383 | [0m[35m            # Get whatever values (if any) were provided on the previous dispatch of this service[0m
[30;1m384 | [0m[35m            value = self.temporary_data[sha256].read_key(key)[0m
[30;1m385 | [0m[35m            dispatched_value = entry.values.get(key)[0m
[30;1m386 | [0m[35m[0m
[30;1m387 | [0m[35m            if type(value) is not type(dispatched_value) or value != dispatched_value:[0m

[31m--[ [0m[34mMatch #[0m[33m399[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m367 | [0m[35m        """A service has completed normally. If the service is monitoring clear out the record."""[0m
[30;1m368 | [0m[35m        # We have an incoming non-partial result, flush out any partial monitoring[0m
[30;1m369 | [0m[35m        self.monitoring.pop((sha256, service_name), None)[0m
[30;1m370 | [0m[35m        # If there is a partial result for this service flush that as well so we accept this new res[0m
[30;1m371 | [0m[35m        result = self.service_results.get((sha256, service_name))[0m
[30;1m372 | [0m[35m        if result and result.partial:[0m
[30;1m373 | [0m[35m            self.service_results.pop((sha256, service_name), None)[0m

[31m--[ [0m[34mMatch #[0m[33m400[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m364 | [0m[35m        return False[0m
[30;1m365 | [0m[35m[0m
[30;1m366 | [0m[35m    def clear_monitoring_entry(self, sha256, service_name):[0m
[30;1m367 | [0m[35m        """A service has completed normally. If the service is monitoring clear out the record."""[0m
[30;1m368 | [0m[35m        # We have an incoming non-partial result, flush out any partial monitoring[0m
[30;1m369 | [0m[35m        self.monitoring.pop((sha256, service_name), None)[0m
[30;1m370 | [0m[35m        # If there is a partial result for this service flush that as well so we accept this new res[0m

[31m--[ [0m[34mMatch #[0m[33m401[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m364 | [0m[35m        return False[0m
[30;1m365 | [0m[35m[0m
[30;1m366 | [0m[35m    def clear_monitoring_entry(self, sha256, service_name):[0m
[30;1m367 | [0m[35m        """A service has completed normally. If the service is monitoring clear out the record."""[0m
[30;1m368 | [0m[35m        # We have an incoming non-partial result, flush out any partial monitoring[0m
[30;1m369 | [0m[35m        self.monitoring.pop((sha256, service_name), None)[0m
[30;1m370 | [0m[35m        # If there is a partial result for this service flush that as well so we accept this new res[0m

[31m--[ [0m[34mMatch #[0m[33m402[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m344 | [0m[35m        ]))[0m
[30;1m345 | [0m[35m[0m
[30;1m346 | [0m[35m    def set_monitoring_entry(self, sha256: str, service_name: str, values: dict[str, Optional[str]])[0m
[30;1m347 | [0m[35m        """A service with monitoring has dispatched, keep track of the conditions."""[0m
[30;1m348 | [0m[35m        self.monitoring[(sha256, service_name)] = MonitorTask([0m
[30;1m349 | [0m[35m            service=service_name,[0m
[30;1m350 | [0m[35m            sha=sha256,[0m

[31m--[ [0m[34mMatch #[0m[33m403[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m334 | [0m[35m        """[0m
[30;1m335 | [0m[35m        Return a list of services that should be excluded for the given file.[0m
[30;1m336 | [0m[35m[0m
[30;1m337 | [0m[35m        Note that this is computed dynamically from the parent map every time it is[0m
[30;1m338 | [0m[35m        called. This is to account for out of order result collection in unusual[0m
[30;1m339 | [0m[35m        circumstances like replay.[0m
[30;1m340 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m404[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m269 | [0m[35m            # Replay the process of receiving results for dispatcher internal state[0m
[30;1m270 | [0m[35m            for k, result in results.items():[0m
[30;1m271 | [0m[35m                sha256, service, _ = k.split('.', 2)[0m
[30;1m272 | [0m[35m                if service not in rescan:[0m
[30;1m273 | [0m[35m                    extracted = result['response']['extracted'][0m
[30;1m274 | [0m[35m                    children: list[str] = [r['sha256'] for r in extracted][0m
[30;1m275 | [0m[35m                    self.register_children(sha256, children)[0m

[31m--[ [0m[34mMatch #[0m[33m405[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m253 | [0m[35m            # Replay the process of routing files for dispatcher internal state.[0m
[30;1m254 | [0m[35m            for k, result in results.items():[0m
[30;1m255 | [0m[35m                sha256, service, _ = k.split('.', 2)[0m
[30;1m256 | [0m[35m                service = scheduler.services.get(service)[0m
[30;1m257 | [0m[35m                if not service:[0m
[30;1m258 | [0m[35m                    continue[0m
[30;1m259 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m406[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m185 | [0m[35m        if not isinstance(values, (list, tuple)):[0m
[30;1m186 | [0m[35m            return False[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m        # Add each value one at a time testing for new values[0m
[30;1m189 | [0m[35m        # This is slower than using set intersection, but isn't type sensitive[0m
[30;1m190 | [0m[35m        changed = False[0m
[30;1m191 | [0m[35m        for new_item in values:[0m

[31m--[ [0m[34mMatch #[0m[33m407[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m94 | [0m[35m@dataclasses.dataclass()[0m
[30;1m95 | [0m[35mclass MonitorTask:[0m
[30;1m96 | [0m[35m    """Tracks whether a task needs to be rerun based on """[0m
[30;1m97 | [0m[35m    # Service name[0m
[30;1m98 | [0m[35m    service: str[0m
[30;1m99 | [0m[35m    # sha256 of file in question[0m
[30;1m100 | [0m[35m    sha: str[0m

[31m--[ [0m[34mMatch #[0m[33m408[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m32 | [0m[35mfrom assemblyline.odm.messages.task import FileInfo, Task as ServiceTask[0m
[30;1m33 | [0m[35mfrom assemblyline.odm.models.error import Error[0m
[30;1m34 | [0m[35mfrom assemblyline.odm.models.result import Result[0m
[30;1m35 | [0m[35mfrom assemblyline.odm.models.service import Service[0m
[30;1m36 | [0m[35mfrom assemblyline.odm.models.submission import Submission[0m
[30;1m37 | [0m[35mfrom assemblyline.odm.models.user import User[0m
[30;1m38 | [0m[35mfrom assemblyline.remote.datatypes.exporting_counter import export_metrics_once[0m
[30;1m39 | [0m[35mfrom assemblyline.remote.datatypes.events import EventWatcher[0m

[31m--[ [0m[34mMatch #[0m[33m409[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mimport uuid[0m
[30;1m3 | [0m[35mimport os[0m
[30;1m4 | [0m[35mimport threading[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mfrom collections import defaultdict[0m
[30;1m7 | [0m[35mfrom contextlib import contextmanager[0m
[30;1m8 | [0m[35mimport typing[0m
[30;1m9 | [0m[35mfrom typing import Optional, Any, TYPE_CHECKING, Iterable[0m

[31m--[ [0m[34mMatch #[0m[33m410[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_worker_submit.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom unittest import mock[0m
[30;1m2 | [0m[35mimport pytest[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom assemblyline.datastore.helper import AssemblylineDatastore[0m
[30;1m6 | [0m[35mfrom assemblyline.odm.models.submission import SubmissionParams[0m
[30;1m7 | [0m[35mfrom assemblyline.odm.models.filescore import FileScore[0m

[31m--[ [0m[34mMatch #[0m[33m411[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/stream_map.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m            return self.table[stream_id][0m
[30;1m93 | [0m[35m        except KeyError:[0m
[30;1m94 | [0m[35m            self._load_stream_map()[0m
[30;1m95 | [0m[35m            return self.table.get(stream_id)[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35mif __name__ == '__main__':[0m

[31m--[ [0m[34mMatch #[0m[33m412[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/stream_map.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m                            name=stream['STREAM_NAME'],[0m
[30;1m74 | [0m[35m                            description=stream['STREAM_DESCRIPTION'],[0m
[30;1m75 | [0m[35m                            zone_id=stream['ZONE'],[0m
[30;1m76 | [0m[35m                            classification=f"{stream.get('LEVEL', 'PB')}//{stream.get('CAVEAT', 'CND[0m
[30;1m77 | [0m[35m                        )[0m
[30;1m78 | [0m[35m                        table[stream.id] = stream[0m
[30;1m79 | [0m[35m            except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m413[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/stream_map.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m                            name=stream['STREAM_NAME'],[0m
[30;1m74 | [0m[35m                            description=stream['STREAM_DESCRIPTION'],[0m
[30;1m75 | [0m[35m                            zone_id=stream['ZONE'],[0m
[30;1m76 | [0m[35m                            classification=f"{stream.get('LEVEL', 'PB')}//{stream.get('CAVEAT', 'CND[0m
[30;1m77 | [0m[35m                        )[0m
[30;1m78 | [0m[35m                        table[stream.id] = stream[0m
[30;1m79 | [0m[35m            except Exception:[0m

[31m--[ [0m[34mMatch #[0m[33m414[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/stream_map.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m            try:[0m
[30;1m66 | [0m[35m                if self.url:[0m
[30;1m67 | [0m[35m                    res = requests.get(self.url, verify=False)[0m
[30;1m68 | [0m[35m                    res.raise_for_status()[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m                    for stream in res.json()['data']:[0m

[31m--[ [0m[34mMatch #[0m[33m415[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/stream_map.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m                            name=stream['STREAM_NAME'],[0m
[30;1m56 | [0m[35m                            description=stream['STREAM_DESCRIPTION'],[0m
[30;1m57 | [0m[35m                            zone_id=stream['ZONE'],[0m
[30;1m58 | [0m[35m                            classification=f"{stream.get('LEVEL', 'PB')}//{stream.get('CAVEAT', 'CND[0m
[30;1m59 | [0m[35m                        )[0m
[30;1m60 | [0m[35m                        table[stream.id] = stream[0m
[30;1m61 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m416[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/stream_map.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m                            name=stream['STREAM_NAME'],[0m
[30;1m56 | [0m[35m                            description=stream['STREAM_DESCRIPTION'],[0m
[30;1m57 | [0m[35m                            zone_id=stream['ZONE'],[0m
[30;1m58 | [0m[35m                            classification=f"{stream.get('LEVEL', 'PB')}//{stream.get('CAVEAT', 'CND[0m
[30;1m59 | [0m[35m                        )[0m
[30;1m60 | [0m[35m                        table[stream.id] = stream[0m
[30;1m61 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m417[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/stream_map.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mimport threading[0m
[30;1m3 | [0m[35mimport functools[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mfrom typing import Optional[0m

[31m--[ [0m[34mMatch #[0m[33m418[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m### Updater[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35mMake sure the different services get their latest update files.[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m```bash[0m
[30;1m137 | [0m[35mdocker run --name updater cccs/assemblyline-core python -m assemblyline_core.updater.run_updater[0m

[31m--[ [0m[34mMatch #[0m[33m419[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35mExécute les différents flux de travail dans le système et appliquer leurs étiquettes, leur priorité [0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m```bash[0m
[30;1m251 | [0m[35mdocker run --name workflow cccs/assemblyline-core python -m assemblyline_core.workflow.run_workflow[0m
[30;1m252 | [0m[35m```[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m## Documentation[0m

[31m--[ [0m[34mMatch #[0m[33m420[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35mAssure que les différents services reçoivent leurs derniers fichiers de mise à jour.[0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35m```bash[0m
[30;1m243 | [0m[35mdocker run --name updater cccs/assemblyline-core python -m assemblyline_core.updater.run_updater[0m
[30;1m244 | [0m[35m```[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m### Workflow[0m

[31m--[ [0m[34mMatch #[0m[33m421[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35mAugmente et diminue les services dans le système en fonction de la charge.[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m```bash[0m
[30;1m235 | [0m[35mdocker run --name scaler cccs/assemblyline-core python -m assemblyline_core.scaler.run_scaler[0m
[30;1m236 | [0m[35m```[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m### Mise à jour[0m

[31m--[ [0m[34mMatch #[0m[33m422[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m##### Agrégateur de statistiques[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m```bash[0m
[30;1m227 | [0m[35mdocker run --name statistics cccs/assemblyline-core python -m assemblyline_core.metrics.run_statisti[0m
[30;1m228 | [0m[35m```[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m### Scaler[0m

[31m--[ [0m[34mMatch #[0m[33m423[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m#### Agrégateur de métriques[0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35m```bash[0m
[30;1m221 | [0m[35mdocker run --name metrics cccs/assemblyline-core python -m assemblyline_core.metrics.run_metrics_agg[0m
[30;1m222 | [0m[35m```[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m##### Agrégateur de statistiques[0m

[31m--[ [0m[34mMatch #[0m[33m424[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m#### Heartbeat Manager[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m```bash[0m
[30;1m215 | [0m[35mdocker run --name heartbeat cccs/assemblyline-core python -m assemblyline_core.metrics.run_heartbeat[0m
[30;1m216 | [0m[35m```[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m#### Agrégateur de métriques[0m

[31m--[ [0m[34mMatch #[0m[33m425[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35mDéplace les fichiers ingérés des files d'attente prioritaires vers les files d'attente de traitement[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m```bash[0m
[30;1m205 | [0m[35mdocker run --name ingester cccs/assemblyline-core python -m assemblyline_core.ingester[0m
[30;1m206 | [0m[35m```[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m### Métriques[0m

[31m--[ [0m[34mMatch #[0m[33m426[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35mSupprimer les soumissions et leurs résultats à l'expiration de leur durée de vie.[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m```bash[0m
[30;1m197 | [0m[35mdocker run --name expiry cccs/assemblyline-core python -m assemblyline_core.expiry.run_expiry[0m
[30;1m198 | [0m[35m```[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m### Ingester[0m

[31m--[ [0m[34mMatch #[0m[33m427[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35mAchemine les fichiers dans le système durant une soumission. S'assure que tous les fichiers de la so[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m```bash[0m
[30;1m189 | [0m[35mdocker run --name dispatcher cccs/assemblyline-core python -m assemblyline_core.dispatching[0m
[30;1m190 | [0m[35m```[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m### Expiration[0m

[31m--[ [0m[34mMatch #[0m[33m428[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35mArchivage des soumissions, de leurs résultats et des fichiers dans l'archive.[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m```bash[0m
[30;1m181 | [0m[35mdocker run --name archiver cccs/assemblyline-core python -m assemblyline_core.archiver.run_archiver[0m
[30;1m182 | [0m[35m```[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m### Dispatcher[0m

[31m--[ [0m[34mMatch #[0m[33m429[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35mCrée des alertes pour les différentes soumissions dans le système.[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m```bash[0m
[30;1m173 | [0m[35mdocker run --name alerter cccs/assemblyline-core python -m assemblyline_core.alerter.run_alerter[0m
[30;1m174 | [0m[35m```[0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m### Archiver[0m

[31m--[ [0m[34mMatch #[0m[33m430[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35mRun the different workflows in the system and apply their labels, priority and status.[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m```bash[0m
[30;1m145 | [0m[35mdocker run --name workflow cccs/assemblyline-core python -m assemblyline_core.workflow.run_workflow[0m
[30;1m146 | [0m[35m```[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m## Documentation[0m

[31m--[ [0m[34mMatch #[0m[33m431[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35mMake sure the different services get their latest update files.[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m```bash[0m
[30;1m137 | [0m[35mdocker run --name updater cccs/assemblyline-core python -m assemblyline_core.updater.run_updater[0m
[30;1m138 | [0m[35m```[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m### Workflow[0m

[31m--[ [0m[34mMatch #[0m[33m432[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35mSpin up and down services in the system depending on the load.[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m```bash[0m
[30;1m129 | [0m[35mdocker run --name scaler cccs/assemblyline-core python -m assemblyline_core.scaler.run_scaler[0m
[30;1m130 | [0m[35m```[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m### Updater[0m

[31m--[ [0m[34mMatch #[0m[33m433[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m#### Statistics Aggregator[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m```bash[0m
[30;1m121 | [0m[35mdocker run --name statistics cccs/assemblyline-core python -m assemblyline_core.metrics.run_statisti[0m
[30;1m122 | [0m[35m```[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m### Scaler[0m

[31m--[ [0m[34mMatch #[0m[33m434[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m#### Metrics Aggregator[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m```bash[0m
[30;1m115 | [0m[35mdocker run --name metrics cccs/assemblyline-core python -m assemblyline_core.metrics.run_metrics_agg[0m
[30;1m116 | [0m[35m```[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m#### Statistics Aggregator[0m

[31m--[ [0m[34mMatch #[0m[33m435[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m#### Heartbeat Manager[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m```bash[0m
[30;1m109 | [0m[35mdocker run --name heartbeat cccs/assemblyline-core python -m assemblyline_core.metrics.run_heartbeat[0m
[30;1m110 | [0m[35m```[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m#### Metrics Aggregator[0m

[31m--[ [0m[34mMatch #[0m[33m436[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35mMove ingested files from the priority queues to the processing queues.[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m```bash[0m
[30;1m99 | [0m[35mdocker run --name ingester cccs/assemblyline-core python -m assemblyline_core.ingester[0m
[30;1m100 | [0m[35m```[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m### Metrics[0m

[31m--[ [0m[34mMatch #[0m[33m437[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35mDelete submissions and their results when their time-to-live expires.[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m```bash[0m
[30;1m91 | [0m[35mdocker run --name expiry cccs/assemblyline-core python -m assemblyline_core.expiry.run_expiry[0m
[30;1m92 | [0m[35m```[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m### Ingester[0m

[31m--[ [0m[34mMatch #[0m[33m438[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35mRoute the files in the system while a submission is tacking place. Make sure all files during a subm[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m```bash[0m
[30;1m83 | [0m[35mdocker run --name dispatcher cccs/assemblyline-core python -m assemblyline_core.dispatching[0m
[30;1m84 | [0m[35m```[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m### Expiry[0m

[31m--[ [0m[34mMatch #[0m[33m439[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35mArchives submissions and their results & files into the archive.[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m```bash[0m
[30;1m75 | [0m[35mdocker run --name archiver cccs/assemblyline-core python -m assemblyline_core.archiver.run_archiver[0m
[30;1m76 | [0m[35m```[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m### Dispatcher[0m

[31m--[ [0m[34mMatch #[0m[33m440[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35mCreate alerts for the different submissions in the system.[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m```bash[0m
[30;1m67 | [0m[35mdocker run --name alerter cccs/assemblyline-core python -m assemblyline_core.alerter.run_alerter[0m
[30;1m68 | [0m[35m```[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m### Archiver[0m

[31m--[ [0m[34mMatch #[0m[33m441[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core.egg-info/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35mDescription-Content-Type: text/markdown[0m
[30;1m21 | [0m[35mLicense-File: LICENCE.md[0m
[30;1m22 | [0m[35mRequires-Dist: assemblyline[0m
[30;1m23 | [0m[35mRequires-Dist: docker[0m
[30;1m24 | [0m[35mRequires-Dist: kubernetes[0m
[30;1m25 | [0m[35mProvides-Extra: test[0m
[30;1m26 | [0m[35mRequires-Dist: pytest; extra == "test"[0m
[30;1m27 | [0m[35mRequires-Dist: assemblyline_client; extra == "test"[0m

[31m--[ [0m[34mMatch #[0m[33m442[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m337 | [0m[35m            else:[0m
[30;1m338 | [0m[35m                # The tags are coming from another repository, so we're don't know the ordering of t[0m
[30;1m339 | [0m[35m                tags.extend(tag_info.get('name') for tag_info in response_data['results'] if tag_inf[0m
[30;1m340 | [0m[35m            url = response_data.get('next')[0m
[30;1m341 | [0m[35m            if not url:[0m
[30;1m342 | [0m[35m                logger.info(f"{prefix}No more pages left to fetch.")[0m
[30;1m343 | [0m[35m                break[0m

[31m--[ [0m[34mMatch #[0m[33m443[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m336 | [0m[35m                        return [tag_name][0m
[30;1m337 | [0m[35m            else:[0m
[30;1m338 | [0m[35m                # The tags are coming from another repository, so we're don't know the ordering of t[0m
[30;1m339 | [0m[35m                tags.extend(tag_info.get('name') for tag_info in response_data['results'] if tag_inf[0m
[30;1m340 | [0m[35m            url = response_data.get('next')[0m
[30;1m341 | [0m[35m            if not url:[0m
[30;1m342 | [0m[35m                logger.info(f"{prefix}No more pages left to fetch.")[0m

[31m--[ [0m[34mMatch #[0m[33m444[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m336 | [0m[35m                        return [tag_name][0m
[30;1m337 | [0m[35m            else:[0m
[30;1m338 | [0m[35m                # The tags are coming from another repository, so we're don't know the ordering of t[0m
[30;1m339 | [0m[35m                tags.extend(tag_info.get('name') for tag_info in response_data['results'] if tag_inf[0m
[30;1m340 | [0m[35m            url = response_data.get('next')[0m
[30;1m341 | [0m[35m            if not url:[0m
[30;1m342 | [0m[35m                logger.info(f"{prefix}No more pages left to fetch.")[0m

[31m--[ [0m[34mMatch #[0m[33m445[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m325 | [0m[35m            if namespace == "cccs":[0m
[30;1m326 | [0m[35m                # The tags are coming from a repository managed by the Assemblyline team[0m
[30;1m327 | [0m[35m                for tag_info in response_data['results']:[0m
[30;1m328 | [0m[35m                    tag_name = tag_info.get('name')[0m
[30;1m329 | [0m[35m                    if tag_name and tag_name == f"{FRAMEWORK_VERSION}.{SYSTEM_VERSION}.{update_chann[0m
[30;1m330 | [0m[35m                        # Ignore tag aliases containing the update_channel[0m
[30;1m331 | [0m[35m                        continue[0m

[31m--[ [0m[34mMatch #[0m[33m446[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m319 | [0m[35m    tags = [][0m
[30;1m320 | [0m[35m    while True:[0m
[30;1m321 | [0m[35m        try:[0m
[30;1m322 | [0m[35m            response = requests.get(url, proxies=proxies)[0m
[30;1m323 | [0m[35m            response.raise_for_status()  # Raises an HTTPError for bad responses[0m
[30;1m324 | [0m[35m            response_data = response.json()[0m
[30;1m325 | [0m[35m            if namespace == "cccs":[0m

[31m--[ [0m[34mMatch #[0m[33m447[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m244 | [0m[35m                    data=f"grant_type=access_token&service={server}&access_token={aad_token}",[0m
[30;1m245 | [0m[35m                    proxies=proxies).json()["refresh_token"][0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35m                token = requests.post([0m
[30;1m248 | [0m[35m                    f"https://{server}/oauth2/token",[0m
[30;1m249 | [0m[35m                    headers={"Content-Type": "application/x-www-form-urlencoded"},[0m
[30;1m250 | [0m[35m                    data=f"grant_type=refresh_token&service={server}&refresh_token={refresh_token}"[0m

[31m--[ [0m[34mMatch #[0m[33m448[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m238 | [0m[35m                credentials = DefaultAzureCredential()[0m
[30;1m239 | [0m[35m                aad_token = credentials.get_token('https://management.core.windows.net/.default').to[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35m                refresh_token = requests.post([0m
[30;1m242 | [0m[35m                    f"https://{server}/oauth2/exchange",[0m
[30;1m243 | [0m[35m                    headers={"Content-Type": "application/x-www-form-urlencoded"},[0m
[30;1m244 | [0m[35m                    data=f"grant_type=access_token&service={server}&access_token={aad_token}",[0m

[31m--[ [0m[34mMatch #[0m[33m449[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m232 | [0m[35m        auth = f"Bearer {auth_config['password']}"[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m    if server.endswith(".azurecr.io"):[0m
[30;1m235 | [0m[35m        if auth_config.get('use_fic', False):[0m
[30;1m236 | [0m[35m            # If the use of federated identity token is set, exchange said token to an ACR token[0m
[30;1m237 | [0m[35m            try:[0m
[30;1m238 | [0m[35m                credentials = DefaultAzureCredential()[0m

[31m--[ [0m[34mMatch #[0m[33m450[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m122 | [0m[35m            resp = self._perform_request(token_url, headers, verify, proxies)[0m
[30;1m123 | [0m[35m            if resp and resp.ok:[0m
[30;1m124 | [0m[35m                # Request to obtain token was successful, set Authorization header for registry API[0m
[30;1m125 | [0m[35m                token = resp.json().get('token')[0m
[30;1m126 | [0m[35m                headers["Authorization"] = f"Bearer {token}"[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m        resp = self._perform_request(url, headers, verify, proxies)[0m

[31m--[ [0m[34mMatch #[0m[33m451[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m            resp = self._perform_request(token_url, headers, verify, proxies)[0m
[30;1m91 | [0m[35m            if resp and resp.ok:[0m
[30;1m92 | [0m[35m                # Request to obtain token was successful, set Authorization header for registry API[0m
[30;1m93 | [0m[35m                token = resp.json().get('access_token')[0m
[30;1m94 | [0m[35m                headers["Authorization"] = f"Bearer {token}"[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m                resp = self._perform_request(url, headers, verify, proxies)[0m

[31m--[ [0m[34mMatch #[0m[33m452[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m            resp = self._perform_request(token_url, headers, verify, proxies)[0m
[30;1m58 | [0m[35m            if resp and resp.ok:[0m
[30;1m59 | [0m[35m                # Request to obtain token was successful, set Authorization header for registry API[0m
[30;1m60 | [0m[35m                token = resp.json().get('token')[0m
[30;1m61 | [0m[35m                headers["Authorization"] = f"Bearer {token}"[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        resp = self._perform_request(url, headers, verify, proxies)[0m

[31m--[ [0m[34mMatch #[0m[33m453[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m            # Connect to insecure registry over HTTP (development only)[0m
[30;1m36 | [0m[35m            if not verify:[0m
[30;1m37 | [0m[35m                url = url.replace('https://','http://')[0m
[30;1m38 | [0m[35m                resp = requests.get(url, headers=headers, verify=verify, proxies=proxies)[0m
[30;1m39 | [0m[35m        return resp[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m454[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m30 | [0m[35m    def _perform_request(self, url, headers, verify, proxies):[0m
[30;1m31 | [0m[35m        resp = None[0m
[30;1m32 | [0m[35m        try:[0m
[30;1m33 | [0m[35m            resp = requests.get(url, headers=headers, verify=verify, proxies=proxies)[0m
[30;1m34 | [0m[35m        except requests.exceptions.SSLError:[0m
[30;1m35 | [0m[35m            # Connect to insecure registry over HTTP (development only)[0m
[30;1m36 | [0m[35m            if not verify:[0m

[31m--[ [0m[34mMatch #[0m[33m455[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m298 | [0m[35mdef _get_dockerhub_tags(image_name, update_channel, prefix, proxies=None, docker_registry=DEFAULT_DO[0m
[30;1m299 | [0m[35m                        logger: Logger=None):[0m
[30;1m300 | [0m[35m    """[0m
[30;1m301 | [0m[35m    Retrieve DockerHub tags for a specific image and update channel.[0m
[30;1m302 | [0m[35m    Args:[0m
[30;1m303 | [0m[35m    image_name (str): Full name of the image (including namespace).[0m
[30;1m304 | [0m[35m    update_channel (str): Specific channel to filter tags (e.g., stable, beta).[0m

[31m--[ [0m[34mMatch #[0m[33m456[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m                resp = self._perform_request(url, headers, verify, proxies)[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m        # At this point, we should have a response from the API[0m
[30;1m99 | [0m[35m        if resp and resp.ok:[0m
[30;1m100 | [0m[35m            # Test for positive list of tags[0m
[30;1m101 | [0m[35m            resp_data = resp.json()[0m

[31m--[ [0m[34mMatch #[0m[33m457[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m303 | [0m[35m    image_name (str): Full name of the image (including namespace).[0m
[30;1m304 | [0m[35m    update_channel (str): Specific channel to filter tags (e.g., stable, beta).[0m
[30;1m305 | [0m[35m    proxies (dict, optional): Proxy configuration.[0m
[30;1m306 | [0m[35m    docker_registry (str, optional): Docker registry URL. Defaults to DEFAULT_DOCKER_REGISTRY.[0m
[30;1m307 | [0m[35m    Returns:[0m
[30;1m308 | [0m[35m    list: A list of tag names that match the given criteria, or None if an error occurs.[0m
[30;1m309 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m458[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m283 | [0m[35m            tag_name = tag[0m
[30;1m284 | [0m[35m    logger.info(f"{prefix}Latest {service_name} tag on {update_channel.upper()} channel is: {tag_nam[0m
[30;1m285 | [0m[35m[0m
[30;1m286 | [0m[35m    # Fix service image for use in Kubernetes[0m
[30;1m287 | [0m[35m    image_variables = defaultdict(str)[0m
[30;1m288 | [0m[35m    image_variables.update(system_config.services.image_variables)[0m
[30;1m289 | [0m[35m    image = string.Template(image).safe_substitute(image_variables)[0m

[31m--[ [0m[34mMatch #[0m[33m459[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m270 | [0m[35m    tags = [tag for tag in tags[0m
[30;1m271 | [0m[35m            if re.match(f"({FRAMEWORK_VERSION})\\.({SYSTEM_VERSION})\\.\\d+\\.({update_channel})\\d+[0m
[30;1m272 | [0m[35m    if not tags:[0m
[30;1m273 | [0m[35m        logger.warning(f"{prefix} Cannot fetch latest tag for service {service_name} - {image_name}"[0m
[30;1m274 | [0m[35m                       f" => [server: {server}, repo_name: {image_name}, channel: {update_channel}]"[0m
[30;1m275 | [0m[35m    tag_name = None[0m
[30;1m276 | [0m[35m    for tag in tags:[0m

[31m--[ [0m[34mMatch #[0m[33m460[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m202 | [0m[35m    if auto_update is None:[0m
[30;1m203 | [0m[35m        auto_update = system_config.services.default_auto_update[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m    # Fix service image for calling Docker API[0m
[30;1m206 | [0m[35m    image_variables = defaultdict(str)[0m
[30;1m207 | [0m[35m    image_variables.update(system_config.services.image_variables)[0m
[30;1m208 | [0m[35m    image_variables.update(system_config.services.update_image_variables)[0m

[31m--[ [0m[34mMatch #[0m[33m461[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m202 | [0m[35m    if auto_update is None:[0m
[30;1m203 | [0m[35m        auto_update = system_config.services.default_auto_update[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m    # Fix service image for calling Docker API[0m
[30;1m206 | [0m[35m    image_variables = defaultdict(str)[0m
[30;1m207 | [0m[35m    image_variables.update(system_config.services.image_variables)[0m
[30;1m208 | [0m[35m    image_variables.update(system_config.services.update_image_variables)[0m

[31m--[ [0m[34mMatch #[0m[33m462[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m194 | [0m[35m        image_name = image_name.rsplit(":", 1)[0][0m
[30;1m195 | [0m[35m        return server, image_name[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m    # Extract and process service information[0m
[30;1m198 | [0m[35m    service_name = service_config.name[0m
[30;1m199 | [0m[35m    image = service_config.docker_config.image[0m
[30;1m200 | [0m[35m    update_channel = service_config.update_channel[0m

[31m--[ [0m[34mMatch #[0m[33m463[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m174 | [0m[35m        tuple: Returns a tuple of the final image name, the latest tag, authentication and auto_upda[0m
[30;1m175 | [0m[35m    """[0m
[30;1m176 | [0m[35m    def process_image(image):[0m
[30;1m177 | [0m[35m        # Find which server to search in[0m
[30;1m178 | [0m[35m        server = image.split("/")[0][0m
[30;1m179 | [0m[35m        if server != "cccs":[0m
[30;1m180 | [0m[35m            if ":" in server:[0m

[31m--[ [0m[34mMatch #[0m[33m464[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m171 | [0m[35m        logger (Logger): Logger object for logging messages.[0m
[30;1m172 | [0m[35m        prefix (str, optional): A prefix string to prepend to log messages for clarity in logs.[0m
[30;1m173 | [0m[35m    Returns:[0m
[30;1m174 | [0m[35m        tuple: Returns a tuple of the final image name, the latest tag, authentication and auto_upda[0m
[30;1m175 | [0m[35m    """[0m
[30;1m176 | [0m[35m    def process_image(image):[0m
[30;1m177 | [0m[35m        # Find which server to search in[0m

[31m--[ [0m[34mMatch #[0m[33m465[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m167 | [0m[35m    private and public ones.[0m
[30;1m168 | [0m[35m    Args:[0m
[30;1m169 | [0m[35m        service_config (ServiceConfig): The configuration object for the service which includes Dock[0m
[30;1m170 | [0m[35m        system_config (SystemConfig): System-wide configuration which includes service updates and r[0m
[30;1m171 | [0m[35m        logger (Logger): Logger object for logging messages.[0m
[30;1m172 | [0m[35m        prefix (str, optional): A prefix string to prepend to log messages for clarity in logs.[0m
[30;1m173 | [0m[35m    Returns:[0m

[31m--[ [0m[34mMatch #[0m[33m466[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m166 | [0m[35m    and system version constraints. It handles different registry configurations including[0m
[30;1m167 | [0m[35m    private and public ones.[0m
[30;1m168 | [0m[35m    Args:[0m
[30;1m169 | [0m[35m        service_config (ServiceConfig): The configuration object for the service which includes Dock[0m
[30;1m170 | [0m[35m        system_config (SystemConfig): System-wide configuration which includes service updates and r[0m
[30;1m171 | [0m[35m        logger (Logger): Logger object for logging messages.[0m
[30;1m172 | [0m[35m        prefix (str, optional): A prefix string to prepend to log messages for clarity in logs.[0m

[31m--[ [0m[34mMatch #[0m[33m467[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m166 | [0m[35m    and system version constraints. It handles different registry configurations including[0m
[30;1m167 | [0m[35m    private and public ones.[0m
[30;1m168 | [0m[35m    Args:[0m
[30;1m169 | [0m[35m        service_config (ServiceConfig): The configuration object for the service which includes Dock[0m
[30;1m170 | [0m[35m        system_config (SystemConfig): System-wide configuration which includes service updates and r[0m
[30;1m171 | [0m[35m        logger (Logger): Logger object for logging messages.[0m
[30;1m172 | [0m[35m        prefix (str, optional): A prefix string to prepend to log messages for clarity in logs.[0m

[31m--[ [0m[34mMatch #[0m[33m468[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m160 | [0m[35mdef get_latest_tag_for_service(service_config: ServiceConfig, system_config: SystemConfig, logger: L[0m
[30;1m161 | [0m[35m                               prefix: str = ""):[0m
[30;1m162 | [0m[35m    """[0m
[30;1m163 | [0m[35m    Retrieves the latest compatible tag for a given service from its respective Docker registry.[0m
[30;1m164 | [0m[35m    This function processes the image name to determine the correct server, authenticates[0m
[30;1m165 | [0m[35m    with the registry, and then fetches the latest tag that matches the service's framework[0m
[30;1m166 | [0m[35m    and system version constraints. It handles different registry configurations including[0m

[31m--[ [0m[34mMatch #[0m[33m469[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m160 | [0m[35mdef get_latest_tag_for_service(service_config: ServiceConfig, system_config: SystemConfig, logger: L[0m
[30;1m161 | [0m[35m                               prefix: str = ""):[0m
[30;1m162 | [0m[35m    """[0m
[30;1m163 | [0m[35m    Retrieves the latest compatible tag for a given service from its respective Docker registry.[0m
[30;1m164 | [0m[35m    This function processes the image name to determine the correct server, authenticates[0m
[30;1m165 | [0m[35m    with the registry, and then fetches the latest tag that matches the service's framework[0m
[30;1m166 | [0m[35m    and system version constraints. It handles different registry configurations including[0m

[31m--[ [0m[34mMatch #[0m[33m470[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m153 | [0m[35m            return dict(username=registry.username, password=registry.password, type=registry.type,[0m
[30;1m154 | [0m[35m                        use_fic=registry.use_fic)[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m    # Otherwise return what's configured for the service[0m
[30;1m157 | [0m[35m    return dict(username=docker_config.registry_username, password=docker_config.registry_password,[0m
[30;1m158 | [0m[35m                type=docker_config.registry_type)[0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35mdef get_latest_tag_for_service(service_config: ServiceConfig, system_config: SystemConfig, logger: L[0m

[31m--[ [0m[34mMatch #[0m[33m471[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m}[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35mdef get_registry_config(docker_config: DockerConfig, system_config: SystemConfig) -> Dict[str, str]:[0m
[30;1m140 | [0m[35m    # Fix service image for calling Docker API[0m
[30;1m141 | [0m[35m    image_variables = defaultdict(str)[0m
[30;1m142 | [0m[35m    image_variables.update(system_config.services.image_variables)[0m
[30;1m143 | [0m[35m    image_variables.update(system_config.services.update_image_variables)[0m

[31m--[ [0m[34mMatch #[0m[33m472[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m}[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35mdef get_registry_config(docker_config: DockerConfig, system_config: SystemConfig) -> Dict[str, str]:[0m
[30;1m140 | [0m[35m    # Fix service image for calling Docker API[0m
[30;1m141 | [0m[35m    image_variables = defaultdict(str)[0m
[30;1m142 | [0m[35m    image_variables.update(system_config.services.image_variables)[0m
[30;1m143 | [0m[35m    image_variables.update(system_config.services.update_image_variables)[0m

[31m--[ [0m[34mMatch #[0m[33m473[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35mclass AzureContainerRegistry(ContainerRegistry):[0m
[30;1m73 | [0m[35m    def _get_proprietary_registry_tags(self, server, image_name, auth, verify, proxies=None, token_s[0m
[30;1m74 | [0m[35m        # Find latest tag for each types[0m
[30;1m75 | [0m[35m        url = f"https://{server}/v2/{image_name}/tags/list"[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m        # Get tag list[0m

[31m--[ [0m[34mMatch #[0m[33m474[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35mclass DockerRegistry(ContainerRegistry):[0m
[30;1m43 | [0m[35m    def _get_proprietary_registry_tags(self, server, image_name, auth, verify, proxies=None, token_s[0m
[30;1m44 | [0m[35m        # Find latest tag for each types[0m
[30;1m45 | [0m[35m        url = f"https://{server}/v2/{image_name}/tags/list"[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m        # Get tag list[0m

[31m--[ [0m[34mMatch #[0m[33m475[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35mfrom assemblyline.odm.models.config import Config as SystemConfig, ServiceRegistry[0m
[30;1m10 | [0m[35mfrom assemblyline.odm.models.service import Service as ServiceConfig, DockerConfig[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mfrom base64 import b64encode[0m
[30;1m13 | [0m[35mfrom collections import defaultdict[0m
[30;1m14 | [0m[35mfrom logging import Logger[0m
[30;1m15 | [0m[35mfrom typing import Dict, List[0m

[31m--[ [0m[34mMatch #[0m[33m476[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mfrom assemblyline.common.version import FRAMEWORK_VERSION, SYSTEM_VERSION[0m
[30;1m9 | [0m[35mfrom assemblyline.odm.models.config import Config as SystemConfig, ServiceRegistry[0m
[30;1m10 | [0m[35mfrom assemblyline.odm.models.service import Service as ServiceConfig, DockerConfig[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mfrom base64 import b64encode[0m
[30;1m13 | [0m[35mfrom collections import defaultdict[0m

[31m--[ [0m[34mMatch #[0m[33m477[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/updater/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mimport re[0m
[30;1m4 | [0m[35mimport socket[0m
[30;1m5 | [0m[35mimport string[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mfrom assemblyline.common.version import FRAMEWORK_VERSION, SYSTEM_VERSION[0m
[30;1m9 | [0m[35mfrom assemblyline.odm.models.config import Config as SystemConfig, ServiceRegistry[0m
[30;1m10 | [0m[35mfrom assemblyline.odm.models.service import Service as ServiceConfig, DockerConfig[0m

[31m--[ [0m[34mMatch #[0m[33m478[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1027 | [0m[35m                         f"l={labels}v={volumes}m={mounts}cm={True}senv={senv}")[0m
[30;1m1028 | [0m[35m[0m
[30;1m1029 | [0m[35m        self.logger.debug(f"{deployment_name} expected change_key: {change_key}")[0m
[30;1m1030 | [0m[35m        if old_deployment.metadata.annotations.get(CHANGE_KEY_NAME) != str(hash(change_key)):[0m
[30;1m1031 | [0m[35m            # A change occurred, declare dependency not ready yet.[0m
[30;1m1032 | [0m[35m            return[0m
[30;1m1033 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m479[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m982 | [0m[35m        # Pull out events that are new, or have occurred again since last reporting[0m
[30;1m983 | [0m[35m        new = [][0m
[30;1m984 | [0m[35m        for event in response.items:[0m
[30;1m985 | [0m[35m            if self.events_window.get(event.metadata.uid, 0) != event.count:[0m
[30;1m986 | [0m[35m                self.events_window[event.metadata.uid] = event.count[0m
[30;1m987 | [0m[35m                new.append(event.involved_object.name + ': ' + event.message)[0m
[30;1m988 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m480[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m942 | [0m[35m                    self.logger.info(f"Conflict scaling {service_name} retrying.")[0m
[30;1m943 | [0m[35m                    continue[0m
[30;1m944 | [0m[35m                if error.status == 404:[0m
[30;1m945 | [0m[35m                    profile = self._external_profiles.get(service_name, None)[0m
[30;1m946 | [0m[35m                    if profile:[0m
[30;1m947 | [0m[35m                        self.add_profile(profile, scale=target)[0m
[30;1m948 | [0m[35m                    return[0m

[31m--[ [0m[34mMatch #[0m[33m481[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m914 | [0m[35m[0m
[30;1m915 | [0m[35m    def get_target(self, service_name: str) -> int:[0m
[30;1m916 | [0m[35m        """Get the target for running instances of a service."""[0m
[30;1m917 | [0m[35m        return self._deployment_targets.get(service_name, 0)[0m
[30;1m918 | [0m[35m[0m
[30;1m919 | [0m[35m    def get_targets(self) -> dict[str, int]:[0m
[30;1m920 | [0m[35m        """Get the target for running instances of all services."""[0m

[31m--[ [0m[34mMatch #[0m[33m482[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m766 | [0m[35m        try:[0m
[30;1m767 | [0m[35m            replace = self.apps_api.read_namespaced_deployment([0m
[30;1m768 | [0m[35m                deployment_name, namespace=self.namespace, _request_timeout=API_TIMEOUT)[0m
[30;1m769 | [0m[35m            if replace.metadata.annotations.get(CHANGE_KEY_NAME) == change_key:[0m
[30;1m770 | [0m[35m                if replace.spec.replicas != scale:[0m
[30;1m771 | [0m[35m                    self.set_target(service_name, scale)[0m
[30;1m772 | [0m[35m                return[0m

[31m--[ [0m[34mMatch #[0m[33m483[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m649 | [0m[35m                    self._deployment_targets[name] = event['raw_object']['spec']['replicas'][0m
[30;1m650 | [0m[35m                    self._deployment_unavailable[name] = event['raw_object']['status'].get('unavaila[0m
[30;1m651 | [0m[35m            elif event['type'] == 'DELETED':[0m
[30;1m652 | [0m[35m                name = event['raw_object']['metadata']['labels'].get('component', None)[0m
[30;1m653 | [0m[35m                self._deployment_targets.pop(name, None)[0m
[30;1m654 | [0m[35m                self._deployment_unavailable.pop(name, None)[0m
[30;1m655 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m484[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m647 | [0m[35m                name = event['raw_object']['metadata']['labels'].get('component', None)[0m
[30;1m648 | [0m[35m                if name is not None:[0m
[30;1m649 | [0m[35m                    self._deployment_targets[name] = event['raw_object']['spec']['replicas'][0m
[30;1m650 | [0m[35m                    self._deployment_unavailable[name] = event['raw_object']['status'].get('unavaila[0m
[30;1m651 | [0m[35m            elif event['type'] == 'DELETED':[0m
[30;1m652 | [0m[35m                name = event['raw_object']['metadata']['labels'].get('component', None)[0m
[30;1m653 | [0m[35m                self._deployment_targets.pop(name, None)[0m

[31m--[ [0m[34mMatch #[0m[33m485[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m644 | [0m[35m                continue[0m
[30;1m645 | [0m[35m[0m
[30;1m646 | [0m[35m            if event['type'] in ['ADDED', 'MODIFIED']:[0m
[30;1m647 | [0m[35m                name = event['raw_object']['metadata']['labels'].get('component', None)[0m
[30;1m648 | [0m[35m                if name is not None:[0m
[30;1m649 | [0m[35m                    self._deployment_targets[name] = event['raw_object']['spec']['replicas'][0m
[30;1m650 | [0m[35m                    self._deployment_unavailable[name] = event['raw_object']['status'].get('unavaila[0m

[31m--[ [0m[34mMatch #[0m[33m486[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m516 | [0m[35m                            self.logger.warning(f"Container Status :: {pod_name} - "[0m
[30;1m517 | [0m[35m                                                f"Current State: {next(iter(status['state'].keys()),[0m
[30;1m518 | [0m[35m                                                f"Last State: {lastState} "[0m
[30;1m519 | [0m[35m                                                f"with reason {detail.get('reason', 'UNKNOWN')}")[0m
[30;1m520 | [0m[35m                elif event['type'] == 'DELETED':[0m
[30;1m521 | [0m[35m                    for container in event['raw_object']['spec']['containers']:[0m
[30;1m522 | [0m[35m                        containers.pop(f"{uid}-{container['name']}", None)[0m

[31m--[ [0m[34mMatch #[0m[33m487[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m510 | [0m[35m_containers[f"{uid}-{container['name']}"] = get_resources(container)[0m
[30;1m511 | [0m[35m                    for status in event['raw_object']['status'].get('containerStatuses', []):[0m
[30;1m512 | [0m[35m                        restarts = status['restartCount'][0m
[30;1m513 | [0m[35m                        if restarts > CONTAINER_RESTART_THRESHOLD and log_cache.get(pod_name, 0) <= [0m
[30;1m514 | [0m[35m                            log_cache[pod_name] = restarts[0m
[30;1m515 | [0m[35m                            lastState, detail = next(iter(status['lastState'].items()), ('UNKNOWN', [0m
[30;1m516 | [0m[35m                            self.logger.warning(f"Container Status :: {pod_name} - "[0m

[31m--[ [0m[34mMatch #[0m[33m488[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m508 | [0m[35m                        containers[f"{uid}-{container['name']}"] = get_resources(container)[0m
[30;1m509 | [0m[35m                        if namespace == self.namespace:[0m
[30;1m510 | [0m[35m                            namespaced_containers[f"{uid}-{container['name']}"] = get_resources(cont[0m
[30;1m511 | [0m[35m                    for status in event['raw_object']['status'].get('containerStatuses', []):[0m
[30;1m512 | [0m[35m                        restarts = status['restartCount'][0m
[30;1m513 | [0m[35m                        if restarts > CONTAINER_RESTART_THRESHOLD and log_cache.get(pod_name, 0) <= [0m
[30;1m514 | [0m[35m                            log_cache[pod_name] = restarts[0m

[31m--[ [0m[34mMatch #[0m[33m489[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m188 | [0m[35m    if cpu_value is not None:[0m
[30;1m189 | [0m[35m        cpu_value = parse_cpu(cpu_value)[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m    memory_value = requests.get('memory', limits.get('memory', None))[0m
[30;1m192 | [0m[35m    if memory_value is not None:[0m
[30;1m193 | [0m[35m        memory_value = parse_memory(memory_value)[0m
[30;1m194 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m490[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m188 | [0m[35m    if cpu_value is not None:[0m
[30;1m189 | [0m[35m        cpu_value = parse_cpu(cpu_value)[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m    memory_value = requests.get('memory', limits.get('memory', None))[0m
[30;1m192 | [0m[35m    if memory_value is not None:[0m
[30;1m193 | [0m[35m        memory_value = parse_memory(memory_value)[0m
[30;1m194 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m491[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m    requests = container['resources'].get('requests', {})[0m
[30;1m185 | [0m[35m    limits = container['resources'].get('limits', {})[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m    cpu_value = requests.get('cpu', limits.get('cpu', None))[0m
[30;1m188 | [0m[35m    if cpu_value is not None:[0m
[30;1m189 | [0m[35m        cpu_value = parse_cpu(cpu_value)[0m
[30;1m190 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m492[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m    requests = container['resources'].get('requests', {})[0m
[30;1m185 | [0m[35m    limits = container['resources'].get('limits', {})[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m    cpu_value = requests.get('cpu', limits.get('cpu', None))[0m
[30;1m188 | [0m[35m    if cpu_value is not None:[0m
[30;1m189 | [0m[35m        cpu_value = parse_cpu(cpu_value)[0m
[30;1m190 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m493[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35mdef get_resources(container) -> Tuple[float, float]:[0m
[30;1m184 | [0m[35m    requests = container['resources'].get('requests', {})[0m
[30;1m185 | [0m[35m    limits = container['resources'].get('limits', {})[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m    cpu_value = requests.get('cpu', limits.get('cpu', None))[0m
[30;1m188 | [0m[35m    if cpu_value is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m494[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35mdef get_resources(container) -> Tuple[float, float]:[0m
[30;1m184 | [0m[35m    requests = container['resources'].get('requests', {})[0m
[30;1m185 | [0m[35m    limits = container['resources'].get('limits', {})[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m    cpu_value = requests.get('cpu', limits.get('cpu', None))[0m

[31m--[ [0m[34mMatch #[0m[33m495[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m)[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35mAL_ROOT_CA = os.environ.get('AL_ROOT_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m59 | [0m[35mAL_ROOT_CA_PK = os.environ.get('AL_ROOT_CA_PK', '/etc/assemblyline/ssl/al_root-ca.key')[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m_exponents = {[0m
[30;1m62 | [0m[35m    'ki': 2**10,[0m

[31m--[ [0m[34mMatch #[0m[33m496[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m55 | [0m[35m    seccomp_profile=V1SeccompProfile(type="RuntimeDefault")[0m
[30;1m56 | [0m[35m)[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35mAL_ROOT_CA = os.environ.get('AL_ROOT_CA', '/etc/assemblyline/ssl/al_root-ca.crt')[0m
[30;1m59 | [0m[35mAL_ROOT_CA_PK = os.environ.get('AL_ROOT_CA_PK', '/etc/assemblyline/ssl/al_root-ca.key')[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m_exponents = {[0m

[31m--[ [0m[34mMatch #[0m[33m497[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35mSERVICE_LIVENESS_TIMEOUT = int(os.environ.get('SERVICE_LIVENESS_TIMEOUT', 60))[0m
[30;1m46 | [0m[35mUNPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('UNPRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m
[30;1m47 | [0m[35mPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('PRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m
[30;1m48 | [0m[35mCERTIFICATE_VALIDITY_PERIOD = int(os.environ.get('CERTIFICATE_VALIDITY_PERIOD', '36500'))[0m
[30;1m49 | [0m[35mRESTRICTED_POD_SECURITY_CONTEXT = V1SecurityContext([0m
[30;1m50 | [0m[35m    run_as_user=1000,[0m
[30;1m51 | [0m[35m    run_as_group=1000,[0m

[31m--[ [0m[34mMatch #[0m[33m498[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35mSERVICE_LIVENESS_PERIOD = int(os.environ.get('SERVICE_LIVENESS_PERIOD', 300))[0m
[30;1m45 | [0m[35mSERVICE_LIVENESS_TIMEOUT = int(os.environ.get('SERVICE_LIVENESS_TIMEOUT', 60))[0m
[30;1m46 | [0m[35mUNPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('UNPRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m
[30;1m47 | [0m[35mPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('PRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m
[30;1m48 | [0m[35mCERTIFICATE_VALIDITY_PERIOD = int(os.environ.get('CERTIFICATE_VALIDITY_PERIOD', '36500'))[0m
[30;1m49 | [0m[35mRESTRICTED_POD_SECURITY_CONTEXT = V1SecurityContext([0m
[30;1m50 | [0m[35m    run_as_user=1000,[0m

[31m--[ [0m[34mMatch #[0m[33m499[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35mCONTAINER_RESTART_THRESHOLD = int(os.environ.get('CONTAINER_RESTART_THRESHOLD', 1))[0m
[30;1m44 | [0m[35mSERVICE_LIVENESS_PERIOD = int(os.environ.get('SERVICE_LIVENESS_PERIOD', 300))[0m
[30;1m45 | [0m[35mSERVICE_LIVENESS_TIMEOUT = int(os.environ.get('SERVICE_LIVENESS_TIMEOUT', 60))[0m
[30;1m46 | [0m[35mUNPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('UNPRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m
[30;1m47 | [0m[35mPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('PRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m
[30;1m48 | [0m[35mCERTIFICATE_VALIDITY_PERIOD = int(os.environ.get('CERTIFICATE_VALIDITY_PERIOD', '36500'))[0m
[30;1m49 | [0m[35mRESTRICTED_POD_SECURITY_CONTEXT = V1SecurityContext([0m

[31m--[ [0m[34mMatch #[0m[33m500[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m42 | [0m[35mDEV_MODE = os.environ.get('DEV_MODE', 'false').lower() == 'true'[0m
[30;1m43 | [0m[35mCONTAINER_RESTART_THRESHOLD = int(os.environ.get('CONTAINER_RESTART_THRESHOLD', 1))[0m
[30;1m44 | [0m[35mSERVICE_LIVENESS_PERIOD = int(os.environ.get('SERVICE_LIVENESS_PERIOD', 300))[0m
[30;1m45 | [0m[35mSERVICE_LIVENESS_TIMEOUT = int(os.environ.get('SERVICE_LIVENESS_TIMEOUT', 60))[0m
[30;1m46 | [0m[35mUNPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('UNPRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m
[30;1m47 | [0m[35mPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('PRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m
[30;1m48 | [0m[35mCERTIFICATE_VALIDITY_PERIOD = int(os.environ.get('CERTIFICATE_VALIDITY_PERIOD', '36500'))[0m

[31m--[ [0m[34mMatch #[0m[33m501[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35mCHANGE_KEY_NAME = 'al_change_key'[0m
[30;1m42 | [0m[35mDEV_MODE = os.environ.get('DEV_MODE', 'false').lower() == 'true'[0m
[30;1m43 | [0m[35mCONTAINER_RESTART_THRESHOLD = int(os.environ.get('CONTAINER_RESTART_THRESHOLD', 1))[0m
[30;1m44 | [0m[35mSERVICE_LIVENESS_PERIOD = int(os.environ.get('SERVICE_LIVENESS_PERIOD', 300))[0m
[30;1m45 | [0m[35mSERVICE_LIVENESS_TIMEOUT = int(os.environ.get('SERVICE_LIVENESS_TIMEOUT', 60))[0m
[30;1m46 | [0m[35mUNPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('UNPRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m
[30;1m47 | [0m[35mPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('PRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m

[31m--[ [0m[34mMatch #[0m[33m502[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m40 | [0m[35mWATCH_API_TIMEOUT = WATCH_TIMEOUT + 10[0m
[30;1m41 | [0m[35mCHANGE_KEY_NAME = 'al_change_key'[0m
[30;1m42 | [0m[35mDEV_MODE = os.environ.get('DEV_MODE', 'false').lower() == 'true'[0m
[30;1m43 | [0m[35mCONTAINER_RESTART_THRESHOLD = int(os.environ.get('CONTAINER_RESTART_THRESHOLD', 1))[0m
[30;1m44 | [0m[35mSERVICE_LIVENESS_PERIOD = int(os.environ.get('SERVICE_LIVENESS_PERIOD', 300))[0m
[30;1m45 | [0m[35mSERVICE_LIVENESS_TIMEOUT = int(os.environ.get('SERVICE_LIVENESS_TIMEOUT', 60))[0m
[30;1m46 | [0m[35mUNPRIVILEGED_SERVICE_ACCOUNT_NAME = os.environ.get('UNPRIVILEGED_SERVICE_ACCOUNT_NAME', None)[0m

[31m--[ [0m[34mMatch #[0m[33m503[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m39 | [0m[35mWATCH_TIMEOUT = 10 * 60[0m
[30;1m40 | [0m[35mWATCH_API_TIMEOUT = WATCH_TIMEOUT + 10[0m
[30;1m41 | [0m[35mCHANGE_KEY_NAME = 'al_change_key'[0m
[30;1m42 | [0m[35mDEV_MODE = os.environ.get('DEV_MODE', 'false').lower() == 'true'[0m
[30;1m43 | [0m[35mCONTAINER_RESTART_THRESHOLD = int(os.environ.get('CONTAINER_RESTART_THRESHOLD', 1))[0m
[30;1m44 | [0m[35mSERVICE_LIVENESS_PERIOD = int(os.environ.get('SERVICE_LIVENESS_PERIOD', 300))[0m
[30;1m45 | [0m[35mSERVICE_LIVENESS_TIMEOUT = int(os.environ.get('SERVICE_LIVENESS_TIMEOUT', 60))[0m

[31m--[ [0m[34mMatch #[0m[33m504[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35mfrom assemblyline_core.scaler.controllers.interface import ControllerInterface[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m# RESERVE_MEMORY_PER_NODE = os.environ.get('RESERVE_MEMORY_PER_NODE')[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35mAPI_TIMEOUT = 90[0m
[30;1m39 | [0m[35mWATCH_TIMEOUT = 10 * 60[0m

[31m--[ [0m[34mMatch #[0m[33m505[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m937 | [0m[35m                return[0m
[30;1m938 | [0m[35m            except client.ApiException as error:[0m
[30;1m939 | [0m[35m                # If the error is a conflict, it means multiple attempts to scale a deployment[0m
[30;1m940 | [0m[35m                # were made at the same time and conflicted, we can retry[0m
[30;1m941 | [0m[35m                if error.reason == 'Conflict':[0m
[30;1m942 | [0m[35m                    self.logger.info(f"Conflict scaling {service_name} retrying.")[0m
[30;1m943 | [0m[35m                    continue[0m

[31m--[ [0m[34mMatch #[0m[33m506[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m775 | [0m[35m                raise[0m
[30;1m776 | [0m[35m[0m
[30;1m777 | [0m[35m        # If we have been given a username or password for the registry, we have to[0m
[30;1m778 | [0m[35m        # update it, if we haven't been, make sure its been cleaned up in the system[0m
[30;1m779 | [0m[35m        # so we don't leave passwords lying around[0m
[30;1m780 | [0m[35m        pull_secret_name = f'{deployment_name}-container-pull-secret'[0m
[30;1m781 | [0m[35m        use_pull_secret = False[0m

[31m--[ [0m[34mMatch #[0m[33m507[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m462 | [0m[35m                # Remove deleted nodes[0m
[30;1m463 | [0m[35m                self.ready_nodes.pop(name, None)[0m
[30;1m464 | [0m[35m[0m
[30;1m465 | [0m[35m            # Update the totals[0m
[30;1m466 | [0m[35m            self.node_count = len(self.ready_nodes)[0m
[30;1m467 | [0m[35m            max_cpu = 0[0m
[30;1m468 | [0m[35m            max_ram = 0[0m

[31m--[ [0m[34mMatch #[0m[33m508[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1337 | [0m[35m                    )[0m
[30;1m1338 | [0m[35m                ))[0m
[30;1m1339 | [0m[35m[0m
[30;1m1340 | [0m[35m        # Create or patch the network policies based on what's required for the service[0m
[30;1m1341 | [0m[35m        [create_or_patch_network_policy(netpol) for netpol in network_policies][0m
[30;1m1342 | [0m[35m[0m
[30;1m1343 | [0m[35m        # Cleanup any network policies that aren't in-use[0m
[30;1m1344 | [0m[35m        for np in (existing_netpol - {np.metadata.name for np in network_policies}):[0m

[31m--[ [0m[34mMatch #[0m[33m509[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1306 | [0m[35m            )[0m
[30;1m1307 | [0m[35m        ][0m
[30;1m1308 | [0m[35m[0m
[30;1m1309 | [0m[35m        # service → anywhere[0m
[30;1m1310 | [0m[35m        if internet:[0m
[30;1m1311 | [0m[35m            network_policies.append(V1NetworkPolicy([0m
[30;1m1312 | [0m[35m                metadata=V1ObjectMeta(name=f'allow-{safe_name}-outgoing'),[0m

[31m--[ [0m[34mMatch #[0m[33m510[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1265 | [0m[35m                else:[0m
[30;1m1266 | [0m[35m                    raise[0m
[30;1m1267 | [0m[35m[0m
[30;1m1268 | [0m[35m        # Create a list of network policies that must exist for this service[0m
[30;1m1269 | [0m[35m        # By default, we allow services to be able to interact with their dependencies and vice-vers[0m
[30;1m1270 | [0m[35m        network_policies = [[0m
[30;1m1271 | [0m[35m            V1NetworkPolicy([0m
[30;1m1272 | [0m[35m                metadata=V1ObjectMeta(name=f'allow-{safe_name}-to-dep'),[0m

[31m--[ [0m[34mMatch #[0m[33m511[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1246 | [0m[35m            'section': 'service',[0m
[30;1m1247 | [0m[35m            'component': service_name,[0m
[30;1m1248 | [0m[35m        }[0m
[30;1m1249 | [0m[35m        # Gather all existing network policies pertaining to the service[0m
[30;1m1250 | [0m[35m        existing_netpol = {netpol.metadata.name for netpol in self.net_api.list_namespaced_network_p[0m
[30;1m1251 | [0m[35m            namespace=self.namespace,[0m
[30;1m1252 | [0m[35m            label_selector=','.join([f"{k}={v}" for k, v in service_labels.items()])).items}[0m
[30;1m1253 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m512[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1162 | [0m[35m        except ApiException as error:[0m
[30;1m1163 | [0m[35m            if error.status != 404:[0m
[30;1m1164 | [0m[35m                raise[0m
[30;1m1165 | [0m[35m            service = V1Service([0m
[30;1m1166 | [0m[35m                metadata=V1ObjectMeta(name=deployment_name, labels=labels),[0m
[30;1m1167 | [0m[35m                spec=V1ServiceSpec([0m
[30;1m1168 | [0m[35m                    cluster_ip='None',[0m

[31m--[ [0m[34mMatch #[0m[33m513[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1154 | [0m[35m[0m
[30;1m1155 | [0m[35m        # Setup a service to direct to the deployment[0m
[30;1m1156 | [0m[35m        try:[0m
[30;1m1157 | [0m[35m            service = self.api.read_namespaced_service(deployment_name, self.namespace)[0m
[30;1m1158 | [0m[35m            service.metadata.labels = labels[0m
[30;1m1159 | [0m[35m            service.spec.selector = labels[0m
[30;1m1160 | [0m[35m            service.spec.ports = [V1ServicePort(port=int(_p), name=f"port-{_p}") for _p in spec.cont[0m

[31m--[ [0m[34mMatch #[0m[33m514[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1152 | [0m[35m                                core_mounts=spec.run_as_core, change_key=change_key,[0m
[30;1m1153 | [0m[35m                                deployment_strategy=deployment_strategy, security_context=self.secur[0m
[30;1m1154 | [0m[35m[0m
[30;1m1155 | [0m[35m        # Setup a service to direct to the deployment[0m
[30;1m1156 | [0m[35m        try:[0m
[30;1m1157 | [0m[35m            service = self.api.read_namespaced_service(deployment_name, self.namespace)[0m
[30;1m1158 | [0m[35m            service.metadata.labels = labels[0m

[31m--[ [0m[34mMatch #[0m[33m515[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1136 | [0m[35m        try:[0m
[30;1m1137 | [0m[35m            old_deployment = self.apps_api.read_namespaced_deployment(deployment_name, self.namespac[0m
[30;1m1138 | [0m[35m            for container in old_deployment.spec.template.spec.containers:[0m
[30;1m1139 | [0m[35m                for env in container.env:[0m
[30;1m1140 | [0m[35m                    if env.name == 'AL_INSTANCE_KEY':[0m
[30;1m1141 | [0m[35m                        instance_key = env.value[0m
[30;1m1142 | [0m[35m                        break[0m

[31m--[ [0m[34mMatch #[0m[33m516[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1103 | [0m[35m                                        secret=V1SecretVolumeSource(secret_name=cert_secret_name)))[0m
[30;1m1104 | [0m[35m                mounts.append(V1VolumeMount(name=cert_secret_name, mount_path=dep_cert_dir, read_onl[0m
[30;1m1105 | [0m[35m[0m
[30;1m1106 | [0m[35m            # Pass gunicorn settings via env[0m
[30;1m1107 | [0m[35m            spec.container.environment.append({'name': 'CERTFILE', 'value': os.path.join(dep_cert_di[0m
[30;1m1108 | [0m[35m            spec.container.environment.append({'name': 'KEYFILE', 'value': os.path.join(dep_cert_dir[0m
[30;1m1109 | [0m[35m[0m
[30;1m1110 | [0m[35m        for volume_name, volume_spec in spec.volumes.items():[0m

[31m--[ [0m[34mMatch #[0m[33m517[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1044 | [0m[35m        deployment_strategy = V1DeploymentStrategy(type='Recreate')[0m
[30;1m1045 | [0m[35m[0m
[30;1m1046 | [0m[35m        if os.path.exists(AL_ROOT_CA):[0m
[30;1m1047 | [0m[35m            # Specifically for service updaters when internal encryption is enabled on the cluster[0m
[30;1m1048 | [0m[35m            dep_cert_dir = f"/etc/assemblyline/ssl/al_{container_name}"[0m
[30;1m1049 | [0m[35m            cert_secret_name = f"{deployment_name}-cert"[0m
[30;1m1050 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m518[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1040 | [0m[35m        volumes, mounts = [], [][0m
[30;1m1041 | [0m[35m        deployment_strategy = V1DeploymentStrategy()  # Default strategy should be RollingUpdate[0m
[30;1m1042 | [0m[35m[0m
[30;1m1043 | [0m[35m        # Since we reserved containers named 'updates' to be service updaters, they will always 'Rec[0m
[30;1m1044 | [0m[35m        deployment_strategy = V1DeploymentStrategy(type='Recreate')[0m
[30;1m1045 | [0m[35m[0m
[30;1m1046 | [0m[35m        if os.path.exists(AL_ROOT_CA):[0m

[31m--[ [0m[34mMatch #[0m[33m519[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1000 | [0m[35m        try:[0m
[30;1m1001 | [0m[35m            old_deployment: V1Deployment = self.apps_api.read_namespaced_deployment(deployment_name,[0m
[30;1m1002 | [0m[35m            for container in old_deployment.spec.template.spec.containers:[0m
[30;1m1003 | [0m[35m                for env in container.env:[0m
[30;1m1004 | [0m[35m                    if env.name == 'AL_INSTANCE_KEY':[0m
[30;1m1005 | [0m[35m                        self._service_limited_env[service_name][f'{container_name}_host'] = deployme[0m
[30;1m1006 | [0m[35m                        self._service_limited_env[service_name][f'{container_name}_key'] = env.value[0m

[31m--[ [0m[34mMatch #[0m[33m520[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m937 | [0m[35m                return[0m
[30;1m938 | [0m[35m            except client.ApiException as error:[0m
[30;1m939 | [0m[35m                # If the error is a conflict, it means multiple attempts to scale a deployment[0m
[30;1m940 | [0m[35m                # were made at the same time and conflicted, we can retry[0m
[30;1m941 | [0m[35m                if error.reason == 'Conflict':[0m
[30;1m942 | [0m[35m                    self.logger.info(f"Conflict scaling {service_name} retrying.")[0m
[30;1m943 | [0m[35m                    continue[0m

[31m--[ [0m[34mMatch #[0m[33m521[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m835 | [0m[35m        # Build metadata[0m
[30;1m836 | [0m[35m        metadata = V1ObjectMeta(name=deployment_name, labels=all_labels, annotations={CHANGE_KEY_NAM[0m
[30;1m837 | [0m[35m[0m
[30;1m838 | [0m[35m        # Figure out which (if any) service account to use[0m
[30;1m839 | [0m[35m        service_account = self.default_service_account or \[0m
[30;1m840 | [0m[35m            (PRIVILEGED_SERVICE_ACCOUNT_NAME if core_mounts else UNPRIVILEGED_SERVICE_ACCOUNT_NAME)[0m
[30;1m841 | [0m[35m        if docker_config.service_account:[0m

[31m--[ [0m[34mMatch #[0m[33m522[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m698 | [0m[35m        min_memory = min(container_config.ram_mb_min, container_config.ram_mb)[0m
[30;1m699 | [0m[35m        environment_variables: list[V1EnvVar] = [][0m
[30;1m700 | [0m[35m[0m
[30;1m701 | [0m[35m        # Use custom health check located in service base[0m
[30;1m702 | [0m[35m        health_probe = V1Probe([0m
[30;1m703 | [0m[35m            _exec=V1ExecAction(command=["python3", "-m", "assemblyline_v4_service.healthz"]),[0m
[30;1m704 | [0m[35m            timeout_seconds=SERVICE_LIVENESS_TIMEOUT,[0m

[31m--[ [0m[34mMatch #[0m[33m523[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m631 | [0m[35m                self._quota_mem_used = None[0m
[30;1m632 | [0m[35m[0m
[30;1m633 | [0m[35m    def _monitor_deployments(self):[0m
[30;1m634 | [0m[35m        watch = TypelessWatch()[0m
[30;1m635 | [0m[35m[0m
[30;1m636 | [0m[35m        self._deployment_targets = {}[0m
[30;1m637 | [0m[35m        self._deployment_unavailable = {}[0m

[31m--[ [0m[34mMatch #[0m[33m524[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m551 | [0m[35m            self._pod_used_namespace_ram[node] = sum(memory_used) + memory_unrestricted * mean(memor[0m
[30;1m552 | [0m[35m[0m
[30;1m553 | [0m[35m    def _monitor_quotas(self):[0m
[30;1m554 | [0m[35m        watch = TypelessWatch()[0m
[30;1m555 | [0m[35m        cpu_limits = {}[0m
[30;1m556 | [0m[35m        cpu_used = {}[0m
[30;1m557 | [0m[35m        mem_limits = {}[0m

[31m--[ [0m[34mMatch #[0m[33m525[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m524 | [0m[35m                else:[0m
[30;1m525 | [0m[35m                    continue[0m
[30;1m526 | [0m[35m            except KeyError as e:[0m
[30;1m527 | [0m[35m                # Sometimes some of the information is missing, and we expect it, so drop[0m
[30;1m528 | [0m[35m                # log sevarity to info.[0m
[30;1m529 | [0m[35m                self.logger.info(f"Couldn't parse container information for {pod_name}: {e}")[0m
[30;1m530 | [0m[35m                continue[0m

[31m--[ [0m[34mMatch #[0m[33m526[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m499 | [0m[35m                pod_name = event['raw_object']['metadata']['name'][0m
[30;1m500 | [0m[35m                uid = event['raw_object']['metadata']['uid'][0m
[30;1m501 | [0m[35m                namespace = event['raw_object']['metadata']['namespace'][0m
[30;1m502 | [0m[35m                node = event['raw_object']['spec']['nodeName'][0m
[30;1m503 | [0m[35m                containers = per_node_containers[node][0m
[30;1m504 | [0m[35m                namespaced_containers = per_node_namespaced_containers[node][0m
[30;1m505 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m527[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m473 | [0m[35m            self._node_pool_max_ram = max_ram[0m
[30;1m474 | [0m[35m[0m
[30;1m475 | [0m[35m    def _monitor_pods(self):[0m
[30;1m476 | [0m[35m        watch = TypelessWatch()[0m
[30;1m477 | [0m[35m        log_cache = CacheDict(cache_len=8000)[0m
[30;1m478 | [0m[35m        per_node_containers: dict[str, dict[str, tuple[float, float]]] = defaultdict(dict)[0m
[30;1m479 | [0m[35m        per_node_namespaced_containers: dict[str, dict[str, tuple[float, float]]] = defaultdict(dict[0m

[31m--[ [0m[34mMatch #[0m[33m528[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m444 | [0m[35m            name: str = event['raw_object']['metadata']['name'][0m
[30;1m445 | [0m[35m[0m
[30;1m446 | [0m[35m            if event['type'] in ["ADDED", "MODIFIED"]:[0m
[30;1m447 | [0m[35m                # Check for node ready condition[0m
[30;1m448 | [0m[35m                ready = False[0m
[30;1m449 | [0m[35m                for condition in event['raw_object']['status']['conditions']:[0m
[30;1m450 | [0m[35m                    if condition['type'] == 'Ready':[0m

[31m--[ [0m[34mMatch #[0m[33m529[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m431 | [0m[35m        self._node_pool_max_cpu = 0[0m
[30;1m432 | [0m[35m        self._node_pool_max_ram = 0[0m
[30;1m433 | [0m[35m        self.node_count = 0[0m
[30;1m434 | [0m[35m        watch = TypelessWatch()[0m
[30;1m435 | [0m[35m        self.ready_nodes: dict[str, tuple[float, float]] = {}[0m
[30;1m436 | [0m[35m        field_selector, label_selector = selector_to_list_filters(self.linux_node_selector)[0m
[30;1m437 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m530[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m404 | [0m[35m        )[0m
[30;1m405 | [0m[35m[0m
[30;1m406 | [0m[35m    def add_profile(self, profile, scale=0):[0m
[30;1m407 | [0m[35m        """Tell the controller about a service profile it needs to manage."""[0m
[30;1m408 | [0m[35m        self._create_deployment(profile.name, self._deployment_name(profile.name),[0m
[30;1m409 | [0m[35m                                profile.container_config, profile.shutdown_seconds, scale,[0m
[30;1m410 | [0m[35m                                change_key=profile.config_blob, core_mounts=profile.privileged,[0m

[31m--[ [0m[34mMatch #[0m[33m531[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m204 | [0m[35m    else:[0m
[30;1m205 | [0m[35m        server_name = 'https://index.docker.io/v1/'[0m
[30;1m206 | [0m[35m[0m
[30;1m207 | [0m[35m    # The docker auth string is the base64'd username and password with a : to separate them[0m
[30;1m208 | [0m[35m    bin_u_pass = f"{username}:{password}".encode()[0m
[30;1m209 | [0m[35m    auth_string = base64.b64encode(bin_u_pass).decode()[0m
[30;1m210 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m532[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35mclass TypelessWatch(watch.Watch):[0m
[30;1m100 | [0m[35m    """A kubernetes watch object that doesn't marshal the response."""[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m    def get_return_type(self, func):[0m
[30;1m103 | [0m[35m        return None[0m

[31m--[ [0m[34mMatch #[0m[33m533[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m19 | [0m[35mfrom time import sleep[0m
[30;1m20 | [0m[35mfrom assemblyline.odm.models.config import Selector[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mfrom kubernetes import client, config, watch[0m
[30;1m23 | [0m[35mfrom kubernetes.client import V1Deployment, V1DeploymentSpec, V1PodTemplateSpec, V1DeploymentStrateg[0m
[30;1m24 | [0m[35m    V1PodSpec, V1ObjectMeta, V1Volume, V1Container, V1VolumeMount, V1EnvVar, V1ConfigMapVolumeSource[0m
[30;1m25 | [0m[35m    V1PersistentVolumeClaimVolumeSource, V1LabelSelector, V1ResourceRequirements, V1PersistentVolume[0m
[30;1m26 | [0m[35m    V1PersistentVolumeClaimSpec, V1NetworkPolicy, V1NetworkPolicySpec, V1NetworkPolicyEgressRule, V1[0m

[31m--[ [0m[34mMatch #[0m[33m534[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35mfrom datetime import datetime, timedelta[0m
[30;1m17 | [0m[35mfrom dateutil.tz import tzlocal[0m
[30;1m18 | [0m[35mfrom typing import List, Optional, Tuple[0m
[30;1m19 | [0m[35mfrom time import sleep[0m
[30;1m20 | [0m[35mfrom assemblyline.odm.models.config import Selector[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mfrom kubernetes import client, config, watch[0m

[31m--[ [0m[34mMatch #[0m[33m535[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mimport weakref[0m
[30;1m9 | [0m[35mimport urllib3[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mfrom base64 import b64encode[0m
[30;1m12 | [0m[35mfrom cryptography import x509[0m
[30;1m13 | [0m[35mfrom cryptography.hazmat.primitives.asymmetric import rsa[0m
[30;1m14 | [0m[35mfrom cryptography.hazmat.primitives import serialization, hashes[0m

[31m--[ [0m[34mMatch #[0m[33m536[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/kubernetes_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom __future__ import annotations[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport functools[0m
[30;1m4 | [0m[35mimport json[0m
[30;1m5 | [0m[35mimport uuid[0m
[30;1m6 | [0m[35mimport os[0m

[31m--[ [0m[34mMatch #[0m[33m537[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_replay.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m294 | [0m[35m        loader_worker.process_file(once=True)[0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m        # If the workflow was edited by someone else, they shouldn't have control over the enabled s[0m
[30;1m297 | [0m[35m        loaded_workflow = datastore.workflow.get(item.workflow_id)[0m
[30;1m298 | [0m[35m        assert loaded_workflow.enabled != item.enabled and loaded_workflow.edited_by == item.edited_[0m

[31m--[ [0m[34mMatch #[0m[33m538[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_replay.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m229 | [0m[35m    assert loader_worker.client.queues['file'].length() == 0[0m
[30;1m230 | [0m[35m    assert not os.path.exists(filename)[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35m    loaded_submission = datastore.submission.get(sub['sid'], as_obj=False)[0m
[30;1m233 | [0m[35m    assert 'bundle.loaded' in loaded_submission['metadata'][0m
[30;1m234 | [0m[35m    assert sub['sid'] == loaded_submission['sid'][0m
[30;1m235 | [0m[35m    assert 'replay' not in loaded_submission['metadata'][0m

[31m--[ [0m[34mMatch #[0m[33m539[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_replay.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m206 | [0m[35m    creator_worker.process_submission(once=True)[0m
[30;1m207 | [0m[35m    datastore.submission.commit()[0m
[30;1m208 | [0m[35m    assert creator_worker.client.queues['submission'].length() == 0[0m
[30;1m209 | [0m[35m    assert datastore.submission.get(sub['sid'], as_obj=False)['metadata']['replay'] == 'done'[0m
[30;1m210 | [0m[35m    assert os.path.exists(filename)[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m    # Delete the alert to test the loading process[0m

[31m--[ [0m[34mMatch #[0m[33m540[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_replay.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m180 | [0m[35m    assert loader_worker.client.queues['file'].length() == 0[0m
[30;1m181 | [0m[35m    assert not os.path.exists(filename)[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m    loaded_alert = datastore.alert.get(alert.alert_id, as_obj=False)[0m
[30;1m184 | [0m[35m    assert 'bundle.loaded' in loaded_alert['metadata'][0m
[30;1m185 | [0m[35m    assert alert.alert_id == loaded_alert['alert_id'][0m
[30;1m186 | [0m[35m    assert alert.workflows_completed != loaded_alert['workflows_completed'][0m

[31m--[ [0m[34mMatch #[0m[33m541[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_replay.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m157 | [0m[35m    creator_worker.process_alert(once=True)[0m
[30;1m158 | [0m[35m    datastore.alert.commit()[0m
[30;1m159 | [0m[35m    assert creator_worker.client.queues['alert'].length() == 0[0m
[30;1m160 | [0m[35m    assert datastore.alert.get(alert.alert_id, as_obj=False)['metadata']['replay'] == 'done'[0m
[30;1m161 | [0m[35m    assert os.path.exists(filename)[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    # Delete the alert to test the loading process[0m

[31m--[ [0m[34mMatch #[0m[33m542[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_replay.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35mdef recursive_extend(d, u):[0m
[30;1m36 | [0m[35m    for k, v in u.items():[0m
[30;1m37 | [0m[35m        if isinstance(v, collections.abc.Mapping):[0m
[30;1m38 | [0m[35m            d[k] = recursive_extend(d.get(k, {}), v)[0m
[30;1m39 | [0m[35m        else:[0m
[30;1m40 | [0m[35m            if k not in d:[0m
[30;1m41 | [0m[35m                d[k] = [][0m

[31m--[ [0m[34mMatch #[0m[33m543[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_replay.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mimport json[0m
[30;1m3 | [0m[35mimport os[0m
[30;1m4 | [0m[35mimport random[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport pytest[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom assemblyline.common import forge[0m

[31m--[ [0m[34mMatch #[0m[33m544[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_replay.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m293 | [0m[35m        loader.load_files(once=True)[0m
[30;1m294 | [0m[35m        loader_worker.process_file(once=True)[0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m        # If the workflow was edited by someone else, they shouldn't have control over the enabled s[0m
[30;1m297 | [0m[35m        loaded_workflow = datastore.workflow.get(item.workflow_id)[0m
[30;1m298 | [0m[35m        assert loaded_workflow.enabled != item.enabled and loaded_workflow.edited_by == item.edited_[0m

[31m--[ [0m[34mMatch #[0m[33m545[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m246 | [0m[35m            self.active = status[0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35m    def get_service_stage(self, service_name: str, default=ServiceStage.Off) -> ServiceStage:[0m
[30;1m249 | [0m[35m        return ServiceStage(self._service_stage_hash.get(service_name) or default)[0m
[30;1m250 | [0m[35m[0m
[30;1m251 | [0m[35m[0m
[30;1m252 | [0m[35mclass ThreadedCoreBase(CoreBase):[0m

[31m--[ [0m[34mMatch #[0m[33m546[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m240 | [0m[35m        if status is None:[0m
[30;1m241 | [0m[35m            self.log.info("Refreshing status")[0m
[30;1m242 | [0m[35m            component = self.__class__.__name__.lower()[0m
[30;1m243 | [0m[35m            self.active = Hash('system', self.redis_persist).get(f'{component}.active')[0m
[30;1m244 | [0m[35m        else:[0m
[30;1m245 | [0m[35m            self.log.info(f"Status change detected: {status}")[0m
[30;1m246 | [0m[35m            self.active = status[0m

[31m--[ [0m[34mMatch #[0m[33m547[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m221 | [0m[35m            self.status_event_watcher.register(f'system.{component}.active', self._handle_status_cha[0m
[30;1m222 | [0m[35m            self.status_event_watcher.start()[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m            self.active = Hash('system', self.redis_persist).get(f'{component}.active')[0m
[30;1m225 | [0m[35m            if self.active is None:[0m
[30;1m226 | [0m[35m                # Initialize state to be active if not set[0m
[30;1m227 | [0m[35m                Hash('system', self.redis_persist).set(f'{component}.active', True)[0m

[31m--[ [0m[34mMatch #[0m[33m548[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m185 | [0m[35m    Running = 2[0m
[30;1m186 | [0m[35m    Paused = 3[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m    # If at any time a service is disabled, scaler will stop the dependent containers[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35mdef get_service_stage_hash(redis) -> Hash[int]:[0m

[31m--[ [0m[34mMatch #[0m[33m549[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m181 | [0m[35m    # A service is not running, but dependencies have been started[0m
[30;1m182 | [0m[35m    # - if enabled updater will try to[0m
[30;1m183 | [0m[35m    Update = 1[0m
[30;1m184 | [0m[35m    # At this stage scaler will begin[0m
[30;1m185 | [0m[35m    Running = 2[0m
[30;1m186 | [0m[35m    Paused = 3[0m
[30;1m187 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m550[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m180 | [0m[35m    Off = 0[0m
[30;1m181 | [0m[35m    # A service is not running, but dependencies have been started[0m
[30;1m182 | [0m[35m    # - if enabled updater will try to[0m
[30;1m183 | [0m[35m    Update = 1[0m
[30;1m184 | [0m[35m    # At this stage scaler will begin[0m
[30;1m185 | [0m[35m    Running = 2[0m
[30;1m186 | [0m[35m    Paused = 3[0m

[31m--[ [0m[34mMatch #[0m[33m551[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m151 | [0m[35m            utime_timestamp = (timestamp, timestamp)[0m
[30;1m152 | [0m[35m[0m
[30;1m153 | [0m[35m        if self.config.logging.heartbeat_file:[0m
[30;1m154 | [0m[35m            # Only do the heartbeat every few seconds at most. If a fast component is[0m
[30;1m155 | [0m[35m            # calling this for every message processed we don't want to slow it down[0m
[30;1m156 | [0m[35m            # by doing a "disk" system call every few milliseconds[0m
[30;1m157 | [0m[35m            now = time.time()[0m

[31m--[ [0m[34mMatch #[0m[33m552[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m143 | [0m[35m        """Touch a special file on disk to indicate this service is responsive.[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m        This should be called in the main processing loop of a component, calling it in[0m
[30;1m146 | [0m[35m        a background thread defeats the purpose. Ideally it should be called at least a couple[0m
[30;1m147 | [0m[35m        times a minute.[0m
[30;1m148 | [0m[35m        """[0m
[30;1m149 | [0m[35m        utime_timestamp = None[0m

[31m--[ [0m[34mMatch #[0m[33m553[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35mSHUTDOWN_SECONDS_LIMIT = 10[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m# Don't write to the heartbeat file if it hasn't been at least this many seconds since the last writ[0m
[30;1m33 | [0m[35mHEARTBEAT_TIME_LIMIT = 3[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m554[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m228 | [0m[35m                self.active = True[0m
[30;1m229 | [0m[35m            self.log.info(f"Listening for status events on: system.{component}.active")[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m        # Create a cached service data object, and access to the service status[0m
[30;1m232 | [0m[35m        self.service_info = typing.cast(typing.Dict[str, Service], forge.CachedObject(self._get_serv[0m
[30;1m233 | [0m[35m        self._service_stage_hash = get_service_stage_hash(self.redis)[0m
[30;1m234 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m555[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m228 | [0m[35m                self.active = True[0m
[30;1m229 | [0m[35m            self.log.info(f"Listening for status events on: system.{component}.active")[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m        # Create a cached service data object, and access to the service status[0m
[30;1m232 | [0m[35m        self.service_info = typing.cast(typing.Dict[str, Service], forge.CachedObject(self._get_serv[0m
[30;1m233 | [0m[35m        self._service_stage_hash = get_service_stage_hash(self.redis)[0m
[30;1m234 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m556[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35mdef get_service_stage_hash(redis) -> Hash[int]:[0m
[30;1m192 | [0m[35m    """A hash from service name to ServiceStage enum values."""[0m
[30;1m193 | [0m[35m    return Hash('service-stage', redis)[0m
[30;1m194 | [0m[35m[0m
[30;1m195 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m557[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m185 | [0m[35m    Running = 2[0m
[30;1m186 | [0m[35m    Paused = 3[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m    # If at any time a service is disabled, scaler will stop the dependent containers[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35mdef get_service_stage_hash(redis) -> Hash[int]:[0m

[31m--[ [0m[34mMatch #[0m[33m558[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m185 | [0m[35m    Running = 2[0m
[30;1m186 | [0m[35m    Paused = 3[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m    # If at any time a service is disabled, scaler will stop the dependent containers[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35mdef get_service_stage_hash(redis) -> Hash[int]:[0m

[31m--[ [0m[34mMatch #[0m[33m559[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m178 | [0m[35m    # A service is not running[0m
[30;1m179 | [0m[35m    # - if enabled scaler will start dependent containers and move to next stage[0m
[30;1m180 | [0m[35m    Off = 0[0m
[30;1m181 | [0m[35m    # A service is not running, but dependencies have been started[0m
[30;1m182 | [0m[35m    # - if enabled updater will try to[0m
[30;1m183 | [0m[35m    Update = 1[0m
[30;1m184 | [0m[35m    # At this stage scaler will begin[0m

[31m--[ [0m[34mMatch #[0m[33m560[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m175 | [0m[35m# If the service is marked as enabled=true, each component should take steps needed to move it to th[0m
[30;1m176 | [0m[35m# If the service is marked as enabled=false, each component should take steps needed to stop it.[0m
[30;1m177 | [0m[35mclass ServiceStage(enum.IntEnum):[0m
[30;1m178 | [0m[35m    # A service is not running[0m
[30;1m179 | [0m[35m    # - if enabled scaler will start dependent containers and move to next stage[0m
[30;1m180 | [0m[35m    Off = 0[0m
[30;1m181 | [0m[35m    # A service is not running, but dependencies have been started[0m

[31m--[ [0m[34mMatch #[0m[33m561[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m173 | [0m[35m# This table in redis tells us about the current stage of operation a service is in.[0m
[30;1m174 | [0m[35m# This is complementary to the 'enabled' flag in the service spec.[0m
[30;1m175 | [0m[35m# If the service is marked as enabled=true, each component should take steps needed to move it to th[0m
[30;1m176 | [0m[35m# If the service is marked as enabled=false, each component should take steps needed to stop it.[0m
[30;1m177 | [0m[35mclass ServiceStage(enum.IntEnum):[0m
[30;1m178 | [0m[35m    # A service is not running[0m
[30;1m179 | [0m[35m    # - if enabled scaler will start dependent containers and move to next stage[0m

[31m--[ [0m[34mMatch #[0m[33m562[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m172 | [0m[35m[0m
[30;1m173 | [0m[35m# This table in redis tells us about the current stage of operation a service is in.[0m
[30;1m174 | [0m[35m# This is complementary to the 'enabled' flag in the service spec.[0m
[30;1m175 | [0m[35m# If the service is marked as enabled=true, each component should take steps needed to move it to th[0m
[30;1m176 | [0m[35m# If the service is marked as enabled=false, each component should take steps needed to stop it.[0m
[30;1m177 | [0m[35mclass ServiceStage(enum.IntEnum):[0m
[30;1m178 | [0m[35m    # A service is not running[0m

[31m--[ [0m[34mMatch #[0m[33m563[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m[0m
[30;1m173 | [0m[35m# This table in redis tells us about the current stage of operation a service is in.[0m
[30;1m174 | [0m[35m# This is complementary to the 'enabled' flag in the service spec.[0m
[30;1m175 | [0m[35m# If the service is marked as enabled=true, each component should take steps needed to move it to th[0m
[30;1m176 | [0m[35m# If the service is marked as enabled=false, each component should take steps needed to stop it.[0m
[30;1m177 | [0m[35mclass ServiceStage(enum.IntEnum):[0m

[31m--[ [0m[34mMatch #[0m[33m564[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m170 | [0m[35m            duration -= sleep_time[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m[0m
[30;1m173 | [0m[35m# This table in redis tells us about the current stage of operation a service is in.[0m
[30;1m174 | [0m[35m# This is complementary to the 'enabled' flag in the service spec.[0m
[30;1m175 | [0m[35m# If the service is marked as enabled=true, each component should take steps needed to move it to th[0m
[30;1m176 | [0m[35m# If the service is marked as enabled=false, each component should take steps needed to stop it.[0m

[31m--[ [0m[34mMatch #[0m[33m565[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m140 | [0m[35m        pass[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    def heartbeat(self, timestamp: Optional[int] = None):[0m
[30;1m143 | [0m[35m        """Touch a special file on disk to indicate this service is responsive.[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m        This should be called in the main processing loop of a component, calling it in[0m
[30;1m146 | [0m[35m        a background thread defeats the purpose. Ideally it should be called at least a couple[0m

[31m--[ [0m[34mMatch #[0m[33m566[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m16 | [0m[35mimport typing[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35mfrom assemblyline.common import forge, log as al_log[0m
[30;1m19 | [0m[35mfrom assemblyline.odm.models.service import Service[0m
[30;1m20 | [0m[35mfrom assemblyline.remote.datatypes import get_client[0m
[30;1m21 | [0m[35mfrom assemblyline.remote.datatypes.hash import Hash[0m
[30;1m22 | [0m[35mfrom assemblyline.remote.datatypes.events import EventWatcher[0m
[30;1m23 | [0m[35mfrom assemblyline_core import PAUSABLE_COMPONENTS[0m

[31m--[ [0m[34mMatch #[0m[33m567[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/server_base.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mfrom __future__ import annotations[0m
[30;1m6 | [0m[35mimport enum[0m
[30;1m7 | [0m[35mimport functools[0m
[30;1m8 | [0m[35mimport time[0m
[30;1m9 | [0m[35mimport threading[0m
[30;1m10 | [0m[35mimport logging[0m
[30;1m11 | [0m[35mimport signal[0m
[30;1m12 | [0m[35mimport sys[0m

[31m--[ [0m[34mMatch #[0m[33m568[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/run_alerter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m            return 'wait'[0m
[30;1m106 | [0m[35m        except Exception:  # pylint: disable=W0703[0m
[30;1m107 | [0m[35m            retries = alert['alert_retries'] = alert.get('alert_retries', 0) + 1[0m
[30;1m108 | [0m[35m            self.counter.increment('error')[0m
[30;1m109 | [0m[35m            if retries > MAX_RETRIES:[0m
[30;1m110 | [0m[35m                self.log.exception(f'Max retries exceeded for: {alert}')[0m

[31m--[ [0m[34mMatch #[0m[33m569[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/run_alerter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m66 | [0m[35m            elif alert:[0m
[30;1m67 | [0m[35m                # If we have peeked an alert and it isn't time for it to be processed[0m
[30;1m68 | [0m[35m                # yet, wait until then before trying to peek the retry queue again[0m
[30;1m69 | [0m[35m                self.next_retry_available = alert.get('wait_until', 0)[0m
[30;1m70 | [0m[35m                alert = None[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m        # If we haven't gotten an alert from retry queue, pop on the main queue[0m

[31m--[ [0m[34mMatch #[0m[33m570[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/run_alerter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m                # Double check after popping it to be sure we got the alert we expected[0m
[30;1m61 | [0m[35m                # if it is in the future (>) put it back in the queue[0m
[30;1m62 | [0m[35m                alert = self.alert_retry_queue.pop(blocking=False)[0m
[30;1m63 | [0m[35m                if alert and alert.get('wait_until', 0) > now():[0m
[30;1m64 | [0m[35m                    self.alert_retry_queue.push(alert)[0m
[30;1m65 | [0m[35m                    alert = None[0m
[30;1m66 | [0m[35m            elif alert:[0m

[31m--[ [0m[34mMatch #[0m[33m571[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/run_alerter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m        if self.next_retry_available < now():[0m
[30;1m57 | [0m[35m            # Check if the next alert in the queue has a wait_until in the past (<)[0m
[30;1m58 | [0m[35m            alert = self.alert_retry_queue.peek_next()[0m
[30;1m59 | [0m[35m            if alert and alert.get('wait_until', 0) < now():[0m
[30;1m60 | [0m[35m                # Double check after popping it to be sure we got the alert we expected[0m
[30;1m61 | [0m[35m                # if it is in the future (>) put it back in the queue[0m
[30;1m62 | [0m[35m                alert = self.alert_retry_queue.pop(blocking=False)[0m

[31m--[ [0m[34mMatch #[0m[33m572[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/run_alerter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m64 | [0m[35m                    self.alert_retry_queue.push(alert)[0m
[30;1m65 | [0m[35m                    alert = None[0m
[30;1m66 | [0m[35m            elif alert:[0m
[30;1m67 | [0m[35m                # If we have peeked an alert and it isn't time for it to be processed[0m
[30;1m68 | [0m[35m                # yet, wait until then before trying to peek the retry queue again[0m
[30;1m69 | [0m[35m                self.next_retry_available = alert.get('wait_until', 0)[0m
[30;1m70 | [0m[35m                alert = None[0m

[31m--[ [0m[34mMatch #[0m[33m573[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/collection.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m36 | [0m[35m    def read(self, service):[0m
[30;1m37 | [0m[35m        now = time.time()[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m        # Load the last messages from this service[0m
[30;1m40 | [0m[35m        try:[0m
[30;1m41 | [0m[35m            hosts = self.services[service][0m
[30;1m42 | [0m[35m        except KeyError:[0m
[30;1m43 | [0m[35m            return None[0m

[31m--[ [0m[34mMatch #[0m[33m574[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/collection.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mThe task of this module is to take data available from metrics across multiple hosts[0m
[30;1m5 | [0m[35mproviding the same service and combine them into general statistics about the service.[0m
[30;1m6 | [0m[35m"""[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom typing import Dict[0m
[30;1m9 | [0m[35mfrom collections import namedtuple[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mRow = namedtuple('Row', ['timestamp', 'busy', 'throughput'])[0m

[31m--[ [0m[34mMatch #[0m[33m575[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/collection.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mCode for collecting metric data and feeding it into the orchestration framework.[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mThe task of this module is to take data available from metrics across multiple hosts[0m
[30;1m5 | [0m[35mproviding the same service and combine them into general statistics about the service.[0m
[30;1m6 | [0m[35m"""[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35mfrom typing import Dict[0m

[31m--[ [0m[34mMatch #[0m[33m576[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/replay/replay.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m10 | [0m[35mfrom assemblyline.odm.models.replay import ReplayConfig[0m
[30;1m11 | [0m[35mfrom assemblyline_core.server_base import ServerBase[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35mCONFIG_PATH = os.environ.get('REPLAY_CONFIG_PATH', '/etc/assemblyline/replay.yml')[0m
[30;1m14 | [0m[35mINPUT_TYPES = ['alert', 'badlist', 'safelist', 'signature', 'submission', 'workflow'][0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m577[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m577 | [0m[35m                           "Will try to use local copy.")[0m
[30;1m578 | [0m[35m[0m
[30;1m579 | [0m[35m            try:[0m
[30;1m580 | [0m[35m                self.client.images.get(repository + ':' + tag)[0m
[30;1m581 | [0m[35m            except ImageNotFound:[0m
[30;1m582 | [0m[35m                self.log.error(f"Couldn't find local image {repository}:{tag}")[0m

[31m--[ [0m[34mMatch #[0m[33m578[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m534 | [0m[35m        # Create network for service[0m
[30;1m535 | [0m[35m        network_name = f'{COMPOSE_PROJECT}_service-net-{service_name}'[0m
[30;1m536 | [0m[35m        try:[0m
[30;1m537 | [0m[35m            self.networks[service_name] = network = self.client.networks.get(network_name)[0m
[30;1m538 | [0m[35m            network.reload()[0m
[30;1m539 | [0m[35m        except NotFound:[0m
[30;1m540 | [0m[35m            network = self.networks[service_name] = self.client.networks.create(name=network_name, i[0m

[31m--[ [0m[34mMatch #[0m[33m579[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m474 | [0m[35m                    break[0m
[30;1m475 | [0m[35m[0m
[30;1m476 | [0m[35m            if instance_key is not None \[0m
[30;1m477 | [0m[35m                    and old_container.labels.get(CHANGE_KEY_NAME) == change_check \[0m
[30;1m478 | [0m[35m                    and old_container.status == 'running':[0m
[30;1m479 | [0m[35m                self._service_limited_env[service_name][f'{container_name}_host'] = deployment_name[0m
[30;1m480 | [0m[35m                self._service_limited_env[service_name][f'{container_name}_key'] = instance_key[0m

[31m--[ [0m[34mMatch #[0m[33m580[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m466 | [0m[35m        instance_key = None[0m
[30;1m467 | [0m[35m[0m
[30;1m468 | [0m[35m        try:[0m
[30;1m469 | [0m[35m            old_container = self.client.containers.get(deployment_name)[0m
[30;1m470 | [0m[35m[0m
[30;1m471 | [0m[35m            for env in old_container.attrs["Config"]["Env"]:[0m
[30;1m472 | [0m[35m                if env.startswith("AL_INSTANCE_KEY="):[0m

[31m--[ [0m[34mMatch #[0m[33m581[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m445 | [0m[35m                    break[0m
[30;1m446 | [0m[35m[0m
[30;1m447 | [0m[35m            if instance_key is not None \[0m
[30;1m448 | [0m[35m                    and old_container.labels.get(CHANGE_KEY_NAME) == change_check \[0m
[30;1m449 | [0m[35m                    and old_container.status == 'running':[0m
[30;1m450 | [0m[35m                self._service_limited_env[service_name][f'{container_name}_host'] = deployment_name[0m
[30;1m451 | [0m[35m                self._service_limited_env[service_name][f'{container_name}_key'] = instance_key[0m

[31m--[ [0m[34mMatch #[0m[33m582[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m437 | [0m[35m        instance_key = None[0m
[30;1m438 | [0m[35m[0m
[30;1m439 | [0m[35m        try:[0m
[30;1m440 | [0m[35m            old_container = self.client.containers.get(deployment_name)[0m
[30;1m441 | [0m[35m[0m
[30;1m442 | [0m[35m            for env in old_container.attrs["Config"]["Env"]:[0m
[30;1m443 | [0m[35m                if env.startswith("AL_INSTANCE_KEY="):[0m

[31m--[ [0m[34mMatch #[0m[33m583[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m409 | [0m[35m                    container = possible_container[0m
[30;1m410 | [0m[35m                    break[0m
[30;1m411 | [0m[35m[0m
[30;1m412 | [0m[35m        if container and container.labels.get('component') == service_name and container.status == '[0m
[30;1m413 | [0m[35m            container.kill()[0m
[30;1m414 | [0m[35m[0m
[30;1m415 | [0m[35m    def restart(self, service):[0m

[31m--[ [0m[34mMatch #[0m[33m584[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m401 | [0m[35m        container = None[0m
[30;1m402 | [0m[35m        try:[0m
[30;1m403 | [0m[35m            # First try the given container id in case its actually correct[0m
[30;1m404 | [0m[35m            container = self.client.containers.get(container_id)[0m
[30;1m405 | [0m[35m        except docker.errors.NotFound:[0m
[30;1m406 | [0m[35m            filters = {'label': f'component={service_name}'}[0m
[30;1m407 | [0m[35m            for possible_container in self.client.containers.list(filters=filters, ignore_removed=Tr[0m

[31m--[ [0m[34mMatch #[0m[33m585[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m][0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mSERVICE_LIVENESS_PERIOD = int(os.environ.get('SERVICE_LIVENESS_PERIOD', 300)) * 1000000000[0m
[30;1m30 | [0m[35mSERVICE_LIVENESS_TIMEOUT = int(os.environ.get('SERVICE_LIVENESS_TIMEOUT', 60)) * 1000000000[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35mclass DockerController(ControllerInterface):[0m

[31m--[ [0m[34mMatch #[0m[33m586[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35m    "com.docker.compose.project.version",[0m
[30;1m27 | [0m[35m][0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mSERVICE_LIVENESS_PERIOD = int(os.environ.get('SERVICE_LIVENESS_PERIOD', 300)) * 1000000000[0m
[30;1m30 | [0m[35mSERVICE_LIVENESS_TIMEOUT = int(os.environ.get('SERVICE_LIVENESS_TIMEOUT', 60)) * 1000000000[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m587[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m17 | [0m[35mNETWORK_REFRESH_INTERVAL = 60 * 3[0m
[30;1m18 | [0m[35mCHANGE_KEY_NAME = 'al_change_key'[0m
[30;1m19 | [0m[35mAL_CORE_NETWORK = os.environ.get("AL_CORE_NETWORK", 'al_core')[0m
[30;1m20 | [0m[35mCOMPOSE_PROJECT = os.environ.get('COMPOSE_PROJECT_NAME', None)[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mCOPY_LABELS = [[0m
[30;1m23 | [0m[35m    "com.docker.compose.config-hash",[0m

[31m--[ [0m[34mMatch #[0m[33m588[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35m# Every this many seconds, check that the services can actually reach the service server.[0m
[30;1m17 | [0m[35mNETWORK_REFRESH_INTERVAL = 60 * 3[0m
[30;1m18 | [0m[35mCHANGE_KEY_NAME = 'al_change_key'[0m
[30;1m19 | [0m[35mAL_CORE_NETWORK = os.environ.get("AL_CORE_NETWORK", 'al_core')[0m
[30;1m20 | [0m[35mCOMPOSE_PROJECT = os.environ.get('COMPOSE_PROJECT_NAME', None)[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mCOPY_LABELS = [[0m

[31m--[ [0m[34mMatch #[0m[33m589[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m.hostname[0m
[30;1m516 | [0m[35m        if spec.container.ports:[0m
[30;1m517 | [0m[35m            self._service_limited_env[service_name][f'{container_name}_port'] = spec.container.ports[0m
[30;1m518 | [0m[35m        self._start_container(service_name=service_name, name=deployment_name, labels=all_labels,[0m
[30;1m519 | [0m[35m                              volumes=volumes, hostname=container_name, cfg=spec.container,[0m
[30;1m520 | [0m[35m                              core_container=spec.run_as_core, network=self._get_network(service_nam[0m
[30;1m521 | [0m[35m[0m
[30;1m522 | [0m[35m    def stop_containers(self, labels):[0m

[31m--[ [0m[34mMatch #[0m[33m590[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m.hostname[0m
[30;1m290 | [0m[35m            self._connect_to_network(container, self.core_network, aliases=[hostname])[0m
[30;1m291 | [0m[35m[0m
[30;1m292 | [0m[35m        if cfg.allow_internet_access:[0m
[30;1m293 | [0m[35m            self._connect_to_network(container, self.external_network, aliases=[hostname])[0m
[30;1m294 | [0m[35m[0m
[30;1m295 | [0m[35m    def _name_container(self, service_name):[0m
[30;1m296 | [0m[35m        """Find an unused name for a container.[0m

[31m--[ [0m[34mMatch #[0m[33m591[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m.hostname[0m
[30;1m287 | [0m[35m        )[0m
[30;1m288 | [0m[35m[0m
[30;1m289 | [0m[35m        if core_container:[0m
[30;1m290 | [0m[35m            self._connect_to_network(container, self.core_network, aliases=[hostname])[0m
[30;1m291 | [0m[35m[0m
[30;1m292 | [0m[35m        if cfg.allow_internet_access:[0m
[30;1m293 | [0m[35m            self._connect_to_network(container, self.external_network, aliases=[hostname])[0m

[31m--[ [0m[34mMatch #[0m[33m592[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m.hostname[0m
[30;1m229 | [0m[35m            self._connect_to_network(container, self.external_network)[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m    def _start_container([0m
[30;1m232 | [0m[35m            self, service_name, name, labels, volumes, cfg: DockerConfig, network, hostname, core_co[0m
[30;1m233 | [0m[35m        """Launch a docker container."""[0m
[30;1m234 | [0m[35m        # Take the port strings and convert them to a dictionary[0m
[30;1m235 | [0m[35m        ports = {}[0m

[31m--[ [0m[34mMatch #[0m[33m593[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m366 | [0m[35m    def set_target(self, service_name, target):[0m
[30;1m367 | [0m[35m        """Change how many instances of a service docker is trying to keep up.[0m
[30;1m368 | [0m[35m[0m
[30;1m369 | [0m[35m        This is managed by killing extra containers at random, or launching new ones.[0m
[30;1m370 | [0m[35m        """[0m
[30;1m371 | [0m[35m        try:[0m
[30;1m372 | [0m[35m            running = self.get_target(service_name)[0m

[31m--[ [0m[34mMatch #[0m[33m594[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m10 | [0m[35mfrom assemblyline.odm.models.service import DependencyConfig, DockerConfig[0m
[30;1m11 | [0m[35mfrom .interface import ControllerInterface, ServiceControlError[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# Where to find the update directory inside this container.[0m
[30;1m14 | [0m[35mINHERITED_VARIABLES = ['HTTP_PROXY', 'HTTPS_PROXY', 'NO_PROXY', 'http_proxy', 'https_proxy', 'no_pro[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m# Every this many seconds, check that the services can actually reach the service server.[0m

[31m--[ [0m[34mMatch #[0m[33m595[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m579 | [0m[35m            try:[0m
[30;1m580 | [0m[35m                self.client.images.get(repository + ':' + tag)[0m
[30;1m581 | [0m[35m            except ImageNotFound:[0m
[30;1m582 | [0m[35m                self.log.error(f"Couldn't find local image {repository}:{tag}")[0m

[31m--[ [0m[34mMatch #[0m[33m596[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m531 | [0m[35m        dynamically rather than in prepare_network.[0m
[30;1m532 | [0m[35m        """[0m
[30;1m533 | [0m[35m        from docker.errors import NotFound[0m
[30;1m534 | [0m[35m        # Create network for service[0m
[30;1m535 | [0m[35m        network_name = f'{COMPOSE_PROJECT}_service-net-{service_name}'[0m
[30;1m536 | [0m[35m        try:[0m
[30;1m537 | [0m[35m            self.networks[service_name] = network = self.client.networks.get(network_name)[0m
[30;1m538 | [0m[35m            network.reload()[0m

[31m--[ [0m[34mMatch #[0m[33m597[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m527 | [0m[35m    def _get_network(self, service_name):[0m
[30;1m528 | [0m[35m        """Get a reference to the network a service uses.[0m
[30;1m529 | [0m[35m[0m
[30;1m530 | [0m[35m        Since we need a reference to networks in docker we will do this setup[0m
[30;1m531 | [0m[35m        dynamically rather than in prepare_network.[0m
[30;1m532 | [0m[35m        """[0m
[30;1m533 | [0m[35m        from docker.errors import NotFound[0m

[31m--[ [0m[34mMatch #[0m[33m598[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m525 | [0m[35m            container.stop()[0m
[30;1m526 | [0m[35m[0m
[30;1m527 | [0m[35m    def _get_network(self, service_name):[0m
[30;1m528 | [0m[35m        """Get a reference to the network a service uses.[0m
[30;1m529 | [0m[35m[0m
[30;1m530 | [0m[35m        Since we need a reference to networks in docker we will do this setup[0m
[30;1m531 | [0m[35m        dynamically rather than in prepare_network.[0m

[31m--[ [0m[34mMatch #[0m[33m599[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m468 | [0m[35m        try:[0m
[30;1m469 | [0m[35m            old_container = self.client.containers.get(deployment_name)[0m
[30;1m470 | [0m[35m[0m
[30;1m471 | [0m[35m            for env in old_container.attrs["Config"]["Env"]:[0m
[30;1m472 | [0m[35m                if env.startswith("AL_INSTANCE_KEY="):[0m
[30;1m473 | [0m[35m                    instance_key = env.split("=")[1][0m
[30;1m474 | [0m[35m                    break[0m

[31m--[ [0m[34mMatch #[0m[33m600[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m439 | [0m[35m        try:[0m
[30;1m440 | [0m[35m            old_container = self.client.containers.get(deployment_name)[0m
[30;1m441 | [0m[35m[0m
[30;1m442 | [0m[35m            for env in old_container.attrs["Config"]["Env"]:[0m
[30;1m443 | [0m[35m                if env.startswith("AL_INSTANCE_KEY="):[0m
[30;1m444 | [0m[35m                    instance_key = env.split("=")[1][0m
[30;1m445 | [0m[35m                    break[0m

[31m--[ [0m[34mMatch #[0m[33m601[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m389 | [0m[35m                for _ in range(delta):[0m
[30;1m390 | [0m[35m                    self._start(service_name)[0m
[30;1m391 | [0m[35m[0m
[30;1m392 | [0m[35m            # Every time we change our container allocation do a little clean up to keep things fres[0m
[30;1m393 | [0m[35m            with self.prune_lock:[0m
[30;1m394 | [0m[35m                self.client.containers.prune()[0m
[30;1m395 | [0m[35m                self.client.volumes.prune()[0m

[31m--[ [0m[34mMatch #[0m[33m602[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m385 | [0m[35m                    container.kill()[0m
[30;1m386 | [0m[35m[0m
[30;1m387 | [0m[35m            if delta > 0:[0m
[30;1m388 | [0m[35m                # Start delta instances of the service[0m
[30;1m389 | [0m[35m                for _ in range(delta):[0m
[30;1m390 | [0m[35m                    self._start(service_name)[0m
[30;1m391 | [0m[35m[0m
[30;1m392 | [0m[35m            # Every time we change our container allocation do a little clean up to keep things fres[0m

[31m--[ [0m[34mMatch #[0m[33m603[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m374 | [0m[35m            delta = target - running[0m
[30;1m375 | [0m[35m[0m
[30;1m376 | [0m[35m            if delta < 0:[0m
[30;1m377 | [0m[35m                # Kill off delta instances of of the service[0m
[30;1m378 | [0m[35m                filters = {'label': f'component={service_name}'}[0m
[30;1m379 | [0m[35m                running = [container[0m
[30;1m380 | [0m[35m                           for container in self.client.containers.list(filters=filters, ignore_remo[0m
[30;1m381 | [0m[35m                           if container.status in {'restarting', 'running'} and 'dependency_for' not[0m

[31m--[ [0m[34mMatch #[0m[33m604[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m364 | [0m[35m        return {}[0m
[30;1m365 | [0m[35m[0m
[30;1m366 | [0m[35m    def set_target(self, service_name, target):[0m
[30;1m367 | [0m[35m        """Change how many instances of a service docker is trying to keep up.[0m
[30;1m368 | [0m[35m[0m
[30;1m369 | [0m[35m        This is managed by killing extra containers at random, or launching new ones.[0m
[30;1m370 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m605[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m352 | [0m[35m            elif container.status in {'created', 'removing', 'paused', 'exited', 'dead'}:[0m
[30;1m353 | [0m[35m                pass[0m
[30;1m354 | [0m[35m            else:[0m
[30;1m355 | [0m[35m                self.log.warning(f"Unknown docker status string: {container.status}")[0m
[30;1m356 | [0m[35m        return running[0m
[30;1m357 | [0m[35m[0m
[30;1m358 | [0m[35m    def get_targets(self) -> Dict[str, int]:[0m

[31m--[ [0m[34mMatch #[0m[33m606[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m340 | [0m[35m        """Get how many instances of a service we expect to be running.[0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35m        Since we start our containers with 'restart always' we just need to count how many[0m
[30;1m343 | [0m[35m        docker is currently trying to keep running.[0m
[30;1m344 | [0m[35m        """[0m
[30;1m345 | [0m[35m        running = 0[0m
[30;1m346 | [0m[35m        filters = {'label': f'component={service_name}'}[0m

[31m--[ [0m[34mMatch #[0m[33m607[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m337 | [0m[35m        return mem, total_mem[0m
[30;1m338 | [0m[35m[0m
[30;1m339 | [0m[35m    def get_target(self, service_name: str) -> int:[0m
[30;1m340 | [0m[35m        """Get how many instances of a service we expect to be running.[0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35m        Since we start our containers with 'restart always' we just need to count how many[0m
[30;1m343 | [0m[35m        docker is currently trying to keep running.[0m

[31m--[ [0m[34mMatch #[0m[33m608[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m337 | [0m[35m        return mem, total_mem[0m
[30;1m338 | [0m[35m[0m
[30;1m339 | [0m[35m    def get_target(self, service_name: str) -> int:[0m
[30;1m340 | [0m[35m        """Get how many instances of a service we expect to be running.[0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35m        Since we start our containers with 'restart always' we just need to count how many[0m
[30;1m343 | [0m[35m        docker is currently trying to keep running.[0m

[31m--[ [0m[34mMatch #[0m[33m609[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m325 | [0m[35m        return cpu, total_cpu[0m
[30;1m326 | [0m[35m[0m
[30;1m327 | [0m[35m    def memory_info(self):[0m
[30;1m328 | [0m[35m        """Try to estimate how much RAM the docker host has unreserved.[0m
[30;1m329 | [0m[35m[0m
[30;1m330 | [0m[35m        NOTE: There is probably a better way to do this.[0m
[30;1m331 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m610[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m313 | [0m[35m            index += 1[0m
[30;1m314 | [0m[35m[0m
[30;1m315 | [0m[35m    def cpu_info(self):[0m
[30;1m316 | [0m[35m        """Try to estimate how much CPU the docker host has unreserved.[0m
[30;1m317 | [0m[35m[0m
[30;1m318 | [0m[35m        NOTE: There is probably a better way to do this.[0m
[30;1m319 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m611[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m296 | [0m[35m        """Find an unused name for a container.[0m
[30;1m297 | [0m[35m[0m
[30;1m298 | [0m[35m        Container names must be unique, but we want our names to be predictable and informative.[0m
[30;1m299 | [0m[35m        Cycle through the pattern we want until we find the lowest free numerical suffix.[0m
[30;1m300 | [0m[35m        """[0m
[30;1m301 | [0m[35m        # Load all container names on the system now[0m
[30;1m302 | [0m[35m        used_names = [][0m

[31m--[ [0m[34mMatch #[0m[33m612[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m257 | [0m[35m            env.append('PRIVILEGED=true')[0m
[30;1m258 | [0m[35m        env += [f'{_e.name}={_e.value}' for _e in cfg.environment][0m
[30;1m259 | [0m[35m        env += [f'{name}={os.environ[name]}' for name in INHERITED_VARIABLES if name in os.environ][0m
[30;1m260 | [0m[35m        env += [f'LOG_LEVEL={self.log_level}', f'AL_SERVICE_NAME={service_name}'][0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35m        healthcheck = {[0m
[30;1m263 | [0m[35m            'test': ["CMD", "python3", "-m", "assemblyline_v4_service.healthz"],[0m

[31m--[ [0m[34mMatch #[0m[33m613[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m256 | [0m[35m            env += [f'{_n}={_v}' for _n, _v in self.core_env.items()][0m
[30;1m257 | [0m[35m            env.append('PRIVILEGED=true')[0m
[30;1m258 | [0m[35m        env += [f'{_e.name}={_e.value}' for _e in cfg.environment][0m
[30;1m259 | [0m[35m        env += [f'{name}={os.environ[name]}' for name in INHERITED_VARIABLES if name in os.environ][0m
[30;1m260 | [0m[35m        env += [f'LOG_LEVEL={self.log_level}', f'AL_SERVICE_NAME={service_name}'][0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35m        healthcheck = {[0m

[31m--[ [0m[34mMatch #[0m[33m614[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m255 | [0m[35m        if core_container:[0m
[30;1m256 | [0m[35m            env += [f'{_n}={_v}' for _n, _v in self.core_env.items()][0m
[30;1m257 | [0m[35m            env.append('PRIVILEGED=true')[0m
[30;1m258 | [0m[35m        env += [f'{_e.name}={_e.value}' for _e in cfg.environment][0m
[30;1m259 | [0m[35m        env += [f'{name}={os.environ[name]}' for name in INHERITED_VARIABLES if name in os.environ][0m
[30;1m260 | [0m[35m        env += [f'LOG_LEVEL={self.log_level}', f'AL_SERVICE_NAME={service_name}'][0m
[30;1m261 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m615[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m253 | [0m[35m        # Put together the environment variables[0m
[30;1m254 | [0m[35m        env = [][0m
[30;1m255 | [0m[35m        if core_container:[0m
[30;1m256 | [0m[35m            env += [f'{_n}={_v}' for _n, _v in self.core_env.items()][0m
[30;1m257 | [0m[35m            env.append('PRIVILEGED=true')[0m
[30;1m258 | [0m[35m        env += [f'{_e.name}={_e.value}' for _e in cfg.environment][0m
[30;1m259 | [0m[35m        env += [f'{name}={os.environ[name]}' for name in INHERITED_VARIABLES if name in os.environ][0m

[31m--[ [0m[34mMatch #[0m[33m616[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m251 | [0m[35m            self.log.warning(f"Not sure how to parse port string {port_string} for container {name} [0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m        # Put together the environment variables[0m
[30;1m254 | [0m[35m        env = [][0m
[30;1m255 | [0m[35m        if core_container:[0m
[30;1m256 | [0m[35m            env += [f'{_n}={_v}' for _n, _v in self.core_env.items()][0m
[30;1m257 | [0m[35m            env.append('PRIVILEGED=true')[0m

[31m--[ [0m[34mMatch #[0m[33m617[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m    def _start_container([0m
[30;1m232 | [0m[35m            self, service_name, name, labels, volumes, cfg: DockerConfig, network, hostname, core_co[0m
[30;1m233 | [0m[35m        """Launch a docker container."""[0m
[30;1m234 | [0m[35m        # Take the port strings and convert them to a dictionary[0m
[30;1m235 | [0m[35m        ports = {}[0m
[30;1m236 | [0m[35m        for port_string in cfg.ports:[0m

[31m--[ [0m[34mMatch #[0m[33m618[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m192 | [0m[35m        env = [f'{name}={os.environ[name]}' for name in INHERITED_VARIABLES if name in os.environ][0m
[30;1m193 | [0m[35m        env += [f'LOG_LEVEL={self.log_level}', f'AL_SERVICE_NAME={service_name}'][0m
[30;1m194 | [0m[35m        env += [f'{_n}={_v}' for _n, _v in self._service_limited_env[service_name].items()][0m
[30;1m195 | [0m[35m        env += [f'{_e.name}={_e.value}' for _e in cfg.environment][0m
[30;1m196 | [0m[35m        if prof.privileged:[0m
[30;1m197 | [0m[35m            env.append('PRIVILEGED=true')[0m
[30;1m198 | [0m[35m            volumes.update({row[0]: {'bind': row[1], 'mode': 'ro'} for row in self.core_mounts})[0m

[31m--[ [0m[34mMatch #[0m[33m619[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m191 | [0m[35m        # Define environment variables[0m
[30;1m192 | [0m[35m        env = [f'{name}={os.environ[name]}' for name in INHERITED_VARIABLES if name in os.environ][0m
[30;1m193 | [0m[35m        env += [f'LOG_LEVEL={self.log_level}', f'AL_SERVICE_NAME={service_name}'][0m
[30;1m194 | [0m[35m        env += [f'{_n}={_v}' for _n, _v in self._service_limited_env[service_name].items()][0m
[30;1m195 | [0m[35m        env += [f'{_e.name}={_e.value}' for _e in cfg.environment][0m
[30;1m196 | [0m[35m        if prof.privileged:[0m
[30;1m197 | [0m[35m            env.append('PRIVILEGED=true')[0m

[31m--[ [0m[34mMatch #[0m[33m620[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m        # Define environment variables[0m
[30;1m192 | [0m[35m        env = [f'{name}={os.environ[name]}' for name in INHERITED_VARIABLES if name in os.environ][0m
[30;1m193 | [0m[35m        env += [f'LOG_LEVEL={self.log_level}', f'AL_SERVICE_NAME={service_name}'][0m
[30;1m194 | [0m[35m        env += [f'{_n}={_v}' for _n, _v in self._service_limited_env[service_name].items()][0m
[30;1m195 | [0m[35m        env += [f'{_e.name}={_e.value}' for _e in cfg.environment][0m
[30;1m196 | [0m[35m        if prof.privileged:[0m

[31m--[ [0m[34mMatch #[0m[33m621[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m189 | [0m[35m        volumes = {row[0]: {'bind': row[1], 'mode': 'ro'} for row in self.global_mounts}[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m        # Define environment variables[0m
[30;1m192 | [0m[35m        env = [f'{name}={os.environ[name]}' for name in INHERITED_VARIABLES if name in os.environ][0m
[30;1m193 | [0m[35m        env += [f'LOG_LEVEL={self.log_level}', f'AL_SERVICE_NAME={service_name}'][0m
[30;1m194 | [0m[35m        env += [f'{_n}={_v}' for _n, _v in self._service_limited_env[service_name].items()][0m
[30;1m195 | [0m[35m        env += [f'{_e.name}={_e.value}' for _e in cfg.environment][0m

[31m--[ [0m[34mMatch #[0m[33m622[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m[0m
[30;1m173 | [0m[35m    def _start(self, service_name):[0m
[30;1m174 | [0m[35m        """Launch a docker container in a manner suitable for Assemblyline."""[0m
[30;1m175 | [0m[35m        container_name, container_index = self._name_container(service_name)[0m
[30;1m176 | [0m[35m        prof = self._profiles[service_name][0m
[30;1m177 | [0m[35m        cfg = prof.container_config[0m

[31m--[ [0m[34mMatch #[0m[33m623[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m163 | [0m[35m            raise e[0m
[30;1m164 | [0m[35m        except docker.errors.NotFound as e:[0m
[30;1m165 | [0m[35m            if aliases == ['service-server']:[0m
[30;1m166 | [0m[35m                # We've lost our service-server container, time to find another[0m
[30;1m167 | [0m[35m                self.service_server = self.find_service_server()[0m
[30;1m168 | [0m[35m                network.connect(self.service_server, aliases=aliases)[0m
[30;1m169 | [0m[35m                return[0m

[31m--[ [0m[34mMatch #[0m[33m624[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m163 | [0m[35m            raise e[0m
[30;1m164 | [0m[35m        except docker.errors.NotFound as e:[0m
[30;1m165 | [0m[35m            if aliases == ['service-server']:[0m
[30;1m166 | [0m[35m                # We've lost our service-server container, time to find another[0m
[30;1m167 | [0m[35m                self.service_server = self.find_service_server()[0m
[30;1m168 | [0m[35m                network.connect(self.service_server, aliases=aliases)[0m
[30;1m169 | [0m[35m                return[0m

[31m--[ [0m[34mMatch #[0m[33m625[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m148 | [0m[35m            self.client.volumes.prune()[0m
[30;1m149 | [0m[35m[0m
[30;1m150 | [0m[35m    def add_profile(self, profile, scale=0):[0m
[30;1m151 | [0m[35m        """Tell the controller about a service profile it needs to manage."""[0m
[30;1m152 | [0m[35m        self._profiles[profile.name] = profile[0m
[30;1m153 | [0m[35m        self._pull_image(profile)[0m
[30;1m154 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m626[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m                # If it does return, find the new service server[0m
[30;1m130 | [0m[35m                self.service_server = self.find_service_server()[0m
[30;1m131 | [0m[35m            except Exception:[0m
[30;1m132 | [0m[35m                self.log.exception("An error occurred while watching the service server.")[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m    def stop(self):[0m
[30;1m135 | [0m[35m        self._flush_containers()[0m

[31m--[ [0m[34mMatch #[0m[33m627[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m126 | [0m[35m                except docker.errors.NotFound:[0m
[30;1m127 | [0m[35m                    pass[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m                # If it does return, find the new service server[0m
[30;1m130 | [0m[35m                self.service_server = self.find_service_server()[0m
[30;1m131 | [0m[35m            except Exception:[0m
[30;1m132 | [0m[35m                self.log.exception("An error occurred while watching the service server.")[0m

[31m--[ [0m[34mMatch #[0m[33m628[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m126 | [0m[35m                except docker.errors.NotFound:[0m
[30;1m127 | [0m[35m                    pass[0m
[30;1m128 | [0m[35m[0m
[30;1m129 | [0m[35m                # If it does return, find the new service server[0m
[30;1m130 | [0m[35m                self.service_server = self.find_service_server()[0m
[30;1m131 | [0m[35m            except Exception:[0m
[30;1m132 | [0m[35m                self.log.exception("An error occurred while watching the service server.")[0m

[31m--[ [0m[34mMatch #[0m[33m629[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m120 | [0m[35m                        self._connect_to_network(self.service_server, self.networks[service_name],[0m
[30;1m121 | [0m[35m                                                 aliases=['service-server'])[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m                # As long as the current service server is still running, just block its exit code i[0m
[30;1m124 | [0m[35m                try:[0m
[30;1m125 | [0m[35m                    self.service_server.wait()[0m
[30;1m126 | [0m[35m                except docker.errors.NotFound:[0m

[31m--[ [0m[34mMatch #[0m[33m630[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m103 | [0m[35m            for container in self.client.containers.list():[0m
[30;1m104 | [0m[35m                if 'service_server' in container.name:[0m
[30;1m105 | [0m[35m                    service_server_container = container[0m
[30;1m106 | [0m[35m                    self.log.info(f'Found the service server at: {container.id} [{container.name}]')[0m
[30;1m107 | [0m[35m                    break[0m
[30;1m108 | [0m[35m            if not service_server_container:[0m
[30;1m109 | [0m[35m                time.sleep(1)[0m

[31m--[ [0m[34mMatch #[0m[33m631[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m80 | [0m[35m        # We aren't checking for swarm nodes[0m
[30;1m81 | [0m[35m        assert not self._info['Swarm']['NodeID'][0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m        # Start a background thread to keep the service server connected[0m
[30;1m84 | [0m[35m        threading.Thread(target=self._refresh_service_networks, daemon=True).start()[0m
[30;1m85 | [0m[35m        self._flush_containers()  # Clear out any containers that are left over from a previous run[0m
[30;1m86 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m632[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35m            self.core_network = network[0m
[30;1m66 | [0m[35m            break[0m
[30;1m67 | [0m[35m        else:[0m
[30;1m68 | [0m[35m            raise ValueError(f"Could not find network {AL_CORE_NETWORK}")[0m
[30;1m69 | [0m[35m        self.networks = {}[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m        # CPU and memory reserved for the host[0m

[31m--[ [0m[34mMatch #[0m[33m633[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m38 | [0m[35m        :param logger: A logger to report status and debug information.[0m
[30;1m39 | [0m[35m        :param prefix: A prefix used to distinguish containers launched by this controller.[0m
[30;1m40 | [0m[35m        """[0m
[30;1m41 | [0m[35m        # Connect to the host docker port[0m
[30;1m42 | [0m[35m        self.client = docker.from_env()[0m
[30;1m43 | [0m[35m        self.log = logger[0m
[30;1m44 | [0m[35m        self.log_level = log_level[0m

[31m--[ [0m[34mMatch #[0m[33m634[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m# Where to find the update directory inside this container.[0m
[30;1m14 | [0m[35mINHERITED_VARIABLES = ['HTTP_PROXY', 'HTTPS_PROXY', 'NO_PROXY', 'http_proxy', 'https_proxy', 'no_pro[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m# Every this many seconds, check that the services can actually reach the service server.[0m
[30;1m17 | [0m[35mNETWORK_REFRESH_INTERVAL = 60 * 3[0m
[30;1m18 | [0m[35mCHANGE_KEY_NAME = 'al_change_key'[0m
[30;1m19 | [0m[35mAL_CORE_NETWORK = os.environ.get("AL_CORE_NETWORK", 'al_core')[0m

[31m--[ [0m[34mMatch #[0m[33m635[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mfrom assemblyline.odm.models.service import DependencyConfig, DockerConfig[0m
[30;1m11 | [0m[35mfrom .interface import ControllerInterface, ServiceControlError[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m# Where to find the update directory inside this container.[0m
[30;1m14 | [0m[35mINHERITED_VARIABLES = ['HTTP_PROXY', 'HTTPS_PROXY', 'NO_PROXY', 'http_proxy', 'https_proxy', 'no_pro[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m# Every this many seconds, check that the services can actually reach the service server.[0m

[31m--[ [0m[34mMatch #[0m[33m636[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mimport docker[0m
[30;1m3 | [0m[35mimport os[0m
[30;1m4 | [0m[35mimport threading[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mfrom collections import defaultdict[0m
[30;1m7 | [0m[35mfrom typing import List, Optional, Tuple, Dict[0m
[30;1m8 | [0m[35mimport uuid[0m
[30;1m9 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m637[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/docker_ctl.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom __future__ import annotations[0m
[30;1m2 | [0m[35mimport docker[0m
[30;1m3 | [0m[35mimport os[0m
[30;1m4 | [0m[35mimport threading[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mfrom collections import defaultdict[0m

[31m--[ [0m[34mMatch #[0m[33m638[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m        output_zip = InMemoryZip()[0m
[30;1m220 | [0m[35m        for fname, data in output_files.items():[0m
[30;1m221 | [0m[35m            separator = self.delimiters.get(fname.split('/')[0], {}).get('delimiter', DEFAULT_DELIMI[0m
[30;1m222 | [0m[35m            output_zip.append(fname, separator.join(data))[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m        return output_zip.read()[0m

[31m--[ [0m[34mMatch #[0m[33m639[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m218 | [0m[35m[0m
[30;1m219 | [0m[35m        output_zip = InMemoryZip()[0m
[30;1m220 | [0m[35m        for fname, data in output_files.items():[0m
[30;1m221 | [0m[35m            separator = self.delimiters.get(fname.split('/')[0], {}).get('delimiter', DEFAULT_DELIMI[0m
[30;1m222 | [0m[35m            output_zip.append(fname, separator.join(data))[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m        return output_zip.read()[0m

[31m--[ [0m[34mMatch #[0m[33m640[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m        for sig in signature_list:[0m
[30;1m213 | [0m[35m            out_fname = f"{sig['type']}/{sig['source']}"[0m
[30;1m214 | [0m[35m            if self.delimiters.get(sig['type'], {}).get('type', None) == 'file':[0m
[30;1m215 | [0m[35m                out_fname = f"{out_fname}/{sig['signature_id']}"[0m
[30;1m216 | [0m[35m            output_files.setdefault(out_fname, [])[0m
[30;1m217 | [0m[35m            output_files[out_fname].append(sig['data'])[0m

[31m--[ [0m[34mMatch #[0m[33m641[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m        for sig in signature_list:[0m
[30;1m213 | [0m[35m            out_fname = f"{sig['type']}/{sig['source']}"[0m
[30;1m214 | [0m[35m            if self.delimiters.get(sig['type'], {}).get('type', None) == 'file':[0m
[30;1m215 | [0m[35m                out_fname = f"{out_fname}/{sig['signature_id']}"[0m
[30;1m216 | [0m[35m            output_files.setdefault(out_fname, [])[0m
[30;1m217 | [0m[35m            output_files[out_fname].append(sig['data'])[0m

[31m--[ [0m[34mMatch #[0m[33m642[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m175 | [0m[35m                                 f"{data['status']} to {status}.")[0m
[30;1m176 | [0m[35m[0m
[30;1m177 | [0m[35m            today = now_as_iso()[0m
[30;1m178 | [0m[35m            uname = user.get('uname')[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m            if status not in ['DISABLED', 'INVALID', 'TESTING']:[0m
[30;1m181 | [0m[35m                query = f"status:{status} AND signature_id:{data['signature_id']} AND NOT id:{signat[0m

[31m--[ [0m[34mMatch #[0m[33m643[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m163 | [0m[35m        data = self.datastore.signature.get(signature_id, as_obj=False)[0m
[30;1m164 | [0m[35m        if data:[0m
[30;1m165 | [0m[35m            if user and not CLASSIFICATION.is_accessible(user['classification'],[0m
[30;1m166 | [0m[35m                                                         data.get('classification', CLASSIFICATION.U[0m
[30;1m167 | [0m[35m                raise PermissionError("You are not allowed change status on this signature")[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m            if data['status'] in STALE_STATUSES and status not in DRAFT_STATUSES:[0m

[31m--[ [0m[34mMatch #[0m[33m644[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m160 | [0m[35m        if status not in possible_statuses:[0m
[30;1m161 | [0m[35m            raise ValueError(f"You cannot apply the status {status} on yara rules.")[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m        data = self.datastore.signature.get(signature_id, as_obj=False)[0m
[30;1m164 | [0m[35m        if data:[0m
[30;1m165 | [0m[35m            if user and not CLASSIFICATION.is_accessible(user['classification'],[0m
[30;1m166 | [0m[35m                                                         data.get('classification', CLASSIFICATION.U[0m

[31m--[ [0m[34mMatch #[0m[33m645[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m        plan = self.datastore.signature.get_bulk_plan()[0m
[30;1m129 | [0m[35m        for rule in data:[0m
[30;1m130 | [0m[35m            key = f"{rule['type']}_{rule['source']}_{rule.get('signature_id', rule['name'])}"[0m
[30;1m131 | [0m[35m            if key in old_data:[0m
[30;1m132 | [0m[35m                # Ensure that the last state change, if any, was made by a user and not a system acc[0m
[30;1m133 | [0m[35m                user_modified_last_state = old_data[key]['state_change_user'] not in ['update_servic[0m

[31m--[ [0m[34mMatch #[0m[33m646[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m120 | [0m[35m            if skip_list:[0m
[30;1m121 | [0m[35m                data = [[0m
[30;1m122 | [0m[35m                    x for x in data[0m
[30;1m123 | [0m[35m                    if f"{x['type']}_{x['source']}_{x.get('signature_id', x['name'])}" not in skip_l[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m        old_data = self.datastore.signature.multiget(list(names_map.values()), as_dictionary=True, a[0m
[30;1m126 | [0m[35m                                                     error_on_missing=False)[0m

[31m--[ [0m[34mMatch #[0m[33m647[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m113 | [0m[35m        if dedup_name:[0m
[30;1m114 | [0m[35m            for item in self.datastore.signature.stream_search(f"type: \"{sig_type}\" AND source:\"{[0m
[30;1m115 | [0m[35m                                                               fl="id,name", as_obj=False, item_buff[0m
[30;1m116 | [0m[35m                lookup_id = names_map.get(item['name'], None)[0m
[30;1m117 | [0m[35m                if lookup_id and lookup_id != item['id']:[0m
[30;1m118 | [0m[35m                    skip_list.append(lookup_id)[0m
[30;1m119 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m648[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m            raise ValueError("Source, source type and data are mandatory fields.")[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m        # Test signature names[0m
[30;1m110 | [0m[35m        names_map = {x['name']: f"{x['type']}_{x['source']}_{x.get('signature_id', x['name'])}" for [0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m        skip_list = [][0m
[30;1m113 | [0m[35m        if dedup_name:[0m

[31m--[ [0m[34mMatch #[0m[33m649[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m75 | [0m[35m            if other['total'] > 0:[0m
[30;1m76 | [0m[35m                raise ValueError("A signature with that name already exists")[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m        old = self.datastore.signature.get(key, as_obj=False)[0m
[30;1m79 | [0m[35m        op = Operation.Modified if old else Operation.Added[0m
[30;1m80 | [0m[35m        if old:[0m
[30;1m81 | [0m[35m            if old['data'] == data['data']:[0m

[31m--[ [0m[34mMatch #[0m[33m650[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m            raise ValueError("Signature id, name, type and data are mandatory fields.")[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        # Compute signature ID if missing[0m
[30;1m64 | [0m[35m        data['signature_id'] = data.get('signature_id', data['name'])[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m        key = f"{data['type']}_{data['source']}_{data['signature_id']}"[0m
[30;1m67 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m651[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35m    def add_update(self, data, dedup_name=True):[0m
[30;1m60 | [0m[35m        if data.get('type', None) is None or data['name'] is None or data['data'] is None:[0m
[30;1m61 | [0m[35m            raise ValueError("Signature id, name, type and data are mandatory fields.")[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m        # Compute signature ID if missing[0m

[31m--[ [0m[34mMatch #[0m[33m652[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m47 | [0m[35m            if replacement.startswith('_'):[0m
[30;1m48 | [0m[35m                # Replace with known field in Signature model[0m
[30;1m49 | [0m[35m                # Otherwise replace with literal[0m
[30;1m50 | [0m[35m                if signature.get(replacement[1:]):[0m
[30;1m51 | [0m[35m                    replacement = signature[replacement[1:]][0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m            classification = classification.replace(term, replacement)[0m

[31m--[ [0m[34mMatch #[0m[33m653[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m        if delimiter_type == 'custom':[0m
[30;1m38 | [0m[35m            delimiter = update_config['custom_delimiter'].encode().decode('unicode-escape')[0m
[30;1m39 | [0m[35m        else:[0m
[30;1m40 | [0m[35m            delimiter = SIGNATURE_DELIMITERS.get(delimiter_type, '\n\n')[0m
[30;1m41 | [0m[35m        return {'type': delimiter_type, 'delimiter': delimiter}[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    def _update_classification(self, signature):[0m

[31m--[ [0m[34mMatch #[0m[33m654[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m    def _get_signature_delimiters(self):[0m
[30;1m29 | [0m[35m        signature_delimiters = {}[0m
[30;1m30 | [0m[35m        for service in self.service_list:[0m
[30;1m31 | [0m[35m            if service.get("update_config", {}).get("generates_signatures", False):[0m
[30;1m32 | [0m[35m                signature_delimiters[service['name'].lower()] = self._get_signature_delimiter(servic[0m
[30;1m33 | [0m[35m        return signature_delimiters[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m655[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m28 | [0m[35m    def _get_signature_delimiters(self):[0m
[30;1m29 | [0m[35m        signature_delimiters = {}[0m
[30;1m30 | [0m[35m        for service in self.service_list:[0m
[30;1m31 | [0m[35m            if service.get("update_config", {}).get("generates_signatures", False):[0m
[30;1m32 | [0m[35m                signature_delimiters[service['name'].lower()] = self._get_signature_delimiter(servic[0m
[30;1m33 | [0m[35m        return signature_delimiters[0m
[30;1m34 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m656[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/signature_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m    def _get_signature_delimiters(self):[0m
[30;1m29 | [0m[35m        signature_delimiters = {}[0m
[30;1m30 | [0m[35m        for service in self.service_list:[0m
[30;1m31 | [0m[35m            if service.get("update_config", {}).get("generates_signatures", False):[0m
[30;1m32 | [0m[35m                signature_delimiters[service['name'].lower()] = self._get_signature_delimiter(servic[0m
[30;1m33 | [0m[35m        return signature_delimiters[0m

[31m--[ [0m[34mMatch #[0m[33m657[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/signature_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    def _update_classification(self, signature):[0m
[30;1m44 | [0m[35m        classification = signature['classification'][0m
[30;1m45 | [0m[35m        # Update classification of signatures based on rewrite definition[0m
[30;1m46 | [0m[35m        for term, replacement in self.classification_replace_map.items():[0m
[30;1m47 | [0m[35m            if replacement.startswith('_'):[0m
[30;1m48 | [0m[35m                # Replace with known field in Signature model[0m

[31m--[ [0m[34mMatch #[0m[33m658[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_safelist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m303 | [0m[35m    assert op == 'update'[0m
[30;1m304 | [0m[35m[0m
[30;1m305 | [0m[35m    # Load inserted data from DB[0m
[30;1m306 | [0m[35m    ds_u = client.datastore.safelist.get(update_hash, as_obj=False)[0m
[30;1m307 | [0m[35m[0m
[30;1m308 | [0m[35m    # Normalize classification in sources[0m
[30;1m309 | [0m[35m    for source in ds_u['sources']:[0m

[31m--[ [0m[34mMatch #[0m[33m659[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_safelist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m282 | [0m[35m    assert op == 'add'[0m
[30;1m283 | [0m[35m[0m
[30;1m284 | [0m[35m    # Load inserted data from DB[0m
[30;1m285 | [0m[35m    ds_sl = client.datastore.safelist.get(update_hash, as_obj=False)[0m
[30;1m286 | [0m[35m[0m
[30;1m287 | [0m[35m    # Normalize classification in sources[0m
[30;1m288 | [0m[35m    for source in ds_sl['sources']:[0m

[31m--[ [0m[34mMatch #[0m[33m660[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_safelist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m208 | [0m[35m    assert op == 'add'[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    # Load inserted data from DB[0m
[30;1m211 | [0m[35m    ds_sl = client.datastore.safelist.get(expected_qhash, as_obj=False)[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m    # Test dates[0m
[30;1m214 | [0m[35m    added = ds_sl.pop('added', None)[0m

[31m--[ [0m[34mMatch #[0m[33m661[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_safelist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m147 | [0m[35m    assert op == 'add'[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    # Load inserted data from DB[0m
[30;1m150 | [0m[35m    ds_sl = client.datastore.safelist.get(expected_qhash, as_obj=False)[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m    # Test dates[0m
[30;1m153 | [0m[35m    added = ds_sl.pop('added', None)[0m

[31m--[ [0m[34mMatch #[0m[33m662[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_safelist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m    assert op == 'add'[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m    # Load inserted data from DB[0m
[30;1m94 | [0m[35m    ds_sl = client.datastore.safelist.get(add_hash_file, as_obj=False)[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m    # Test dates[0m
[30;1m97 | [0m[35m    added = ds_sl.pop('added', None)[0m

[31m--[ [0m[34mMatch #[0m[33m663[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_safelist_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m[0m
[30;1m2 | [0m[35mimport hashlib[0m
[30;1m3 | [0m[35mimport random[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mfrom copy import deepcopy[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport pytest[0m
[30;1m8 | [0m[35mfrom assemblyline.common.forge import get_classification[0m

[31m--[ [0m[34mMatch #[0m[33m664[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m373 | [0m[35m        :param sid: Submission ID[0m
[30;1m374 | [0m[35m        :return: The name of the watch queue that was created[0m
[30;1m375 | [0m[35m        """[0m
[30;1m376 | [0m[35m        dispatcher_id = self.submission_assignments.get(sid)[0m
[30;1m377 | [0m[35m        if dispatcher_id:[0m
[30;1m378 | [0m[35m            queue_name = reply_queue_name(prefix="D", suffix="WQ")[0m
[30;1m379 | [0m[35m            command_queue = NamedQueue(DISPATCH_COMMAND_QUEUE+dispatcher_id, host=self.redis)[0m

[31m--[ [0m[34mMatch #[0m[33m665[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m177 | [0m[35m        :return: Dictionary of services and number of files[0m
[30;1m178 | [0m[35m                 remaining per services e.g. {"SERVICE_NAME": 1, ... }[0m
[30;1m179 | [0m[35m        """[0m
[30;1m180 | [0m[35m        dispatcher_id = self.submission_assignments.get(sid)[0m
[30;1m181 | [0m[35m        if dispatcher_id:[0m
[30;1m182 | [0m[35m            queue_name = reply_queue_name(prefix="D", suffix="ResponseQueue")[0m
[30;1m183 | [0m[35m            queue: NamedQueue[dict[str, int]] = NamedQueue(queue_name, host=self.redis, ttl=30)[0m

[31m--[ [0m[34mMatch #[0m[33m666[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m371 | [0m[35m        the specified queue so the client that requests the watch queue is up to date.[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m        :param sid: Submission ID[0m
[30;1m374 | [0m[35m        :return: The name of the watch queue that was created[0m
[30;1m375 | [0m[35m        """[0m
[30;1m376 | [0m[35m        dispatcher_id = self.submission_assignments.get(sid)[0m
[30;1m377 | [0m[35m        if dispatcher_id:[0m

[31m--[ [0m[34mMatch #[0m[33m667[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m368 | [0m[35m        result keys for that given submission will be returned to as soon as they come in.[0m
[30;1m369 | [0m[35m[0m
[30;1m370 | [0m[35m        If the submission is in the middle of processing, this will also send all currently received[0m
[30;1m371 | [0m[35m        the specified queue so the client that requests the watch queue is up to date.[0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m        :param sid: Submission ID[0m
[30;1m374 | [0m[35m        :return: The name of the watch queue that was created[0m

[31m--[ [0m[34mMatch #[0m[33m668[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m364 | [0m[35m[0m
[30;1m365 | [0m[35m    def setup_watch_queue(self, sid: str) -> Optional[str]:[0m
[30;1m366 | [0m[35m        """[0m
[30;1m367 | [0m[35m        This function takes a submission ID as a parameter and creates a unique queue where all serv[0m
[30;1m368 | [0m[35m        result keys for that given submission will be returned to as soon as they come in.[0m
[30;1m369 | [0m[35m[0m
[30;1m370 | [0m[35m        If the submission is in the middle of processing, this will also send all currently received[0m
[30;1m371 | [0m[35m        the specified queue so the client that requests the watch queue is up to date.[0m

[31m--[ [0m[34mMatch #[0m[33m669[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m338 | [0m[35m        task_key = ServiceTask.make_key(sid=sid, service_name=error.response.service_name, sha=error[0m
[30;1m339 | [0m[35m        task = self.running_tasks.pop(task_key)[0m
[30;1m340 | [0m[35m        if not task:[0m
[30;1m341 | [0m[35m            self.log.warning(f"[{sid}/{error.sha256}] {error.response.service_name} could not find t[0m
[30;1m342 | [0m[35m                             f"task in its set of running tasks while processing an error.")[0m
[30;1m343 | [0m[35m            return[0m
[30;1m344 | [0m[35m        task = ServiceTask(task)[0m

[31m--[ [0m[34mMatch #[0m[33m670[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m267 | [0m[35m        task = ServiceTask(task)[0m
[30;1m268 | [0m[35m[0m
[30;1m269 | [0m[35m        # Save or freshen the result, the CONTENT of the result shouldn't change, but we need to kee[0m
[30;1m270 | [0m[35m        # most distant expiry time to prevent pulling it out from under another submission too early[0m
[30;1m271 | [0m[35m        if result.is_empty():[0m
[30;1m272 | [0m[35m            result.expiry_ts = now_as_iso(self.config.submission.emptyresult_dtl * 24 * 60 * 60)[0m
[30;1m273 | [0m[35m            self.ds.emptyresult.save(result_key, {"expiry_ts": result.expiry_ts})[0m

[31m--[ [0m[34mMatch #[0m[33m671[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m261 | [0m[35m        task_key = ServiceTask.make_key(sid=sid, service_name=result.response.service_name, sha=resu[0m
[30;1m262 | [0m[35m        task = self.running_tasks.pop(task_key)[0m
[30;1m263 | [0m[35m        if not task:[0m
[30;1m264 | [0m[35m            self.log.warning(f"[{sid}/{result.sha256}] {result.response.service_name} could not find[0m
[30;1m265 | [0m[35m                             f"task in its set of running tasks while processing successful results.[0m
[30;1m266 | [0m[35m            return[0m
[30;1m267 | [0m[35m        task = ServiceTask(task)[0m

[31m--[ [0m[34mMatch #[0m[33m672[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m256 | [0m[35m    def service_finished(self, sid: str, result_key: str, result: Result,[0m
[30;1m257 | [0m[35m                         temporary_data: Optional[dict[str, Any]] = None,[0m
[30;1m258 | [0m[35m                         version="create"):[0m
[30;1m259 | [0m[35m        """Notifies the dispatcher of service completion, and possible new files to dispatch."""[0m
[30;1m260 | [0m[35m        # Make sure the dispatcher knows we were working on this task[0m
[30;1m261 | [0m[35m        task_key = ServiceTask.make_key(sid=sid, service_name=result.response.service_name, sha=resu[0m
[30;1m262 | [0m[35m        task = self.running_tasks.pop(task_key)[0m

[31m--[ [0m[34mMatch #[0m[33m673[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m212 | [0m[35m                                      blocking=blocking, timeout=remaining, low_priority=low_priorit[0m
[30;1m213 | [0m[35m            if work or not blocking:[0m
[30;1m214 | [0m[35m                return work[0m
[30;1m215 | [0m[35m            remaining = timeout - (time.time() - start)[0m
[30;1m216 | [0m[35m        return None[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m    def _request_work(self, worker_id, service_name, service_version,[0m

[31m--[ [0m[34mMatch #[0m[33m674[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m206 | [0m[35m                 been returned by request_work.[0m
[30;1m207 | [0m[35m        """[0m
[30;1m208 | [0m[35m        start = time.time()[0m
[30;1m209 | [0m[35m        remaining = timeout[0m
[30;1m210 | [0m[35m        while int(remaining) > 0:[0m
[30;1m211 | [0m[35m            work = self._request_work(worker_id, service_name, service_version,[0m
[30;1m212 | [0m[35m                                      blocking=blocking, timeout=remaining, low_priority=low_priorit[0m
[30;1m213 | [0m[35m            if work or not blocking:[0m

[31m--[ [0m[34mMatch #[0m[33m675[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m202 | [0m[35m        :param service_version: The version of the service that needs work[0m
[30;1m203 | [0m[35m        :param timeout: How many seconds to block before returning if blocking is true.[0m
[30;1m204 | [0m[35m        :param blocking: Whether to wait for jobs to enter the queue, or if false, return immediatel[0m
[30;1m205 | [0m[35m        :return: The job found, and a boolean value indicating if this is the first time this task h[0m
[30;1m206 | [0m[35m                 been returned by request_work.[0m
[30;1m207 | [0m[35m        """[0m
[30;1m208 | [0m[35m        start = time.time()[0m

[31m--[ [0m[34mMatch #[0m[33m676[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m        :param worker_id:[0m
[30;1m201 | [0m[35m        :param service_name: Which service needs work.[0m
[30;1m202 | [0m[35m        :param service_version: The version of the service that needs work[0m
[30;1m203 | [0m[35m        :param timeout: How many seconds to block before returning if blocking is true.[0m
[30;1m204 | [0m[35m        :param blocking: Whether to wait for jobs to enter the queue, or if false, return immediatel[0m
[30;1m205 | [0m[35m        :return: The job found, and a boolean value indicating if this is the first time this task h[0m

[31m--[ [0m[34mMatch #[0m[33m677[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m198 | [0m[35m        """Pull work from the service queue for the service in question.[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m        :param worker_id:[0m
[30;1m201 | [0m[35m        :param service_name: Which service needs work.[0m
[30;1m202 | [0m[35m        :param service_version: The version of the service that needs work[0m
[30;1m203 | [0m[35m        :param timeout: How many seconds to block before returning if blocking is true.[0m
[30;1m204 | [0m[35m        :param blocking: Whether to wait for jobs to enter the queue, or if false, return immediatel[0m

[31m--[ [0m[34mMatch #[0m[33m678[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m195 | [0m[35m    @elasticapm.capture_span(span_type='dispatch_client')[0m
[30;1m196 | [0m[35m    def request_work(self, worker_id, service_name, service_version,[0m
[30;1m197 | [0m[35m                     timeout: float = 60, blocking=True, low_priority=False) -> Optional[ServiceTask[0m
[30;1m198 | [0m[35m        """Pull work from the service queue for the service in question.[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m        :param worker_id:[0m
[30;1m201 | [0m[35m        :param service_name: Which service needs work.[0m

[31m--[ [0m[34mMatch #[0m[33m679[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m195 | [0m[35m    @elasticapm.capture_span(span_type='dispatch_client')[0m
[30;1m196 | [0m[35m    def request_work(self, worker_id, service_name, service_version,[0m
[30;1m197 | [0m[35m                     timeout: float = 60, blocking=True, low_priority=False) -> Optional[ServiceTask[0m
[30;1m198 | [0m[35m        """Pull work from the service queue for the service in question.[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m        :param worker_id:[0m
[30;1m201 | [0m[35m        :param service_name: Which service needs work.[0m

[31m--[ [0m[34mMatch #[0m[33m680[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35mfrom assemblyline.odm.models.error import Error[0m
[30;1m24 | [0m[35mfrom assemblyline.odm.models.file import File[0m
[30;1m25 | [0m[35mfrom assemblyline.odm.models.result import Result[0m
[30;1m26 | [0m[35mfrom assemblyline.odm.models.service import Service[0m
[30;1m27 | [0m[35mfrom assemblyline.odm.models.submission import Submission[0m
[30;1m28 | [0m[35mfrom assemblyline.remote.datatypes import get_client, reply_queue_name[0m
[30;1m29 | [0m[35mfrom assemblyline.remote.datatypes.hash import ExpiringHash, Hash[0m
[30;1m30 | [0m[35mfrom assemblyline.remote.datatypes.queues.named import NamedQueue[0m

[31m--[ [0m[34mMatch #[0m[33m681[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mimport elasticapm[0m
[30;1m7 | [0m[35mimport functools[0m
[30;1m8 | [0m[35mimport logging[0m
[30;1m9 | [0m[35mimport time[0m
[30;1m10 | [0m[35mimport weakref[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mfrom typing import Optional, Any, cast[0m
[30;1m13 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m682[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m146 | [0m[35m        # Mark the sid as bad[0m
[30;1m147 | [0m[35m        self.bad_sids.add(sid)[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m        # Tell all the known dispatchers that they need to update their bad list[0m
[30;1m150 | [0m[35m        queue_name = reply_queue_name(prefix="D", suffix="ResponseQueue")[0m
[30;1m151 | [0m[35m        queue: NamedQueue[dict[str, int]] = NamedQueue(queue_name, host=self.redis, ttl=30)[0m
[30;1m152 | [0m[35m        listed_dispatchers = set()[0m

[31m--[ [0m[34mMatch #[0m[33m683[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1434 | [0m[35m    dropped_task = notification_queue.pop(timeout=RESPONSE_TIMEOUT)[0m
[30;1m1435 | [0m[35m    assert dropped_task[0m
[30;1m1436 | [0m[35m    dropped_task = IngestTask(dropped_task)[0m
[30;1m1437 | [0m[35m    sub: Submission = core.ds.submission.get(dropped_task.submission.sid)[0m
[30;1m1438 | [0m[35m    assert len(sub.errors) == 0[0m
[30;1m1439 | [0m[35m    assert len(sub.results) == 8, 'results'[0m
[30;1m1440 | [0m[35m    assert core.pre_service.hits[sha] == 1, 'pre_service.hits[root]'[0m

[31m--[ [0m[34mMatch #[0m[33m684[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1351 | [0m[35m    dropped_task = notification_queue.pop(timeout=RESPONSE_TIMEOUT)[0m
[30;1m1352 | [0m[35m    assert dropped_task[0m
[30;1m1353 | [0m[35m    dropped_task = IngestTask(dropped_task)[0m
[30;1m1354 | [0m[35m    sub: Submission = core.ds.submission.get(dropped_task.submission.sid)[0m
[30;1m1355 | [0m[35m[0m
[30;1m1356 | [0m[35m    # The submission should produce no errors and two results[0m
[30;1m1357 | [0m[35m    assert len(sub.errors) == 0[0m

[31m--[ [0m[34mMatch #[0m[33m685[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1339 | [0m[35m        service.local_lock.set()[0m
[30;1m1340 | [0m[35m[0m
[30;1m1341 | [0m[35m    # Let a finish so that the temporary data is added in the dispatcher[0m
[30;1m1342 | [0m[35m    while sum(s.finish.get(sha, 0) for s in core_a) < 1:[0m
[30;1m1343 | [0m[35m        if time.time() - start > RESPONSE_TIMEOUT:[0m
[30;1m1344 | [0m[35m            pytest.fail()[0m
[30;1m1345 | [0m[35m        time.sleep(0.01)    [0m

[31m--[ [0m[34mMatch #[0m[33m686[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1329 | [0m[35m [0m
[30;1m1330 | [0m[35m    # Wait until both of the services have started (so service b doesn't get the temp data a produce[0m
[30;1m1331 | [0m[35m    start = time.time()[0m
[30;1m1332 | [0m[35m    while sum(s.hits.get(sha, 0) for s in core.services) != 2:[0m
[30;1m1333 | [0m[35m        if time.time() - start > RESPONSE_TIMEOUT:[0m
[30;1m1334 | [0m[35m            pytest.fail()[0m
[30;1m1335 | [0m[35m        time.sleep(0.01)[0m

[31m--[ [0m[34mMatch #[0m[33m687[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1265 | [0m[35m    dropped_task = notification_queue.pop(timeout=RESPONSE_TIMEOUT)[0m
[30;1m1266 | [0m[35m    assert dropped_task[0m
[30;1m1267 | [0m[35m    dropped_task = IngestTask(dropped_task)[0m
[30;1m1268 | [0m[35m    sub: Submission = core.ds.submission.get(dropped_task.submission.sid)[0m
[30;1m1269 | [0m[35m    assert len(sub.errors) == 0[0m
[30;1m1270 | [0m[35m    assert len(sub.results) == 4, 'results'[0m
[30;1m1271 | [0m[35m    assert core.pre_service.hits[sha] >= 2, f'pre_service.hits {core.pre_service.hits}'[0m

[31m--[ [0m[34mMatch #[0m[33m688[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1213 | [0m[35m    dropped_task = notification_queue.pop(timeout=RESPONSE_TIMEOUT)[0m
[30;1m1214 | [0m[35m    assert dropped_task[0m
[30;1m1215 | [0m[35m    dropped_task = IngestTask(dropped_task)[0m
[30;1m1216 | [0m[35m    sub: Submission = core.ds.submission.get(dropped_task.submission.sid)[0m
[30;1m1217 | [0m[35m    assert len(sub.errors) == 0[0m
[30;1m1218 | [0m[35m    assert len(sub.results) == 4, 'results'[0m
[30;1m1219 | [0m[35m    assert core.pre_service.hits[sha] == 1, 'pre_service.hits'[0m

[31m--[ [0m[34mMatch #[0m[33m689[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1166 | [0m[35m        task = notification_queue.pop(timeout=RESPONSE_TIMEOUT)[0m
[30;1m1167 | [0m[35m        assert task[0m
[30;1m1168 | [0m[35m        task = IngestTask(task)[0m
[30;1m1169 | [0m[35m        sub = core.ds.submission.get(task.submission.sid)[0m
[30;1m1170 | [0m[35m        assert len(sub.files) == 1[0m
[30;1m1171 | [0m[35m        assert len(sub.results) == 4[0m
[30;1m1172 | [0m[35m        assert len(sub.errors) == 0[0m

[31m--[ [0m[34mMatch #[0m[33m690[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1094 | [0m[35m        task = notification_queue.pop(timeout=RESPONSE_TIMEOUT)[0m
[30;1m1095 | [0m[35m        assert task[0m
[30;1m1096 | [0m[35m        task = IngestTask(task)[0m
[30;1m1097 | [0m[35m        sub = core.ds.submission.get(task.submission.sid)[0m
[30;1m1098 | [0m[35m        assert len(sub.files) == 1[0m
[30;1m1099 | [0m[35m        assert len(sub.results) == 8[0m
[30;1m1100 | [0m[35m        assert len(sub.errors) == 0[0m

[31m--[ [0m[34mMatch #[0m[33m691[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1051 | [0m[35m[0m
[30;1m1052 | [0m[35m    finally:[0m
[30;1m1053 | [0m[35m        _global_semaphore.release()[0m
[30;1m1054 | [0m[35m        service_delta = core.ds.service_delta.get('pre')[0m
[30;1m1055 | [0m[35m        service_delta['enabled'] = True[0m
[30;1m1056 | [0m[35m        core.ds.service_delta.save('pre', service_delta)[0m
[30;1m1057 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m692[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1041 | [0m[35m        assert len(sub.files) == 1[0m
[30;1m1042 | [0m[35m        assert len(sub.results) == 3[0m
[30;1m1043 | [0m[35m        assert len(sub.errors) == 1[0m
[30;1m1044 | [0m[35m        error = core.ds.error.get(sub.errors[0])[0m
[30;1m1045 | [0m[35m        assert "disabled" in error.response.message[0m
[30;1m1046 | [0m[35m[0m
[30;1m1047 | [0m[35m        metrics.expect('ingester', 'submissions_completed', 1)[0m

[31m--[ [0m[34mMatch #[0m[33m693[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1037 | [0m[35m        notification_queue = NamedQueue('nq-test_plumber_clearing', core.redis)[0m
[30;1m1038 | [0m[35m        dropped_task = notification_queue.pop(timeout=RESPONSE_TIMEOUT)[0m
[30;1m1039 | [0m[35m        dropped_task = IngestTask(dropped_task)[0m
[30;1m1040 | [0m[35m        sub = core.ds.submission.get(dropped_task.submission.sid)[0m
[30;1m1041 | [0m[35m        assert len(sub.files) == 1[0m
[30;1m1042 | [0m[35m        assert len(sub.results) == 3[0m
[30;1m1043 | [0m[35m        assert len(sub.errors) == 1[0m

[31m--[ [0m[34mMatch #[0m[33m694[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m1030 | [0m[35m                pytest.fail(f'Found { service_queue.length()}')[0m
[30;1m1031 | [0m[35m            time.sleep(0.1)[0m
[30;1m1032 | [0m[35m[0m
[30;1m1033 | [0m[35m        service_delta = core.ds.service_delta.get('pre')[0m
[30;1m1034 | [0m[35m        service_delta['enabled'] = False[0m
[30;1m1035 | [0m[35m        core.ds.service_delta.save('pre', service_delta)[0m
[30;1m1036 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m695[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m966 | [0m[35m        # One of the submission will get processed fully[0m
[30;1m967 | [0m[35m        assert first_task is not None[0m
[30;1m968 | [0m[35m        first_task = IngestTask(first_task)[0m
[30;1m969 | [0m[35m        first_submission: Submission = core.ds.submission.get(first_task.submission.sid)[0m
[30;1m970 | [0m[35m        assert first_submission.state == 'completed'[0m
[30;1m971 | [0m[35m        assert len(first_submission.files) == 1[0m
[30;1m972 | [0m[35m        assert len(first_submission.errors) == 0[0m

[31m--[ [0m[34mMatch #[0m[33m696[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m925 | [0m[35m[0m
[30;1m926 | [0m[35m    notification_queue = NamedQueue('nq-test-extracted-in-several', core.redis)[0m
[30;1m927 | [0m[35m    task = IngestTask(notification_queue.pop(timeout=RESPONSE_TIMEOUT))[0m
[30;1m928 | [0m[35m    sub: Submission = core.ds.submission.get(task.submission.sid)[0m
[30;1m929 | [0m[35m    assert len(sub.files) == 1[0m
[30;1m930 | [0m[35m    # We should only get results for each file up to the max depth[0m
[30;1m931 | [0m[35m    assert len(sub.results) == 4 * (1 + 3)  # 4 services, 1 original file, 3 extracted files[0m

[31m--[ [0m[34mMatch #[0m[33m697[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m883 | [0m[35m    print("notification time waited", time.time() - start)[0m
[30;1m884 | [0m[35m    assert task is not None[0m
[30;1m885 | [0m[35m    task = IngestTask(task)[0m
[30;1m886 | [0m[35m    sub: Submission = core.ds.submission.get(task.submission.sid)[0m
[30;1m887 | [0m[35m    assert len(sub.files) == 1[0m
[30;1m888 | [0m[35m    # We should only get results for each file up to the max depth[0m
[30;1m889 | [0m[35m    assert len(sub.results) == 4 * (1 + 3)[0m

[31m--[ [0m[34mMatch #[0m[33m698[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m839 | [0m[35m    print("notification time waited", time.time() - start)[0m
[30;1m840 | [0m[35m    assert task is not None[0m
[30;1m841 | [0m[35m    task = IngestTask(task)[0m
[30;1m842 | [0m[35m    sub: Submission = core.ds.submission.get(task.submission.sid)[0m
[30;1m843 | [0m[35m    assert len(sub.files) == 1[0m
[30;1m844 | [0m[35m    # We should only get results for each file up to the max depth[0m
[30;1m845 | [0m[35m    assert len(sub.results) == 4 * core.config.submission.max_extraction_depth[0m

[31m--[ [0m[34mMatch #[0m[33m699[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m795 | [0m[35m    task = notification_queue.pop(timeout=RESPONSE_TIMEOUT)[0m
[30;1m796 | [0m[35m    assert task[0m
[30;1m797 | [0m[35m    task = IngestTask(task)[0m
[30;1m798 | [0m[35m    sub = core.ds.submission.get(task.submission.sid)[0m
[30;1m799 | [0m[35m    assert len(sub.files) == 1[0m
[30;1m800 | [0m[35m    assert len(sub.results) == 8[0m
[30;1m801 | [0m[35m    assert len(sub.errors) == 0[0m

[31m--[ [0m[34mMatch #[0m[33m700[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m757 | [0m[35m[0m
[30;1m758 | [0m[35m    notification_queue = NamedQueue('nq-error', core.redis)[0m
[30;1m759 | [0m[35m    task = IngestTask(notification_queue.pop(timeout=RESPONSE_TIMEOUT))[0m
[30;1m760 | [0m[35m    sub = core.ds.submission.get(task.submission.sid)[0m
[30;1m761 | [0m[35m    assert len(sub.files) == 1[0m
[30;1m762 | [0m[35m    assert len(sub.results) == 3[0m
[30;1m763 | [0m[35m    assert len(sub.errors) == 1[0m

[31m--[ [0m[34mMatch #[0m[33m701[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m702 | [0m[35m    notification_queue = NamedQueue('nq-drop', core.redis)[0m
[30;1m703 | [0m[35m    dropped_task = notification_queue.pop(timeout=RESPONSE_TIMEOUT)[0m
[30;1m704 | [0m[35m    dropped_task = IngestTask(dropped_task)[0m
[30;1m705 | [0m[35m    sub = core.ds.submission.get(dropped_task.submission.sid)[0m
[30;1m706 | [0m[35m    assert len(sub.files) == 1[0m
[30;1m707 | [0m[35m    assert len(sub.results) == 1[0m
[30;1m708 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m702[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m656 | [0m[35m    dropped_task = notification_queue.pop(timeout=RESPONSE_TIMEOUT)[0m
[30;1m657 | [0m[35m    assert dropped_task[0m
[30;1m658 | [0m[35m    dropped_task = IngestTask(dropped_task)[0m
[30;1m659 | [0m[35m    sub = core.ds.submission.get(dropped_task.submission.sid)[0m
[30;1m660 | [0m[35m    assert len(sub.errors) == 1[0m
[30;1m661 | [0m[35m    assert len(sub.results) == 3[0m
[30;1m662 | [0m[35m    assert core.pre_service.drops[sha] == 3[0m

[31m--[ [0m[34mMatch #[0m[33m703[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m611 | [0m[35m    dropped_task = notification_queue.pop(timeout=RESPONSE_TIMEOUT)[0m
[30;1m612 | [0m[35m    assert dropped_task[0m
[30;1m613 | [0m[35m    dropped_task = IngestTask(dropped_task)[0m
[30;1m614 | [0m[35m    sub = core.ds.submission.get(dropped_task.submission.sid)[0m
[30;1m615 | [0m[35m    assert len(sub.errors) == 0  # No error raised if the service succeeds on retry[0m
[30;1m616 | [0m[35m    assert len(sub.results) == 4[0m
[30;1m617 | [0m[35m    assert core.pre_service.drops[sha] == 1[0m

[31m--[ [0m[34mMatch #[0m[33m704[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m505 | [0m[35m        # One of the submission will get processed fully[0m
[30;1m506 | [0m[35m        assert first_task is not None[0m
[30;1m507 | [0m[35m        first_task = IngestTask(first_task)[0m
[30;1m508 | [0m[35m        first_submission: Submission = core.ds.submission.get(first_task.submission.sid)[0m
[30;1m509 | [0m[35m        assert len(attempts) == 2[0m
[30;1m510 | [0m[35m        assert len(failures) == 1[0m
[30;1m511 | [0m[35m        assert first_submission.state == 'completed'[0m

[31m--[ [0m[34mMatch #[0m[33m705[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m446 | [0m[35m[0m
[30;1m447 | [0m[35m    # The third task should not be deduplicated by ingester, so will have a different submission[0m
[30;1m448 | [0m[35m    third_task = IngestTask(third_task)[0m
[30;1m449 | [0m[35m    third_submission: Submission = core.ds.submission.get(third_task.submission.sid)[0m
[30;1m450 | [0m[35m    assert third_submission.state == 'completed'[0m
[30;1m451 | [0m[35m    assert first_submission.sid != third_submission.sid[0m
[30;1m452 | [0m[35m    assert len(third_submission.files) == 1[0m

[31m--[ [0m[34mMatch #[0m[33m706[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m405 | [0m[35m    # One of the submission will get processed fully[0m
[30;1m406 | [0m[35m    assert first_task is not None[0m
[30;1m407 | [0m[35m    first_task = IngestTask(first_task)[0m
[30;1m408 | [0m[35m    first_submission: Submission = core.ds.submission.get(first_task.submission.sid)[0m
[30;1m409 | [0m[35m    assert first_submission.state == 'completed'[0m
[30;1m410 | [0m[35m    assert len(first_submission.files) == 1[0m
[30;1m411 | [0m[35m    assert len(first_submission.errors) == 0[0m

[31m--[ [0m[34mMatch #[0m[33m707[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m230 | [0m[35m        start_time = time.time()[0m
[30;1m231 | [0m[35m        while time.time() - start_time < RESPONSE_TIMEOUT:[0m
[30;1m232 | [0m[35m            if channel in self.data:[0m
[30;1m233 | [0m[35m                if self.data[channel].get(name, 0) >= value:[0m
[30;1m234 | [0m[35m                    # self.data[channel][name] -= value[0m
[30;1m235 | [0m[35m                    return[0m
[30;1m236 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m708[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m            for key, value in metric_message.items():[0m
[30;1m206 | [0m[35m                if isinstance(value, (int, float)):[0m
[30;1m207 | [0m[35m                    existing[key] = existing.get(key, 0) + value[0m
[30;1m208 | [0m[35m        return read[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    def __enter__(self):[0m

[31m--[ [0m[34mMatch #[0m[33m709[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m159 | [0m[35m                result_key = result.build_key(get_random_id())[0m
[30;1m160 | [0m[35m            self.dispatch_client.service_finished(task.sid, result_key, result,[0m
[30;1m161 | [0m[35m                                                  temporary_data=instructions.get('temporary_data'))[0m
[30;1m162 | [0m[35m            self.finish[task.fileinfo.sha256] = self.finish.get(task.fileinfo.sha256, 0) + 1[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35mclass CoreSession:[0m

[31m--[ [0m[34mMatch #[0m[33m710[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m158 | [0m[35m            except KeyError:[0m
[30;1m159 | [0m[35m                result_key = result.build_key(get_random_id())[0m
[30;1m160 | [0m[35m            self.dispatch_client.service_finished(task.sid, result_key, result,[0m
[30;1m161 | [0m[35m                                                  temporary_data=instructions.get('temporary_data'))[0m
[30;1m162 | [0m[35m            self.finish[task.fileinfo.sha256] = self.finish.get(task.fileinfo.sha256, 0) + 1[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m711[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m150 | [0m[35m            }[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m            result_data.update(instructions.get('result', {}))[0m
[30;1m153 | [0m[35m            result_data['response'].update(instructions.get('response', {}))[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m            result = Result(result_data)[0m
[30;1m156 | [0m[35m            try:[0m

[31m--[ [0m[34mMatch #[0m[33m712[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m                'expiry_ts': time.time() + 600[0m
[30;1m150 | [0m[35m            }[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m            result_data.update(instructions.get('result', {}))[0m
[30;1m153 | [0m[35m            result_data['response'].update(instructions.get('response', {}))[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m            result = Result(result_data)[0m

[31m--[ [0m[34mMatch #[0m[33m713[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m                partial = True[0m
[30;1m125 | [0m[35m                requirements = instructions['partial'][0m
[30;1m126 | [0m[35m                for key, value in requirements.items():[0m
[30;1m127 | [0m[35m                    if value in temp_data.get(key, ''):[0m
[30;1m128 | [0m[35m                        partial = False[0m
[30;1m129 | [0m[35m                    else:[0m
[30;1m130 | [0m[35m                        partial = True[0m

[31m--[ [0m[34mMatch #[0m[33m714[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m108 | [0m[35m                    self.drops[task.fileinfo.sha256] = self.drops.get(task.fileinfo.sha256, 0) + 1[0m
[30;1m109 | [0m[35m                    continue[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m            if instructions.get('failure', False):[0m
[30;1m112 | [0m[35m                error = Error(instructions['error'])[0m
[30;1m113 | [0m[35m                error.sha256 = task.fileinfo.sha256[0m
[30;1m114 | [0m[35m                self.dispatch_client.service_failed(task.sid, error=error, error_key=get_random_id()[0m

[31m--[ [0m[34mMatch #[0m[33m715[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m            if 'drop' in instructions:[0m
[30;1m107 | [0m[35m                if instructions['drop'] >= hits:[0m
[30;1m108 | [0m[35m                    self.drops[task.fileinfo.sha256] = self.drops.get(task.fileinfo.sha256, 0) + 1[0m
[30;1m109 | [0m[35m                    continue[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m            if instructions.get('failure', False):[0m

[31m--[ [0m[34mMatch #[0m[33m716[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m            if instructions.get('lock', False):[0m
[30;1m101 | [0m[35m                _global_semaphore.acquire(blocking=True, timeout=instructions['lock'])[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m            if instructions.get('local_lock', False):[0m
[30;1m104 | [0m[35m                self.local_lock.wait(instructions['local_lock'])[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m            if 'drop' in instructions:[0m

[31m--[ [0m[34mMatch #[0m[33m717[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m                _global_semaphore.acquire(blocking=True, timeout=instructions['hold'])[0m
[30;1m98 | [0m[35m                continue[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m            if instructions.get('lock', False):[0m
[30;1m101 | [0m[35m                _global_semaphore.acquire(blocking=True, timeout=instructions['lock'])[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m            if instructions.get('local_lock', False):[0m

[31m--[ [0m[34mMatch #[0m[33m718[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m90 | [0m[35m            self.log.info(f"{self.service_name} following instruction: {instructions}")[0m
[30;1m91 | [0m[35m            hits = self.hits[task.fileinfo.sha256] = self.hits.get(task.fileinfo.sha256, 0) + 1[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m            if instructions.get('hold', False):[0m
[30;1m94 | [0m[35m                queue = get_service_queue(self.service_name, self.dispatch_client.redis)[0m
[30;1m95 | [0m[35m                queue.push(0, task.as_primitives())[0m
[30;1m96 | [0m[35m                self.log.info(f"{self.service_name} Requeued task to {queue.name} holding for {instr[0m

[31m--[ [0m[34mMatch #[0m[33m719[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m            instructions = json.loads(file)[0m
[30;1m89 | [0m[35m            instructions = instructions.get(self.service_name, {})[0m
[30;1m90 | [0m[35m            self.log.info(f"{self.service_name} following instruction: {instructions}")[0m
[30;1m91 | [0m[35m            hits = self.hits[task.fileinfo.sha256] = self.hits.get(task.fileinfo.sha256, 0) + 1[0m
[30;1m92 | [0m[35m[0m
[30;1m93 | [0m[35m            if instructions.get('hold', False):[0m
[30;1m94 | [0m[35m                queue = get_service_queue(self.service_name, self.dispatch_client.redis)[0m

[31m--[ [0m[34mMatch #[0m[33m720[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m86 | [0m[35m            file = self.filestore.get(task.fileinfo.sha256)[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m            instructions = json.loads(file)[0m
[30;1m89 | [0m[35m            instructions = instructions.get(self.service_name, {})[0m
[30;1m90 | [0m[35m            self.log.info(f"{self.service_name} following instruction: {instructions}")[0m
[30;1m91 | [0m[35m            hits = self.hits[task.fileinfo.sha256] = self.hits.get(task.fileinfo.sha256, 0) + 1[0m
[30;1m92 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m721[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m83 | [0m[35m                continue[0m
[30;1m84 | [0m[35m            self.log.info(f"{self.service_name} has received a job {task.sid}")[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m            file = self.filestore.get(task.fileinfo.sha256)[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m            instructions = json.loads(file)[0m
[30;1m89 | [0m[35m            instructions = instructions.get(self.service_name, {})[0m

[31m--[ [0m[34mMatch #[0m[33m722[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1292 | [0m[35m[0m
[30;1m1293 | [0m[35m    # Both services run at the same time, but one requires info from the other.[0m
[30;1m1294 | [0m[35m    # We lock down the timing of the service completion so that:[0m
[30;1m1295 | [0m[35m    # a) both run at the same time so that in its first run core-b does not have the[0m
[30;1m1296 | [0m[35m    #    temp data it wants and produces a partial result.[0m
[30;1m1297 | [0m[35m    # b) core-a finishes before core-b adding the temporary data to the dispatcher[0m
[30;1m1298 | [0m[35m    # c) core-b finishes and should trigger a rerun with the data to produce a full result[0m

[31m--[ [0m[34mMatch #[0m[33m723[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1290 | [0m[35m    # result of a submission would not trigger dispatching when it should due to data[0m
[30;1m1291 | [0m[35m    # that was produced while it was running.[0m
[30;1m1292 | [0m[35m[0m
[30;1m1293 | [0m[35m    # Both services run at the same time, but one requires info from the other.[0m
[30;1m1294 | [0m[35m    # We lock down the timing of the service completion so that:[0m
[30;1m1295 | [0m[35m    # a) both run at the same time so that in its first run core-b does not have the[0m
[30;1m1296 | [0m[35m    #    temp data it wants and produces a partial result.[0m

[31m--[ [0m[34mMatch #[0m[33m724[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1234 | [0m[35m[0m
[30;1m1235 | [0m[35m[0m
[30;1m1236 | [0m[35mdef test_temp_data_monitoring(core: CoreSession, metrics):[0m
[30;1m1237 | [0m[35m    # Have pre produce a partial result, then have core-a update a monitored key[0m
[30;1m1238 | [0m[35m    sha, size = ready_body(core, {[0m
[30;1m1239 | [0m[35m        'pre': {'partial': {'passwords': 'test_temp_data_monitoring'}},[0m
[30;1m1240 | [0m[35m        'core-a': {'temporary_data': {'passwords': ['test_temp_data_monitoring']}},[0m

[31m--[ [0m[34mMatch #[0m[33m725[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1184 | [0m[35m[0m
[30;1m1185 | [0m[35m[0m
[30;1m1186 | [0m[35mdef test_partial(core: CoreSession, metrics):[0m
[30;1m1187 | [0m[35m    # Have pre produce a partial result, then have core-a update a monitored key[0m
[30;1m1188 | [0m[35m    sha, size = ready_body(core, {[0m
[30;1m1189 | [0m[35m        'pre': {'partial': {'passwords': 'test_temp_data_monitoring'}},[0m
[30;1m1190 | [0m[35m    })[0m

[31m--[ [0m[34mMatch #[0m[33m726[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1357 | [0m[35m    assert len(sub.errors) == 0[0m
[30;1m1358 | [0m[35m    assert len(sub.results) == 2, sub.results[0m
[30;1m1359 | [0m[35m[0m
[30;1m1360 | [0m[35m    # b service should have run twice to produce the results[0m
[30;1m1361 | [0m[35m    assert core_b.hits[sha] >= 2, f'core_b.hits {core_b.hits[sha]}'[0m
[30;1m1362 | [0m[35m[0m
[30;1m1363 | [0m[35m    # Wait until we get feedback from the metrics channel[0m

[31m--[ [0m[34mMatch #[0m[33m727[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1335 | [0m[35m        time.sleep(0.01)[0m
[30;1m1336 | [0m[35m[0m
[30;1m1337 | [0m[35m    # Release a[0m
[30;1m1338 | [0m[35m    for service in core_a:[0m
[30;1m1339 | [0m[35m        service.local_lock.set()[0m
[30;1m1340 | [0m[35m[0m
[30;1m1341 | [0m[35m    # Let a finish so that the temporary data is added in the dispatcher[0m

[31m--[ [0m[34mMatch #[0m[33m728[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1327 | [0m[35m        )][0m
[30;1m1328 | [0m[35m    )).as_primitives())[0m
[30;1m1329 | [0m[35m [0m
[30;1m1330 | [0m[35m    # Wait until both of the services have started (so service b doesn't get the temp data a produce[0m
[30;1m1331 | [0m[35m    start = time.time()[0m
[30;1m1332 | [0m[35m    while sum(s.hits.get(sha, 0) for s in core.services) != 2:[0m
[30;1m1333 | [0m[35m        if time.time() - start > RESPONSE_TIMEOUT:[0m

[31m--[ [0m[34mMatch #[0m[33m729[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1304 | [0m[35m    core_a = [s for s in core.services if s.service_name == 'core-a'][0m
[30;1m1305 | [0m[35m    core_b = [s for s in core.services if s.service_name == 'core-b'][0][0m
[30;1m1306 | [0m[35m[0m
[30;1m1307 | [0m[35m    for service in core_a + [core_b]:[0m
[30;1m1308 | [0m[35m        service.local_lock.clear()[0m
[30;1m1309 | [0m[35m[0m
[30;1m1310 | [0m[35m    core.ingest_queue.push(SubmissionInput(dict([0m

[31m--[ [0m[34mMatch #[0m[33m730[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1292 | [0m[35m[0m
[30;1m1293 | [0m[35m    # Both services run at the same time, but one requires info from the other.[0m
[30;1m1294 | [0m[35m    # We lock down the timing of the service completion so that:[0m
[30;1m1295 | [0m[35m    # a) both run at the same time so that in its first run core-b does not have the[0m
[30;1m1296 | [0m[35m    #    temp data it wants and produces a partial result.[0m
[30;1m1297 | [0m[35m    # b) core-a finishes before core-b adding the temporary data to the dispatcher[0m
[30;1m1298 | [0m[35m    # c) core-b finishes and should trigger a rerun with the data to produce a full result[0m

[31m--[ [0m[34mMatch #[0m[33m731[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1291 | [0m[35m    # that was produced while it was running.[0m
[30;1m1292 | [0m[35m[0m
[30;1m1293 | [0m[35m    # Both services run at the same time, but one requires info from the other.[0m
[30;1m1294 | [0m[35m    # We lock down the timing of the service completion so that:[0m
[30;1m1295 | [0m[35m    # a) both run at the same time so that in its first run core-b does not have the[0m
[30;1m1296 | [0m[35m    #    temp data it wants and produces a partial result.[0m
[30;1m1297 | [0m[35m    # b) core-a finishes before core-b adding the temporary data to the dispatcher[0m

[31m--[ [0m[34mMatch #[0m[33m732[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m880 | [0m[35m    notification_queue = NamedQueue('nq-test-extracted-in-one', core.redis)[0m
[30;1m881 | [0m[35m    start = time.time()[0m
[30;1m882 | [0m[35m    task = notification_queue.pop(timeout=RESPONSE_TIMEOUT)[0m
[30;1m883 | [0m[35m    print("notification time waited", time.time() - start)[0m
[30;1m884 | [0m[35m    assert task is not None[0m
[30;1m885 | [0m[35m    task = IngestTask(task)[0m
[30;1m886 | [0m[35m    sub: Submission = core.ds.submission.get(task.submission.sid)[0m

[31m--[ [0m[34mMatch #[0m[33m733[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m836 | [0m[35m    notification_queue = NamedQueue('nq-test-depth-limit', core.redis)[0m
[30;1m837 | [0m[35m    start = time.time()[0m
[30;1m838 | [0m[35m    task = notification_queue.pop(timeout=RESPONSE_TIMEOUT)[0m
[30;1m839 | [0m[35m    print("notification time waited", time.time() - start)[0m
[30;1m840 | [0m[35m    assert task is not None[0m
[30;1m841 | [0m[35m    task = IngestTask(task)[0m
[30;1m842 | [0m[35m    sub: Submission = core.ds.submission.get(task.submission.sid)[0m

[31m--[ [0m[34mMatch #[0m[33m734[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m716 | [0m[35m    # -------------------------------------------------------------------------------[0m
[30;1m717 | [0m[35m    # Have a service produce an error[0m
[30;1m718 | [0m[35m    # -------------------------------------------------------------------------------[0m
[30;1m719 | [0m[35m    # This time have a file get marked for dropping by a service[0m
[30;1m720 | [0m[35m    sha, size = ready_body(core, {[0m
[30;1m721 | [0m[35m        'core-a': {[0m
[30;1m722 | [0m[35m            'error': {[0m
[30;1m723 | [0m[35m                'archive_ts': None,[0m

[31m--[ [0m[34mMatch #[0m[33m735[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m716 | [0m[35m    # -------------------------------------------------------------------------------[0m
[30;1m717 | [0m[35m    # Have a service produce an error[0m
[30;1m718 | [0m[35m    # -------------------------------------------------------------------------------[0m
[30;1m719 | [0m[35m    # This time have a file get marked for dropping by a service[0m
[30;1m720 | [0m[35m    sha, size = ready_body(core, {[0m
[30;1m721 | [0m[35m        'core-a': {[0m
[30;1m722 | [0m[35m            'error': {[0m

[31m--[ [0m[34mMatch #[0m[33m736[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m714 | [0m[35m[0m
[30;1m715 | [0m[35mdef test_service_error(core, metrics):[0m
[30;1m716 | [0m[35m    # -------------------------------------------------------------------------------[0m
[30;1m717 | [0m[35m    # Have a service produce an error[0m
[30;1m718 | [0m[35m    # -------------------------------------------------------------------------------[0m
[30;1m719 | [0m[35m    # This time have a file get marked for dropping by a service[0m
[30;1m720 | [0m[35m    sha, size = ready_body(core, {[0m

[31m--[ [0m[34mMatch #[0m[33m737[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m674 | [0m[35m[0m
[30;1m675 | [0m[35mdef test_dropping_early(core, metrics):[0m
[30;1m676 | [0m[35m    # -------------------------------------------------------------------------------[0m
[30;1m677 | [0m[35m    # This time have a file get marked for dropping by a service[0m
[30;1m678 | [0m[35m    sha, size = ready_body(core, {[0m
[30;1m679 | [0m[35m        'pre': {'result': {'drop_file': True}}[0m
[30;1m680 | [0m[35m    })[0m
[30;1m681 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m738[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m674 | [0m[35m[0m
[30;1m675 | [0m[35mdef test_dropping_early(core, metrics):[0m
[30;1m676 | [0m[35m    # -------------------------------------------------------------------------------[0m
[30;1m677 | [0m[35m    # This time have a file get marked for dropping by a service[0m
[30;1m678 | [0m[35m    sha, size = ready_body(core, {[0m
[30;1m679 | [0m[35m        'pre': {'result': {'drop_file': True}}[0m
[30;1m680 | [0m[35m    })[0m

[31m--[ [0m[34mMatch #[0m[33m739[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m627 | [0m[35m[0m
[30;1m628 | [0m[35m[0m
[30;1m629 | [0m[35mdef test_service_retry_limit(core, metrics):[0m
[30;1m630 | [0m[35m    # This time have the service 'crash'[0m
[30;1m631 | [0m[35m    sha, size = ready_body(core, {[0m
[30;1m632 | [0m[35m        'pre': {'drop': 3}[0m
[30;1m633 | [0m[35m    })[0m

[31m--[ [0m[34mMatch #[0m[33m740[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m627 | [0m[35m[0m
[30;1m628 | [0m[35m[0m
[30;1m629 | [0m[35mdef test_service_retry_limit(core, metrics):[0m
[30;1m630 | [0m[35m    # This time have the service 'crash'[0m
[30;1m631 | [0m[35m    sha, size = ready_body(core, {[0m
[30;1m632 | [0m[35m        'pre': {'drop': 3}[0m
[30;1m633 | [0m[35m    })[0m

[31m--[ [0m[34mMatch #[0m[33m741[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m612 | [0m[35m    assert dropped_task[0m
[30;1m613 | [0m[35m    dropped_task = IngestTask(dropped_task)[0m
[30;1m614 | [0m[35m    sub = core.ds.submission.get(dropped_task.submission.sid)[0m
[30;1m615 | [0m[35m    assert len(sub.errors) == 0  # No error raised if the service succeeds on retry[0m
[30;1m616 | [0m[35m    assert len(sub.results) == 4[0m
[30;1m617 | [0m[35m    assert core.pre_service.drops[sha] == 1[0m
[30;1m618 | [0m[35m    assert core.pre_service.hits[sha] == 2[0m

[31m--[ [0m[34mMatch #[0m[33m742[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m582 | [0m[35m[0m
[30;1m583 | [0m[35m[0m
[30;1m584 | [0m[35mdef test_service_crash_recovery(core, metrics):[0m
[30;1m585 | [0m[35m    # This time have the service 'crash'[0m
[30;1m586 | [0m[35m    sha, size = ready_body(core, {[0m
[30;1m587 | [0m[35m        'pre': {'drop': 1}[0m
[30;1m588 | [0m[35m    })[0m

[31m--[ [0m[34mMatch #[0m[33m743[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m582 | [0m[35m[0m
[30;1m583 | [0m[35m[0m
[30;1m584 | [0m[35mdef test_service_crash_recovery(core, metrics):[0m
[30;1m585 | [0m[35m    # This time have the service 'crash'[0m
[30;1m586 | [0m[35m    sha, size = ready_body(core, {[0m
[30;1m587 | [0m[35m        'pre': {'drop': 1}[0m
[30;1m588 | [0m[35m    })[0m

[31m--[ [0m[34mMatch #[0m[33m744[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m60 | [0m[35mclass MockService(ServerBase):[0m
[30;1m61 | [0m[35m    """Replaces everything past the dispatcher.[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m    Including service API, in the future probably include that in this test.[0m
[30;1m64 | [0m[35m    """[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m    def __init__(self, name, datastore, redis, filestore):[0m

[31m--[ [0m[34mMatch #[0m[33m745[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_simulation.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m7 | [0m[35mimport hashlib[0m
[30;1m8 | [0m[35mimport json[0m
[30;1m9 | [0m[35mimport typing[0m
[30;1m10 | [0m[35mimport time[0m
[30;1m11 | [0m[35mimport threading[0m
[30;1m12 | [0m[35mimport logging[0m
[30;1m13 | [0m[35mfrom tempfile import NamedTemporaryFile[0m
[30;1m14 | [0m[35mfrom typing import TYPE_CHECKING, Any[0m

[31m--[ [0m[34mMatch #[0m[33m746[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m### Updater[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35mMake sure the different services get their latest update files.[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m```bash[0m
[30;1m137 | [0m[35mdocker run --name updater cccs/assemblyline-core python -m assemblyline_core.updater.run_updater[0m

[31m--[ [0m[34mMatch #[0m[33m747[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35mExécute les différents flux de travail dans le système et appliquer leurs étiquettes, leur priorité [0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m```bash[0m
[30;1m251 | [0m[35mdocker run --name workflow cccs/assemblyline-core python -m assemblyline_core.workflow.run_workflow[0m
[30;1m252 | [0m[35m```[0m
[30;1m253 | [0m[35m[0m
[30;1m254 | [0m[35m## Documentation[0m

[31m--[ [0m[34mMatch #[0m[33m748[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m239 | [0m[35m[0m
[30;1m240 | [0m[35mAssure que les différents services reçoivent leurs derniers fichiers de mise à jour.[0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35m```bash[0m
[30;1m243 | [0m[35mdocker run --name updater cccs/assemblyline-core python -m assemblyline_core.updater.run_updater[0m
[30;1m244 | [0m[35m```[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m### Workflow[0m

[31m--[ [0m[34mMatch #[0m[33m749[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m231 | [0m[35m[0m
[30;1m232 | [0m[35mAugmente et diminue les services dans le système en fonction de la charge.[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m```bash[0m
[30;1m235 | [0m[35mdocker run --name scaler cccs/assemblyline-core python -m assemblyline_core.scaler.run_scaler[0m
[30;1m236 | [0m[35m```[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m### Mise à jour[0m

[31m--[ [0m[34mMatch #[0m[33m750[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m##### Agrégateur de statistiques[0m
[30;1m225 | [0m[35m[0m
[30;1m226 | [0m[35m```bash[0m
[30;1m227 | [0m[35mdocker run --name statistics cccs/assemblyline-core python -m assemblyline_core.metrics.run_statisti[0m
[30;1m228 | [0m[35m```[0m
[30;1m229 | [0m[35m[0m
[30;1m230 | [0m[35m### Scaler[0m

[31m--[ [0m[34mMatch #[0m[33m751[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m#### Agrégateur de métriques[0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35m```bash[0m
[30;1m221 | [0m[35mdocker run --name metrics cccs/assemblyline-core python -m assemblyline_core.metrics.run_metrics_agg[0m
[30;1m222 | [0m[35m```[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m##### Agrégateur de statistiques[0m

[31m--[ [0m[34mMatch #[0m[33m752[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m#### Heartbeat Manager[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m```bash[0m
[30;1m215 | [0m[35mdocker run --name heartbeat cccs/assemblyline-core python -m assemblyline_core.metrics.run_heartbeat[0m
[30;1m216 | [0m[35m```[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m#### Agrégateur de métriques[0m

[31m--[ [0m[34mMatch #[0m[33m753[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35mDéplace les fichiers ingérés des files d'attente prioritaires vers les files d'attente de traitement[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m```bash[0m
[30;1m205 | [0m[35mdocker run --name ingester cccs/assemblyline-core python -m assemblyline_core.ingester[0m
[30;1m206 | [0m[35m```[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m### Métriques[0m

[31m--[ [0m[34mMatch #[0m[33m754[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35mSupprimer les soumissions et leurs résultats à l'expiration de leur durée de vie.[0m
[30;1m195 | [0m[35m[0m
[30;1m196 | [0m[35m```bash[0m
[30;1m197 | [0m[35mdocker run --name expiry cccs/assemblyline-core python -m assemblyline_core.expiry.run_expiry[0m
[30;1m198 | [0m[35m```[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35m### Ingester[0m

[31m--[ [0m[34mMatch #[0m[33m755[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35mAchemine les fichiers dans le système durant une soumission. S'assure que tous les fichiers de la so[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m```bash[0m
[30;1m189 | [0m[35mdocker run --name dispatcher cccs/assemblyline-core python -m assemblyline_core.dispatching[0m
[30;1m190 | [0m[35m```[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m### Expiration[0m

[31m--[ [0m[34mMatch #[0m[33m756[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35mArchivage des soumissions, de leurs résultats et des fichiers dans l'archive.[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m```bash[0m
[30;1m181 | [0m[35mdocker run --name archiver cccs/assemblyline-core python -m assemblyline_core.archiver.run_archiver[0m
[30;1m182 | [0m[35m```[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m### Dispatcher[0m

[31m--[ [0m[34mMatch #[0m[33m757[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35mCrée des alertes pour les différentes soumissions dans le système.[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m```bash[0m
[30;1m173 | [0m[35mdocker run --name alerter cccs/assemblyline-core python -m assemblyline_core.alerter.run_alerter[0m
[30;1m174 | [0m[35m```[0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m### Archiver[0m

[31m--[ [0m[34mMatch #[0m[33m758[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35mRun the different workflows in the system and apply their labels, priority and status.[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m```bash[0m
[30;1m145 | [0m[35mdocker run --name workflow cccs/assemblyline-core python -m assemblyline_core.workflow.run_workflow[0m
[30;1m146 | [0m[35m```[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m## Documentation[0m

[31m--[ [0m[34mMatch #[0m[33m759[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35mMake sure the different services get their latest update files.[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m```bash[0m
[30;1m137 | [0m[35mdocker run --name updater cccs/assemblyline-core python -m assemblyline_core.updater.run_updater[0m
[30;1m138 | [0m[35m```[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m### Workflow[0m

[31m--[ [0m[34mMatch #[0m[33m760[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35mSpin up and down services in the system depending on the load.[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m```bash[0m
[30;1m129 | [0m[35mdocker run --name scaler cccs/assemblyline-core python -m assemblyline_core.scaler.run_scaler[0m
[30;1m130 | [0m[35m```[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m### Updater[0m

[31m--[ [0m[34mMatch #[0m[33m761[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m#### Statistics Aggregator[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35m```bash[0m
[30;1m121 | [0m[35mdocker run --name statistics cccs/assemblyline-core python -m assemblyline_core.metrics.run_statisti[0m
[30;1m122 | [0m[35m```[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m### Scaler[0m

[31m--[ [0m[34mMatch #[0m[33m762[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m#### Metrics Aggregator[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m```bash[0m
[30;1m115 | [0m[35mdocker run --name metrics cccs/assemblyline-core python -m assemblyline_core.metrics.run_metrics_agg[0m
[30;1m116 | [0m[35m```[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m#### Statistics Aggregator[0m

[31m--[ [0m[34mMatch #[0m[33m763[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m105 | [0m[35m[0m
[30;1m106 | [0m[35m#### Heartbeat Manager[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m```bash[0m
[30;1m109 | [0m[35mdocker run --name heartbeat cccs/assemblyline-core python -m assemblyline_core.metrics.run_heartbeat[0m
[30;1m110 | [0m[35m```[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35m#### Metrics Aggregator[0m

[31m--[ [0m[34mMatch #[0m[33m764[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35mMove ingested files from the priority queues to the processing queues.[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m```bash[0m
[30;1m99 | [0m[35mdocker run --name ingester cccs/assemblyline-core python -m assemblyline_core.ingester[0m
[30;1m100 | [0m[35m```[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m### Metrics[0m

[31m--[ [0m[34mMatch #[0m[33m765[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35mDelete submissions and their results when their time-to-live expires.[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m```bash[0m
[30;1m91 | [0m[35mdocker run --name expiry cccs/assemblyline-core python -m assemblyline_core.expiry.run_expiry[0m
[30;1m92 | [0m[35m```[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m### Ingester[0m

[31m--[ [0m[34mMatch #[0m[33m766[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35mRoute the files in the system while a submission is tacking place. Make sure all files during a subm[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m```bash[0m
[30;1m83 | [0m[35mdocker run --name dispatcher cccs/assemblyline-core python -m assemblyline_core.dispatching[0m
[30;1m84 | [0m[35m```[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m### Expiry[0m

[31m--[ [0m[34mMatch #[0m[33m767[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35mArchives submissions and their results & files into the archive.[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m```bash[0m
[30;1m75 | [0m[35mdocker run --name archiver cccs/assemblyline-core python -m assemblyline_core.archiver.run_archiver[0m
[30;1m76 | [0m[35m```[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m### Dispatcher[0m

[31m--[ [0m[34mMatch #[0m[33m768[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35mCreate alerts for the different submissions in the system.[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m```bash[0m
[30;1m67 | [0m[35mdocker run --name alerter cccs/assemblyline-core python -m assemblyline_core.alerter.run_alerter[0m
[30;1m68 | [0m[35m```[0m
[30;1m69 | [0m[35m[0m
[30;1m70 | [0m[35m### Archiver[0m

[31m--[ [0m[34mMatch #[0m[33m769[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/PKG-INFO[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m20 | [0m[35mDescription-Content-Type: text/markdown[0m
[30;1m21 | [0m[35mLicense-File: LICENCE.md[0m
[30;1m22 | [0m[35mRequires-Dist: assemblyline[0m
[30;1m23 | [0m[35mRequires-Dist: docker[0m
[30;1m24 | [0m[35mRequires-Dist: kubernetes[0m
[30;1m25 | [0m[35mProvides-Extra: test[0m
[30;1m26 | [0m[35mRequires-Dist: pytest; extra == "test"[0m
[30;1m27 | [0m[35mRequires-Dist: assemblyline_client; extra == "test"[0m

[31m--[ [0m[34mMatch #[0m[33m770[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/__init__.py[0m
   Pattern: [32m.hostname[0m
[30;1m6 | [0m[35m        tag_value = tag_value.lower()[0m
[30;1m7 | [0m[35m    elif tag_type.endswith('.uri'):[0m
[30;1m8 | [0m[35m        hostname = tag_value.split('//', 1)[1].split('/', 1)[0][0m
[30;1m9 | [0m[35m        tag_value = tag_value.replace(hostname, hostname.lower(), 1)[0m
[30;1m10 | [0m[35m    return tag_value[0m

[31m--[ [0m[34mMatch #[0m[33m771[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/__init__.py[0m
   Pattern: [32m.hostname[0m
[30;1m6 | [0m[35m        tag_value = tag_value.lower()[0m
[30;1m7 | [0m[35m    elif tag_type.endswith('.uri'):[0m
[30;1m8 | [0m[35m        hostname = tag_value.split('//', 1)[1].split('/', 1)[0][0m
[30;1m9 | [0m[35m        tag_value = tag_value.replace(hostname, hostname.lower(), 1)[0m
[30;1m10 | [0m[35m    return tag_value[0m

[31m--[ [0m[34mMatch #[0m[33m772[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/__init__.py[0m
   Pattern: [32m.hostname[0m
[30;1m5 | [0m[35m    if tag_type.endswith('.domain'):[0m
[30;1m6 | [0m[35m        tag_value = tag_value.lower()[0m
[30;1m7 | [0m[35m    elif tag_type.endswith('.uri'):[0m
[30;1m8 | [0m[35m        hostname = tag_value.split('//', 1)[1].split('/', 1)[0][0m
[30;1m9 | [0m[35m        tag_value = tag_value.replace(hostname, hostname.lower(), 1)[0m
[30;1m10 | [0m[35m    return tag_value[0m

[31m--[ [0m[34mMatch #[0m[33m773[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_alerter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m    datastore.alert.commit()[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35m    updated_alert = datastore.alert.get(datastore.alert.search(f"sid:{child_submission.sid}",[0m
[30;1m155 | [0m[35m                                                               fl="id", as_obj=False)['items'][0]['i[0m
[30;1m156 | [0m[35m    assert updated_alert is not None[0m
[30;1m157 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m774[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_alerter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m119 | [0m[35m    # Alter the result of one of the services[0m
[30;1m120 | [0m[35m    r = None[0m
[30;1m121 | [0m[35m    while r is None:[0m
[30;1m122 | [0m[35m        r = datastore.result.get(random.choice(child_submission.results))[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    for s in r.result.sections:[0m
[30;1m125 | [0m[35m        old_tags = s.tags.as_primitives(strip_null=True)[0m

[31m--[ [0m[34mMatch #[0m[33m775[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_alerter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m107 | [0m[35m    assert alert_type == 'create'[0m
[30;1m108 | [0m[35m    datastore.alert.commit()[0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    original_alert = datastore.alert.get(datastore.alert.search(f"sid:{submission.sid}", fl="id",[0m
[30;1m111 | [0m[35m                                                                as_obj=False)['items'][0]['id'])[0m
[30;1m112 | [0m[35m    assert original_alert is not None[0m
[30;1m113 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m776[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_alerter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m    res = datastore.alert.search("id:*", as_obj=False)[0m
[30;1m78 | [0m[35m    assert res['total'] == 1[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    alert = datastore.alert.get(res['items'][0]['alert_id'])[0m
[30;1m81 | [0m[35m    assert alert.sid == submission.sid[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m777[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_alerter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35mdef recursive_extend(d, u):[0m
[30;1m28 | [0m[35m    for k, v in u.items():[0m
[30;1m29 | [0m[35m        if isinstance(v, collections.abc.Mapping):[0m
[30;1m30 | [0m[35m            d[k] = recursive_extend(d.get(k, {}), v)[0m
[30;1m31 | [0m[35m        else:[0m
[30;1m32 | [0m[35m            if k not in d:[0m
[30;1m33 | [0m[35m                d[k] = [][0m

[31m--[ [0m[34mMatch #[0m[33m778[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_alerter.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35m[0m
[30;1m161 | [0m[35mdef test_update_expired_alert(config, datastore):[0m
[30;1m162 | [0m[35m    # If we're attempting to update an alert that has either expired or was removed from the 'alert'[0m
[30;1m163 | [0m[35m    # Alert should be created in it's stead[0m
[30;1m164 | [0m[35m    test_update_single_alert(config, datastore, delete_original=True)[0m

[31m--[ [0m[34mMatch #[0m[33m779[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_scaler.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m36 | [0m[35m    assert collection.read('service-b')['instances'] == 1[0m
[30;1m37 | [0m[35m    assert collection.read('service-b')['duty_cycle'] == approx(0.5)[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    # Move forward that the last of the original group of messages expire, but the update for the se[0m
[30;1m40 | [0m[35m    # service is still in effect[0m
[30;1m41 | [0m[35m    mock_time.return_value = 100[0m
[30;1m42 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m780[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_scaler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m46 | [0m[35m[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35mdef test_default_bucket_rates():[0m
[30;1m49 | [0m[35m    service = ServiceProfile('service', DockerConfig(dict(image='redis')))[0m
[30;1m50 | [0m[35m    before = service.pressure[0m
[30;1m51 | [0m[35m    service.update(5, 1, 1, 1)[0m
[30;1m52 | [0m[35m    print(service.pressure, before)[0m

[31m--[ [0m[34mMatch #[0m[33m781[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_scaler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m    assert collection.read('service-b')['duty_cycle'] == approx(0.5)[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35m    # Move forward that the last of the original group of messages expire, but the update for the se[0m
[30;1m40 | [0m[35m    # service is still in effect[0m
[30;1m41 | [0m[35m    mock_time.return_value = 100[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m    assert collection.read('service-a') is None[0m

[31m--[ [0m[34mMatch #[0m[33m782[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m375 | [0m[35m    disp.service_worker(disp.process_queue_index(sid))[0m
[30;1m376 | [0m[35m[0m
[30;1m377 | [0m[35m    # 'sandbox' should have a task for the extracted file[0m
[30;1m378 | [0m[35m    # disp.dispatch_file(disp.tasks.get(sid), second_file_hash)[0m
[30;1m379 | [0m[35m    job = client.request_work('0', 'sandbox', '0')[0m
[30;1m380 | [0m[35m    assert job.fileinfo.sha256 == second_file_hash[0m
[30;1m381 | [0m[35m    assert job.filename == 'second-*'[0m

[31m--[ [0m[34mMatch #[0m[33m783[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m219 | [0m[35m    disp.save_submission()[0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m    assert wait_result(task, file_hash, 'xerox')[0m
[30;1m222 | [0m[35m    assert disp.tasks.get(sid) is None[0m
[30;1m223 | [0m[35m[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m@mock.patch('assemblyline_core.dispatching.dispatcher.MetricsFactory', mock.MagicMock())[0m

[31m--[ [0m[34mMatch #[0m[33m784[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_dispatcher.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m146 | [0m[35m    client.dispatch_submission(sub)[0m
[30;1m147 | [0m[35m    disp.pull_submissions()[0m
[30;1m148 | [0m[35m    disp.service_worker(disp.process_queue_index(sid))[0m
[30;1m149 | [0m[35m    task = disp.tasks.get(sid)[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35m    assert task.queue_keys[(file_hash, 'extract')] is not None[0m
[30;1m152 | [0m[35m    assert task.queue_keys[(file_hash, 'wrench')] is not None[0m

[31m--[ [0m[34mMatch #[0m[33m785[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_dispatcher.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m400 | [0m[35m    assert items['first'] == 1[0m
[30;1m401 | [0m[35m[0m
[30;1m402 | [0m[35m    # Replace the data and expiry[0m
[30;1m403 | [0m[35m    table.set('second', 20, 5)  # second now expires at 26[0m
[30;1m404 | [0m[35m[0m
[30;1m405 | [0m[35m    # Expire two things[0m
[30;1m406 | [0m[35m    mock_time.return_value = 21[0m

[31m--[ [0m[34mMatch #[0m[33m786[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m447 | [0m[35m    msg_result_key = message['result_summary']['key'][0m
[30;1m448 | [0m[35m    assert msg_result_key == result_key[0m
[30;1m449 | [0m[35m[0m
[30;1m450 | [0m[35m    # Save the same result again but we expect to be saved under another key[0m
[30;1m451 | [0m[35m    client.running_tasks.add(task.key(), task.as_primitives())[0m
[30;1m452 | [0m[35m    client.service_finished(task.sid, result_key, result)[0m
[30;1m453 | [0m[35m    message = result_queue.pop(blocking=False)[0m

[31m--[ [0m[34mMatch #[0m[33m787[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m442 | [0m[35m    client.running_tasks.add(task.key(), task.as_primitives())[0m
[30;1m443 | [0m[35m    client.service_finished(task.sid, result_key, result)[0m
[30;1m444 | [0m[35m[0m
[30;1m445 | [0m[35m    # Pop result from queue, we expect to get the same result key as earlier[0m
[30;1m446 | [0m[35m    message = result_queue.pop(blocking=False)[0m
[30;1m447 | [0m[35m    msg_result_key = message['result_summary']['key'][0m
[30;1m448 | [0m[35m    assert msg_result_key == result_key[0m

[31m--[ [0m[34mMatch #[0m[33m788[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m360 | [0m[35m    disp.service_worker(disp.process_queue_index(sid))[0m
[30;1m361 | [0m[35m    disp.service_worker(disp.process_queue_index(sid))[0m
[30;1m362 | [0m[35m[0m
[30;1m363 | [0m[35m    # 'extract' service should have a task for the extracted file, give results to move onto next st[0m
[30;1m364 | [0m[35m    job = client.request_work('0', 'extract', '0')[0m
[30;1m365 | [0m[35m    assert job.fileinfo.sha256 == second_file_hash[0m
[30;1m366 | [0m[35m    assert job.filename == 'second-*'[0m

[31m--[ [0m[34mMatch #[0m[33m789[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m346 | [0m[35m    disp.service_worker(disp.process_queue_index(sid))[0m
[30;1m347 | [0m[35m    disp.service_worker(disp.process_queue_index(sid))[0m
[30;1m348 | [0m[35m[0m
[30;1m349 | [0m[35m    # Then 'sandbox' service will analyze the same file, give result[0m
[30;1m350 | [0m[35m    job = client.request_work('0', 'sandbox', '0')[0m
[30;1m351 | [0m[35m    assert job.fileinfo.sha256 == file_hash[0m
[30;1m352 | [0m[35m    assert job.filename == './file'[0m

[31m--[ [0m[34mMatch #[0m[33m790[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m329 | [0m[35m    disp.pull_submissions()[0m
[30;1m330 | [0m[35m    disp.service_worker(disp.process_queue_index(sid))[0m
[30;1m331 | [0m[35m[0m
[30;1m332 | [0m[35m    # 'extract' service extracts a file and yields a result[0m
[30;1m333 | [0m[35m    job = client.request_work('0', 'extract', '0')[0m
[30;1m334 | [0m[35m    assert job.fileinfo.sha256 == file_hash[0m
[30;1m335 | [0m[35m    assert job.filename == './file'[0m

[31m--[ [0m[34mMatch #[0m[33m791[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m259 | [0m[35m    disp.pull_submissions()[0m
[30;1m260 | [0m[35m    disp.service_worker(disp.process_queue_index(sid))[0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35m    # Finish one service extracting a file[0m
[30;1m263 | [0m[35m    job = client.request_work('0', 'extract', '0')[0m
[30;1m264 | [0m[35m    assert job.fileinfo.sha256 == file_hash[0m
[30;1m265 | [0m[35m    assert job.filename == './file'[0m

[31m--[ [0m[34mMatch #[0m[33m792[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m210 | [0m[35m    assert wait_error(task, file_hash, 'av-b')[0m
[30;1m211 | [0m[35m    assert service_queue('xerox').length() == 1[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m    # Finish the xerox service and check if the submission completion got checked[0m
[30;1m214 | [0m[35m    logger.info('==== sixth dispatch')[0m
[30;1m215 | [0m[35m    client.request_work('0', 'xerox', '0')[0m
[30;1m216 | [0m[35m    client.service_finished(sid, 'xerox-result-key', make_result(file_hash, 'xerox'))[0m

[31m--[ [0m[34mMatch #[0m[33m793[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m140 | [0m[35m    client.dispatcher_data.append(disp.instance_id)[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    # Submit a problem, and check that it gets added to the dispatch hash[0m
[30;1m143 | [0m[35m    # and the right service queues[0m
[30;1m144 | [0m[35m    logger.info('==== first dispatch')[0m
[30;1m145 | [0m[35m    # task = SubmissionTask(sub.as_primitives(), 'some-completion-queue')[0m
[30;1m146 | [0m[35m    client.dispatch_submission(sub)[0m

[31m--[ [0m[34mMatch #[0m[33m794[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35mdef make_error(file_hash, service, recoverable=True):[0m
[30;1m79 | [0m[35m    new_error: Error = random_model_obj(Error)[0m
[30;1m80 | [0m[35m    new_error.response.service_name = service[0m
[30;1m81 | [0m[35m    new_error.sha256 = file_hash[0m
[30;1m82 | [0m[35m    if recoverable:[0m
[30;1m83 | [0m[35m        new_error.response.status = 'FAIL_RECOVERABLE'[0m
[30;1m84 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m795[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35mdef make_result(file_hash, service):[0m
[30;1m72 | [0m[35m    new_result: Result = random_minimal_obj(Result)[0m
[30;1m73 | [0m[35m    new_result.sha256 = file_hash[0m
[30;1m74 | [0m[35m    new_result.response.service_name = service[0m
[30;1m75 | [0m[35m    return new_result[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35mdef make_error(file_hash, service, recoverable=True):[0m

[31m--[ [0m[34mMatch #[0m[33m796[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_dispatcher.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mfrom unittest import mock[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport json[0m
[30;1m6 | [0m[35mimport pytest[0m

[31m--[ [0m[34mMatch #[0m[33m797[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m462 | [0m[35m                        elif key.endswith('.t'):[0m
[30;1m463 | [0m[35m                            name = key.rstrip('.t')[0m
[30;1m464 | [0m[35m                            metrics_data[name] = value / max(counter.get(name + ".c", 1), 1)[0m
[30;1m465 | [0m[35m                            metrics_data[name + "_count"] = counter.get(name + ".c", 0)[0m
[30;1m466 | [0m[35m                        # Plain old metric, no modifications needed[0m
[30;1m467 | [0m[35m                        else:[0m
[30;1m468 | [0m[35m                            metrics_data[key] = value[0m

[31m--[ [0m[34mMatch #[0m[33m798[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m461 | [0m[35m                        # We have an entry that is a timer, should also have a .c count[0m
[30;1m462 | [0m[35m                        elif key.endswith('.t'):[0m
[30;1m463 | [0m[35m                            name = key.rstrip('.t')[0m
[30;1m464 | [0m[35m                            metrics_data[name] = value / max(counter.get(name + ".c", 1), 1)[0m
[30;1m465 | [0m[35m                            metrics_data[name + "_count"] = counter.get(name + ".c", 0)[0m
[30;1m466 | [0m[35m                        # Plain old metric, no modifications needed[0m
[30;1m467 | [0m[35m                        else:[0m

[31m--[ [0m[34mMatch #[0m[33m799[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m            c_time = time.time()[0m
[30;1m398 | [0m[35m            for k in list(self.window_ttl.keys()):[0m
[30;1m399 | [0m[35m                if self.window_ttl.get(k, c_time) < c_time:[0m
[30;1m400 | [0m[35m                    c_name, c_type, c_host = k[0m
[30;1m401 | [0m[35m                    self.log.info(f"Counter {c_name} [{c_type}] for host {c_host} is expired")[0m
[30;1m402 | [0m[35m                    del self.window_ttl[k][0m

[31m--[ [0m[34mMatch #[0m[33m800[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m381 | [0m[35m                'request_time': request_time,[0m
[30;1m382 | [0m[35m                'status': status,[0m
[30;1m383 | [0m[35m            }[0m
[30;1m384 | [0m[35m            instances = len(status.get('storage', {}))[0m
[30;1m385 | [0m[35m[0m
[30;1m386 | [0m[35m            # Export heartbeat[0m
[30;1m387 | [0m[35m            self.hm.send_heartbeat('retrohunt', 'hauntedhouse', metrics, instances)[0m

[31m--[ [0m[34mMatch #[0m[33m801[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m351 | [0m[35m                node = shard['node'][0m
[30;1m352 | [0m[35m                if node:[0m
[30;1m353 | [0m[35m                    sizes.setdefault(index, 0)[0m
[30;1m354 | [0m[35m                    sizes[index] = max(sizes[index], int(shard.get('store') or 0))[0m
[30;1m355 | [0m[35m                    nodes.add(node)[0m
[30;1m356 | [0m[35m                else:[0m
[30;1m357 | [0m[35m                    unassigned += 1[0m

[31m--[ [0m[34mMatch #[0m[33m802[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m222 | [0m[35m                elif key.endswith('.t'):[0m
[30;1m223 | [0m[35m                    name = key.rstrip('.t')[0m
[30;1m224 | [0m[35m                    output_metrics[name] = counts[key] / counts.get(name + ".c", 1)[0m
[30;1m225 | [0m[35m                    output_metrics[name + "_count"] = counts.get(name + ".c", 0)[0m
[30;1m226 | [0m[35m                # Plain old metric, no modifications needed[0m
[30;1m227 | [0m[35m                else:[0m
[30;1m228 | [0m[35m                    output_metrics[key] = value[0m

[31m--[ [0m[34mMatch #[0m[33m803[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m221 | [0m[35m                # We have an entry that is a timer, should also have a .c count[0m
[30;1m222 | [0m[35m                elif key.endswith('.t'):[0m
[30;1m223 | [0m[35m                    name = key.rstrip('.t')[0m
[30;1m224 | [0m[35m                    output_metrics[name] = counts[key] / counts.get(name + ".c", 1)[0m
[30;1m225 | [0m[35m                    output_metrics[name + "_count"] = counts.get(name + ".c", 0)[0m
[30;1m226 | [0m[35m                # Plain old metric, no modifications needed[0m
[30;1m227 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m804[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35mNON_AGGREGATED_COUNTERS = {'dispatcher': {'save_queue', 'error_queue'}}[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mMETRICSTORE_ROOT_CA_PATH = environ.get('METRICSTORE_ROOT_CA_PATH', '/etc/assemblyline/ssl/al_root-ca[0m
[30;1m30 | [0m[35mMETRICSTORE_VERIFY_CERTS = environ.get('METRICSTORE_VERIFY_CERTS', 'true').lower() == "true"[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35mdef cleanup_metrics(input_dict):[0m

[31m--[ [0m[34mMatch #[0m[33m805[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m26 | [0m[35mNON_AGGREGATED = ['scaler', 'scaler_status'][0m
[30;1m27 | [0m[35mNON_AGGREGATED_COUNTERS = {'dispatcher': {'save_queue', 'error_queue'}}[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35mMETRICSTORE_ROOT_CA_PATH = environ.get('METRICSTORE_ROOT_CA_PATH', '/etc/assemblyline/ssl/al_root-ca[0m
[30;1m30 | [0m[35mMETRICSTORE_VERIFY_CERTS = environ.get('METRICSTORE_VERIFY_CERTS', 'true').lower() == "true"[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m806[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m105 | [0m[35m        if self.apm_client:[0m
[30;1m106 | [0m[35m            self.apm_client.begin_transaction('statistics')[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m        # Do signature update[0m
[30;1m109 | [0m[35m        self.signature_lookback = self.datastore.calculate_signature_stats(self.signature_lookback)[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m        # APM Transaction end[0m
[30;1m112 | [0m[35m        if self.apm_client:[0m

[31m--[ [0m[34mMatch #[0m[33m807[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m91 | [0m[35m        if self.apm_client:[0m
[30;1m92 | [0m[35m            self.apm_client.begin_transaction('statistics')[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m        # Do heuristics update[0m
[30;1m95 | [0m[35m        self.datastore.calculate_heuristic_stats()[0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m        # APM Transaction end[0m
[30;1m98 | [0m[35m        if self.apm_client:[0m

[31m--[ [0m[34mMatch #[0m[33m808[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m455 | [0m[35m[0m
[30;1m456 | [0m[35m                    metrics_data = {}[0m
[30;1m457 | [0m[35m                    for key, value in counter.items():[0m
[30;1m458 | [0m[35m                        # Skip counts, they will be paired with a time entry and we only want to cou[0m
[30;1m459 | [0m[35m                        if key.endswith('.c'):[0m
[30;1m460 | [0m[35m                            continue[0m
[30;1m461 | [0m[35m                        # We have an entry that is a timer, should also have a .c count[0m

[31m--[ [0m[34mMatch #[0m[33m809[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m418 | [0m[35m[0m
[30;1m419 | [0m[35m            self.log.info("Compiling service list...")[0m
[30;1m420 | [0m[35m            aggregated_counters = {}[0m
[30;1m421 | [0m[35m            for service in [s['name'] for s in self.datastore.list_all_services(as_obj=False) if s['[0m
[30;1m422 | [0m[35m                data = {[0m
[30;1m423 | [0m[35m                    'cache_hit': 0,[0m
[30;1m424 | [0m[35m                    'cache_miss': 0,[0m

[31m--[ [0m[34mMatch #[0m[33m810[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m416 | [0m[35m                self.rolling_window[w_key] = self.rolling_window[w_key][-self.window_size:][0m
[30;1m417 | [0m[35m                self.window_ttl[w_key] = time.time() + self.ttl[0m
[30;1m418 | [0m[35m[0m
[30;1m419 | [0m[35m            self.log.info("Compiling service list...")[0m
[30;1m420 | [0m[35m            aggregated_counters = {}[0m
[30;1m421 | [0m[35m            for service in [s['name'] for s in self.datastore.list_all_services(as_obj=False) if s['[0m
[30;1m422 | [0m[35m                data = {[0m

[31m--[ [0m[34mMatch #[0m[33m811[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m348 | [0m[35m            response = self.datastore.ds.client.cat.shards(bytes='b', format='json', master_timeout=[0m
[30;1m349 | [0m[35m            for shard in response.body:[0m
[30;1m350 | [0m[35m                index = shard['index'][0m
[30;1m351 | [0m[35m                node = shard['node'][0m
[30;1m352 | [0m[35m                if node:[0m
[30;1m353 | [0m[35m                    sizes.setdefault(index, 0)[0m
[30;1m354 | [0m[35m                    sizes[index] = max(sizes[index], int(shard.get('store') or 0))[0m

[31m--[ [0m[34mMatch #[0m[33m812[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m215 | [0m[35m            output_metrics = {'name': component_name, 'type': component_type}[0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35m            for key, value in counts.items():[0m
[30;1m218 | [0m[35m                # Skip counts, they will be paired with a time entry and we only want to count it on[0m
[30;1m219 | [0m[35m                if key.endswith('.c'):[0m
[30;1m220 | [0m[35m                    continue[0m
[30;1m221 | [0m[35m                # We have an entry that is a timer, should also have a .c count[0m

[31m--[ [0m[34mMatch #[0m[33m813[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m        while self.running:[0m
[30;1m82 | [0m[35m            self._aggregated_statistics()[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m            # Non-block wait for sleep time duration[0m
[30;1m85 | [0m[35m            self.sleep(self.sleep_time)[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m    def _heuristics_stats(self):[0m

[31m--[ [0m[34mMatch #[0m[33m814[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m68 | [0m[35m        self.config = config or forge.get_config()[0m
[30;1m69 | [0m[35m        self.datastore = forge.get_datastore(archive_access=True)[0m
[30;1m70 | [0m[35m        self.sleep_time = 60 * 5  # Default sleep time (5 minutes)[0m
[30;1m71 | [0m[35m        self.signature_lookback = "now-1d"  # Default lookback time for signatures[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m        if self.config.core.metrics.apm_server.server_url is not None:[0m
[30;1m74 | [0m[35m            self.log.info(f"Exporting application metrics to: {self.config.core.metrics.apm_server.s[0m

[31m--[ [0m[34mMatch #[0m[33m815[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m67 | [0m[35m        super().__init__('assemblyline.statistics_aggregator')[0m
[30;1m68 | [0m[35m        self.config = config or forge.get_config()[0m
[30;1m69 | [0m[35m        self.datastore = forge.get_datastore(archive_access=True)[0m
[30;1m70 | [0m[35m        self.sleep_time = 60 * 5  # Default sleep time (5 minutes)[0m
[30;1m71 | [0m[35m        self.signature_lookback = "now-1d"  # Default lookback time for signatures[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m        if self.config.core.metrics.apm_server.server_url is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m816[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/metrics_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport tempfile[0m
[30;1m4 | [0m[35mimport sys[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mimport threading[0m
[30;1m7 | [0m[35mfrom collections import Counter[0m
[30;1m8 | [0m[35mfrom threading import Lock, Thread[0m
[30;1m9 | [0m[35mfrom os import environ, path[0m

[31m--[ [0m[34mMatch #[0m[33m817[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/heartbeat_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m332 | [0m[35m                        'ingested_last_minute': fetcher.get('last_minute_throughput', 0),[0m
[30;1m333 | [0m[35m                        'worker_storage_available': min_storage,[0m
[30;1m334 | [0m[35m                        'total_storage_available': sum_storage,[0m
[30;1m335 | [0m[35m                        'active_searches': status.get('active_searches', 0),[0m
[30;1m336 | [0m[35m                        'last_minute_cpu': last_minute_cpu,[0m
[30;1m337 | [0m[35m                        'total_memory_used': memory,[0m
[30;1m338 | [0m[35m                    }[0m

[31m--[ [0m[34mMatch #[0m[33m818[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/heartbeat_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m329 | [0m[35m                        'instances': instances,[0m
[30;1m330 | [0m[35m                        'request_time': m_data['request_time'],[0m
[30;1m331 | [0m[35m                        'pending_files': fetcher.get('pending_files', 0),[0m
[30;1m332 | [0m[35m                        'ingested_last_minute': fetcher.get('last_minute_throughput', 0),[0m
[30;1m333 | [0m[35m                        'worker_storage_available': min_storage,[0m
[30;1m334 | [0m[35m                        'total_storage_available': sum_storage,[0m
[30;1m335 | [0m[35m                        'active_searches': status.get('active_searches', 0),[0m

[31m--[ [0m[34mMatch #[0m[33m819[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/heartbeat_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m328 | [0m[35m                    "msg": {[0m
[30;1m329 | [0m[35m                        'instances': instances,[0m
[30;1m330 | [0m[35m                        'request_time': m_data['request_time'],[0m
[30;1m331 | [0m[35m                        'pending_files': fetcher.get('pending_files', 0),[0m
[30;1m332 | [0m[35m                        'ingested_last_minute': fetcher.get('last_minute_throughput', 0),[0m
[30;1m333 | [0m[35m                        'worker_storage_available': min_storage,[0m
[30;1m334 | [0m[35m                        'total_storage_available': sum_storage,[0m

[31m--[ [0m[34mMatch #[0m[33m820[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/heartbeat_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m317 | [0m[35m                storage = status.get('storage', {})[0m
[30;1m318 | [0m[35m                last_minute_cpu = sum(report.get('cpu_load_1m', 0) for report in resources.values())[0m
[30;1m319 | [0m[35m                memory = sum(report.get('memory', 0) for report in resources.values())[0m
[30;1m320 | [0m[35m                free_storage = [report.get('high_water', 0) for report in storage.values()][0m
[30;1m321 | [0m[35m                min_storage = sum_storage = 0[0m
[30;1m322 | [0m[35m                if free_storage:[0m
[30;1m323 | [0m[35m                    min_storage = min(free_storage)[0m

[31m--[ [0m[34mMatch #[0m[33m821[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/heartbeat_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m316 | [0m[35m                resources = status.get('resources', {})[0m
[30;1m317 | [0m[35m                storage = status.get('storage', {})[0m
[30;1m318 | [0m[35m                last_minute_cpu = sum(report.get('cpu_load_1m', 0) for report in resources.values())[0m
[30;1m319 | [0m[35m                memory = sum(report.get('memory', 0) for report in resources.values())[0m
[30;1m320 | [0m[35m                free_storage = [report.get('high_water', 0) for report in storage.values()][0m
[30;1m321 | [0m[35m                min_storage = sum_storage = 0[0m
[30;1m322 | [0m[35m                if free_storage:[0m

[31m--[ [0m[34mMatch #[0m[33m822[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/heartbeat_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m315 | [0m[35m                fetcher = status.get('fetcher', {})[0m
[30;1m316 | [0m[35m                resources = status.get('resources', {})[0m
[30;1m317 | [0m[35m                storage = status.get('storage', {})[0m
[30;1m318 | [0m[35m                last_minute_cpu = sum(report.get('cpu_load_1m', 0) for report in resources.values())[0m
[30;1m319 | [0m[35m                memory = sum(report.get('memory', 0) for report in resources.values())[0m
[30;1m320 | [0m[35m                free_storage = [report.get('high_water', 0) for report in storage.values()][0m
[30;1m321 | [0m[35m                min_storage = sum_storage = 0[0m

[31m--[ [0m[34mMatch #[0m[33m823[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/heartbeat_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m314 | [0m[35m                status = m_data.get('status', {})[0m
[30;1m315 | [0m[35m                fetcher = status.get('fetcher', {})[0m
[30;1m316 | [0m[35m                resources = status.get('resources', {})[0m
[30;1m317 | [0m[35m                storage = status.get('storage', {})[0m
[30;1m318 | [0m[35m                last_minute_cpu = sum(report.get('cpu_load_1m', 0) for report in resources.values())[0m
[30;1m319 | [0m[35m                memory = sum(report.get('memory', 0) for report in resources.values())[0m
[30;1m320 | [0m[35m                free_storage = [report.get('high_water', 0) for report in storage.values()][0m

[31m--[ [0m[34mMatch #[0m[33m824[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/heartbeat_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m313 | [0m[35m[0m
[30;1m314 | [0m[35m                status = m_data.get('status', {})[0m
[30;1m315 | [0m[35m                fetcher = status.get('fetcher', {})[0m
[30;1m316 | [0m[35m                resources = status.get('resources', {})[0m
[30;1m317 | [0m[35m                storage = status.get('storage', {})[0m
[30;1m318 | [0m[35m                last_minute_cpu = sum(report.get('cpu_load_1m', 0) for report in resources.values())[0m
[30;1m319 | [0m[35m                memory = sum(report.get('memory', 0) for report in resources.values())[0m

[31m--[ [0m[34mMatch #[0m[33m825[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/heartbeat_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m312 | [0m[35m            try:[0m
[30;1m313 | [0m[35m[0m
[30;1m314 | [0m[35m                status = m_data.get('status', {})[0m
[30;1m315 | [0m[35m                fetcher = status.get('fetcher', {})[0m
[30;1m316 | [0m[35m                resources = status.get('resources', {})[0m
[30;1m317 | [0m[35m                storage = status.get('storage', {})[0m
[30;1m318 | [0m[35m                last_minute_cpu = sum(report.get('cpu_load_1m', 0) for report in resources.values())[0m

[31m--[ [0m[34mMatch #[0m[33m826[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/heartbeat_formatter.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m311 | [0m[35m        elif m_type == "retrohunt":[0m
[30;1m312 | [0m[35m            try:[0m
[30;1m313 | [0m[35m[0m
[30;1m314 | [0m[35m                status = m_data.get('status', {})[0m
[30;1m315 | [0m[35m                fetcher = status.get('fetcher', {})[0m
[30;1m316 | [0m[35m                resources = status.get('resources', {})[0m
[30;1m317 | [0m[35m                storage = status.get('storage', {})[0m

[31m--[ [0m[34mMatch #[0m[33m827[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/heartbeat_formatter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m274 | [0m[35m                    }[0m
[30;1m275 | [0m[35m                }[0m
[30;1m276 | [0m[35m                self.status_queue.publish(ServiceMessage(msg).as_primitives())[0m
[30;1m277 | [0m[35m                self.log.info(f"Sent service heartbeat: {msg['msg']}")[0m
[30;1m278 | [0m[35m            except Exception:[0m
[30;1m279 | [0m[35m                self.log.exception("An exception occurred while generating ServiceMessage")[0m
[30;1m280 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m828[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/heartbeat_formatter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m    busy = [][0m
[30;1m40 | [0m[35m    idle = [][0m
[30;1m41 | [0m[35m    for host, (service, state, time_limit) in service_data.items():[0m
[30;1m42 | [0m[35m        if service == current_service:[0m
[30;1m43 | [0m[35m            if time.time() < time_limit:[0m
[30;1m44 | [0m[35m                if state == ServiceStatus.Running:[0m
[30;1m45 | [0m[35m                    busy.append(host)[0m

[31m--[ [0m[34mMatch #[0m[33m829[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/heartbeat_formatter.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom apscheduler.schedulers.background import BackgroundScheduler[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom assemblyline.common import forge, metrics[0m

[31m--[ [0m[34mMatch #[0m[33m830[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/replay/creator/run_worker.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m9 | [0m[35mfrom assemblyline_core.replay.client import APIClient, DirectClient[0m
[30;1m10 | [0m[35mfrom assemblyline_core.replay.replay import ReplayBase, INPUT_TYPES[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mREPLAY_BATCH_SIZE = int(os.environ.get("REPLAY_BATCH_SIZE", "1000"))[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mclass ReplayCreatorWorker(ReplayBase):[0m

[31m--[ [0m[34mMatch #[0m[33m831[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/replay/creator/run_worker.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m133 | [0m[35m                if len(batch) == REPLAY_BATCH_SIZE:[0m
[30;1m134 | [0m[35m                    upload_batch()[0m
[30;1m135 | [0m[35m            elif last_obj:[0m
[30;1m136 | [0m[35m                # Update the checkpoint based on the last item processed before nothing[0m
[30;1m137 | [0m[35m                self.client._put_checkpoint(collection, last_obj[date_field])[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m                # Check if there's anything that hasn't been exported before the queue went silent[0m

[31m--[ [0m[34mMatch #[0m[33m832[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/replay/creator/run_worker.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m99 | [0m[35m                break[0m
[30;1m100 | [0m[35m[0m
[30;1m101 | [0m[35m    def _process_json_exports(self, collection, id_field, date_field, once=False):[0m
[30;1m102 | [0m[35m        # Keep track of the last record exported to update checkpoint[0m
[30;1m103 | [0m[35m        last_obj = None[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35m        # Collection of records to be exported to a single JSON file per batch size[0m

[31m--[ [0m[34mMatch #[0m[33m833[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/es_metrics.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m434 | [0m[35m                    "name": name,[0m
[30;1m435 | [0m[35m                    "timestamp": timestamp,[0m
[30;1m436 | [0m[35m                    "status": health.get(name, 'red'),[0m
[30;1m437 | [0m[35m                    "shards": shards.get(name, {"total": 0, "unassigned": 0}),[0m
[30;1m438 | [0m[35m                    "docs": {[0m
[30;1m439 | [0m[35m                        "total": stats['total']['docs']['count'][0m
[30;1m440 | [0m[35m                    },[0m

[31m--[ [0m[34mMatch #[0m[33m834[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/es_metrics.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m433 | [0m[35m                metric = {[0m
[30;1m434 | [0m[35m                    "name": name,[0m
[30;1m435 | [0m[35m                    "timestamp": timestamp,[0m
[30;1m436 | [0m[35m                    "status": health.get(name, 'red'),[0m
[30;1m437 | [0m[35m                    "shards": shards.get(name, {"total": 0, "unassigned": 0}),[0m
[30;1m438 | [0m[35m                    "docs": {[0m
[30;1m439 | [0m[35m                        "total": stats['total']['docs']['count'][0m

[31m--[ [0m[34mMatch #[0m[33m835[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/es_metrics.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mMETRICSTORE_ROOT_CA_PATH = environ.get('METRICSTORE_ROOT_CA_PATH', '/etc/assemblyline/ssl/al_root-ca[0m
[30;1m20 | [0m[35mMETRICSTORE_VERIFY_CERTS = environ.get('METRICSTORE_VERIFY_CERTS', 'true').lower() == "true"[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m[0m
[30;1m23 | [0m[35mclass ESMetricsServer(ServerBase):[0m

[31m--[ [0m[34mMatch #[0m[33m836[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/es_metrics.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m16 | [0m[35mfrom assemblyline_core.server_base import ServerBase[0m
[30;1m17 | [0m[35m[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35mMETRICSTORE_ROOT_CA_PATH = environ.get('METRICSTORE_ROOT_CA_PATH', '/etc/assemblyline/ssl/al_root-ca[0m
[30;1m20 | [0m[35mMETRICSTORE_VERIFY_CERTS = environ.get('METRICSTORE_VERIFY_CERTS', 'true').lower() == "true"[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m837[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/es_metrics.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m553 | [0m[35m            self.log.debug(cluster_metrics)[0m
[30;1m554 | [0m[35m[0m
[30;1m555 | [0m[35m            # NODES[0m
[30;1m556 | [0m[35m            self.log.info("Gathering node metrics ...")[0m
[30;1m557 | [0m[35m            node_metrics = self.get_node_metrics()[0m
[30;1m558 | [0m[35m            self.log.debug(node_metrics)[0m
[30;1m559 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m838[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/es_metrics.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m168 | [0m[35m                        "open": stats['process']['open_file_descriptors'],[0m
[30;1m169 | [0m[35m                        "max": stats['process']['max_file_descriptors'][0m
[30;1m170 | [0m[35m                    },[0m
[30;1m171 | [0m[35m                    # This is an aggregate over time. Should we compute the value from the last time[0m
[30;1m172 | [0m[35m                    "gc": {[0m
[30;1m173 | [0m[35m                        "old": {[0m
[30;1m174 | [0m[35m                            "count": old_gc_count / divider,[0m

[31m--[ [0m[34mMatch #[0m[33m839[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/es_metrics.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport json[0m
[30;1m2 | [0m[35mimport tempfile[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mimport sys[0m
[30;1m5 | [0m[35mfrom os import environ, path[0m
[30;1m6 | [0m[35mfrom urllib.parse import urlparse[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m840[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m902 | [0m[35m[0m
[30;1m903 | [0m[35m        if not reason:[0m
[30;1m904 | [0m[35m            with self.whitelisted_lock:[0m
[30;1m905 | [0m[35m                reason = self.whitelisted.get(sha256, None)[0m
[30;1m906 | [0m[35m                if reason:[0m
[30;1m907 | [0m[35m                    hit = 'cached'[0m
[30;1m908 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m841[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m842 | [0m[35m        if threshold is not None and task.score is not None and task.score < threshold:[0m
[30;1m843 | [0m[35m            return[0m
[30;1m844 | [0m[35m[0m
[30;1m845 | [0m[35m        q = self.notification_queues.get(note_queue, None)[0m
[30;1m846 | [0m[35m        if not q:[0m
[30;1m847 | [0m[35m            self.notification_queues[note_queue] = q = NamedQueue(note_queue, self.redis_persist)[0m
[30;1m848 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m842[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m776 | [0m[35m[0m
[30;1m777 | [0m[35m        if not raw:[0m
[30;1m778 | [0m[35m            # Some other worker has already popped the scanning queue?[0m
[30;1m779 | [0m[35m            self.log.warning(f"[{sub.metadata.get('ingest_id', 'unknown')} :: {sha256}] "[0m
[30;1m780 | [0m[35m                             f"Submission completed twice")[0m
[30;1m781 | [0m[35m            return scan_key[0m
[30;1m782 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m843[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m765 | [0m[35m        sha256 = sub.files[0].sha256[0m
[30;1m766 | [0m[35m        scan_key = sub.scan_key[0m
[30;1m767 | [0m[35m        if not scan_key:[0m
[30;1m768 | [0m[35m            self.log.warning(f"[{sub.metadata.get('ingest_id', 'unknown')} :: {sha256}] "[0m
[30;1m769 | [0m[35m                             f"Submission missing scan key")[0m
[30;1m770 | [0m[35m            scan_key = sub.params.create_filescore_key(sha256)[0m
[30;1m771 | [0m[35m        raw = self.scanning.pop(scan_key)[0m

[31m--[ [0m[34mMatch #[0m[33m844[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m698 | [0m[35m        key = self.stamp_filescore_key(task)[0m
[30;1m699 | [0m[35m[0m
[30;1m700 | [0m[35m        with self.cache_lock:[0m
[30;1m701 | [0m[35m            result: Optional[FileScore] = self.cache.get(key, None)[0m
[30;1m702 | [0m[35m[0m
[30;1m703 | [0m[35m        if result:[0m
[30;1m704 | [0m[35m            self.counter.increment('cache_hit_local')[0m

[31m--[ [0m[34mMatch #[0m[33m845[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m650 | [0m[35m[0m
[30;1m651 | [0m[35m            if self.config.core.ingester.always_create_submission:[0m
[30;1m652 | [0m[35m                # Create a submission record based on the cache hit[0m
[30;1m653 | [0m[35m                submission = self.datastore.submission.get(previous, as_obj=False)[0m
[30;1m654 | [0m[35m[0m
[30;1m655 | [0m[35m                # Assign the current submission as the PSID for the new submission[0m
[30;1m656 | [0m[35m                pprevious = previous[0m

[31m--[ [0m[34mMatch #[0m[33m846[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m572 | [0m[35m[0m
[30;1m573 | [0m[35m        # Get the groups for this user if not known[0m
[30;1m574 | [0m[35m        if username not in self._user_groups:[0m
[30;1m575 | [0m[35m            user_data: User = self.datastore.user.get(username)[0m
[30;1m576 | [0m[35m            if user_data:[0m
[30;1m577 | [0m[35m                self._user_groups[username] = user_data.groups[0m
[30;1m578 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m847[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m58 | [0m[35mHOUR_IN_SECONDS = 60 * 60[0m
[30;1m59 | [0m[35mCOMPLETE_THREADS = int(environ.get('INGESTER_COMPLETE_THREADS', 4))[0m
[30;1m60 | [0m[35mINGEST_THREADS = int(environ.get('INGESTER_INGEST_THREADS', 1))[0m
[30;1m61 | [0m[35mSUBMIT_THREADS = int(environ.get('INGESTER_SUBMIT_THREADS', 4))[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35mdef must_drop(length: int, maximum: int) -> bool:[0m

[31m--[ [0m[34mMatch #[0m[33m848[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m_max_time = 2 * 24 * 60 * 60  # Wait 2 days for responses.[0m
[30;1m58 | [0m[35mHOUR_IN_SECONDS = 60 * 60[0m
[30;1m59 | [0m[35mCOMPLETE_THREADS = int(environ.get('INGESTER_COMPLETE_THREADS', 4))[0m
[30;1m60 | [0m[35mINGEST_THREADS = int(environ.get('INGESTER_INGEST_THREADS', 1))[0m
[30;1m61 | [0m[35mSUBMIT_THREADS = int(environ.get('INGESTER_SUBMIT_THREADS', 4))[0m
[30;1m62 | [0m[35m[0m
[30;1m63 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m849[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m56 | [0m[35m_retry_delay = 60 * 4  # Wait 4 minutes to retry[0m
[30;1m57 | [0m[35m_max_time = 2 * 24 * 60 * 60  # Wait 2 days for responses.[0m
[30;1m58 | [0m[35mHOUR_IN_SECONDS = 60 * 60[0m
[30;1m59 | [0m[35mCOMPLETE_THREADS = int(environ.get('INGESTER_COMPLETE_THREADS', 4))[0m
[30;1m60 | [0m[35mINGEST_THREADS = int(environ.get('INGESTER_INGEST_THREADS', 1))[0m
[30;1m61 | [0m[35mSUBMIT_THREADS = int(environ.get('INGESTER_SUBMIT_THREADS', 4))[0m
[30;1m62 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m850[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m846 | [0m[35m        if not q:[0m
[30;1m847 | [0m[35m            self.notification_queues[note_queue] = q = NamedQueue(note_queue, self.redis_persist)[0m
[30;1m848 | [0m[35m[0m
[30;1m849 | [0m[35m        # Mark at which time an item was queued[0m
[30;1m850 | [0m[35m        task.notify_time = now_as_iso()[0m
[30;1m851 | [0m[35m[0m
[30;1m852 | [0m[35m        q.push(task.as_primitives())[0m

[31m--[ [0m[34mMatch #[0m[33m851[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m565 | [0m[35m            last_round = set(unprocessed)[0m
[30;1m566 | [0m[35m[0m
[30;1m567 | [0m[35m    def get_groups_from_user(self, username: str) -> List[str]:[0m
[30;1m568 | [0m[35m        # Reset the group cache at the top of each hour[0m
[30;1m569 | [0m[35m        if time.time()//HOUR_IN_SECONDS > self._user_groups_reset:[0m
[30;1m570 | [0m[35m            self._user_groups = {}[0m
[30;1m571 | [0m[35m            self._user_groups_reset = time.time()//HOUR_IN_SECONDS[0m

[31m--[ [0m[34mMatch #[0m[33m852[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m557 | [0m[35m                    self.log.warning(f"Recovering a submission dispatcher hasn't processed [{sid}]")[0m
[30;1m558 | [0m[35m                    self.submit(task)[0m
[30;1m559 | [0m[35m[0m
[30;1m560 | [0m[35m                # Otherwise defer looking at this until next iteration[0m
[30;1m561 | [0m[35m                else:[0m
[30;1m562 | [0m[35m                    unprocessed.append(sid)[0m
[30;1m563 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m853[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m        # Move from ingest to unique and waiting queues.[0m
[30;1m219 | [0m[35m        # While there are entries in the ingest queue we consume chunk_size[0m
[30;1m220 | [0m[35m        # entries at a time and move unique entries to uniqueq / queued and[0m
[30;1m221 | [0m[35m        # duplicates to their own queues / waiting.[0m
[30;1m222 | [0m[35m        while self.running:[0m
[30;1m223 | [0m[35m            while not self.active:[0m

[31m--[ [0m[34mMatch #[0m[33m854[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m184 | [0m[35m        # Utility object to handle post-processing actions[0m
[30;1m185 | [0m[35m        self.postprocess_worker = ActionWorker(cache=True, config=self.config, datastore=self.datast[0m
[30;1m186 | [0m[35m                                               redis_persist=self.redis_persist)[0m
[30;1m187 | [0m[35m        # Async Submission quota tracker[0m
[30;1m188 | [0m[35m        self.async_submission_tracker = UserQuotaTracker('async_submissions', timeout=24 * 60 * 60, [0m
[30;1m189 | [0m[35m                                                         redis=self.redis_persist)[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m        # Watchers[0m

[31m--[ [0m[34mMatch #[0m[33m855[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m135 | [0m[35m        self.get_whitelist_verdict = load_module_by_path(self.config.core.ingester.get_whitelist_ver[0m
[30;1m136 | [0m[35m        self.whitelist = load_module_by_path(self.config.core.ingester.whitelist)[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35m        # Constants are loaded based on a non-constant path, so has to be done at init rather than l[0m
[30;1m139 | [0m[35m        constants = forge.get_constants(self.config)[0m
[30;1m140 | [0m[35m        self.priority_value: dict[str, int] = constants.PRIORITIES[0m
[30;1m141 | [0m[35m        self.priority_range: dict[str, Tuple[int, int]] = constants.PRIORITY_RANGES[0m

[31m--[ [0m[34mMatch #[0m[33m856[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m130 | [0m[35m        self.whitelisted: dict[str, Any] = {}[0m
[30;1m131 | [0m[35m        self.whitelisted_lock = threading.RLock()[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m        # Module path parameters are fixed at start time. Changing these involves a restart[0m
[30;1m134 | [0m[35m        self.is_low_priority = load_module_by_path(self.config.core.ingester.is_low_priority)[0m
[30;1m135 | [0m[35m        self.get_whitelist_verdict = load_module_by_path(self.config.core.ingester.get_whitelist_ver[0m
[30;1m136 | [0m[35m        self.whitelist = load_module_by_path(self.config.core.ingester.whitelist)[0m

[31m--[ [0m[34mMatch #[0m[33m857[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m111 | [0m[35m    extended_scan = odm.Enum(EXTENDED_SCAN_VALUES, default="skipped")  # Status of the extended scan[0m
[30;1m112 | [0m[35m    ingest_id = odm.UUID()  # Ingestion Identifier[0m
[30;1m113 | [0m[35m    ingest_time = odm.Date(default="NOW")  # Time at which the file was ingested[0m
[30;1m114 | [0m[35m    notify_time = odm.Optional(odm.Date())  # Time at which the user is notify the submission is fin[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35mclass Ingester(ThreadedCoreBase):[0m

[31m--[ [0m[34mMatch #[0m[33m858[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m110 | [0m[35m    score = odm.Optional(odm.Integer())  # Score from previous processing of this file[0m
[30;1m111 | [0m[35m    extended_scan = odm.Enum(EXTENDED_SCAN_VALUES, default="skipped")  # Status of the extended scan[0m
[30;1m112 | [0m[35m    ingest_id = odm.UUID()  # Ingestion Identifier[0m
[30;1m113 | [0m[35m    ingest_time = odm.Date(default="NOW")  # Time at which the file was ingested[0m
[30;1m114 | [0m[35m    notify_time = odm.Optional(odm.Date())  # Time at which the user is notify the submission is fin[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m859[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m846 | [0m[35m        if not q:[0m
[30;1m847 | [0m[35m            self.notification_queues[note_queue] = q = NamedQueue(note_queue, self.redis_persist)[0m
[30;1m848 | [0m[35m[0m
[30;1m849 | [0m[35m        # Mark at which time an item was queued[0m
[30;1m850 | [0m[35m        task.notify_time = now_as_iso()[0m
[30;1m851 | [0m[35m[0m
[30;1m852 | [0m[35m        q.push(task.as_primitives())[0m

[31m--[ [0m[34mMatch #[0m[33m860[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m565 | [0m[35m            last_round = set(unprocessed)[0m
[30;1m566 | [0m[35m[0m
[30;1m567 | [0m[35m    def get_groups_from_user(self, username: str) -> List[str]:[0m
[30;1m568 | [0m[35m        # Reset the group cache at the top of each hour[0m
[30;1m569 | [0m[35m        if time.time()//HOUR_IN_SECONDS > self._user_groups_reset:[0m
[30;1m570 | [0m[35m            self._user_groups = {}[0m
[30;1m571 | [0m[35m            self._user_groups_reset = time.time()//HOUR_IN_SECONDS[0m

[31m--[ [0m[34mMatch #[0m[33m861[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m515 | [0m[35m         - listed by ingester but unknown by dispatcher (message could have been dropped on either e[0m
[30;1m516 | [0m[35m[0m
[30;1m517 | [0m[35m        Loading all the info needed to do these checks is a bit slow, but doing them every 5 or 15 m[0m
[30;1m518 | [0m[35m        per ingester shouldn't be noteworthy. While these missing messages are bound to happen from [0m
[30;1m519 | [0m[35m        they should be rare. With that in mind, a warning is raised whenever this worker processes s[0m
[30;1m520 | [0m[35m        so that if a constant stream of items are falling through and getting processed here it migh[0m
[30;1m521 | [0m[35m        """[0m
[30;1m522 | [0m[35m        last_round: set[str] = set()[0m

[31m--[ [0m[34mMatch #[0m[33m862[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m515 | [0m[35m         - listed by ingester but unknown by dispatcher (message could have been dropped on either e[0m
[30;1m516 | [0m[35m[0m
[30;1m517 | [0m[35m        Loading all the info needed to do these checks is a bit slow, but doing them every 5 or 15 m[0m
[30;1m518 | [0m[35m        per ingester shouldn't be noteworthy. While these missing messages are bound to happen from [0m
[30;1m519 | [0m[35m        they should be rare. With that in mind, a warning is raised whenever this worker processes s[0m
[30;1m520 | [0m[35m        so that if a constant stream of items are falling through and getting processed here it migh[0m
[30;1m521 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m863[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m        # Move from ingest to unique and waiting queues.[0m
[30;1m219 | [0m[35m        # While there are entries in the ingest queue we consume chunk_size[0m
[30;1m220 | [0m[35m        # entries at a time and move unique entries to uniqueq / queued and[0m
[30;1m221 | [0m[35m        # duplicates to their own queues / waiting.[0m
[30;1m222 | [0m[35m        while self.running:[0m
[30;1m223 | [0m[35m            while not self.active:[0m

[31m--[ [0m[34mMatch #[0m[33m864[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m185 | [0m[35m        self.postprocess_worker = ActionWorker(cache=True, config=self.config, datastore=self.datast[0m
[30;1m186 | [0m[35m                                               redis_persist=self.redis_persist)[0m
[30;1m187 | [0m[35m        # Async Submission quota tracker[0m
[30;1m188 | [0m[35m        self.async_submission_tracker = UserQuotaTracker('async_submissions', timeout=24 * 60 * 60, [0m
[30;1m189 | [0m[35m                                                         redis=self.redis_persist)[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m        # Watchers[0m
[30;1m192 | [0m[35m        self.submission_delete_watcher = EventWatcher(self.redis)[0m

[31m--[ [0m[34mMatch #[0m[33m865[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m167 | [0m[35m        # Internal, delay queue for retrying[0m
[30;1m168 | [0m[35m        self.retry_queue = PriorityQueue('m-retry', self.redis_persist)[0m
[30;1m169 | [0m[35m[0m
[30;1m170 | [0m[35m        # Internal, timeout watch queue[0m
[30;1m171 | [0m[35m        self.timeout_queue: PriorityQueue[str] = PriorityQueue('m-timeout', self.redis)[0m
[30;1m172 | [0m[35m[0m
[30;1m173 | [0m[35m        # Internal, queue for processing duplicates[0m

[31m--[ [0m[34mMatch #[0m[33m866[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m111 | [0m[35m    extended_scan = odm.Enum(EXTENDED_SCAN_VALUES, default="skipped")  # Status of the extended scan[0m
[30;1m112 | [0m[35m    ingest_id = odm.UUID()  # Ingestion Identifier[0m
[30;1m113 | [0m[35m    ingest_time = odm.Date(default="NOW")  # Time at which the file was ingested[0m
[30;1m114 | [0m[35m    notify_time = odm.Optional(odm.Date())  # Time at which the user is notify the submission is fin[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35mclass Ingester(ThreadedCoreBase):[0m

[31m--[ [0m[34mMatch #[0m[33m867[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m110 | [0m[35m    score = odm.Optional(odm.Integer())  # Score from previous processing of this file[0m
[30;1m111 | [0m[35m    extended_scan = odm.Enum(EXTENDED_SCAN_VALUES, default="skipped")  # Status of the extended scan[0m
[30;1m112 | [0m[35m    ingest_id = odm.UUID()  # Ingestion Identifier[0m
[30;1m113 | [0m[35m    ingest_time = odm.Date(default="NOW")  # Time at which the file was ingested[0m
[30;1m114 | [0m[35m    notify_time = odm.Optional(odm.Date())  # Time at which the user is notify the submission is fin[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m868[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/ingester/ingester.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mimport logging[0m
[30;1m13 | [0m[35mimport threading[0m
[30;1m14 | [0m[35mimport time[0m
[30;1m15 | [0m[35mfrom os import environ[0m
[30;1m16 | [0m[35mfrom random import random[0m
[30;1m17 | [0m[35mfrom typing import Any, Iterable, List, Optional, Tuple[0m
[30;1m18 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m869[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m    assert {'errors': False, 'success': 1, 'skipped': []} == client.add_update_many(source, s_type, [0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m    # Test the signature data[0m
[30;1m88 | [0m[35m    modded_sig = client.datastore.signature.get(key, as_obj=False)[0m
[30;1m89 | [0m[35m    assert modded_sig["data"] == new_sig_data[0m
[30;1m90 | [0m[35m    # Was state kept?[0m
[30;1m91 | [0m[35m    assert "DISABLED" == modded_sig.pop('status')[0m

[31m--[ [0m[34mMatch #[0m[33m870[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m76 | [0m[35m    assert data == added_sig[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    # Change the signature status[0m
[30;1m79 | [0m[35m    success, _ = client.change_status(key, "DISABLED", client.datastore.user.get('user', as_obj=Fals[0m
[30;1m80 | [0m[35m    assert success[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    # Update signature data[0m

[31m--[ [0m[34mMatch #[0m[33m871[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m    client.datastore.signature.commit()[0m
[30;1m73 | [0m[35m    data = random.choice(sig_list)[0m
[30;1m74 | [0m[35m    key = f"{data['type']}_{data['source']}_{data['signature_id']}"[0m
[30;1m75 | [0m[35m    added_sig = client.datastore.signature.get(key, as_obj=False)[0m
[30;1m76 | [0m[35m    assert data == added_sig[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    # Change the signature status[0m

[31m--[ [0m[34mMatch #[0m[33m872[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m44 | [0m[35m    success, key, _ = client.add_update(data)[0m
[30;1m45 | [0m[35m    assert success[0m
[30;1m46 | [0m[35m    assert expected_key == key[0m
[30;1m47 | [0m[35m    modded_sig = client.datastore.signature.get(key, as_obj=False)[0m
[30;1m48 | [0m[35m    assert modded_sig["data"] == new_sig_data[0m
[30;1m49 | [0m[35m    # Was state kept from user setting?[0m
[30;1m50 | [0m[35m    assert "DISABLED" == modded_sig.pop('status')[0m

[31m--[ [0m[34mMatch #[0m[33m873[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m    assert data == added_sig[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    # Change the signature status as a user[0m
[30;1m38 | [0m[35m    success, _ = client.change_status(key, "DISABLED", client.datastore.user.get('user', as_obj=Fals[0m
[30;1m39 | [0m[35m    assert success[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    # Update signature data as an internal component[0m

[31m--[ [0m[34mMatch #[0m[33m874[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_signature_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    # Test the signature data[0m
[30;1m33 | [0m[35m    client.datastore.signature.commit()[0m
[30;1m34 | [0m[35m    added_sig = client.datastore.signature.get(key, as_obj=False)[0m
[30;1m35 | [0m[35m    assert data == added_sig[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    # Change the signature status as a user[0m

[31m--[ [0m[34mMatch #[0m[33m875[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_signature_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m112 | [0m[35m    client._update_classification(sig)[0m
[30;1m113 | [0m[35m    assert sig['classification'] == "TLP:A//TEST"[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    # Update classification with value from another field within the signature[0m
[30;1m116 | [0m[35m    client.classification_replace_map = {"TEST": "_source"}[0m
[30;1m117 | [0m[35m    client._update_classification(sig)[0m
[30;1m118 | [0m[35m    assert sig['classification'] == f"TLP:A//{sig['source']}"[0m

[31m--[ [0m[34mMatch #[0m[33m876[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_signature_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m107 | [0m[35mdef test_update_classification(client):[0m
[30;1m108 | [0m[35m    sig = client.datastore.signature.search("*", rows=1, as_obj=False)['items'][0][0m
[30;1m109 | [0m[35m[0m
[30;1m110 | [0m[35m    # Update classification with literal string[0m
[30;1m111 | [0m[35m    client.classification_replace_map = {"TLP:C": "TLP:A//TEST"}[0m
[30;1m112 | [0m[35m    client._update_classification(sig)[0m
[30;1m113 | [0m[35m    assert sig['classification'] == "TLP:A//TEST"[0m

[31m--[ [0m[34mMatch #[0m[33m877[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_signature_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m79 | [0m[35m    success, _ = client.change_status(key, "DISABLED", client.datastore.user.get('user', as_obj=Fals[0m
[30;1m80 | [0m[35m    assert success[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m    # Update signature data[0m
[30;1m83 | [0m[35m    new_sig_data = "NEW SIGNATURE DATA"[0m
[30;1m84 | [0m[35m    data['data'] = new_sig_data[0m
[30;1m85 | [0m[35m    assert {'errors': False, 'success': 1, 'skipped': []} == client.add_update_many(source, s_type, [0m

[31m--[ [0m[34mMatch #[0m[33m878[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_signature_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m38 | [0m[35m    success, _ = client.change_status(key, "DISABLED", client.datastore.user.get('user', as_obj=Fals[0m
[30;1m39 | [0m[35m    assert success[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m    # Update signature data as an internal component[0m
[30;1m42 | [0m[35m    new_sig_data = "NEW SIGNATURE DATA"[0m
[30;1m43 | [0m[35m    data['data'] = new_sig_data[0m
[30;1m44 | [0m[35m    success, key, _ = client.add_update(data)[0m

[31m--[ [0m[34mMatch #[0m[33m879[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m400 | [0m[35m    else:[0m
[30;1m401 | [0m[35m        user_classification = None[0m
[30;1m402 | [0m[35m    a_type = alert_data.get('submission', {}).get('metadata', {}).pop('type', None)[0m
[30;1m403 | [0m[35m    a_ts = alert_data.get('submission', {}).get('metadata', {}).pop('ts', None)[0m
[30;1m404 | [0m[35m[0m
[30;1m405 | [0m[35m    alert = {[0m
[30;1m406 | [0m[35m        'al': {[0m

[31m--[ [0m[34mMatch #[0m[33m880[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m400 | [0m[35m    else:[0m
[30;1m401 | [0m[35m        user_classification = None[0m
[30;1m402 | [0m[35m    a_type = alert_data.get('submission', {}).get('metadata', {}).pop('type', None)[0m
[30;1m403 | [0m[35m    a_ts = alert_data.get('submission', {}).get('metadata', {}).pop('ts', None)[0m
[30;1m404 | [0m[35m[0m
[30;1m405 | [0m[35m    alert = {[0m
[30;1m406 | [0m[35m        'al': {[0m

[31m--[ [0m[34mMatch #[0m[33m881[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m399 | [0m[35m        user_classification = user['classification'][0m
[30;1m400 | [0m[35m    else:[0m
[30;1m401 | [0m[35m        user_classification = None[0m
[30;1m402 | [0m[35m    a_type = alert_data.get('submission', {}).get('metadata', {}).pop('type', None)[0m
[30;1m403 | [0m[35m    a_ts = alert_data.get('submission', {}).get('metadata', {}).pop('ts', None)[0m
[30;1m404 | [0m[35m[0m
[30;1m405 | [0m[35m    alert = {[0m

[31m--[ [0m[34mMatch #[0m[33m882[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m399 | [0m[35m        user_classification = user['classification'][0m
[30;1m400 | [0m[35m    else:[0m
[30;1m401 | [0m[35m        user_classification = None[0m
[30;1m402 | [0m[35m    a_type = alert_data.get('submission', {}).get('metadata', {}).pop('type', None)[0m
[30;1m403 | [0m[35m    a_ts = alert_data.get('submission', {}).get('metadata', {}).pop('ts', None)[0m
[30;1m404 | [0m[35m[0m
[30;1m405 | [0m[35m    alert = {[0m

[31m--[ [0m[34mMatch #[0m[33m883[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m394 | [0m[35m    # Additional init goes here[0m
[30;1m395 | [0m[35m    ###############################[0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m    user = datastore.user.get(alert_data.get('submission', {}).get('params', {}).get('submitter', No[0m
[30;1m398 | [0m[35m    if user:[0m
[30;1m399 | [0m[35m        user_classification = user['classification'][0m
[30;1m400 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m884[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m394 | [0m[35m    # Additional init goes here[0m
[30;1m395 | [0m[35m    ###############################[0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m    user = datastore.user.get(alert_data.get('submission', {}).get('params', {}).get('submitter', No[0m
[30;1m398 | [0m[35m    if user:[0m
[30;1m399 | [0m[35m        user_classification = user['classification'][0m
[30;1m400 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m885[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m394 | [0m[35m    # Additional init goes here[0m
[30;1m395 | [0m[35m    ###############################[0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m    user = datastore.user.get(alert_data.get('submission', {}).get('params', {}).get('submitter', No[0m
[30;1m398 | [0m[35m    if user:[0m
[30;1m399 | [0m[35m        user_classification = user['classification'][0m
[30;1m400 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m886[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m394 | [0m[35m    # Additional init goes here[0m
[30;1m395 | [0m[35m    ###############################[0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m    user = datastore.user.get(alert_data.get('submission', {}).get('params', {}).get('submitter', No[0m
[30;1m398 | [0m[35m    if user:[0m
[30;1m399 | [0m[35m        user_classification = user['classification'][0m
[30;1m400 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m887[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m343 | [0m[35m    alert_update_p1, alert_update_p2 = cache.get(alert_data['submission']['sid'], (None, None))[0m
[30;1m344 | [0m[35m    if alert_update_p1 is None or alert_update_p2 is None:[0m
[30;1m345 | [0m[35m        parsed_record = parse_submission_record(counter, datastore, alert_data, logger, user_classif[0m
[30;1m346 | [0m[35m        file_record = datastore.file.get(alert_file['sha256'], as_obj=False)[0m
[30;1m347 | [0m[35m        al = {k: list(v) for k, v in parsed_record['summary'].items() if k in AL_RESULT_KEYS}[0m
[30;1m348 | [0m[35m        al['detailed'] = parsed_record['detailed'][0m
[30;1m349 | [0m[35m        al['request_end_time'] = parsed_record['srecord']['times']['completed'][0m

[31m--[ [0m[34mMatch #[0m[33m888[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m340 | [0m[35m    global cache[0m
[30;1m341 | [0m[35m    # Check cache[0m
[30;1m342 | [0m[35m    alert_file = alert_data['submission']['files'][0][0m
[30;1m343 | [0m[35m    alert_update_p1, alert_update_p2 = cache.get(alert_data['submission']['sid'], (None, None))[0m
[30;1m344 | [0m[35m    if alert_update_p1 is None or alert_update_p2 is None:[0m
[30;1m345 | [0m[35m        parsed_record = parse_submission_record(counter, datastore, alert_data, logger, user_classif[0m
[30;1m346 | [0m[35m        file_record = datastore.file.get(alert_file['sha256'], as_obj=False)[0m

[31m--[ [0m[34mMatch #[0m[33m889[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m260 | [0m[35m            # did not exist in the parent the extended scan is 'incomplete'.[0m
[30;1m261 | [0m[35m            ps = datastore.submission.get(psid, as_obj=False) or {}[0m
[30;1m262 | [0m[35m            pe = set((x[:x.rfind('.')] for x in ps.get('errors', [])))[0m
[30;1m263 | [0m[35m            e = set((x[:x.rfind('.')] for x in srecord.get('errors', [])))[0m
[30;1m264 | [0m[35m            ne = e.difference(pe)[0m
[30;1m265 | [0m[35m            extended_scan = 'incomplete' if ne else 'completed'[0m
[30;1m266 | [0m[35m        except Exception:  # pylint: disable=W0702[0m

[31m--[ [0m[34mMatch #[0m[33m890[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m259 | [0m[35m            # to only sha256 and service name. If there are any keys that[0m
[30;1m260 | [0m[35m            # did not exist in the parent the extended scan is 'incomplete'.[0m
[30;1m261 | [0m[35m            ps = datastore.submission.get(psid, as_obj=False) or {}[0m
[30;1m262 | [0m[35m            pe = set((x[:x.rfind('.')] for x in ps.get('errors', [])))[0m
[30;1m263 | [0m[35m            e = set((x[:x.rfind('.')] for x in srecord.get('errors', [])))[0m
[30;1m264 | [0m[35m            ne = e.difference(pe)[0m
[30;1m265 | [0m[35m            extended_scan = 'incomplete' if ne else 'completed'[0m

[31m--[ [0m[34mMatch #[0m[33m891[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m258 | [0m[35m            # Get errors from parent submission and submission. Strip keys[0m
[30;1m259 | [0m[35m            # to only sha256 and service name. If there are any keys that[0m
[30;1m260 | [0m[35m            # did not exist in the parent the extended scan is 'incomplete'.[0m
[30;1m261 | [0m[35m            ps = datastore.submission.get(psid, as_obj=False) or {}[0m
[30;1m262 | [0m[35m            pe = set((x[:x.rfind('.')] for x in ps.get('errors', [])))[0m
[30;1m263 | [0m[35m            e = set((x[:x.rfind('.')] for x in srecord.get('errors', [])))[0m
[30;1m264 | [0m[35m            ne = e.difference(pe)[0m

[31m--[ [0m[34mMatch #[0m[33m892[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m208 | [0m[35m    detailed = {k: list(v.values()) for k, v in detailed.items()}[0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m    # Generate the Summary[0m
[30;1m211 | [0m[35m    summary = {k: set([f"{item['value']} [{item['subtype']}]" if item.get('subtype', None) else item[0m
[30;1m212 | [0m[35m                       for item in v]) for k, v in detailed.items()}[0m
[30;1m213 | [0m[35m    summary['domain'] = summary['domain_dynamic'].union(summary['domain_static'])[0m
[30;1m214 | [0m[35m    summary['ip'] = summary['ip_dynamic'].union(summary['ip_static'])[0m

[31m--[ [0m[34mMatch #[0m[33m893[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m186 | [0m[35m        if tag_value == '' or tag_type is None:[0m
[30;1m187 | [0m[35m            continue[0m
[30;1m188 | [0m[35m[0m
[30;1m189 | [0m[35m        sub_type = TAG_MAP.get(t['type'], None)[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m        if tag_type == 'av':[0m
[30;1m192 | [0m[35m            if tag_value in AV_TO_BEAVIOR:[0m

[31m--[ [0m[34mMatch #[0m[33m894[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m181 | [0m[35m            continue[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m        tag_value = t['value'][0m
[30;1m184 | [0m[35m        tag_type = SUMMARY_TYPE_MAP.get(t['type'], None)[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m        if tag_value == '' or tag_type is None:[0m
[30;1m187 | [0m[35m            continue[0m

[31m--[ [0m[34mMatch #[0m[33m895[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m    # Process Tags[0m
[30;1m179 | [0m[35m    for t in submission_summary['tags']:[0m
[30;1m180 | [0m[35m        if t.get('safelisted', False):[0m
[30;1m181 | [0m[35m            continue[0m
[30;1m182 | [0m[35m[0m
[30;1m183 | [0m[35m        tag_value = t['value'][0m

[31m--[ [0m[34mMatch #[0m[33m896[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m125 | [0m[35m    detailed = {v: {} for v in SUMMARY_TYPE_MAP.values()}[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m    submission_summary = datastore.get_summary_from_keys([0m
[30;1m128 | [0m[35m        srecord.get('results', []),[0m
[30;1m129 | [0m[35m        cl_engine=Classification, user_classification=user_classification,[0m
[30;1m130 | [0m[35m        screenshot_sha256=srecord['files'][0]['sha256'])[0m
[30;1m131 | [0m[35m    max_classification = Classification.max_classification(max_classification, submission_summary['c[0m

[31m--[ [0m[34mMatch #[0m[33m897[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m112 | [0m[35m        counter.increment('error')[0m
[30;1m113 | [0m[35m        raise SubmissionNotFound(f"Couldn't find submission: {sid}")[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    submission_state = srecord.get('state', 'unknown')[0m
[30;1m116 | [0m[35m    if submission_state != 'completed':[0m
[30;1m117 | [0m[35m        raise SubmissionNotFinalized(f"Submission not finalized: {sid} ({submission_state})")[0m
[30;1m118 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m898[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35mdef get_submission_record(counter, datastore, sid):[0m
[30;1m109 | [0m[35m    srecord = datastore.submission.get(sid, as_obj=False)[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    if not srecord:[0m
[30;1m112 | [0m[35m        counter.increment('error')[0m

[31m--[ [0m[34mMatch #[0m[33m899[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m434 | [0m[35m    # Update alert with default values[0m
[30;1m435 | [0m[35m    alert = recursive_update(alert, alert_update_p1)[0m
[30;1m436 | [0m[35m[0m
[30;1m437 | [0m[35m    # Update alert with computed values[0m
[30;1m438 | [0m[35m    alert = recursive_update(alert, alert_update_p2)[0m
[30;1m439 | [0m[35m[0m
[30;1m440 | [0m[35m    return save_alert(datastore, counter, logger, alert)[0m

[31m--[ [0m[34mMatch #[0m[33m900[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m431 | [0m[35m                                                              alert_data, logger,[0m
[30;1m432 | [0m[35m                                                              user_classification)[0m
[30;1m433 | [0m[35m[0m
[30;1m434 | [0m[35m    # Update alert with default values[0m
[30;1m435 | [0m[35m    alert = recursive_update(alert, alert_update_p1)[0m
[30;1m436 | [0m[35m[0m
[30;1m437 | [0m[35m    # Update alert with computed values[0m

[31m--[ [0m[34mMatch #[0m[33m901[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m426 | [0m[35m    # and alert updating goes here[0m
[30;1m427 | [0m[35m    ###############################[0m
[30;1m428 | [0m[35m[0m
[30;1m429 | [0m[35m    # Get update parts[0m
[30;1m430 | [0m[35m    alert_update_p1, alert_update_p2 = get_alert_update_parts(counter, datastore,[0m
[30;1m431 | [0m[35m                                                              alert_data, logger,[0m
[30;1m432 | [0m[35m                                                              user_classification)[0m

[31m--[ [0m[34mMatch #[0m[33m902[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m320 | [0m[35m            counter.increment('updated')[0m
[30;1m321 | [0m[35m            return "AlertUpdated", 'update'[0m
[30;1m322 | [0m[35m        except VersionConflictException as vce:[0m
[30;1m323 | [0m[35m            logger.info(f"Retrying update alert due to version conflict: {str(vce)}")[0m
[30;1m324 | [0m[35m[0m
[30;1m325 | [0m[35m[0m
[30;1m326 | [0m[35mdef save_alert(datastore, counter, logger, alert):[0m

[31m--[ [0m[34mMatch #[0m[33m903[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m305 | [0m[35m                counter.increment('created')[0m
[30;1m306 | [0m[35m                return "AlertCreated", "create"[0m
[30;1m307 | [0m[35m            except VersionConflictException as vce:[0m
[30;1m308 | [0m[35m                logger.info(f"Retrying update alert due to version conflict: {str(vce)}")[0m
[30;1m309 | [0m[35m                continue[0m
[30;1m310 | [0m[35m[0m
[30;1m311 | [0m[35m        # merge both alerts together so it doesn't matter if messages are out of order[0m

[31m--[ [0m[34mMatch #[0m[33m904[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m256 | [0m[35m    if psid and extended_scan == 'skipped':[0m
[30;1m257 | [0m[35m        try:[0m
[30;1m258 | [0m[35m            # Get errors from parent submission and submission. Strip keys[0m
[30;1m259 | [0m[35m            # to only sha256 and service name. If there are any keys that[0m
[30;1m260 | [0m[35m            # did not exist in the parent the extended scan is 'incomplete'.[0m
[30;1m261 | [0m[35m            ps = datastore.submission.get(psid, as_obj=False) or {}[0m
[30;1m262 | [0m[35m            pe = set((x[:x.rfind('.')] for x in ps.get('errors', [])))[0m

[31m--[ [0m[34mMatch #[0m[33m905[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m153 | [0m[35m                    "type": tag_type,[0m
[30;1m154 | [0m[35m                    "subtype": None,[0m
[30;1m155 | [0m[35m                    "verdict": attack['h_type'],[0m
[30;1m156 | [0m[35m                    "value": cat[0m
[30;1m157 | [0m[35m                }[0m
[30;1m158 | [0m[35m            else:[0m
[30;1m159 | [0m[35m                if VERDICT_RANK_MAP[detailed[tag_type][cat]['verdict']] < VERDICT_RANK_MAP[attack['h[0m
[30;1m160 | [0m[35m                    detailed[tag_type][cat]['verdict'] = attack['h_type'][0m

[31m--[ [0m[34mMatch #[0m[33m906[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m148 | [0m[35m        # Process Att&cks categories[0m
[30;1m149 | [0m[35m        for cat in attack['categories']:[0m
[30;1m150 | [0m[35m            tag_type = 'attack_category'[0m
[30;1m151 | [0m[35m            if cat not in detailed[tag_type]:[0m
[30;1m152 | [0m[35m                detailed[tag_type][cat] = {[0m
[30;1m153 | [0m[35m                    "type": tag_type,[0m
[30;1m154 | [0m[35m                    "subtype": None,[0m

[31m--[ [0m[34mMatch #[0m[33m907[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m146 | [0m[35m                detailed[tag_type][item_key]['verdict'] = attack['h_type'][0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m        # Process Att&cks categories[0m
[30;1m149 | [0m[35m        for cat in attack['categories']:[0m
[30;1m150 | [0m[35m            tag_type = 'attack_category'[0m
[30;1m151 | [0m[35m            if cat not in detailed[tag_type]:[0m
[30;1m152 | [0m[35m                detailed[tag_type][cat] = {[0m

[31m--[ [0m[34mMatch #[0m[33m908[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/alerter/processing.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m    if not srecord:[0m
[30;1m112 | [0m[35m        counter.increment('error')[0m
[30;1m113 | [0m[35m        raise SubmissionNotFound(f"Couldn't find submission: {sid}")[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    submission_state = srecord.get('state', 'unknown')[0m
[30;1m116 | [0m[35m    if submission_state != 'completed':[0m

[31m--[ [0m[34mMatch #[0m[33m909[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m913 | [0m[35m[0m
[30;1m914 | [0m[35m                        # Check if we expect no messages, if so pull the queue length ourselves[0m
[30;1m915 | [0m[35m                        # since there is no heartbeat[0m
[30;1m916 | [0m[35m                        if targets.get(profile_name) == 0 and profile.desired_instances == 0 and pro[0m
[30;1m917 | [0m[35m[0m
[30;1m918 | [0m[35m                            if queue_length > 0:[0m
[30;1m919 | [0m[35m                                self.log.info(f"Service at zero instances has messages: "[0m

[31m--[ [0m[34mMatch #[0m[33m910[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m899 | [0m[35m                    lengths = dict(zip(queues, lengths_list))[0m
[30;1m900 | [0m[35m[0m
[30;1m901 | [0m[35m                    for profile_name, profile in self.profiles.items():[0m
[30;1m902 | [0m[35m                        queue_length = lengths.get(profile.queue, 0)[0m
[30;1m903 | [0m[35m[0m
[30;1m904 | [0m[35m                        # Pull out statistics from the metrics regularization[0m
[30;1m905 | [0m[35m                        update = self.state.read(profile_name)[0m

[31m--[ [0m[34mMatch #[0m[33m911[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m861 | [0m[35m[0m
[30;1m862 | [0m[35m        # Include the service containers not counted in the raw numbers because they are pending[0m
[30;1m863 | [0m[35m        for name, pending in self.controller.get_unavailable().items():[0m
[30;1m864 | [0m[35m            profile = self.profiles.get(name)[0m
[30;1m865 | [0m[35m            if not profile or not pending:[0m
[30;1m866 | [0m[35m                continue[0m
[30;1m867 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m912[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m842 | [0m[35m[0m
[30;1m843 | [0m[35m        # Include the service containers not counted in the raw numbers because they are pending[0m
[30;1m844 | [0m[35m        for name, pending in self.controller.get_unavailable().items():[0m
[30;1m845 | [0m[35m            profile = self.profiles.get(name)[0m
[30;1m846 | [0m[35m            if not profile or not pending:[0m
[30;1m847 | [0m[35m                continue[0m
[30;1m848 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m913[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m748 | [0m[35m[0m
[30;1m749 | [0m[35m                    raw_targets = self.controller.get_targets()[0m
[30;1m750 | [0m[35m                    # This is the list of targets we will adjust[0m
[30;1m751 | [0m[35m                    targets = {_p.name: raw_targets.get(_p.name, 0) for _p in all_profiles.values()}[0m
[30;1m752 | [0m[35m                    # This represents what the environment is currently running[0m
[30;1m753 | [0m[35m                    old_targets = dict(targets)[0m
[30;1m754 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m914[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m674 | [0m[35m                        profile.privileged = service.privileged[0m
[30;1m675 | [0m[35m[0m
[30;1m676 | [0m[35m                        for dependency_name, dependency_blob in dependency_blobs.items():[0m
[30;1m677 | [0m[35m                            if profile.dependency_blobs.get(dependency_name, '') != dependency_blob:[0m
[30;1m678 | [0m[35m                                self.log.info(f"Updating deployment information for {name}/{dependen[0m
[30;1m679 | [0m[35m                                profile.dependency_blobs[dependency_name] = dependency_blob[0m
[30;1m680 | [0m[35m                                self.controller.start_stateful_container([0m

[31m--[ [0m[34mMatch #[0m[33m915[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m625 | [0m[35m                        container_name=_n,[0m
[30;1m626 | [0m[35m                        spec=dependency,[0m
[30;1m627 | [0m[35m                        labels={'dependency_for': service.name},[0m
[30;1m628 | [0m[35m                        change_key=dependency_blobs.get(_n, '')[0m
[30;1m629 | [0m[35m                    )[0m
[30;1m630 | [0m[35m[0m
[30;1m631 | [0m[35m            # If the conditions for running are met deploy or update service containers[0m

[31m--[ [0m[34mMatch #[0m[33m916[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m616 | [0m[35m                    stage = ServiceStage.Running[0m
[30;1m617 | [0m[35m[0m
[30;1m618 | [0m[35m                for _n, dependency in dependency_config.items():[0m
[30;1m619 | [0m[35m                    if dependency_keys.get(_n):[0m
[30;1m620 | [0m[35m                        # Dependency already exists, skip[0m
[30;1m621 | [0m[35m                        continue[0m
[30;1m622 | [0m[35m                    self.log.info(f'Launching {service.name} dependency {_n}')[0m

[31m--[ [0m[34mMatch #[0m[33m917[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m591 | [0m[35m            if service.update_config:[0m
[30;1m592 | [0m[35m                for _n, dependency in dependency_config.items():[0m
[30;1m593 | [0m[35m                    key = self.controller.stateful_container_key(service.name, _n, dependency,[0m
[30;1m594 | [0m[35m                                                                 dependency_blobs.get(_n, ''))[0m
[30;1m595 | [0m[35m                    if key:[0m
[30;1m596 | [0m[35m                        dependency_keys[_n] = _n + key[0m
[30;1m597 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m918[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m486 | [0m[35m                        for service, profile in self.profiles.items():[0m
[30;1m487 | [0m[35m                            # Assume there was no backlog initially if the service is new since last[0m
[30;1m488 | [0m[35m                            last_synced_backlog = 0[0m
[30;1m489 | [0m[35m                            if last_synced_profiles.get(service):[0m
[30;1m490 | [0m[35m                                 last_synced_backlog = last_synced_profiles[service].backlog[0m
[30;1m491 | [0m[35m[0m
[30;1m492 | [0m[35m                            # Check to see if the backlog has increased and if the service has been [0m

[31m--[ [0m[34mMatch #[0m[33m919[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m278 | [0m[35m[0m
[30;1m279 | [0m[35m        # Limit secrets to be shared to very specific configurations[0m
[30;1m280 | [0m[35m        for cfg in ["datastore.hosts", "filestore.archive", "filestore.cache", "filestore.storage"]:[0m
[30;1m281 | [0m[35m            for conn_str in flattened_config.get(cfg, []):[0m
[30;1m282 | [0m[35m                # Look for any secrets that need to passed onto services via env[0m
[30;1m283 | [0m[35m                for secret in Template(conn_str).get_identifiers():[0m
[30;1m284 | [0m[35m                    try:[0m

[31m--[ [0m[34mMatch #[0m[33m920[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m# An environment variable that should be set when we are started with kubernetes, tells us how to at[0m
[30;1m61 | [0m[35m# the global Assemblyline config to new things that we launch.[0m
[30;1m62 | [0m[35mKUBERNETES_AL_CONFIG = os.environ.get('KUBERNETES_AL_CONFIG')[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35mHOSTNAME = os.getenv('HOSTNAME', platform.node())[0m
[30;1m65 | [0m[35mRELEASE_NAME = os.getenv('RELEASE_NAME', 'assemblyline')[0m

[31m--[ [0m[34mMatch #[0m[33m921[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m916 | [0m[35m                        if targets.get(profile_name) == 0 and profile.desired_instances == 0 and pro[0m
[30;1m917 | [0m[35m[0m
[30;1m918 | [0m[35m                            if queue_length > 0:[0m
[30;1m919 | [0m[35m                                self.log.info(f"Service at zero instances has messages: "[0m
[30;1m920 | [0m[35m                                              f"{profile.name} ({queue_length} in queue)")[0m
[30;1m921 | [0m[35m                            profile.update([0m
[30;1m922 | [0m[35m                                delta=export_interval,[0m

[31m--[ [0m[34mMatch #[0m[33m922[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m902 | [0m[35m                        queue_length = lengths.get(profile.queue, 0)[0m
[30;1m903 | [0m[35m[0m
[30;1m904 | [0m[35m                        # Pull out statistics from the metrics regularization[0m
[30;1m905 | [0m[35m                        update = self.state.read(profile_name)[0m
[30;1m906 | [0m[35m                        if update:[0m
[30;1m907 | [0m[35m                            delta = time.time() - profile.last_update[0m
[30;1m908 | [0m[35m                            profile.update([0m

[31m--[ [0m[34mMatch #[0m[33m923[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m889 | [0m[35m                with self.profiles_lock:[0m
[30;1m890 | [0m[35m                    targets = {name: profile.target_instances for name, profile in self.profiles.ite[0m
[30;1m891 | [0m[35m[0m
[30;1m892 | [0m[35m                # Check the set of services that might be sitting at zero instances, and if it is, w[0m
[30;1m893 | [0m[35m                # manually check if it is offline[0m
[30;1m894 | [0m[35m                export_interval = self.config.core.metrics.export_interval[0m
[30;1m895 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m924[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m808 | [0m[35m                    # TODO do we need to add balancing metrics other than 'least running' for this? [0m
[30;1m809 | [0m[35m                    remaining_profiles.sort(key=lambda _p: targets[_p.name])[0m
[30;1m810 | [0m[35m[0m
[30;1m811 | [0m[35m                    # Add one for the profile at the bottom[0m
[30;1m812 | [0m[35m                    free_memory -= remaining_profiles[0].container_config.ram_mb[0m
[30;1m813 | [0m[35m                    free_cpu -= remaining_profiles[0].container_config.cpu_cores[0m
[30;1m814 | [0m[35m                    targets[remaining_profiles[0].name] += 1[0m

[31m--[ [0m[34mMatch #[0m[33m925[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m666 | [0m[35m                            privileged=service.privileged[0m
[30;1m667 | [0m[35m                        ))[0m
[30;1m668 | [0m[35m[0m
[30;1m669 | [0m[35m                    # Update RAM, CPU, licence requirements for running services[0m
[30;1m670 | [0m[35m                    else:[0m
[30;1m671 | [0m[35m                        profile = self.profiles[name][0m
[30;1m672 | [0m[35m                        profile.min_instances = min_instances[0m

[31m--[ [0m[34mMatch #[0m[33m926[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m631 | [0m[35m            # If the conditions for running are met deploy or update service containers[0m
[30;1m632 | [0m[35m            if stage == ServiceStage.Running:[0m
[30;1m633 | [0m[35m                # Build the docker config for the service, we are going to either create it or[0m
[30;1m634 | [0m[35m                # update it so we need to know what the current configuration is either way[0m
[30;1m635 | [0m[35m                docker_config = prepare_container(service.docker_config)[0m
[30;1m636 | [0m[35m[0m
[30;1m637 | [0m[35m                # Compute a blob of service properties not include in the docker config, that[0m

[31m--[ [0m[34mMatch #[0m[33m927[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m628 | [0m[35m                        change_key=dependency_blobs.get(_n, '')[0m
[30;1m629 | [0m[35m                    )[0m
[30;1m630 | [0m[35m[0m
[30;1m631 | [0m[35m            # If the conditions for running are met deploy or update service containers[0m
[30;1m632 | [0m[35m            if stage == ServiceStage.Running:[0m
[30;1m633 | [0m[35m                # Build the docker config for the service, we are going to either create it or[0m
[30;1m634 | [0m[35m                # update it so we need to know what the current configuration is either way[0m

[31m--[ [0m[34mMatch #[0m[33m928[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m610 | [0m[35m[0m
[30;1m611 | [0m[35m            # If dependency container(s) are missing, start the setup process[0m
[30;1m612 | [0m[35m            if set(dependency_keys.keys()) != set(dependency_config.keys()):[0m
[30;1m613 | [0m[35m                # Services that don't need to wait for an update can be declared ready[0m
[30;1m614 | [0m[35m                if service.update_config and not service.update_config.wait_for_update:[0m
[30;1m615 | [0m[35m                    self._service_stage_hash.set(name, ServiceStage.Running)[0m
[30;1m616 | [0m[35m                    stage = ServiceStage.Running[0m

[31m--[ [0m[34mMatch #[0m[33m929[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m595 | [0m[35m                    if key:[0m
[30;1m596 | [0m[35m                        dependency_keys[_n] = _n + key[0m
[30;1m597 | [0m[35m            else:[0m
[30;1m598 | [0m[35m                # Services without an update configuration are born ready[0m
[30;1m599 | [0m[35m                self._service_stage_hash.set(name, ServiceStage.Running)[0m
[30;1m600 | [0m[35m                stage = ServiceStage.Running[0m
[30;1m601 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m930[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m495 | [0m[35m                                # Restart the service in an attempt to resolve intermittent issues w[0m
[30;1m496 | [0m[35m                                self.controller.restart(profile)[0m
[30;1m497 | [0m[35m[0m
[30;1m498 | [0m[35m                    # Update the last synced profiles for next time[0m
[30;1m499 | [0m[35m                    last_synced_profiles = self.profiles[0m
[30;1m500 | [0m[35m[0m
[30;1m501 | [0m[35m                discovered_services: list[str] = [][0m

[31m--[ [0m[34mMatch #[0m[33m931[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m220 | [0m[35m        leak = min(self.leak_rate * delta, abs(self.pressure))[0m
[30;1m221 | [0m[35m        self.pressure = math.copysign(abs(self.pressure) - leak, self.pressure)[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m        # When we are already at the minimum number of instances, don't let negative values build up[0m
[30;1m224 | [0m[35m        # otherwise this can cause irregularities in scaling response around the min_instances[0m
[30;1m225 | [0m[35m        if self.desired_instances == self.min_instances:[0m
[30;1m226 | [0m[35m            self.pressure = max(0.0, self.pressure)[0m

[31m--[ [0m[34mMatch #[0m[33m932[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m54 | [0m[35mHEARTBEAT_INTERVAL = 5[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m# The maximum containers we ask to be created in a single scaling iteration[0m
[30;1m57 | [0m[35m# This is to give kubernetes a chance to update our view of resource usage before we ask for more co[0m
[30;1m58 | [0m[35mMAX_CONTAINER_ALLOCATION = 10[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m# An environment variable that should be set when we are started with kubernetes, tells us how to at[0m

[31m--[ [0m[34mMatch #[0m[33m933[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m985 | [0m[35m                                    counter_type='scaler', config=self.config, redis=self.redis)[0m
[30;1m986 | [0m[35m[0m
[30;1m987 | [0m[35m    def log_container_events(self):[0m
[30;1m988 | [0m[35m        """The service status table may have references to containers that have crashed. Try to remo[0m
[30;1m989 | [0m[35m        while self.sleep(CONTAINER_EVENTS_LOG_INTERVAL):[0m
[30;1m990 | [0m[35m            with apm_span(self.apm_client, 'log_container_events'):[0m
[30;1m991 | [0m[35m                for message in self.controller.new_events():[0m

[31m--[ [0m[34mMatch #[0m[33m934[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m950 | [0m[35m                    for _f in finished:[0m
[30;1m951 | [0m[35m                        exception = _f.exception()[0m
[30;1m952 | [0m[35m                        if exception is not None:[0m
[30;1m953 | [0m[35m                            self.log.error(f"Exception trying to stop timed out service container: {[0m
[30;1m954 | [0m[35m[0m
[30;1m955 | [0m[35m    def export_metrics(self):[0m
[30;1m956 | [0m[35m        while self.sleep(self.config.logging.export_interval):[0m

[31m--[ [0m[34mMatch #[0m[33m935[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m941 | [0m[35m[0m
[30;1m942 | [0m[35m                with apm_span(self.apm_client, 'process_timeouts'):[0m
[30;1m943 | [0m[35m                    # Process new messages[0m
[30;1m944 | [0m[35m                    self.log.info(f"Killing service container: {message['container']} running: {mess[0m
[30;1m945 | [0m[35m                    futures.append(pool.submit(self._timeout_kill, message['service'], message['cont[0m
[30;1m946 | [0m[35m[0m
[30;1m947 | [0m[35m                    # Process finished[0m

[31m--[ [0m[34mMatch #[0m[33m936[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m911 | [0m[35m                                **update[0m
[30;1m912 | [0m[35m                            )[0m
[30;1m913 | [0m[35m[0m
[30;1m914 | [0m[35m                        # Check if we expect no messages, if so pull the queue length ourselves[0m
[30;1m915 | [0m[35m                        # since there is no heartbeat[0m
[30;1m916 | [0m[35m                        if targets.get(profile_name) == 0 and profile.desired_instances == 0 and pro[0m
[30;1m917 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m937[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m873 | [0m[35m        """Check if there are any pub-sub messages we need."""[0m
[30;1m874 | [0m[35m        while self.sleep(METRIC_SYNC_INTERVAL):[0m
[30;1m875 | [0m[35m            with apm_span(self.apm_client, 'sync_metrics'):[0m
[30;1m876 | [0m[35m                # Pull service metrics from redis[0m
[30;1m877 | [0m[35m                service_data = self.status_table.items()[0m
[30;1m878 | [0m[35m                for host, (service, state, time_limit) in service_data.items():[0m
[30;1m879 | [0m[35m                    # If an entry hasn't expired, take it into account[0m

[31m--[ [0m[34mMatch #[0m[33m938[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m859 | [0m[35m            used_memory = total_memory - free_memory[0m
[30;1m860 | [0m[35m            free_memory = total_memory * self.get_memory_overallocation() - used_memory[0m
[30;1m861 | [0m[35m[0m
[30;1m862 | [0m[35m        # Include the service containers not counted in the raw numbers because they are pending[0m
[30;1m863 | [0m[35m        for name, pending in self.controller.get_unavailable().items():[0m
[30;1m864 | [0m[35m            profile = self.profiles.get(name)[0m
[30;1m865 | [0m[35m            if not profile or not pending:[0m

[31m--[ [0m[34mMatch #[0m[33m939[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m840 | [0m[35m            used_cpu = total_cpu - free_cpu[0m
[30;1m841 | [0m[35m            free_cpu = total_cpu * self.get_cpu_overallocation() - used_cpu[0m
[30;1m842 | [0m[35m[0m
[30;1m843 | [0m[35m        # Include the service containers not counted in the raw numbers because they are pending[0m
[30;1m844 | [0m[35m        for name, pending in self.controller.get_unavailable().items():[0m
[30;1m845 | [0m[35m            profile = self.profiles.get(name)[0m
[30;1m846 | [0m[35m            if not profile or not pending:[0m

[31m--[ [0m[34mMatch #[0m[33m940[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m828 | [0m[35m                            old = old_targets[name][0m
[30;1m829 | [0m[35m[0m
[30;1m830 | [0m[35m                            if value != old:[0m
[30;1m831 | [0m[35m                                self.log.info(f"Scaling service {name}: {old} -> {value}")[0m
[30;1m832 | [0m[35m                                pool.call(self.controller.set_target, name, value)[0m
[30;1m833 | [0m[35m[0m
[30;1m834 | [0m[35m    def get_cpu_info(self, overallocation: bool) -> tuple[float, float]:[0m

[31m--[ [0m[34mMatch #[0m[33m941[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m821 | [0m[35m                    with pool:[0m
[30;1m822 | [0m[35m                        for name, value in targets.items():[0m
[30;1m823 | [0m[35m                            if name not in self.profiles:[0m
[30;1m824 | [0m[35m                                # A service was probably added/removed while we were[0m
[30;1m825 | [0m[35m                                # in the middle of this function[0m
[30;1m826 | [0m[35m                                continue[0m
[30;1m827 | [0m[35m                            self.profiles[name].target_instances = value[0m

[31m--[ [0m[34mMatch #[0m[33m942[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m785 | [0m[35m                #   3.  Try to estimate available resources, and based on some metric grant the[0m
[30;1m786 | [0m[35m                #       resources to each service that wants them. While this free memory[0m
[30;1m787 | [0m[35m                #       pool might be spread across many nodes, we are going to treat it like[0m
[30;1m788 | [0m[35m                #       it is one big one, and let the orchestration layer sort out the details.[0m
[30;1m789 | [0m[35m                #[0m
[30;1m790 | [0m[35m[0m
[30;1m791 | [0m[35m                # Get the processed resource numbers[0m

[31m--[ [0m[34mMatch #[0m[33m943[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m783 | [0m[35m[0m
[30;1m784 | [0m[35m                #[0m
[30;1m785 | [0m[35m                #   3.  Try to estimate available resources, and based on some metric grant the[0m
[30;1m786 | [0m[35m                #       resources to each service that wants them. While this free memory[0m
[30;1m787 | [0m[35m                #       pool might be spread across many nodes, we are going to treat it like[0m
[30;1m788 | [0m[35m                #       it is one big one, and let the orchestration layer sort out the details.[0m
[30;1m789 | [0m[35m                #[0m

[31m--[ [0m[34mMatch #[0m[33m944[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m739 | [0m[35m                # Figure out what services are expected to be running and how many[0m
[30;1m740 | [0m[35m                with elasticapm.capture_span('read_profiles'):[0m
[30;1m741 | [0m[35m                    with self.profiles_lock:[0m
[30;1m742 | [0m[35m                        # We want to evaluate 'active' service profiles[0m
[30;1m743 | [0m[35m                        all_profiles: dict[str, ServiceProfile] = {[0m
[30;1m744 | [0m[35m                            _n: copy.deepcopy(_v)[0m
[30;1m745 | [0m[35m                            for _n, _v in self.profiles.items()[0m

[31m--[ [0m[34mMatch #[0m[33m945[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m709 | [0m[35m            # Clear related dependency caching from Redis[0m
[30;1m710 | [0m[35m            Hash(f'service-updates-{name}', self.redis_persist).delete()[0m
[30;1m711 | [0m[35m[0m
[30;1m712 | [0m[35m            # Mark this service as not running in the shared record[0m
[30;1m713 | [0m[35m            self._service_stage_hash.set(name, ServiceStage.Off)[0m
[30;1m714 | [0m[35m[0m
[30;1m715 | [0m[35m        # Stop any running disabled services[0m

[31m--[ [0m[34mMatch #[0m[33m946[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m696 | [0m[35m                self.log.info(f"System has deemed {name} not ready/running. Scaling down..")[0m
[30;1m697 | [0m[35m                self.controller.set_target(name, 0)[0m
[30;1m698 | [0m[35m        except Exception:[0m
[30;1m699 | [0m[35m            self.log.exception(f"Error applying service settings from: {service.name}")[0m
[30;1m700 | [0m[35m[0m
[30;1m701 | [0m[35m    @elasticapm.capture_span(span_type=APM_SPAN_TYPE)[0m
[30;1m702 | [0m[35m    def stop_service(self, name: str, current_stage: ServiceStage):[0m

[31m--[ [0m[34mMatch #[0m[33m947[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m691 | [0m[35m                            profile.config_blob = config_blob[0m
[30;1m692 | [0m[35m                            self.controller.restart(profile)[0m
[30;1m693 | [0m[35m                            self.log.info(f"Deployment information for {name} replaced")[0m
[30;1m694 | [0m[35m            # If service has already been scaled but is not running, scale down until ready[0m
[30;1m695 | [0m[35m            elif name in self.profiles:[0m
[30;1m696 | [0m[35m                self.log.info(f"System has deemed {name} not ready/running. Scaling down..")[0m
[30;1m697 | [0m[35m                self.controller.set_target(name, 0)[0m

[31m--[ [0m[34mMatch #[0m[33m948[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m661 | [0m[35m                            max_instances=service.licence_count,[0m
[30;1m662 | [0m[35m                            container_config=docker_config,[0m
[30;1m663 | [0m[35m                            queue=get_service_queue(name, self.redis),[0m
[30;1m664 | [0m[35m                            # Give service an extra 30 seconds to upload results[0m
[30;1m665 | [0m[35m                            shutdown_seconds=service.timeout + 30,[0m
[30;1m666 | [0m[35m                            privileged=service.privileged[0m
[30;1m667 | [0m[35m                        ))[0m

[31m--[ [0m[34mMatch #[0m[33m949[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m641 | [0m[35m                config_blob = (f"c={cfg_items}sp={service.submission_params}"[0m
[30;1m642 | [0m[35m                               f"dk={dep_keys}p={service.privileged}d={docker_config}ssl={INTERNAL_E[0m
[30;1m643 | [0m[35m[0m
[30;1m644 | [0m[35m                # Add the service to the list of services being scaled[0m
[30;1m645 | [0m[35m                with self.profiles_lock:[0m
[30;1m646 | [0m[35m                    min_instances = default_settings.min_instances[0m
[30;1m647 | [0m[35m                    if service.min_instances is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m950[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m635 | [0m[35m                docker_config = prepare_container(service.docker_config)[0m
[30;1m636 | [0m[35m[0m
[30;1m637 | [0m[35m                # Compute a blob of service properties not include in the docker config, that[0m
[30;1m638 | [0m[35m                # should still result in a service being restarted when changed[0m
[30;1m639 | [0m[35m                cfg_items = get_recursive_sorted_tuples(service.config)[0m
[30;1m640 | [0m[35m                dep_keys = ''.join(sorted(dependency_keys.values()))[0m
[30;1m641 | [0m[35m                config_blob = (f"c={cfg_items}sp={service.submission_params}"[0m

[31m--[ [0m[34mMatch #[0m[33m951[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m634 | [0m[35m                # update it so we need to know what the current configuration is either way[0m
[30;1m635 | [0m[35m                docker_config = prepare_container(service.docker_config)[0m
[30;1m636 | [0m[35m[0m
[30;1m637 | [0m[35m                # Compute a blob of service properties not include in the docker config, that[0m
[30;1m638 | [0m[35m                # should still result in a service being restarted when changed[0m
[30;1m639 | [0m[35m                cfg_items = get_recursive_sorted_tuples(service.config)[0m
[30;1m640 | [0m[35m                dep_keys = ''.join(sorted(dependency_keys.values()))[0m

[31m--[ [0m[34mMatch #[0m[33m952[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m634 | [0m[35m                # update it so we need to know what the current configuration is either way[0m
[30;1m635 | [0m[35m                docker_config = prepare_container(service.docker_config)[0m
[30;1m636 | [0m[35m[0m
[30;1m637 | [0m[35m                # Compute a blob of service properties not include in the docker config, that[0m
[30;1m638 | [0m[35m                # should still result in a service being restarted when changed[0m
[30;1m639 | [0m[35m                cfg_items = get_recursive_sorted_tuples(service.config)[0m
[30;1m640 | [0m[35m                dep_keys = ''.join(sorted(dependency_keys.values()))[0m

[31m--[ [0m[34mMatch #[0m[33m953[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m630 | [0m[35m[0m
[30;1m631 | [0m[35m            # If the conditions for running are met deploy or update service containers[0m
[30;1m632 | [0m[35m            if stage == ServiceStage.Running:[0m
[30;1m633 | [0m[35m                # Build the docker config for the service, we are going to either create it or[0m
[30;1m634 | [0m[35m                # update it so we need to know what the current configuration is either way[0m
[30;1m635 | [0m[35m                docker_config = prepare_container(service.docker_config)[0m
[30;1m636 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m954[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m628 | [0m[35m                        change_key=dependency_blobs.get(_n, '')[0m
[30;1m629 | [0m[35m                    )[0m
[30;1m630 | [0m[35m[0m
[30;1m631 | [0m[35m            # If the conditions for running are met deploy or update service containers[0m
[30;1m632 | [0m[35m            if stage == ServiceStage.Running:[0m
[30;1m633 | [0m[35m                # Build the docker config for the service, we are going to either create it or[0m
[30;1m634 | [0m[35m                # update it so we need to know what the current configuration is either way[0m

[31m--[ [0m[34mMatch #[0m[33m955[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m601 | [0m[35m[0m
[30;1m602 | [0m[35m            self.log.info(f'Preparing environment for {service.name}')[0m
[30;1m603 | [0m[35m[0m
[30;1m604 | [0m[35m            # Configure the necessary network policies for the service and it's dependencies, if app[0m
[30;1m605 | [0m[35m            dependency_internet = [(name, dependency.container.allow_internet_access)[0m
[30;1m606 | [0m[35m                                   for name, dependency in dependency_config.items()][0m
[30;1m607 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m956[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m586 | [0m[35m                dep_hash = get_id_from_data(dependency, length=16)[0m
[30;1m587 | [0m[35m                dependency_blobs[_n] = f"dh={dep_hash}v={service.version}p={service.privileged}ssl={[0m
[30;1m588 | [0m[35m[0m
[30;1m589 | [0m[35m            # Check if the service dependencies have been deployed.[0m
[30;1m590 | [0m[35m            dependency_keys = dict()[0m
[30;1m591 | [0m[35m            if service.update_config:[0m
[30;1m592 | [0m[35m                for _n, dependency in dependency_config.items():[0m

[31m--[ [0m[34mMatch #[0m[33m957[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m576 | [0m[35m            # Build the docker config for the dependencies. For now the dependency blob values[0m
[30;1m577 | [0m[35m            # aren't set for the change key going to kubernetes because everything about[0m
[30;1m578 | [0m[35m            # the dependency config should be captured in change key that the function generates[0m
[30;1m579 | [0m[35m            # internally. A change key is set for the service deployment as that includes[0m
[30;1m580 | [0m[35m            # things like the submission params[0m
[30;1m581 | [0m[35m            dependency_config: dict[str, Any] = {}[0m
[30;1m582 | [0m[35m            dependency_blobs: dict[str, str] = {}[0m

[31m--[ [0m[34mMatch #[0m[33m958[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m573 | [0m[35m                self.stop_service(service.name, stage)[0m
[30;1m574 | [0m[35m                return[0m
[30;1m575 | [0m[35m[0m
[30;1m576 | [0m[35m            # Build the docker config for the dependencies. For now the dependency blob values[0m
[30;1m577 | [0m[35m            # aren't set for the change key going to kubernetes because everything about[0m
[30;1m578 | [0m[35m            # the dependency config should be captured in change key that the function generates[0m
[30;1m579 | [0m[35m            # internally. A change key is set for the service deployment as that includes[0m

[31m--[ [0m[34mMatch #[0m[33m959[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m566 | [0m[35m                # All signatures sources from a signature-dependent service was removed[0m
[30;1m567 | [0m[35m                # Disable and treat it as incompatible due to service configuration relative to sour[0m
[30;1m568 | [0m[35m                self.log.warning("Disabling service with incompatible service configuration. "[0m
[30;1m569 | [0m[35m                                 "Signature-dependent service has no signature sources.")[0m
[30;1m570 | [0m[35m                disable_incompatible_service()[0m
[30;1m571 | [0m[35m[0m
[30;1m572 | [0m[35m            if not service.enabled:[0m

[31m--[ [0m[34mMatch #[0m[33m960[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m565 | [0m[35m            elif service.update_config and service.update_config.wait_for_update and not service.upd[0m
[30;1m566 | [0m[35m                # All signatures sources from a signature-dependent service was removed[0m
[30;1m567 | [0m[35m                # Disable and treat it as incompatible due to service configuration relative to sour[0m
[30;1m568 | [0m[35m                self.log.warning("Disabling service with incompatible service configuration. "[0m
[30;1m569 | [0m[35m                                 "Signature-dependent service has no signature sources.")[0m
[30;1m570 | [0m[35m                disable_incompatible_service()[0m
[30;1m571 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m961[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m565 | [0m[35m            elif service.update_config and service.update_config.wait_for_update and not service.upd[0m
[30;1m566 | [0m[35m                # All signatures sources from a signature-dependent service was removed[0m
[30;1m567 | [0m[35m                # Disable and treat it as incompatible due to service configuration relative to sour[0m
[30;1m568 | [0m[35m                self.log.warning("Disabling service with incompatible service configuration. "[0m
[30;1m569 | [0m[35m                                 "Signature-dependent service has no signature sources.")[0m
[30;1m570 | [0m[35m                disable_incompatible_service()[0m
[30;1m571 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m962[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m564 | [0m[35m                disable_incompatible_service()[0m
[30;1m565 | [0m[35m            elif service.update_config and service.update_config.wait_for_update and not service.upd[0m
[30;1m566 | [0m[35m                # All signatures sources from a signature-dependent service was removed[0m
[30;1m567 | [0m[35m                # Disable and treat it as incompatible due to service configuration relative to sour[0m
[30;1m568 | [0m[35m                self.log.warning("Disabling service with incompatible service configuration. "[0m
[30;1m569 | [0m[35m                                 "Signature-dependent service has no signature sources.")[0m
[30;1m570 | [0m[35m                disable_incompatible_service()[0m

[31m--[ [0m[34mMatch #[0m[33m963[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m563 | [0m[35mrvice.version} != '{system_spec}.X.{service.update_channel}Y'].")[0m
[30;1m564 | [0m[35m                disable_incompatible_service()[0m
[30;1m565 | [0m[35m            elif service.update_config and service.update_config.wait_for_update and not service.upd[0m
[30;1m566 | [0m[35m                # All signatures sources from a signature-dependent service was removed[0m
[30;1m567 | [0m[35m                # Disable and treat it as incompatible due to service configuration relative to sour[0m
[30;1m568 | [0m[35m                self.log.warning("Disabling service with incompatible service configuration. "[0m

[31m--[ [0m[34mMatch #[0m[33m964[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m558 | [0m[35m            system_spec = f'{FRAMEWORK_VERSION}.{SYSTEM_VERSION}'[0m
[30;1m559 | [0m[35m            if not service.version.startswith(system_spec):[0m
[30;1m560 | [0m[35m                # If FW and SYS version don't prefix in the service version, we can't guarantee the[0m
[30;1m561 | [0m[35m                # service is compatible. Disable and treat it as incompatible due to service version[0m
[30;1m562 | [0m[35m                self.log.warning(f"Disabling {service.name} with incompatible version. "[0m
[30;1m563 | [0m[35m                                 f"[{service.version} != '{system_spec}.X.{service.update_channel}Y'[0m
[30;1m564 | [0m[35m                disable_incompatible_service()[0m

[31m--[ [0m[34mMatch #[0m[33m965[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m558 | [0m[35m            system_spec = f'{FRAMEWORK_VERSION}.{SYSTEM_VERSION}'[0m
[30;1m559 | [0m[35m            if not service.version.startswith(system_spec):[0m
[30;1m560 | [0m[35m                # If FW and SYS version don't prefix in the service version, we can't guarantee the[0m
[30;1m561 | [0m[35m                # service is compatible. Disable and treat it as incompatible due to service version[0m
[30;1m562 | [0m[35m                self.log.warning(f"Disabling {service.name} with incompatible version. "[0m
[30;1m563 | [0m[35m                                 f"[{service.version} != '{system_spec}.X.{service.update_channel}Y'[0m
[30;1m564 | [0m[35m                disable_incompatible_service()[0m

[31m--[ [0m[34mMatch #[0m[33m966[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m557 | [0m[35m            # Check if service considered compatible to run on Assemblyline?[0m
[30;1m558 | [0m[35m            system_spec = f'{FRAMEWORK_VERSION}.{SYSTEM_VERSION}'[0m
[30;1m559 | [0m[35m            if not service.version.startswith(system_spec):[0m
[30;1m560 | [0m[35m                # If FW and SYS version don't prefix in the service version, we can't guarantee the[0m
[30;1m561 | [0m[35m                # service is compatible. Disable and treat it as incompatible due to service version[0m
[30;1m562 | [0m[35m                self.log.warning(f"Disabling {service.name} with incompatible version. "[0m
[30;1m563 | [0m[35m                                 f"[{service.version} != '{system_spec}.X.{service.update_channel}Y'[0m

[31m--[ [0m[34mMatch #[0m[33m967[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m554 | [0m[35m                        'name': service.name[0m
[30;1m555 | [0m[35m                    })[0m
[30;1m556 | [0m[35m[0m
[30;1m557 | [0m[35m            # Check if service considered compatible to run on Assemblyline?[0m
[30;1m558 | [0m[35m            system_spec = f'{FRAMEWORK_VERSION}.{SYSTEM_VERSION}'[0m
[30;1m559 | [0m[35m            if not service.version.startswith(system_spec):[0m
[30;1m560 | [0m[35m                # If FW and SYS version don't prefix in the service version, we can't guarantee the[0m

[31m--[ [0m[34mMatch #[0m[33m968[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m548 | [0m[35m                service.enabled = False[0m
[30;1m549 | [0m[35m                if self.datastore.service_delta.update(service.name,[0m
[30;1m550 | [0m[35m                                                       [(self.datastore.service_delta.UPDATE_SET, 'e[0m
[30;1m551 | [0m[35m                    # Raise awareness to other components by sending an event for the service[0m
[30;1m552 | [0m[35m                    self.service_event_sender.send(service.name, {[0m
[30;1m553 | [0m[35m                        'operation': Operation.Incompatible,[0m
[30;1m554 | [0m[35m                        'name': service.name[0m
[30;1m555 | [0m[35m                    })[0m

[31m--[ [0m[34mMatch #[0m[33m969[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m520 | [0m[35m        """[0m
[30;1m521 | [0m[35m        Synchronize the state of the service in the database with the orchestration environment.[0m
[30;1m522 | [0m[35m[0m
[30;1m523 | [0m[35m        :param service: Service data from the database.[0m
[30;1m524 | [0m[35m        """[0m
[30;1m525 | [0m[35m        name = service.name[0m
[30;1m526 | [0m[35m        stage = self.get_service_stage(service.name)[0m

[31m--[ [0m[34mMatch #[0m[33m970[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m518 | [0m[35m[0m
[30;1m519 | [0m[35m    def _sync_service(self, service: Service):[0m
[30;1m520 | [0m[35m        """[0m
[30;1m521 | [0m[35m        Synchronize the state of the service in the database with the orchestration environment.[0m
[30;1m522 | [0m[35m[0m
[30;1m523 | [0m[35m        :param service: Service data from the database.[0m
[30;1m524 | [0m[35m        """[0m

[31m--[ [0m[34mMatch #[0m[33m971[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m510 | [0m[35m                    self.log.info(f'Service appears to be deleted, removing stray {stray_service}')[0m
[30;1m511 | [0m[35m                    stage = self.get_service_stage(stray_service)[0m
[30;1m512 | [0m[35m                    self.stop_service(stray_service, stage)[0m
[30;1m513 | [0m[35m                self.log.info('Finish synchronizing service configuration')[0m
[30;1m514 | [0m[35m[0m
[30;1m515 | [0m[35m            # Wait for the interval or until someone wakes us up[0m
[30;1m516 | [0m[35m            self.service_watcher_wakeup.wait(timeout=SERVICE_SYNC_INTERVAL)[0m

[31m--[ [0m[34mMatch #[0m[33m972[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m505 | [0m[35m                    self._sync_service(service)[0m
[30;1m506 | [0m[35m                    discovered_services.append(service.name)[0m
[30;1m507 | [0m[35m[0m
[30;1m508 | [0m[35m                # Find any services we have running, that are no longer in the database and remove t[0m
[30;1m509 | [0m[35m                for stray_service in current_services - set(discovered_services):[0m
[30;1m510 | [0m[35m                    self.log.info(f'Service appears to be deleted, removing stray {stray_service}')[0m
[30;1m511 | [0m[35m                    stage = self.get_service_stage(stray_service)[0m

[31m--[ [0m[34mMatch #[0m[33m973[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m501 | [0m[35m                discovered_services: list[str] = [][0m
[30;1m502 | [0m[35m[0m
[30;1m503 | [0m[35m                # Get all the service data[0m
[30;1m504 | [0m[35m                for service in self.datastore.list_all_services(full=True):[0m
[30;1m505 | [0m[35m                    self._sync_service(service)[0m
[30;1m506 | [0m[35m                    discovered_services.append(service.name)[0m
[30;1m507 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m974[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m500 | [0m[35m[0m
[30;1m501 | [0m[35m                discovered_services: list[str] = [][0m
[30;1m502 | [0m[35m[0m
[30;1m503 | [0m[35m                # Get all the service data[0m
[30;1m504 | [0m[35m                for service in self.datastore.list_all_services(full=True):[0m
[30;1m505 | [0m[35m                    self._sync_service(service)[0m
[30;1m506 | [0m[35m                    discovered_services.append(service.name)[0m

[31m--[ [0m[34mMatch #[0m[33m975[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m495 | [0m[35m                                # Restart the service in an attempt to resolve intermittent issues w[0m
[30;1m496 | [0m[35m                                self.controller.restart(profile)[0m
[30;1m497 | [0m[35m[0m
[30;1m498 | [0m[35m                    # Update the last synced profiles for next time[0m
[30;1m499 | [0m[35m                    last_synced_profiles = self.profiles[0m
[30;1m500 | [0m[35m[0m
[30;1m501 | [0m[35m                discovered_services: list[str] = [][0m
[30;1m502 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m976[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m492 | [0m[35m                            # Check to see if the backlog has increased and if the service has been [0m
[30;1m493 | [0m[35m                            if profile.backlog and profile.backlog >= last_synced_backlog and \[0m
[30;1m494 | [0m[35m                                profile.running_instances == 0 and profile.target_instances > 0:[0m
[30;1m495 | [0m[35m                                # Restart the service in an attempt to resolve intermittent issues w[0m
[30;1m496 | [0m[35m                                self.controller.restart(profile)[0m
[30;1m497 | [0m[35m[0m
[30;1m498 | [0m[35m                    # Update the last synced profiles for next time[0m

[31m--[ [0m[34mMatch #[0m[33m977[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m489 | [0m[35m                            if last_synced_profiles.get(service):[0m
[30;1m490 | [0m[35m                                 last_synced_backlog = last_synced_profiles[service].backlog[0m
[30;1m491 | [0m[35m[0m
[30;1m492 | [0m[35m                            # Check to see if the backlog has increased and if the service has been [0m
[30;1m493 | [0m[35m                            if profile.backlog and profile.backlog >= last_synced_backlog and \[0m
[30;1m494 | [0m[35m                                profile.running_instances == 0 and profile.target_instances > 0:[0m
[30;1m495 | [0m[35m                                # Restart the service in an attempt to resolve intermittent issues w[0m

[31m--[ [0m[34mMatch #[0m[33m978[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m484 | [0m[35m                    # Check to see if the service is progressing since it's last sync[0m
[30;1m485 | [0m[35m                    if last_synced_profiles:[0m
[30;1m486 | [0m[35m                        for service, profile in self.profiles.items():[0m
[30;1m487 | [0m[35m                            # Assume there was no backlog initially if the service is new since last[0m
[30;1m488 | [0m[35m                            last_synced_backlog = 0[0m
[30;1m489 | [0m[35m                            if last_synced_profiles.get(service):[0m
[30;1m490 | [0m[35m                                 last_synced_backlog = last_synced_profiles[service].backlog[0m

[31m--[ [0m[34mMatch #[0m[33m979[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m481 | [0m[35m                with self.profiles_lock:[0m
[30;1m482 | [0m[35m                    current_services = set(self.profiles.keys())[0m
[30;1m483 | [0m[35m[0m
[30;1m484 | [0m[35m                    # Check to see if the service is progressing since it's last sync[0m
[30;1m485 | [0m[35m                    if last_synced_profiles:[0m
[30;1m486 | [0m[35m                        for service, profile in self.profiles.items():[0m
[30;1m487 | [0m[35m                            # Assume there was no backlog initially if the service is new since last[0m

[31m--[ [0m[34mMatch #[0m[33m980[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m477 | [0m[35m        last_synced_profiles = None[0m
[30;1m478 | [0m[35m        while self.running:[0m
[30;1m479 | [0m[35m            with apm_span(self.apm_client, 'sync_services'):[0m
[30;1m480 | [0m[35m                self.log.info('Synchronizing service configuration')[0m
[30;1m481 | [0m[35m                with self.profiles_lock:[0m
[30;1m482 | [0m[35m                    current_services = set(self.profiles.keys())[0m
[30;1m483 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m981[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m467 | [0m[35m            elif data.operation == Operation.Incompatible:[0m
[30;1m468 | [0m[35m                return[0m
[30;1m469 | [0m[35m            else:[0m
[30;1m470 | [0m[35m                service = self.datastore.get_service_with_delta(data.name)[0m
[30;1m471 | [0m[35m                if not service:[0m
[30;1m472 | [0m[35m                    self.log.warning(f'Received change event for non-existent service: {data.name}. [0m
[30;1m473 | [0m[35m                    return[0m

[31m--[ [0m[34mMatch #[0m[33m982[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m434 | [0m[35m            profile.desired_instances = max(self.controller.get_target(profile.name), profile.min_in[0m
[30;1m435 | [0m[35m            profile.running_instances = profile.desired_instances[0m
[30;1m436 | [0m[35m            profile.target_instances = profile.desired_instances[0m
[30;1m437 | [0m[35m            self.log.debug(f'Starting service {profile.name} with a target of {profile.desired_insta[0m
[30;1m438 | [0m[35m            profile.last_update = time.time()[0m
[30;1m439 | [0m[35m            self.profiles[profile.name] = profile[0m
[30;1m440 | [0m[35m            self.controller.add_profile(profile, scale=profile.desired_instances)[0m

[31m--[ [0m[34mMatch #[0m[33m983[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m427 | [0m[35m[0m
[30;1m428 | [0m[35m    @elasticapm.capture_span(span_type=APM_SPAN_TYPE)[0m
[30;1m429 | [0m[35m    def add_service(self, profile: ServiceProfile):[0m
[30;1m430 | [0m[35m        # We need to hold the lock the whole time we add the service,[0m
[30;1m431 | [0m[35m        # we don't want the scaling thread trying to adjust the scale of a[0m
[30;1m432 | [0m[35m        # deployment we haven't added to the system yet[0m
[30;1m433 | [0m[35m        with self.profiles_lock:[0m

[31m--[ [0m[34mMatch #[0m[33m984[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m392 | [0m[35m                self.controller.global_mounts.append((CLASSIFICATION_HOST_PATH, '/etc/assemblyline/c[0m
[30;1m393 | [0m[35m[0m
[30;1m394 | [0m[35m            for mount in service_defaults_config.mounts:[0m
[30;1m395 | [0m[35m                # Mounts are all storage-based since there's no equivalent to ConfigMaps in Docker[0m
[30;1m396 | [0m[35m                if mount.privileged_only:[0m
[30;1m397 | [0m[35m                    self.controller.core_mounts.append((mount.name, mount.path))[0m
[30;1m398 | [0m[35m                else:[0m
[30;1m399 | [0m[35m                    self.controller.global_mounts.append((mount.name, mount.path))[0m

[31m--[ [0m[34mMatch #[0m[33m985[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m391 | [0m[35m            if CLASSIFICATION_HOST_PATH:[0m
[30;1m392 | [0m[35m                self.controller.global_mounts.append((CLASSIFICATION_HOST_PATH, '/etc/assemblyline/c[0m
[30;1m393 | [0m[35m[0m
[30;1m394 | [0m[35m            for mount in service_defaults_config.mounts:[0m
[30;1m395 | [0m[35m                # Mounts are all storage-based since there's no equivalent to ConfigMaps in Docker[0m
[30;1m396 | [0m[35m                if mount.privileged_only:[0m
[30;1m397 | [0m[35m                    self.controller.core_mounts.append((mount.name, mount.path))[0m

[31m--[ [0m[34mMatch #[0m[33m986[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m387 | [0m[35m                with open(os.path.join(DOCKER_CONFIGURATION_PATH, 'classification.yml'), 'w') as han[0m
[30;1m388 | [0m[35m                    yaml.dump(get_classification().original_definition, handle)[0m
[30;1m389 | [0m[35m[0m
[30;1m390 | [0m[35m            # If we know where to find it, mount the classification into the service containers[0m
[30;1m391 | [0m[35m            if CLASSIFICATION_HOST_PATH:[0m
[30;1m392 | [0m[35m                self.controller.global_mounts.append((CLASSIFICATION_HOST_PATH, '/etc/assemblyline/c[0m
[30;1m393 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m987[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m387 | [0m[35m                with open(os.path.join(DOCKER_CONFIGURATION_PATH, 'classification.yml'), 'w') as han[0m
[30;1m388 | [0m[35m                    yaml.dump(get_classification().original_definition, handle)[0m
[30;1m389 | [0m[35m[0m
[30;1m390 | [0m[35m            # If we know where to find it, mount the classification into the service containers[0m
[30;1m391 | [0m[35m            if CLASSIFICATION_HOST_PATH:[0m
[30;1m392 | [0m[35m                self.controller.global_mounts.append((CLASSIFICATION_HOST_PATH, '/etc/assemblyline/c[0m
[30;1m393 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m988[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m387 | [0m[35m                with open(os.path.join(DOCKER_CONFIGURATION_PATH, 'classification.yml'), 'w') as han[0m
[30;1m388 | [0m[35m                    yaml.dump(get_classification().original_definition, handle)[0m
[30;1m389 | [0m[35m[0m
[30;1m390 | [0m[35m            # If we know where to find it, mount the classification into the service containers[0m
[30;1m391 | [0m[35m            if CLASSIFICATION_HOST_PATH:[0m
[30;1m392 | [0m[35m                self.controller.global_mounts.append((CLASSIFICATION_HOST_PATH, '/etc/assemblyline/c[0m
[30;1m393 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m989[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m371 | [0m[35m                    self.controller.add_volume_mount(name=mount.name, target_path=mount.path, read_o[0m
[30;1m372 | [0m[35m                                                     core=mount.privileged_only)[0m
[30;1m373 | [0m[35m        else:[0m
[30;1m374 | [0m[35m            self.log.info("Loading Docker cluster interface.")[0m
[30;1m375 | [0m[35m            self.controller = DockerController(logger=self.log, prefix=NAMESPACE,[0m
[30;1m376 | [0m[35m                                               labels=labels, log_level=self.config.logging.log_leve[0m
[30;1m377 | [0m[35m                                               core_env=core_env)[0m

[31m--[ [0m[34mMatch #[0m[33m990[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m367 | [0m[35m                                                     sub_path=mount.resource_key, target_path=mount.[0m
[30;1m368 | [0m[35m                                                     read_only=mount.read_only, core=mount.privilege[0m
[30;1m369 | [0m[35m                elif mount.resource_type == 'volume':[0m
[30;1m370 | [0m[35m                    # Add storage-based mount[0m
[30;1m371 | [0m[35m                    self.controller.add_volume_mount(name=mount.name, target_path=mount.path, read_o[0m
[30;1m372 | [0m[35m                                                     core=mount.privileged_only)[0m
[30;1m373 | [0m[35m        else:[0m
[30;1m374 | [0m[35m            self.log.info("Loading Docker cluster interface.")[0m

[31m--[ [0m[34mMatch #[0m[33m991[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m361 | [0m[35me, key=mount.resource_key,[0m
[30;1m362 | [0m[35m                                                     target_path=mount.path, read_only=mount.read_on[0m
[30;1m363 | [0m[35m                                                     core=mount.privileged_only)[0m
[30;1m364 | [0m[35m                elif mount.resource_type == 'secret':[0m
[30;1m365 | [0m[35m                    # Secret-based mount[0m
[30;1m366 | [0m[35m                    self.controller.add_secret_mount(mount.name, secret_name=mount.resource_name,[0m
[30;1m367 | [0m[35m                                                     sub_path=mount.resource_key, target_path=mount.[0m

[31m--[ [0m[34mMatch #[0m[33m992[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m357 | [0m[35m                    continue[0m
[30;1m358 | [0m[35m[0m
[30;1m359 | [0m[35m                if mount.resource_type == 'configmap':[0m
[30;1m360 | [0m[35m                    # ConfigMap-based mount[0m
[30;1m361 | [0m[35m                    self.controller.add_config_mount(mount.name, config_map=mount.resource_name, key[0m
[30;1m362 | [0m[35m                                                     target_path=mount.path, read_only=mount.read_on[0m
[30;1m363 | [0m[35m                                                     core=mount.privileged_only)[0m
[30;1m364 | [0m[35m                elif mount.resource_type == 'secret':[0m

[31m--[ [0m[34mMatch #[0m[33m993[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m347 | [0m[35m                )))[0m
[30;1m348 | [0m[35m[0m
[30;1m349 | [0m[35m            # Add default mounts for (non-)privileged services[0m
[30;1m350 | [0m[35m            for mount in service_defaults_config.mounts:[0m
[30;1m351 | [0m[35m                # Deprecated configuration for mounting ConfigMap[0m
[30;1m352 | [0m[35m                # TODO: Deprecate code on next major change[0m
[30;1m353 | [0m[35m                if mount.config_map:[0m

[31m--[ [0m[34mMatch #[0m[33m994[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m336 | [0m[35m                                             target_path="/etc/assemblyline/config.yml", read_only=T[0m
[30;1m337 | [0m[35m[0m
[30;1m338 | [0m[35m            # If we're passed an override for server-server and it's defining an HTTPS connection, t[0m
[30;1m339 | [0m[35m            # mount for the Root CA that needs to be mounted[0m
[30;1m340 | [0m[35m            if INTERNAL_ENCRYPT:[0m
[30;1m341 | [0m[35m                service_defaults_config.mounts.append(Mount(dict([0m
[30;1m342 | [0m[35m                    name="root-ca",[0m

[31m--[ [0m[34mMatch #[0m[33m995[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m307 | [0m[35m        if SERVICE_API_KEY:[0m
[30;1m308 | [0m[35m            service_defaults_config.environment = \[0m
[30;1m309 | [0m[35m                [EnvironmentVariable(dict(name="SERVICE_API_KEY", value=SERVICE_API_KEY))] + \[0m
[30;1m310 | [0m[35m                [env for env in service_defaults_config.environment if env.name != "SERVICE_API_KEY"[0m
[30;1m311 | [0m[35m[0m
[30;1m312 | [0m[35m        if self.config.core.scaler.additional_labels:[0m
[30;1m313 | [0m[35m            labels.update({k: v for k, v in (_l.split("=") for _l in self.config.core.scaler.additio[0m

[31m--[ [0m[34mMatch #[0m[33m996[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m302 | [0m[35m        if SERVICE_API_HOST:[0m
[30;1m303 | [0m[35m            service_defaults_config.environment = \[0m
[30;1m304 | [0m[35m                [EnvironmentVariable(dict(name="SERVICE_API_HOST", value=SERVICE_API_HOST))] + \[0m
[30;1m305 | [0m[35m                [env for env in service_defaults_config.environment if env.name != "SERVICE_API_HOST[0m
[30;1m306 | [0m[35m[0m
[30;1m307 | [0m[35m        if SERVICE_API_KEY:[0m
[30;1m308 | [0m[35m            service_defaults_config.environment = \[0m

[31m--[ [0m[34mMatch #[0m[33m997[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m279 | [0m[35m        # Limit secrets to be shared to very specific configurations[0m
[30;1m280 | [0m[35m        for cfg in ["datastore.hosts", "filestore.archive", "filestore.cache", "filestore.storage"]:[0m
[30;1m281 | [0m[35m            for conn_str in flattened_config.get(cfg, []):[0m
[30;1m282 | [0m[35m                # Look for any secrets that need to passed onto services via env[0m
[30;1m283 | [0m[35m                for secret in Template(conn_str).get_identifiers():[0m
[30;1m284 | [0m[35m                    try:[0m
[30;1m285 | [0m[35m                        core_env[secret] = os.environ[secret][0m
[30;1m286 | [0m[35m                    except KeyError:[0m

[31m--[ [0m[34mMatch #[0m[33m998[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m133 | [0m[35m        :param shrink: Delay before shrinking a service, unit-less, approximately seconds, defaults [0m
[30;1m134 | [0m[35m        :param backlog: How long a queue backlog should be before it takes `growth` seconds to grow.[0m
[30;1m135 | [0m[35m        :param queue: Queue object for monitoring[0m
[30;1m136 | [0m[35m        :param privileged: Is this service able to interact with core directly?[0m
[30;1m137 | [0m[35m        """[0m
[30;1m138 | [0m[35m        self.name = name[0m
[30;1m139 | [0m[35m        self.queue: Optional[PriorityQueue] = queue[0m

[31m--[ [0m[34mMatch #[0m[33m999[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m127 | [0m[35m        """[0m
[30;1m128 | [0m[35m        :param name: Name of the service to manage[0m
[30;1m129 | [0m[35m        :param container_config: Instructions on how to start this service[0m
[30;1m130 | [0m[35m        :param min_instances: The minimum number of copies of this service keep running[0m
[30;1m131 | [0m[35m        :param max_instances: The maximum number of copies permitted to be running[0m
[30;1m132 | [0m[35m        :param growth: Delay before growing a service, unit-less, approximately seconds[0m
[30;1m133 | [0m[35m        :param shrink: Delay before shrinking a service, unit-less, approximately seconds, defaults [0m

[31m--[ [0m[34mMatch #[0m[33m1000[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m126 | [0m[35m                 privileged: bool = False):[0m
[30;1m127 | [0m[35m        """[0m
[30;1m128 | [0m[35m        :param name: Name of the service to manage[0m
[30;1m129 | [0m[35m        :param container_config: Instructions on how to start this service[0m
[30;1m130 | [0m[35m        :param min_instances: The minimum number of copies of this service keep running[0m
[30;1m131 | [0m[35m        :param max_instances: The maximum number of copies permitted to be running[0m
[30;1m132 | [0m[35m        :param growth: Delay before growing a service, unit-less, approximately seconds[0m
[30;1m133 | [0m[35m        :param shrink: Delay before shrinking a service, unit-less, approximately seconds, defaults [0m

[31m--[ [0m[34mMatch #[0m[33m1001[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35m                 shutdown_seconds: int = 30, dependency_blobs: Optional[dict[str, str]] = None,[0m
[30;1m126 | [0m[35m                 privileged: bool = False):[0m
[30;1m127 | [0m[35m        """[0m
[30;1m128 | [0m[35m        :param name: Name of the service to manage[0m
[30;1m129 | [0m[35m        :param container_config: Instructions on how to start this service[0m
[30;1m130 | [0m[35m        :param min_instances: The minimum number of copies of this service keep running[0m
[30;1m131 | [0m[35m        :param max_instances: The maximum number of copies permitted to be running[0m

[31m--[ [0m[34mMatch #[0m[33m1002[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m116 | [0m[35mclass ServiceProfile:[0m
[30;1m117 | [0m[35m    """A profile, describing a currently running service.[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m    This includes how the service should be run, and conditions related to the scaling of the servic[0m
[30;1m120 | [0m[35m    """[0m
[30;1m121 | [0m[35m[0m
[30;1m122 | [0m[35m    def __init__(self, name: str, container_config: DockerConfig, config_blob: str = '',[0m

[31m--[ [0m[34mMatch #[0m[33m1003[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35mAPM_SPAN_TYPE = 'scaler'[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35m# How often (in seconds) to download new service data, try to scale managed services,[0m
[30;1m49 | [0m[35m# and download more metrics data respectively[0m
[30;1m50 | [0m[35mSERVICE_SYNC_INTERVAL = 60 * 30  # Every half hour[0m
[30;1m51 | [0m[35mSCALE_INTERVAL = 5[0m

[31m--[ [0m[34mMatch #[0m[33m1004[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m26 | [0m[35mfrom assemblyline.remote.datatypes.hash import ExpiringHash, Hash[0m
[30;1m27 | [0m[35mfrom assemblyline.remote.datatypes.events import EventWatcher, EventSender[0m
[30;1m28 | [0m[35mfrom assemblyline.odm.models.service import Service, DockerConfig, EnvironmentVariable[0m
[30;1m29 | [0m[35mfrom assemblyline.odm.models.config import Mount[0m
[30;1m30 | [0m[35mfrom assemblyline.odm.messages.scaler_heartbeat import Metrics[0m
[30;1m31 | [0m[35mfrom assemblyline.odm.messages.scaler_status_heartbeat import Status[0m
[30;1m32 | [0m[35mfrom assemblyline.odm.messages.changes import ServiceChange, Operation[0m
[30;1m33 | [0m[35mfrom assemblyline.common.dict_utils import get_recursive_sorted_tuples, flatten[0m

[31m--[ [0m[34mMatch #[0m[33m1005[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35mimport os[0m
[30;1m11 | [0m[35mimport re[0m
[30;1m12 | [0m[35mimport math[0m
[30;1m13 | [0m[35mimport time[0m
[30;1m14 | [0m[35mimport platform[0m
[30;1m15 | [0m[35mimport concurrent.futures[0m
[30;1m16 | [0m[35mimport copy[0m
[30;1m17 | [0m[35mfrom contextlib import contextmanager[0m

[31m--[ [0m[34mMatch #[0m[33m1006[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/scaler_server.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mAn auto-scaling service specific to Assemblyline services.[0m
[30;1m3 | [0m[35m"""[0m
[30;1m4 | [0m[35mfrom __future__ import annotations[0m
[30;1m5 | [0m[35mimport functools[0m

[31m--[ [0m[34mMatch #[0m[33m1007[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/timeout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m46 | [0m[35m            # Loop until we hit an entry that is active, and non expired[0m
[30;1m47 | [0m[35m            current: TimeoutItem = self.timeout_queue.get_nowait()[0m
[30;1m48 | [0m[35m            while current.expiry <= now or self.event_data.get(current.key, None) != current:[0m
[30;1m49 | [0m[35m                if self.event_data.get(current.key, None) == current:[0m
[30;1m50 | [0m[35m                    self.event_data.pop(current.key)[0m
[30;1m51 | [0m[35m                    found[current.key] = current.data[0m
[30;1m52 | [0m[35m                current = self.timeout_queue.get_nowait()[0m

[31m--[ [0m[34mMatch #[0m[33m1008[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/timeout.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m            # Loop until we hit an entry that is active, and non expired[0m
[30;1m47 | [0m[35m            current: TimeoutItem = self.timeout_queue.get_nowait()[0m
[30;1m48 | [0m[35m            while current.expiry <= now or self.event_data.get(current.key, None) != current:[0m
[30;1m49 | [0m[35m                if self.event_data.get(current.key, None) == current:[0m
[30;1m50 | [0m[35m                    self.event_data.pop(current.key)[0m
[30;1m51 | [0m[35m                    found[current.key] = current.data[0m

[31m--[ [0m[34mMatch #[0m[33m1009[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/timeout.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m25 | [0m[35m        self.event_data: dict[KeyType, TimeoutItem] = {}[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    def set(self, key: KeyType, timeout: float, data: DataType):[0m
[30;1m28 | [0m[35m        # If a timeout is set repeatedly with the same key, only the last one will count[0m
[30;1m29 | [0m[35m        # even though we aren't removing the old ones from the queue. When the items are[0m
[30;1m30 | [0m[35m        # popped from the queue they[0m
[30;1m31 | [0m[35m        entry = TimeoutItem(time.time() + timeout, key, data)[0m

[31m--[ [0m[34mMatch #[0m[33m1010[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/timeout.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35m"""[0m
[30;1m4 | [0m[35mfrom __future__ import annotations[0m
[30;1m5 | [0m[35mimport queue[0m
[30;1m6 | [0m[35mimport time[0m
[30;1m7 | [0m[35mfrom queue import PriorityQueue[0m
[30;1m8 | [0m[35mfrom dataclasses import dataclass, field[0m
[30;1m9 | [0m[35mfrom typing import TypeVar, Generic, Hashable[0m
[30;1m10 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1011[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/timeout.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m"""[0m
[30;1m2 | [0m[35mA data structure encapsulating the timeout logic for the dispatcher.[0m
[30;1m3 | [0m[35m"""[0m
[30;1m4 | [0m[35mfrom __future__ import annotations[0m
[30;1m5 | [0m[35mimport queue[0m

[31m--[ [0m[34mMatch #[0m[33m1012[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/crawler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mimport os[0m
[30;1m6 | [0m[35mimport io[0m
[30;1m7 | [0m[35mimport signal[0m
[30;1m8 | [0m[35mfrom time import sleep, time[0m
[30;1m9 | [0m[35mfrom typing import TYPE_CHECKING[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mfrom assemblyline.common.log import init_logging[0m
[30;1m12 | [0m[35mfrom assemblyline.common.forge import get_config[0m

[31m--[ [0m[34mMatch #[0m[33m1013[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/crawler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mimport os[0m
[30;1m6 | [0m[35mimport io[0m
[30;1m7 | [0m[35mimport signal[0m
[30;1m8 | [0m[35mfrom time import sleep, time[0m
[30;1m9 | [0m[35mfrom typing import TYPE_CHECKING[0m
[30;1m10 | [0m[35m[0m
[30;1m11 | [0m[35mfrom assemblyline.common.log import init_logging[0m

[31m--[ [0m[34mMatch #[0m[33m1014[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m465 | [0m[35m                # Set section score to zero and lower total score if service is set to zeroize score[0m
[30;1m466 | [0m[35m                # and all tags were safelisted[0m
[30;1m467 | [0m[35m                if section.pop('zeroize_on_tag_safe', False) and \[0m
[30;1m468 | [0m[35m                        section.get('heuristic') and \[0m
[30;1m469 | [0m[35m                        len(tags) == 0 and \[0m
[30;1m470 | [0m[35m                        len(safelisted_tags) != 0:[0m
[30;1m471 | [0m[35m                    result['result']['score'] -= section['heuristic']['score'][0m

[31m--[ [0m[34mMatch #[0m[33m1015[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m460 | [0m[35m                section['tags'] = unflatten(tags)[0m
[30;1m461 | [0m[35m                section['safelisted_tags'] = safelisted_tags[0m
[30;1m462 | [0m[35m[0m
[30;1m463 | [0m[35m                section['tags'], dropped = construct_safe(Tagging, section.get('tags', {}))[0m
[30;1m464 | [0m[35m[0m
[30;1m465 | [0m[35m                # Set section score to zero and lower total score if service is set to zeroize score[0m
[30;1m466 | [0m[35m                # and all tags were safelisted[0m

[31m--[ [0m[34mMatch #[0m[33m1016[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m414 | [0m[35m            for section in result['result']['sections']:[0m
[30;1m415 | [0m[35m                zeroize_on_sig_safe = section.pop('zeroize_on_sig_safe', True)[0m
[30;1m416 | [0m[35m                section['tags'] = flatten(section['tags'])[0m
[30;1m417 | [0m[35m                if section.get('heuristic'):[0m
[30;1m418 | [0m[35m                    heur_id = f"{service_name.upper()}.{str(section['heuristic']['heur_id'])}"[0m
[30;1m419 | [0m[35m                    section['heuristic']['heur_id'] = heur_id[0m
[30;1m420 | [0m[35m                    try:[0m

[31m--[ [0m[34mMatch #[0m[33m1017[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m377 | [0m[35m                self.datastore.save_or_freshen_file(item['sha256'], file_info,[0m
[30;1m378 | [0m[35m                                                    file_info['expiry_ts'], file_info['classificatio[0m
[30;1m379 | [0m[35m                                                    is_section_image=item.get('is_section_image', Fa[0m
[30;1m380 | [0m[35m                                                    is_supplementary=item.get('is_supplementary', Fa[0m
[30;1m381 | [0m[35m            return False[0m
[30;1m382 | [0m[35m[0m
[30;1m383 | [0m[35m        if task.ttl:[0m

[31m--[ [0m[34mMatch #[0m[33m1018[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m376 | [0m[35m                file_info['classification'] = item['classification'][0m
[30;1m377 | [0m[35m                self.datastore.save_or_freshen_file(item['sha256'], file_info,[0m
[30;1m378 | [0m[35m                                                    file_info['expiry_ts'], file_info['classificatio[0m
[30;1m379 | [0m[35m                                                    is_section_image=item.get('is_section_image', Fa[0m
[30;1m380 | [0m[35m                                                    is_supplementary=item.get('is_supplementary', Fa[0m
[30;1m381 | [0m[35m            return False[0m
[30;1m382 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1019[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m367 | [0m[35m        file_exists_check = {}[0m
[30;1m368 | [0m[35m[0m
[30;1m369 | [0m[35m        def freshen_file(file_info_list, item):[0m
[30;1m370 | [0m[35m            file_info = file_info_list.get(item['sha256'], None)[0m
[30;1m371 | [0m[35m            if file_info is None or not file_exists_check[item['sha256']]:[0m
[30;1m372 | [0m[35m                return True[0m
[30;1m373 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m1020[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m337 | [0m[35m[0m
[30;1m338 | [0m[35m    @elasticapm.capture_span(span_type='tasking_client')[0m
[30;1m339 | [0m[35m    def task_finished(self, service_task, client_id, service_name, metric_factory):[0m
[30;1m340 | [0m[35m        exec_time = service_task.get('exec_time')[0m
[30;1m341 | [0m[35m[0m
[30;1m342 | [0m[35m        try:[0m
[30;1m343 | [0m[35m            task = ServiceTask(service_task['task'])[0m

[31m--[ [0m[34mMatch #[0m[33m1021[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m172 | [0m[35m                    heuristic['heur_id'] = f"{service.name.upper()}.{str(heuristic['heur_id'])}"[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m                    # Attack_id field is now a list, make it a list if we receive otherwise[0m
[30;1m175 | [0m[35m                    attack_id = heuristic.get('attack_id', None)[0m
[30;1m176 | [0m[35m                    if isinstance(attack_id, str):[0m
[30;1m177 | [0m[35m                        heuristic['attack_id'] = [attack_id][0m
[30;1m178 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1022[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m136 | [0m[35m                .get('registry_type', self.config.services.preferred_registry_type)[0m
[30;1m137 | [0m[35m            service_data['privileged'] = service_data.get('privileged', self.config.services.prefer_[0m
[30;1m138 | [0m[35m            for dep in service_data.get('dependencies', {}).values():[0m
[30;1m139 | [0m[35m                dep['container']['registry_type'] = dep.get([0m
[30;1m140 | [0m[35m                    'registry_type', self.config.services.preferred_registry_type)[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m            # Pop unused registration service_data[0m

[31m--[ [0m[34mMatch #[0m[33m1023[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m135 | [0m[35m            service_data['docker_config']['registry_type'] = service_data['docker_config'] \[0m
[30;1m136 | [0m[35m                .get('registry_type', self.config.services.preferred_registry_type)[0m
[30;1m137 | [0m[35m            service_data['privileged'] = service_data.get('privileged', self.config.services.prefer_[0m
[30;1m138 | [0m[35m            for dep in service_data.get('dependencies', {}).values():[0m
[30;1m139 | [0m[35m                dep['container']['registry_type'] = dep.get([0m
[30;1m140 | [0m[35m                    'registry_type', self.config.services.preferred_registry_type)[0m
[30;1m141 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1024[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m134 | [0m[35m                'update_channel', self.config.services.preferred_update_channel)[0m
[30;1m135 | [0m[35m            service_data['docker_config']['registry_type'] = service_data['docker_config'] \[0m
[30;1m136 | [0m[35m                .get('registry_type', self.config.services.preferred_registry_type)[0m
[30;1m137 | [0m[35m            service_data['privileged'] = service_data.get('privileged', self.config.services.prefer_[0m
[30;1m138 | [0m[35m            for dep in service_data.get('dependencies', {}).values():[0m
[30;1m139 | [0m[35m                dep['container']['registry_type'] = dep.get([0m
[30;1m140 | [0m[35m                    'registry_type', self.config.services.preferred_registry_type)[0m

[31m--[ [0m[34mMatch #[0m[33m1025[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m            service_data['update_channel'] = service_data.get([0m
[30;1m134 | [0m[35m                'update_channel', self.config.services.preferred_update_channel)[0m
[30;1m135 | [0m[35m            service_data['docker_config']['registry_type'] = service_data['docker_config'] \[0m
[30;1m136 | [0m[35m                .get('registry_type', self.config.services.preferred_registry_type)[0m
[30;1m137 | [0m[35m            service_data['privileged'] = service_data.get('privileged', self.config.services.prefer_[0m
[30;1m138 | [0m[35m            for dep in service_data.get('dependencies', {}).values():[0m
[30;1m139 | [0m[35m                dep['container']['registry_type'] = dep.get([0m

[31m--[ [0m[34mMatch #[0m[33m1026[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m            heuristics = service_data.pop('heuristics', [])[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m            # Patch update_channel, registry_type before Service registration object creation[0m
[30;1m133 | [0m[35m            service_data['update_channel'] = service_data.get([0m
[30;1m134 | [0m[35m                'update_channel', self.config.services.preferred_update_channel)[0m
[30;1m135 | [0m[35m            service_data['docker_config']['registry_type'] = service_data['docker_config'] \[0m
[30;1m136 | [0m[35m                .get('registry_type', self.config.services.preferred_registry_type)[0m

[31m--[ [0m[34mMatch #[0m[33m1027[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m    def reload_heuristics(self, data: Optional[dict]):[0m
[30;1m74 | [0m[35m        service_name = None[0m
[30;1m75 | [0m[35m        if data is not None:[0m
[30;1m76 | [0m[35m            service_name = data.get('service_name')[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m        if service_name:[0m
[30;1m79 | [0m[35m            self.heuristics.update({h.heur_id: h for h in self.datastore.list_service_heuristics(ser[0m

[31m--[ [0m[34mMatch #[0m[33m1028[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m428 | [0m[35m                    except InvalidHeuristicException:[0m
[30;1m429 | [0m[35m                        section['heuristic'] = None[0m
[30;1m430 | [0m[35m[0m
[30;1m431 | [0m[35m        # Update the total score of the result[0m
[30;1m432 | [0m[35m        result['result']['score'] = total_score[0m
[30;1m433 | [0m[35m[0m
[30;1m434 | [0m[35m        # Add timestamps for creation, archive and expiry[0m

[31m--[ [0m[34mMatch #[0m[33m1029[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m106 | [0m[35m            else:[0m
[30;1m107 | [0m[35m                file_info['expiry_ts'] = None[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m            # Update the datastore with the uploaded file[0m
[30;1m110 | [0m[35m            self.datastore.save_or_freshen_file([0m
[30;1m111 | [0m[35m                file_info['sha256'],[0m
[30;1m112 | [0m[35m                file_info, file_info['expiry_ts'],[0m

[31m--[ [0m[34mMatch #[0m[33m1030[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m462 | [0m[35m[0m
[30;1m463 | [0m[35m                section['tags'], dropped = construct_safe(Tagging, section.get('tags', {}))[0m
[30;1m464 | [0m[35m[0m
[30;1m465 | [0m[35m                # Set section score to zero and lower total score if service is set to zeroize score[0m
[30;1m466 | [0m[35m                # and all tags were safelisted[0m
[30;1m467 | [0m[35m                if section.pop('zeroize_on_tag_safe', False) and \[0m
[30;1m468 | [0m[35m                        section.get('heuristic') and \[0m

[31m--[ [0m[34mMatch #[0m[33m1031[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m254 | [0m[35m        task = self.dispatch_client.request_work(client_id, service_name, service_version, timeout=t[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m        if not task:[0m
[30;1m257 | [0m[35m            # We've reached the timeout and no task found in service queue[0m
[30;1m258 | [0m[35m            return None, False[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m        # We've got a task to process, consider us busy[0m

[31m--[ [0m[34mMatch #[0m[33m1032[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m254 | [0m[35m        task = self.dispatch_client.request_work(client_id, service_name, service_version, timeout=t[0m
[30;1m255 | [0m[35m[0m
[30;1m256 | [0m[35m        if not task:[0m
[30;1m257 | [0m[35m            # We've reached the timeout and no task found in service queue[0m
[30;1m258 | [0m[35m            return None, False[0m
[30;1m259 | [0m[35m[0m
[30;1m260 | [0m[35m        # We've got a task to process, consider us busy[0m

[31m--[ [0m[34mMatch #[0m[33m1033[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m247 | [0m[35m        except KeyError:[0m
[30;1m248 | [0m[35m            raise ServiceMissingException("The service you're asking task for does not exist, try la[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m        # Set the service status to Idle since we will be waiting for a task[0m
[30;1m251 | [0m[35m        self.status_table.set(client_id, (service_name, ServiceStatus.Idle, status_expiry))[0m
[30;1m252 | [0m[35m[0m
[30;1m253 | [0m[35m        # Getting a new task[0m

[31m--[ [0m[34mMatch #[0m[33m1034[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m245 | [0m[35m        try:[0m
[30;1m246 | [0m[35m            service_data = self.dispatch_client.service_data[service_name][0m
[30;1m247 | [0m[35m        except KeyError:[0m
[30;1m248 | [0m[35m            raise ServiceMissingException("The service you're asking task for does not exist, try la[0m
[30;1m249 | [0m[35m[0m
[30;1m250 | [0m[35m        # Set the service status to Idle since we will be waiting for a task[0m
[30;1m251 | [0m[35m        self.status_table.set(client_id, (service_name, ServiceStatus.Idle, status_expiry))[0m

[31m--[ [0m[34mMatch #[0m[33m1035[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m238 | [0m[35m    def get_task(self, client_id, service_name, service_version, service_tool_version,[0m
[30;1m239 | [0m[35m                 metric_factory, status_expiry=None, timeout=30):[0m
[30;1m240 | [0m[35m        if status_expiry is None:[0m
[30;1m241 | [0m[35m            status_expiry = time.time() + timeout[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m        cache_found = False[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m1036[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m228 | [0m[35m                'name': service.name[0m
[30;1m229 | [0m[35m            })[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m        except ValueError as e:  # Catch errors when building Service or Heuristic model(s)[0m
[30;1m232 | [0m[35m            raise e[0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m        return dict(keep_alive=keep_alive, new_heuristics=new_heuristics, service_config=service_con[0m

[31m--[ [0m[34mMatch #[0m[33m1037[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m            service_config = self.datastore.get_service_with_delta(service.name, as_obj=False)[0m
[30;1m224 | [0m[35m[0m
[30;1m225 | [0m[35m            # Notify components watching for service config changes[0m
[30;1m226 | [0m[35m            self.event_sender.send('services.' + service.name, {[0m
[30;1m227 | [0m[35m                'operation': Operation.Added,[0m
[30;1m228 | [0m[35m                'name': service.name[0m

[31m--[ [0m[34mMatch #[0m[33m1038[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m            # Look for heuristics that are no longer managed by the service and clean them up[0m
[30;1m199 | [0m[35m            if self.register_only:[0m
[30;1m200 | [0m[35m                # Fetch current heuristics for the service during registration[0m
[30;1m201 | [0m[35m                self.reload_heuristics({'service_name': service.name})[0m
[30;1m202 | [0m[35m[0m
[30;1m203 | [0m[35m            all_heuristics = set(h_id for h_id in self.heuristics.keys()[0m

[31m--[ [0m[34mMatch #[0m[33m1039[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m195 | [0m[35m                        self.log.info(f"{log_prefix}{service.name} "[0m
[30;1m196 | [0m[35m                                    f"heuristic {item['update']['_id']}: {item['update']['result'].u[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m            # Look for heuristics that are no longer managed by the service and clean them up[0m
[30;1m199 | [0m[35m            if self.register_only:[0m
[30;1m200 | [0m[35m                # Fetch current heuristics for the service during registration[0m
[30;1m201 | [0m[35m                self.reload_heuristics({'service_name': service.name})[0m

[31m--[ [0m[34mMatch #[0m[33m1040[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m168 | [0m[35m            for index, heuristic in enumerate(heuristics):[0m
[30;1m169 | [0m[35m                heuristic_id = f'#{index}'  # Set heuristic id to it's position in the list for logg[0m
[30;1m170 | [0m[35m                try:[0m
[30;1m171 | [0m[35m                    # Append service name to heuristic ID[0m
[30;1m172 | [0m[35m                    heuristic['heur_id'] = f"{service.name.upper()}.{str(heuristic['heur_id'])}"[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m                    # Attack_id field is now a list, make it a list if we receive otherwise[0m

[31m--[ [0m[34mMatch #[0m[33m1041[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m156 | [0m[35m                self.log.info(f"{log_prefix}{service.name} registered")[0m
[30;1m157 | [0m[35m                keep_alive = False[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m            # Save service delta if it doesn't already exist[0m
[30;1m160 | [0m[35m            if not self.datastore.service_delta.exists(service.name):[0m
[30;1m161 | [0m[35m                self.datastore.service_delta.save(service.name, {'version': service.version})[0m
[30;1m162 | [0m[35m                self.datastore.service_delta.commit()[0m

[31m--[ [0m[34mMatch #[0m[33m1042[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m149 | [0m[35m            # Fix service version, we don't need to see the stable label[0m
[30;1m150 | [0m[35m            service.version = service.version.replace('stable', '')[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m            # Save service if it doesn't already exist[0m
[30;1m153 | [0m[35m            if not self.datastore.service.exists(f'{service.name}_{service.version}'):[0m
[30;1m154 | [0m[35m                self.datastore.service.save(f'{service.name}_{service.version}', service)[0m
[30;1m155 | [0m[35m                self.datastore.service.commit()[0m

[31m--[ [0m[34mMatch #[0m[33m1043[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m146 | [0m[35m            # Create Service registration object[0m
[30;1m147 | [0m[35m            service = Service(service_data)[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m            # Fix service version, we don't need to see the stable label[0m
[30;1m150 | [0m[35m            service.version = service.version.replace('stable', '')[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m            # Save service if it doesn't already exist[0m

[31m--[ [0m[34mMatch #[0m[33m1044[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m144 | [0m[35m                service_data.pop(x, None)[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m            # Create Service registration object[0m
[30;1m147 | [0m[35m            service = Service(service_data)[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m            # Fix service version, we don't need to see the stable label[0m
[30;1m150 | [0m[35m            service.version = service.version.replace('stable', '')[0m

[31m--[ [0m[34mMatch #[0m[33m1045[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m143 | [0m[35m            for x in ['file_required', 'tool_version']:[0m
[30;1m144 | [0m[35m                service_data.pop(x, None)[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m            # Create Service registration object[0m
[30;1m147 | [0m[35m            service = Service(service_data)[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m            # Fix service version, we don't need to see the stable label[0m

[31m--[ [0m[34mMatch #[0m[33m1046[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m            # Get heuristics list[0m
[30;1m130 | [0m[35m            heuristics = service_data.pop('heuristics', [])[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m            # Patch update_channel, registry_type before Service registration object creation[0m
[30;1m133 | [0m[35m            service_data['update_channel'] = service_data.get([0m
[30;1m134 | [0m[35m                'update_channel', self.config.services.preferred_update_channel)[0m
[30;1m135 | [0m[35m            service_data['docker_config']['registry_type'] = service_data['docker_config'] \[0m

[31m--[ [0m[34mMatch #[0m[33m1047[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m120 | [0m[35m            raise TaskingClientException("Uploaded file does not match expected file hash. "[0m
[30;1m121 | [0m[35m                                         f"[{file_info['sha256']} != {expected_sha256}]")[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m    # Service[0m
[30;1m124 | [0m[35m    @elasticapm.capture_span(span_type='tasking_client')[0m
[30;1m125 | [0m[35m    def register_service(self, service_data, log_prefix=""):[0m
[30;1m126 | [0m[35m        keep_alive = True[0m
[30;1m127 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1048[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m        self.heuristics: dict[str, Heuristic] = {}[0m
[30;1m53 | [0m[35m        self.register_only = register_only[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m        # If we're performing service registration, we only need a connection to the datastore[0m
[30;1m56 | [0m[35m        if not register_only:[0m
[30;1m57 | [0m[35m            self.dispatch_client = DispatchClient(self.datastore, redis=redis, redis_persist=redis_p[0m
[30;1m58 | [0m[35m            self.event_listener = EventWatcher(redis)[0m

[31m--[ [0m[34mMatch #[0m[33m1049[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m18 | [0m[35mfrom assemblyline.odm.models.error import Error[0m
[30;1m19 | [0m[35mfrom assemblyline.odm.models.heuristic import Heuristic[0m
[30;1m20 | [0m[35mfrom assemblyline.odm.models.result import Result[0m
[30;1m21 | [0m[35mfrom assemblyline.odm.models.service import Service[0m
[30;1m22 | [0m[35mfrom assemblyline.odm.models.tagging import Tagging[0m
[30;1m23 | [0m[35mfrom assemblyline.remote.datatypes.events import EventSender, EventWatcher[0m
[30;1m24 | [0m[35mfrom assemblyline.remote.datatypes.hash import ExpiringHash[0m
[30;1m25 | [0m[35mfrom assemblyline_core.dispatching.client import DispatchClient[0m

[31m--[ [0m[34mMatch #[0m[33m1050[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mfrom typing import Any, Dict, Optional[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mimport elasticapm[0m
[30;1m6 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1051[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/badlist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m246 | [0m[35m                    old['classification'], src.get('classification', None))[0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35m            # Set the expiry[0m
[30;1m249 | [0m[35m            old['expiry_ts'] = new.get('expiry_ts', None)[0m
[30;1m250 | [0m[35m            return old[0m
[30;1m251 | [0m[35m        except Exception as e:[0m
[30;1m252 | [0m[35m            raise InvalidBadhash(f"Invalid data provided: {str(e)}")[0m

[31m--[ [0m[34mMatch #[0m[33m1052[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/badlist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m243 | [0m[35m            # Calculate the new classification[0m
[30;1m244 | [0m[35m            for src in old['sources']:[0m
[30;1m245 | [0m[35m                old['classification'] = CLASSIFICATION.max_classification([0m
[30;1m246 | [0m[35m                    old['classification'], src.get('classification', None))[0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35m            # Set the expiry[0m
[30;1m249 | [0m[35m            old['expiry_ts'] = new.get('expiry_ts', None)[0m

[31m--[ [0m[34mMatch #[0m[33m1053[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/badlist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m237 | [0m[35m                    for reason in src['reason']:[0m
[30;1m238 | [0m[35m                        if reason not in old_src['reason']:[0m
[30;1m239 | [0m[35m                            old_src['reason'].append(reason)[0m
[30;1m240 | [0m[35m                    old_src['classification'] = src.get('classification', old_src['classification'])[0m
[30;1m241 | [0m[35m            old['sources'] = list(old_src_map.values())[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m            # Calculate the new classification[0m

[31m--[ [0m[34mMatch #[0m[33m1054[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/badlist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m216 | [0m[35m                            old['file']['name'].append(name)[0m
[30;1m217 | [0m[35m                elif new_names:[0m
[30;1m218 | [0m[35m                    old['file']['name'] = new_names[0m
[30;1m219 | [0m[35m                old['file'].update({k: v for k, v in new.get('file', {}).items() if v})[0m
[30;1m220 | [0m[35m            elif old['type'] == 'tag':[0m
[30;1m221 | [0m[35m                old['tag'] = new['tag'][0m
[30;1m222 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1055[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/badlist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m209 | [0m[35m            # Update type specific info[0m
[30;1m210 | [0m[35m            if old['type'] == 'file':[0m
[30;1m211 | [0m[35m                old.setdefault('file', {})[0m
[30;1m212 | [0m[35m                new_names = new.get('file', {}).pop('name', [])[0m
[30;1m213 | [0m[35m                if 'name' in old['file']:[0m
[30;1m214 | [0m[35m                    for name in new_names:[0m
[30;1m215 | [0m[35m                        if name not in old['file']['name']:[0m

[31m--[ [0m[34mMatch #[0m[33m1056[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/badlist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m200 | [0m[35m            elif new.get('attribution', None):[0m
[30;1m201 | [0m[35m                for key in ["actor", 'campaign', 'category', 'exploit', 'implant', 'family', 'networ[0m
[30;1m202 | [0m[35m                    old_value = old['attribution'].get(key, []) or [][0m
[30;1m203 | [0m[35m                    new_value = new['attribution'].get(key, []) or [][0m
[30;1m204 | [0m[35m                    old['attribution'][key] = list(set(old_value + new_value)) or None[0m
[30;1m205 | [0m[35m[0m
[30;1m206 | [0m[35m            if old['attribution'] is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m1057[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/badlist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m199 | [0m[35m                old['attribution'] = new.get('attribution', None)[0m
[30;1m200 | [0m[35m            elif new.get('attribution', None):[0m
[30;1m201 | [0m[35m                for key in ["actor", 'campaign', 'category', 'exploit', 'implant', 'family', 'networ[0m
[30;1m202 | [0m[35m                    old_value = old['attribution'].get(key, []) or [][0m
[30;1m203 | [0m[35m                    new_value = new['attribution'].get(key, []) or [][0m
[30;1m204 | [0m[35m                    old['attribution'][key] = list(set(old_value + new_value)) or None[0m
[30;1m205 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1058[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/badlist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m197 | [0m[35m            # Merge attributions[0m
[30;1m198 | [0m[35m            if not old['attribution']:[0m
[30;1m199 | [0m[35m                old['attribution'] = new.get('attribution', None)[0m
[30;1m200 | [0m[35m            elif new.get('attribution', None):[0m
[30;1m201 | [0m[35m                for key in ["actor", 'campaign', 'category', 'exploit', 'implant', 'family', 'networ[0m
[30;1m202 | [0m[35m                    old_value = old['attribution'].get(key, []) or [][0m
[30;1m203 | [0m[35m                    new_value = new['attribution'].get(key, []) or [][0m

[31m--[ [0m[34mMatch #[0m[33m1059[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/badlist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m            # Merge attributions[0m
[30;1m198 | [0m[35m            if not old['attribution']:[0m
[30;1m199 | [0m[35m                old['attribution'] = new.get('attribution', None)[0m
[30;1m200 | [0m[35m            elif new.get('attribution', None):[0m
[30;1m201 | [0m[35m                for key in ["actor", 'campaign', 'category', 'exploit', 'implant', 'family', 'networ[0m
[30;1m202 | [0m[35m                    old_value = old['attribution'].get(key, []) or [][0m

[31m--[ [0m[34mMatch #[0m[33m1060[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/badlist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m189 | [0m[35m            old['classification'] = new['classification'][0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m            # Update updated time[0m
[30;1m192 | [0m[35m            old['updated'] = new.get('updated', now_as_iso())[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m            # Update hashes[0m
[30;1m195 | [0m[35m            old['hashes'].update({k: v for k, v in new['hashes'].items() if v})[0m

[31m--[ [0m[34mMatch #[0m[33m1061[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/badlist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m128 | [0m[35m        plan = self.datastore.badlist.get_bulk_plan()[0m
[30;1m129 | [0m[35m        for key, val in new_data.items():[0m
[30;1m130 | [0m[35m            # Use maximum classification[0m
[30;1m131 | [0m[35m            old_val = old_data.get(key, {'classification': CLASSIFICATION.UNRESTRICTED, 'attribution[0m
[30;1m132 | [0m[35m                                         'hashes': {}, 'sources': [], 'type': val['type']})[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m            # Add upsert operation[0m

[31m--[ [0m[34mMatch #[0m[33m1062[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/badlist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m            # Find the highest classification of all sources[0m
[30;1m95 | [0m[35m            badlist_object['classification'] = CLASSIFICATION.max_classification([0m
[30;1m96 | [0m[35m                badlist_object['classification'], src.get('classification', None))[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m            src_map[src['name']] = src[0m
[30;1m99 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1063[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/badlist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m        # Find the best hash to use for the key[0m
[30;1m69 | [0m[35m        for hash_key in ['sha256', 'sha1', 'md5', 'tlsh', 'ssdeep']:[0m
[30;1m70 | [0m[35m            qhash = data['hashes'].get(hash_key, None)[0m
[30;1m71 | [0m[35m            if qhash:[0m
[30;1m72 | [0m[35m                break[0m
[30;1m73 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1064[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/badlist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m            data.pop('file', None)[0m
[30;1m42 | [0m[35m            data.pop('hashes', None)[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m            tag_data = data.get('tag', None)[0m
[30;1m45 | [0m[35m            if tag_data is None or 'type' not in tag_data or 'value' not in tag_data:[0m
[30;1m46 | [0m[35m                raise ValueError("Tag data not found")[0m
[30;1m47 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1065[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/badlist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m    def _preprocess_object(self, data: dict) -> str:[0m
[30;1m31 | [0m[35m        # Remove any null classification that might already be set[0m
[30;1m32 | [0m[35m        if 'classification' in data and not data.get('classification'):[0m
[30;1m33 | [0m[35m            data.pop('classification')[0m
[30;1m34 | [0m[35m[0m
[30;1m35 | [0m[35m        # Set defaults[0m

[31m--[ [0m[34mMatch #[0m[33m1066[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/badlist_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m206 | [0m[35m            if old['attribution'] is not None:[0m
[30;1m207 | [0m[35m                old['attribution'] = {key: value for key, value in old['attribution'].items() if val[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35m            # Update type specific info[0m
[30;1m210 | [0m[35m            if old['type'] == 'file':[0m
[30;1m211 | [0m[35m                old.setdefault('file', {})[0m
[30;1m212 | [0m[35m                new_names = new.get('file', {}).pop('name', [])[0m

[31m--[ [0m[34mMatch #[0m[33m1067[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/badlist_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m191 | [0m[35m            # Update updated time[0m
[30;1m192 | [0m[35m            old['updated'] = new.get('updated', now_as_iso())[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m            # Update hashes[0m
[30;1m195 | [0m[35m            old['hashes'].update({k: v for k, v in new['hashes'].items() if v})[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m            # Merge attributions[0m

[31m--[ [0m[34mMatch #[0m[33m1068[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/badlist_client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m188 | [0m[35m            # Use the new classification but we will recompute it later anyway[0m
[30;1m189 | [0m[35m            old['classification'] = new['classification'][0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m            # Update updated time[0m
[30;1m192 | [0m[35m            old['updated'] = new.get('updated', now_as_iso())[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m            # Update hashes[0m

[31m--[ [0m[34mMatch #[0m[33m1069[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/badlist_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m188 | [0m[35m            # Use the new classification but we will recompute it later anyway[0m
[30;1m189 | [0m[35m            old['classification'] = new['classification'][0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35m            # Update updated time[0m
[30;1m192 | [0m[35m            old['updated'] = new.get('updated', now_as_iso())[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m            # Update hashes[0m
[30;1m195 | [0m[35m            old['hashes'].update({k: v for k, v in new['hashes'].items() if v})[0m

[31m--[ [0m[34mMatch #[0m[33m1070[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/badlist_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m91 | [0m[35m                    if ROLES.signature_import not in user['roles']:[0m
[30;1m92 | [0m[35m                        raise PermissionError("You do not have sufficient priviledges to add an exte[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m            # Find the highest classification of all sources[0m
[30;1m95 | [0m[35m            badlist_object['classification'] = CLASSIFICATION.max_classification([0m
[30;1m96 | [0m[35m                badlist_object['classification'], src.get('classification', None))[0m
[30;1m97 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1071[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/badlist_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35m        # Set last updated[0m
[30;1m66 | [0m[35m        data['added'] = data['updated'] = now_as_iso()[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m        # Find the best hash to use for the key[0m
[30;1m69 | [0m[35m        for hash_key in ['sha256', 'sha1', 'md5', 'tlsh', 'ssdeep']:[0m
[30;1m70 | [0m[35m            qhash = data['hashes'].get(hash_key, None)[0m
[30;1m71 | [0m[35m            if qhash:[0m

[31m--[ [0m[34mMatch #[0m[33m1072[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m10 | [0m[35m    client = TaskingClient(datastore_connection, register_only=True)[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m    # Test service registration[0m
[30;1m13 | [0m[35m    service = random_minimal_obj(Service).as_primitives()[0m
[30;1m14 | [0m[35m    heuristics = [random_minimal_obj(Heuristic).as_primitives() for _ in range(2)][0m
[30;1m15 | [0m[35m    service['heuristics'] = heuristics[0m
[30;1m16 | [0m[35m    assert client.register_service(service)    [0m

[31m--[ [0m[34mMatch #[0m[33m1073[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m9 | [0m[35mdef test_register_service(datastore_connection):[0m
[30;1m10 | [0m[35m    client = TaskingClient(datastore_connection, register_only=True)[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35m    # Test service registration[0m
[30;1m13 | [0m[35m    service = random_minimal_obj(Service).as_primitives()[0m
[30;1m14 | [0m[35m    heuristics = [random_minimal_obj(Heuristic).as_primitives() for _ in range(2)][0m
[30;1m15 | [0m[35m    service['heuristics'] = heuristics[0m

[31m--[ [0m[34mMatch #[0m[33m1074[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_tasking_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom assemblyline_core.tasking_client import TaskingClient[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom assemblyline.odm.models.service import Service[0m
[30;1m4 | [0m[35mfrom assemblyline.odm.models.heuristic import Heuristic[0m
[30;1m5 | [0m[35mfrom assemblyline.odm.models.result import Result, Section, Heuristic as SectionHeuristic[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mfrom assemblyline.odm.randomizer import random_minimal_obj[0m

[31m--[ [0m[34mMatch #[0m[33m1075[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m### Updater[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35mMake sure the different services get their latest update files.[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m```bash[0m
[30;1m97 | [0m[35mdocker run --name updater cccs/assemblyline-core python -m assemblyline_core.updater.run_updater[0m

[31m--[ [0m[34mMatch #[0m[33m1076[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35mExécute les différents flux de travail dans le système et appliquer leurs étiquettes, leur priorité [0m
[30;1m209 | [0m[35m[0m
[30;1m210 | [0m[35m```bash[0m
[30;1m211 | [0m[35mdocker run --name workflow cccs/assemblyline-core python -m assemblyline_core.workflow.run_workflow[0m
[30;1m212 | [0m[35m```[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m## Documentation[0m

[31m--[ [0m[34mMatch #[0m[33m1077[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m199 | [0m[35m[0m
[30;1m200 | [0m[35mAssure que les différents services reçoivent leurs derniers fichiers de mise à jour.[0m
[30;1m201 | [0m[35m[0m
[30;1m202 | [0m[35m```bash[0m
[30;1m203 | [0m[35mdocker run --name updater cccs/assemblyline-core python -m assemblyline_core.updater.run_updater[0m
[30;1m204 | [0m[35m```[0m
[30;1m205 | [0m[35m[0m
[30;1m206 | [0m[35m### Workflow[0m

[31m--[ [0m[34mMatch #[0m[33m1078[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35mAugmente et diminue les services dans le système en fonction de la charge.[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m```bash[0m
[30;1m195 | [0m[35mdocker run --name scaler cccs/assemblyline-core python -m assemblyline_core.scaler.run_scaler[0m
[30;1m196 | [0m[35m```[0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m### Mise à jour[0m

[31m--[ [0m[34mMatch #[0m[33m1079[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m##### Agrégateur de statistiques[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m```bash[0m
[30;1m187 | [0m[35mdocker run --name statistics cccs/assemblyline-core python -m assemblyline_core.metrics.run_statisti[0m
[30;1m188 | [0m[35m```[0m
[30;1m189 | [0m[35m[0m
[30;1m190 | [0m[35m### Scaler[0m

[31m--[ [0m[34mMatch #[0m[33m1080[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m#### Agrégateur de métriques[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m```bash[0m
[30;1m181 | [0m[35mdocker run --name metrics cccs/assemblyline-core python -m assemblyline_core.metrics.run_metrics_agg[0m
[30;1m182 | [0m[35m```[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m##### Agrégateur de statistiques[0m

[31m--[ [0m[34mMatch #[0m[33m1081[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35m#### Heartbeat Manager[0m
[30;1m173 | [0m[35m[0m
[30;1m174 | [0m[35m```bash[0m
[30;1m175 | [0m[35mdocker run --name heartbeat cccs/assemblyline-core python -m assemblyline_core.metrics.run_heartbeat[0m
[30;1m176 | [0m[35m```[0m
[30;1m177 | [0m[35m[0m
[30;1m178 | [0m[35m#### Agrégateur de métriques[0m

[31m--[ [0m[34mMatch #[0m[33m1082[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m161 | [0m[35m[0m
[30;1m162 | [0m[35mDéplace les fichiers ingérés des files d'attente prioritaires vers les files d'attente de traitement[0m
[30;1m163 | [0m[35m[0m
[30;1m164 | [0m[35m```bash[0m
[30;1m165 | [0m[35mdocker run --name ingester cccs/assemblyline-core python -m assemblyline_core.ingester[0m
[30;1m166 | [0m[35m```[0m
[30;1m167 | [0m[35m[0m
[30;1m168 | [0m[35m### Métriques[0m

[31m--[ [0m[34mMatch #[0m[33m1083[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m153 | [0m[35m[0m
[30;1m154 | [0m[35mSupprimer les soumissions et leurs résultats à l'expiration de leur durée de vie.[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m```bash[0m
[30;1m157 | [0m[35mdocker run --name expiry cccs/assemblyline-core python -m assemblyline_core.expiry.run_expiry[0m
[30;1m158 | [0m[35m```[0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35m### Ingester[0m

[31m--[ [0m[34mMatch #[0m[33m1084[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35mAchemine les fichiers dans le système durant une soumission. S'assure que tous les fichiers de la so[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m```bash[0m
[30;1m149 | [0m[35mdocker run --name dispatcher cccs/assemblyline-core python -m assemblyline_core.dispatching[0m
[30;1m150 | [0m[35m```[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m### Expiration[0m

[31m--[ [0m[34mMatch #[0m[33m1085[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m137 | [0m[35m[0m
[30;1m138 | [0m[35mArchivage des soumissions, de leurs résultats et des fichiers dans l'archive.[0m
[30;1m139 | [0m[35m[0m
[30;1m140 | [0m[35m```bash[0m
[30;1m141 | [0m[35mdocker run --name archiver cccs/assemblyline-core python -m assemblyline_core.archiver.run_archiver[0m
[30;1m142 | [0m[35m```[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m### Dispatcher[0m

[31m--[ [0m[34mMatch #[0m[33m1086[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m129 | [0m[35m[0m
[30;1m130 | [0m[35mCrée des alertes pour les différentes soumissions dans le système.[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m```bash[0m
[30;1m133 | [0m[35mdocker run --name alerter cccs/assemblyline-core python -m assemblyline_core.alerter.run_alerter[0m
[30;1m134 | [0m[35m```[0m
[30;1m135 | [0m[35m[0m
[30;1m136 | [0m[35m### Archiver[0m

[31m--[ [0m[34mMatch #[0m[33m1087[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35mRun the different workflows in the system and apply their labels, priority and status.[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m```bash[0m
[30;1m105 | [0m[35mdocker run --name workflow cccs/assemblyline-core python -m assemblyline_core.workflow.run_workflow[0m
[30;1m106 | [0m[35m```[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m## Documentation[0m

[31m--[ [0m[34mMatch #[0m[33m1088[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35mMake sure the different services get their latest update files.[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m```bash[0m
[30;1m97 | [0m[35mdocker run --name updater cccs/assemblyline-core python -m assemblyline_core.updater.run_updater[0m
[30;1m98 | [0m[35m```[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m### Workflow[0m

[31m--[ [0m[34mMatch #[0m[33m1089[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35mSpin up and down services in the system depending on the load.[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m```bash[0m
[30;1m89 | [0m[35mdocker run --name scaler cccs/assemblyline-core python -m assemblyline_core.scaler.run_scaler[0m
[30;1m90 | [0m[35m```[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m### Updater[0m

[31m--[ [0m[34mMatch #[0m[33m1090[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m#### Statistics Aggregator[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m```bash[0m
[30;1m81 | [0m[35mdocker run --name statistics cccs/assemblyline-core python -m assemblyline_core.metrics.run_statisti[0m
[30;1m82 | [0m[35m```[0m
[30;1m83 | [0m[35m[0m
[30;1m84 | [0m[35m### Scaler[0m

[31m--[ [0m[34mMatch #[0m[33m1091[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m#### Metrics Aggregator[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m```bash[0m
[30;1m75 | [0m[35mdocker run --name metrics cccs/assemblyline-core python -m assemblyline_core.metrics.run_metrics_agg[0m
[30;1m76 | [0m[35m```[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m#### Statistics Aggregator[0m

[31m--[ [0m[34mMatch #[0m[33m1092[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m#### Heartbeat Manager[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35m```bash[0m
[30;1m69 | [0m[35mdocker run --name heartbeat cccs/assemblyline-core python -m assemblyline_core.metrics.run_heartbeat[0m
[30;1m70 | [0m[35m```[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m#### Metrics Aggregator[0m

[31m--[ [0m[34mMatch #[0m[33m1093[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35mMove ingested files from the priority queues to the processing queues.[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m```bash[0m
[30;1m59 | [0m[35mdocker run --name ingester cccs/assemblyline-core python -m assemblyline_core.ingester[0m
[30;1m60 | [0m[35m```[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m### Metrics[0m

[31m--[ [0m[34mMatch #[0m[33m1094[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m47 | [0m[35m[0m
[30;1m48 | [0m[35mDelete submissions and their results when their time-to-live expires.[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m```bash[0m
[30;1m51 | [0m[35mdocker run --name expiry cccs/assemblyline-core python -m assemblyline_core.expiry.run_expiry[0m
[30;1m52 | [0m[35m```[0m
[30;1m53 | [0m[35m[0m
[30;1m54 | [0m[35m### Ingester[0m

[31m--[ [0m[34mMatch #[0m[33m1095[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35mRoute the files in the system while a submission is tacking place. Make sure all files during a subm[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m```bash[0m
[30;1m43 | [0m[35mdocker run --name dispatcher cccs/assemblyline-core python -m assemblyline_core.dispatching[0m
[30;1m44 | [0m[35m```[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m### Expiry[0m

[31m--[ [0m[34mMatch #[0m[33m1096[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35mArchives submissions and their results & files into the archive.[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m```bash[0m
[30;1m35 | [0m[35mdocker run --name archiver cccs/assemblyline-core python -m assemblyline_core.archiver.run_archiver[0m
[30;1m36 | [0m[35m```[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m### Dispatcher[0m

[31m--[ [0m[34mMatch #[0m[33m1097[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/README.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35mCreate alerts for the different submissions in the system.[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m```bash[0m
[30;1m27 | [0m[35mdocker run --name alerter cccs/assemblyline-core python -m assemblyline_core.alerter.run_alerter[0m
[30;1m28 | [0m[35m```[0m
[30;1m29 | [0m[35m[0m
[30;1m30 | [0m[35m### Archiver[0m

[31m--[ [0m[34mMatch #[0m[33m1098[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m153 | [0m[35m                wait_for = service.update_config and (service.update_config.wait_for_update and not [0m
[30;1m154 | [0m[35m                # This is a service that we wait for, and is new, so check if it has finished its up[0m
[30;1m155 | [0m[35m                if wait_for and service.name not in old:[0m
[30;1m156 | [0m[35m                    if stages.get(service.name, ServiceStage.Running) == ServiceStage.Running:[0m
[30;1m157 | [0m[35m                        self._services[service.name] = service[0m
[30;1m158 | [0m[35m                else:[0m
[30;1m159 | [0m[35m                    self._services[service.name] = service[0m

[31m--[ [0m[34mMatch #[0m[33m1099[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m131 | [0m[35m        return all_categories[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m    def get_accessible_services(self, user_c12n: str) -> Set[str]:[0m
[30;1m134 | [0m[35m        if not self.c12n_services.get(user_c12n):[0m
[30;1m135 | [0m[35m            # Cache services that are accessible to a classification group[0m
[30;1m136 | [0m[35m            self.c12n_services[user_c12n] = {_ for _, service in dict(self.services).items()[0m
[30;1m137 | [0m[35m                                             if Classification.is_accessible(user_c12n, service.clas[0m

[31m--[ [0m[34mMatch #[0m[33m1100[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m        selected = [][0m
[30;1m71 | [0m[35m        skipped = [][0m
[30;1m72 | [0m[35m        for name in services:[0m
[30;1m73 | [0m[35m            service = all_services.get(name, None)[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m            if not service:[0m
[30;1m76 | [0m[35m                skipped.append(name)[0m

[31m--[ [0m[34mMatch #[0m[33m1101[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m# If you are doing development and you want the system to route jobs ignoring the service setup/tear[0m
[30;1m17 | [0m[35m# set an environment variable SKIP_SERVICE_SETUP to true for all dispatcher containers[0m
[30;1m18 | [0m[35mSKIP_SERVICE_SETUP = os.environ.get('SKIP_SERVICE_SETUP', 'false').lower() in ['true', '1'][0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35mClassification = get_classification()[0m
[30;1m21 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1102[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m152 | [0m[35m # on the side of waiting for the update and processing more, rather than skipping[0m
[30;1m153 | [0m[35m                wait_for = service.update_config and (service.update_config.wait_for_update and not [0m
[30;1m154 | [0m[35m                # This is a service that we wait for, and is new, so check if it has finished its up[0m
[30;1m155 | [0m[35m                if wait_for and service.name not in old:[0m
[30;1m156 | [0m[35m                    if stages.get(service.name, ServiceStage.Running) == ServiceStage.Running:[0m
[30;1m157 | [0m[35m                        self._services[service.name] = service[0m
[30;1m158 | [0m[35m                else:[0m

[31m--[ [0m[34mMatch #[0m[33m1103[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m149 | [0m[35m            if service.enabled:[0m
[30;1m150 | [0m[35m                # Determine if this is a service we would wait for the first update run for[0m
[30;1m151 | [0m[35m                # Assume it is set to running so that in the case of a redis failure we fail[0m
[30;1m152 | [0m[35m                # on the side of waiting for the update and processing more, rather than skipping[0m
[30;1m153 | [0m[35m                wait_for = service.update_config and (service.update_config.wait_for_update and not [0m
[30;1m154 | [0m[35m                # This is a service that we wait for, and is new, so check if it has finished its up[0m
[30;1m155 | [0m[35m                if wait_for and service.name not in old:[0m

[31m--[ [0m[34mMatch #[0m[33m1104[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m147 | [0m[35m        services: list[Service] = self.datastore.list_all_services(full=True)[0m
[30;1m148 | [0m[35m        for service in services:[0m
[30;1m149 | [0m[35m            if service.enabled:[0m
[30;1m150 | [0m[35m                # Determine if this is a service we would wait for the first update run for[0m
[30;1m151 | [0m[35m                # Assume it is set to running so that in the case of a redis failure we fail[0m
[30;1m152 | [0m[35m                # on the side of waiting for the update and processing more, rather than skipping[0m
[30;1m153 | [0m[35m                wait_for = service.update_config and (service.update_config.wait_for_update and not [0m

[31m--[ [0m[34mMatch #[0m[33m1105[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m158 | [0m[35m                    if stages.get(service.name, ServiceStage.Running) == ServiceStage.Running:[0m
[30;1m159 | [0m[35m                        self._services[service.name] = service[0m
[30;1m160 | [0m[35m                else:[0m
[30;1m161 | [0m[35m                    self._services[service.name] = service[0m
[30;1m162 | [0m[35m        return self._services[0m

[31m--[ [0m[34mMatch #[0m[33m1106[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m154 | [0m[35m                # This is a service that we wait for, and is new, so check if it has finished its up[0m
[30;1m155 | [0m[35m                if wait_for and service.name not in old:[0m
[30;1m156 | [0m[35m                    if stages.get(service.name, ServiceStage.Running) == ServiceStage.Running:[0m
[30;1m157 | [0m[35m                        self._services[service.name] = service[0m
[30;1m158 | [0m[35m                else:[0m
[30;1m159 | [0m[35m                    self._services[service.name] = service[0m
[30;1m160 | [0m[35m        return self._services[0m

[31m--[ [0m[34mMatch #[0m[33m1107[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m151 | [0m[35mrunning so that in the case of a redis failure we fail[0m
[30;1m152 | [0m[35m                # on the side of waiting for the update and processing more, rather than skipping[0m
[30;1m153 | [0m[35m                wait_for = service.update_config and (service.update_config.wait_for_update and not [0m
[30;1m154 | [0m[35m                # This is a service that we wait for, and is new, so check if it has finished its up[0m
[30;1m155 | [0m[35m                if wait_for and service.name not in old:[0m
[30;1m156 | [0m[35m                    if stages.get(service.name, ServiceStage.Running) == ServiceStage.Running:[0m
[30;1m157 | [0m[35m                        self._services[service.name] = service[0m

[31m--[ [0m[34mMatch #[0m[33m1108[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m147 | [0m[35m        services: list[Service] = self.datastore.list_all_services(full=True)[0m
[30;1m148 | [0m[35m        for service in services:[0m
[30;1m149 | [0m[35m            if service.enabled:[0m
[30;1m150 | [0m[35m                # Determine if this is a service we would wait for the first update run for[0m
[30;1m151 | [0m[35m                # Assume it is set to running so that in the case of a redis failure we fail[0m
[30;1m152 | [0m[35m                # on the side of waiting for the update and processing more, rather than skipping[0m
[30;1m153 | [0m[35m                wait_for = service.update_config and (service.update_config.wait_for_update and not [0m

[31m--[ [0m[34mMatch #[0m[33m1109[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m145 | [0m[35m        old, self._services = self._services, {}[0m
[30;1m146 | [0m[35m        stages = self.service_stage.items()[0m
[30;1m147 | [0m[35m        services: list[Service] = self.datastore.list_all_services(full=True)[0m
[30;1m148 | [0m[35m        for service in services:[0m
[30;1m149 | [0m[35m            if service.enabled:[0m
[30;1m150 | [0m[35m                # Determine if this is a service we would wait for the first update run for[0m
[30;1m151 | [0m[35m                # Assume it is set to running so that in the case of a redis failure we fail[0m

[31m--[ [0m[34mMatch #[0m[33m1110[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m133 | [0m[35m    def get_accessible_services(self, user_c12n: str) -> Set[str]:[0m
[30;1m134 | [0m[35m        if not self.c12n_services.get(user_c12n):[0m
[30;1m135 | [0m[35m            # Cache services that are accessible to a classification group[0m
[30;1m136 | [0m[35m            self.c12n_services[user_c12n] = {_ for _, service in dict(self.services).items()[0m
[30;1m137 | [0m[35m                                             if Classification.is_accessible(user_c12n, service.clas[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35m        return self.c12n_services[user_c12n][0m

[31m--[ [0m[34mMatch #[0m[33m1111[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35m    def categories(self) -> Dict[str, list[str]]:[0m
[30;1m125 | [0m[35m        all_categories: dict[str, list[str]] = {}[0m
[30;1m126 | [0m[35m        for service in self.services.values():[0m
[30;1m127 | [0m[35m            try:[0m
[30;1m128 | [0m[35m                all_categories[service.category].append(service.name)[0m
[30;1m129 | [0m[35m            except KeyError:[0m

[31m--[ [0m[34mMatch #[0m[33m1112[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m115 | [0m[35m                    seen_categories.add(name)[0m
[30;1m116 | [0m[35m                continue[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m            # If it isn't a category, its a service[0m
[30;1m119 | [0m[35m            found_services.append(name)[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m        # Use set to remove duplicates, set is more efficient in batches[0m
[30;1m122 | [0m[35m        return list(set(found_services))[0m

[31m--[ [0m[34mMatch #[0m[33m1113[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m92 | [0m[35m        """Expands the names of service categories found in the list of services.[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m        Args:[0m
[30;1m95 | [0m[35m            services (list): List of service category or service names.[0m
[30;1m96 | [0m[35m        """[0m
[30;1m97 | [0m[35m        if services is None:[0m
[30;1m98 | [0m[35m            return [][0m

[31m--[ [0m[34mMatch #[0m[33m1114[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m92 | [0m[35m        """Expands the names of service categories found in the list of services.[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m        Args:[0m
[30;1m95 | [0m[35m            services (list): List of service category or service names.[0m
[30;1m96 | [0m[35m        """[0m
[30;1m97 | [0m[35m        if services is None:[0m
[30;1m98 | [0m[35m            return [][0m

[31m--[ [0m[34mMatch #[0m[33m1115[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m89 | [0m[35m        return schedule[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m    def expand_categories(self, services: list[str]) -> list[str]:[0m
[30;1m92 | [0m[35m        """Expands the names of service categories found in the list of services.[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m        Args:[0m
[30;1m95 | [0m[35m            services (list): List of service category or service names.[0m

[31m--[ [0m[34mMatch #[0m[33m1116[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m81 | [0m[35m            rejected = bool(service.rejects) and re.match(service.rejects, file_type)[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m            if accepted and not rejected:[0m
[30;1m84 | [0m[35m                schedule[self.stage_index(service.stage)][name] = service[0m
[30;1m85 | [0m[35m                selected.append(name)[0m
[30;1m86 | [0m[35m            else:[0m
[30;1m87 | [0m[35m                skipped.append(name)[0m
[30;1m88 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1117[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m        selected = [][0m
[30;1m71 | [0m[35m        skipped = [][0m
[30;1m72 | [0m[35m        for name in services:[0m
[30;1m73 | [0m[35m            service = all_services.get(name, None)[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m            if not service:[0m
[30;1m76 | [0m[35m                skipped.append(name)[0m

[31m--[ [0m[34mMatch #[0m[33m1118[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m55 | [0m[35m            selected.extend(self.expand_categories(submission.params.services.rescan))[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m        # If we enable service safelisting, the Safelist service shouldn't run on extracted files un[0m
[30;1m58 | [0m[35m        #   - We're enforcing use of the Safelist service (we always want to run the Safelist servic[0m
[30;1m59 | [0m[35m        #   - We're running submission with Deep Scanning[0m
[30;1m60 | [0m[35m        #   - We want to Ignore Filtering (perform as much unfiltered analysis as possible)[0m
[30;1m61 | [0m[35m        if "Safelist" in selected and file_depth and self.config.services.safelist.enabled and \[0m

[31m--[ [0m[34mMatch #[0m[33m1119[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m        if submission.params.services.rescan:[0m
[30;1m55 | [0m[35m            selected.extend(self.expand_categories(submission.params.services.rescan))[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m        # If we enable service safelisting, the Safelist service shouldn't run on extracted files un[0m
[30;1m58 | [0m[35m        #   - We're enforcing use of the Safelist service (we always want to run the Safelist servic[0m
[30;1m59 | [0m[35m        #   - We're running submission with Deep Scanning[0m
[30;1m60 | [0m[35m        #   - We want to Ignore Filtering (perform as much unfiltered analysis as possible)[0m

[31m--[ [0m[34mMatch #[0m[33m1120[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m54 | [0m[35m        if submission.params.services.rescan:[0m
[30;1m55 | [0m[35m            selected.extend(self.expand_categories(submission.params.services.rescan))[0m
[30;1m56 | [0m[35m[0m
[30;1m57 | [0m[35m        # If we enable service safelisting, the Safelist service shouldn't run on extracted files un[0m
[30;1m58 | [0m[35m        #   - We're enforcing use of the Safelist service (we always want to run the Safelist servic[0m
[30;1m59 | [0m[35m        #   - We're running submission with Deep Scanning[0m
[30;1m60 | [0m[35m        #   - We want to Ignore Filtering (perform as much unfiltered analysis as possible)[0m

[31m--[ [0m[34mMatch #[0m[33m1121[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35mfrom assemblyline_core.server_base import get_service_stage_hash, ServiceStage[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m[0m
[30;1m16 | [0m[35m# If you are doing development and you want the system to route jobs ignoring the service setup/tear[0m
[30;1m17 | [0m[35m# set an environment variable SKIP_SERVICE_SETUP to true for all dispatcher containers[0m
[30;1m18 | [0m[35mSKIP_SERVICE_SETUP = os.environ.get('SKIP_SERVICE_SETUP', 'false').lower() in ['true', '1'][0m
[30;1m19 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1122[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/dispatching/schedules.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m8 | [0m[35mfrom assemblyline.common.forge import CachedObject, get_classification[0m
[30;1m9 | [0m[35mfrom assemblyline.datastore.helper import AssemblylineDatastore[0m
[30;1m10 | [0m[35mfrom assemblyline.odm.models.config import Config[0m
[30;1m11 | [0m[35mfrom assemblyline.odm.models.service import Service[0m
[30;1m12 | [0m[35mfrom assemblyline.odm.models.submission import Submission[0m
[30;1m13 | [0m[35mfrom assemblyline_core.server_base import get_service_stage_hash, ServiceStage[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1123[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_badlist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m262 | [0m[35m    assert op == 'update'[0m
[30;1m263 | [0m[35m[0m
[30;1m264 | [0m[35m    # Load inserted data from DB[0m
[30;1m265 | [0m[35m    ds_u = client.datastore.badlist.get(update_hash, as_obj=False)[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35m    # Normalize classification in sources[0m
[30;1m268 | [0m[35m    for source in ds_u['sources']:[0m

[31m--[ [0m[34mMatch #[0m[33m1124[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_badlist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m240 | [0m[35m    assert op == 'add'[0m
[30;1m241 | [0m[35m[0m
[30;1m242 | [0m[35m    # Load inserted data from DB[0m
[30;1m243 | [0m[35m    ds_sl = client.datastore.badlist.get(update_hash, as_obj=False)[0m
[30;1m244 | [0m[35m[0m
[30;1m245 | [0m[35m    # Normalize classification in sources[0m
[30;1m246 | [0m[35m    for source in ds_sl['sources']:[0m

[31m--[ [0m[34mMatch #[0m[33m1125[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_badlist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m158 | [0m[35m    assert op == 'add'[0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35m    # Load inserted data from DB[0m
[30;1m161 | [0m[35m    ds_sl = client.datastore.badlist.get(expected_qhash, as_obj=False)[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m    # Test dates[0m
[30;1m164 | [0m[35m    added = ds_sl.pop('added', None)[0m

[31m--[ [0m[34mMatch #[0m[33m1126[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_badlist_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m    assert op == 'add'[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35m    # Load inserted data from DB[0m
[30;1m97 | [0m[35m    ds_sl = client.datastore.badlist.get(add_hash_file, as_obj=False)[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35m    # Test dates[0m
[30;1m100 | [0m[35m    added = ds_sl.pop('added', None)[0m

[31m--[ [0m[34mMatch #[0m[33m1127[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_badlist_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m[0m
[30;1m2 | [0m[35mimport hashlib[0m
[30;1m3 | [0m[35mimport random[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35mfrom copy import deepcopy[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35mimport pytest[0m
[30;1m8 | [0m[35mfrom assemblyline.common.forge import get_classification[0m

[31m--[ [0m[34mMatch #[0m[33m1128[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_scheduler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m146 | [0m[35m    for a, b in zip(schedule, [["Safelist"], [], []]):[0m
[30;1m147 | [0m[35m        assert set(a) == set(b)[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m    # Safelist service should be scheduled because we're enabling ignore_filtering[0m
[30;1m150 | [0m[35m    sub.params.deep_scan = False[0m
[30;1m151 | [0m[35m    sub.params.ignore_filtering = True[0m
[30;1m152 | [0m[35m    schedule = scheduler.build_schedule(sub, 'document/word', file_depth=1)[0m

[31m--[ [0m[34mMatch #[0m[33m1129[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_scheduler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m139 | [0m[35m    for a, b in zip(schedule, [[], [], []]):[0m
[30;1m140 | [0m[35m        assert set(a) == set(b)[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m    # Safelist service should be scheduled because we're enabling deep_scan[0m
[30;1m143 | [0m[35m    sub.params.deep_scan = True[0m
[30;1m144 | [0m[35m    sub.params.ignore_filtering = False[0m
[30;1m145 | [0m[35m    schedule = scheduler.build_schedule(sub, 'document/word', file_depth=1)[0m

[31m--[ [0m[34mMatch #[0m[33m1130[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_scheduler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m130 | [0m[35m    for a, b in zip(schedule, [["Safelist"], [], []]):[0m
[30;1m131 | [0m[35m        assert set(a) == set(b)[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m    # Safelist service should NOT still be scheduled because we're not enforcing Safelist service by[0m
[30;1m134 | [0m[35m    # and deep_scan and ignore_filtering is OFF for this submission[0m
[30;1m135 | [0m[35m    sub = submission(["Safelist"], [])[0m
[30;1m136 | [0m[35m    sub.params.deep_scan = False[0m

[31m--[ [0m[34mMatch #[0m[33m1131[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_scheduler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m130 | [0m[35m    for a, b in zip(schedule, [["Safelist"], [], []]):[0m
[30;1m131 | [0m[35m        assert set(a) == set(b)[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m    # Safelist service should NOT still be scheduled because we're not enforcing Safelist service by[0m
[30;1m134 | [0m[35m    # and deep_scan and ignore_filtering is OFF for this submission[0m
[30;1m135 | [0m[35m    sub = submission(["Safelist"], [])[0m
[30;1m136 | [0m[35m    sub.params.deep_scan = False[0m

[31m--[ [0m[34mMatch #[0m[33m1132[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_scheduler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35mdef test_schedule_service_safelist(scheduler):[0m
[30;1m128 | [0m[35m    # Safelist service should still be scheduled[0m
[30;1m129 | [0m[35m    schedule = scheduler.build_schedule(submission(["Safelist"], []), 'document/word', file_depth=0)[0m
[30;1m130 | [0m[35m    for a, b in zip(schedule, [["Safelist"], [], []]):[0m
[30;1m131 | [0m[35m        assert set(a) == set(b)[0m

[31m--[ [0m[34mMatch #[0m[33m1133[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_scheduler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m97 | [0m[35m    config.services.stages = ['pre', 'core', 'post'][0m
[30;1m98 | [0m[35m    stages = get_service_stage_hash(redis)[0m
[30;1m99 | [0m[35m    ds = FakeDatastore()[0m
[30;1m100 | [0m[35m    for service in ds.list_all_services():[0m
[30;1m101 | [0m[35m        stages.set(service.name, ServiceStage.Running)[0m
[30;1m102 | [0m[35m    return Scheduler(ds, config, redis)[0m
[30;1m103 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1134[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_scheduler.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mfrom assemblyline.odm.models.submission import Submission[0m
[30;1m4 | [0m[35mfrom assemblyline.odm.models.config import Config, DEFAULT_CONFIG[0m
[30;1m5 | [0m[35mfrom assemblyline.odm.models.service import Service[0m
[30;1m6 | [0m[35mfrom assemblyline.odm.randomizer import random_model_obj[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mfrom assemblyline_core.dispatching.dispatcher import Scheduler[0m
[30;1m9 | [0m[35mfrom assemblyline_core.server_base import get_service_stage_hash, ServiceStage[0m

[31m--[ [0m[34mMatch #[0m[33m1135[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/workflow/run_workflow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m        items = result.get('items', [{}]) or [{}][0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        ret_val = items[0].get("reporting_ts", p_start_ts)[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m        # End of transaction[0m
[30;1m56 | [0m[35m        if self.apm_client:[0m

[31m--[ [0m[34mMatch #[0m[33m1136[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/workflow/run_workflow.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m48 | [0m[35m                self.log.warning(f"Failed to load last reported alert from the datastore, retrying..[0m
[30;1m49 | [0m[35m                continue[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m        items = result.get('items', [{}]) or [{}][0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        ret_val = items[0].get("reporting_ts", p_start_ts)[0m
[30;1m54 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1137[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/workflow/run_workflow.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m211 | [0m[35m                        self.apm_client.end_transaction("workflows_completed", 'success')[0m
[30;1m212 | [0m[35m[0m
[30;1m213 | [0m[35m                except SearchException as e:[0m
[30;1m214 | [0m[35m                    self.log.warning(f"Failed to update alerts workflows_completed field. [{str(e)}][0m
[30;1m215 | [0m[35m[0m
[30;1m216 | [0m[35m                    # End of transaction[0m
[30;1m217 | [0m[35m                    if self.apm_client:[0m

[31m--[ [0m[34mMatch #[0m[33m1138[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/workflow/run_workflow.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m218 | [0m[35m                        self.apm_client.end_transaction("workflows_completed", 'search_exception')[0m
[30;1m219 | [0m[35m[0m
[30;1m220 | [0m[35m            else:[0m
[30;1m221 | [0m[35m                self.log.info("Skipping all workflows since there where no new alerts in the specifi[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35m            if run_once:[0m
[30;1m224 | [0m[35m                break[0m

[31m--[ [0m[34mMatch #[0m[33m1139[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/workflow/run_workflow.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m190 | [0m[35m                    if self.apm_client:[0m
[30;1m191 | [0m[35m                        self.apm_client.end_transaction(workflow.name, 'success')[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35m                # Marking all alerts for the time period as their workflow completed[0m
[30;1m194 | [0m[35m                # Start of transaction[0m
[30;1m195 | [0m[35m                if self.apm_client:[0m
[30;1m196 | [0m[35m                    self.apm_client.begin_transaction("Mark alerts complete")[0m

[31m--[ [0m[34mMatch #[0m[33m1140[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/workflow/run_workflow.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35m#!/usr/bin/env python[0m
[30;1m2 | [0m[35m[0m
[30;1m3 | [0m[35mimport elasticapm[0m
[30;1m4 | [0m[35mimport time[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom assemblyline_core.server_base import ServerBase[0m
[30;1m7 | [0m[35mfrom assemblyline.common import forge[0m
[30;1m8 | [0m[35mfrom assemblyline.common.isotime import now_as_iso[0m

[31m--[ [0m[34mMatch #[0m[33m1141[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m        except elasticsearch.exceptions.ConflictError as ce:[0m
[30;1m181 | [0m[35m            updated += ce.info.get('updated', 0)[0m
[30;1m182 | [0m[35m            deleted += ce.info.get('deleted', 0)[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m            time.sleep(min(retries, MAX_RETRY_BACKOFF))[0m
[30;1m185 | [0m[35m            retries += 1[0m

[31m--[ [0m[34mMatch #[0m[33m1142[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m178 | [0m[35m            raise[0m
[30;1m179 | [0m[35m[0m
[30;1m180 | [0m[35m        except elasticsearch.exceptions.ConflictError as ce:[0m
[30;1m181 | [0m[35m            updated += ce.info.get('updated', 0)[0m
[30;1m182 | [0m[35m            deleted += ce.info.get('deleted', 0)[0m
[30;1m183 | [0m[35m[0m
[30;1m184 | [0m[35m            time.sleep(min(retries, MAX_RETRY_BACKOFF))[0m

[31m--[ [0m[34mMatch #[0m[33m1143[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m            # Get the shard/replica configuration for metric-based indices from the environment[0m
[30;1m69 | [0m[35m            # Otherwise default to values for a single-node Elastic cluster[0m
[30;1m70 | [0m[35m            replicas = environ.get(f"ELASTIC_{index_type.upper()}_METRICS_REPLICAS", environ.get('EL[0m
[30;1m71 | [0m[35m            shards = environ.get(f"ELASTIC_{index_type.upper()}_METRICS_SHARDS", environ.get('ELASTI[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m            index = f"al_metrics_{index_type}_ds" if datastream_enabled else f"al_metrics_{index_typ[0m
[30;1m74 | [0m[35m            policy = f"{index}_policy"[0m

[31m--[ [0m[34mMatch #[0m[33m1144[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m68 | [0m[35m            # Get the shard/replica configuration for metric-based indices from the environment[0m
[30;1m69 | [0m[35m            # Otherwise default to values for a single-node Elastic cluster[0m
[30;1m70 | [0m[35m            replicas = environ.get(f"ELASTIC_{index_type.upper()}_METRICS_REPLICAS", environ.get('EL[0m
[30;1m71 | [0m[35m            shards = environ.get(f"ELASTIC_{index_type.upper()}_METRICS_SHARDS", environ.get('ELASTI[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m            index = f"al_metrics_{index_type}_ds" if datastream_enabled else f"al_metrics_{index_typ[0m
[30;1m74 | [0m[35m            policy = f"{index}_policy"[0m

[31m--[ [0m[34mMatch #[0m[33m1145[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m        try:[0m
[30;1m68 | [0m[35m            # Get the shard/replica configuration for metric-based indices from the environment[0m
[30;1m69 | [0m[35m            # Otherwise default to values for a single-node Elastic cluster[0m
[30;1m70 | [0m[35m            replicas = environ.get(f"ELASTIC_{index_type.upper()}_METRICS_REPLICAS", environ.get('EL[0m
[30;1m71 | [0m[35m            shards = environ.get(f"ELASTIC_{index_type.upper()}_METRICS_SHARDS", environ.get('ELASTI[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m            index = f"al_metrics_{index_type}_ds" if datastream_enabled else f"al_metrics_{index_typ[0m

[31m--[ [0m[34mMatch #[0m[33m1146[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/helper.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m67 | [0m[35m        try:[0m
[30;1m68 | [0m[35m            # Get the shard/replica configuration for metric-based indices from the environment[0m
[30;1m69 | [0m[35m            # Otherwise default to values for a single-node Elastic cluster[0m
[30;1m70 | [0m[35m            replicas = environ.get(f"ELASTIC_{index_type.upper()}_METRICS_REPLICAS", environ.get('EL[0m
[30;1m71 | [0m[35m            shards = environ.get(f"ELASTIC_{index_type.upper()}_METRICS_SHARDS", environ.get('ELASTI[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m            index = f"al_metrics_{index_type}_ds" if datastream_enabled else f"al_metrics_{index_typ[0m

[31m--[ [0m[34mMatch #[0m[33m1147[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/metrics/helper.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mimport elasticsearch[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mfrom os import environ[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1148[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/replay/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m392 | [0m[35m        self.checkpoint_hash.set(collection, checkpoint)[0m
[30;1m393 | [0m[35m[0m
[30;1m394 | [0m[35m    def _get_checkpoint(self, collection) -> str:[0m
[30;1m395 | [0m[35m        return self.checkpoint_hash.get(collection) or "*"[0m
[30;1m396 | [0m[35m[0m
[30;1m397 | [0m[35m    def _get_next_object_ids(self, collection, query, filter_queries, fl, sort):[0m
[30;1m398 | [0m[35m        return getattr(self.datastore, collection).search(query, fl=fl, sort=sort, rows=100, filters[0m

[31m--[ [0m[34mMatch #[0m[33m1149[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/replay/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m12 | [0m[35mfrom assemblyline_core.safelist_client import SafelistClient[0m
[30;1m13 | [0m[35mfrom assemblyline_core.signature_client import SignatureClient[0m
[30;1m14 | [0m[35m[0m
[30;1m15 | [0m[35mEMPTY_WAIT_TIME = int(os.environ.get('EMPTY_WAIT_TIME', '30'))[0m
[30;1m16 | [0m[35mREPLAY_REQUESTED = 'requested'[0m
[30;1m17 | [0m[35mREPLAY_PENDING = 'pending'[0m
[30;1m18 | [0m[35mREPLAY_DONE = 'done'[0m

[31m--[ [0m[34mMatch #[0m[33m1150[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/replay/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m195 | [0m[35m                # Update checkpoint[0m
[30;1m196 | [0m[35m                checkpoint = obj[date_field][0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m            # Wait if there are no more items to queue at this time[0m
[30;1m199 | [0m[35m            if self._query(collection, f"{date_field}:[{checkpoint} TO now]", fqs, rows=0)['total'] [0m
[30;1m200 | [0m[35m                for _ in range(EMPTY_WAIT_TIME):[0m
[30;1m201 | [0m[35m                    if not self.running:[0m

[31m--[ [0m[34mMatch #[0m[33m1151[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/replay/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m192 | [0m[35m                self.log.info(f"Replaying {collection}: {obj[id_field]}")[0m
[30;1m193 | [0m[35m                # Submit name queue to be tasked to worker(s) for replay[0m
[30;1m194 | [0m[35m                self.put_message(collection, obj)[0m
[30;1m195 | [0m[35m                # Update checkpoint[0m
[30;1m196 | [0m[35m                checkpoint = obj[date_field][0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m            # Wait if there are no more items to queue at this time[0m

[31m--[ [0m[34mMatch #[0m[33m1152[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/replay/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m180 | [0m[35m                break[0m
[30;1m181 | [0m[35m[0m
[30;1m182 | [0m[35m    def _setup_checkpoint_based_input_queue(self, collection: str, id_field: str, date_field: str, o[0m
[30;1m183 | [0m[35m        # At bootstrap, get the last checkpoint[0m
[30;1m184 | [0m[35m        checkpoint = self._get_checkpoint(collection)[0m
[30;1m185 | [0m[35m        fqs = getattr(self, f"{collection}_fqs")[0m
[30;1m186 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1153[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/replay/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m195 | [0m[35m                # Update checkpoint[0m
[30;1m196 | [0m[35m                checkpoint = obj[date_field][0m
[30;1m197 | [0m[35m[0m
[30;1m198 | [0m[35m            # Wait if there are no more items to queue at this time[0m
[30;1m199 | [0m[35m            if self._query(collection, f"{date_field}:[{checkpoint} TO now]", fqs, rows=0)['total'] [0m
[30;1m200 | [0m[35m                for _ in range(EMPTY_WAIT_TIME):[0m
[30;1m201 | [0m[35m                    if not self.running:[0m
[30;1m202 | [0m[35m                        break[0m

[31m--[ [0m[34mMatch #[0m[33m1154[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/replay/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35m        # Run[0m
[30;1m188 | [0m[35m        while self.running:[0m
[30;1m189 | [0m[35m            # Find objects of the collection that haven't been replayed[0m
[30;1m190 | [0m[35m            for obj in self._stream_objects([0m
[30;1m191 | [0m[35m                    collection, f"{date_field}:[{checkpoint} TO now]", fl="*,id", filter_queries=fqs[0m
[30;1m192 | [0m[35m                self.log.info(f"Replaying {collection}: {obj[id_field]}")[0m

[31m--[ [0m[34mMatch #[0m[33m1155[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/replay/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m151 | [0m[35m[0m
[30;1m152 | [0m[35m        # Run[0m
[30;1m153 | [0m[35m        while self.running:[0m
[30;1m154 | [0m[35m            # Find submissions[0m
[30;1m155 | [0m[35m            sub_query = f"times.completed:[{self.last_submission_time} TO now]"[0m
[30;1m156 | [0m[35m            submissions = self._get_next_submission_ids(sub_query, processing_fqs)[0m
[30;1m157 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1156[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/replay/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m112 | [0m[35m[0m
[30;1m113 | [0m[35m        # Run[0m
[30;1m114 | [0m[35m        while self.running:[0m
[30;1m115 | [0m[35m            # Find alerts[0m
[30;1m116 | [0m[35m            alert_input_query = f"reporting_ts:{{{self.last_alert_time} TO now]"[0m
[30;1m117 | [0m[35m            alerts = self._get_next_alert_ids(alert_input_query, processing_fqs)[0m
[30;1m118 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1157[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/replay/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport json[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom assemblyline.common import forge[0m
[30;1m6 | [0m[35mfrom assemblyline.common.bundling import create_bundle, import_bundle[0m
[30;1m7 | [0m[35mfrom assemblyline.odm import Model[0m

[31m--[ [0m[34mMatch #[0m[33m1158[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_worker_ingest.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m        # Check to see if certain properties have been nullified[0m
[30;1m244 | [0m[35m        # (properties that are set outside of submission)[0m
[30;1m245 | [0m[35m        assert not all([new_sub.get(attr) \[0m
[30;1m246 | [0m[35m                        for attr in ['archived', 'archive_ts', 'to_be_deleted', 'from_archive']])[0m
[30;1m247 | [0m[35m    finally:[0m
[30;1m248 | [0m[35m        datastore.filescore.get_if_exists = get_if_exists[0m

[31m--[ [0m[34mMatch #[0m[33m1159[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_worker_ingest.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m        # Check to see if certain properties are different[0m
[30;1m239 | [0m[35m        # (anything that isn't related to analysis but can be set at submission time)[0m
[30;1m240 | [0m[35m        assert all([old_sub.get(attr) != new_sub.get(attr) \[0m
[30;1m241 | [0m[35m                    for attr in ['expiry_ts', 'metadata', 'params', 'times']])[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m        # Check to see if certain properties have been nullified[0m

[31m--[ [0m[34mMatch #[0m[33m1160[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_worker_ingest.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m        # Check to see if certain properties are different[0m
[30;1m239 | [0m[35m        # (anything that isn't related to analysis but can be set at submission time)[0m
[30;1m240 | [0m[35m        assert all([old_sub.get(attr) != new_sub.get(attr) \[0m
[30;1m241 | [0m[35m                    for attr in ['expiry_ts', 'metadata', 'params', 'times']])[0m
[30;1m242 | [0m[35m[0m
[30;1m243 | [0m[35m        # Check to see if certain properties have been nullified[0m

[31m--[ [0m[34mMatch #[0m[33m1161[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_worker_ingest.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m232 | [0m[35m        assert new_sub and new_sub['params']['psid'] == old_sub['sid'][0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m        # Check to see if certain properties are same (anything relating to analysis)[0m
[30;1m235 | [0m[35m        assert all([old_sub.get(attr) == new_sub.get(attr) \[0m
[30;1m236 | [0m[35m                    for attr in ['error_count', 'errors', 'file_count', 'files', 'max_score', 'resul[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m        # Check to see if certain properties are different[0m

[31m--[ [0m[34mMatch #[0m[33m1162[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_worker_ingest.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m232 | [0m[35m        assert new_sub and new_sub['params']['psid'] == old_sub['sid'][0m
[30;1m233 | [0m[35m[0m
[30;1m234 | [0m[35m        # Check to see if certain properties are same (anything relating to analysis)[0m
[30;1m235 | [0m[35m        assert all([old_sub.get(attr) == new_sub.get(attr) \[0m
[30;1m236 | [0m[35m                    for attr in ['error_count', 'errors', 'file_count', 'files', 'max_score', 'resul[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m        # Check to see if certain properties are different[0m

[31m--[ [0m[34mMatch #[0m[33m1163[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_worker_ingest.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m236 | [0m[35m                    for attr in ['error_count', 'errors', 'file_count', 'files', 'max_score', 'resul[0m
[30;1m237 | [0m[35m[0m
[30;1m238 | [0m[35m        # Check to see if certain properties are different[0m
[30;1m239 | [0m[35m        # (anything that isn't related to analysis but can be set at submission time)[0m
[30;1m240 | [0m[35m        assert all([old_sub.get(attr) != new_sub.get(attr) \[0m
[30;1m241 | [0m[35m                    for attr in ['expiry_ts', 'metadata', 'params', 'times']])[0m
[30;1m242 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1164[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_worker_ingest.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport pytest[0m
[30;1m2 | [0m[35mfrom unittest import mock[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35m[0m
[30;1m5 | [0m[35mfrom assemblyline.datastore.helper import AssemblylineDatastore[0m
[30;1m6 | [0m[35mfrom assemblyline.odm.models.user import User[0m
[30;1m7 | [0m[35mfrom assemblyline.odm.models.file import File[0m

[31m--[ [0m[34mMatch #[0m[33m1165[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_plumber.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mfrom unittest import mock[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mfrom assemblyline.odm.messages.task import Task[0m
[30;1m5 | [0m[35mfrom assemblyline.odm.models.service import Service[0m
[30;1m6 | [0m[35mfrom assemblyline.odm.random_data import random_model_obj[0m
[30;1m7 | [0m[35mfrom assemblyline_core.plumber.run_plumber import Plumber[0m
[30;1m8 | [0m[35mfrom assemblyline_core.server_base import ServiceStage[0m
[30;1m9 | [0m[35mfrom mocking import TrueCountTimes[0m

[31m--[ [0m[34mMatch #[0m[33m1166[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_plumber.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mfrom time import sleep[0m
[30;1m2 | [0m[35mfrom unittest import mock[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mfrom assemblyline.odm.messages.task import Task[0m

[31m--[ [0m[34mMatch #[0m[33m1167[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_vacuum.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m5 | [0m[35mimport uuid[0m
[30;1m6 | [0m[35mimport json[0m
[30;1m7 | [0m[35mimport hashlib[0m
[30;1m8 | [0m[35mimport time[0m
[30;1m9 | [0m[35mimport random[0m
[30;1m10 | [0m[35mimport threading[0m
[30;1m11 | [0m[35m[0m
[30;1m12 | [0m[35mfrom assemblyline.odm.models.config import Config, MetadataConfig[0m

[31m--[ [0m[34mMatch #[0m[33m1168[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_expiry.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m65 | [0m[35m            expiry.feed_expiry_jobs(collection=collection, pool=pool, start='*', jobs=[])[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m    for k, v in expiry_collections_len.items():[0m
[30;1m68 | [0m[35m        assert v == expiry.counter.get(k)[0m
[30;1m69 | [0m[35m        collection = getattr(ds_expiry, k)[0m
[30;1m70 | [0m[35m        collection.commit()[0m
[30;1m71 | [0m[35m        assert collection.search("id:*")['total'] == 0[0m

[31m--[ [0m[34mMatch #[0m[33m1169[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/test/test_expiry.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m53 | [0m[35m        self.counts[name] += increment_by[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    def get(self, name):[0m
[30;1m56 | [0m[35m        return self.counts.get(name, 0)[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35mdef test_expire_all(config, ds_expiry, filestore):[0m

[31m--[ [0m[34mMatch #[0m[33m1170[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/safelist.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m    @staticmethod[0m
[30;1m117 | [0m[35m    def optimize(signatures):[0m
[30;1m118 | [0m[35m        for sig in signatures:[0m
[30;1m119 | [0m[35m            conditions = sig.get('conditions')[0m
[30;1m120 | [0m[35m            for k, v in conditions.items():[0m
[30;1m121 | [0m[35m                conditions[k] = _transform(v)[0m
[30;1m122 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m1171[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/safelist.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m    try:[0m
[30;1m94 | [0m[35m        value = cache.get(key, None)[0m
[30;1m95 | [0m[35m        if not value:[0m
[30;1m96 | [0m[35m            cache[key] = value = data.get(key)[0m
[30;1m97 | [0m[35m        if not callable(func):[0m
[30;1m98 | [0m[35m            func = _transform(func)[0m
[30;1m99 | [0m[35m        return {key: value} if func(value) else {}[0m

[31m--[ [0m[34mMatch #[0m[33m1172[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/safelist.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m91 | [0m[35m# noinspection PyBroadException[0m
[30;1m92 | [0m[35mdef _call(cache, data, func, key):[0m
[30;1m93 | [0m[35m    try:[0m
[30;1m94 | [0m[35m        value = cache.get(key, None)[0m
[30;1m95 | [0m[35m        if not value:[0m
[30;1m96 | [0m[35m            cache[key] = value = data.get(key)[0m
[30;1m97 | [0m[35m        if not callable(func):[0m

[31m--[ [0m[34mMatch #[0m[33m1173[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/vacuum/safelist.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m70 | [0m[35m    for sig in sigs:[0m
[30;1m71 | [0m[35m        result = _match(cache, data, sig)[0m
[30;1m72 | [0m[35m        if result:[0m
[30;1m73 | [0m[35m            name = sig.get('name', None)[0m
[30;1m74 | [0m[35m            if not name:[0m
[30;1m75 | [0m[35m                unknown += 1[0m
[30;1m76 | [0m[35m                name = "unknown%d" % unknown[0m

[31m--[ [0m[34mMatch #[0m[33m1174[0m[34m of [0m[33m1174[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/assemblyline_core-4.6.0.dev5/assemblyline_core/scaler/controllers/interface.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mclass ControllerInterface:[0m
[30;1m15 | [0m[35m    def add_profile(self, profile, scale=0):[0m
[30;1m16 | [0m[35m        """Tell the controller about a service profile it needs to manage."""[0m
[30;1m17 | [0m[35m        raise NotImplementedError()[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    def memory_info(self):[0m

1174 matches found.
