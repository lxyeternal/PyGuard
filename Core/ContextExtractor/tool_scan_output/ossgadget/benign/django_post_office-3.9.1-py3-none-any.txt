[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/post_office/tests/test_html_email.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m146 | [0m[35m    def setUp(self) -> None:[0m
[30;1m147 | [0m[35m        self.client = Client()[0m
[30;1m148 | [0m[35m        self.user = get_user_model().objects.create_superuser([0m
[30;1m149 | [0m[35m            username='testuser', password='secret', email='test@example.com'[0m
[30;1m150 | [0m[35m        )[0m
[30;1m151 | [0m[35m        self.client.force_login(self.user)[0m
[30;1m152 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/post_office/tests/test_forms.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m13 | [0m[35m    def setUp(self) -> None:[0m
[30;1m14 | [0m[35m        self.form_set = formset_factory(EmailTemplateAdminForm, extra=2)[0m
[30;1m15 | [0m[35m        self.client = Client()[0m
[30;1m16 | [0m[35m        self.user = User.objects.create_superuser(username='testuser', password='abc123456', email='[0m
[30;1m17 | [0m[35m        self.client.force_login(self.user)[0m
[30;1m18 | [0m[35m[0m
[30;1m19 | [0m[35m    def test_can_create_a_email_template_with_the_same_attributes(self):[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/post_office/tests/test_views.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m16 | [0m[35m    def setUp(self):[0m
[30;1m17 | [0m[35m        user = User.objects.create_superuser(admin_username, admin_email, admin_pass)[0m
[30;1m18 | [0m[35m        self.client = Client()[0m
[30;1m19 | [0m[35m        self.client.login(username=user.username, password=admin_pass)[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m    # Small test to make sure the admin interface is loaded[0m
[30;1m22 | [0m[35m    def test_admin_interface(self):[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/post_office/test_settings.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m59 | [0m[35m    'post_office',[0m
[30;1m60 | [0m[35m)[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35mSECRET_KEY = 'a'[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35mROOT_URLCONF = 'post_office.test_urls'[0m
[30;1m65 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_html_email.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m        # check that inlined images are accessible through Django admin URL[0m
[30;1m187 | [0m[35m        response = self.client.get(email_image_url)[0m
[30;1m188 | [0m[35m        self.assertEqual(response.get('Content-Type'), 'image/png')[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_html_email.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m184 | [0m[35m            self.assertContains(response, 'Testing image attachments')[0m
[30;1m185 | [0m[35m[0m
[30;1m186 | [0m[35m        # check that inlined images are accessible through Django admin URL[0m
[30;1m187 | [0m[35m        response = self.client.get(email_image_url)[0m
[30;1m188 | [0m[35m        self.assertEqual(response.get('Content-Type'), 'image/png')[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_html_email.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m172 | [0m[35m        self.assertEqual(part.get_content_type(), 'image/png')[0m
[30;1m173 | [0m[35m        content_id = part['Content-Id'][1:33][0m
[30;1m174 | [0m[35m        email_change_url = reverse('admin:post_office_email_change', args=(email.pk,))[0m
[30;1m175 | [0m[35m        response = self.client.get(email_change_url, follow=True)[0m
[30;1m176 | [0m[35m        self.assertContains(response, '[Django Post-Office unit tests] attached image')[0m
[30;1m177 | [0m[35m        email_image_url = reverse('admin:post_office_email_image', kwargs={'pk': email.pk, 'content_[0m
[30;1m178 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_html_email.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m139 | [0m[35m        )[0m
[30;1m140 | [0m[35m        queued_mail = Email.objects.get(id=queued_mail.id)[0m
[30;1m141 | [0m[35m        send_queued()[0m
[30;1m142 | [0m[35m        self.assertEqual(Email.objects.get(id=queued_mail.id).status, STATUS.sent)[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35mclass EmailAdminTest(TestCase):[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_html_email.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m137 | [0m[35m            context=context,[0m
[30;1m138 | [0m[35m            render_on_delivery=True,[0m
[30;1m139 | [0m[35m        )[0m
[30;1m140 | [0m[35m        queued_mail = Email.objects.get(id=queued_mail.id)[0m
[30;1m141 | [0m[35m        send_queued()[0m
[30;1m142 | [0m[35m        self.assertEqual(Email.objects.get(id=queued_mail.id).status, STATUS.sent)[0m
[30;1m143 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_mail.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m422 | [0m[35m            to='to@example.com', from_email='from@example.com', template=template, status=STATUS.que[0m
[30;1m423 | [0m[35m        )[0m
[30;1m424 | [0m[35m        _send_bulk([email], uses_multiprocessing=False)[0m
[30;1m425 | [0m[35m        email = Email.objects.get(id=email.id)[0m
[30;1m426 | [0m[35m        self.assertEqual(email.status, STATUS.sent)[0m
[30;1m427 | [0m[35m[0m
[30;1m428 | [0m[35m    @override_settings(USE_TZ=False)[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_mail.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m401 | [0m[35m        email = send([0m
[30;1m402 | [0m[35m            recipients=['to@example.com'], sender='from@example.com', template=template, context=con[0m
[30;1m403 | [0m[35m        )[0m
[30;1m404 | [0m[35m        email = Email.objects.get(id=email.id)[0m
[30;1m405 | [0m[35m        self.assertEqual(email.subject, '–ø—Ä–µ–¥–º–µ—Ç test')[0m
[30;1m406 | [0m[35m[0m
[30;1m407 | [0m[35m        email = send([0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_mail.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m390 | [0m[35m        email = send([0m
[30;1m391 | [0m[35m            recipients=['to@example.com'], sender='from@example.com', template=russian_template, con[0m
[30;1m392 | [0m[35m        )[0m
[30;1m393 | [0m[35m        email = Email.objects.get(id=email.id)[0m
[30;1m394 | [0m[35m        self.assertEqual(email.subject, '–ø—Ä–µ–¥–º–µ—Ç test')[0m
[30;1m395 | [0m[35m        self.assertEqual(email.message, '—Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ test')[0m
[30;1m396 | [0m[35m        self.assertEqual(email.html_message, 'HTML test')[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_mail.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m379 | [0m[35m[0m
[30;1m380 | [0m[35m        context = {'name': 'test'}[0m
[30;1m381 | [0m[35m        email = send(recipients=['to@example.com'], sender='from@example.com', template=template, co[0m
[30;1m382 | [0m[35m        email = Email.objects.get(id=email.id)[0m
[30;1m383 | [0m[35m        self.assertEqual(email.subject, 'Subject test')[0m
[30;1m384 | [0m[35m        self.assertEqual(email.message, 'Content test')[0m
[30;1m385 | [0m[35m        self.assertEqual(email.html_message, 'HTML test')[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_mail.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m            backend_alias='locmem',[0m
[30;1m98 | [0m[35m        )[0m
[30;1m99 | [0m[35m        _send_bulk([email], uses_multiprocessing=False)[0m
[30;1m100 | [0m[35m        self.assertEqual(Email.objects.get(id=email.id).status, STATUS.sent)[0m
[30;1m101 | [0m[35m        self.assertEqual(len(mail.outbox), 1)[0m
[30;1m102 | [0m[35m        self.assertEqual(mail.outbox[0].subject, 'send bulk')[0m
[30;1m103 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_mail.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m62 | [0m[35m        send_queued()[0m
[30;1m63 | [0m[35m        self.assertNotEqual(Email.objects.get(id=failed_mail.id).status, STATUS.sent)[0m
[30;1m64 | [0m[35m        self.assertNotEqual(Email.objects.get(id=none_mail.id).status, STATUS.sent)[0m
[30;1m65 | [0m[35m        self.assertEqual(Email.objects.get(id=queued_mail.id).status, STATUS.sent)[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m    @override_settings(EMAIL_BACKEND='django.core.mail.backends.locmem.EmailBackend')[0m
[30;1m68 | [0m[35m    def test_send_queued_mail_multi_processes(self):[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_mail.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m61 | [0m[35m        queued_mail = Email.objects.create(status=STATUS.queued, **kwargs)[0m
[30;1m62 | [0m[35m        send_queued()[0m
[30;1m63 | [0m[35m        self.assertNotEqual(Email.objects.get(id=failed_mail.id).status, STATUS.sent)[0m
[30;1m64 | [0m[35m        self.assertNotEqual(Email.objects.get(id=none_mail.id).status, STATUS.sent)[0m
[30;1m65 | [0m[35m        self.assertEqual(Email.objects.get(id=queued_mail.id).status, STATUS.sent)[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m    @override_settings(EMAIL_BACKEND='django.core.mail.backends.locmem.EmailBackend')[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_mail.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m        # This should be the only email that gets sent[0m
[30;1m61 | [0m[35m        queued_mail = Email.objects.create(status=STATUS.queued, **kwargs)[0m
[30;1m62 | [0m[35m        send_queued()[0m
[30;1m63 | [0m[35m        self.assertNotEqual(Email.objects.get(id=failed_mail.id).status, STATUS.sent)[0m
[30;1m64 | [0m[35m        self.assertNotEqual(Email.objects.get(id=none_mail.id).status, STATUS.sent)[0m
[30;1m65 | [0m[35m        self.assertEqual(Email.objects.get(id=queued_mail.id).status, STATUS.sent)[0m
[30;1m66 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m535 | [0m[35m        with self.assertRaises(TimeoutError):[0m
[30;1m536 | [0m[35m            send_queued()[0m
[30;1m537 | [0m[35m        end_time = timezone.now()[0m
[30;1m538 | [0m[35m        # Assert that running time is less than 3 seconds (2 seconds timeout + 1 second buffer)[0m
[30;1m539 | [0m[35m        self.assertTrue(end_time - start_time < timezone.timedelta(seconds=3))[0m
[30;1m540 | [0m[35m[0m
[30;1m541 | [0m[35m    @patch('post_office.signals.email_queued.send')[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m535 | [0m[35m        with self.assertRaises(TimeoutError):[0m
[30;1m536 | [0m[35m            send_queued()[0m
[30;1m537 | [0m[35m        end_time = timezone.now()[0m
[30;1m538 | [0m[35m        # Assert that running time is less than 3 seconds (2 seconds timeout + 1 second buffer)[0m
[30;1m539 | [0m[35m        self.assertTrue(end_time - start_time < timezone.timedelta(seconds=3))[0m
[30;1m540 | [0m[35m[0m
[30;1m541 | [0m[35m    @patch('post_office.signals.email_queued.send')[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m531 | [0m[35m        )[0m
[30;1m532 | [0m[35m        start_time = timezone.now()[0m
[30;1m533 | [0m[35m        # slow backend sleeps for 5 seconds, so we should get a timeout error since we set[0m
[30;1m534 | [0m[35m        # BATCH_DELIVERY_TIMEOUT timeout to 2 seconds in test_settings.py[0m
[30;1m535 | [0m[35m        with self.assertRaises(TimeoutError):[0m
[30;1m536 | [0m[35m            send_queued()[0m
[30;1m537 | [0m[35m        end_time = timezone.now()[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m530 | [0m[35m            backend_alias='slow_backend',[0m
[30;1m531 | [0m[35m        )[0m
[30;1m532 | [0m[35m        start_time = timezone.now()[0m
[30;1m533 | [0m[35m        # slow backend sleeps for 5 seconds, so we should get a timeout error since we set[0m
[30;1m534 | [0m[35m        # BATCH_DELIVERY_TIMEOUT timeout to 2 seconds in test_settings.py[0m
[30;1m535 | [0m[35m        with self.assertRaises(TimeoutError):[0m
[30;1m536 | [0m[35m            send_queued()[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m519 | [0m[35m[0m
[30;1m520 | [0m[35m    def test_batch_delivery_timeout(self):[0m
[30;1m521 | [0m[35m        """[0m
[30;1m522 | [0m[35m        Ensure that batch delivery timeout is respected.[0m
[30;1m523 | [0m[35m        """[0m
[30;1m524 | [0m[35m        email = Email.objects.create([0m
[30;1m525 | [0m[35m            to=['to@example.com'],[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m455 | [0m[35m            self.assertEqual(email.number_of_retries, 1)[0m
[30;1m456 | [0m[35m            self.assertEqual(email.scheduled_time, timezone.datetime(2020, 5, 18, 8, 15, 0))[0m
[30;1m457 | [0m[35m[0m
[30;1m458 | [0m[35m        # check that sending after the new scheduled time retries again[0m
[30;1m459 | [0m[35m        with patch('django.utils.timezone.now', side_effect=lambda: timezone.datetime(2020, 5, 18, 8[0m
[30;1m460 | [0m[35m            result = send_queued()[0m
[30;1m461 | [0m[35m            self.assertTupleEqual(result, (0, 0, 1))[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m446 | [0m[35m            self.assertEqual(email.number_of_retries, 1)[0m
[30;1m447 | [0m[35m            self.assertEqual(email.scheduled_time, timezone.datetime(2020, 5, 18, 8, 15, 0))[0m
[30;1m448 | [0m[35m[0m
[30;1m449 | [0m[35m        # check that resending before the new scheduled time doesn't do anything[0m
[30;1m450 | [0m[35m        with patch('django.utils.timezone.now', side_effect=lambda: timezone.datetime(2020, 5, 18, 8[0m
[30;1m451 | [0m[35m            result = send_queued()[0m
[30;1m452 | [0m[35m            self.assertTupleEqual(result, (0, 0, 0))[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m430 | [0m[35m        self.assertEqual(get_retry_timedelta(), timezone.timedelta(minutes=15))[0m
[30;1m431 | [0m[35m        self.assertEqual(get_max_retries(), 2)[0m
[30;1m432 | [0m[35m[0m
[30;1m433 | [0m[35m        # attempt to send email for the first time[0m
[30;1m434 | [0m[35m        with patch('django.utils.timezone.now', side_effect=lambda: timezone.datetime(2020, 5, 18, 8[0m
[30;1m435 | [0m[35m            email = create([0m
[30;1m436 | [0m[35m                'from@example.com', recipients=['to@example.com'], subject='subject', message='messa[0m
[30;1m437 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m6 | [0m[35mfrom zoneinfo import ZoneInfo[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mfrom django.conf import settings[0m
[30;1m9 | [0m[35mfrom django.core import mail[0m
[30;1m10 | [0m[35mfrom django.core.exceptions import ValidationError[0m
[30;1m11 | [0m[35mfrom django.core.files.base import ContentFile[0m
[30;1m12 | [0m[35mfrom django.test import TestCase[0m
[30;1m13 | [0m[35mfrom django.test.utils import override_settings[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport re[0m
[30;1m2 | [0m[35mimport time[0m
[30;1m3 | [0m[35mfrom datetime import timedelta[0m
[30;1m4 | [0m[35mfrom multiprocessing.context import TimeoutError[0m
[30;1m5 | [0m[35mfrom unittest.mock import patch[0m
[30;1m6 | [0m[35mfrom zoneinfo import ZoneInfo[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/admin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m259 | [0m[35m        fields = ['name', 'description', 'subject', 'content', 'html_content', 'language', 'default_[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m    def __init__(self, *args, **kwargs):[0m
[30;1m262 | [0m[35m        instance = kwargs.get('instance')[0m
[30;1m263 | [0m[35m        super().__init__(*args, **kwargs)[0m
[30;1m264 | [0m[35m        if instance and instance.language:[0m
[30;1m265 | [0m[35m            self.fields['language'].disabled = True[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/admin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m208 | [0m[35m    def fetch_email_image(self, request, pk, content_id):[0m
[30;1m209 | [0m[35m        instance = self.get_object(request, pk)[0m
[30;1m210 | [0m[35m        for message in instance.email_message().message().walk():[0m
[30;1m211 | [0m[35m            if message.get_content_maintype() == 'image' and message.get('Content-Id')[1:33] == cont[0m
[30;1m212 | [0m[35m                return HttpResponse(message.get_payload(decode=True), content_type=message.get_conte[0m
[30;1m213 | [0m[35m        return HttpResponseNotFound()[0m
[30;1m214 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/admin.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m49 | [0m[35m            a.id[0m
[30;1m50 | [0m[35m            for a in queryset[0m
[30;1m51 | [0m[35m            if isinstance(a.attachment.headers, dict)[0m
[30;1m52 | [0m[35m            and a.attachment.headers.get('Content-Disposition', '').startswith('inline')[0m
[30;1m53 | [0m[35m        ][0m
[30;1m54 | [0m[35m        return queryset.exclude(id__in=inlined_attachments)[0m
[30;1m55 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_models.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mfrom datetime import datetime, timedelta[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom django.conf import settings as django_settings, settings[0m
[30;1m7 | [0m[35mfrom django.core import mail[0m
[30;1m8 | [0m[35mfrom django.core import serializers[0m
[30;1m9 | [0m[35mfrom django.core.files.base import ContentFile[0m
[30;1m10 | [0m[35mfrom django.core.mail import EmailMessage, EmailMultiAlternatives[0m
[30;1m11 | [0m[35mfrom django.forms.models import modelform_factory[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/template/backends/post_office.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m            'file_charset',[0m
[30;1m36 | [0m[35m            settings.FILE_CHARSET if settings.is_overridden('FILE_CHARSET') else 'utf-8',[0m
[30;1m37 | [0m[35m        )[0m
[30;1m38 | [0m[35m        libraries = options.get('libraries', {})[0m
[30;1m39 | [0m[35m        options['libraries'] = self.get_templatetag_libraries(libraries)[0m
[30;1m40 | [0m[35m        super().__init__(params)[0m
[30;1m41 | [0m[35m        self.engine = Engine(self.dirs, self.app_dirs, **options)[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m19 | [0m[35m[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35mdef get(name):[0m
[30;1m22 | [0m[35m    return cache_backend.get(get_cache_key(name))[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mdef delete(name):[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/management/commands/send_queued_mail.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m        )[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    def handle(self, *args, **options):[0m
[30;1m30 | [0m[35m        send_queued_mail_until_done(options['lockfile'], options['processes'], options.get('log_leve[0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_lockfile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m66 | [0m[35m        with FileLock('test', timeout=timeout, force=True):[0m
[30;1m67 | [0m[35m            assert True[0m
[30;1m68 | [0m[35m        end = time.time()[0m
[30;1m69 | [0m[35m        assert end - start > timeout[0m
[30;1m70 | [0m[35m[0m
[30;1m71 | [0m[35m    def test_get_lock_pid(self):[0m
[30;1m72 | [0m[35m        """Ensure get_lock_pid() works properly"""[0m
[30;1m73 | [0m[35m        with FileLock('test', timeout=1, force=True) as lock:[0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_lockfile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m61 | [0m[35m        with open(lockfile, 'w+') as f:[0m
[30;1m62 | [0m[35m            f.write(str(os.getpid()))[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35m        timeout = 1[0m
[30;1m65 | [0m[35m        start = time.time()[0m
[30;1m66 | [0m[35m        with FileLock('test', timeout=timeout, force=True):[0m
[30;1m67 | [0m[35m            assert True[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_lockfile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mimport os[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mfrom django.test import TestCase[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/django_post_office-3.9.1.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m878 | [0m[35m[0m
[30;1m879 | [0m[35mFull changelog can be found [here](https://github.com/ui/django-post_office/blob/master/CHANGELOG.md[0m
[30;1m880 | [0m[35m[0m
[30;1m881 | [0m[35mCreated and maintained by the cool guys at [Stamps](https://stamps.co.id), Indonesia's most elegant[0m
[30;1m882 | [0m[35mCRM/loyalty platform.[0m
[30;1m883 | [0m[35m[0m
[30;1m884 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/django_post_office-3.9.1.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m841 | [0m[35m[0m
[30;1m842 | [0m[35mAlternatively you can also use the decorator[0m
[30;1m843 | [0m[35m`@uwsgidecorators.cron(minute, hour, day, month, weekday)`. This will[0m
[30;1m844 | [0m[35mschedule a task at specific times. Use `-1` to signal any time, it[0m
[30;1m845 | [0m[35mcorresponds to the `*` in cron.[0m
[30;1m846 | [0m[35m[0m
[30;1m847 | [0m[35mPlease note that `uwsgidecorators` are available only, if the[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/django_post_office-3.9.1.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m656 | [0m[35m### Threads[0m
[30;1m657 | [0m[35m[0m
[30;1m658 | [0m[35m`post-office` >= 3.0 allows you to use multiple threads to dramatically[0m
[30;1m659 | [0m[35mspeed up the speed at which emails are sent. By default, `post-office`[0m
[30;1m660 | [0m[35muses 5 threads per process. You can tweak this setting by changing[0m
[30;1m661 | [0m[35m`THREADS_PER_PROCESS` setting.[0m
[30;1m662 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/django_post_office-3.9.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m854 | [0m[35m[0m
[30;1m855 | [0m[35m## Signals[0m
[30;1m856 | [0m[35m[0m
[30;1m857 | [0m[35mEach time an email is added to the mail queue, Post Office emits a[0m
[30;1m858 | [0m[35mspecial [Django[0m
[30;1m859 | [0m[35msignal](https://docs.djangoproject.com/en/stable/topics/signals/).[0m
[30;1m860 | [0m[35mWhenever a third party application wants to be informed about this[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/django_post_office-3.9.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m854 | [0m[35m[0m
[30;1m855 | [0m[35m## Signals[0m
[30;1m856 | [0m[35m[0m
[30;1m857 | [0m[35mEach time an email is added to the mail queue, Post Office emits a[0m
[30;1m858 | [0m[35mspecial [Django[0m
[30;1m859 | [0m[35msignal](https://docs.djangoproject.com/en/stable/topics/signals/).[0m
[30;1m860 | [0m[35mWhenever a third party application wants to be informed about this[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/django_post_office-3.9.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m849 | [0m[35m`./manange.py runserver` also access this file, therefore wrap the block[0m
[30;1m850 | [0m[35minto an exception handler as shown above.[0m
[30;1m851 | [0m[35m[0m
[30;1m852 | [0m[35mThis configuration can be useful in environments, such as Docker[0m
[30;1m853 | [0m[35mcontainers, where you don't have a running cron-daemon.[0m
[30;1m854 | [0m[35m[0m
[30;1m855 | [0m[35m## Signals[0m
[30;1m856 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/django_post_office-3.9.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m832 | [0m[35m[0m
[30;1m833 | [0m[35m    @uwsgidecorators.timer(10)[0m
[30;1m834 | [0m[35m    def send_queued_mail(num):[0m
[30;1m835 | [0m[35m        """Send queued mail every 10 seconds"""[0m
[30;1m836 | [0m[35m        call_command('send_queued_mail', processes=1)[0m
[30;1m837 | [0m[35m[0m
[30;1m838 | [0m[35mexcept ImportError:[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/django_post_office-3.9.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m751 | [0m[35mIf your Django project runs in a Celery enabled configuration, you can use its worker to send out[0m
[30;1m752 | [0m[35mqueued emails. Compared to the solution with cron (see above), or the solution with uWSGI timers[0m
[30;1m753 | [0m[35m(see below) this setup has the big advantage that queued emails are send *immediately* after they[0m
[30;1m754 | [0m[35mhave been added to the mail queue. The delivery is still performed in a separate and asynchronous[0m
[30;1m755 | [0m[35mtask, which prevents sending emails during the request/response-cycle.[0m
[30;1m756 | [0m[35m[0m
[30;1m757 | [0m[35mIf you [configured Celery](https://docs.celeryproject.org/en/latest/userguide/application.html)[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/django_post_office-3.9.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m704 | [0m[35marguments that you'd usually pass into `mail.send()`:[0m
[30;1m705 | [0m[35m[0m
[30;1m706 | [0m[35m```python[0m
[30;1m707 | [0m[35mfrom post_office import mail[0m
[30;1m708 | [0m[35m[0m
[30;1m709 | [0m[35mfirst_email = {[0m
[30;1m710 | [0m[35m    'sender': 'from@example.com',[0m
[30;1m711 | [0m[35m    'recipients': ['alice@example.com'],[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/django_post_office-3.9.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m555 | [0m[35m### Retry[0m
[30;1m556 | [0m[35m[0m
[30;1m557 | [0m[35mNot activated by default. You can automatically requeue failed email deliveries.[0m
[30;1m558 | [0m[35mYou can also configure failed deliveries to be retried after a specific time interval.[0m
[30;1m559 | [0m[35m[0m
[30;1m560 | [0m[35m```python[0m
[30;1m561 | [0m[35m# Put this in settings.py[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/django_post_office-3.9.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m462 | [0m[35m```[0m
[30;1m463 | [0m[35m[0m
[30;1m464 | [0m[35mVersion 3.8 introduces a companion setting called `BATCH_DELIVERY_TIMEOUT`. This setting[0m
[30;1m465 | [0m[35mspecifies the maximum time allowed for each batch to be delivered, this is useful to guard against[0m
[30;1m466 | [0m[35mcases where delivery process never terminates. Defaults to 180.[0m
[30;1m467 | [0m[35m[0m
[30;1m468 | [0m[35mIf you send a large number of emails in a single batch on a slow connection, consider increasing thi[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/django_post_office-3.9.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m228 | [0m[35m[0m
[30;1m229 | [0m[35m```python[0m
[30;1m230 | [0m[35mfrom post_office.models import EmailTemplate[0m
[30;1m231 | [0m[35mfrom post_office import mail[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35mEmailTemplate.objects.create([0m
[30;1m234 | [0m[35m    name='morning_greeting',[0m
[30;1m235 | [0m[35m    subject='Morning, {{ name|capfirst }}',[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/django_post_office-3.9.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35m```python[0m
[30;1m206 | [0m[35mfrom django.core.files.base import ContentFile[0m
[30;1m207 | [0m[35mfrom post_office import mail[0m
[30;1m208 | [0m[35m[0m
[30;1m209 | [0m[35mmail.send([0m
[30;1m210 | [0m[35m    ['recipient1@example.com'],[0m
[30;1m211 | [0m[35m    'from@example.com',[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/django_post_office-3.9.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m186 | [0m[35mit), regardless of how many emails you have in your queue:[0m
[30;1m187 | [0m[35m[0m
[30;1m188 | [0m[35m```python[0m
[30;1m189 | [0m[35mfrom post_office import mail[0m
[30;1m190 | [0m[35m[0m
[30;1m191 | [0m[35mmail.send([0m
[30;1m192 | [0m[35m    ['recipient1@example.com'],[0m
[30;1m193 | [0m[35m    'from@example.com',[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/django_post_office-3.9.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m167 | [0m[35mYou can call the `send` command without the `template` argument.[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35m```python[0m
[30;1m170 | [0m[35mfrom post_office import mail[0m
[30;1m171 | [0m[35m[0m
[30;1m172 | [0m[35mmail.send([0m
[30;1m173 | [0m[35m    ['recipient1@example.com'],[0m
[30;1m174 | [0m[35m    'from@example.com',[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/django_post_office-3.9.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m116 | [0m[35mfollowing:[0m
[30;1m117 | [0m[35m[0m
[30;1m118 | [0m[35m```python[0m
[30;1m119 | [0m[35mfrom post_office import mail[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35mmail.send([0m
[30;1m122 | [0m[35m    'recipient@example.com', # List of email addresses also accepted[0m
[30;1m123 | [0m[35m    'from@example.com',[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/django_post_office-3.9.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m100 | [0m[35mSend a simple email is really easy:[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m```python[0m
[30;1m103 | [0m[35mfrom post_office import mail[0m
[30;1m104 | [0m[35m[0m
[30;1m105 | [0m[35mmail.send([0m
[30;1m106 | [0m[35m    'recipient@example.com', # List of email addresses also accepted[0m
[30;1m107 | [0m[35m    'from@example.com',[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/django_post_office-3.9.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m70 | [0m[35m[![PyPI](https://img.shields.io/pypi/l/django-post_office.svg)]()[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35m```sh[0m
[30;1m74 | [0m[35mpip install django-post_office[0m
[30;1m75 | [0m[35m```[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35mAdd `post_office` to your INSTALLED_APPS in django's `settings.py`:[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/django_post_office-3.9.1.dist-info/METADATA[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mMetadata-Version: 2.1[0m
[30;1m2 | [0m[35mName: django-post-office[0m
[30;1m3 | [0m[35mVersion: 3.9.1[0m
[30;1m4 | [0m[35mSummary: A Django app to monitor and send mail asynchronously, complete with template support.[0m
[30;1m5 | [0m[35mHome-page: https://github.com/ui/django-post_office[0m
[30;1m6 | [0m[35mAuthor: Selwin Ong[0m
[30;1m7 | [0m[35mAuthor-email: selwin.ong@gmail.com[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tasks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m45 | [0m[35m    def cleanup_mail(*args, **kwargs):[0m
[30;1m46 | [0m[35m        days = kwargs.get('days', 90)[0m
[30;1m47 | [0m[35m        cutoff_date = now() - datetime.timedelta(days)[0m
[30;1m48 | [0m[35m        delete_attachments = kwargs.get('delete_attachments', True)[0m
[30;1m49 | [0m[35m        cleanup_expired_mails(cutoff_date, delete_attachments)[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tasks.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m    @shared_task(ignore_result=True)[0m
[30;1m45 | [0m[35m    def cleanup_mail(*args, **kwargs):[0m
[30;1m46 | [0m[35m        days = kwargs.get('days', 90)[0m
[30;1m47 | [0m[35m        cutoff_date = now() - datetime.timedelta(days)[0m
[30;1m48 | [0m[35m        delete_attachments = kwargs.get('delete_attachments', True)[0m
[30;1m49 | [0m[35m        cleanup_expired_mails(cutoff_date, delete_attachments)[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tasks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m37 | [0m[35m[0m
[30;1m38 | [0m[35m    def queued_mail_handler(sender, **kwargs):[0m
[30;1m39 | [0m[35m        """[0m
[30;1m40 | [0m[35m        Trigger an asynchronous mail delivery.[0m
[30;1m41 | [0m[35m        """[0m
[30;1m42 | [0m[35m        send_queued_mail.delay()[0m
[30;1m43 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tasks.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m24 | [0m[35m    def queued_mail_handler(sender, **kwargs):[0m
[30;1m25 | [0m[35m        """[0m
[30;1m26 | [0m[35m        To be called by :func:`post_office.signals.email_queued.send()` for triggering asynchronous[0m
[30;1m27 | [0m[35m        mail delivery ‚Äì if provided by an external queue, such as Celery.[0m
[30;1m28 | [0m[35m        """[0m
[30;1m29 | [0m[35melse:[0m
[30;1m30 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_forms.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m        add_template_url = reverse('admin:post_office_emailtemplate_add')[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        response = self.client.post(add_template_url, email_template, follow=True)[0m
[30;1m63 | [0m[35m        self.assertContains(response, 'Duplicate template for language &#39;Spanish&#39;.', html=Tru[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/models.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35mclass EmailTemplateManager(models.Manager):[0m
[30;1m263 | [0m[35m    def get_by_natural_key(self, name, language, default_template):[0m
[30;1m264 | [0m[35m        return self.get(name=name, language=language, default_template=default_template)[0m
[30;1m265 | [0m[35m[0m
[30;1m266 | [0m[35m[0m
[30;1m267 | [0m[35mclass EmailTemplate(models.Model):[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/models.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m228 | [0m[35m[0m
[30;1m229 | [0m[35m    def clean(self):[0m
[30;1m230 | [0m[35m        if self.scheduled_time and self.expires_at and self.scheduled_time > self.expires_at:[0m
[30;1m231 | [0m[35m            raise ValidationError(_('The scheduled time may not be later than the expires time.'))[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m    def save(self, *args, **kwargs):[0m
[30;1m234 | [0m[35m        self.full_clean()[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_views.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m27 | [0m[35m        """Ensure that changing an email object in admin works."""[0m
[30;1m28 | [0m[35m        mail.send(recipients=['test@example.com'], headers={'foo': 'bar'})[0m
[30;1m29 | [0m[35m        email = Email.objects.latest('id')[0m
[30;1m30 | [0m[35m        response = self.client.get(reverse('admin:post_office_email_change', args=[email.id]))[0m
[30;1m31 | [0m[35m        self.assertEqual(response.status_code, 200)[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_views.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m    # Small test to make sure the admin interface is loaded[0m
[30;1m22 | [0m[35m    def test_admin_interface(self):[0m
[30;1m23 | [0m[35m        response = self.client.get(reverse('admin:index'))[0m
[30;1m24 | [0m[35m        self.assertEqual(response.status_code, 200)[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def test_admin_change_page(self):[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_views.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m3 | [0m[35mfrom django.test import TestCase[0m
[30;1m4 | [0m[35mfrom django.urls import reverse[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom post_office import mail[0m
[30;1m7 | [0m[35mfrom post_office.models import Email[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m[0m
[30;1m10 | [0m[35madmin_username = 'real_test_admin'[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/mail.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m377 | [0m[35m    #     try:[0m
[30;1m378 | [0m[35m    #         # Wait for all tasks to complete with a timeout[0m
[30;1m379 | [0m[35m    #         # The get method is used with a timeout to wait for each result[0m
[30;1m380 | [0m[35m    #         result.get(timeout=timeout)[0m
[30;1m381 | [0m[35m    #     except TimeoutError:[0m
[30;1m382 | [0m[35m    #         logger.exception("Process timed out after %d seconds" % timeout)[0m
[30;1m383 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/mail.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m372 | [0m[35m    # Wait for all tasks to complete with a timeout[0m
[30;1m373 | [0m[35m    # The get method is used with a timeout to wait for each result[0m
[30;1m374 | [0m[35m    for result in results:[0m
[30;1m375 | [0m[35m        result.get(timeout=timeout)[0m
[30;1m376 | [0m[35m    # for result in results:[0m
[30;1m377 | [0m[35m    #     try:[0m
[30;1m378 | [0m[35m    #         # Wait for all tasks to complete with a timeout[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/mail.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m301 | [0m[35m            #     try:[0m
[30;1m302 | [0m[35m            #         # Wait for all tasks to complete with a timeout[0m
[30;1m303 | [0m[35m            #         # The get method is used with a timeout to wait for each result[0m
[30;1m304 | [0m[35m            #         results.append(task.get(timeout=timeout))[0m
[30;1m305 | [0m[35m            #     except (TimeoutError, ContextTimeoutError):[0m
[30;1m306 | [0m[35m            #         logger.exception("Process timed out after %d seconds" % timeout)[0m
[30;1m307 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/mail.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m296 | [0m[35m            # Wait for all tasks to complete with a timeout[0m
[30;1m297 | [0m[35m            # The get method is used with a timeout to wait for each result[0m
[30;1m298 | [0m[35m            for task in tasks:[0m
[30;1m299 | [0m[35m                results.append(task.get(timeout=timeout))[0m
[30;1m300 | [0m[35m            # for task in tasks:[0m
[30;1m301 | [0m[35m            #     try:[0m
[30;1m302 | [0m[35m            #         # Wait for all tasks to complete with a timeout[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/mail.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m188 | [0m[35m            template = template[0m
[30;1m189 | [0m[35m            # If language is specified, ensure template uses the right language[0m
[30;1m190 | [0m[35m            if language and template.language != language:[0m
[30;1m191 | [0m[35m                template = template.translated_templates.get(language=language)[0m
[30;1m192 | [0m[35m        else:[0m
[30;1m193 | [0m[35m            template = get_email_template(template, language)[0m
[30;1m194 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/mail.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m452 | [0m[35m    """[0m
[30;1m453 | [0m[35m    try:[0m
[30;1m454 | [0m[35m        with FileLock(lockfile):[0m
[30;1m455 | [0m[35m            logger.info('Acquired lock for sending queued emails at %s.lock', lockfile)[0m
[30;1m456 | [0m[35m            while True:[0m
[30;1m457 | [0m[35m                try:[0m
[30;1m458 | [0m[35m                    send_queued(processes, log_level)[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/mail.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m390 | [0m[35m    email_ids = [email.id for email in sent_emails][0m
[30;1m391 | [0m[35m    Email.objects.filter(id__in=email_ids).update(status=STATUS.sent)[0m
[30;1m392 | [0m[35m[0m
[30;1m393 | [0m[35m    # Update statuses and conditionally requeue failed emails[0m
[30;1m394 | [0m[35m    num_failed, num_requeued = 0, 0[0m
[30;1m395 | [0m[35m    max_retries = get_max_retries()[0m
[30;1m396 | [0m[35m    scheduled_time = timezone.now() + get_retry_timedelta()[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/mail.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m386 | [0m[35m[0m
[30;1m387 | [0m[35m    connections.close()[0m
[30;1m388 | [0m[35m[0m
[30;1m389 | [0m[35m    # Update statuses of sent emails[0m
[30;1m390 | [0m[35m    email_ids = [email.id for email in sent_emails][0m
[30;1m391 | [0m[35m    Email.objects.filter(id__in=email_ids).update(status=STATUS.sent)[0m
[30;1m392 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m448 | [0m[35m[0m
[30;1m449 | [0m[35mdef send_queued_mail_until_done(lockfile=default_lockfile, processes=1, log_level=None):[0m
[30;1m450 | [0m[35m    """[0m
[30;1m451 | [0m[35m    Send mail in queue batch by batch, until all emails have been processed.[0m
[30;1m452 | [0m[35m    """[0m
[30;1m453 | [0m[35m    try:[0m
[30;1m454 | [0m[35m        with FileLock(lockfile):[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m376 | [0m[35m    # for result in results:[0m
[30;1m377 | [0m[35m    #     try:[0m
[30;1m378 | [0m[35m    #         # Wait for all tasks to complete with a timeout[0m
[30;1m379 | [0m[35m    #         # The get method is used with a timeout to wait for each result[0m
[30;1m380 | [0m[35m    #         result.get(timeout=timeout)[0m
[30;1m381 | [0m[35m    #     except TimeoutError:[0m
[30;1m382 | [0m[35m    #         logger.exception("Process timed out after %d seconds" % timeout)[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m375 | [0m[35m        result.get(timeout=timeout)[0m
[30;1m376 | [0m[35m    # for result in results:[0m
[30;1m377 | [0m[35m    #     try:[0m
[30;1m378 | [0m[35m    #         # Wait for all tasks to complete with a timeout[0m
[30;1m379 | [0m[35m    #         # The get method is used with a timeout to wait for each result[0m
[30;1m380 | [0m[35m    #         result.get(timeout=timeout)[0m
[30;1m381 | [0m[35m    #     except TimeoutError:[0m
[30;1m382 | [0m[35m    #         logger.exception("Process timed out after %d seconds" % timeout)[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m370 | [0m[35m    timeout = get_batch_delivery_timeout()[0m
[30;1m371 | [0m[35m[0m
[30;1m372 | [0m[35m    # Wait for all tasks to complete with a timeout[0m
[30;1m373 | [0m[35m    # The get method is used with a timeout to wait for each result[0m
[30;1m374 | [0m[35m    for result in results:[0m
[30;1m375 | [0m[35m        result.get(timeout=timeout)[0m
[30;1m376 | [0m[35m    # for result in results:[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m369 | [0m[35m[0m
[30;1m370 | [0m[35m    timeout = get_batch_delivery_timeout()[0m
[30;1m371 | [0m[35m[0m
[30;1m372 | [0m[35m    # Wait for all tasks to complete with a timeout[0m
[30;1m373 | [0m[35m    # The get method is used with a timeout to wait for each result[0m
[30;1m374 | [0m[35m    for result in results:[0m
[30;1m375 | [0m[35m        result.get(timeout=timeout)[0m
[30;1m376 | [0m[35m    # for result in results:[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m367 | [0m[35m    for email in emails:[0m
[30;1m368 | [0m[35m        results.append(pool.apply_async(send, args=(email,)))[0m
[30;1m369 | [0m[35m[0m
[30;1m370 | [0m[35m    timeout = get_batch_delivery_timeout()[0m
[30;1m371 | [0m[35m[0m
[30;1m372 | [0m[35m    # Wait for all tasks to complete with a timeout[0m
[30;1m373 | [0m[35m    # The get method is used with a timeout to wait for each result[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m300 | [0m[35m            # for task in tasks:[0m
[30;1m301 | [0m[35m            #     try:[0m
[30;1m302 | [0m[35m            #         # Wait for all tasks to complete with a timeout[0m
[30;1m303 | [0m[35m            #         # The get method is used with a timeout to wait for each result[0m
[30;1m304 | [0m[35m            #         results.append(task.get(timeout=timeout))[0m
[30;1m305 | [0m[35m            #     except (TimeoutError, ContextTimeoutError):[0m
[30;1m306 | [0m[35m            #         logger.exception("Process timed out after %d seconds" % timeout)[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m299 | [0m[35m                results.append(task.get(timeout=timeout))[0m
[30;1m300 | [0m[35m            # for task in tasks:[0m
[30;1m301 | [0m[35m            #     try:[0m
[30;1m302 | [0m[35m            #         # Wait for all tasks to complete with a timeout[0m
[30;1m303 | [0m[35m            #         # The get method is used with a timeout to wait for each result[0m
[30;1m304 | [0m[35m            #         results.append(task.get(timeout=timeout))[0m
[30;1m305 | [0m[35m            #     except (TimeoutError, ContextTimeoutError):[0m
[30;1m306 | [0m[35m            #         logger.exception("Process timed out after %d seconds" % timeout)[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m294 | [0m[35m            results = [][0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m            # Wait for all tasks to complete with a timeout[0m
[30;1m297 | [0m[35m            # The get method is used with a timeout to wait for each result[0m
[30;1m298 | [0m[35m            for task in tasks:[0m
[30;1m299 | [0m[35m                results.append(task.get(timeout=timeout))[0m
[30;1m300 | [0m[35m            # for task in tasks:[0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m293 | [0m[35m            timeout = get_batch_delivery_timeout()[0m
[30;1m294 | [0m[35m            results = [][0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m            # Wait for all tasks to complete with a timeout[0m
[30;1m297 | [0m[35m            # The get method is used with a timeout to wait for each result[0m
[30;1m298 | [0m[35m            for task in tasks:[0m
[30;1m299 | [0m[35m                results.append(task.get(timeout=timeout))[0m
[30;1m300 | [0m[35m            # for task in tasks:[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m290 | [0m[35m            for email_list in email_lists:[0m
[30;1m291 | [0m[35m                tasks.append(pool.apply_async(_send_bulk, args=(email_list,)))[0m
[30;1m292 | [0m[35m[0m
[30;1m293 | [0m[35m            timeout = get_batch_delivery_timeout()[0m
[30;1m294 | [0m[35m            results = [][0m
[30;1m295 | [0m[35m[0m
[30;1m296 | [0m[35m            # Wait for all tasks to complete with a timeout[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m245 | [0m[35m    Returns the queryset of emails eligible for sending ‚Äì fulfilling these conditions:[0m
[30;1m246 | [0m[35m     - Status is queued or requeued[0m
[30;1m247 | [0m[35m     - Has scheduled_time before the current time or is None[0m
[30;1m248 | [0m[35m     - Has expires_at after the current time or is None[0m
[30;1m249 | [0m[35m    """[0m
[30;1m250 | [0m[35m    now = timezone.now()[0m
[30;1m251 | [0m[35m    query = (Q(scheduled_time__lte=now) | Q(scheduled_time=None)) & (Q(expires_at__gt=now) | Q(expir[0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/mail.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m244 | [0m[35m    """[0m
[30;1m245 | [0m[35m    Returns the queryset of emails eligible for sending ‚Äì fulfilling these conditions:[0m
[30;1m246 | [0m[35m     - Status is queued or requeued[0m
[30;1m247 | [0m[35m     - Has scheduled_time before the current time or is None[0m
[30;1m248 | [0m[35m     - Has expires_at after the current time or is None[0m
[30;1m249 | [0m[35m    """[0m
[30;1m250 | [0m[35m    now = timezone.now()[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/lockfile.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m125 | [0m[35m        if hasattr(os, 'symlink') and platform.system() != 'Windows':[0m
[30;1m126 | [0m[35m            os.symlink(self.pid_filename, self.lock_filename)[0m
[30;1m127 | [0m[35m        else:[0m
[30;1m128 | [0m[35m            # Windows platforms doesn't support symlinks, at least not through the os API[0m
[30;1m129 | [0m[35m            self.lock_filename = self.pid_filename[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m    def release(self):[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/lockfile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m104 | [0m[35m            else:[0m
[30;1m105 | [0m[35m                return True[0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m        # check one last time[0m
[30;1m108 | [0m[35m        if self.valid_lock():[0m
[30;1m109 | [0m[35m            if self.force:[0m
[30;1m110 | [0m[35m                self.release()[0m
[30;1m111 | [0m[35m            else:[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/lockfile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m33 | [0m[35mclass FileLock:[0m
[30;1m34 | [0m[35m    def __init__(self, lock_filename, timeout=None, force=False):[0m
[30;1m35 | [0m[35m        self.lock_filename = '%s.lock' % lock_filename[0m
[30;1m36 | [0m[35m        self.timeout = timeout[0m
[30;1m37 | [0m[35m        self.force = force[0m
[30;1m38 | [0m[35m        self._pid = str(os.getpid())[0m
[30;1m39 | [0m[35m        # Store pid in a file in the same directory as desired lockname[0m
[30;1m40 | [0m[35m        self.pid_filename = os.path.join(os.path.dirname(self.lock_filename), self._pid) + '.lock'[0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/lockfile.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35mimport os[0m
[30;1m22 | [0m[35mimport platform[0m
[30;1m23 | [0m[35mimport tempfile[0m
[30;1m24 | [0m[35mimport time[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35mfrom post_office.settings import get_lock_file_name[0m
[30;1m27 | [0m[35m[0m
[30;1m28 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m37 | [0m[35m        cache.set('test-cache', 'awesome content')[0m
[30;1m38 | [0m[35m        self.assertTrue('awesome content', cache.get('test-cache'))[0m
[30;1m39 | [0m[35m        cache.delete('test-cache')[0m
[30;1m40 | [0m[35m        self.assertEqual(None, cache.get('test-cache'))[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m        cache.cache_backend.clear()[0m
[30;1m36 | [0m[35m        self.assertEqual(None, cache.get('test-cache'))[0m
[30;1m37 | [0m[35m        cache.set('test-cache', 'awesome content')[0m
[30;1m38 | [0m[35m        self.assertTrue('awesome content', cache.get('test-cache'))[0m
[30;1m39 | [0m[35m        cache.delete('test-cache')[0m
[30;1m40 | [0m[35m        self.assertEqual(None, cache.get('test-cache'))[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_cache.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m33 | [0m[35m        """[0m
[30;1m34 | [0m[35m        # clean test cache[0m
[30;1m35 | [0m[35m        cache.cache_backend.clear()[0m
[30;1m36 | [0m[35m        self.assertEqual(None, cache.get('test-cache'))[0m
[30;1m37 | [0m[35m        cache.set('test-cache', 'awesome content')[0m
[30;1m38 | [0m[35m        self.assertTrue('awesome content', cache.get('test-cache'))[0m
[30;1m39 | [0m[35m        cache.delete('test-cache')[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_backends.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m155 | [0m[35m        self.assertEqual(email.attachments.all()[0].name, 'dummy.png')[0m
[30;1m156 | [0m[35m        self.assertEqual(email.attachments.all()[0].file.read(), image.get_payload().encode())[0m
[30;1m157 | [0m[35m        self.assertEqual(email.attachments.all()[0].headers.get('Content-ID'), '<{dummy.png}>')[0m
[30;1m158 | [0m[35m        self.assertEqual(email.attachments.all()[0].headers.get('Content-Disposition'), 'inline; fil[0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35m    @override_settings([0m
[30;1m161 | [0m[35m        EMAIL_BACKEND='post_office.EmailBackend',[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/tests/test_backends.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m        self.assertEqual(email.attachments.count(), 1)[0m
[30;1m155 | [0m[35m        self.assertEqual(email.attachments.all()[0].name, 'dummy.png')[0m
[30;1m156 | [0m[35m        self.assertEqual(email.attachments.all()[0].file.read(), image.get_payload().encode())[0m
[30;1m157 | [0m[35m        self.assertEqual(email.attachments.all()[0].headers.get('Content-ID'), '<{dummy.png}>')[0m
[30;1m158 | [0m[35m        self.assertEqual(email.attachments.all()[0].headers.get('Content-Disposition'), 'inline; fil[0m
[30;1m159 | [0m[35m[0m
[30;1m160 | [0m[35m    @override_settings([0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m94 | [0m[35m        if isinstance(filedata, dict):[0m
[30;1m95 | [0m[35m            content = filedata.get('file', None)[0m
[30;1m96 | [0m[35m            mimetype = filedata.get('mimetype', None)[0m
[30;1m97 | [0m[35m            headers = filedata.get('headers', None)[0m
[30;1m98 | [0m[35m        else:[0m
[30;1m99 | [0m[35m            content = filedata[0m
[30;1m100 | [0m[35m            mimetype = None[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m    for filename, filedata in attachment_files.items():[0m
[30;1m94 | [0m[35m        if isinstance(filedata, dict):[0m
[30;1m95 | [0m[35m            content = filedata.get('file', None)[0m
[30;1m96 | [0m[35m            mimetype = filedata.get('mimetype', None)[0m
[30;1m97 | [0m[35m            headers = filedata.get('headers', None)[0m
[30;1m98 | [0m[35m        else:[0m
[30;1m99 | [0m[35m            content = filedata[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m92 | [0m[35m    attachments = [][0m
[30;1m93 | [0m[35m    for filename, filedata in attachment_files.items():[0m
[30;1m94 | [0m[35m        if isinstance(filedata, dict):[0m
[30;1m95 | [0m[35m            content = filedata.get('file', None)[0m
[30;1m96 | [0m[35m            mimetype = filedata.get('mimetype', None)[0m
[30;1m97 | [0m[35m            headers = filedata.get('headers', None)[0m
[30;1m98 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m63 | [0m[35m        email_template = cache.get(composite_name)[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m        if email_template is None:[0m
[30;1m66 | [0m[35m            email_template = EmailTemplate.objects.get(name=name, language=language)[0m
[30;1m67 | [0m[35m            cache.set(composite_name, email_template)[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m        return email_template[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m60 | [0m[35m        return EmailTemplate.objects.get(name=name, language=language)[0m
[30;1m61 | [0m[35m    else:[0m
[30;1m62 | [0m[35m        composite_name = '%s:%s' % (name, language)[0m
[30;1m63 | [0m[35m        email_template = cache.get(composite_name)[0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35m        if email_template is None:[0m
[30;1m66 | [0m[35m            email_template = EmailTemplate.objects.get(name=name, language=language)[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m57 | [0m[35m    if use_cache:[0m
[30;1m58 | [0m[35m        use_cache = getattr(settings, 'POST_OFFICE_TEMPLATE_CACHE', True)[0m
[30;1m59 | [0m[35m    if not use_cache:[0m
[30;1m60 | [0m[35m        return EmailTemplate.objects.get(name=name, language=language)[0m
[30;1m61 | [0m[35m    else:[0m
[30;1m62 | [0m[35m        composite_name = '%s:%s' % (name, language)[0m
[30;1m63 | [0m[35m        email_template = cache.get(composite_name)[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m21 | [0m[35m    priority=PRIORITY.medium,[0m
[30;1m22 | [0m[35m):[0m
[30;1m23 | [0m[35m    """[0m
[30;1m24 | [0m[35m    Add a new message to the mail queue. This is a replacement for Django's[0m
[30;1m25 | [0m[35m    ``send_mail`` core email method.[0m
[30;1m26 | [0m[35m    """[0m
[30;1m27 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m130 | [0m[35m    return get_config().get('BATCH_DELIVERY_TIMEOUT', 180)[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35mCONTEXT_FIELD_CLASS = get_config().get('CONTEXT_FIELD_CLASS', 'django.db.models.JSONField')[0m
[30;1m134 | [0m[35mcontext_field_class = import_string(CONTEXT_FIELD_CLASS)[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m# BATCH_DELIVERY_TIMEOUT defaults to 180 seconds (3 minutes)[0m
[30;1m129 | [0m[35mdef get_batch_delivery_timeout():[0m
[30;1m130 | [0m[35m    return get_config().get('BATCH_DELIVERY_TIMEOUT', 180)[0m
[30;1m131 | [0m[35m[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35mCONTEXT_FIELD_CLASS = get_config().get('CONTEXT_FIELD_CLASS', 'django.db.models.JSONField')[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35mdef get_message_id_fqdn():[0m
[30;1m125 | [0m[35m    return get_config().get('MESSAGE_ID_FQDN', DNS_NAME)[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35m[0m
[30;1m128 | [0m[35m# BATCH_DELIVERY_TIMEOUT defaults to 180 seconds (3 minutes)[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35mdef get_message_id_enabled():[0m
[30;1m121 | [0m[35m    return get_config().get('MESSAGE_ID_ENABLED', False)[0m
[30;1m122 | [0m[35m[0m
[30;1m123 | [0m[35m[0m
[30;1m124 | [0m[35mdef get_message_id_fqdn():[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35mdef get_retry_timedelta():[0m
[30;1m117 | [0m[35m    return get_config().get('RETRY_INTERVAL', datetime.timedelta(minutes=15))[0m
[30;1m118 | [0m[35m[0m
[30;1m119 | [0m[35m[0m
[30;1m120 | [0m[35mdef get_message_id_enabled():[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35mdef get_max_retries():[0m
[30;1m113 | [0m[35m    return get_config().get('MAX_RETRIES', 0)[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35mdef get_retry_timedelta():[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35mdef get_override_recipients():[0m
[30;1m109 | [0m[35m    return get_config().get('OVERRIDE_RECIPIENTS', None)[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35mdef get_max_retries():[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35mdef get_template_engine():[0m
[30;1m104 | [0m[35m    using = get_config().get('TEMPLATE_ENGINE', 'django')[0m
[30;1m105 | [0m[35m    return template_engines[using][0m
[30;1m106 | [0m[35m[0m
[30;1m107 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35mdef get_sending_order():[0m
[30;1m100 | [0m[35m    return get_config().get('SENDING_ORDER', ['-priority'])[0m
[30;1m101 | [0m[35m[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35mdef get_template_engine():[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35mdef get_log_level():[0m
[30;1m96 | [0m[35m    return get_config().get('LOG_LEVEL', 2)[0m
[30;1m97 | [0m[35m[0m
[30;1m98 | [0m[35m[0m
[30;1m99 | [0m[35mdef get_sending_order():[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35mdef get_default_priority():[0m
[30;1m92 | [0m[35m    return get_config().get('DEFAULT_PRIORITY', 'medium')[0m
[30;1m93 | [0m[35m[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35mdef get_log_level():[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35mdef get_threads_per_process():[0m
[30;1m88 | [0m[35m    return get_config().get('THREADS_PER_PROCESS', 5)[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35mdef get_default_priority():[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35mdef get_lock_file_name():[0m
[30;1m84 | [0m[35m    return get_config().get('LOCK_FILE_NAME', 'post_office')[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35mdef get_threads_per_process():[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35mdef get_celery_enabled():[0m
[30;1m80 | [0m[35m    return get_config().get('CELERY_ENABLED', False)[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35mdef get_lock_file_name():[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35mdef get_batch_size():[0m
[30;1m76 | [0m[35m    return get_config().get('BATCH_SIZE', 100)[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m[0m
[30;1m79 | [0m[35mdef get_celery_enabled():[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m    # POST_OFFICE = {[0m
[30;1m32 | [0m[35m    #     'EMAIL_BACKEND': 'mybackend'[0m
[30;1m33 | [0m[35m    # }[0m
[30;1m34 | [0m[35m    backend = get_config().get('EMAIL_BACKEND')[0m
[30;1m35 | [0m[35m    if backend:[0m
[30;1m36 | [0m[35m        warnings.warn('Please use the new POST_OFFICE["BACKENDS"] settings', DeprecationWarning)[0m
[30;1m37 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m120[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/post_office/settings.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m22 | [0m[35m        'locmem': 'django.core.mail.backends.locmem.EmailBackend',[0m
[30;1m23 | [0m[35m    }[0m
[30;1m24 | [0m[35m    """[0m
[30;1m25 | [0m[35m    backends = get_config().get('BACKENDS', {})[0m
[30;1m26 | [0m[35m[0m
[30;1m27 | [0m[35m    if backends:[0m
[30;1m28 | [0m[35m        return backends[0m

120 matches found.
