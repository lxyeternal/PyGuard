[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/ttypes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m24120 | [0m[35m    None,  # 0[0m
[30;1m24121 | [0m[35m    (1, TType.I32, 'client_protocol', None,     -7, ),  # 1[0m
[30;1m24122 | [0m[35m    (2, TType.STRING, 'username', 'UTF8', None, ),  # 2[0m
[30;1m24123 | [0m[35m    (3, TType.STRING, 'password', 'UTF8', None, ),  # 3[0m
[30;1m24124 | [0m[35m    (4, TType.MAP, 'configuration', (TType.STRING, 'UTF8', TType.STRING, 'UTF8', False), None, ),  #[0m
[30;1m24125 | [0m[35m    None,  # 5[0m
[30;1m24126 | [0m[35m    None,  # 6[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/ttypes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m4865 | [0m[35m            oprot.writeFieldEnd()[0m
[30;1m4866 | [0m[35m        if self.password is not None:[0m
[30;1m4867 | [0m[35m            oprot.writeFieldBegin('password', TType.STRING, 3)[0m
[30;1m4868 | [0m[35m            oprot.writeString(self.password.encode('utf-8') if sys.version_info[0] == 2 else self.pa[0m
[30;1m4869 | [0m[35m            oprot.writeFieldEnd()[0m
[30;1m4870 | [0m[35m        if self.configuration is not None:[0m
[30;1m4871 | [0m[35m            oprot.writeFieldBegin('configuration', TType.MAP, 4)[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/ttypes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m4865 | [0m[35m            oprot.writeFieldEnd()[0m
[30;1m4866 | [0m[35m        if self.password is not None:[0m
[30;1m4867 | [0m[35m            oprot.writeFieldBegin('password', TType.STRING, 3)[0m
[30;1m4868 | [0m[35m            oprot.writeString(self.password.encode('utf-8') if sys.version_info[0] == 2 else self.pa[0m
[30;1m4869 | [0m[35m            oprot.writeFieldEnd()[0m
[30;1m4870 | [0m[35m        if self.configuration is not None:[0m
[30;1m4871 | [0m[35m            oprot.writeFieldBegin('configuration', TType.MAP, 4)[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/ttypes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m4864 | [0m[35m            oprot.writeString(self.username.encode('utf-8') if sys.version_info[0] == 2 else self.us[0m
[30;1m4865 | [0m[35m            oprot.writeFieldEnd()[0m
[30;1m4866 | [0m[35m        if self.password is not None:[0m
[30;1m4867 | [0m[35m            oprot.writeFieldBegin('password', TType.STRING, 3)[0m
[30;1m4868 | [0m[35m            oprot.writeString(self.password.encode('utf-8') if sys.version_info[0] == 2 else self.pa[0m
[30;1m4869 | [0m[35m            oprot.writeFieldEnd()[0m
[30;1m4870 | [0m[35m        if self.configuration is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/ttypes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m4863 | [0m[35m            oprot.writeFieldBegin('username', TType.STRING, 2)[0m
[30;1m4864 | [0m[35m            oprot.writeString(self.username.encode('utf-8') if sys.version_info[0] == 2 else self.us[0m
[30;1m4865 | [0m[35m            oprot.writeFieldEnd()[0m
[30;1m4866 | [0m[35m        if self.password is not None:[0m
[30;1m4867 | [0m[35m            oprot.writeFieldBegin('password', TType.STRING, 3)[0m
[30;1m4868 | [0m[35m            oprot.writeString(self.password.encode('utf-8') if sys.version_info[0] == 2 else self.pa[0m
[30;1m4869 | [0m[35m            oprot.writeFieldEnd()[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/ttypes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m4788 | [0m[35m                    iprot.skip(ftype)[0m
[30;1m4789 | [0m[35m            elif fid == 3:[0m
[30;1m4790 | [0m[35m                if ftype == TType.STRING:[0m
[30;1m4791 | [0m[35m                    self.password = iprot.readString().decode('utf-8', errors='replace') if sys.vers[0m
[30;1m4792 | [0m[35m                else:[0m
[30;1m4793 | [0m[35m                    iprot.skip(ftype)[0m
[30;1m4794 | [0m[35m            elif fid == 4:[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/ttypes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m4758 | [0m[35m    def __init__(self, client_protocol=    -7, username=None, password=None, configuration=None, get[0m
[30;1m4759 | [0m[35m        self.client_protocol = client_protocol[0m
[30;1m4760 | [0m[35m        self.username = username[0m
[30;1m4761 | [0m[35m        self.password = password[0m
[30;1m4762 | [0m[35m        self.configuration = configuration[0m
[30;1m4763 | [0m[35m        self.getInfos = getInfos[0m
[30;1m4764 | [0m[35m        self.client_protocol_i64 = client_protocol_i64[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/ttypes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m4758 | [0m[35m    def __init__(self, client_protocol=    -7, username=None, password=None, configuration=None, get[0m
[30;1m4759 | [0m[35m        self.client_protocol = client_protocol[0m
[30;1m4760 | [0m[35m        self.username = username[0m
[30;1m4761 | [0m[35m        self.password = password[0m
[30;1m4762 | [0m[35m        self.configuration = configuration[0m
[30;1m4763 | [0m[35m        self.getInfos = getInfos[0m
[30;1m4764 | [0m[35m        self.client_protocol_i64 = client_protocol_i64[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/ttypes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m4755 | [0m[35m    """[0m
[30;1m4756 | [0m[35m[0m
[30;1m4757 | [0m[35m[0m
[30;1m4758 | [0m[35m    def __init__(self, client_protocol=    -7, username=None, password=None, configuration=None, get[0m
[30;1m4759 | [0m[35m        self.client_protocol = client_protocol[0m
[30;1m4760 | [0m[35m        self.username = username[0m
[30;1m4761 | [0m[35m        self.password = password[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/ttypes.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m4743 | [0m[35m    Attributes:[0m
[30;1m4744 | [0m[35m     - client_protocol[0m
[30;1m4745 | [0m[35m     - username[0m
[30;1m4746 | [0m[35m     - password[0m
[30;1m4747 | [0m[35m     - configuration[0m
[30;1m4748 | [0m[35m     - getInfos[0m
[30;1m4749 | [0m[35m     - client_protocol_i64[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/types.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m63 | [0m[35m            ssl_context.load_cert_chain([0m
[30;1m64 | [0m[35m                certfile=self.tls_client_cert_file,[0m
[30;1m65 | [0m[35m                keyfile=self.tls_client_cert_key_file,[0m
[30;1m66 | [0m[35m                password=self.tls_client_cert_key_password,[0m
[30;1m67 | [0m[35m            )[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m        return ssl_context[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/types.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m63 | [0m[35m            ssl_context.load_cert_chain([0m
[30;1m64 | [0m[35m                certfile=self.tls_client_cert_file,[0m
[30;1m65 | [0m[35m                keyfile=self.tls_client_cert_key_file,[0m
[30;1m66 | [0m[35m                password=self.tls_client_cert_key_password,[0m
[30;1m67 | [0m[35m            )[0m
[30;1m68 | [0m[35m[0m
[30;1m69 | [0m[35m        return ssl_context[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/types.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m44 | [0m[35m        self.tls_trusted_ca_file = tls_trusted_ca_file[0m
[30;1m45 | [0m[35m        self.tls_client_cert_file = tls_client_cert_file[0m
[30;1m46 | [0m[35m        self.tls_client_cert_key_file = tls_client_cert_key_file[0m
[30;1m47 | [0m[35m        self.tls_client_cert_key_password = tls_client_cert_key_password[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m    def create_ssl_context(self) -> SSLContext:[0m
[30;1m50 | [0m[35m        ssl_context = create_default_context(cafile=self.tls_trusted_ca_file)[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/types.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m44 | [0m[35m        self.tls_trusted_ca_file = tls_trusted_ca_file[0m
[30;1m45 | [0m[35m        self.tls_client_cert_file = tls_client_cert_file[0m
[30;1m46 | [0m[35m        self.tls_client_cert_key_file = tls_client_cert_key_file[0m
[30;1m47 | [0m[35m        self.tls_client_cert_key_password = tls_client_cert_key_password[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m    def create_ssl_context(self) -> SSLContext:[0m
[30;1m50 | [0m[35m        ssl_context = create_default_context(cafile=self.tls_trusted_ca_file)[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/types.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m37 | [0m[35m        tls_trusted_ca_file: Optional[str] = None,[0m
[30;1m38 | [0m[35m        tls_client_cert_file: Optional[str] = None,[0m
[30;1m39 | [0m[35m        tls_client_cert_key_file: Optional[str] = None,[0m
[30;1m40 | [0m[35m        tls_client_cert_key_password: Optional[str] = None,[0m
[30;1m41 | [0m[35m    ):[0m
[30;1m42 | [0m[35m        self.tls_verify = tls_verify[0m
[30;1m43 | [0m[35m        self.tls_verify_hostname = tls_verify_hostname[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/types.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m28 | [0m[35m    tls_trusted_ca_file: Optional[str][0m
[30;1m29 | [0m[35m    tls_client_cert_file: Optional[str][0m
[30;1m30 | [0m[35m    tls_client_cert_key_file: Optional[str][0m
[30;1m31 | [0m[35m    tls_client_cert_key_password: Optional[str][0m
[30;1m32 | [0m[35m[0m
[30;1m33 | [0m[35m    def __init__([0m
[30;1m34 | [0m[35m        self,[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/CHANGELOG.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m63 | [0m[35m- Add option to disable SSL verification for CloudFetch links (databricks/databricks-sql-python#414 [0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35mDatabricks-managed passwords reached end of life on July 10, 2024. Therefore, Basic auth support was[0m
[30;1m66 | [0m[35mthe library. See https://docs.databricks.com/en/security/auth-authz/password-deprecation.html[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35mThe existing option `_tls_no_verify=True` of `sql.connect(...)` will now also disable SSL cert verif[0m
[30;1m69 | [0m[35m(but not the SSL itself) for CloudFetch links. This option should be used as a workaround only, when[0m

[31m--[ [0m[34mMatch #[0m[33m18[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/CHANGELOG.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m62 | [0m[35m- Refactor CloudFetch handler to fix numerous issues with it (databricks/databricks-sql-python#405 b[0m
[30;1m63 | [0m[35m- Add option to disable SSL verification for CloudFetch links (databricks/databricks-sql-python#414 [0m
[30;1m64 | [0m[35m[0m
[30;1m65 | [0m[35mDatabricks-managed passwords reached end of life on July 10, 2024. Therefore, Basic auth support was[0m
[30;1m66 | [0m[35mthe library. See https://docs.databricks.com/en/security/auth-authz/password-deprecation.html[0m
[30;1m67 | [0m[35m[0m
[30;1m68 | [0m[35mThe existing option `_tls_no_verify=True` of `sql.connect(...)` will now also disable SSL cert verif[0m

[31m--[ [0m[34mMatch #[0m[33m19[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/CHANGELOG.md[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m58 | [0m[35m# 3.3.0 (2024-07-18)[0m
[30;1m59 | [0m[35m[0m
[30;1m60 | [0m[35m- Don't retry requests that fail with HTTP code 401 (databricks/databricks-sql-python#408 by @Hodneb[0m
[30;1m61 | [0m[35m- Remove username/password (aka "basic") auth option (databricks/databricks-sql-python#409 by @jacky[0m
[30;1m62 | [0m[35m- Refactor CloudFetch handler to fix numerous issues with it (databricks/databricks-sql-python#405 b[0m
[30;1m63 | [0m[35m- Add option to disable SSL verification for CloudFetch links (databricks/databricks-sql-python#414 [0m
[30;1m64 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m20[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m96 | [0m[35m    ):[0m
[30;1m97 | [0m[35m        # Internal arguments in **kwargs:[0m
[30;1m98 | [0m[35m        # _username, _password[0m
[30;1m99 | [0m[35m        #   Username and password Basic authentication (no official support)[0m
[30;1m100 | [0m[35m        # _connection_uri[0m
[30;1m101 | [0m[35m        #   Overrides server_hostname and http_path.[0m
[30;1m102 | [0m[35m        # RETRY/ATTEMPT POLICY[0m

[31m--[ [0m[34mMatch #[0m[33m21[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m95 | [0m[35m        **kwargs,[0m
[30;1m96 | [0m[35m    ):[0m
[30;1m97 | [0m[35m        # Internal arguments in **kwargs:[0m
[30;1m98 | [0m[35m        # _username, _password[0m
[30;1m99 | [0m[35m        #   Username and password Basic authentication (no official support)[0m
[30;1m100 | [0m[35m        # _connection_uri[0m
[30;1m101 | [0m[35m        #   Overrides server_hostname and http_path.[0m

[31m--[ [0m[34mMatch #[0m[33m22[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000801[0m
       Tag: [34mSecurity.Backdoor.ExecuteObfuscatedCode[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){5,}[0m
[30;1m1101 | [0m[35m        """Return a hexadecimal string instead of bytes[0m
[30;1m1102 | [0m[35m[0m
[30;1m1103 | [0m[35m        Example:[0m
[30;1m1104 | [0m[35m            IN   b'\x01\xee\x1d)\xa4\x19\x1d\xb6\xa9\xc0\x8d\xf1\xfe\xbaB\xdd'[0m
[30;1m1105 | [0m[35m            OUT  '01ee1d29-a419-1db6-a9c0-8df1feba42dd'[0m
[30;1m1106 | [0m[35m[0m
[30;1m1107 | [0m[35m        If conversion to hexadecimal fails, the original bytes are returned[0m

[31m--[ [0m[34mMatch #[0m[33m23[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m74 | [0m[35m                    )[0m
[30;1m75 | [0m[35m                    logger.error(msg)[0m
[30;1m76 | [0m[35m                    raise Exception(msg)[0m
[30;1m77 | [0m[35m                return OAuthToken([0m
[30;1m78 | [0m[35m                    token_as_json["access_token"], token_as_json["refresh_token"][0m
[30;1m79 | [0m[35m                )[0m
[30;1m80 | [0m[35m        except Exception as e:[0m

[31m--[ [0m[34mMatch #[0m[33m24[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m59 | [0m[35m        with open(self._file_path, "w") as outfile:[0m
[30;1m60 | [0m[35m            outfile.write(json_object)[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    def read(self, hostname: str) -> Optional[OAuthToken]:[0m
[30;1m63 | [0m[35m        try:[0m
[30;1m64 | [0m[35m            with open(self._file_path, "r") as infile:[0m
[30;1m65 | [0m[35m                json_as_string = infile.read()[0m

[31m--[ [0m[34mMatch #[0m[33m25[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m43 | [0m[35m    def __init__(self, file_path):[0m
[30;1m44 | [0m[35m        self._file_path = file_path[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    def persist(self, hostname: str, token: OAuthToken):[0m
[30;1m47 | [0m[35m        logger.info(f"persisting token in {self._file_path}")[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m        # Data to be written[0m

[31m--[ [0m[34mMatch #[0m[33m26[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m34 | [0m[35m    def persist(self, hostname: str, oauth_token: OAuthToken):[0m
[30;1m35 | [0m[35m        self.tokens[hostname] = oauth_token[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    def read(self, hostname: str) -> Optional[OAuthToken]:[0m
[30;1m38 | [0m[35m        return self.tokens.get(hostname)[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m27[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m32 | [0m[35m        self.tokens = {}[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    def persist(self, hostname: str, oauth_token: OAuthToken):[0m
[30;1m35 | [0m[35m        self.tokens[hostname] = oauth_token[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    def read(self, hostname: str) -> Optional[OAuthToken]:[0m
[30;1m38 | [0m[35m        return self.tokens.get(hostname)[0m

[31m--[ [0m[34mMatch #[0m[33m28[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m31 | [0m[35m    def __init__(self):[0m
[30;1m32 | [0m[35m        self.tokens = {}[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    def persist(self, hostname: str, oauth_token: OAuthToken):[0m
[30;1m35 | [0m[35m        self.tokens[hostname] = oauth_token[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    def read(self, hostname: str) -> Optional[OAuthToken]:[0m

[31m--[ [0m[34mMatch #[0m[33m29[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m31 | [0m[35m    def __init__(self):[0m
[30;1m32 | [0m[35m        self.tokens = {}[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    def persist(self, hostname: str, oauth_token: OAuthToken):[0m
[30;1m35 | [0m[35m        self.tokens[hostname] = oauth_token[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    def read(self, hostname: str) -> Optional[OAuthToken]:[0m

[31m--[ [0m[34mMatch #[0m[33m30[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m23 | [0m[35m    def persist(self, hostname: str, oauth_token: OAuthToken):[0m
[30;1m24 | [0m[35m        pass[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def read(self, hostname: str) -> Optional[OAuthToken]:[0m
[30;1m27 | [0m[35m        pass[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m31[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mclass OAuthPersistence:[0m
[30;1m23 | [0m[35m    def persist(self, hostname: str, oauth_token: OAuthToken):[0m
[30;1m24 | [0m[35m        pass[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def read(self, hostname: str) -> Optional[OAuthToken]:[0m

[31m--[ [0m[34mMatch #[0m[33m32[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mclass OAuthPersistence:[0m
[30;1m23 | [0m[35m    def persist(self, hostname: str, oauth_token: OAuthToken):[0m
[30;1m24 | [0m[35m        pass[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def read(self, hostname: str) -> Optional[OAuthToken]:[0m

[31m--[ [0m[34mMatch #[0m[33m33[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m5 | [0m[35mlogger = logging.getLogger(__name__)[0m
[30;1m6 | [0m[35m[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mclass OAuthToken:[0m
[30;1m9 | [0m[35m    def __init__(self, access_token, refresh_token):[0m
[30;1m10 | [0m[35m        self._access_token = access_token[0m
[30;1m11 | [0m[35m        self._refresh_token = refresh_token[0m

[31m--[ [0m[34mMatch #[0m[33m34[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m255 | [0m[35m            tls_trusted_ca_file=kwargs.get("_tls_trusted_ca_file"),[0m
[30;1m256 | [0m[35m            tls_client_cert_file=kwargs.get("_tls_client_cert_file"),[0m
[30;1m257 | [0m[35m            tls_client_cert_key_file=kwargs.get("_tls_client_cert_key_file"),[0m
[30;1m258 | [0m[35m            tls_client_cert_key_password=kwargs.get("_tls_client_cert_key_password"),[0m
[30;1m259 | [0m[35m        )[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m        self.thrift_backend = ThriftBackend([0m

[31m--[ [0m[34mMatch #[0m[33m35[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m255 | [0m[35m            tls_trusted_ca_file=kwargs.get("_tls_trusted_ca_file"),[0m
[30;1m256 | [0m[35m            tls_client_cert_file=kwargs.get("_tls_client_cert_file"),[0m
[30;1m257 | [0m[35m            tls_client_cert_key_file=kwargs.get("_tls_client_cert_key_file"),[0m
[30;1m258 | [0m[35m            tls_client_cert_key_password=kwargs.get("_tls_client_cert_key_password"),[0m
[30;1m259 | [0m[35m        )[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m        self.thrift_backend = ThriftBackend([0m

[31m--[ [0m[34mMatch #[0m[33m36[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m194 | [0m[35m        # _tls_trusted_ca_file[0m
[30;1m195 | [0m[35m        #   Set to the path of the file containing trusted CA certificates for server certificate[0m
[30;1m196 | [0m[35m        #   verification. If not provide, uses system truststore.[0m
[30;1m197 | [0m[35m        # _tls_client_cert_file, _tls_client_cert_key_file, _tls_client_cert_key_password[0m
[30;1m198 | [0m[35m        #   Set client SSL certificate.[0m
[30;1m199 | [0m[35m        #   See https://docs.python.org/3/library/ssl.html#ssl.SSLContext.load_cert_chain[0m
[30;1m200 | [0m[35m        # _retry_stop_after_attempts_count[0m

[31m--[ [0m[34mMatch #[0m[33m37[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m142 | [0m[35m                    def persist(self, token: OAuthToken):[0m
[30;1m143 | [0m[35m                        # implement this method to persist token.refresh_token and token.access_toke[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m                    def read(self) -> Optional[OAuthToken]:[0m
[30;1m146 | [0m[35m                        # implement this method to return an instance of the persisted token[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m38[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m139 | [0m[35m                    def __init__(self, file_path):[0m
[30;1m140 | [0m[35m                        self._file_path = file_path[0m
[30;1m141 | [0m[35m[0m
[30;1m142 | [0m[35m                    def persist(self, token: OAuthToken):[0m
[30;1m143 | [0m[35m                        # implement this method to persist token.refresh_token and token.access_toke[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35m                    def read(self) -> Optional[OAuthToken]:[0m

[31m--[ [0m[34mMatch #[0m[33m39[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m                For persisting the oauth token in a prod environment you should subclass and impleme[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m                from databricks.sql.experimental.oauth_persistence import OAuthPersistence, OAuthTok[0m
[30;1m138 | [0m[35m                class MyCustomImplementation(OAuthPersistence):[0m
[30;1m139 | [0m[35m                    def __init__(self, file_path):[0m
[30;1m140 | [0m[35m                        self._file_path = file_path[0m

[31m--[ [0m[34mMatch #[0m[33m40[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000702[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Environment[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m(env|environment).{1,50}(get|post|curl|nc|invoke-restmethod)[0m
[30;1m132 | [0m[35m                restarts the end user will have to login again.[0m
[30;1m133 | [0m[35m                Note this is beta (private preview)[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m                For persisting the oauth token in a prod environment you should subclass and impleme[0m
[30;1m136 | [0m[35m[0m
[30;1m137 | [0m[35m                from databricks.sql.experimental.oauth_persistence import OAuthPersistence, OAuthTok[0m
[30;1m138 | [0m[35m                class MyCustomImplementation(OAuthPersistence):[0m

[31m--[ [0m[34mMatch #[0m[33m41[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m108 | [0m[35m    )[0m
[30;1m109 | [0m[35m    if kwargs.get("username") or kwargs.get("password"):[0m
[30;1m110 | [0m[35m        raise ValueError([0m
[30;1m111 | [0m[35m            "Username/password authentication is no longer supported. "[0m
[30;1m112 | [0m[35m            "Please use OAuth or access token instead."[0m
[30;1m113 | [0m[35m        )[0m
[30;1m114 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m42[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m106 | [0m[35m    (client_id, redirect_port_range) = get_client_id_and_redirect_port([0m
[30;1m107 | [0m[35m        auth_type == AuthType.AZURE_OAUTH.value[0m
[30;1m108 | [0m[35m    )[0m
[30;1m109 | [0m[35m    if kwargs.get("username") or kwargs.get("password"):[0m
[30;1m110 | [0m[35m        raise ValueError([0m
[30;1m111 | [0m[35m            "Username/password authentication is no longer supported. "[0m
[30;1m112 | [0m[35m            "Please use OAuth or access token instead."[0m

[31m--[ [0m[34mMatch #[0m[33m43[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/authenticators.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport abc[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport logging[0m
[30;1m4 | [0m[35mfrom typing import Callable, Dict, List[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m44[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/authenticators.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m131 | [0m[35m                self._refresh_token = fresh_refresh_token[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m                if self._oauth_persistence:[0m
[30;1m134 | [0m[35m                    token = OAuthToken(self._access_token, self._refresh_token)[0m
[30;1m135 | [0m[35m                    self._oauth_persistence.persist(self._hostname, token)[0m
[30;1m136 | [0m[35m        except Exception as e:[0m
[30;1m137 | [0m[35m            logging.error(f"unexpected error in oauth token update", e, exc_info=True)[0m

[31m--[ [0m[34mMatch #[0m[33m45[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/authenticators.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m                if self._oauth_persistence:[0m
[30;1m109 | [0m[35m                    self._oauth_persistence.persist([0m
[30;1m110 | [0m[35m                        self._hostname, OAuthToken(access_token, refresh_token)[0m
[30;1m111 | [0m[35m                    )[0m
[30;1m112 | [0m[35m        except Exception as e:[0m
[30;1m113 | [0m[35m            logging.error(f"unexpected error in oauth initialization", e, exc_info=True)[0m

[31m--[ [0m[34mMatch #[0m[33m46[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/authenticators.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35m# Private API: this is an evolving interface and it will change in the future.[0m
[30;1m10 | [0m[35m# Please must not depend on it in your applications.[0m
[30;1m11 | [0m[35mfrom databricks.sql.experimental.oauth_persistence import OAuthToken, OAuthPersistence[0m
[30;1m12 | [0m[35m[0m
[30;1m13 | [0m[35m[0m
[30;1m14 | [0m[35mclass AuthProvider:[0m

[31m--[ [0m[34mMatch #[0m[33m47[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/thrift_http_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m210 | [0m[35m            return None[0m
[30;1m211 | [0m[35m        ap = "%s:%s" % ([0m
[30;1m212 | [0m[35m            urllib.parse.unquote(proxy.username),[0m
[30;1m213 | [0m[35m            urllib.parse.unquote(proxy.password),[0m
[30;1m214 | [0m[35m        )[0m
[30;1m215 | [0m[35m        return make_headers(proxy_basic_auth=ap)[0m
[30;1m216 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m48[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/thrift_http_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m121 | [0m[35m                    "ca_certs": self._ssl_options.tls_trusted_ca_file,[0m
[30;1m122 | [0m[35m                    "cert_file": self._ssl_options.tls_client_cert_file,[0m
[30;1m123 | [0m[35m                    "key_file": self._ssl_options.tls_client_cert_key_file,[0m
[30;1m124 | [0m[35m                    "key_password": self._ssl_options.tls_client_cert_key_password,[0m
[30;1m125 | [0m[35m                }[0m
[30;1m126 | [0m[35m            )[0m
[30;1m127 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m49[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000701[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Token[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/thrift_http_client.py[0m
   Pattern: [32m(npm owner|password|htpasswd|auth_?token|secret_?key|private_?key|authorized_keys?|npmrc|\.ssh|usersecrets?|api_?keys|nuget\.config|\.identityservice)[0m
[30;1m121 | [0m[35m                    "ca_certs": self._ssl_options.tls_trusted_ca_file,[0m
[30;1m122 | [0m[35m                    "cert_file": self._ssl_options.tls_client_cert_file,[0m
[30;1m123 | [0m[35m                    "key_file": self._ssl_options.tls_client_cert_key_file,[0m
[30;1m124 | [0m[35m                    "key_password": self._ssl_options.tls_client_cert_key_password,[0m
[30;1m125 | [0m[35m                }[0m
[30;1m126 | [0m[35m            )[0m
[30;1m127 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m50[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/thrift_http_client.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport logging[0m
[30;1m3 | [0m[35mimport urllib.parse[0m
[30;1m4 | [0m[35mfrom typing import Dict, Union, Optional[0m

[31m--[ [0m[34mMatch #[0m[33m51[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/oauth.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m205 | [0m[35m            access_token_payload = access_token_payload + "=" * ([0m
[30;1m206 | [0m[35m                -len(access_token_payload) % 4[0m
[30;1m207 | [0m[35m            )[0m
[30;1m208 | [0m[35m            decoded = json.loads(base64.standard_b64decode(access_token_payload))[0m
[30;1m209 | [0m[35m            expiration_time = datetime.fromtimestamp(decoded["exp"], tz=timezone.utc)[0m
[30;1m210 | [0m[35m        except Exception as e:[0m
[30;1m211 | [0m[35m            logger.error(e)[0m

[31m--[ [0m[34mMatch #[0m[33m52[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/oauth.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m91 | [0m[35m        verifier_string = OAuthManager.__token_urlsafe(32)[0m
[30;1m92 | [0m[35m        digest = hashlib.sha256(verifier_string.encode("UTF-8")).digest()[0m
[30;1m93 | [0m[35m        challenge_string = ([0m
[30;1m94 | [0m[35m            base64.urlsafe_b64encode(digest).decode("UTF-8").replace("=", "")[0m
[30;1m95 | [0m[35m        )[0m
[30;1m96 | [0m[35m        return verifier_string, challenge_string[0m
[30;1m97 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m53[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000800[0m
       Tag: [34mSecurity.Backdoor.Obfuscation[0m
  Severity: [36mImportant[0m, Confidence: [36mHigh[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/oauth.py[0m
   Pattern: [32mbase64|encodedcommand|obfuscate[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport hashlib[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35mimport logging[0m

[31m--[ [0m[34mMatch #[0m[33m54[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000805[0m
       Tag: [34mSecurity.Backdoor.Obfuscation.LongBinaryStrings[0m
  Severity: [36mModerate[0m, Confidence: [36mMedium[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m(\\x[a-f0-9][a-f0-9]){10,}[0m
[30;1m1101 | [0m[35m        """Return a hexadecimal string instead of bytes[0m
[30;1m1102 | [0m[35m[0m
[30;1m1103 | [0m[35m        Example:[0m
[30;1m1104 | [0m[35m            IN   b'\x01\xee\x1d)\xa4\x19\x1d\xb6\xa9\xc0\x8d\xf1\xfe\xbaB\xdd'[0m
[30;1m1105 | [0m[35m            OUT  '01ee1d29-a419-1db6-a9c0-8df1feba42dd'[0m
[30;1m1106 | [0m[35m[0m
[30;1m1107 | [0m[35m        If conversion to hexadecimal fails, the original bytes are returned[0m

[31m--[ [0m[34mMatch #[0m[33m55[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/exc.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m89 | [0m[35m    "no-retry-reason": Why the request wasn't retried (if available)[0m
[30;1m90 | [0m[35m    "bounded-retry-delay": The maximum amount of time an error will be retried before giving up[0m
[30;1m91 | [0m[35m    "attempt": current retry number / maximum number of retries[0m
[30;1m92 | [0m[35m    "elapsed-seconds": time that has elapsed since first attempting the RPC request[0m
[30;1m93 | [0m[35m    """[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m    pass[0m

[31m--[ [0m[34mMatch #[0m[33m56[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/exc.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m87 | [0m[35m    "error-message": Error message from the HTTP headers (if available)[0m
[30;1m88 | [0m[35m    "original-exception": The Python level original exception[0m
[30;1m89 | [0m[35m    "no-retry-reason": Why the request wasn't retried (if available)[0m
[30;1m90 | [0m[35m    "bounded-retry-delay": The maximum amount of time an error will be retried before giving up[0m
[30;1m91 | [0m[35m    "attempt": current retry number / maximum number of retries[0m
[30;1m92 | [0m[35m    "elapsed-seconds": time that has elapsed since first attempting the RPC request[0m
[30;1m93 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m57[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/__init__.py[0m
   Pattern: [32m.hostname[0m
[30;1m87 | [0m[35mdef connect(server_hostname, http_path, access_token=None, **kwargs) -> "Connection":[0m
[30;1m88 | [0m[35m    from .client import Connection[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m    return Connection(server_hostname, http_path, access_token, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m58[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/__init__.py[0m
   Pattern: [32m.hostname[0m
[30;1m84 | [0m[35m    return Timestamp(*time.localtime(ticks)[:6])[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35mdef connect(server_hostname, http_path, access_token=None, **kwargs) -> "Connection":[0m
[30;1m88 | [0m[35m    from .client import Connection[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35m    return Connection(server_hostname, http_path, access_token, **kwargs)[0m

[31m--[ [0m[34mMatch #[0m[33m59[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/README.md[0m
   Pattern: [32m.hostname[0m
[30;1m57 | [0m[35m```[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35mIn the above example:[0m
[30;1m60 | [0m[35m- `server-hostname` is the Databricks instance host name.[0m
[30;1m61 | [0m[35m- `http-path` is the HTTP Path either to a Databricks SQL endpoint (e.g. /sql/1.0/endpoints/12345678[0m
[30;1m62 | [0m[35mor to a Databricks Runtime interactive cluster (e.g. /sql/protocolv1/o/1234567890123456/1234-123456-[0m
[30;1m63 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m60[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/README.md[0m
   Pattern: [32m.hostname[0m
[30;1m43 | [0m[35mhttp_path = os.getenv("DATABRICKS_HTTP_PATH")[0m
[30;1m44 | [0m[35m[0m
[30;1m45 | [0m[35mconnection = sql.connect([0m
[30;1m46 | [0m[35m  server_hostname=host,[0m
[30;1m47 | [0m[35m  http_path=http_path)[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35mcursor = connection.cursor()[0m

[31m--[ [0m[34mMatch #[0m[33m61[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/README.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m6 | [0m[35mhon DB API 2.0 specification](https://www.python.org/dev/peps/pep-0249/).[0m
[30;1m7 | [0m[35m[0m
[30;1m8 | [0m[35mThis connector uses Arrow as the data-exchange format, and supports APIs (e.g. `fetchmany_arrow`) to[0m
[30;1m9 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m62[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/types.py[0m
   Pattern: [32m.hostname[0m
[30;1m56 | [0m[35m            ssl_context.check_hostname = False[0m
[30;1m57 | [0m[35m            ssl_context.verify_mode = CERT_REQUIRED[0m
[30;1m58 | [0m[35m        else:[0m
[30;1m59 | [0m[35m            ssl_context.check_hostname = True[0m
[30;1m60 | [0m[35m            ssl_context.verify_mode = CERT_REQUIRED[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m        if self.tls_client_cert_file:[0m

[31m--[ [0m[34mMatch #[0m[33m63[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/types.py[0m
   Pattern: [32m.hostname[0m
[30;1m56 | [0m[35m            ssl_context.check_hostname = False[0m
[30;1m57 | [0m[35m            ssl_context.verify_mode = CERT_NONE[0m
[30;1m58 | [0m[35m        elif self.tls_verify_hostname is False:[0m
[30;1m59 | [0m[35m            ssl_context.check_hostname = False[0m
[30;1m60 | [0m[35m            ssl_context.verify_mode = CERT_REQUIRED[0m
[30;1m61 | [0m[35m        else:[0m
[30;1m62 | [0m[35m            ssl_context.check_hostname = True[0m

[31m--[ [0m[34mMatch #[0m[33m64[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/types.py[0m
   Pattern: [32m.hostname[0m
[30;1m52 | [0m[35m        if self.tls_verify is False:[0m
[30;1m53 | [0m[35m            ssl_context.check_hostname = False[0m
[30;1m54 | [0m[35m            ssl_context.verify_mode = CERT_NONE[0m
[30;1m55 | [0m[35m        elif self.tls_verify_hostname is False:[0m
[30;1m56 | [0m[35m            ssl_context.check_hostname = False[0m
[30;1m57 | [0m[35m            ssl_context.verify_mode = CERT_REQUIRED[0m
[30;1m58 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m65[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/types.py[0m
   Pattern: [32m.hostname[0m
[30;1m50 | [0m[35m        ssl_context = create_default_context(cafile=self.tls_trusted_ca_file)[0m
[30;1m51 | [0m[35m[0m
[30;1m52 | [0m[35m        if self.tls_verify is False:[0m
[30;1m53 | [0m[35m            ssl_context.check_hostname = False[0m
[30;1m54 | [0m[35m            ssl_context.verify_mode = CERT_NONE[0m
[30;1m55 | [0m[35m        elif self.tls_verify_hostname is False:[0m
[30;1m56 | [0m[35m            ssl_context.check_hostname = False[0m

[31m--[ [0m[34mMatch #[0m[33m66[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/types.py[0m
   Pattern: [32m.hostname[0m
[30;1m40 | [0m[35m        tls_client_cert_key_password: Optional[str] = None,[0m
[30;1m41 | [0m[35m    ):[0m
[30;1m42 | [0m[35m        self.tls_verify = tls_verify[0m
[30;1m43 | [0m[35m        self.tls_verify_hostname = tls_verify_hostname[0m
[30;1m44 | [0m[35m        self.tls_trusted_ca_file = tls_trusted_ca_file[0m
[30;1m45 | [0m[35m        self.tls_client_cert_file = tls_client_cert_file[0m
[30;1m46 | [0m[35m        self.tls_client_cert_key_file = tls_client_cert_key_file[0m

[31m--[ [0m[34mMatch #[0m[33m67[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/types.py[0m
   Pattern: [32m.hostname[0m
[30;1m40 | [0m[35m        tls_client_cert_key_password: Optional[str] = None,[0m
[30;1m41 | [0m[35m    ):[0m
[30;1m42 | [0m[35m        self.tls_verify = tls_verify[0m
[30;1m43 | [0m[35m        self.tls_verify_hostname = tls_verify_hostname[0m
[30;1m44 | [0m[35m        self.tls_trusted_ca_file = tls_trusted_ca_file[0m
[30;1m45 | [0m[35m        self.tls_client_cert_file = tls_client_cert_file[0m
[30;1m46 | [0m[35m        self.tls_client_cert_key_file = tls_client_cert_key_file[0m

[31m--[ [0m[34mMatch #[0m[33m68[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/types.py[0m
   Pattern: [32m.hostname[0m
[30;1m33 | [0m[35m    def __init__([0m
[30;1m34 | [0m[35m        self,[0m
[30;1m35 | [0m[35m        tls_verify: bool = True,[0m
[30;1m36 | [0m[35m        tls_verify_hostname: bool = True,[0m
[30;1m37 | [0m[35m        tls_trusted_ca_file: Optional[str] = None,[0m
[30;1m38 | [0m[35m        tls_client_cert_file: Optional[str] = None,[0m
[30;1m39 | [0m[35m        tls_client_cert_key_file: Optional[str] = None,[0m

[31m--[ [0m[34mMatch #[0m[33m69[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/types.py[0m
   Pattern: [32m.hostname[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35mclass SSLOptions:[0m
[30;1m26 | [0m[35m    tls_verify: bool[0m
[30;1m27 | [0m[35m    tls_verify_hostname: bool[0m
[30;1m28 | [0m[35m    tls_trusted_ca_file: Optional[str][0m
[30;1m29 | [0m[35m    tls_client_cert_file: Optional[str][0m
[30;1m30 | [0m[35m    tls_client_cert_key_file: Optional[str][0m

[31m--[ [0m[34mMatch #[0m[33m70[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/types.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m4 | [0m[35m# this work for additional information regarding copyright ownership.[0m
[30;1m5 | [0m[35m# The ASF licenses this file to You under the Apache License, Version 2.0[0m
[30;1m6 | [0m[35m# (the "License"); you may not use this file except in compliance with[0m
[30;1m7 | [0m[35m# the License.  You may obtain a copy of the License at[0m
[30;1m8 | [0m[35m#[0m
[30;1m9 | [0m[35m#    http://www.apache.org/licenses/LICENSE-2.0[0m
[30;1m10 | [0m[35m#[0m
[30;1m11 | [0m[35m# Unless required by applicable law or agreed to in writing, software[0m

[31m--[ [0m[34mMatch #[0m[33m71[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/cloudfetch/downloader.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m96 | [0m[35m[0m
[30;1m97 | [0m[35m        try:[0m
[30;1m98 | [0m[35m            # Get the file via HTTP request[0m
[30;1m99 | [0m[35m            response = session.get([0m
[30;1m100 | [0m[35m                self.link.fileLink,[0m
[30;1m101 | [0m[35m                timeout=self.settings.download_timeout,[0m
[30;1m102 | [0m[35m                verify=self._ssl_options.tls_verify,[0m

[31m--[ [0m[34mMatch #[0m[33m72[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/cloudfetch/downloader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m50 | [0m[35m    Attributes:[0m
[30;1m51 | [0m[35m        is_lz4_compressed (bool): Whether file is expected to be lz4 compressed.[0m
[30;1m52 | [0m[35m        link_expiry_buffer_secs (int): Time in seconds to prevent download of a link before it expir[0m
[30;1m53 | [0m[35m        download_timeout (int): Timeout for download requests. Default 60 secs.[0m
[30;1m54 | [0m[35m        max_consecutive_file_download_retries (int): Number of consecutive download retries before s[0m
[30;1m55 | [0m[35m    """[0m
[30;1m56 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m73[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/cloudfetch/downloader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m    Attributes:[0m
[30;1m51 | [0m[35m        is_lz4_compressed (bool): Whether file is expected to be lz4 compressed.[0m
[30;1m52 | [0m[35m        link_expiry_buffer_secs (int): Time in seconds to prevent download of a link before it expir[0m
[30;1m53 | [0m[35m        download_timeout (int): Timeout for download requests. Default 60 secs.[0m
[30;1m54 | [0m[35m        max_consecutive_file_download_retries (int): Number of consecutive download retries before s[0m
[30;1m55 | [0m[35m    """[0m

[31m--[ [0m[34mMatch #[0m[33m74[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/cloudfetch/downloader.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m4 | [0m[35mimport requests[0m
[30;1m5 | [0m[35mfrom requests.adapters import HTTPAdapter, Retry[0m
[30;1m6 | [0m[35mimport lz4.frame[0m
[30;1m7 | [0m[35mimport time[0m
[30;1m8 | [0m[35m[0m
[30;1m9 | [0m[35mfrom databricks.sql.thrift_api.TCLIService.ttypes import TSparkArrowResultLink[0m
[30;1m10 | [0m[35mfrom databricks.sql.exc import Error[0m
[30;1m11 | [0m[35mfrom databricks.sql.types import SSLOptions[0m

[31m--[ [0m[34mMatch #[0m[33m75[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/CHANGELOG.md[0m
   Pattern: [32m.hostname[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m- SQLAlchemy dialect now supports table and column comments (thanks @cbornet!)[0m
[30;1m105 | [0m[35m- Fix: SQLAlchemy dialect now correctly reflects TINYINT types (thanks @TimTheinAtTabs!)[0m
[30;1m106 | [0m[35m- Fix: `server_hostname` URIs that included `https://` would raise an exception[0m
[30;1m107 | [0m[35m- Other: pinned to `pandas<=2.1` and `urllib3>=1.26` to avoid runtime errors in dbt-databricks (#330[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35m## 3.0.1 (2023-12-01)[0m

[31m--[ [0m[34mMatch #[0m[33m76[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/CHANGELOG.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m245 | [0m[35m[0m
[30;1m246 | [0m[35m## 2.0.5 (2022-08-23)[0m
[30;1m247 | [0m[35m[0m
[30;1m248 | [0m[35m- Fix: closing a connection now closes any open cursors from that connection at the server[0m
[30;1m249 | [0m[35m- Other: Add project links to pyproject.toml (helpful for visitors from PyPi)[0m
[30;1m250 | [0m[35m[0m
[30;1m251 | [0m[35m## 2.0.4 (2022-08-17)[0m

[31m--[ [0m[34mMatch #[0m[33m77[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/CHANGELOG.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m- Less strict numpy and pyarrow dependencies[0m
[30;1m215 | [0m[35m- Update examples in README to use security best practices[0m
[30;1m216 | [0m[35m- Update docstring for client.execute() for clarity[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m## 2.4.0 (2023-02-21)[0m
[30;1m219 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m78[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/CHANGELOG.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m212 | [0m[35m## 2.4.1 (2023-03-21)[0m
[30;1m213 | [0m[35m[0m
[30;1m214 | [0m[35m- Less strict numpy and pyarrow dependencies[0m
[30;1m215 | [0m[35m- Update examples in README to use security best practices[0m
[30;1m216 | [0m[35m- Update docstring for client.execute() for clarity[0m
[30;1m217 | [0m[35m[0m
[30;1m218 | [0m[35m## 2.4.0 (2023-02-21)[0m

[31m--[ [0m[34mMatch #[0m[33m79[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/CHANGELOG.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m75 | [0m[35m- Relax `pyarrow` pin (databricks/databricks-sql-python#389 by @dhirschfeld)[0m
[30;1m76 | [0m[35m- Fix error logging in OAuth manager (databricks/databricks-sql-python#269 by @susodapop)[0m
[30;1m77 | [0m[35m- SQLAlchemy: enable delta.feature.allowColumnDefaults for all tables (databricks/databricks-sql-pyt[0m
[30;1m78 | [0m[35m- Update `thrift` dependency (databricks/databricks-sql-python#397 by @m1n0)[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m# 3.1.2 (2024-04-18)[0m
[30;1m81 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m80[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/CHANGELOG.md[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m# 3.2.0 (2024-06-06)[0m
[30;1m73 | [0m[35m[0m
[30;1m74 | [0m[35m- Update proxy authentication (databricks/databricks-sql-python#354 by @amir-haroun)[0m
[30;1m75 | [0m[35m- Relax `pyarrow` pin (databricks/databricks-sql-python#389 by @dhirschfeld)[0m
[30;1m76 | [0m[35m- Fix error logging in OAuth manager (databricks/databricks-sql-python#269 by @susodapop)[0m
[30;1m77 | [0m[35m- SQLAlchemy: enable delta.feature.allowColumnDefaults for all tables (databricks/databricks-sql-pyt[0m

[31m--[ [0m[34mMatch #[0m[33m81[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/CHANGELOG.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m- Add support for External Auth providers[0m
[30;1m209 | [0m[35m- Fix: Python HTTP proxies were broken[0m
[30;1m210 | [0m[35m- Other: All Thrift requests that timeout during connection will be automatically retried[0m
[30;1m211 | [0m[35m[0m
[30;1m212 | [0m[35m## 2.4.1 (2023-03-21)[0m
[30;1m213 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m82[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/CHANGELOG.md[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m192 | [0m[35m## 2.6.0 (2023-06-07)[0m
[30;1m193 | [0m[35m[0m
[30;1m194 | [0m[35m- Add support for HTTP 1.1 connections (connection pools)[0m
[30;1m195 | [0m[35m- Add a default socket timeout for thrift RPCs[0m
[30;1m196 | [0m[35m[0m
[30;1m197 | [0m[35m## 2.5.2 (2023-05-08)[0m
[30;1m198 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m83[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m513 | [0m[35m    def _check_session_configuration(self, session_configuration):[0m
[30;1m514 | [0m[35m        # This client expects timetampsAsString to be false, so we do not allow users to modify that[0m
[30;1m515 | [0m[35m        if ([0m
[30;1m516 | [0m[35m            session_configuration.get(TIMESTAMP_AS_STRING_CONFIG, "false").lower()[0m
[30;1m517 | [0m[35m            != "false"[0m
[30;1m518 | [0m[35m        ):[0m
[30;1m519 | [0m[35m            raise Error([0m

[31m--[ [0m[34mMatch #[0m[33m84[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m372 | [0m[35m[0m
[30;1m373 | [0m[35m                # These three lines are no-ops if the v3 retry policy is not in use[0m
[30;1m374 | [0m[35m                if self.enable_v3_retries:[0m
[30;1m375 | [0m[35m                    this_command_type = CommandType.get(this_method_name)[0m
[30;1m376 | [0m[35m                    self._transport.set_retry_command_type(this_command_type)[0m
[30;1m377 | [0m[35m                    self._transport.startRetryTimer()[0m
[30;1m378 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m85[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m350 | [0m[35m            # encapsulate retry checks, returns None || delay-in-secs[0m
[30;1m351 | [0m[35m            # Retry IFF 429/503 code + Retry-After header set[0m
[30;1m352 | [0m[35m            http_code = getattr(self._transport, "code", None)[0m
[30;1m353 | [0m[35m            retry_after = getattr(self._transport, "headers", {}).get("Retry-After", 1)[0m
[30;1m354 | [0m[35m            if http_code in [429, 503]:[0m
[30;1m355 | [0m[35m                # bound delay (seconds) by [min_delay*1.5^(attempt-1), max_delay][0m
[30;1m356 | [0m[35m                return bound_retry_delay(attempt, int(retry_after))[0m

[31m--[ [0m[34mMatch #[0m[33m86[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m222 | [0m[35m        # Configure retries & timing: use user-settings or defaults, and bound[0m
[30;1m223 | [0m[35m        # by policy. Log.warn when given param gets restricted.[0m
[30;1m224 | [0m[35m        for key, (type_, default, min, max) in _retry_policy.items():[0m
[30;1m225 | [0m[35m            given_or_default = type_(kwargs.get(key, default))[0m
[30;1m226 | [0m[35m            bound = _bound(min, max, given_or_default)[0m
[30;1m227 | [0m[35m            setattr(self, key, bound)[0m
[30;1m228 | [0m[35m            logger.debug([0m

[31m--[ [0m[34mMatch #[0m[33m87[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m201 | [0m[35m            **additional_transport_args,  # type: ignore[0m
[30;1m202 | [0m[35m        )[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m        timeout = kwargs.get("_socket_timeout", DEFAULT_SOCKET_TIMEOUT)[0m
[30;1m205 | [0m[35m        # setTimeout defaults to 15 minutes and is expected in ms[0m
[30;1m206 | [0m[35m        self._transport.setTimeout(timeout and (float(timeout) * 1000.0))[0m
[30;1m207 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m88[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m171 | [0m[35m        self.force_dangerous_codes = kwargs.get("_retry_dangerous_codes", [])[0m
[30;1m172 | [0m[35m[0m
[30;1m173 | [0m[35m        additional_transport_args = {}[0m
[30;1m174 | [0m[35m        _max_redirects: Union[None, int] = kwargs.get("_retry_max_redirects")[0m
[30;1m175 | [0m[35m[0m
[30;1m176 | [0m[35m        if _max_redirects:[0m
[30;1m177 | [0m[35m            if _max_redirects > self._retry_stop_after_attempts_count:[0m

[31m--[ [0m[34mMatch #[0m[33m89[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m168 | [0m[35m                "Legacy retry behavior is enabled for this connection."[0m
[30;1m169 | [0m[35m                " This behaviour is deprecated and will be removed in a future release."[0m
[30;1m170 | [0m[35m            )[0m
[30;1m171 | [0m[35m        self.force_dangerous_codes = kwargs.get("_retry_dangerous_codes", [])[0m
[30;1m172 | [0m[35m[0m
[30;1m173 | [0m[35m        additional_transport_args = {}[0m
[30;1m174 | [0m[35m        _max_redirects: Union[None, int] = kwargs.get("_retry_max_redirects")[0m

[31m--[ [0m[34mMatch #[0m[33m90[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m161 | [0m[35m        self._auth_provider = auth_provider[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35m        # Connector version 3 retry approach[0m
[30;1m164 | [0m[35m        self.enable_v3_retries = kwargs.get("_enable_v3_retries", True)[0m
[30;1m165 | [0m[35m[0m
[30;1m166 | [0m[35m        if not self.enable_v3_retries:[0m
[30;1m167 | [0m[35m            logger.warning([0m

[31m--[ [0m[34mMatch #[0m[33m91[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m154 | [0m[35m        )[0m
[30;1m155 | [0m[35m[0m
[30;1m156 | [0m[35m        # Cloud fetch[0m
[30;1m157 | [0m[35m        self.max_download_threads = kwargs.get("max_download_threads", 10)[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m        self._ssl_options = ssl_options[0m
[30;1m160 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m92[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m149 | [0m[35m            "_use_arrow_native_complex_types", True[0m
[30;1m150 | [0m[35m        )[0m
[30;1m151 | [0m[35m        self._use_arrow_native_decimals = kwargs.get("_use_arrow_native_decimals", True)[0m
[30;1m152 | [0m[35m        self._use_arrow_native_timestamps = kwargs.get([0m
[30;1m153 | [0m[35m            "_use_arrow_native_timestamps", True[0m
[30;1m154 | [0m[35m        )[0m
[30;1m155 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m93[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m148 | [0m[35m        self._use_arrow_native_complex_types = kwargs.get([0m
[30;1m149 | [0m[35m            "_use_arrow_native_complex_types", True[0m
[30;1m150 | [0m[35m        )[0m
[30;1m151 | [0m[35m        self._use_arrow_native_decimals = kwargs.get("_use_arrow_native_decimals", True)[0m
[30;1m152 | [0m[35m        self._use_arrow_native_timestamps = kwargs.get([0m
[30;1m153 | [0m[35m            "_use_arrow_native_timestamps", True[0m
[30;1m154 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m94[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m145 | [0m[35m[0m
[30;1m146 | [0m[35m        self.staging_allowed_local_path = staging_allowed_local_path[0m
[30;1m147 | [0m[35m        self._initialize_retry_args(kwargs)[0m
[30;1m148 | [0m[35m        self._use_arrow_native_complex_types = kwargs.get([0m
[30;1m149 | [0m[35m            "_use_arrow_native_complex_types", True[0m
[30;1m150 | [0m[35m        )[0m
[30;1m151 | [0m[35m        self._use_arrow_native_decimals = kwargs.get("_use_arrow_native_decimals", True)[0m

[31m--[ [0m[34mMatch #[0m[33m95[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m        port = port or 443[0m
[30;1m135 | [0m[35m        if kwargs.get("_connection_uri"):[0m
[30;1m136 | [0m[35m            uri = kwargs.get("_connection_uri")[0m
[30;1m137 | [0m[35m        elif server_hostname and http_path:[0m
[30;1m138 | [0m[35m            uri = "{host}:{port}/{path}".format([0m
[30;1m139 | [0m[35m                host=server_hostname.rstrip("/"), port=port, path=http_path.lstrip("/")[0m

[31m--[ [0m[34mMatch #[0m[33m96[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m132 | [0m[35m        #  Number of threads for handling cloud fetch downloads. Defaults to 10[0m
[30;1m133 | [0m[35m[0m
[30;1m134 | [0m[35m        port = port or 443[0m
[30;1m135 | [0m[35m        if kwargs.get("_connection_uri"):[0m
[30;1m136 | [0m[35m            uri = kwargs.get("_connection_uri")[0m
[30;1m137 | [0m[35m        elif server_hostname and http_path:[0m
[30;1m138 | [0m[35m            uri = "{host}:{port}/{path}".format([0m

[31m--[ [0m[34mMatch #[0m[33m97[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m.hostname[0m
[30;1m136 | [0m[35m            uri = kwargs.get("_connection_uri")[0m
[30;1m137 | [0m[35m        elif server_hostname and http_path:[0m
[30;1m138 | [0m[35m            uri = "{host}:{port}/{path}".format([0m
[30;1m139 | [0m[35m                host=server_hostname.rstrip("/"), port=port, path=http_path.lstrip("/")[0m
[30;1m140 | [0m[35m            )[0m
[30;1m141 | [0m[35m            if not uri.startswith("https://"):[0m
[30;1m142 | [0m[35m                uri = "https://" + uri[0m

[31m--[ [0m[34mMatch #[0m[33m98[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m.hostname[0m
[30;1m134 | [0m[35m        port = port or 443[0m
[30;1m135 | [0m[35m        if kwargs.get("_connection_uri"):[0m
[30;1m136 | [0m[35m            uri = kwargs.get("_connection_uri")[0m
[30;1m137 | [0m[35m        elif server_hostname and http_path:[0m
[30;1m138 | [0m[35m            uri = "{host}:{port}/{path}".format([0m
[30;1m139 | [0m[35m                host=server_hostname.rstrip("/"), port=port, path=http_path.lstrip("/")[0m
[30;1m140 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m99[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m.hostname[0m
[30;1m98 | [0m[35m        # _username, _password[0m
[30;1m99 | [0m[35m        #   Username and password Basic authentication (no official support)[0m
[30;1m100 | [0m[35m        # _connection_uri[0m
[30;1m101 | [0m[35m        #   Overrides server_hostname and http_path.[0m
[30;1m102 | [0m[35m        # RETRY/ATTEMPT POLICY[0m
[30;1m103 | [0m[35m        # _retry_delay_min                      (default: 1)[0m
[30;1m104 | [0m[35m        # _retry_delay_max                      (default: 60)[0m

[31m--[ [0m[34mMatch #[0m[33m100[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m.hostname[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m    def __init__([0m
[30;1m87 | [0m[35m        self,[0m
[30;1m88 | [0m[35m        server_hostname: str,[0m
[30;1m89 | [0m[35m        port,[0m
[30;1m90 | [0m[35m        http_path: str,[0m
[30;1m91 | [0m[35m        http_headers,[0m

[31m--[ [0m[34mMatch #[0m[33m101[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1056 | [0m[35m        resp = self.make_request(self._client.FetchResults, req, use_cloud_fetch)[0m
[30;1m1057 | [0m[35m        if resp.results.startRowOffset > expected_row_start_offset:[0m
[30;1m1058 | [0m[35m            raise DataError([0m
[30;1m1059 | [0m[35m                "fetch_results failed due to inconsistency in the state between the client and the s[0m
[30;1m1060 | [0m[35m                    expected_row_start_offset, resp.results.startRowOffset[0m
[30;1m1061 | [0m[35m                )[0m
[30;1m1062 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m102[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m327 | [0m[35m        For delay between attempts, honor the given Retry-After header, but with bounds.[0m
[30;1m328 | [0m[35m        Use lower bound of expontial-backoff based on _retry_delay_min,[0m
[30;1m329 | [0m[35m        and upper bound of _retry_delay_max.[0m
[30;1m330 | [0m[35m        Will stop retry attempts if total elapsed time + next retry delay would exceed[0m
[30;1m331 | [0m[35m        _retry_stop_after_attempts_duration.[0m
[30;1m332 | [0m[35m        """[0m
[30;1m333 | [0m[35m        # basic strategy: build range iterator rep'ing number of available[0m

[31m--[ [0m[34mMatch #[0m[33m103[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m263 | [0m[35m        if DATABRICKS_ERROR_OR_REDIRECT_HEADER in headers:[0m
[30;1m264 | [0m[35m            if ([0m
[30;1m265 | [0m[35m                err_msg[0m
[30;1m266 | [0m[35m            ):  # We don't expect both to be set, but log both here just in case[0m
[30;1m267 | [0m[35m                err_msg = "Thriftserver error: {}, Databricks error: {}".format([0m
[30;1m268 | [0m[35m                    err_msg, headers[DATABRICKS_ERROR_OR_REDIRECT_HEADER][0m
[30;1m269 | [0m[35m                )[0m

[31m--[ [0m[34mMatch #[0m[33m104[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m201 | [0m[35m            **additional_transport_args,  # type: ignore[0m
[30;1m202 | [0m[35m        )[0m
[30;1m203 | [0m[35m[0m
[30;1m204 | [0m[35m        timeout = kwargs.get("_socket_timeout", DEFAULT_SOCKET_TIMEOUT)[0m
[30;1m205 | [0m[35m        # setTimeout defaults to 15 minutes and is expected in ms[0m
[30;1m206 | [0m[35m        self._transport.setTimeout(timeout and (float(timeout) * 1000.0))[0m
[30;1m207 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m105[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m119 | [0m[35m        #  An iterable of integer HTTP status codes. ExecuteStatement commands will be retried if th[0m
[30;1m120 | [0m[35m        #  (defaults to [])[0m
[30;1m121 | [0m[35m        # _socket_timeout[0m
[30;1m122 | [0m[35m        #  The timeout in seconds for socket send, recv and connect operations. Should be a positive[0m
[30;1m123 | [0m[35m        #  (defaults to 900)[0m
[30;1m124 | [0m[35m        # _enable_v3_retries[0m
[30;1m125 | [0m[35m        # Whether to use the DatabricksRetryPolicy implemented in urllib3[0m

[31m--[ [0m[34mMatch #[0m[33m106[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_backend.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m2 | [0m[35mimport errno[0m
[30;1m3 | [0m[35mimport logging[0m
[30;1m4 | [0m[35mimport math[0m
[30;1m5 | [0m[35mimport time[0m
[30;1m6 | [0m[35mimport uuid[0m
[30;1m7 | [0m[35mimport threading[0m
[30;1m8 | [0m[35mfrom typing import List, Union[0m
[30;1m9 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m107[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m35 | [0m[35m        self.tokens[hostname] = oauth_token[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    def read(self, hostname: str) -> Optional[OAuthToken]:[0m
[30;1m38 | [0m[35m        return self.tokens.get(hostname)[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m# Note this is only intended to be used for development[0m

[31m--[ [0m[34mMatch #[0m[33m108[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m.hostname[0m
[30;1m69 | [0m[35m                if hostname != hostname_in_token:[0m
[30;1m70 | [0m[35m                    msg = ([0m
[30;1m71 | [0m[35m                        f"token was persisted for host {hostname_in_token} does not match {hostname}[0m
[30;1m72 | [0m[35m                        f"This is a dev only persistence and it only supports a single Databricks ho[0m
[30;1m73 | [0m[35m                        f"\n manually delete {self._file_path} file and restart this process"[0m
[30;1m74 | [0m[35m                    )[0m
[30;1m75 | [0m[35m                    logger.error(msg)[0m

[31m--[ [0m[34mMatch #[0m[33m109[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m.hostname[0m
[30;1m68 | [0m[35m                hostname_in_token = token_as_json["hostname"][0m
[30;1m69 | [0m[35m                if hostname != hostname_in_token:[0m
[30;1m70 | [0m[35m                    msg = ([0m
[30;1m71 | [0m[35m                        f"token was persisted for host {hostname_in_token} does not match {hostname}[0m
[30;1m72 | [0m[35m                        f"This is a dev only persistence and it only supports a single Databricks ho[0m
[30;1m73 | [0m[35m                        f"\n manually delete {self._file_path} file and restart this process"[0m
[30;1m74 | [0m[35m                    )[0m

[31m--[ [0m[34mMatch #[0m[33m110[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m.hostname[0m
[30;1m68 | [0m[35m                hostname_in_token = token_as_json["hostname"][0m
[30;1m69 | [0m[35m                if hostname != hostname_in_token:[0m
[30;1m70 | [0m[35m                    msg = ([0m
[30;1m71 | [0m[35m                        f"token was persisted for host {hostname_in_token} does not match {hostname}[0m
[30;1m72 | [0m[35m                        f"This is a dev only persistence and it only supports a single Databricks ho[0m
[30;1m73 | [0m[35m                        f"\n manually delete {self._file_path} file and restart this process"[0m
[30;1m74 | [0m[35m                    )[0m

[31m--[ [0m[34mMatch #[0m[33m111[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m.hostname[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m                token_as_json = json.loads(json_as_string)[0m
[30;1m68 | [0m[35m                hostname_in_token = token_as_json["hostname"][0m
[30;1m69 | [0m[35m                if hostname != hostname_in_token:[0m
[30;1m70 | [0m[35m                    msg = ([0m
[30;1m71 | [0m[35m                        f"token was persisted for host {hostname_in_token} does not match {hostname}[0m
[30;1m72 | [0m[35m                        f"This is a dev only persistence and it only supports a single Databricks ho[0m

[31m--[ [0m[34mMatch #[0m[33m112[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m.hostname[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m                token_as_json = json.loads(json_as_string)[0m
[30;1m68 | [0m[35m                hostname_in_token = token_as_json["hostname"][0m
[30;1m69 | [0m[35m                if hostname != hostname_in_token:[0m
[30;1m70 | [0m[35m                    msg = ([0m
[30;1m71 | [0m[35m                        f"token was persisted for host {hostname_in_token} does not match {hostname}[0m
[30;1m72 | [0m[35m                        f"This is a dev only persistence and it only supports a single Databricks ho[0m

[31m--[ [0m[34mMatch #[0m[33m113[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m.hostname[0m
[30;1m65 | [0m[35m                json_as_string = infile.read()[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m                token_as_json = json.loads(json_as_string)[0m
[30;1m68 | [0m[35m                hostname_in_token = token_as_json["hostname"][0m
[30;1m69 | [0m[35m                if hostname != hostname_in_token:[0m
[30;1m70 | [0m[35m                    msg = ([0m
[30;1m71 | [0m[35m                        f"token was persisted for host {hostname_in_token} does not match {hostname}[0m

[31m--[ [0m[34mMatch #[0m[33m114[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m.hostname[0m
[30;1m65 | [0m[35m                json_as_string = infile.read()[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m                token_as_json = json.loads(json_as_string)[0m
[30;1m68 | [0m[35m                hostname_in_token = token_as_json["hostname"][0m
[30;1m69 | [0m[35m                if hostname != hostname_in_token:[0m
[30;1m70 | [0m[35m                    msg = ([0m
[30;1m71 | [0m[35m                        f"token was persisted for host {hostname_in_token} does not match {hostname}[0m

[31m--[ [0m[34mMatch #[0m[33m115[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m.hostname[0m
[30;1m59 | [0m[35m        with open(self._file_path, "w") as outfile:[0m
[30;1m60 | [0m[35m            outfile.write(json_object)[0m
[30;1m61 | [0m[35m[0m
[30;1m62 | [0m[35m    def read(self, hostname: str) -> Optional[OAuthToken]:[0m
[30;1m63 | [0m[35m        try:[0m
[30;1m64 | [0m[35m            with open(self._file_path, "r") as infile:[0m
[30;1m65 | [0m[35m                json_as_string = infile.read()[0m

[31m--[ [0m[34mMatch #[0m[33m116[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m.hostname[0m
[30;1m50 | [0m[35m        dictionary = {[0m
[30;1m51 | [0m[35m            "refresh_token": token.refresh_token,[0m
[30;1m52 | [0m[35m            "access_token": token.access_token,[0m
[30;1m53 | [0m[35m            "hostname": hostname,[0m
[30;1m54 | [0m[35m        }[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m        # Serializing json[0m

[31m--[ [0m[34mMatch #[0m[33m117[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m.hostname[0m
[30;1m50 | [0m[35m        dictionary = {[0m
[30;1m51 | [0m[35m            "refresh_token": token.refresh_token,[0m
[30;1m52 | [0m[35m            "access_token": token.access_token,[0m
[30;1m53 | [0m[35m            "hostname": hostname,[0m
[30;1m54 | [0m[35m        }[0m
[30;1m55 | [0m[35m[0m
[30;1m56 | [0m[35m        # Serializing json[0m

[31m--[ [0m[34mMatch #[0m[33m118[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m.hostname[0m
[30;1m43 | [0m[35m    def __init__(self, file_path):[0m
[30;1m44 | [0m[35m        self._file_path = file_path[0m
[30;1m45 | [0m[35m[0m
[30;1m46 | [0m[35m    def persist(self, hostname: str, token: OAuthToken):[0m
[30;1m47 | [0m[35m        logger.info(f"persisting token in {self._file_path}")[0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m        # Data to be written[0m

[31m--[ [0m[34mMatch #[0m[33m119[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m.hostname[0m
[30;1m35 | [0m[35m        self.tokens[hostname] = oauth_token[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    def read(self, hostname: str) -> Optional[OAuthToken]:[0m
[30;1m38 | [0m[35m        return self.tokens.get(hostname)[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m[0m
[30;1m41 | [0m[35m# Note this is only intended to be used for development[0m

[31m--[ [0m[34mMatch #[0m[33m120[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m.hostname[0m
[30;1m34 | [0m[35m    def persist(self, hostname: str, oauth_token: OAuthToken):[0m
[30;1m35 | [0m[35m        self.tokens[hostname] = oauth_token[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    def read(self, hostname: str) -> Optional[OAuthToken]:[0m
[30;1m38 | [0m[35m        return self.tokens.get(hostname)[0m
[30;1m39 | [0m[35m[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m121[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m.hostname[0m
[30;1m32 | [0m[35m        self.tokens = {}[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    def persist(self, hostname: str, oauth_token: OAuthToken):[0m
[30;1m35 | [0m[35m        self.tokens[hostname] = oauth_token[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    def read(self, hostname: str) -> Optional[OAuthToken]:[0m
[30;1m38 | [0m[35m        return self.tokens.get(hostname)[0m

[31m--[ [0m[34mMatch #[0m[33m122[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m.hostname[0m
[30;1m31 | [0m[35m    def __init__(self):[0m
[30;1m32 | [0m[35m        self.tokens = {}[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    def persist(self, hostname: str, oauth_token: OAuthToken):[0m
[30;1m35 | [0m[35m        self.tokens[hostname] = oauth_token[0m
[30;1m36 | [0m[35m[0m
[30;1m37 | [0m[35m    def read(self, hostname: str) -> Optional[OAuthToken]:[0m

[31m--[ [0m[34mMatch #[0m[33m123[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m.hostname[0m
[30;1m23 | [0m[35m    def persist(self, hostname: str, oauth_token: OAuthToken):[0m
[30;1m24 | [0m[35m        pass[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def read(self, hostname: str) -> Optional[OAuthToken]:[0m
[30;1m27 | [0m[35m        pass[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m124[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/experimental/oauth_persistence.py[0m
   Pattern: [32m.hostname[0m
[30;1m20 | [0m[35m[0m
[30;1m21 | [0m[35m[0m
[30;1m22 | [0m[35mclass OAuthPersistence:[0m
[30;1m23 | [0m[35m    def persist(self, hostname: str, oauth_token: OAuthToken):[0m
[30;1m24 | [0m[35m        pass[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m    def read(self, hostname: str) -> Optional[OAuthToken]:[0m

[31m--[ [0m[34mMatch #[0m[33m125[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/cloudfetch/download_manager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m47 | [0m[35m        """[0m
[30;1m48 | [0m[35m        Get next file that starts at given offset.[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m        This function gets the next downloaded file in which its rows start at the specified next_ro[0m
[30;1m51 | [0m[35m        in relation to the full result. File downloads are scheduled if not already, and once the co[0m
[30;1m52 | [0m[35m        download handler is located, the function waits for the download status and returns the resu[0m
[30;1m53 | [0m[35m        If there are no more downloads, a download was not successful, or the correct file could not[0m

[31m--[ [0m[34mMatch #[0m[33m126[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/cloudfetch/download_manager.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m45 | [0m[35m        self, next_row_offset: int[0m
[30;1m46 | [0m[35m    ) -> Union[DownloadedFile, None]:[0m
[30;1m47 | [0m[35m        """[0m
[30;1m48 | [0m[35m        Get next file that starts at given offset.[0m
[30;1m49 | [0m[35m[0m
[30;1m50 | [0m[35m        This function gets the next downloaded file in which its rows start at the specified next_ro[0m
[30;1m51 | [0m[35m        in relation to the full result. File downloads are scheduled if not already, and once the co[0m

[31m--[ [0m[34mMatch #[0m[33m127[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m726 | [0m[35m        if local_file is None:[0m
[30;1m727 | [0m[35m            raise Error("Cannot perform GET without specifying a local_file")[0m
[30;1m728 | [0m[35m[0m
[30;1m729 | [0m[35m        r = requests.get(url=presigned_url, headers=headers)[0m
[30;1m730 | [0m[35m[0m
[30;1m731 | [0m[35m        # response.ok verifies the status code is not between 400-600.[0m
[30;1m732 | [0m[35m        # Any 2xx or 3xx will evaluate r.ok == True[0m

[31m--[ [0m[34mMatch #[0m[33m128[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m280 | [0m[35m        self._cursors = []  # type: List[Cursor][0m
[30;1m281 | [0m[35m[0m
[30;1m282 | [0m[35m        self.use_inline_params = self._set_use_inline_params_with_warning([0m
[30;1m283 | [0m[35m            kwargs.get("use_inline_params", False)[0m
[30;1m284 | [0m[35m        )[0m
[30;1m285 | [0m[35m[0m
[30;1m286 | [0m[35m    def _set_use_inline_params_with_warning(self, value: Union[bool, str]):[0m

[31m--[ [0m[34mMatch #[0m[33m129[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m274 | [0m[35m        )[0m
[30;1m275 | [0m[35m        self._session_handle = self._open_session_resp.sessionHandle[0m
[30;1m276 | [0m[35m        self.protocol_version = self.get_protocol_version(self._open_session_resp)[0m
[30;1m277 | [0m[35m        self.use_cloud_fetch = kwargs.get("use_cloud_fetch", True)[0m
[30;1m278 | [0m[35m        self.open = True[0m
[30;1m279 | [0m[35m        logger.info("Successfully opened session " + str(self.get_session_id_hex()))[0m
[30;1m280 | [0m[35m        self._cursors = []  # type: List[Cursor][0m

[31m--[ [0m[34mMatch #[0m[33m130[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m255 | [0m[35m            tls_trusted_ca_file=kwargs.get("_tls_trusted_ca_file"),[0m
[30;1m256 | [0m[35m            tls_client_cert_file=kwargs.get("_tls_client_cert_file"),[0m
[30;1m257 | [0m[35m            tls_client_cert_key_file=kwargs.get("_tls_client_cert_key_file"),[0m
[30;1m258 | [0m[35m            tls_client_cert_key_password=kwargs.get("_tls_client_cert_key_password"),[0m
[30;1m259 | [0m[35m        )[0m
[30;1m260 | [0m[35m[0m
[30;1m261 | [0m[35m        self.thrift_backend = ThriftBackend([0m

[31m--[ [0m[34mMatch #[0m[33m131[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m254 | [0m[35m            tls_verify_hostname=kwargs.get("_tls_verify_hostname", True),[0m
[30;1m255 | [0m[35m            tls_trusted_ca_file=kwargs.get("_tls_trusted_ca_file"),[0m
[30;1m256 | [0m[35m            tls_client_cert_file=kwargs.get("_tls_client_cert_file"),[0m
[30;1m257 | [0m[35m            tls_client_cert_key_file=kwargs.get("_tls_client_cert_key_file"),[0m
[30;1m258 | [0m[35m            tls_client_cert_key_password=kwargs.get("_tls_client_cert_key_password"),[0m
[30;1m259 | [0m[35m        )[0m
[30;1m260 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m132[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m253 | [0m[35m            ),  # by default - verify cert and host[0m
[30;1m254 | [0m[35m            tls_verify_hostname=kwargs.get("_tls_verify_hostname", True),[0m
[30;1m255 | [0m[35m            tls_trusted_ca_file=kwargs.get("_tls_trusted_ca_file"),[0m
[30;1m256 | [0m[35m            tls_client_cert_file=kwargs.get("_tls_client_cert_file"),[0m
[30;1m257 | [0m[35m            tls_client_cert_key_file=kwargs.get("_tls_client_cert_key_file"),[0m
[30;1m258 | [0m[35m            tls_client_cert_key_password=kwargs.get("_tls_client_cert_key_password"),[0m
[30;1m259 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m133[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m252 | [0m[35m                "_tls_no_verify", False[0m
[30;1m253 | [0m[35m            ),  # by default - verify cert and host[0m
[30;1m254 | [0m[35m            tls_verify_hostname=kwargs.get("_tls_verify_hostname", True),[0m
[30;1m255 | [0m[35m            tls_trusted_ca_file=kwargs.get("_tls_trusted_ca_file"),[0m
[30;1m256 | [0m[35m            tls_client_cert_file=kwargs.get("_tls_client_cert_file"),[0m
[30;1m257 | [0m[35m            tls_client_cert_key_file=kwargs.get("_tls_client_cert_key_file"),[0m
[30;1m258 | [0m[35m            tls_client_cert_key_password=kwargs.get("_tls_client_cert_key_password"),[0m

[31m--[ [0m[34mMatch #[0m[33m134[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m251 | [0m[35m            tls_verify=not kwargs.get([0m
[30;1m252 | [0m[35m                "_tls_no_verify", False[0m
[30;1m253 | [0m[35m            ),  # by default - verify cert and host[0m
[30;1m254 | [0m[35m            tls_verify_hostname=kwargs.get("_tls_verify_hostname", True),[0m
[30;1m255 | [0m[35m            tls_trusted_ca_file=kwargs.get("_tls_trusted_ca_file"),[0m
[30;1m256 | [0m[35m            tls_client_cert_file=kwargs.get("_tls_client_cert_file"),[0m
[30;1m257 | [0m[35m            tls_client_cert_key_file=kwargs.get("_tls_client_cert_key_file"),[0m

[31m--[ [0m[34mMatch #[0m[33m135[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m248 | [0m[35m[0m
[30;1m249 | [0m[35m        self._ssl_options = SSLOptions([0m
[30;1m250 | [0m[35m            # Double negation is generally a bad thing, but we have to keep backward compatibility[0m
[30;1m251 | [0m[35m            tls_verify=not kwargs.get([0m
[30;1m252 | [0m[35m                "_tls_no_verify", False[0m
[30;1m253 | [0m[35m            ),  # by default - verify cert and host[0m
[30;1m254 | [0m[35m            tls_verify_hostname=kwargs.get("_tls_verify_hostname", True),[0m

[31m--[ [0m[34mMatch #[0m[33m136[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m        user_agent_entry = kwargs.get("user_agent_entry")[0m
[30;1m232 | [0m[35m        if user_agent_entry is None:[0m
[30;1m233 | [0m[35m            user_agent_entry = kwargs.get("_user_agent_entry")[0m
[30;1m234 | [0m[35m            if user_agent_entry is not None:[0m
[30;1m235 | [0m[35m                logger.warning([0m
[30;1m236 | [0m[35m                    "[WARN] Parameter '_user_agent_entry' is deprecated; use 'user_agent_entry' inst[0m

[31m--[ [0m[34mMatch #[0m[33m137[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m228 | [0m[35m            server_hostname, **kwargs[0m
[30;1m229 | [0m[35m        )[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m        user_agent_entry = kwargs.get("user_agent_entry")[0m
[30;1m232 | [0m[35m        if user_agent_entry is None:[0m
[30;1m233 | [0m[35m            user_agent_entry = kwargs.get("_user_agent_entry")[0m
[30;1m234 | [0m[35m            if user_agent_entry is not None:[0m

[31m--[ [0m[34mMatch #[0m[33m138[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m222 | [0m[35m        self.host = server_hostname[0m
[30;1m223 | [0m[35m        self.port = kwargs.get("_port", 443)[0m
[30;1m224 | [0m[35m        self.disable_pandas = kwargs.get("_disable_pandas", False)[0m
[30;1m225 | [0m[35m        self.lz4_compression = kwargs.get("enable_query_result_lz4_compression", True)[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m        auth_provider = get_python_sql_connector_auth_provider([0m
[30;1m228 | [0m[35m            server_hostname, **kwargs[0m

[31m--[ [0m[34mMatch #[0m[33m139[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m221 | [0m[35m        self.open = False[0m
[30;1m222 | [0m[35m        self.host = server_hostname[0m
[30;1m223 | [0m[35m        self.port = kwargs.get("_port", 443)[0m
[30;1m224 | [0m[35m        self.disable_pandas = kwargs.get("_disable_pandas", False)[0m
[30;1m225 | [0m[35m        self.lz4_compression = kwargs.get("enable_query_result_lz4_compression", True)[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m        auth_provider = get_python_sql_connector_auth_provider([0m

[31m--[ [0m[34mMatch #[0m[33m140[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m        self.open = False[0m
[30;1m222 | [0m[35m        self.host = server_hostname[0m
[30;1m223 | [0m[35m        self.port = kwargs.get("_port", 443)[0m
[30;1m224 | [0m[35m        self.disable_pandas = kwargs.get("_disable_pandas", False)[0m
[30;1m225 | [0m[35m        self.lz4_compression = kwargs.get("enable_query_result_lz4_compression", True)[0m
[30;1m226 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m141[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m.hostname[0m
[30;1m251 | [0m[35m            tls_verify=not kwargs.get([0m
[30;1m252 | [0m[35m                "_tls_no_verify", False[0m
[30;1m253 | [0m[35m            ),  # by default - verify cert and host[0m
[30;1m254 | [0m[35m            tls_verify_hostname=kwargs.get("_tls_verify_hostname", True),[0m
[30;1m255 | [0m[35m            tls_trusted_ca_file=kwargs.get("_tls_trusted_ca_file"),[0m
[30;1m256 | [0m[35m            tls_client_cert_file=kwargs.get("_tls_client_cert_file"),[0m
[30;1m257 | [0m[35m            tls_client_cert_key_file=kwargs.get("_tls_client_cert_key_file"),[0m

[31m--[ [0m[34mMatch #[0m[33m142[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m.hostname[0m
[30;1m251 | [0m[35m            tls_verify=not kwargs.get([0m
[30;1m252 | [0m[35m                "_tls_no_verify", False[0m
[30;1m253 | [0m[35m            ),  # by default - verify cert and host[0m
[30;1m254 | [0m[35m            tls_verify_hostname=kwargs.get("_tls_verify_hostname", True),[0m
[30;1m255 | [0m[35m            tls_trusted_ca_file=kwargs.get("_tls_trusted_ca_file"),[0m
[30;1m256 | [0m[35m            tls_client_cert_file=kwargs.get("_tls_client_cert_file"),[0m
[30;1m257 | [0m[35m            tls_client_cert_key_file=kwargs.get("_tls_client_cert_key_file"),[0m

[31m--[ [0m[34mMatch #[0m[33m143[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m.hostname[0m
[30;1m225 | [0m[35m        self.lz4_compression = kwargs.get("enable_query_result_lz4_compression", True)[0m
[30;1m226 | [0m[35m[0m
[30;1m227 | [0m[35m        auth_provider = get_python_sql_connector_auth_provider([0m
[30;1m228 | [0m[35m            server_hostname, **kwargs[0m
[30;1m229 | [0m[35m        )[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m        user_agent_entry = kwargs.get("user_agent_entry")[0m

[31m--[ [0m[34mMatch #[0m[33m144[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m.hostname[0m
[30;1m219 | [0m[35m            kwargs = {**kwargs, **access_token_kv}[0m
[30;1m220 | [0m[35m[0m
[30;1m221 | [0m[35m        self.open = False[0m
[30;1m222 | [0m[35m        self.host = server_hostname[0m
[30;1m223 | [0m[35m        self.port = kwargs.get("_port", 443)[0m
[30;1m224 | [0m[35m        self.disable_pandas = kwargs.get("_disable_pandas", False)[0m
[30;1m225 | [0m[35m        self.lz4_compression = kwargs.get("enable_query_result_lz4_compression", True)[0m

[31m--[ [0m[34mMatch #[0m[33m145[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m.hostname[0m
[30;1m190 | [0m[35m        # _tls_no_verify[0m
[30;1m191 | [0m[35m        #   Set to True (Boolean) to completely disable SSL verification.[0m
[30;1m192 | [0m[35m        # _tls_verify_hostname[0m
[30;1m193 | [0m[35m        #   Set to False (Boolean) to disable SSL hostname verification, but check certificate.[0m
[30;1m194 | [0m[35m        # _tls_trusted_ca_file[0m
[30;1m195 | [0m[35m        #   Set to the path of the file containing trusted CA certificates for server certificate[0m
[30;1m196 | [0m[35m        #   verification. If not provide, uses system truststore.[0m

[31m--[ [0m[34mMatch #[0m[33m146[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m.hostname[0m
[30;1m189 | [0m[35m        #  Don't set routing headers if set to True (for use when connecting directly to server)[0m
[30;1m190 | [0m[35m        # _tls_no_verify[0m
[30;1m191 | [0m[35m        #   Set to True (Boolean) to completely disable SSL verification.[0m
[30;1m192 | [0m[35m        # _tls_verify_hostname[0m
[30;1m193 | [0m[35m        #   Set to False (Boolean) to disable SSL hostname verification, but check certificate.[0m
[30;1m194 | [0m[35m        # _tls_trusted_ca_file[0m
[30;1m195 | [0m[35m        #   Set to the path of the file containing trusted CA certificates for server certificate[0m

[31m--[ [0m[34mMatch #[0m[33m147[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m.hostname[0m
[30;1m163 | [0m[35m                        from databricks.sql.experimental.oauth_persistence import DevOnlyFilePersist[0m
[30;1m164 | [0m[35m[0m
[30;1m165 | [0m[35m                        connection = sql.connect([0m
[30;1m166 | [0m[35m                            server_hostname='dbc-12345.staging.cloud.databricks.com',[0m
[30;1m167 | [0m[35m                            http_path='sql/protocolv1/o/6789/12abc567',[0m
[30;1m168 | [0m[35m                            auth_type="databricks-oauth",[0m
[30;1m169 | [0m[35m                            experimental_oauth_persistence=DevOnlyFilePersistence("~/dev-oauth.json"[0m

[31m--[ [0m[34mMatch #[0m[33m148[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m.hostname[0m
[30;1m147 | [0m[35m[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m                    connection = sql.connect([0m
[30;1m150 | [0m[35m                        server_hostname='dbc-12345.staging.cloud.databricks.com',[0m
[30;1m151 | [0m[35m                        http_path='sql/protocolv1/o/6789/12abc567',[0m
[30;1m152 | [0m[35m                        auth_type="databricks-oauth",[0m
[30;1m153 | [0m[35m                        experimental_oauth_persistence=MyCustomImplementation()[0m

[31m--[ [0m[34mMatch #[0m[33m149[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m.hostname[0m
[30;1m93 | [0m[35m                Examples:[0m
[30;1m94 | [0m[35m                        ```[0m
[30;1m95 | [0m[35m                         connection = sql.connect([0m
[30;1m96 | [0m[35m                            server_hostname='dbc-12345.staging.cloud.databricks.com',[0m
[30;1m97 | [0m[35m                            http_path='sql/protocolv1/o/6789/12abc567',[0m
[30;1m98 | [0m[35m                            access_token='dabpi12345678'[0m
[30;1m99 | [0m[35m                         )[0m

[31m--[ [0m[34mMatch #[0m[33m150[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m.hostname[0m
[30;1m84 | [0m[35m        Connect to a Databricks SQL endpoint or a Databricks cluster.[0m
[30;1m85 | [0m[35m[0m
[30;1m86 | [0m[35m        Parameters:[0m
[30;1m87 | [0m[35m            :param server_hostname: Databricks instance host name.[0m
[30;1m88 | [0m[35m            :param http_path: Http path either to a DBSQL endpoint (e.g. /sql/1.0/endpoints/12345678[0m
[30;1m89 | [0m[35m                or to a DBR interactive cluster (e.g. /sql/protocolv1/o/1234567890123456/1234-123456[0m
[30;1m90 | [0m[35m            :param access_token: `str`, optional[0m

[31m--[ [0m[34mMatch #[0m[33m151[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m.hostname[0m
[30;1m70 | [0m[35mclass Connection:[0m
[30;1m71 | [0m[35m    def __init__([0m
[30;1m72 | [0m[35m        self,[0m
[30;1m73 | [0m[35m        server_hostname: str,[0m
[30;1m74 | [0m[35m        http_path: str,[0m
[30;1m75 | [0m[35m        access_token: Optional[str] = None,[0m
[30;1m76 | [0m[35m        http_headers: Optional[List[Tuple[str, str]]] = None,[0m

[31m--[ [0m[34mMatch #[0m[33m152[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1272 | [0m[35m                break[0m
[30;1m1273 | [0m[35m[0m
[30;1m1274 | [0m[35m    def _fill_results_buffer(self):[0m
[30;1m1275 | [0m[35m        # At initialization or if the server does not have cloud fetch result links available[0m
[30;1m1276 | [0m[35m        results, has_more_rows = self.thrift_backend.fetch_results([0m
[30;1m1277 | [0m[35m            op_handle=self.command_id,[0m
[30;1m1278 | [0m[35m            max_rows=self.arraysize,[0m

[31m--[ [0m[34mMatch #[0m[33m153[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m1239 | [0m[35m        :param connection: The parent connection that was used to execute this command[0m
[30;1m1240 | [0m[35m        :param execute_response: A `ExecuteResponse` class returned by a command execution[0m
[30;1m1241 | [0m[35m        :param result_buffer_size_bytes: The size (in bytes) of the internal buffer + max fetch[0m
[30;1m1242 | [0m[35m        amount :param arraysize: The max number of rows to fetch at a time (PEP-249)[0m
[30;1m1243 | [0m[35m        """[0m
[30;1m1244 | [0m[35m        self.connection = connection[0m
[30;1m1245 | [0m[35m        self.command_id = execute_response.command_handle[0m

[31m--[ [0m[34mMatch #[0m[33m154[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m637 | [0m[35m        if getattr(row, "localFile", None):[0m
[30;1m638 | [0m[35m            abs_localFile = os.path.abspath(row.localFile)[0m
[30;1m639 | [0m[35m            for abs_staging_allowed_local_path in abs_staging_allowed_local_paths:[0m
[30;1m640 | [0m[35m                # If the indicated local file matches at least one allowed base path, allow the oper[0m
[30;1m641 | [0m[35m                if ([0m
[30;1m642 | [0m[35m                    os.path.commonpath([abs_localFile, abs_staging_allowed_local_path])[0m
[30;1m643 | [0m[35m                    == abs_staging_allowed_local_path[0m

[31m--[ [0m[34mMatch #[0m[33m155[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m618 | [0m[35m            _staging_allowed_local_paths = staging_allowed_local_path[0m
[30;1m619 | [0m[35m        else:[0m
[30;1m620 | [0m[35m            raise Error([0m
[30;1m621 | [0m[35m                "You must provide at least one staging_allowed_local_path when initialising a connec[0m
[30;1m622 | [0m[35m            )[0m
[30;1m623 | [0m[35m[0m
[30;1m624 | [0m[35m        abs_staging_allowed_local_paths = [[0m

[31m--[ [0m[34mMatch #[0m[33m156[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m406 | [0m[35m                )[0m
[30;1m407 | [0m[35m            else:[0m
[30;1m408 | [0m[35m                logger.warning([0m
[30;1m409 | [0m[35m                    f"Attempt to close session raised an exception at the server: {e}"[0m
[30;1m410 | [0m[35m                )[0m
[30;1m411 | [0m[35m        except Exception as e:[0m
[30;1m412 | [0m[35m            logger.error(f"Attempt to close session raised a local exception: {e}")[0m

[31m--[ [0m[34mMatch #[0m[33m157[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1239 | [0m[35m        :param connection: The parent connection that was used to execute this command[0m
[30;1m1240 | [0m[35m        :param execute_response: A `ExecuteResponse` class returned by a command execution[0m
[30;1m1241 | [0m[35m        :param result_buffer_size_bytes: The size (in bytes) of the internal buffer + max fetch[0m
[30;1m1242 | [0m[35m        amount :param arraysize: The max number of rows to fetch at a time (PEP-249)[0m
[30;1m1243 | [0m[35m        """[0m
[30;1m1244 | [0m[35m        self.connection = connection[0m
[30;1m1245 | [0m[35m        self.command_id = execute_response.command_handle[0m

[31m--[ [0m[34mMatch #[0m[33m158[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m919 | [0m[35m        self._check_not_closed()[0m
[30;1m920 | [0m[35m[0m
[30;1m921 | [0m[35m        while self.is_query_pending():[0m
[30;1m922 | [0m[35m            # Poll after some default time[0m
[30;1m923 | [0m[35m            time.sleep(self.ASYNC_DEFAULT_POLLING_INTERVAL)[0m
[30;1m924 | [0m[35m[0m
[30;1m925 | [0m[35m        operation_state = self.get_query_state()[0m
[30;1m926 | [0m[35m        if operation_state == ttypes.TOperationState.FINISHED_STATE:[0m

[31m--[ [0m[34mMatch #[0m[33m159[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m200 | [0m[35m        # _retry_stop_after_attempts_count[0m
[30;1m201 | [0m[35m        #  The maximum number of attempts during a request retry sequence (defaults to 24)[0m
[30;1m202 | [0m[35m        # _socket_timeout[0m
[30;1m203 | [0m[35m        #  The timeout in seconds for socket send, recv and connect operations. Defaults to None for[0m
[30;1m204 | [0m[35m        #  no timeout. Should be a positive float or integer.[0m
[30;1m205 | [0m[35m        # _disable_pandas[0m
[30;1m206 | [0m[35m        #  In case the deserialisation through pandas causes any issues, it can be disabled with[0m

[31m--[ [0m[34mMatch #[0m[33m160[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m58 | [0m[35m    logger.warning([0m
[30;1m59 | [0m[35m        "[WARN] pyarrow is not installed by default since databricks-sql-connector 4.0.0,"[0m
[30;1m60 | [0m[35m        "any arrow specific api (e.g. fetchmany_arrow) and cloud fetch will be disabled."[0m
[30;1m61 | [0m[35m        "If you need these features, please run pip install pyarrow or pip install databricks-sql-co[0m
[30;1m62 | [0m[35m    )[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35mDEFAULT_RESULT_BUFFER_SIZE_BYTES = 104857600[0m

[31m--[ [0m[34mMatch #[0m[33m161[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m58 | [0m[35m    logger.warning([0m
[30;1m59 | [0m[35m        "[WARN] pyarrow is not installed by default since databricks-sql-connector 4.0.0,"[0m
[30;1m60 | [0m[35m        "any arrow specific api (e.g. fetchmany_arrow) and cloud fetch will be disabled."[0m
[30;1m61 | [0m[35m        "If you need these features, please run pip install pyarrow or pip install databricks-sql-co[0m
[30;1m62 | [0m[35m    )[0m
[30;1m63 | [0m[35m[0m
[30;1m64 | [0m[35mDEFAULT_RESULT_BUFFER_SIZE_BYTES = 104857600[0m

[31m--[ [0m[34mMatch #[0m[33m162[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport time[0m
[30;1m2 | [0m[35mfrom typing import Dict, Tuple, List, Optional, Any, Union, Sequence[0m
[30;1m3 | [0m[35m[0m
[30;1m4 | [0m[35mimport pandas[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m163[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m244 | [0m[35m        sys.exit(1)[0m
[30;1m245 | [0m[35m    pp.pprint(client.CancelDelegationToken(eval(args[0]),))[0m
[30;1m246 | [0m[35m[0m
[30;1m247 | [0m[35melif cmd == 'RenewDelegationToken':[0m
[30;1m248 | [0m[35m    if len(args) != 1:[0m
[30;1m249 | [0m[35m        print('RenewDelegationToken requires 1 args')[0m
[30;1m250 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m164[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m238 | [0m[35m        sys.exit(1)[0m
[30;1m239 | [0m[35m    pp.pprint(client.GetDelegationToken(eval(args[0]),))[0m
[30;1m240 | [0m[35m[0m
[30;1m241 | [0m[35melif cmd == 'CancelDelegationToken':[0m
[30;1m242 | [0m[35m    if len(args) != 1:[0m
[30;1m243 | [0m[35m        print('CancelDelegationToken requires 1 args')[0m
[30;1m244 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m165[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m232 | [0m[35m        sys.exit(1)[0m
[30;1m233 | [0m[35m    pp.pprint(client.FetchResults(eval(args[0]),))[0m
[30;1m234 | [0m[35m[0m
[30;1m235 | [0m[35melif cmd == 'GetDelegationToken':[0m
[30;1m236 | [0m[35m    if len(args) != 1:[0m
[30;1m237 | [0m[35m        print('GetDelegationToken requires 1 args')[0m
[30;1m238 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m166[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m226 | [0m[35m        sys.exit(1)[0m
[30;1m227 | [0m[35m    pp.pprint(client.GetResultSetMetadata(eval(args[0]),))[0m
[30;1m228 | [0m[35m[0m
[30;1m229 | [0m[35melif cmd == 'FetchResults':[0m
[30;1m230 | [0m[35m    if len(args) != 1:[0m
[30;1m231 | [0m[35m        print('FetchResults requires 1 args')[0m
[30;1m232 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m167[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m220 | [0m[35m        sys.exit(1)[0m
[30;1m221 | [0m[35m    pp.pprint(client.CloseOperation(eval(args[0]),))[0m
[30;1m222 | [0m[35m[0m
[30;1m223 | [0m[35melif cmd == 'GetResultSetMetadata':[0m
[30;1m224 | [0m[35m    if len(args) != 1:[0m
[30;1m225 | [0m[35m        print('GetResultSetMetadata requires 1 args')[0m
[30;1m226 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m168[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m214 | [0m[35m        sys.exit(1)[0m
[30;1m215 | [0m[35m    pp.pprint(client.CancelOperation(eval(args[0]),))[0m
[30;1m216 | [0m[35m[0m
[30;1m217 | [0m[35melif cmd == 'CloseOperation':[0m
[30;1m218 | [0m[35m    if len(args) != 1:[0m
[30;1m219 | [0m[35m        print('CloseOperation requires 1 args')[0m
[30;1m220 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m169[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m208 | [0m[35m        sys.exit(1)[0m
[30;1m209 | [0m[35m    pp.pprint(client.GetOperationStatus(eval(args[0]),))[0m
[30;1m210 | [0m[35m[0m
[30;1m211 | [0m[35melif cmd == 'CancelOperation':[0m
[30;1m212 | [0m[35m    if len(args) != 1:[0m
[30;1m213 | [0m[35m        print('CancelOperation requires 1 args')[0m
[30;1m214 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m170[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m202 | [0m[35m        sys.exit(1)[0m
[30;1m203 | [0m[35m    pp.pprint(client.GetCrossReference(eval(args[0]),))[0m
[30;1m204 | [0m[35m[0m
[30;1m205 | [0m[35melif cmd == 'GetOperationStatus':[0m
[30;1m206 | [0m[35m    if len(args) != 1:[0m
[30;1m207 | [0m[35m        print('GetOperationStatus requires 1 args')[0m
[30;1m208 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m171[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m196 | [0m[35m        sys.exit(1)[0m
[30;1m197 | [0m[35m    pp.pprint(client.GetPrimaryKeys(eval(args[0]),))[0m
[30;1m198 | [0m[35m[0m
[30;1m199 | [0m[35melif cmd == 'GetCrossReference':[0m
[30;1m200 | [0m[35m    if len(args) != 1:[0m
[30;1m201 | [0m[35m        print('GetCrossReference requires 1 args')[0m
[30;1m202 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m172[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m190 | [0m[35m        sys.exit(1)[0m
[30;1m191 | [0m[35m    pp.pprint(client.GetFunctions(eval(args[0]),))[0m
[30;1m192 | [0m[35m[0m
[30;1m193 | [0m[35melif cmd == 'GetPrimaryKeys':[0m
[30;1m194 | [0m[35m    if len(args) != 1:[0m
[30;1m195 | [0m[35m        print('GetPrimaryKeys requires 1 args')[0m
[30;1m196 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m173[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m184 | [0m[35m        sys.exit(1)[0m
[30;1m185 | [0m[35m    pp.pprint(client.GetColumns(eval(args[0]),))[0m
[30;1m186 | [0m[35m[0m
[30;1m187 | [0m[35melif cmd == 'GetFunctions':[0m
[30;1m188 | [0m[35m    if len(args) != 1:[0m
[30;1m189 | [0m[35m        print('GetFunctions requires 1 args')[0m
[30;1m190 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m174[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m178 | [0m[35m        sys.exit(1)[0m
[30;1m179 | [0m[35m    pp.pprint(client.GetTableTypes(eval(args[0]),))[0m
[30;1m180 | [0m[35m[0m
[30;1m181 | [0m[35melif cmd == 'GetColumns':[0m
[30;1m182 | [0m[35m    if len(args) != 1:[0m
[30;1m183 | [0m[35m        print('GetColumns requires 1 args')[0m
[30;1m184 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m175[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m172 | [0m[35m        sys.exit(1)[0m
[30;1m173 | [0m[35m    pp.pprint(client.GetTables(eval(args[0]),))[0m
[30;1m174 | [0m[35m[0m
[30;1m175 | [0m[35melif cmd == 'GetTableTypes':[0m
[30;1m176 | [0m[35m    if len(args) != 1:[0m
[30;1m177 | [0m[35m        print('GetTableTypes requires 1 args')[0m
[30;1m178 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m176[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m166 | [0m[35m        sys.exit(1)[0m
[30;1m167 | [0m[35m    pp.pprint(client.GetSchemas(eval(args[0]),))[0m
[30;1m168 | [0m[35m[0m
[30;1m169 | [0m[35melif cmd == 'GetTables':[0m
[30;1m170 | [0m[35m    if len(args) != 1:[0m
[30;1m171 | [0m[35m        print('GetTables requires 1 args')[0m
[30;1m172 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m177[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m160 | [0m[35m        sys.exit(1)[0m
[30;1m161 | [0m[35m    pp.pprint(client.GetCatalogs(eval(args[0]),))[0m
[30;1m162 | [0m[35m[0m
[30;1m163 | [0m[35melif cmd == 'GetSchemas':[0m
[30;1m164 | [0m[35m    if len(args) != 1:[0m
[30;1m165 | [0m[35m        print('GetSchemas requires 1 args')[0m
[30;1m166 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m178[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m154 | [0m[35m        sys.exit(1)[0m
[30;1m155 | [0m[35m    pp.pprint(client.GetTypeInfo(eval(args[0]),))[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35melif cmd == 'GetCatalogs':[0m
[30;1m158 | [0m[35m    if len(args) != 1:[0m
[30;1m159 | [0m[35m        print('GetCatalogs requires 1 args')[0m
[30;1m160 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m179[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m148 | [0m[35m        sys.exit(1)[0m
[30;1m149 | [0m[35m    pp.pprint(client.ExecuteStatement(eval(args[0]),))[0m
[30;1m150 | [0m[35m[0m
[30;1m151 | [0m[35melif cmd == 'GetTypeInfo':[0m
[30;1m152 | [0m[35m    if len(args) != 1:[0m
[30;1m153 | [0m[35m        print('GetTypeInfo requires 1 args')[0m
[30;1m154 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m180[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m142 | [0m[35m        sys.exit(1)[0m
[30;1m143 | [0m[35m    pp.pprint(client.GetInfo(eval(args[0]),))[0m
[30;1m144 | [0m[35m[0m
[30;1m145 | [0m[35melif cmd == 'ExecuteStatement':[0m
[30;1m146 | [0m[35m    if len(args) != 1:[0m
[30;1m147 | [0m[35m        print('ExecuteStatement requires 1 args')[0m
[30;1m148 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m181[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m136 | [0m[35m        sys.exit(1)[0m
[30;1m137 | [0m[35m    pp.pprint(client.CloseSession(eval(args[0]),))[0m
[30;1m138 | [0m[35m[0m
[30;1m139 | [0m[35melif cmd == 'GetInfo':[0m
[30;1m140 | [0m[35m    if len(args) != 1:[0m
[30;1m141 | [0m[35m        print('GetInfo requires 1 args')[0m
[30;1m142 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m182[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m130 | [0m[35m        sys.exit(1)[0m
[30;1m131 | [0m[35m    pp.pprint(client.OpenSession(eval(args[0]),))[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35melif cmd == 'CloseSession':[0m
[30;1m134 | [0m[35m    if len(args) != 1:[0m
[30;1m135 | [0m[35m        print('CloseSession requires 1 args')[0m
[30;1m136 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m183[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m124 | [0m[35mclient = TCLIService.Client(protocol)[0m
[30;1m125 | [0m[35mtransport.open()[0m
[30;1m126 | [0m[35m[0m
[30;1m127 | [0m[35mif cmd == 'OpenSession':[0m
[30;1m128 | [0m[35m    if len(args) != 1:[0m
[30;1m129 | [0m[35m        print('OpenSession requires 1 args')[0m
[30;1m130 | [0m[35m        sys.exit(1)[0m

[31m--[ [0m[34mMatch #[0m[33m184[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/thrift_api/TCLIService/TCLIService-remote[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m105 | [0m[35mif sys.argv[argi] == '-certfile':[0m
[30;1m106 | [0m[35m    certfile = sys.argv[argi+1][0m
[30;1m107 | [0m[35m    argi += 2[0m
[30;1m108 | [0m[35m[0m
[30;1m109 | [0m[35mcmd = sys.argv[argi][0m
[30;1m110 | [0m[35margs = sys.argv[argi + 1:][0m
[30;1m111 | [0m[35m[0m
[30;1m112 | [0m[35mif http:[0m

[31m--[ [0m[34mMatch #[0m[33m185[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m88 | [0m[35m```[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35mIn the above example:[0m
[30;1m91 | [0m[35m- `server-hostname` is the Databricks instance host name.[0m
[30;1m92 | [0m[35m- `http-path` is the HTTP Path either to a Databricks SQL endpoint (e.g. /sql/1.0/endpoints/12345678[0m
[30;1m93 | [0m[35mor to a Databricks Runtime interactive cluster (e.g. /sql/protocolv1/o/1234567890123456/1234-123456-[0m
[30;1m94 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m186[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/PKG-INFO[0m
   Pattern: [32m.hostname[0m
[30;1m74 | [0m[35mhttp_path = os.getenv("DATABRICKS_HTTP_PATH")[0m
[30;1m75 | [0m[35m[0m
[30;1m76 | [0m[35mconnection = sql.connect([0m
[30;1m77 | [0m[35m  server_hostname=host,[0m
[30;1m78 | [0m[35m  http_path=http_path)[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35mcursor = connection.cursor()[0m

[31m--[ [0m[34mMatch #[0m[33m187[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/PKG-INFO[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m37 | [0m[35mhon DB API 2.0 specification](https://www.python.org/dev/peps/pep-0249/).[0m
[30;1m38 | [0m[35m[0m
[30;1m39 | [0m[35mThis connector uses Arrow as the data-exchange format, and supports APIs (e.g. `fetchmany_arrow`) to[0m
[30;1m40 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m188[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m124 | [0m[35m        if kwargs.get("oauth_client_id") and kwargs.get("oauth_redirect_port")[0m
[30;1m125 | [0m[35m        else redirect_port_range,[0m
[30;1m126 | [0m[35m        oauth_persistence=kwargs.get("experimental_oauth_persistence"),[0m
[30;1m127 | [0m[35m        credentials_provider=kwargs.get("credentials_provider"),[0m
[30;1m128 | [0m[35m    )[0m
[30;1m129 | [0m[35m    return get_auth_provider(cfg)[0m

[31m--[ [0m[34mMatch #[0m[33m189[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m123 | [0m[35m        oauth_redirect_port_range=[kwargs["oauth_redirect_port"]][0m
[30;1m124 | [0m[35m        if kwargs.get("oauth_client_id") and kwargs.get("oauth_redirect_port")[0m
[30;1m125 | [0m[35m        else redirect_port_range,[0m
[30;1m126 | [0m[35m        oauth_persistence=kwargs.get("experimental_oauth_persistence"),[0m
[30;1m127 | [0m[35m        credentials_provider=kwargs.get("credentials_provider"),[0m
[30;1m128 | [0m[35m    )[0m
[30;1m129 | [0m[35m    return get_auth_provider(cfg)[0m

[31m--[ [0m[34mMatch #[0m[33m190[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m121 | [0m[35m        oauth_scopes=PYSQL_OAUTH_SCOPES,[0m
[30;1m122 | [0m[35m        oauth_client_id=kwargs.get("oauth_client_id") or client_id,[0m
[30;1m123 | [0m[35m        oauth_redirect_port_range=[kwargs["oauth_redirect_port"]][0m
[30;1m124 | [0m[35m        if kwargs.get("oauth_client_id") and kwargs.get("oauth_redirect_port")[0m
[30;1m125 | [0m[35m        else redirect_port_range,[0m
[30;1m126 | [0m[35m        oauth_persistence=kwargs.get("experimental_oauth_persistence"),[0m
[30;1m127 | [0m[35m        credentials_provider=kwargs.get("credentials_provider"),[0m

[31m--[ [0m[34mMatch #[0m[33m191[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m121 | [0m[35m        oauth_scopes=PYSQL_OAUTH_SCOPES,[0m
[30;1m122 | [0m[35m        oauth_client_id=kwargs.get("oauth_client_id") or client_id,[0m
[30;1m123 | [0m[35m        oauth_redirect_port_range=[kwargs["oauth_redirect_port"]][0m
[30;1m124 | [0m[35m        if kwargs.get("oauth_client_id") and kwargs.get("oauth_redirect_port")[0m
[30;1m125 | [0m[35m        else redirect_port_range,[0m
[30;1m126 | [0m[35m        oauth_persistence=kwargs.get("experimental_oauth_persistence"),[0m
[30;1m127 | [0m[35m        credentials_provider=kwargs.get("credentials_provider"),[0m

[31m--[ [0m[34mMatch #[0m[33m192[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m119 | [0m[35m        use_cert_as_auth=kwargs.get("_use_cert_as_auth"),[0m
[30;1m120 | [0m[35m        tls_client_cert_file=kwargs.get("_tls_client_cert_file"),[0m
[30;1m121 | [0m[35m        oauth_scopes=PYSQL_OAUTH_SCOPES,[0m
[30;1m122 | [0m[35m        oauth_client_id=kwargs.get("oauth_client_id") or client_id,[0m
[30;1m123 | [0m[35m        oauth_redirect_port_range=[kwargs["oauth_redirect_port"]][0m
[30;1m124 | [0m[35m        if kwargs.get("oauth_client_id") and kwargs.get("oauth_redirect_port")[0m
[30;1m125 | [0m[35m        else redirect_port_range,[0m

[31m--[ [0m[34mMatch #[0m[33m193[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m117 | [0m[35m        auth_type=auth_type,[0m
[30;1m118 | [0m[35m        access_token=kwargs.get("access_token"),[0m
[30;1m119 | [0m[35m        use_cert_as_auth=kwargs.get("_use_cert_as_auth"),[0m
[30;1m120 | [0m[35m        tls_client_cert_file=kwargs.get("_tls_client_cert_file"),[0m
[30;1m121 | [0m[35m        oauth_scopes=PYSQL_OAUTH_SCOPES,[0m
[30;1m122 | [0m[35m        oauth_client_id=kwargs.get("oauth_client_id") or client_id,[0m
[30;1m123 | [0m[35m        oauth_redirect_port_range=[kwargs["oauth_redirect_port"]][0m

[31m--[ [0m[34mMatch #[0m[33m194[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m116 | [0m[35m        hostname=normalize_host_name(hostname),[0m
[30;1m117 | [0m[35m        auth_type=auth_type,[0m
[30;1m118 | [0m[35m        access_token=kwargs.get("access_token"),[0m
[30;1m119 | [0m[35m        use_cert_as_auth=kwargs.get("_use_cert_as_auth"),[0m
[30;1m120 | [0m[35m        tls_client_cert_file=kwargs.get("_tls_client_cert_file"),[0m
[30;1m121 | [0m[35m        oauth_scopes=PYSQL_OAUTH_SCOPES,[0m
[30;1m122 | [0m[35m        oauth_client_id=kwargs.get("oauth_client_id") or client_id,[0m

[31m--[ [0m[34mMatch #[0m[33m195[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m115 | [0m[35m    cfg = ClientContext([0m
[30;1m116 | [0m[35m        hostname=normalize_host_name(hostname),[0m
[30;1m117 | [0m[35m        auth_type=auth_type,[0m
[30;1m118 | [0m[35m        access_token=kwargs.get("access_token"),[0m
[30;1m119 | [0m[35m        use_cert_as_auth=kwargs.get("_use_cert_as_auth"),[0m
[30;1m120 | [0m[35m        tls_client_cert_file=kwargs.get("_tls_client_cert_file"),[0m
[30;1m121 | [0m[35m        oauth_scopes=PYSQL_OAUTH_SCOPES,[0m

[31m--[ [0m[34mMatch #[0m[33m196[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m    (client_id, redirect_port_range) = get_client_id_and_redirect_port([0m
[30;1m107 | [0m[35m        auth_type == AuthType.AZURE_OAUTH.value[0m
[30;1m108 | [0m[35m    )[0m
[30;1m109 | [0m[35m    if kwargs.get("username") or kwargs.get("password"):[0m
[30;1m110 | [0m[35m        raise ValueError([0m
[30;1m111 | [0m[35m            "Username/password authentication is no longer supported. "[0m
[30;1m112 | [0m[35m            "Please use OAuth or access token instead."[0m

[31m--[ [0m[34mMatch #[0m[33m197[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m106 | [0m[35m    (client_id, redirect_port_range) = get_client_id_and_redirect_port([0m
[30;1m107 | [0m[35m        auth_type == AuthType.AZURE_OAUTH.value[0m
[30;1m108 | [0m[35m    )[0m
[30;1m109 | [0m[35m    if kwargs.get("username") or kwargs.get("password"):[0m
[30;1m110 | [0m[35m        raise ValueError([0m
[30;1m111 | [0m[35m            "Username/password authentication is no longer supported. "[0m
[30;1m112 | [0m[35m            "Please use OAuth or access token instead."[0m

[31m--[ [0m[34mMatch #[0m[33m198[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35mdef get_python_sql_connector_auth_provider(hostname: str, **kwargs):[0m
[30;1m105 | [0m[35m    auth_type = kwargs.get("auth_type")[0m
[30;1m106 | [0m[35m    (client_id, redirect_port_range) = get_client_id_and_redirect_port([0m
[30;1m107 | [0m[35m        auth_type == AuthType.AZURE_OAUTH.value[0m
[30;1m108 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m199[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m.hostname[0m
[30;1m113 | [0m[35m        )[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    cfg = ClientContext([0m
[30;1m116 | [0m[35m        hostname=normalize_host_name(hostname),[0m
[30;1m117 | [0m[35m        auth_type=auth_type,[0m
[30;1m118 | [0m[35m        access_token=kwargs.get("access_token"),[0m
[30;1m119 | [0m[35m        use_cert_as_auth=kwargs.get("_use_cert_as_auth"),[0m

[31m--[ [0m[34mMatch #[0m[33m200[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m.hostname[0m
[30;1m113 | [0m[35m        )[0m
[30;1m114 | [0m[35m[0m
[30;1m115 | [0m[35m    cfg = ClientContext([0m
[30;1m116 | [0m[35m        hostname=normalize_host_name(hostname),[0m
[30;1m117 | [0m[35m        auth_type=auth_type,[0m
[30;1m118 | [0m[35m        access_token=kwargs.get("access_token"),[0m
[30;1m119 | [0m[35m        use_cert_as_auth=kwargs.get("_use_cert_as_auth"),[0m

[31m--[ [0m[34mMatch #[0m[33m201[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m.hostname[0m
[30;1m101 | [0m[35m    )[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35mdef get_python_sql_connector_auth_provider(hostname: str, **kwargs):[0m
[30;1m105 | [0m[35m    auth_type = kwargs.get("auth_type")[0m
[30;1m106 | [0m[35m    (client_id, redirect_port_range) = get_client_id_and_redirect_port([0m
[30;1m107 | [0m[35m        auth_type == AuthType.AZURE_OAUTH.value[0m

[31m--[ [0m[34mMatch #[0m[33m202[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m.hostname[0m
[30;1m90 | [0m[35mdef normalize_host_name(hostname: str):[0m
[30;1m91 | [0m[35m    maybe_scheme = "https://" if not hostname.startswith("https://") else ""[0m
[30;1m92 | [0m[35m    maybe_trailing_slash = "/" if not hostname.endswith("/") else ""[0m
[30;1m93 | [0m[35m    return f"{maybe_scheme}{hostname}{maybe_trailing_slash}"[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m[0m
[30;1m96 | [0m[35mdef get_client_id_and_redirect_port(use_azure_auth: bool):[0m

[31m--[ [0m[34mMatch #[0m[33m203[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m.hostname[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35mdef normalize_host_name(hostname: str):[0m
[30;1m91 | [0m[35m    maybe_scheme = "https://" if not hostname.startswith("https://") else ""[0m
[30;1m92 | [0m[35m    maybe_trailing_slash = "/" if not hostname.endswith("/") else ""[0m
[30;1m93 | [0m[35m    return f"{maybe_scheme}{hostname}{maybe_trailing_slash}"[0m
[30;1m94 | [0m[35m[0m
[30;1m95 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m204[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m.hostname[0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35mdef normalize_host_name(hostname: str):[0m
[30;1m91 | [0m[35m    maybe_scheme = "https://" if not hostname.startswith("https://") else ""[0m
[30;1m92 | [0m[35m    maybe_trailing_slash = "/" if not hostname.endswith("/") else ""[0m
[30;1m93 | [0m[35m    return f"{maybe_scheme}{hostname}{maybe_trailing_slash}"[0m
[30;1m94 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m205[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m.hostname[0m
[30;1m87 | [0m[35mPYSQL_OAUTH_AZURE_REDIRECT_PORT_RANGE = [8030][0m
[30;1m88 | [0m[35m[0m
[30;1m89 | [0m[35m[0m
[30;1m90 | [0m[35mdef normalize_host_name(hostname: str):[0m
[30;1m91 | [0m[35m    maybe_scheme = "https://" if not hostname.startswith("https://") else ""[0m
[30;1m92 | [0m[35m    maybe_trailing_slash = "/" if not hostname.endswith("/") else ""[0m
[30;1m93 | [0m[35m    return f"{maybe_scheme}{hostname}{maybe_trailing_slash}"[0m

[31m--[ [0m[34mMatch #[0m[33m206[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m.hostname[0m
[30;1m70 | [0m[35m            and cfg.oauth_scopes is not None[0m
[30;1m71 | [0m[35m        ):[0m
[30;1m72 | [0m[35m            return DatabricksOAuthProvider([0m
[30;1m73 | [0m[35m                cfg.hostname,[0m
[30;1m74 | [0m[35m                cfg.oauth_persistence,[0m
[30;1m75 | [0m[35m                cfg.oauth_redirect_port_range,[0m
[30;1m76 | [0m[35m                cfg.oauth_client_id,[0m

[31m--[ [0m[34mMatch #[0m[33m207[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m.hostname[0m
[30;1m51 | [0m[35m        assert cfg.oauth_scopes is not None[0m
[30;1m52 | [0m[35m[0m
[30;1m53 | [0m[35m        return DatabricksOAuthProvider([0m
[30;1m54 | [0m[35m            cfg.hostname,[0m
[30;1m55 | [0m[35m            cfg.oauth_persistence,[0m
[30;1m56 | [0m[35m            cfg.oauth_redirect_port_range,[0m
[30;1m57 | [0m[35m            cfg.oauth_client_id,[0m

[31m--[ [0m[34mMatch #[0m[33m208[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m.hostname[0m
[30;1m30 | [0m[35m        oauth_persistence=None,[0m
[30;1m31 | [0m[35m        credentials_provider=None,[0m
[30;1m32 | [0m[35m    ):[0m
[30;1m33 | [0m[35m        self.hostname = hostname[0m
[30;1m34 | [0m[35m        self.access_token = access_token[0m
[30;1m35 | [0m[35m        self.auth_type = auth_type[0m
[30;1m36 | [0m[35m        self.oauth_scopes = oauth_scopes[0m

[31m--[ [0m[34mMatch #[0m[33m209[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m.hostname[0m
[30;1m30 | [0m[35m        oauth_persistence=None,[0m
[30;1m31 | [0m[35m        credentials_provider=None,[0m
[30;1m32 | [0m[35m    ):[0m
[30;1m33 | [0m[35m        self.hostname = hostname[0m
[30;1m34 | [0m[35m        self.access_token = access_token[0m
[30;1m35 | [0m[35m        self.auth_type = auth_type[0m
[30;1m36 | [0m[35m        self.oauth_scopes = oauth_scopes[0m

[31m--[ [0m[34mMatch #[0m[33m210[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/auth.py[0m
   Pattern: [32m.hostname[0m
[30;1m19 | [0m[35mclass ClientContext:[0m
[30;1m20 | [0m[35m    def __init__([0m
[30;1m21 | [0m[35m        self,[0m
[30;1m22 | [0m[35m        hostname: str,[0m
[30;1m23 | [0m[35m        access_token: Optional[str] = None,[0m
[30;1m24 | [0m[35m        auth_type: Optional[str] = None,[0m
[30;1m25 | [0m[35m        oauth_scopes: Optional[List[str]] = None,[0m

[31m--[ [0m[34mMatch #[0m[33m211[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/authenticators.py[0m
   Pattern: [32m.hostname[0m
[30;1m132 | [0m[35m[0m
[30;1m133 | [0m[35m                if self._oauth_persistence:[0m
[30;1m134 | [0m[35m                    token = OAuthToken(self._access_token, self._refresh_token)[0m
[30;1m135 | [0m[35m                    self._oauth_persistence.persist(self._hostname, token)[0m
[30;1m136 | [0m[35m        except Exception as e:[0m
[30;1m137 | [0m[35m            logging.error(f"unexpected error in oauth token update", e, exc_info=True)[0m
[30;1m138 | [0m[35m            raise e[0m

[31m--[ [0m[34mMatch #[0m[33m212[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/authenticators.py[0m
   Pattern: [32m.hostname[0m
[30;1m120 | [0m[35m                fresh_refresh_token,[0m
[30;1m121 | [0m[35m                is_refreshed,[0m
[30;1m122 | [0m[35m            ) = self.oauth_manager.check_and_refresh_access_token([0m
[30;1m123 | [0m[35m                hostname=self._hostname,[0m
[30;1m124 | [0m[35m                access_token=self._access_token,[0m
[30;1m125 | [0m[35m                refresh_token=self._refresh_token,[0m
[30;1m126 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m213[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/authenticators.py[0m
   Pattern: [32m.hostname[0m
[30;1m120 | [0m[35m                fresh_refresh_token,[0m
[30;1m121 | [0m[35m                is_refreshed,[0m
[30;1m122 | [0m[35m            ) = self.oauth_manager.check_and_refresh_access_token([0m
[30;1m123 | [0m[35m                hostname=self._hostname,[0m
[30;1m124 | [0m[35m                access_token=self._access_token,[0m
[30;1m125 | [0m[35m                refresh_token=self._refresh_token,[0m
[30;1m126 | [0m[35m            )[0m

[31m--[ [0m[34mMatch #[0m[33m214[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/authenticators.py[0m
   Pattern: [32m.hostname[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m                if self._oauth_persistence:[0m
[30;1m109 | [0m[35m                    self._oauth_persistence.persist([0m
[30;1m110 | [0m[35m                        self._hostname, OAuthToken(access_token, refresh_token)[0m
[30;1m111 | [0m[35m                    )[0m
[30;1m112 | [0m[35m        except Exception as e:[0m
[30;1m113 | [0m[35m            logging.error(f"unexpected error in oauth initialization", e, exc_info=True)[0m

[31m--[ [0m[34mMatch #[0m[33m215[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/authenticators.py[0m
   Pattern: [32m.hostname[0m
[30;1m100 | [0m[35m                self._update_token_if_expired()[0m
[30;1m101 | [0m[35m            else:[0m
[30;1m102 | [0m[35m                (access_token, refresh_token) = self.oauth_manager.get_tokens([0m
[30;1m103 | [0m[35m                    hostname=self._hostname, scope=self._scopes_as_str[0m
[30;1m104 | [0m[35m                )[0m
[30;1m105 | [0m[35m                self._access_token = access_token[0m
[30;1m106 | [0m[35m                self._refresh_token = refresh_token[0m

[31m--[ [0m[34mMatch #[0m[33m216[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/authenticators.py[0m
   Pattern: [32m.hostname[0m
[30;1m100 | [0m[35m                self._update_token_if_expired()[0m
[30;1m101 | [0m[35m            else:[0m
[30;1m102 | [0m[35m                (access_token, refresh_token) = self.oauth_manager.get_tokens([0m
[30;1m103 | [0m[35m                    hostname=self._hostname, scope=self._scopes_as_str[0m
[30;1m104 | [0m[35m                )[0m
[30;1m105 | [0m[35m                self._access_token = access_token[0m
[30;1m106 | [0m[35m                self._refresh_token = refresh_token[0m

[31m--[ [0m[34mMatch #[0m[33m217[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/authenticators.py[0m
   Pattern: [32m.hostname[0m
[30;1m91 | [0m[35m        try:[0m
[30;1m92 | [0m[35m            if self._access_token is None or self._refresh_token is None:[0m
[30;1m93 | [0m[35m                if self._oauth_persistence:[0m
[30;1m94 | [0m[35m                    token = self._oauth_persistence.read(self._hostname)[0m
[30;1m95 | [0m[35m                    if token:[0m
[30;1m96 | [0m[35m                        self._access_token = token.access_token[0m
[30;1m97 | [0m[35m                        self._refresh_token = token.refresh_token[0m

[31m--[ [0m[34mMatch #[0m[33m218[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/authenticators.py[0m
   Pattern: [32m.hostname[0m
[30;1m72 | [0m[35m                client_id=client_id,[0m
[30;1m73 | [0m[35m                idp_endpoint=idp_endpoint,[0m
[30;1m74 | [0m[35m            )[0m
[30;1m75 | [0m[35m            self._hostname = hostname[0m
[30;1m76 | [0m[35m            self._scopes_as_str = DatabricksOAuthProvider.SCOPE_DELIM.join(cloud_scopes)[0m
[30;1m77 | [0m[35m            self._oauth_persistence = oauth_persistence[0m
[30;1m78 | [0m[35m            self._client_id = client_id[0m

[31m--[ [0m[34mMatch #[0m[33m219[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/authenticators.py[0m
   Pattern: [32m.hostname[0m
[30;1m72 | [0m[35m                client_id=client_id,[0m
[30;1m73 | [0m[35m                idp_endpoint=idp_endpoint,[0m
[30;1m74 | [0m[35m            )[0m
[30;1m75 | [0m[35m            self._hostname = hostname[0m
[30;1m76 | [0m[35m            self._scopes_as_str = DatabricksOAuthProvider.SCOPE_DELIM.join(cloud_scopes)[0m
[30;1m77 | [0m[35m            self._oauth_persistence = oauth_persistence[0m
[30;1m78 | [0m[35m            self._client_id = client_id[0m

[31m--[ [0m[34mMatch #[0m[33m220[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/authenticators.py[0m
   Pattern: [32m.hostname[0m
[30;1m61 | [0m[35m            idp_endpoint = get_oauth_endpoints(hostname, auth_type == "azure-oauth")[0m
[30;1m62 | [0m[35m            if not idp_endpoint:[0m
[30;1m63 | [0m[35m                raise NotImplementedError([0m
[30;1m64 | [0m[35m                    f"OAuth is not supported for host ${hostname}"[0m
[30;1m65 | [0m[35m                )[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35m            # Convert to the corresponding scopes in the corresponding IdP[0m

[31m--[ [0m[34mMatch #[0m[33m221[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/authenticators.py[0m
   Pattern: [32m.hostname[0m
[30;1m58 | [0m[35m        auth_type: str = "databricks-oauth",[0m
[30;1m59 | [0m[35m    ):[0m
[30;1m60 | [0m[35m        try:[0m
[30;1m61 | [0m[35m            idp_endpoint = get_oauth_endpoints(hostname, auth_type == "azure-oauth")[0m
[30;1m62 | [0m[35m            if not idp_endpoint:[0m
[30;1m63 | [0m[35m                raise NotImplementedError([0m
[30;1m64 | [0m[35m                    f"OAuth is not supported for host ${hostname}"[0m

[31m--[ [0m[34mMatch #[0m[33m222[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/authenticators.py[0m
   Pattern: [32m.hostname[0m
[30;1m50 | [0m[35m[0m
[30;1m51 | [0m[35m    def __init__([0m
[30;1m52 | [0m[35m        self,[0m
[30;1m53 | [0m[35m        hostname: str,[0m
[30;1m54 | [0m[35m        oauth_persistence: OAuthPersistence,[0m
[30;1m55 | [0m[35m        redirect_port_range: List[int],[0m
[30;1m56 | [0m[35m        client_id: str,[0m

[31m--[ [0m[34mMatch #[0m[33m223[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/authenticators.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport abc[0m
[30;1m2 | [0m[35mimport base64[0m
[30;1m3 | [0m[35mimport logging[0m
[30;1m4 | [0m[35mfrom typing import Callable, Dict, List[0m
[30;1m5 | [0m[35m[0m
[30;1m6 | [0m[35mfrom databricks.sql.auth.oauth import OAuthManager[0m

[31m--[ [0m[34mMatch #[0m[33m224[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/thrift_http_client.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m183 | [0m[35m            headers.update(**custom_headers)[0m
[30;1m184 | [0m[35m[0m
[30;1m185 | [0m[35m        # HTTP request[0m
[30;1m186 | [0m[35m        self.__resp = self.__pool.request([0m
[30;1m187 | [0m[35m            "POST",[0m
[30;1m188 | [0m[35m            url=self.path,[0m
[30;1m189 | [0m[35m            body=data,[0m

[31m--[ [0m[34mMatch #[0m[33m225[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/thrift_http_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m98 | [0m[35m        super().setCustomHeaders(headers)[0m
[30;1m99 | [0m[35m[0m
[30;1m100 | [0m[35m    def startRetryTimer(self):[0m
[30;1m101 | [0m[35m        """Notify DatabricksRetryPolicy of the request start time[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m        This is used to enforce the retry_stop_after_attempts_duration[0m
[30;1m104 | [0m[35m        """[0m
[30;1m105 | [0m[35m        self.retry_policy and self.retry_policy.start_retry_timer()[0m

[31m--[ [0m[34mMatch #[0m[33m226[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/thrift_http_client.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport logging[0m
[30;1m3 | [0m[35mimport urllib.parse[0m
[30;1m4 | [0m[35mfrom typing import Dict, Union, Optional[0m
[30;1m5 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m227[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/thrift_http_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m74 | [0m[35m[0m
[30;1m75 | [0m[35m            # this is passed to ProxyManager[0m
[30;1m76 | [0m[35m            self.proxy_uri: str = proxy[0m
[30;1m77 | [0m[35m            self.host = parsed.hostname[0m
[30;1m78 | [0m[35m            self.port = parsed.port[0m
[30;1m79 | [0m[35m            self.proxy_auth = self.basic_proxy_auth_headers(parsed)[0m
[30;1m80 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m228[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/thrift_http_client.py[0m
   Pattern: [32m.hostname[0m
[30;1m54 | [0m[35m                    self.keyfile = self._ssl_options.tls_client_cert_key_file[0m
[30;1m55 | [0m[35m                    self.context = self._ssl_options.create_ssl_context()[0m
[30;1m56 | [0m[35m            self.port = parsed.port[0m
[30;1m57 | [0m[35m            self.host = parsed.hostname[0m
[30;1m58 | [0m[35m            self.path = parsed.path[0m
[30;1m59 | [0m[35m            if parsed.query:[0m
[30;1m60 | [0m[35m                self.path += "?%s" % parsed.query[0m

[31m--[ [0m[34mMatch #[0m[33m229[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m.hostname[0m
[30;1m133 | [0m[35m    elif cloud == CloudType.AZURE:[0m
[30;1m134 | [0m[35m        return ([0m
[30;1m135 | [0m[35m            InHouseOAuthEndpointCollection()[0m
[30;1m136 | [0m[35m            if is_supported_databricks_oauth_host(hostname) and not use_azure_auth[0m
[30;1m137 | [0m[35m            else AzureOAuthEndpointCollection()[0m
[30;1m138 | [0m[35m        )[0m
[30;1m139 | [0m[35m    else:[0m

[31m--[ [0m[34mMatch #[0m[33m230[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m.hostname[0m
[30;1m126 | [0m[35mdef get_oauth_endpoints([0m
[30;1m127 | [0m[35m    hostname: str, use_azure_auth: bool[0m
[30;1m128 | [0m[35m) -> Optional[OAuthEndpointCollection]:[0m
[30;1m129 | [0m[35m    cloud = infer_cloud_from_host(hostname)[0m
[30;1m130 | [0m[35m[0m
[30;1m131 | [0m[35m    if cloud in [CloudType.AWS, CloudType.GCP]:[0m
[30;1m132 | [0m[35m        return InHouseOAuthEndpointCollection()[0m

[31m--[ [0m[34mMatch #[0m[33m231[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m.hostname[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m[0m
[30;1m126 | [0m[35mdef get_oauth_endpoints([0m
[30;1m127 | [0m[35m    hostname: str, use_azure_auth: bool[0m
[30;1m128 | [0m[35m) -> Optional[OAuthEndpointCollection]:[0m
[30;1m129 | [0m[35m    cloud = infer_cloud_from_host(hostname)[0m
[30;1m130 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m232[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m.hostname[0m
[30;1m119 | [0m[35m        return f"{idp_url}/oauth2/v2.0/authorize"[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m    def get_openid_config_url(self, hostname: str):[0m
[30;1m122 | [0m[35m        idp_url = get_databricks_oidc_url(hostname)[0m
[30;1m123 | [0m[35m        return f"{idp_url}/.well-known/oauth-authorization-server"[0m
[30;1m124 | [0m[35m[0m
[30;1m125 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m233[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m.hostname[0m
[30;1m118 | [0m[35m        idp_url = get_databricks_oidc_url(hostname)[0m
[30;1m119 | [0m[35m        return f"{idp_url}/oauth2/v2.0/authorize"[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m    def get_openid_config_url(self, hostname: str):[0m
[30;1m122 | [0m[35m        idp_url = get_databricks_oidc_url(hostname)[0m
[30;1m123 | [0m[35m        return f"{idp_url}/.well-known/oauth-authorization-server"[0m
[30;1m124 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m234[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m.hostname[0m
[30;1m115 | [0m[35m        return scopes.copy()[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    def get_authorization_url(self, hostname: str):[0m
[30;1m118 | [0m[35m        idp_url = get_databricks_oidc_url(hostname)[0m
[30;1m119 | [0m[35m        return f"{idp_url}/oauth2/v2.0/authorize"[0m
[30;1m120 | [0m[35m[0m
[30;1m121 | [0m[35m    def get_openid_config_url(self, hostname: str):[0m

[31m--[ [0m[34mMatch #[0m[33m235[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m.hostname[0m
[30;1m114 | [0m[35m        # No scope mapping in AWS[0m
[30;1m115 | [0m[35m        return scopes.copy()[0m
[30;1m116 | [0m[35m[0m
[30;1m117 | [0m[35m    def get_authorization_url(self, hostname: str):[0m
[30;1m118 | [0m[35m        idp_url = get_databricks_oidc_url(hostname)[0m
[30;1m119 | [0m[35m        return f"{idp_url}/oauth2/v2.0/authorize"[0m
[30;1m120 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m236[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m.hostname[0m
[30;1m105 | [0m[35m        # We need get account specific url, which can be redirected by databricks unified oidc endpo[0m
[30;1m106 | [0m[35m        return f"{get_databricks_oidc_url(hostname)}/oauth2/v2.0/authorize"[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m    def get_openid_config_url(self, hostname: str):[0m
[30;1m109 | [0m[35m        return "https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuratio[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m237[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m.hostname[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m    def get_authorization_url(self, hostname: str):[0m
[30;1m105 | [0m[35m        # We need get account specific url, which can be redirected by databricks unified oidc endpo[0m
[30;1m106 | [0m[35m        return f"{get_databricks_oidc_url(hostname)}/oauth2/v2.0/authorize"[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m    def get_openid_config_url(self, hostname: str):[0m
[30;1m109 | [0m[35m        return "https://login.microsoftonline.com/organizations/v2.0/.well-known/openid-configuratio[0m

[31m--[ [0m[34mMatch #[0m[33m238[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m.hostname[0m
[30;1m101 | [0m[35m            mapped_scopes.append(OAuthScope.OFFLINE_ACCESS)[0m
[30;1m102 | [0m[35m        return mapped_scopes[0m
[30;1m103 | [0m[35m[0m
[30;1m104 | [0m[35m    def get_authorization_url(self, hostname: str):[0m
[30;1m105 | [0m[35m        # We need get account specific url, which can be redirected by databricks unified oidc endpo[0m
[30;1m106 | [0m[35m        return f"{get_databricks_oidc_url(hostname)}/oauth2/v2.0/authorize"[0m
[30;1m107 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m239[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m.hostname[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    # Endpoint for well-known openid configuration e.g https://idp.example.com/oauth2/.well-known/op[0m
[30;1m84 | [0m[35m    @abstractmethod[0m
[30;1m85 | [0m[35m    def get_openid_config_url(self, hostname: str) -> str:[0m
[30;1m86 | [0m[35m        raise NotImplementedError()[0m
[30;1m87 | [0m[35m[0m
[30;1m88 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m240[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m.hostname[0m
[30;1m77 | [0m[35m[0m
[30;1m78 | [0m[35m    # Endpoint for oauth2 authorization  e.g https://idp.example.com/oauth2/v2.0/authorize[0m
[30;1m79 | [0m[35m    @abstractmethod[0m
[30;1m80 | [0m[35m    def get_authorization_url(self, hostname: str) -> str:[0m
[30;1m81 | [0m[35m        raise NotImplementedError()[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35m    # Endpoint for well-known openid configuration e.g https://idp.example.com/oauth2/.well-known/op[0m

[31m--[ [0m[34mMatch #[0m[33m241[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m.hostname[0m
[30;1m67 | [0m[35mdef get_databricks_oidc_url(hostname: str):[0m
[30;1m68 | [0m[35m    maybe_scheme = "https://" if not hostname.startswith("https://") else ""[0m
[30;1m69 | [0m[35m    maybe_trailing_slash = "/" if not hostname.endswith("/") else ""[0m
[30;1m70 | [0m[35m    return f"{maybe_scheme}{hostname}{maybe_trailing_slash}{OIDC_REDIRECTOR_PATH}"[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m[0m
[30;1m73 | [0m[35mclass OAuthEndpointCollection(ABC):[0m

[31m--[ [0m[34mMatch #[0m[33m242[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m.hostname[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35mdef get_databricks_oidc_url(hostname: str):[0m
[30;1m68 | [0m[35m    maybe_scheme = "https://" if not hostname.startswith("https://") else ""[0m
[30;1m69 | [0m[35m    maybe_trailing_slash = "/" if not hostname.endswith("/") else ""[0m
[30;1m70 | [0m[35m    return f"{maybe_scheme}{hostname}{maybe_trailing_slash}{OIDC_REDIRECTOR_PATH}"[0m
[30;1m71 | [0m[35m[0m
[30;1m72 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m243[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m.hostname[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35mdef get_databricks_oidc_url(hostname: str):[0m
[30;1m68 | [0m[35m    maybe_scheme = "https://" if not hostname.startswith("https://") else ""[0m
[30;1m69 | [0m[35m    maybe_trailing_slash = "/" if not hostname.endswith("/") else ""[0m
[30;1m70 | [0m[35m    return f"{maybe_scheme}{hostname}{maybe_trailing_slash}{OIDC_REDIRECTOR_PATH}"[0m
[30;1m71 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m244[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m.hostname[0m
[30;1m64 | [0m[35m    return any(e for e in domains if host.endswith(e))[0m
[30;1m65 | [0m[35m[0m
[30;1m66 | [0m[35m[0m
[30;1m67 | [0m[35mdef get_databricks_oidc_url(hostname: str):[0m
[30;1m68 | [0m[35m    maybe_scheme = "https://" if not hostname.startswith("https://") else ""[0m
[30;1m69 | [0m[35m    maybe_trailing_slash = "/" if not hostname.endswith("/") else ""[0m
[30;1m70 | [0m[35m    return f"{maybe_scheme}{hostname}{maybe_trailing_slash}{OIDC_REDIRECTOR_PATH}"[0m

[31m--[ [0m[34mMatch #[0m[33m245[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m.hostname[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35mdef is_supported_databricks_oauth_host(hostname: str) -> bool:[0m
[30;1m60 | [0m[35m    host = hostname.lower().replace("https://", "").split("/")[0][0m
[30;1m61 | [0m[35m    domains = ([0m
[30;1m62 | [0m[35m        DATABRICKS_AWS_DOMAINS + DATABRICKS_GCP_DOMAINS + DATABRICKS_OAUTH_AZURE_DOMAINS[0m
[30;1m63 | [0m[35m    )[0m

[31m--[ [0m[34mMatch #[0m[33m246[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m.hostname[0m
[30;1m56 | [0m[35m        return None[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m[0m
[30;1m59 | [0m[35mdef is_supported_databricks_oauth_host(hostname: str) -> bool:[0m
[30;1m60 | [0m[35m    host = hostname.lower().replace("https://", "").split("/")[0][0m
[30;1m61 | [0m[35m    domains = ([0m
[30;1m62 | [0m[35m        DATABRICKS_AWS_DOMAINS + DATABRICKS_GCP_DOMAINS + DATABRICKS_OAUTH_AZURE_DOMAINS[0m

[31m--[ [0m[34mMatch #[0m[33m247[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m.hostname[0m
[30;1m44 | [0m[35m# Infer cloud type from Databricks SQL instance hostname[0m
[30;1m45 | [0m[35mdef infer_cloud_from_host(hostname: str) -> Optional[CloudType]:[0m
[30;1m46 | [0m[35m    # normalize[0m
[30;1m47 | [0m[35m    host = hostname.lower().replace("https://", "").split("/")[0][0m
[30;1m48 | [0m[35m[0m
[30;1m49 | [0m[35m    if any(e for e in DATABRICKS_AZURE_DOMAINS if host.endswith(e)):[0m
[30;1m50 | [0m[35m        return CloudType.AZURE[0m

[31m--[ [0m[34mMatch #[0m[33m248[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m.hostname[0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m# Infer cloud type from Databricks SQL instance hostname[0m
[30;1m45 | [0m[35mdef infer_cloud_from_host(hostname: str) -> Optional[CloudType]:[0m
[30;1m46 | [0m[35m    # normalize[0m
[30;1m47 | [0m[35m    host = hostname.lower().replace("https://", "").split("/")[0][0m
[30;1m48 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m249[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m.hostname[0m
[30;1m41 | [0m[35mDATABRICKS_OAUTH_AZURE_DOMAINS = [".azuredatabricks.net"][0m
[30;1m42 | [0m[35m[0m
[30;1m43 | [0m[35m[0m
[30;1m44 | [0m[35m# Infer cloud type from Databricks SQL instance hostname[0m
[30;1m45 | [0m[35mdef infer_cloud_from_host(hostname: str) -> Optional[CloudType]:[0m
[30;1m46 | [0m[35m    # normalize[0m
[30;1m47 | [0m[35m    host = hostname.lower().replace("https://", "").split("/")[0][0m

[31m--[ [0m[34mMatch #[0m[33m250[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/endpoint.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m90 | [0m[35m    DATATRICKS_AZURE_APP = "2ff814a6-3304-4ab8-85cb-cd0e6f879c1d"[0m
[30;1m91 | [0m[35m[0m
[30;1m92 | [0m[35m    def get_scopes_mapping(self, scopes: List[str]) -> List[str]:[0m
[30;1m93 | [0m[35m        # There is no corresponding scopes in Azure, instead, access control will be delegated to Da[0m
[30;1m94 | [0m[35m        tenant_id = os.getenv([0m
[30;1m95 | [0m[35m            "DATABRICKS_AZURE_TENANT_ID",[0m
[30;1m96 | [0m[35m            AzureOAuthEndpointCollection.DATATRICKS_AZURE_APP,[0m

[31m--[ [0m[34mMatch #[0m[33m251[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/retry.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m109 | [0m[35m        # we only care about urllib3 kwargs that we alias, override, or add to in some way[0m
[30;1m110 | [0m[35m[0m
[30;1m111 | [0m[35m        # the length of _history increases as retries are performed[0m
[30;1m112 | [0m[35m        _history: Optional[Tuple[RequestHistory, ...]] = urllib3_kwargs.get("history")[0m
[30;1m113 | [0m[35m[0m
[30;1m114 | [0m[35m        if not _history:[0m
[30;1m115 | [0m[35m            # no attempts were made so we can retry the current command as many times as specified[0m

[31m--[ [0m[34mMatch #[0m[33m252[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/retry.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m41 | [0m[35m    @classmethod[0m
[30;1m42 | [0m[35m    def get(cls, value: str):[0m
[30;1m43 | [0m[35m        value_name_map = {i.value: i.name for i in cls}[0m
[30;1m44 | [0m[35m        valid_command = value_name_map.get(value, False)[0m
[30;1m45 | [0m[35m        if valid_command:[0m
[30;1m46 | [0m[35m            return getattr(cls, str(valid_command))[0m
[30;1m47 | [0m[35m        else:[0m

[31m--[ [0m[34mMatch #[0m[33m253[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/retry.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m225 | [0m[35m            respect_retry_after_header=self.respect_retry_after_header,[0m
[30;1m226 | [0m[35m        )[0m
[30;1m227 | [0m[35m[0m
[30;1m228 | [0m[35m        # Update urllib3's current state to reflect the incremented counters[0m
[30;1m229 | [0m[35m        urllib3_init_params.update(**urllib3_incremented_counters)[0m
[30;1m230 | [0m[35m[0m
[30;1m231 | [0m[35m        # Include urllib3's current state in our __init__ params[0m

[31m--[ [0m[34mMatch #[0m[33m254[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/retry.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m207 | [0m[35m[0m
[30;1m208 | [0m[35m        # Gather urllib3's current retry state _before_ increment was called[0m
[30;1m209 | [0m[35m        # These arguments match the function signature for Retry.__init__[0m
[30;1m210 | [0m[35m        # Note: if we update urllib3 we may need to add/remove arguments from this dict[0m
[30;1m211 | [0m[35m        urllib3_init_params = dict([0m
[30;1m212 | [0m[35m            total=self.total,[0m
[30;1m213 | [0m[35m            connect=self.connect,[0m

[31m--[ [0m[34mMatch #[0m[33m255[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/retry.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m116 | [0m[35m            # by the user[0m
[30;1m117 | [0m[35m            _attempts_remaining = self.stop_after_attempts_count[0m
[30;1m118 | [0m[35m        else:[0m
[30;1m119 | [0m[35m            # at least one of our attempts has been consumed, and urllib3 will have set a total[0m
[30;1m120 | [0m[35m            # `total` is a counter that begins equal to self.stop_after_attempts_count and is[0m
[30;1m121 | [0m[35m            # decremented after each unsuccessful request. When `total` is zero, urllib3 raises a[0m
[30;1m122 | [0m[35m            # MaxRetryError[0m

[31m--[ [0m[34mMatch #[0m[33m256[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/retry.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m263 | [0m[35m        self._retry_start_time = time.time()[0m
[30;1m264 | [0m[35m[0m
[30;1m265 | [0m[35m    def check_timer_duration(self) -> float:[0m
[30;1m266 | [0m[35m        """Return time in seconds since the timer was started"""[0m
[30;1m267 | [0m[35m[0m
[30;1m268 | [0m[35m        if self._retry_start_time is None:[0m
[30;1m269 | [0m[35m            raise OperationalError([0m

[31m--[ [0m[34mMatch #[0m[33m257[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/retry.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m257 | [0m[35m        return self._delay_default[0m
[30;1m258 | [0m[35m[0m
[30;1m259 | [0m[35m    def start_retry_timer(self) -> None:[0m
[30;1m260 | [0m[35m        """Timer is used to monitor the overall time across successive requests[0m
[30;1m261 | [0m[35m[0m
[30;1m262 | [0m[35m        Should only be called by ThriftBackend before sending a Thrift command"""[0m
[30;1m263 | [0m[35m        self._retry_start_time = time.time()[0m

[31m--[ [0m[34mMatch #[0m[33m258[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/retry.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m52 | [0m[35m    """[0m
[30;1m53 | [0m[35m    Implements our v3 retry policy by extending urllib3's robust default retry behaviour.[0m
[30;1m54 | [0m[35m[0m
[30;1m55 | [0m[35m    Retry logic varies based on the overall wall-clock request time and Thrift CommandType[0m
[30;1m56 | [0m[35m    being issued. ThriftBackend starts a timer and sets the current CommandType prior to[0m
[30;1m57 | [0m[35m    initiating a network request. See `self.should_retry()` for details about what we do[0m
[30;1m58 | [0m[35m    and do not retry.[0m

[31m--[ [0m[34mMatch #[0m[33m259[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/retry.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport logging[0m
[30;1m2 | [0m[35mimport random[0m
[30;1m3 | [0m[35mimport time[0m
[30;1m4 | [0m[35mimport typing[0m
[30;1m5 | [0m[35mfrom enum import Enum[0m
[30;1m6 | [0m[35mfrom typing import List, Optional, Tuple, Union[0m
[30;1m7 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m260[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/oauth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m165 | [0m[35m            "Accept": "application/json",[0m
[30;1m166 | [0m[35m            "Content-Type": "application/x-www-form-urlencoded",[0m
[30;1m167 | [0m[35m        }[0m
[30;1m168 | [0m[35m        response = requests.post([0m
[30;1m169 | [0m[35m            url=token_request_url, data=data, headers=headers, auth=IgnoreNetrcAuth()[0m
[30;1m170 | [0m[35m        )[0m
[30;1m171 | [0m[35m        return response.json()[0m

[31m--[ [0m[34mMatch #[0m[33m261[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/oauth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m59 | [0m[35m        known_config_url = self.idp_endpoint.get_openid_config_url(hostname)[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m        try:[0m
[30;1m62 | [0m[35m            response = requests.get(url=known_config_url, auth=IgnoreNetrcAuth())[0m
[30;1m63 | [0m[35m        except RequestException as e:[0m
[30;1m64 | [0m[35m            logger.error([0m
[30;1m65 | [0m[35m                f"Unable to fetch OAuth configuration from {known_config_url}.\n"[0m

[31m--[ [0m[34mMatch #[0m[33m262[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/oauth.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m23 | [0m[35m    """This auth method is a no-op.[0m
[30;1m24 | [0m[35m[0m
[30;1m25 | [0m[35m    We use it to force requestslib to not use .netrc to write auth headers[0m
[30;1m26 | [0m[35m    when making .post() requests to the oauth token endpoints, since these[0m
[30;1m27 | [0m[35m    don't require authentication.[0m
[30;1m28 | [0m[35m[0m
[30;1m29 | [0m[35m    In cases where .netrc is outdated or corrupt, these requests will fail.[0m

[31m--[ [0m[34mMatch #[0m[33m263[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/oauth.py[0m
   Pattern: [32m.hostname[0m
[30;1m234 | [0m[35m        oauth_config = self.__fetch_well_known_config(hostname)[0m
[30;1m235 | [0m[35m        # We are going to override oauth_config["authorization_endpoint"] use the[0m
[30;1m236 | [0m[35m        # /oidc redirector on the hostname, which may inject additional parameters.[0m
[30;1m237 | [0m[35m        auth_url = self.idp_endpoint.get_authorization_url(hostname)[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m        state = OAuthManager.__token_urlsafe(16)[0m
[30;1m240 | [0m[35m        (verifier, challenge) = OAuthManager.__get_challenge()[0m

[31m--[ [0m[34mMatch #[0m[33m264[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/oauth.py[0m
   Pattern: [32m.hostname[0m
[30;1m233 | [0m[35m    def get_tokens(self, hostname: str, scope=None):[0m
[30;1m234 | [0m[35m        oauth_config = self.__fetch_well_known_config(hostname)[0m
[30;1m235 | [0m[35m        # We are going to override oauth_config["authorization_endpoint"] use the[0m
[30;1m236 | [0m[35m        # /oidc redirector on the hostname, which may inject additional parameters.[0m
[30;1m237 | [0m[35m        auth_url = self.idp_endpoint.get_authorization_url(hostname)[0m
[30;1m238 | [0m[35m[0m
[30;1m239 | [0m[35m        state = OAuthManager.__token_urlsafe(16)[0m

[31m--[ [0m[34mMatch #[0m[33m265[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/oauth.py[0m
   Pattern: [32m.hostname[0m
[30;1m231 | [0m[35m        return fresh_access_token, fresh_refresh_token, True[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m    def get_tokens(self, hostname: str, scope=None):[0m
[30;1m234 | [0m[35m        oauth_config = self.__fetch_well_known_config(hostname)[0m
[30;1m235 | [0m[35m        # We are going to override oauth_config["authorization_endpoint"] use the[0m
[30;1m236 | [0m[35m        # /oidc redirector on the hostname, which may inject additional parameters.[0m
[30;1m237 | [0m[35m        auth_url = self.idp_endpoint.get_authorization_url(hostname)[0m

[31m--[ [0m[34mMatch #[0m[33m266[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/oauth.py[0m
   Pattern: [32m.hostname[0m
[30;1m230 | [0m[35m        )[0m
[30;1m231 | [0m[35m        return fresh_access_token, fresh_refresh_token, True[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m    def get_tokens(self, hostname: str, scope=None):[0m
[30;1m234 | [0m[35m        oauth_config = self.__fetch_well_known_config(hostname)[0m
[30;1m235 | [0m[35m        # We are going to override oauth_config["authorization_endpoint"] use the[0m
[30;1m236 | [0m[35m        # /oidc redirector on the hostname, which may inject additional parameters.[0m

[31m--[ [0m[34mMatch #[0m[33m267[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/oauth.py[0m
   Pattern: [32m.hostname[0m
[30;1m224 | [0m[35m        logger.debug([0m
[30;1m225 | [0m[35m            f"Attempting to refresh OAuth access token that expired on {expiration_time}"[0m
[30;1m226 | [0m[35m        )[0m
[30;1m227 | [0m[35m        oauth_response = self.__send_refresh_token_request(hostname, refresh_token)[0m
[30;1m228 | [0m[35m        fresh_access_token, fresh_refresh_token = self.__get_tokens_from_response([0m
[30;1m229 | [0m[35m            oauth_response[0m
[30;1m230 | [0m[35m        )[0m

[31m--[ [0m[34mMatch #[0m[33m268[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/oauth.py[0m
   Pattern: [32m.hostname[0m
[30;1m190 | [0m[35m        return access_token, refresh_token[0m
[30;1m191 | [0m[35m[0m
[30;1m192 | [0m[35m    def check_and_refresh_access_token([0m
[30;1m193 | [0m[35m        self, hostname: str, access_token: str, refresh_token: str[0m
[30;1m194 | [0m[35m    ):[0m
[30;1m195 | [0m[35m        now = datetime.now(tz=timezone.utc)[0m
[30;1m196 | [0m[35m        # If we can't decode an expiration time, this will be expired by default.[0m

[31m--[ [0m[34mMatch #[0m[33m269[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/oauth.py[0m
   Pattern: [32m.hostname[0m
[30;1m171 | [0m[35m        return response.json()[0m
[30;1m172 | [0m[35m[0m
[30;1m173 | [0m[35m    def __send_refresh_token_request(self, hostname, refresh_token):[0m
[30;1m174 | [0m[35m        oauth_config = self.__fetch_well_known_config(hostname)[0m
[30;1m175 | [0m[35m        token_request_url = oauth_config["token_endpoint"][0m
[30;1m176 | [0m[35m        client = oauthlib.oauth2.WebApplicationClient(self.client_id)[0m
[30;1m177 | [0m[35m        token_request_body = client.prepare_refresh_body([0m

[31m--[ [0m[34mMatch #[0m[33m270[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/oauth.py[0m
   Pattern: [32m.hostname[0m
[30;1m170 | [0m[35m        )[0m
[30;1m171 | [0m[35m        return response.json()[0m
[30;1m172 | [0m[35m[0m
[30;1m173 | [0m[35m    def __send_refresh_token_request(self, hostname, refresh_token):[0m
[30;1m174 | [0m[35m        oauth_config = self.__fetch_well_known_config(hostname)[0m
[30;1m175 | [0m[35m        token_request_url = oauth_config["token_endpoint"][0m
[30;1m176 | [0m[35m        client = oauthlib.oauth2.WebApplicationClient(self.client_id)[0m

[31m--[ [0m[34mMatch #[0m[33m271[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/oauth.py[0m
   Pattern: [32m.hostname[0m
[30;1m56 | [0m[35m        return f"http://localhost:{redirect_port}"[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    def __fetch_well_known_config(self, hostname: str):[0m
[30;1m59 | [0m[35m        known_config_url = self.idp_endpoint.get_openid_config_url(hostname)[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m        try:[0m
[30;1m62 | [0m[35m            response = requests.get(url=known_config_url, auth=IgnoreNetrcAuth())[0m

[31m--[ [0m[34mMatch #[0m[33m272[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000704[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration.Hostname[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/oauth.py[0m
   Pattern: [32m.hostname[0m
[30;1m55 | [0m[35m    def __get_redirect_url(redirect_port: int):[0m
[30;1m56 | [0m[35m        return f"http://localhost:{redirect_port}"[0m
[30;1m57 | [0m[35m[0m
[30;1m58 | [0m[35m    def __fetch_well_known_config(self, hostname: str):[0m
[30;1m59 | [0m[35m        known_config_url = self.idp_endpoint.get_openid_config_url(hostname)[0m
[30;1m60 | [0m[35m[0m
[30;1m61 | [0m[35m        try:[0m

[31m--[ [0m[34mMatch #[0m[33m273[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/oauth.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m133 | [0m[35m            raise last_error[0m
[30;1m134 | [0m[35m[0m
[30;1m135 | [0m[35m        if not handler.request_path:[0m
[30;1m136 | [0m[35m            msg = f"No path parameters were returned to the callback at {redirect_url}"[0m
[30;1m137 | [0m[35m            logger.error(msg)[0m
[30;1m138 | [0m[35m            raise RuntimeError(msg)[0m
[30;1m139 | [0m[35m        # This is a kludge because the parsing library expects https callbacks[0m

[31m--[ [0m[34mMatch #[0m[33m274[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/oauth.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m115 | [0m[35m[0m
[30;1m116 | [0m[35m                    webbrowser.open_new(auth_req_uri)[0m
[30;1m117 | [0m[35m                    logger.info([0m
[30;1m118 | [0m[35m                        f"Listening for OAuth authorization callback at {redirect_url}"[0m
[30;1m119 | [0m[35m                    )[0m
[30;1m120 | [0m[35m                    httpd.handle_request()[0m
[30;1m121 | [0m[35m                self.redirect_port = port[0m

[31m--[ [0m[34mMatch #[0m[33m275[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/oauth.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m128 | [0m[35m                logger.error("unexpected error: %s", e)[0m
[30;1m129 | [0m[35m        if self.redirect_port is None:[0m
[30;1m130 | [0m[35m            logger.error([0m
[30;1m131 | [0m[35m                f"Tried all the ports {self.port_range} for oauth redirect, but can't find free port[0m
[30;1m132 | [0m[35m            )[0m
[30;1m133 | [0m[35m            raise last_error[0m
[30;1m134 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m276[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/auth/oauth.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m1 | [0m[35mimport base64[0m
[30;1m2 | [0m[35mimport hashlib[0m
[30;1m3 | [0m[35mimport json[0m
[30;1m4 | [0m[35mimport logging[0m
[30;1m5 | [0m[35mimport secrets[0m

[31m--[ [0m[34mMatch #[0m[33m277[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m412 | [0m[35m        return log_base_data_dict[0m
[30;1m413 | [0m[35m[0m
[30;1m414 | [0m[35m    def user_friendly_error_message(self, no_retry_reason, attempt, elapsed):[0m
[30;1m415 | [0m[35m        # This should be kept at the level that is appropriate to return to a Redash user[0m
[30;1m416 | [0m[35m        user_friendly_error_message = "Error during request to server"[0m
[30;1m417 | [0m[35m        if self.error_message:[0m
[30;1m418 | [0m[35m            user_friendly_error_message = "{}: {}".format([0m

[31m--[ [0m[34mMatch #[0m[33m278[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m325 | [0m[35m        if arrow_table.num_rows > downloaded_file.row_count:[0m
[30;1m326 | [0m[35m            arrow_table = arrow_table.slice(0, downloaded_file.row_count)[0m
[30;1m327 | [0m[35m[0m
[30;1m328 | [0m[35m        # At this point, whether the file has extraneous rows or not, the arrow table should have th[0m
[30;1m329 | [0m[35m        assert downloaded_file.row_count == arrow_table.num_rows[0m
[30;1m330 | [0m[35m        self.start_row_index += arrow_table.num_rows[0m
[30;1m331 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m279[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/utils.py[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m268 | [0m[35m            results = pyarrow.concat_tables([results, table_slice])[0m
[30;1m269 | [0m[35m            self.table_row_index += table_slice.num_rows[0m
[30;1m270 | [0m[35m[0m
[30;1m271 | [0m[35m            # Replace current table with the next table if we are at the end of the current table[0m
[30;1m272 | [0m[35m            if self.table_row_index == self.table.num_rows:[0m
[30;1m273 | [0m[35m                self.table = self._create_next_table()[0m
[30;1m274 | [0m[35m                self.table_row_index = 0[0m

[31m--[ [0m[34mMatch #[0m[33m280[0m[34m of [0m[33m280[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/databricks_sql_connector-4.0.2/src/databricks/sql/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m310 | [0m[35m        )[0m
[30;1m311 | [0m[35m        if not downloaded_file:[0m
[30;1m312 | [0m[35m            logger.debug([0m
[30;1m313 | [0m[35m                "CloudFetchQueue: Cannot find downloaded file for row {}".format([0m
[30;1m314 | [0m[35m                    self.start_row_index[0m
[30;1m315 | [0m[35m                )[0m
[30;1m316 | [0m[35m            )[0m

280 matches found.
