[31m--[ [0m[34mMatch #[0m[33m1[0m[34m of [0m[33m17[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/revproxy/transformer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m152 | [0m[35m        transform = etree.XSLT(output_xslt)[0m
[30;1m153 | [0m[35m        self.log.debug("Transform: %s", transform)[0m
[30;1m154 | [0m[35m[0m
[30;1m155 | [0m[35m        charset = get_charset(self.response.get('Content-Type'))[0m
[30;1m156 | [0m[35m[0m
[30;1m157 | [0m[35m        try:[0m
[30;1m158 | [0m[35m            decoded_response = self.response.content.decode(charset)[0m

[31m--[ [0m[34mMatch #[0m[33m2[0m[34m of [0m[33m17[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/revproxy/transformer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m105 | [0m[35m            self.log.info("Content-type: false")[0m
[30;1m106 | [0m[35m            return False[0m
[30;1m107 | [0m[35m[0m
[30;1m108 | [0m[35m        content_encoding = self.response.get('Content-Encoding')[0m
[30;1m109 | [0m[35m        if content_encoding in ('zip', 'compress'):[0m
[30;1m110 | [0m[35m            self.log.info("Content encode is %s", content_encoding)[0m
[30;1m111 | [0m[35m            return False[0m

[31m--[ [0m[34mMatch #[0m[33m3[0m[34m of [0m[33m17[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/revproxy/transformer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m100 | [0m[35m            self.log.info("Response has streaming")[0m
[30;1m101 | [0m[35m            return False[0m
[30;1m102 | [0m[35m[0m
[30;1m103 | [0m[35m        content_type = self.response.get('Content-Type')[0m
[30;1m104 | [0m[35m        if not is_html_content_type(content_type):[0m
[30;1m105 | [0m[35m            self.log.info("Content-type: false")[0m
[30;1m106 | [0m[35m            return False[0m

[31m--[ [0m[34mMatch #[0m[33m4[0m[34m of [0m[33m17[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/revproxy/transformer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m88 | [0m[35m            self.log.info("DIAZO_OFF_REQUEST_HEADER in request.META: off")[0m
[30;1m89 | [0m[35m            return False[0m
[30;1m90 | [0m[35m[0m
[30;1m91 | [0m[35m        if asbool(self.response.get(DIAZO_OFF_RESPONSE_HEADER)):[0m
[30;1m92 | [0m[35m            self.log.info("DIAZO_OFF_RESPONSE_HEADER in response.get: off")[0m
[30;1m93 | [0m[35m            return False[0m
[30;1m94 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m5[0m[34m of [0m[33m17[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/revproxy/transformer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m            self.log.info("HAS_DIAZO: false")[0m
[30;1m85 | [0m[35m            return False[0m
[30;1m86 | [0m[35m[0m
[30;1m87 | [0m[35m        if asbool(self.request.META.get(DIAZO_OFF_REQUEST_HEADER)):[0m
[30;1m88 | [0m[35m            self.log.info("DIAZO_OFF_REQUEST_HEADER in request.META: off")[0m
[30;1m89 | [0m[35m            return False[0m
[30;1m90 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m6[0m[34m of [0m[33m17[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/revproxy/transformer.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m71 | [0m[35m        if hasattr(self.request, 'is_ajax'):[0m
[30;1m72 | [0m[35m            return self.request.is_ajax()[0m
[30;1m73 | [0m[35m        else:[0m
[30;1m74 | [0m[35m            return self.request.headers.get('x-requested-with') \[0m
[30;1m75 | [0m[35m                   == 'XMLHttpRequest'[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    def should_transform(self):[0m

[31m--[ [0m[34mMatch #[0m[33m7[0m[34m of [0m[33m17[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/revproxy/transformer.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m23 | [0m[35m[0m
[30;1m24 | [0m[35mfrom .utils import get_charset, is_html_content_type[0m
[30;1m25 | [0m[35m[0m
[30;1m26 | [0m[35m#: Regex used to find the doctype-header in a html content[0m
[30;1m27 | [0m[35mdoctype_re = re.compile(br"^<!DOCTYPE\s[^>]+>\s*", re.MULTILINE)[0m
[30;1m28 | [0m[35m#: String used to verify if request has a 'HTTP_X_DIAZO_OFF' header[0m
[30;1m29 | [0m[35mDIAZO_OFF_REQUEST_HEADER = 'HTTP_X_DIAZO_OFF'[0m

[31m--[ [0m[34mMatch #[0m[33m8[0m[34m of [0m[33m17[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/revproxy/response.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m84 | [0m[35m[0m
[30;1m85 | [0m[35m    :param proxy_response: urllib3.response.HTTPResponse object[0m
[30;1m86 | [0m[35m    """[0m
[30;1m87 | [0m[35m    content_type = proxy_response.headers.get('Content-Type', '')[0m
[30;1m88 | [0m[35m    # Disable buffering for "text/event-stream"(or other special types)[0m
[30;1m89 | [0m[35m    if content_type.lower() in NO_BUFFERING_CONTENT_TYPES:[0m
[30;1m90 | [0m[35m        return NO_BUFFERING_AMT[0m

[31m--[ [0m[34mMatch #[0m[33m9[0m[34m of [0m[33m17[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/revproxy/response.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m31 | [0m[35m[0m
[30;1m32 | [0m[35m    logger.debug('Proxy response headers: %s', headers)[0m
[30;1m33 | [0m[35m[0m
[30;1m34 | [0m[35m    content_type = headers.get('Content-Type')[0m
[30;1m35 | [0m[35m[0m
[30;1m36 | [0m[35m    logger.debug('Content-Type: %s', content_type)[0m
[30;1m37 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m10[0m[34m of [0m[33m17[0m[31m ]--[0m
   Rule Id: [34mBD000600[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Windows[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/django_revproxy-0.13.0.dist-info/METADATA[0m
   Pattern: [32m\s(advpack\.dll|appvlp|at|atbroker|bash|bginfo|bitsadmin|cdb|certutil|cl_invocation\.ps1|cl_mutexverifiers\.ps1|cmd|cmdkey|cmstp|comsvcs\.dll|control|csc|cscript|csi|devtoolslauncher|dfsvc|diskshadow|dnscmd|dnx|dotnet|dxcap|esentutl|eventvwr|excel|expand|extexport|extrac32|findstr|forfiles|ftp|gfxdownloadwrapper|gpscript|hh|ie4uinit|ieadvpack\.dll|ieaframe\.dll|ic|infdefaultinstall|installutil|jsc|makecab|manage-bde\.wsf|mavinject|mftrace|microsoft\.workflow\.compiler|mmc|msbuild|msconfig|msdeploy|msdt|mshta|mshtml\.dll|msc|msxsl|netsh|odbcconf|pcalua|pcwrun|pcwutl\.dll|pester\.bat|powerpnt|presentationhost|pubprn\.vbs|rcsi|reg|regasm|regedit|register-cimprovider|regsvcs|regsvr32|rpcping|rundll32|runonce|runscripthelper|sc|schtasks|scriptrunner|setupapi\.dll|shdocvw\.dll|shell32\.dll|slmgr\.vbs|sqldumper|sqlps|sqltoolsps|squirrel|syncappvpublishingserver|syncappvpublishingserver\.vbs|syssetup\.dll|te|tracker|tttracer|update|url\.dll|verclsid|vsjitdebugger|wab|winrm\.vbs|winword|wmic|wscript|wsl|wsreset|xwizard|zipfldr\.dll)\s[0m
[30;1m77 | [0m[35mreverse Proxy to HTTP requests. It also allows to use Django as an[0m
[30;1m78 | [0m[35mauthentication Proxy.[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35mDocumentation available at http://django-revproxy.readthedocs.org/[0m
[30;1m81 | [0m[35m[0m
[30;1m82 | [0m[35m[0m
[30;1m83 | [0m[35mFeatures[0m

[31m--[ [0m[34mMatch #[0m[33m11[0m[34m of [0m[33m17[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/revproxy/views.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m231 | [0m[35m                           proxy_response.headers['Location'])[0m
[30;1m232 | [0m[35m[0m
[30;1m233 | [0m[35m    def _set_content_type(self, request, proxy_response):[0m
[30;1m234 | [0m[35m        content_type = proxy_response.headers.get('Content-Type')[0m
[30;1m235 | [0m[35m        if not content_type:[0m
[30;1m236 | [0m[35m            content_type = (mimetypes.guess_type(request.path)[0] or[0m
[30;1m237 | [0m[35m                            self.default_content_type)[0m

[31m--[ [0m[34mMatch #[0m[33m12[0m[34m of [0m[33m17[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/revproxy/views.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m213 | [0m[35m        return proxy_response[0m
[30;1m214 | [0m[35m[0m
[30;1m215 | [0m[35m    def _replace_host_on_redirect_location(self, request, proxy_response):[0m
[30;1m216 | [0m[35m        location = proxy_response.headers.get('Location')[0m
[30;1m217 | [0m[35m        if location:[0m
[30;1m218 | [0m[35m            if request.is_secure():[0m
[30;1m219 | [0m[35m                scheme = 'https://'[0m

[31m--[ [0m[34mMatch #[0m[33m13[0m[34m of [0m[33m17[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/revproxy/views.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m157 | [0m[35m            self.log.info("REMOTE_USER set")[0m
[30;1m158 | [0m[35m[0m
[30;1m159 | [0m[35m        if self.add_x_forwarded:[0m
[30;1m160 | [0m[35m            request_ip = self.request.META.get('REMOTE_ADDR')[0m
[30;1m161 | [0m[35m            self.log.debug("Proxy request IP: %s", request_ip)[0m
[30;1m162 | [0m[35m            request_headers['X-Forwarded-For'] = request_ip[0m
[30;1m163 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m14[0m[34m of [0m[33m17[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/revproxy/views.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m143 | [0m[35m[0m
[30;1m144 | [0m[35m        If the view's add_x_forwarded property is True, the[0m
[30;1m145 | [0m[35m        headers X-Forwarded-For and X-Forwarded-Proto are set to the[0m
[30;1m146 | [0m[35m        IP address of the requestor and the request's protocol (http or https),[0m
[30;1m147 | [0m[35m        respectively.[0m
[30;1m148 | [0m[35m[0m
[30;1m149 | [0m[35m        .. versionadded:: TODO[0m

[31m--[ [0m[34mMatch #[0m[33m15[0m[34m of [0m[33m17[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/revproxy/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m78 | [0m[35m        return False[0m
[30;1m79 | [0m[35m[0m
[30;1m80 | [0m[35m    try:[0m
[30;1m81 | [0m[35m        content_length = int(proxy_response.headers.get('Content-Length', 0))[0m
[30;1m82 | [0m[35m    except ValueError:[0m
[30;1m83 | [0m[35m        content_length = 0[0m
[30;1m84 | [0m[35m[0m

[31m--[ [0m[34mMatch #[0m[33m16[0m[34m of [0m[33m17[0m[31m ]--[0m
   Rule Id: [34mBD000700[0m
       Tag: [34mSecurity.Backdoor.DataExfiltration[0m
  Severity: [36mImportant[0m, Confidence: [36mLow[0m
  Filename: [33m/revproxy/utils.py[0m
   Pattern: [32m\.(request|post|get)\([0m
[30;1m72 | [0m[35m    :returns: A boolean stating if the proxy_response should[0m
[30;1m73 | [0m[35m              be treated as a stream[0m
[30;1m74 | [0m[35m    """[0m
[30;1m75 | [0m[35m    content_type = proxy_response.headers.get('Content-Type')[0m
[30;1m76 | [0m[35m[0m
[30;1m77 | [0m[35m    if is_html_content_type(content_type):[0m
[30;1m78 | [0m[35m        return False[0m

[31m--[ [0m[34mMatch #[0m[33m17[0m[34m of [0m[33m17[0m[31m ]--[0m
   Rule Id: [34mBD000610[0m
       Tag: [34mSecurity.Backdoor.LOLBAS.Linux[0m
  Severity: [36mModerate[0m, Confidence: [36mLow[0m
  Filename: [33m/revproxy/utils.py[0m
   Pattern: [32m\s(apt|apt\-get|aria2c|arp|ash|awk|base64|bash|bpftrace|busybox|cat|chmod|chown|cp|cpan|cpulimit|crontab|csh|curl|cut|dash|dd|diff|dmesg|dmsetup|dnf|docker|dpkg|easy_install|ed|emacs|env|expand|expect|facter|find|finger|flock|fmt|ftp|gawk|gdb|gimp|git|grep|head|iftop|ionice|ip|irb|jjs|journalctl|jrunscript|ksh|ld\.so|ldconfig|logsave|ltrace|lua|mail|mawk|mount|mtr|mv|mysql|nano|nawk|nc|nice|nl|nmap|node|od|openssl|perl|pg|php|pic|pico|pip|puppet|readelf|red|rlogin|rlwrap|rpm|rpmquery|rsync|ruby|run\-mailcap|run\-parts|rvim|scp|screen|script|sed|service|setarch|sftp|shuf|smbclient|socat|sort|sqlite3|ssh|start\-stop\-daemon|stdbuf|strace|systemctl|tail|tar|taskset|tclsh|tcpdump|tee|telnet|tftp|time|timeout|tmux|top|ul|unexpand|uniq|unshare|vi|vim|watch|wget|whois|wish|xargs|xxd|yum|zsh|zypper)\s[0m
[30;1m39 | [0m[35m#: to be turned into stream[0m
[30;1m40 | [0m[35mMIN_STREAMING_LENGTH = 4 * 1024  # 4KB[0m
[30;1m41 | [0m[35m[0m
[30;1m42 | [0m[35m#: Regex used to find charset in a html content type[0m
[30;1m43 | [0m[35m_get_charset_re = re.compile(r';\s*charset=(?P<charset>[^\s;]+)', re.I)[0m
[30;1m44 | [0m[35m#: Regex used to clean extra HTTP prefixes in headers[0m
[30;1m45 | [0m[35m_get_header_name_re = re.compile([0m

17 matches found.
